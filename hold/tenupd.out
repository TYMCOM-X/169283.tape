TENUPD - SIMPL VERS 2.00 21-JUL 1973 13:42



     1	00010	!  IOCS DEFS OF INTEREST TO USER
     2	00020	
     3	00030	!  FILE DESCRIPTORS PASSED TO %OPEN
     4	00040	
     5	00050	!MAINTAIN ORDER OF FILE TYPES (SEE %OPEN1)
     6	00060	
     7	00070	DEF INPUT AS 0
     8	00080	DEF UPDATE AS 1
     9	00090	DEF OUTPUT AS 2
    10	00100	DEF OUTMSG AS 3
    11	00110	
    12	00120	!FILE TYPE MODIFIERS
    13	00130	
    14	00140	DEF NEW AS OCT 100
    15	00150	DEF OLD AS OCT 200
    16	00160	
    17	00170	!FILE MODES
    18	00180	
    19	00190	DEF SEQUEN AS 0
    20	00200	DEF DIRECT AS OCT 10
    21	00210	
    22	00220	!FILE ORGANIZATIONS
    23	00230	
    24	00240	DEF WORD AS 0
    25	00250	DEF CHARACTER AS OCT 20
    26	00260	DEF PACK AS OCT 40
    27	00270	
    28	00280	!  FILE NUMBERS  (FNMIN IS MIN CHANNEL WHICH WILL BE USED)
    29	00290	
    30	00300	DEF FNMIN AS 1            !MIN AND MAX FILE NUMBERS
    31	00310	DEF FNMAX AS 15           !AVAILABLE, EXCLUDING TEL
    32	00320	DEF TEL AS (FNMIN-1)        !FILE NO. INDICATING TERMINAL 
    33	00330	
    34	00340	!  ERROR NUMBERS (ERRNUM VALUES)
    35	00350	
    36	00360	DEF TMFERR AS 1     !TOO MANY FILES OPEN (OPEN)
    37	00370	DEF FMDERR AS 2     !BAD FILE MODE OR TYPE FOR ATTEMPTED OPERATION
    38	00380	                    !(OPEN SEQUEN UPDATE, SETCP OR ERASE SEQUEN,
    39	00390	                    !WRITE OR ERASE INPUT, READ SEQUEN OUTPUT)
    40	00400	DEF IFDERR AS 3     !ILLEGAL FILE IDENTIFIER (SETFID, OPEN, DELETE, RENAME)
    41	00410	DEF CNFERR AS 4     !NEW/OLD FILE MESSAGE NOT CONFIRMED (OPEN OUTMSG)
    42	00420	                    !OR TYPE MODIFIER CONFLICT - FILE NOT NEW/OLD (OPEN OUTPUT OR UPDATE)
    43	00430	
    44	00440	!ORDER OF FOLLOWING 5 NOS. SHALL BE MAINTAINED. (ALL BUT LAST MAY
    45	00450	!OCCUR DURING OPEN, DELETE, OR RENAME)
    46	00460	
    47	00470	DEF FNFERR AS 5     !FILE NOT FOUND
    48	00480	DEF IUSERR AS 6     !INVALID USER NAME (BAD PPN)
    49	00490	DEF PRTERR AS 7     !PROTECTION VIOLATION ATTEMPT
    50	00500	DEF FBSERR AS 8     !FILE BUSY
    51	00510	DEF AEFERR AS 9     !NEW NAME BELONGS TO ALREADY EXISTING FILE  (RENAME)
    52	00520	
    53	00530	DEF EOFERR AS 10    !END OF FILE (R, RB, GETLINE)
    54	00540	DEF LNGERR AS 11    !LINE TOO LONG (GETLINE FROM FILE)
    55	00550	DEF TELERR AS 12    !ILLEGAL OPERATION ON TEL (OPEN, DELETE, RENAME,
    56	00560	                    !CP, SIZE)
    57	00570	DEF ARGERR AS 13    !BAD ARGUMENT VALUE - SUCH AS:
    58	00580	                    !NEGATIVE CURSOR POSITION (SETCP, ERASE),
    59	00590	                    !NEG. COUNT (RB, WB)
    60	00600	DEF CORERR AS 14    !OUT OF CORE (OPEN, BLOCK, RELEASE)
    61	00610	
    62	00620	FIND CFN, %SETCFN, %EXU
    63	00630	FIND %IOCS,%OPEN,%SETFID,%WFID,%CLOSE,%BUF.DUMP
    64	00640	FIND %CLOSE.ALL, %PLNCHK, %PLNW, %SET.TAB
    65	00650	FIND %SET.TERM, %SET.PRMPT, %TAB.OFF, %R, %GETLINE
    66	00660	FIND %W, %WX, %ERASE, %SETCP, %CP, %SIZE
    67	00670	FIND %WB, %RB
    68	00680	FIND %BLOCK, %RELEASE
    69	00690	FIND %DELETE,%RENAME
    70	00700	FIND %CLIBUF, %CLOBUF, %TTYLEN, %GET, %PUT, %PUTX, %PUTC
    71	00710	FIND %PRINT, %PRINTC, %MSG, %SETRWE
    72	00720	FIND %OFFALT, %ONALT, %ONALT.C, ALTLOC, ERRNUM
    73	00730	
    74	00740	FIND FIDP()
    75	00750	DEF LOCWPF AS 4
    76	00760	DEF MAXARG AS 27
    77	00770	DEF MINARG AS 5
    78	00780	DEF WPF AS (LOCWPF+1+MINARG)
    79	00790	DEF MAXWPF AS (LOCWPF+1+MAXARG)
    80	00800	! EXTENDED ARGUMENT BLOCK:
    81	00810	DEF ARGCNT(TBL) AS TBL(LOCWPF)
    82	00820	DEF PPNARG(TBL) AS TBL(LOCWPF+1)
    83	00830	DEF NAMARG(TBL) AS TBL(LOCWPF+2)
    84	00840	DEF EXTARG(TBL) AS TBL(LOCWPF+3)
    85	00850	DEF PRVARG(TBL) AS TBL(LOCWPF+4)
    86	00860	DEF FILSIZ(TBL) AS TBL(LOCWPF+5)
    87	00870	DEF EXTQ(TBL) AS TBL(0)
    88	00880	DEF USRNAM(TBL) AS TBL(1)
    89	00890	DEF DEVNAM(TBL) AS TBL(3)
    90	00900	
    91	00910	!  GETLINE 
    92	00920	
    93	00930	DEF LLEN AS 256                !MAX. LINE LENGTH
    94	00940	DEF GLBCMX AS (LLEN+1)         !MAX. CHAR CAPACITY
    95	00950	DEF CPW AS CHARS.PER.WORD
    96	00960	DEF GLBSZ AS (GLBCMX+CPW-1)/CPW   !SIZE IN WORDS
    97	00970	FIND FREE(0:GLBSZ-1)         !GETLINE INTERNAL BUFFER (AVAILABLE
    98	00980	                             !BETWEEN GETLINE CALLS)
    99	00990	FIND IMAGE(0:GLBSZ-1)        !GETLINE IMAGE LINE BUFFER
   100	01000	FIND GLCNT                   !GETLINE CHAR COUNT
   101	BASE 0
   102	GLOBAL %TENUPDATE
   103	
   104	%TENUPDATE
   105	
   106	
   107	FIND %OUT, %BYPT, %CHOOSE, %LISTABLE, %DATOUT, %BUILD
   108	FIND %INITTTY, %GETNUM, %GETTOKEN, %NUMOUT, %OCTOUT, %GETOCT, %QUERY
   109	FIND %IMGIO, %HASH, %MAKE.SIXBIT, %CHR.OUT, %PASS.IN
   110	FIND TOKEN(0)
   111	
   112	GLOBAL CHK.ERR:, IO.ADR, IOTAB(WPF)
   113	
   114	GLOBAL INDEX, THIS.SYS, THIS.LIC, CMD,CHG
   115	GLOBAL OP, CHR	!VARIABLES FOR IMAGE I/O
   116	GLOBAL D.BLK(128), D.INDEX, D.LOC, CH.DUL,  DUL.NAME, D.OV.BLK.N
   117	GLOBAL SIZE.DUL, PASSW(2), ANS(4), H.SYS, DATE, DAY, TTFNAME, TTEXT
   118	GLOBAL L.BLK(128), L.INDEX, LOC.HASH, CH.LUD, LUD.NAME, L.OV.BLK.N
   119	GLOBAL L.SAVE(128), SIZE.LUD, CPARW, CT
   120	GLOBAL SITE.31.NAME, SITE, CODE, C.USER(2), M.KIND
   121	GLOBAL CH.OUT, P, NUMBER, P1, TMP, USER(2), FOUND
   122	GLOBAL STRINF(2), NAME.HASH, OLD.NAME(2), PRIV, DIST, RUB
   123	GLOBAL GAN, UUN, MUD(3), A.CHAN, STRING
   124	GLOBAL L.OLD.INDEX, LOC.OLD.HASH, O.ENT.SIZE, OLD.HASH
   125	GLOBAL UFD, BAD.CHR:, FROMTTY:
   126	
   127	GLOBAL %ERROR, %INITUPD, %LOKUP.LUD, %LUD.SEQ, %LOKUP.DUL
   128	GLOBAL %LUD.LOOK, %DUL.LOOK, %DEL.FILES, %CALL.UUO
   129	GLOBAL %FIND.STR, %FIND.L.ROOM, %MAKE.L.OVER
   130	GLOBAL %MAKE.D.OVER, %CHK.IO.ERR, %GET.STR.INF, %SEND.O.WD
   131	GLOBAL %GET.P.BITS, %O.LUDUPD, %MUDUP, %GET.M.CIR, %GET.A.CIR
   132	GLOBAL  %GET.MODE, %SEND.ACT, %GET.CIR, %T.ERROR
   133	GLOBAL %CHECK.OK, %LIST.INF, %CHANGE.ENT, %BILL.USER
   134	GLOBAL %SEND.MUD, %SEND.CIR
   135	GLOBAL %GET.MUD.DATA, %COMPRESS, %MAKE.CPARW
   136	
   137	
   138	
   139	
   140	!INTERNAL MUD,LUD,DUL COMMANDS
   141	DEF DEL.USR AS 1
   142	DEF ADD.USR AS 2
   143	DEF CH.NAME AS 3
   144	DEF CH.PRIV AS 4
   145	DEF CH.STR AS 5
   146	DEF CH.DIST AS 6
   147	DEF CH.RUB AS 7
   148	DEF CH.HOME AS 8
   149	DEF REVERSE AS 9
   150	DEF CH.PASSW AS 10
   151	DEF GET.M AS 11
   152	DEF OTHER.L.D AS 12
   153	DEF CH.COMMON AS 13
   154	
   155	!USER COMMANDS
   156	DEF HELP AS 1
   157	DEF GET AS 2
   158	DEF VALIDATE AS 3
   159	DEF ADD AS 4
   160	DEF CHANGE AS 5
   161	DEF INVALIDATE AS 6
   162	DEF REMOVE AS 7
   163	DEF CHECK AS 8
   164	DEF LIST AS 9
   165	DEF QUIT AS 10
   166	
   167	!LIST COMMANDS
   168	DEF L.PROJECT AS 1
   169	DEF L.USER AS 2
   170	
   171	!MUD CODES
   172	DEF M.NEW AS 1
   173	DEF M.CH.PASSW AS 2
   174	DEF M.DEL AS 3
   175	DEF M.CH.CPAR AS 4
   176	DEF M.CH.NAME AS 6
   177	DEF M.CK.UNQE AS 7
   178	DEF M.CH.SYS AS 8
   179	DEF M.G.MUD AS 10
   180	
   181	!MUD ERRORS
   182	DEF NIM AS 1
   183	DEF AIM AS 2
   184	DEF MFB AS 3
   185	DEF MMISC AS 4
   186	
   187	!SIZE OF TABLES
   188	DEF N.I.CMDS AS 10
   189	DEF N.U.CMDS AS 16
   190	DEF N.MODES AS 4
   191	DEF N.LISTS AS 2
   192	DEF N.CHANGES AS 9
   193	
   194	
   195	GLOBAL TABLE INT.CMDS(1:N.I.CMDS)['HELP','GET','NEW','ADD','CHANGE',&
   196		'CANCEL','REMOVE','CHECK','LIST','QUIT']
   197	
   198	GLOBAL TABLE U.CMDS(1:N.U.CMDS)['HELP','NEW USER',&
   199		'ADD PDP10','CHANGE NAME','CHANGE HOME','CHANGE PASSWORD',&
   200	        'CHANGE PRIVILEGES','CANCEL USER','REMOVE PDP10',&
   201		'CHANGE STRUCTURE','CHANGE DISTRICT','CHECK NAME',&
   202		'GET MUD','LIST PROJECT','LIST USER','QUIT']
   203	
   204	
   205	DEF DUMMY AS 'JILLMARCIN'
   206	GLOBAL TABLE CH.CMDS(1:N.CHANGES)[DUMMY,DUMMY,'NAME','PRIVILEGES',&
   207	   'STRUCTURE','DISTRICT',DUMMY,'HOME','PASSWORD']
   208	
   209	GLOBAL TABLE L.CMDS(1:N.LISTS)['PRIJECT','USER']
   210	
   211	GLOBAL TABLE MODES(1:N.MODES)['PDP10','TYMEX','GE','SUDS']
   212	
   213	!FLAGS
   214	GLOBAL N.OFFICIAL	!=1 IF CHANGING NON-OFFICIAL LUD/DUL
   215	GLOBAL TTYF		!=1 IF RUN FROM TTY; =0 IF FROM CIRCUITS
   216	   DEF CIR AS 0
   217	GLOBAL MUD.CIR		 ! = CHAN. #  IF CIR BUILT TO MUD SYSTEM, ELSE ZERO
   218	GLOBAL ACCT.CIR		! = CHAN. #  IF CIR BUILT TO ACCTG. SYS, ELSE ZERO
   219	GLOBAL IN.VAL.UF	! = EITHER REMOVE OR CANCEL
   220	   DEF UCANCEL AS 0
   221	   DEF U.REMOVE AS 1
   222	GLOBAL NEW.USERF	! = EITHER NEW OR ADD
   223	   DEF NEW.U AS 0
   224	   DEF ADD.U AS 1
   225	
   226	!IMAGE MODE OPERATIONS - USED WHEN TENUPD IS RUN FROM AN AUX CIR.
   227	DEF SET.UP.TTY AS 1
   228	DEF SEND AS 2
   229	DEF RECEIVE AS 3
   230	
   231	!WORDS IN LUD/DUL ENTRIES
   232	DEF WD.PPN AS 0
   233	DEF WD.S.NAME AS 0
   234	DEF WD.DIST AS 1
   235	DEF WD.NAME AS 1	!DUL ENTRY ONLY
   236	DEF WD.INIT AS 2
   237	DEF WD.SIZE AS 2
   238	DEF WD.RUB AS 2
   239	DEF WD.PRIV AS 3
   240	DEF WD.HASH AS 4
   241	DEF WD.STRN AS 5
   242	DEF WD.QIN AS 6
   243	DEF WD.QOUT AS 7
   244	
   245	!MUD WORD VALUES
   246	DEF M.GAN AS 0
   247	DEF M.UUN AS 1
   248	DEF M.HOME AS 1
   249	DEF M.CPARW AS 2
   250	
   251	
   252	
   253	GLOBAL TABLE ERRTAB(1:20)['$ENTRY COMPLETED','NAME ALLREADY IN LUD',&
   254	   'NAME NOT IN LUD','NAME ALLREADY IN DUL','NAME NOT IN DUL',&
   255	   'NAME ALLREADY IN MUD','NAME NOT IN MUD','STR ALLREADY THERE',&
   256	   'STR NOT FOUND','ILLEGAL SYSTEM NO.',&
   257	   'ERROR IN BILLING FILE','FILE BUSY - TRY AGAIN',&
   258	   'ERROR IN DELETING FILE OR UFD','BAD CODE','SIMPL ERROR',&
   259	   'ILLEGAL NAME','BAD UUO','AUX. CIR. ERROR','MISC. MUD ERROR',&
   260	   'MUD BUSY - TRY LATER']
   261	
   262	
   263	
   264	DEF ACCT.SYS AS 31
   265	DEF ACCT.SUP.BIT(A) AS BYT(A,1,13)
   266	DEF ALPHA AS 0	!ARGUMENT FOR GETTOKEN - RETURN ALPHA VALUE
   267	DEF C.IMGIO(A,B) AS [OP _ A; CHR _ B; IMGIO]
   268	DEF CK.A.CIR AS [IF ACCT.CIR = NOT.THERE THEN [IF GET.A.CIR = NOT.THERE THEN &
   269		GO GETCMD]]
   270	DEF CK.M.CIR AS [IF MUD.CIR = NOT.THERE THEN [IF GET.M.CIR = NOT.THERE THEN &
   271		GO GETCMD]]
   272	DEF CK.NAME AS [IF FOUND # THERE THEN ERROR(NAME.NT.LUD);&
   273	   IF MUDUP(GET.M) # THERE THEN ERROR(NAME.NT.MUD)]
   274	DEF CPARW.CHG AS [M.KIND _ M.CH.CPAR; CT+_3; SEND.CT.AND.NAME;&
   275	   SEND.M.EOF; MUD.GOOD]
   276	DEF CR AS CHR.OUT(CARRET)
   277	DEF CUD10.PPN AS OCT 1042313
   278	DEF D.BLK.UP AS [LOKUP.DUL(IN.UPDATE); SETCP(CH.DUL,FIXCP(D.LOC));&
   279		RB(CH.DUL,SIZE.BLK,D.BLK); SETCP(CH.DUL,FIXCP(D.LOC))]
   280	DEF DIST.BITS AS BYT(LUD(WD.DIST),8,0)
   281	DEF DSKB AS 'DSKB'
   282	DEF DUL(A) AS D.BLK(D.INDEX+A)
   283	DEF DUL.OVER AS [D.OV.BLK.N_GET.D.OV.BLK; LOKUP.DUL(IN.READ);&
   284		SETCP(CH.DUL,FIXCP(D.OV.BLK.N)); DUL.READ; CLOSE(CH.DUL)]
   285	DEF DUL.READ AS [RB(CH.DUL,SIZE.BLK,D.BLK); D.INDEX _ 0]
   286	DEF DUL.WRIT AS [WB(CH.DUL,SIZE.BLK,D.BLK); CLOSE(CH.DUL)]
   287	DEF EXCH.OLD.NEW.N AS [USER(0)<=>OLDNAME(0);USER(1)<=>OLDNAME(1)]
   288	DEF FILL.IN.LUD.INF AS [MOVE SIZE.NEW.ENT FROM L.SAVE TO @LUD(WD.PPN);&
   289	   MOVE SIZE.STR.INF FROM STRINF TO @LUD(WD.STRN)]
   290	DEF FIND.NAME AS [GET.T.NAME; IF FOUND _ LUD.LOOK = THERE &
   291	   THEN MOVE SIZE.LUD.ENT FROM @LUD(WD.PPN) TO L.SAVE]
   292	DEF FIND.D.ROOM AS IF D.INDEX+SIZE.DUL.ENT>=SIZE.BLK THEN MAKE.D.OVER
   293	DEF FIRSTOF24(A) AS BYT(A,1,23)
   294	DEF FIXCP(A) AS (A-1)*SIZE.BLK
   295	DEF G.CIR.NUM AS [P1 _ BYPT(NUMBER,24,8); NUMBER _ 0;&
   296	   REPEAT 3 C.IMGIO(RECEIVE,NCHV P1)]
   297	DEF G.CIR.WD(A,B) AS [P1 _ CHPT(A,-1); REPEAT B IMGIO(RECEIVE,P1)]
   298	DEF GET.C.NAME AS [IF TTYF = CIR THEN G.CIR.WD(USER,12); FOUND_LUD.LOOK]
   299	DEF GET.DIST AS [MSG('DISTRICT: '); DIST _ GETNUM]
   300	DEF GET.D.OV.BLK AS HW(@DUL(WD.PPN),1)
   301	DEF GET.GAN AS [MSG('GAN: '); GAN _ HW(@L.SAVE(WD.PPN),0)_GETOCT]
   302	DEF GET.L.OV.BLK AS HW(@LUD(WD.PPN),1)
   303	DEF GET.NEW AS MSG('NEW ')
   304	DEF GET.NUM.INF(A) AS [IF TTYF # CIR THEN [MSG(A); GETNUM] &
   305	   ELSE G.CIR.NUM]
   306	DEF GET.H.SITE AS [MSG('$HOME SYSTEM: '); IF MAX.SITE<H.SYS_GETNUM&
   307	   <1 OR 19<H.SYS<24 OR 24<H.SYS<30 THEN ERROR(BAD.SITE)]
   308	DEF GET.PASS AS [CLOSE.ALL; PASS.IN; CH.OUT_OPEN('TEL',SEQUEN+&
   309	   OUTPUT+CHARACTER,0,2)]
   310	DEF GET.T.NAME AS [MSG('USER NAME: '); GETTOKEN(ALPHA);&
   311		MAKE.SIXBIT(TOKEN,USER,12)]
   312	DEF HIGH.UFD.INDEX AS 125
   313	DEF INIT.BIT AS BYT(LUD(WD.INIT),1,8)
   314	DEF IN.STR.PDP AS 'CUD10:31'
   315	DEF IN.STR.940 AS 'CUD:*;'
   316	DEF IN.VAL.DUL AS MAKE.DUL.CHG(MOVE 3 FROM ALL 0 TO @DUL(WD.PPN))
   317	DEF MAKE.LUD.CHG(A) AS [L.BLK.UP; A; LUD.CL]
   318	DEF IN.VAL.LUD AS [MAKE.LUD.CHG(LUD(WD.HASH) _ 0); MSG(TT.MSGS(LUD.REV))]
   319	DEF L.BLK.UP AS [LOKUP.LUD(IN.UPDATE); SETCP(CH.LUD,FIXCP(LOC.HASH));&
   320	   RB(CH.LUD,SIZE.BLK,L.BLK); SETCP(CH.LUD,FIXCP(LOC.HASH))]
   321	DEF L.OV.BLK AS HW(@LUD(WD.PPN),1)
   322	DEF LUD(A) AS L.BLK(L.INDEX+A)
   323	DEF LUD.CL AS [LUD.WRIT; CLOSE(CH.LUD)]
   324	DEF LUD.OVER AS [L.OV.BLK.N _ GET.L.OV.BLK; LOKUP.LUD(IN.READ);&
   325	   SETCP(CH.LUD,FIXCP(L.OV.BLK.N)); LUD.READ; CLOSE(CH.LUD)]
   326	DEF LUD.READ AS [RB(CH.LUD,SIZE.BLK,L.BLK); L.INDEX _ 0]
   327	DEF LUD.WRIT AS WB(CH.LUD,SIZE.BLK,L.BLK)
   328	DEF MAKE.CHG(A) AS [CHECK.OK; MAKE.LUD.CHG(A)]
   329	DEF MAKE.DUL.CHG(A) AS [D.BLK.UP; A; DUL.WRIT]
   330	DEF MAKE.VALID AS [MAKE.LUD.CHG(LUD(WD.HASH) _ NAME.HASH); MSG(TT.MSGS(LUD.REV))]
   331	DEF MIN.CMD AS 1
   332	DEF MAX.CMD AS 12
   333	DEF MAX.SITE AS 33
   334	DEF MODE.BITS(A) AS BYT(A,2,7)
   335	DEF M.EOF AS OCT 40
   336	DEF MUD.GOOD AS [GET.CIR(MUD.CIR,1); IF ANS = 0 THEN &
   337	   [MSG(TT.MSGS(MUD.OK)); RETURN]]
   338	DEF NAME.OUT(A) AS [P1 _ BYPT(A,1,6); REPEAT 12 CHR.OUT(NCHV P1 + &
   339	   OCT 40); CR]
   340	DEF N.DUL.BLKS AS SIZE(CH.DUL)/SIZE.BLK
   341	DEF N.LUD.BLKS AS SIZE(CH.LUD)/SIZE.BLK
   342	DEF NO AS 0
   343	DEF NOT.THERE AS 0
   344	DEF NUM AS 1
   345	DEF PPN.OUT AS [OUT('$PPN: '); OCT.WD.OUT(@LUD(WD.PPN))]
   346	DEF OCT.WD.OUT(A) AS [OCTOUT(HW(A),0); CHR.OUT($,); OCTOUT(HW(A),1)]
   347	DEF OV.BIT AS OCT 400000
   348	DEF OV.L.BIT AS HW(@LUD(WD.PPN),0)
   349	DEF OV.D.BIT AS HW(@DUL(WD.PPN),0)
   350	DEF IN.READ AS 0
   351	DEF RESTORE AS [NAME.HASH_OLD.HASH; LOC.HASH_LOC.OLD.HASH;&
   352		L.INDEX_L.OLD.INDEX]
   353	DEF RUB.BIT AS BYT(LUD(WD.RUB),1,33)
   354	DEF SAVE.OLD AS [O.ENT.SIZE_SIZE.LUD.ENT; L.OLD.INDEX_L.INDEX+&
   355		LOC.OLD.HASH_LOC.HASH; OLD.HASH_NAME.HASH]
   356	DEF SEND.CT.AND.NAME AS [SEND.MUD(@CT,1); SEND.MUD(@M.KIND,1);&
   357	   SEND.MUD(C.USER,9)]
   358	DEF SEND.M.EOF AS SEND.MUD(M.EOF,1)
   359	DEF SEND.SYS.AND.NAME AS [TMP_THIS.SYS; SEND.ACT(NUM,TMP,1);&
   360	   SEND.ACT(ALPHA,USER,12)]
   361	DEF SET.RUB AS RUB _ QUERY('$SET RESTRICTED USE BIT')
   362	DEF SET.SITE AS [HW(@EXTARG(IOTAB),0) _ SITE.31.NAME;&
   363	   SITBYT _ SITBYT + SITE - 31]
   364	DEF SITBYT AS BYT(EXTARG(IOTAB),6,24)
   365	DEF SIX.B(A) AS A-OCT 40
   366	DEF SIZE.BLK AS 128
   367	DEF SIZE.DUL.ENT AS 3
   368	DEF SIZE.NEW.ENT AS 8
   369	DEF SIZE.INIT.INF AS 3
   370	DEF SIZE.LUD.ENT AS BYT(LUD(WD.SIZE),7,0)
   371	DEF SIZE.STR.INF AS 3
   372	DEF SIZE.UFD.ENT AS 5
   373	DEF TT.DIST.OUT AS [OUT('$2. DISTRICT: '); NUMOUT(L.SAVE(WD.DIST))]
   374	DEF TT.HOME.OUT AS [OUT('$5. HOME SYSTEM: '); NUMOUT(H.SYS)]
   375	DEF TT.PRIV.OUT AS [OUT('$3. PRIV: ');&
   376	   IF ACCT.SUP.BIT(L.SAVE(WD.PRIV)) = THERE THEN OUT('ACCT. SUP');&
   377	   IF TYMSH.BIT(L.SAVE(WD.PRIV)) = THERE THEN OUT('TYM');&
   378	   OUT('$   MODE: '); OUT(@MODES(MODE.BITS(WD.PRIV)))]
   379	DEF TT.RUB.OUT AS IF RUB.BIT = THERE THEN OUT('$6. RUB BIT SET') &
   380	   ELSE OUT('$6. RUB BIT NOT SET')
   381	DEF TT.STR.OUT AS [OUT('$4. STRUCTURE: ');P1 _ BYPT(L.SAVE(WD.STRN),1,6);&
   382	   REPEAT 4 CHR.OUT(NCHV P1 + OCT 40);&
   383	   OUT('$   QUOTA IN: '); NUMOUT(L.SAVE(WD.QIN));&
   384	   OUT('$   QUOTA OUT: '); NUMOUT(L.SAVE(WD.QOUT))]
   385	DEF TT.USER.OUT AS [OUT('$1. USER NAME: '); NAME.OUT(USER)]
   386	DEF THERE AS 1
   387	DEF TYMSH.BIT(A) AS BYT(A,1,14)
   388	DEF UFD.READ AS [RB(CH.UFD,SIZE.BLK,UFD.BLK); INDEX _ 0]
   389	DEF IN.UPDATE AS 1
   390	DEF VERSION AS 1
   391	DEF WHAT AS [MSG('$??$'); GO GETCMD]
   392	DEF YES AS 1
   393	
   394	!ERRORS
   395	DEF OK AS 1
   396	DEF NAME.IN.LUD AS 2
   397	DEF NAME.NT.LUD AS 3
   398	DEF NAME.IN.DUL AS 4
   399	DEF NAME.NT.DUL AS 5
   400	DEF NAME.IN.MUD AS 6
   401	DEF NAME.NT.MUD AS 7
   402	DEF STR.THERE AS 8
   403	DEF STR.NT.THERE AS 9
   404	DEF BAD.SITE AS 10
   405	DEF BILL.FILE.ERR AS 11
   406	DEF FILE.BUSY AS 12
   407	DEF DEL.ERR AS 13
   408	DEF BAD.CODE AS 14
   409	DEF SIMPL.ERR AS 15
   410	DEF BAD.NAME AS 16
   411	DEF BAD.UUO AS 17
   412	DEF AUX.ERR AS 18
   413	DEF MUD.ERR AS 19
   414	DEF MUD.BUSY AS 20
   415	
   416	!TATTLE TALE FILES MESSAGES
   417	DEF MUD.OK AS 1
   418	DEF MUD.REV AS 2
   419	DEF LUD.OK AS 3
   420	DEF LUD.REV AS 4
   421	
   422	TABLE TT.MSGS(1:4)['MUD ENTRY MADE','MUD ENTRY REVERESED',&
   423	   'LUD ENTRY MADE','LUD ENTRY REVERESED']
   424	
   425	
   426	
   427	START: GO FROMCIR	!START HERE IF FROM A CIRCUIT
   428	
   429	FROMTTY: TTYF _ 1; INITUPD; GO GETCMD	!HERE IF FROM TTY - SET TTYF
   430	\\->FROMTTY
   431	
   432	FROMCIR: TTYF _ CIR; INITUPD; LOOP RETURN O.LUDUPD(OTHER.L.D)
   433	
   434	GETCMD: N.OFFICIAL _ IN.VAL.UF _ NEW.USERF _ 0
   435	MSG('$*'); P _ GETLINE(TEL); GETTOKEN(ALPHA)
   436	   IF CMD _ CHOOSE(N.I.CMDS,INT.CMDS) = NOT.THERE THEN WHAT
   437	DISP: DO CMD OF 1:N.I.CMDS
   438	
   439	HELP: LISTABLE(N.U.CMDS,U.CMDS)
   440	
   441	GET: CK.M.CIR; GET.T.NAME
   442	   IF MUDUP(GET.M) # THERE THEN ERROR(NAME.NT.MUD)
   443	   MSG('$GAN: '); OCTOUT(BYT(MUD(M.GAN),20,0))
   444	   MSG('$UUN: '); OCTOUT(BYT(MUD(M.UUN),17,0))
   445	   MSG('$DISTRICT: '); NUMOUT(BYT(MUD(M.CPARW),9,0))
   446	   MSG('$HOME SYS: '); NUMOUT(BYT(MUD(M.HOME),7,23))
   447	48	CHECK: CK.M.CIR; GET.T.NAME
   449	   IF MUDUP(CHECK) = THERE THEN ERROR(NAME.IN.MUD) ELSE &
   450		ERROR(NAME.NT.MUD)
   451	
   452	
   453	LIST: GETTOKEN(ALPHA)
   454	   IF TMP _ CHOOSE(N.LISTS,L.CMDS) = NOT.THERE THEN WHAT
   455	   EIF TMP = L.USER THEN DO
   456		FIND.NAME
   457		CK.NAME
   458		PPN.OUT
   459		MSG('$DISTRICT: '); NUMOUT(LUD(WD.DIST))
   460		MSG('$PRIV: ')
   461		   IF ACCT.SUP.BIT(LUD(WD.PRIV)) = THERE THEN MSG('ACCT. SUP ')
   462		   IF TYMSH.BIT(LUD(WD.PRIV)) = THERE THEN MSG('TYM')
   463		MSG('$MODE: '); MSG(@MODES(MODE.BITS(WD.PRIV)))
   464		INDEX _ WD.STRN; TMP _ 0
   465		   IF INIT.BIT = 1 THEN [INDEX+_SIZE.INIT.INF; TMP_SIZE.INIT.INF]
   466		   TMP _ ((SIZE.LUD.ENT-TMP)-WD.STRN)/SIZE.STR.INF
   467		   REPEAT TMP DO
   468			MSG('STRUCTURE: ')
   469			P1 _ BYPT(L.BLK+L.INDEX+INDEX,1,6)
   470			REPEAT 4 CHR.OUT(NCHV P1 + OCT 40)
   471			MSG('$QUOTA IN: '); NUMOUT(LUD(INDEX+1))
   472			MSG('$QUOTA OUT: '); NUMOUT(LUD(INDEX+2))
   473		   END
   474	   END
   475	   ORIF TMP = L.PROJECT THEN DO
   476		GET.GAN
   477		IO.ADR _ GETCMD
   478		LOKUP.LUD(IN.READ); LUD.READ
   479		LOOP DO
   480		   LUD.SEQ
   481		   IF HW(@LUD(WD.PPN),0) = GAN THEN DO
   482			IF DUL.LOOK = THERE THEN NAME.OUT(D.BLK+D.INDEX+WD.NAME)
   483		   END
   484		END
   485	   END
   486	ELSE WHAT
   487	
   488	QUIT: EXIT
   489	
   490	REMOVE: IN.VAL.UF _ U.REMOVE; GO DELETE.U
   491	
   492	DELETE.U: INVALIDATE:  CK.A.CIR; CK.M.CIR
   493	   FIND.NAME
   494	   CK.NAME
   495	   IF LUD(WD.PPN) = OCT 1000001 OR LUD(WD.PPN) = OCT 1000004 THEN ERROR(BAD.NAME)
   496	   CHECK.OK
   497	   MAKE.LUD.CHG(LUD(WD.HASH) _ 0)
   498	   DEL.FILES
   499	   IF THIS.SYS # ACCT.SYS THEN DO
   500		SEND.ACT(NUM,DEL.USR,1)
   501		SEND.SYS.AND.NAME
   502		GET.CIR(ACCT.CIR,1)
   503	   END ELSE ANS(0) _ O.LUDUPD(DEL.USR)
   504	   IF ANS # OK THEN DO
   505		IF IN.VAL.UF = U.CANCEL THEN MUDUP(REVERSE)
   506		MAKE.VALID
   507	   END ELSE BILL.USER(DEL.USR)
   508	   IF IN.VAL.UF = U.CANCEL THEN MUDUP(DEL.USR)
   509	    ERROR(ANS)
   510	
   511	ADD: NEW.USERF _ ADD.U;GO VALUSER
   512	
   513	VALIDATE: VALUSER: CK.A.CIR; CK.M.CIR
   514	   FIND.NAME
   515	   IF FOUND # THERE THEN ERROR(NAME.IN.LUD)
   516	   IF TMP _ MUDUP(GET.M) # THERE THEN DO
   517		IF NEW.USERF = ADD.U THEN ERROR(NAME.NT.MUD)
   518	   END ELSE IF NEW.USERF = NOT.THERE THEN ERROR(NAME.IN.MUD)
   519	   L.SAVE(WD.HASH) _ NAME.HASH
   520	   IF TMP = 0 THEN DO
   521		GET.GAN
   522		MSG('UUN: '); UUN _ HW(@L.SAVE(WD.PPN),1) _ GETOCT
   523		GET.DIST; BYT(L.SAVE(WD.DIST),8,0) _ DIST
   524		GET.P.BITS; L.SAVE(WD.PRIV) _ PRIV
   525	   END ELSE DO
   526		GAN _ HW(@L.SAVE(WD.PPN),0) _ BYT(MUD(M.GAN),20,0)
   527		UUN _ HW(@L.SAVE(WD.PPN),1) _ BYT(MUD(M.UUN),17,0)
   528		DIST _ BYT(L.SAVE(WD.DIST),8,0) _ BYT(MUD(M.CPARW),9,0) SHR 2
   529		ACCT.SUP.BIT(PRIV) _ BYT(MUD(M.CPARW),1,19)
   530		TYM.SH.BIT(PRIV) _ BYT(MUD(M.CPARW),1,23)
   531		GET.MODE
   532		L.SAVE(WD.PRIV) _ PRIV
   533	   END
   534	   BYT(L.SAVE(WD.SIZE),7,0) _ SIZE.NEW.ENT
   535	   GET.STR.INF
   536	   FILL.IN.LUD.INF
   537	   CHECK.OK
   538	   IF NEW.USERF = NEW.U THEN DO
   539		GET.PASS
   540		MUDUP(ADD.USR)
   541	   END ELSE MUDUP(CH.COMMON)
   542	   FIND.L.ROOM
   543	   IF DUL.LOOK = THERE THEN DO
   544		IF NEW.USERF = NEW.U THEN MUDUP(DEL.USR)
   545		ERROR(NAME.IN.DUL)
   546	   END
   547	   MAKE.LUD.CHG(FILL.IN.LUD.INF)
   548	   FIND.D.ROOM	
   549	   MAKE.DUL.CHG(DUL(WD.PPN) _ LUD(WD.PPN); MOVE 2 FROM USER TO @DUL(WD.NAME))
   550	   IF THIS.SYS # ACCT.SYS THEN DO
   551		SEND.ACT(NUM,ADD.USR,1)
   552		SEND.SYS.AND.NAME
   553		SEND.ACT(NUM,GAN,3)
   554		SEND.ACT(NUM,UUN,3)
   555		SEND.ACT(NUM,DIST,1)
   556		SEND.ACT(NUM,PRIV,3)
   557		SEND.ACT(NUM,STRINF+1,3)
   558		SEND.ACT(NUM,STRINF+2,3)
   559		GET.CIR(ACCT.CIR,1)
   560	   END ELSE ANS(0) _ O.LUDUPD(ADD.USR)
   561	   IF ANS # OK THEN DO
   562		IF NEW.USERF = NEW.U THEN MUDUP(REVERSE)
   563		IN.VAL.DUL
   564		IN.VAL.LUD
   565	   END ELSE BILL.USER(ADD.USR)
   566	   ERROR(ANS)
   567	
   568	CHANGE: GETTOKEN(ALPHA)
   569	   IF CHG _ CHOOSE(N.CHANGES,CH.CMDS) = 0 THEN WHAT
   570	   DO CHG OF 1:N.CHANGES
   571	
   572	CH.HOME: CK.M.CIR; GET.T.NAME
   573	   IF MUDUP(GET.M) # THERE THEN ERROR(NAME.NT.MUD)
   574	   GET.NEW; GET.H.SITE
   575	   CHECK.OK; MUDUP(CH.HOME)
   576	
   577	CH.PASS: CK.M.CIR; GET.T.NAME
   578	   IF MUDUP(GET.M) # THERE THEN ERROR(NAME.NT.MUD)
   579	   GET.NEW; GET.PASS
   580	    MUDUP(CH.PASSW)
   581	
   582	CH.PRIV: CK.M.CIR; CK.A.CIR
   583	   FIND.NAME
   584	   CK.NAME
   585	   GET.P.BITS
   586	   MAKE.CHG(LUD(WD.PRIV) _ PRIV)
   587	   MUDUP(CH.PRIV)
   588	   IF THIS.SYS = ACCT.SYS THEN DO
   589		SEND.ACT(NUM,CH.PRIV,1)
   590		SEND.SYS.AND.NAME
   591		SEND.ACT(NUM,PRIV,3)
   592		GET.CIR(ACCT.CIR,1)
   593	   END ELSE ANS(0) _ O.LUDUPD(CH.PRIV)
   594	   ERROR(ANS)
   595	
   596	CH.STR: CK.A.CIR; FIND.NAME
   597	   IF FOUND # THERE THEN ERROR(NAME.NT.LUD)
   598	   STR.INF(WD.STRN) _ DSKB
   599	   IF FIND.STR # THERE THEN ERROR(STR.NT.THERE)
   600		GET.STR.INF
   601		MAKE.CHG(MOVE SIZE.STR.INF FROM STRINF TO @LUD(INDEX))
   602	   IF THIS.SYS = ACCT.SYS THEN DO
   603		SEND.ACT(NUM,CH.STR,1)
   604		SEND.SYS.AND.NAME
   605		SEND.ACT(NUM,STRINF+1,3)
   606		SEND.ACT(NUM,STRINF+2,3)
   607		GET.CIR(ACCT.CIR,1)
   608	   END ELSE ANS(0) _ O.LUDUPD(CH.STR)
   609	   ERROR(ANS)
   610	
   611	CH.DIST: CK.M.CIR; CK.A.CIR;  FIND.NAME
   612	   CK.NAME
   613	   GET.NEW
   614	   GET.DIST
   615	   MAKE.CHG(DIST.BITS _ DIST)
   616	   MUDUP(CH.DIST)
   617	   IF THIS.SYS = ACCT.SYS THEN DO
   618		SEND.ACT(NUM,CH.DIST,1)
   619		SEND.SYS.AND.NAME
   620		SEND.ACT(NUM,DIST,1)
   621		GET.CIR(ACCT.CIR,1)
   622	   END ELSE ANS(0) _ O.LUDUPD(CH.DIST)
   623	   IF ANS # OK THEN DO
   624		MUDUP(REVERSE)
   625		MAKE.LUD.CHG(DIST.BITS _ BYT(L.SAVE(WD.DIST),8,0))
   626	   END
   627	   ERROR(ANS)
   628	
   629	CH.RUB: CK.A.CIR; FIND.NAME
   630	   IF FOUND # THERE THEN  ERROR(NAME.NT.LUD)
   631	   SET.RUB
   632	   MAKE.CHG(RUB.BIT _ RUB)
   633	   IF THIS.SYS = ACCT.SYS THEN DO
   634		SEND.ACT(NUM,CH.RUB,1)
   635		SEND.SYS.AND.NAME
   636		SEND.ACT(NUM,RUB,1)
   637		GET.CIR(ACCT.CIR,1)
   638	   END ELSE ANS(0) _ O.LUDUPD(CH.RUB)
   639	   IF ANS # OK THEN MAKE.LUD.CHG(RUB.BIT_BYT(L.SAVE(WD.RUB),1,33))
   640	   ERROR(ANS)
   641	
   642	CH.NAME: FIND.NAME
   643	   CK.NAME
   644	   MOVE 2 FROM USER TO OLDNAME
   645	   GET.NEW; GET.T.NAME; GET.PASS; MUDUP(CH.NAME)
   646	   MAKE.CHG(LUD(WD.HASH) _ 0)
   647	   SAVE.OLD
   648	   IF LUD.LOOK = THERE THEN DO
   649		RESTORE
   650		MAKE.VALID
   651		MUDUP(REVERSE)
   652		ERROR(NAME.IN.LUD)
   653	   END
   654	   FIND.L.ROOM
   655	   LUD(WD.PPN) _ L.SAVE(WD.PPN)
   656	   EXCH.OLD.NEW.N
   657	   IF DUL.LOOK = NOT.THERE THEN DO
   658		RESTORE
   659		MAKE.VALID
   660		MUDUP(REVERSE)
   661		ERROR(NAME.NT.DUL)
   662	   END
   663	   EXCH.OLD.NEW.N
   664	   MAKE.DUL.CHG(MOVE 2 FROM USER TO @DUL(WD.NAME))
   665	   MAKE.LUD.CHG(MOVE O.ENT.SIZE FROM L.SAVE TO @LUD(WD.PPN))
   666	   IF THIS.SYS = ACCT.SYS THEN DO
   667		SEND.ACT(NUM,CH.NAME,1)
   668		SEND.ACT(ALPHA,OLDNAME,12)
   669		SEND.ACT(NUM,THISSYS,1)
   670		SEND.ACT(ALPHA,USER,12)
   671		GET.CIR(ACCT.CIR,1)
   672	   END ELSE ANS(0) _ O.LUDUPD(CH.NAME)
   673	   IF ANS # OK THEN DO
   674		MUDUP(REVERSE)
   675		IN.VAL.LUD
   676		RESTORE
   677		MAKE.VALID
   678		MAKE.DUL.CHG(MOVE 2 FROM OLD.NAME TO @DUL(WD.NAME))
   679	   END ELSE BILL.USER(CH.NAME)
   680	   ERROR(ANS)
   681	
   682	END
   683	END
   684	GO GETCMD
   685	
   686	BAD.CHR: WHAT
   687	
   688	
   689	
   690	
   691	%INITUPD
   692	LOCAL TENS,ONES
   693	IOCS(2)
   694	IF EXU(OCT 47,0,OCT 24,0) # CUD10.PPN THEN EXIT
   695	!SET THIS.LIC
   696	THIS.SYS _ 31	!LATER, SET SITE HERE
   697	IF TTYF # CIR THEN DO
   698	   INITTTY(BAD.CHR)
   699	   CH.OUT _ OPEN('TEL', SEQUEN+OUTPUT+CHARACTER,0,2)
   700	   MOVE 72/CHARS.PER.WORD FROM ALL 0 TO TOKEN
   701	   MSG('$LUD UPDATER - VERSION ; DATOUT'); NUMOUT(VERSION)
   702	   DATE _ EXU(OCT 47,OCT 1,OCT 14)
   703	   [TMP;DAY] _ DATE DIVMOD 31
   704	   [TENS;ONES] _ DATE DIVMOD 10
   705	   TT.EXT _ (TENS + $0 SHL 6) BAND ONES + $0
   706	   P1 _ CHPT('(CUD10)TTFILE',-1)
   707		SETFID(IOTAB,@P1,0,CHKERR)
   708		TTFNAME _ NAMARG(IOTAB)
   709	   GET.M.CIR
   710	   GET.A.CIR
   711	END ELSE DO
   712	   C.IMGIO(SET.UP.TTY,0)
   713	   FOR TMP _ 1 TO 4 C.IMGIO(SEND,TMP)
   714	   TMP _ 0
   715	   WHILE INC TMP < 5 THEN DO
   716		C.IMGIO(RECEIVE,0)
   717		IF CHR # TMP THEN TMP _ 0
   718	   END
   719	END
   720	P1 _ CHPT('(CUD10)LUD.31',-1)
   721	   SETFID(IOTAB,@P1,0,CHK.ERR)
   722	   LUD.NAME _ NAMARG(IOTAB)
   723	   SITE.31.NAME _ HW(@EXTARG(IOTAB),0)
   724	P1 _ CHPT('(CUD10)DUL.UFD',-1)
   725	   SETFID(IOTAB,@P1,0,CHKERR)
   726	   DUL.NAME _ NAMARG(IOTAB)
   727	   UFD _ HW(@EXTARG(IOTAB),0)
   728	INDEX _ D.LOC _ D.OV.BLK.N _ TMP _ CODE _ OLD.NAME(0) _ 0
   729	OLD.NAME(1) _ L.OLD.INDEX _ LOC.OLD.HASH _ O.ENT.SIZE _ OLD.HASH _ 0
   730	FOUND _ N.OFFICIAL _ SITE _ 0
   731	RETURN
   732	END INIT.UPD
   733	
   734	
   735	
   736	%O.LUDUPD(CODE)	!UPDATE NON STANDARD LUD/DUL
   737	LOCAL SITE
   738	N.OFFICIAL _ 1
   739	IF TTYF = CIR THEN DO 
   740	   G.CIR.NUM; CODE _ NUMBER
   741	   G.CIR.NUM; SITE _ NUMBER
   742	   GET.C.NAME
   743	END ELSE SITE _ ACCT.SYS
   744	DO CODE OF MIN.CMD: MAX.CMD
   745	
   746	DEL.USR: IF FOUND # THERE THEN RETURN NAME.NT.LUD
   747	   MAKE.LUD.CHG(LUD(WD.HASH) _ 0)
   748	
   749	CH.PRIV: IF FOUND # THERE THEN RETURN NAME.NT.LUD
   750	   IF TTYF = CIR THEN [G.CIR.NUM; PRIV _ NUMBER]
   751	   MAKE.LUD.CHG(LUD(WD.PRIV) _ PRIV)
   752	
   753	CH.STR:  IF FOUND # THERE THEN RETURN NAME.NT.LUD
   754	   STRINF(WD.STRN) _ DSKB
   755	   IF FIND.STR # THERE THEN RETURN STR.NT.THERE
   756	   IF TTYF = CIR THEN GET.STR.INF
   757	   MAKE.LUD.CHG(MOVE SIZE.STR.INF FROM STRINF TO @LUD(INDEX))
   758	
   759	CH.DIST: IF FOUND # THERE THEN RETURN NAME.NT.LUD
   760	   IF TTY = CIR THEN [C.IMGIO(RECEIVE,0); DIST _ NUMBER]
   761	   MAKE.LUD.CHG(DIST.BITS _ DIST)
   762	
   763	CH.RUB: IF FOUND # THERE THEN RETURN NAME.NT.LUD
   764	   IF TTY = CIR THEN [C.IMGIO(RECEIVE,0); RUB _ NUMBER]
   765	   MAKE.LUD.CHG(RUB.BIT _ RUB)
   766	
   767	ADD.USR: IF FOUND = THERE THEN RETURN NAME.IN.LUD
   768	   FIND.L.ROOM
   769	   IF TTYF = CIR THEN DO
   770		L.SAVE(WD.HASH) _ NAME.HASH
   771		G.CIR.NUM; HW(@L.SAVE(WD.PPN),0) _ NUMBER
   772		G.CIR.NUM; HW(@L.SAVE(WD.PPN),1) _ NUMBER
   773		BYT(L.SAVE(WD.SIZE),7,0) _ SIZE.NEW.ENT
   774		GET.DIST; BYT(L.SAVE(WD.DIST),8,0) _ DIST
   775		GET.P.BITS; L.SAVE(WD.PRIV) _ PRIV
   776		GET.STR.INF
   777	    END
   778	   MAKE.LUD.CHG(MOVE SIZE.NEW.ENT FROM L.SAVE TO @LUD(WD.PPN);&
   779		MOVE SIZE.STR.INF FROM STRINF TO @LUD(WD.STRN))
   780	   IF DUL.LOOK = THERE THEN [IN.VAL.LUD; RETURN NAME.IN.DUL]
   781	   FIND.D.ROOM
   782	   MAKE.DUL.CHG(MOVE 2 FROM USER TO @DUL(WD.NAME); DUL(WD.PPN) _ LUD(WD.PPN))
   783	
   784	CH.NAME: IF TTYF = CIR THEN [OLDNAME(0) _ USER(0); &
   785		OLDNAME(1) _ USER(1)]
   786	   IF FOUND _ LUD.LOOK = THERE THEN RETURN NAME.IN.LUD
   787	   IF TTYF = CIR THEN DO
   788		G.CIR.WD(USER,12)
   789		SAVE.OLD
   790	   END
   791	   MAKE.LUD.CHG(LUD(WD.HASH) _ 0)
   792	   IF LUD.LOOK = THERE THEN DO
   793		RESTORE
   794		MAKE.VALID
   795		RETURN NAME.IN.LUD
   796	   END
   797	   FIND.L.ROOM
   798	   LUD(WD.PPN) _ L.SAVE(WD.PPN)
   799	   OLDNAME(0) <=> USER(0)
   800	   OLDNAME(1) <=> USER(1)
   801	   IF DUL.LOOK # THERE THEN DO
   802		RESTORE
   803		MAKE.VALID
   804		RETURN NAME.NT.DUL
   805	   END
   806	   OLDNAME(0) <=> USER(0)
   807	   OLDNAME(1) <=> USER(1)
   808	   MAKE.DUL.CHG(MOVE 2 FROM USER TO @DUL(WD.NAME))
   809	   MAKE.LUD.CHG(MOVE O.ENT.SIZE FROM L.SAVE TO @LUD(WD.PPN))
   810	END
   811	RETURN OK
   812	END  O.LUDUPD
   813	
   814	
   815	%LOKUP.LUD(MODE)
   816		!MODE = READ OR UPDATE
   817	IF N.OFFICIAL = 0 THEN DO
   818	   IF MODE = IN.READ THEN CH.LUD _ OPEN('(NICRAM)LUD.SYS',DIRECT+INPUT+WORD,CHK.ERR)&
   819		ELSE CH.LUD _ OPEN('(NICRAM)LUD.SYS',DIRECT+UPDATE+WORD,CHK.ERR)
   820	END ELSE DO
   821	   NAMARG(IOTAB) _ LUD.NAME
   822	   SET.SITE
   823	   IF MODE = IN.READ THEN CH.LUD _ OPEN(-IOTAB,DIRECT+INPUT+WORD,CHK.ERR)&
   824		ELSE CH.LUD _ OPEN(-IOTAB,DIRECT+UPDATE+WORD,CHK.ERR)
   825	END
   826	SIZE.LUD _ N.LUD.BLKS
   827	RETURN
   828	END LOKUP.LUD
   829	
   830	
   831	%LOKUP.DUL(MODE)
   832	IF N.OFFICIAL = 0 THEN DO
   833	IF MODE = IN.READ THEN CH.DUL _ OPEN('(NICRAM)DUL.SYS',DIRECT+INPUT+WORD,CHK.ERR)&
   834		ELSE CH.DUL _ OPEN('(NICRAM)DUL.SYS',DIRECT+UPDATE+WORD,CHK.ERR)
   835	END ELSE DO
   836	   NAMARG(IOTAB) _ DUL.NAME
   837	   SET.SITE
   838	   IF MODE = IN.READ THEN CH.DUL _ OPEN(-IOTAB,DIRECT+INPUT+WORD,CHK.ERR)&
   839		ELSE CH.DUL _ OPEN(-IOTAB,DIRECT+UPDATE+WORD,CHK.ERR)
   840	END
   841	SIZE.DUL _ N.DUL.BLKS
   842	RETURN
   843	END LOKUP.DUL
   844	
   845	
   846	%LUD.LOOK
   847		!LOOKUP USER,USER+1 IN LUD
   848	HASH(USER(0),USER(1)); L.OV.BLK.N _ 0
   849	LOKUP.LUD(IN.READ)
   850	SETCP(CH.LUD,FIXCP(LOC.HASH)); LUD.READ; CLOSE(CH.LUD)
   851	WHILE LUD(WD.HASH) # NAME.HASH THEN DO
   852	   EIF LUD(WD.PPN) = 0 THEN RETURN NOT.THERE
   853	   ORIF LUD(WD.PPN) < 0 THEN LUD.OVER
   854	   ELSE L.INDEX + _ SIZE.LUD.ENT
   855	END
   856	RETURN THERE
   857	END LUD.LOOK
   858	
   859	
   860	
   861	%DUL.LOOK
   862	D.LOC _ LUD(WD.PPN) MOD 101 + 1
   863	D.OV.BLK.N _ 0
   864	LOKUP.DUL(IN.READ)
   865	SETCP(CH.DUL,FIXCP(D.LOC))
   866	DUL.READ; CLOSE(CH.DUL)
   867	WHILE DUL(WD.PPN) # LUD(WD.PPN) THEN DO
   868	   IF DUL(WD.PPN) = 0 THEN RETURN NOT.THERE
   869	   IF DUL(WD.PPN) < 0 THEN DUL.OVER
   870	   D.INDEX + _ SIZE.DUL.ENT
   871	END
   872	RETURN THERE
   873	END DUL.LOOK
   874	
   875	
   876	%CHK.IO.ERR
   877	CHK.ERR: IF ERRNUM = EOFERR AND IO.ADR # 0 THEN GO ^IO.ADR
   878	   IF TTYF = CIR THEN ERROR(SIMPL.ERR)
   879	   MSG('$ERROR ON '); WFID(FIDP); CR
   880	   DO ERRNUM OF TMFERR:CORERR
   881	TMFERR: MSG('TOO MANY FILES OPEN')
   882	FMDERR: MSG('BAD FILE MODE OR TYPE')
   883	IFDERR: MSG('ILLEGAL FILE ID')
   884	FNFERR: MSG('FILE NOT FOUND')
   885	IUSERR: MSG('INVALID USER NAME')
   886	PRTERR: MSG('PROTECTION FAILURE')
   887	EOFERR: MSG('END OF FILE')
   888	   END
   889	   MSG('.$ ERROR '); NUMOUT(ERRNUM); ERROR(SIMPL.ERR); EXIT
   890	END CHK.IO.ERR
   891	
   892	
   893	%T.ERROR(A)
   894	OUT(ERRTAB(A)); CR
   895	CLOSE(CH.OUT)
   896	CH.OUT _ OPEN('TEL',SEQUEN+OUTPUT+CHARACTER,0,2)
   897	ERROR(A)
   898	RETURN
   899	END T.ERROR
   900	
   901	
   902	%ERROR(NUMB)
   903	IF TTYF = CIR THEN DO
   904	   C.IMGIO(SEND,NUMB)
   905	   IF NUMB = BAD.CODE THEN C.IMGIO(SEND,CODE)
   906	   IF NUMB = SIMPL.ERR THEN C.IMGIO(SEND,ERRNUM)
   907	   EXIT
   908	END ELSE DO
   909	   OUT(ERRTAB(NUMB)); CR
   910	   GO GETCMD
   911	END
   912	END ERROR
   913	
   914	
   915	%LUD.SEQ
   916	LOOP DO
   917	   L.INDEX + _ SIZE.LUD.ENT
   918	   IF LUD(WD.PPN) < 0 THEN LUD.OVER
   919	   WHILE LUD(WD.PPN) <= 0 THEN LUD.READ
   920	   IF LUD(WD.HASH) # 0 THEN RETURN
   921	END
   922	END LUD.SEQ
   923	
   924	
   925	%FIND.STR
   926	!FIND STR IN STRINF IN LUD,
   927	!IF FOUND, LOC IN INDEX UPDON RETURN
   928	INDEX _ WD.STRN
   929	WHILE LUD(INDEX) # STRINF(WD.S.NAME) THEN DO
   930	   INDEX + _ SIZE.STR.INF
   931	   IF INDEX >=SIZE.LUD.ENT THEN RETURN NOT.THERE
   932	END
   933	RETURN THERE
   934	END FIND.STR
   935	
   936	
   937	%FIND.L.ROOM
   938	!MAKE ROOM FOR NEW ENTRY (SIZE.NEW.ENT WDS)
   939	!CREATE OVERFLOW IF NECESSARY
   940	L.INDEX _ 0
   941	LOOP DO
   942	   EIF LUD(WD.PPN) = 0 THEN DO
   943		IF L.INDEX + SIZE.NEW.ENT <= SIZE.BLK-1 THEN RETURN
   944		MAKE.L.OVER; RETURN
   945	     END
   946	   ORIF LUD(WD.PPN) < 0 THEN LUD.OVER
   947	   ORIF LUD(WD.HASH) = 0 THEN DO
   948		IF SIZE.LUD.ENT = SIZE.NEW.ENT THEN RETURN
   949		MOVE SIZE.BLK-(L.INDEX+SIZE.LUD.ENT) FROM @LUD(SIZE.LUD.ENT)&
   950		TO @LUD(SIZE.LUD.ENT-SIZE.NEW.ENT)
   951		RETURN
   952	     END
   953	   ELSE L.INDEX+_SIZE.LUD.ENT
   954	END
   955	END FIND.L.ROOM
   956	
   957	
   958	%MAKE.L.OVER
   959	L.BLK.UP
   960	SIZE.LUD _ GET.L.OV.BLK _ L.OV.BLK.N _ SIZE.LUD + 1
   961	OV.L.BIT _ OV.BIT; LUD.CL
   962	MOVE SIZE.BLK FROM ALL 0 TO @LUD(WD.PPN)
   963	LOKUP.LUD(IN.UPDATE)
   964	SETCP(CH.LUD,FIXCP(SIZE.LUD))
   965	LUD.CL
   966	L.INDEX _ 0
   967	RETURN
   968	END MAKE.L.OVER
   969	
   970	
   971	%MAKE.D.OVER
   972	D.BLK.UP; SIZE.DUL _ GET.D.OV.BLK _ D.OV.BLK.N _ SIZE.DUL + 1
   973	OV.D.BIT _ OV.BIT; DUL.WRIT
   974	MOVE SIZE.BLK FROM ALL 0 TO @DUL(WD.PPN)
   975	LOKUP.DUL(IN.UPDATE); SETCP(CH.DUL,FIXCP(SIZE.DUL))
   976	DUL.WRIT
   977	D.INDEX _ 0
   978	RETURN
   979	END MAKE.D.OVER
   980	
   981	
   982	
   983	%DELFILES
   984	LOCAL CH.UFD, UFDBLK(SIZE.BLK)
   985	LOCAL  HIGHJOB, ACC, USR.TAB(WPF)
   986	ERRNUM _ 0
   987	ACC _ OCT 20000012
   988	HIGHJOB _ CALL.UUO(ACC)
   989	WHILE DEC HIGH.JOB >= 0 THEN DO
   990	   HW(ACC,0) _ HIGHJOB + 1; HW(ACC,1) _ 2
   991	   IF CALL.UUO(ACC) = LUD(WD.PPN) THEN T.ERROR(DEL.ERR)
   992	END
   993	PPNARG(IOTAB) _ OCT 1000001; NAMARG(IOTAB) _ LUD(WD.PPN)
   994	EXTARG(IOTAB) _ UFD
   995	CH.UFD _ OPEN(-IOTAB,DIRECT+INPUT+WORD,CHK.ERR)
   996	PPNARG(IOTAB) _ LUD(WD.PPN)
   997	UFD.READ
   998	WHILE NAMARG(USR.TAB) _ UFD.BLK(INDEX) # 0 THEN DO
   999	   IF INDEX >= HIGH.UFD.INDEX THEN UFD.READ ELSE DO
  1000		HW(@EXTARG(USR.TAB),0) _ HW(@UFD.BLK(INDEX+1),0)
  1001		DELETE(-USR.TAB,CHK.ERR)
  1002		INDEX + _ SIZE.UFD.ENT
  1003	    END
  1004	END
  1005	END.UFD: DELETE(-IOTAB,CHK.ERR)
  1006	IF TTYF = CIR THEN DO
  1007	   C.IMGIO(SEND,1)
  1008	   SEND.O.WD('$PPN: ',^L.BLK+L.INDEX+WD.PPN)
  1009	END
  1010	RETURN
  1011	END DELFILES
  1012	
  1013	
  1014	%CALL.UUO(AC)
  1015	LOCAL DIDIT:
  1016	TMP _ EXU(OCT 47,AC,OCT 41,DIDIT)
  1017	ERROR(BAD.UUO)
  1018	DIDIT: RETURN TMP
  1019	END CALL.UUO
  1020	
  1021	
  1022	
  1023	%GET.STR.INF
  1024	 STRINF(WD.STRN)_'DSKB'
  1025	GET.NUM.INF('QUOTA IN: '); STRINF(WD.QOUT) _ NUMBER
  1026	GET.NUM.INF('QUOTA OUT: '); STRINF(2) _ NUMBER
  1027	RETURN
  1028	END GET.STR.INF
  1029	
  1030	
  1031	%SEND.O.WD(A,B)
  1032	IF TTYF # CIR THEN DO
  1033	   MSG(A)
  1034	   OCTOUT(HW(B,0))
  1035	   CHR.OUT($,)
  1036	   OCTOUT(HW(B,1))
  1037	END ELSE DO
  1038	   TMP _ HW(B,0)
  1039	   C.IMGIO(SEND,TMP)
  1040	   TMP _ HW(B,1)
  1041	   C.IMGIO(SEND,TMP)
  1042	END
  1043	RETURN
  1044	END SEND.O.WD
  1045	
  1046	
  1047	
  1048	%GET.P.BITS
  1049	IF TTYF = CIR THEN DO
  1050	   G.CIR.NUM
  1051	   PRIV _ NUMBER
  1052	   RETURN
  1053	END
  1054	PRIV _ 0
  1055	ACCT.SUP.BIT(PRIV) _ QUERY('ACCOUNT SUPERVISOR')
  1056	TYMSH.BIT(PRIV) _ QUERY('TYMSHARE')
  1057	GET.MODE
  1058	RETURN
  1059	END GET.P.BITS
  1060	
  1061	
  1062	
  1063	%GET.MODE
  1064	LOCAL MODE
  1065	LOOP DO
  1066		MSG('MODE: '); GETTOKEN(ALPHA)
  1067		IF MODE _ CHOOSE(N.MODES,MODES) # 0 THEN DO
  1068		  MODE.BITS(PRIV) _ MODE -1
  1069		RETURN
  1070	END
  1071	MSG('$VALID MODES ARE: '); LISTABLE(N.MODES,MODES)
  1072	CR
  1073	END
  1074	END GET.MODE
  1075	
  1076	
  1077	
  1078	
  1079	%GET.CIR(N)
  1080	LOCAL GOOD:
  1081	HW(TMP,0) _ ACCT.CIR; HW(TMP,1) _ 0
  1082	P1 _ BYPT(ANS,24,8)
  1083	REPEAT 3-N NCHV P1
  1084	NCHV P1 _ EXU(OCT 42,TMP,ANS,GOOD)
  1085	   ERROR(AUX.ERR)
  1086	GOOD: RETURN
  1087	END GET.CIR
  1088	
  1089	
  1090	
  1091	%SEND.MUD(WD,N)
  1092	P1 _ BYPT(WD,24,8)
  1093	REPEAT 3-N NCHV P1
  1094	SEND.CIR(MUD.CIR,N)
  1095	RETURN
  1096	END SEND.MUD
  1097	
  1098	
  1099	
  1100	
  1101	%SEND.ACT(TYPE,WD,N)
  1102	IF TYPE = NUM THEN DO
  1103	   P1 _ BYPT(WD,24,8)
  1104	   REPEAT 3-N NCHV P1
  1105	END ELSE P1 _ BYPT(WD,6,0)
  1106	SEND.CIR(ACCT.CIR,N)
  1107	RETURN
  1108	END SEND.ACT
  1109	
  1110	
  1111	
  1112	%GET.M.CIR
  1113	IF MUD.CIR = THERE THEN RETURN
  1114	STRING _ IN.STR.940
  1115	BUILD
  1116	IF MUD.CIR _ A.CHAN < 0 THEN ERROR(AUX.ERR)
  1117	RETURN
  1118	END GET.M.CIR
  1119	
  1120	
  1121	
  1122	%GET.A.CIR
  1123	LOCAL CNT
  1124	IF ACCT.CIR = THERE THEN RETURN
  1125	STRING _ IN.STR.PDP
  1126	BUILD
  1127	IF ACCT.CIR _ A.CHAN < 0 THEN ERROR(AUX.ERR)
  1128	SEND.ACT(ALPHA,'$GET TENUPD$ST$',16)
  1129	CNT _ 0
  1130	WHILE INC CNT < 5 THEN DO
  1131	   GET.CIR(ACCT.CIR,1)
  1132	   IF ANS # CNT THEN CNT _ 0
  1133	END
  1134	FOR CNT _ 1 TO 4 SEND.ACT(NUM,CNT,1)
  1135	RETURN 
  1136	END GET.A.CIR
  1137	
  1138	
  1139	%CHECK.OK
  1140	LOCAL TT.ERR:
  1141	LIST.INF(0)
  1142	IF QUERY('$ALL ENTRIES CORRECT') = NO THEN CHANGE.ENT
  1143	NAMARG(IOTAB) _ TT.F.NAME
  1144	EXTARG(IOTAB) _ TT.EXT
  1145	CH.OUT _ OPEN(-IOTAB,DIRECT+UPDATE+CHARACTER,TT.ERR)
  1146	WRIT.IT: DAT.OUT
  1147		!OUTPUT NAME AND OPER NAME OF USER
  1148	LIST.INF(1)
  1149	RETURN
  1150	TT.ERR: IF ERRNUM # FNFERR THEN CHK.IO.ERR
  1151	CH.OUT _ OPEN(-IOTAB,DIRECT+OUTPUT+CHARACTER,CHK.ERR)
  1152	GO WRIT.IT
  1153	END CHECK.OK
  1154	
  1155	
  1156	
  1157	%LIST.INF(TTF)	!TTF = 1 IF TO TATTLE TALE FILE, 0 IF TO TTY
  1158	
  1159	DO CMD OF 1:N.I.CMDS
  1160	
  1161	INVALIDATE: DDTREMOVE:  IF TTF # 0 THEN DO
  1162	 	IF CMD = REMOVE THEN OUT('$REMOVE PDP10') ELSE OUT('$CANCEL USER')
  1163	   END
  1164	   TT.USER.OUT
  1165	
  1166	ADD: VALIDATE: IF TTF # 0 THEN DO
  1167		IF CMD = ADD THEN OUT('$ADD PDP10') ELSE OUT('$NEW USER')
  1168	   END
  1169	   TT.USER.OUT
  1170	   TT.DIST.OUT
  1171	   TT.PRIV.OUT
  1172	   TT.STR.OUT
  1173	   IF TTF # 0 THEN PPN.OUT
  1174	
  1175	CHANGE: DO CHG OF 1:NCHANGES
  1176	
  1177	CH.HOME: IF TTF # 0 THEN OUT('$CHANGE HOME')
  1178	   TT.USER.OUT
  1179	   TT.HOME.OUT
  1180	
  1181	CH.PRIV: IF TTF # 0 THEN OUT('$CHANGE PRIVILIGES')
  1182	   TT.USER.OUT
  1183	   TT.PRIV.OUT
  1184	
  1185	CH.STR: IF TTF = 0 THEN OUT('$CHANGE STRUCTURE')
  1186	   TT.USER.OUT
  1187	   TT.STR.OUT
  1188	
  1189	CH.DIST: IF TTF = 0 THEN OUT('$CHANGE DISTRICT')
  1190	   TT.USER.OUT
  1191	   TT.DIST.OUT
  1192	
  1193	CH.RUB: IF TTF = 0 THEN OUT('$CHANGE RUB BIT')
  1194	   TT.USER.OUT
  1195	   TT.RUB.OUT
  1196	
  1197	CH.NAME: IF TTF = 0 THEN OUT('$CHANGE NAME')
  1198	   OUT('$1. OLD USER NAME: '); NAME.OUT(OLD.NAME)
  1199	   OUT('$7. NEW USER NAME: '); NAME.OUT(USER)
  1200	
  1201	END
  1202	END
  1203	RETURN
  1204	END LIST.INF
  1205	
  1206	
  1207	%CHANGE.ENT
  1208	LOCAL T.CHG, ER.FLG
  1209	ER.FLG _ 0	!STAYS ZERO IF USER TYPED LEGAL #
  1210	LOOP DO
  1211	   MSG('$WHICH ENTRY DO YOU WANT TO CHANGE??')
  1212	   T.CHG _ GETNUM
  1213	   DO CMD OF 1:N.I.CMDS
  1214	
  1215	REMOVE: INVALIDATE: GO GETCMD
  1216	
  1217	ADD: VALIDATE: IF T.CHG < 6 THEN DO T.CHG OF 1:5
  1218	1: GO GETCMD
  1219	2: GET.DIST; BYT(L.SAVE(WD.DIST),8,0) _ DIST; TT.DIST.OUT
  1220	3: GET.P.BITS; L.SAVE(WD.PRIV) _ PRIV; TT.PRIV.OUT
  1221	4: GET.STR.INF; TT.STR.OUT
  1222	END ELSE INC ERFLG
  1223	
  1224	CHANGE: DO CHG OF 1:N.CHANGES
  1225	CH.HOME: EIF T.CHG = 1 THEN GO GETCMD
  1226	   ORIF T.CHG = 5 THEN [GET.H.SITE; TT.HOME.OUT]
  1227	   ELSE INC ERFLG
  1228	
  1229	CH.PRIV: EIF T.CHG = 1 THEN GO GETCMD
  1230	   ORIF T.CHG = 3 THEN [GET.P.BITS; L.SAVE(WD.PPN) _ PRIV; TT.PRIV.OUT]
  1231	   ELSE INC ERFLG
  1232	
  1233	CH.STR: EIF T.CHG = 1 THEN GO GETCMD
  1234	   ORIF T.CHG = 4 THEN [GET.STR.INF; TT.STR.OUT]
  1235	   ELSE INC ERFLG
  1236	
  1237	CH.DIST: EIF T.CHG = 1 THEN GO GETCMD
  1238	   ORIF T.CHG = 2 THEN [GET.DIST; BYT(L.SAVE(WD.DIST),8,0)_DIST;TT.DIST.OUT]
  1239	   ELSE INC ERFLG
  1240	
  1241	CH.RUB: EIF T.CHG = 1 THEN GO GETCMD
  1242	   ORIF T.CHG = 6 THEN [SET.RUB; TT.RUB.OUT]
  1243	   ELSE INC ERFLG
  1244	
  1245	CH.NAME: GO GETCMD
  1246	END
  1247	END
  1248	IF ERFLG = 0 THEN DO
  1249		IF QUERY('$OKAY') = YES THEN DO
  1250		   IF QUERY('$ANOTHER') = NO THEN RETURN
  1251		END
  1252	   END
  1253	END
  1254	END CHANGE.ENT
  1255	
  1256	
  1257	%BILL.USER(KIND)
  1258	LOCAL CH.BILL,BILL.ERR:
  1259	TMP _ (KIND SHL 33) BAND DATE
  1260	CH.BILL _ OPEN('(NICRAM)LUDCHG.SYS',DIRECT+UPDATE+WORD,BILL.ERR)
  1261	SETCP(CH.BILL,SIZE(CH.BILL))
  1262	WRITE.BILL: W(CH.BILL,LUD(WD.PPN))
  1263		W(CH.BILL,TMP)
  1264		CLOSE(CH.BILL)
  1265		RETURN
  1266	BILL.ERR: IF ERRNUM # FNFERR THEN CHK.IO.ERR
  1267		CH.BILL _ OPEN('(NICRAM)LUDCHG.SYS',DIRECT+OUTPUT+WORD,CHK.ERR)
  1268		GO WRITE.BILL
  1269	END BILL.USER
  1270	
  1271	
  1272	
  1273	%MUDUP(KIND)
  1274	COMPRESS	!CONVERST NAME IN USER TO C.USER
  1275	CT _ 9
  1276	DO KIND OF DEL.USR:GET.M
  1277	
  1278	DELETE.M:NULL
  1279	DEL.USR: M.KIND _ M.DEL
  1280	   SEND.CT.AND.NAME
  1281	   MUD.GOOD
  1282	
  1283	CH.PASSW: M.KIND _ M.CH.PASSW; CT+_6
  1284	   SEND.CT.AND.NAME
  1285	   SEND.MUD(PASSW,6)
  1286	   MUD.GOOD
  1287	
  1288	ADD.USR: M.KIND _ M.NEW; CT+_15
  1289	   SEND.MUD(@CT,1)
  1290	   SEND.MUD(@M.KIND,1)
  1291	   SEND.MUD(PASSW,6)
  1292	   SEND.MUD(L.SAVE(WD.PPN),6)
  1293	   MAKE.CPARW; SEND.MUD(CPARW,3)
  1294	   SEND.MUD(C.USER,9)
  1295	   MUD.GOOD
  1296	
  1297	CH.NAME: M.KIND _ M.CH.NAME; CT+_9
  1298	   SEND.CT.AND.NAME
  1299	   EXCH.OLD.NEW.N
  1300	   COMPRESS
  1301	   SEND.MUD(C.USER,9)
  1302	   EXCH.OLD.NEW.N
  1303	   MUD.GOOD
  1304	
  1305	GET.M: GET.MUD.DATA
  1306	
  1307	CHECK: M.KIND _ M.CK.UNQE; SEND.CT.AND.NAME
  1308	   SEND.M.EOF
  1309	   GET.CIR(MUD.CIR,1)
  1310	   RETURN ANS
  1311	
  1312	CH.COM: GET.MUD.DATA
  1313	   IF BYT(MUD(M.CPARW),1,6) = 1 THEN RETURN
  1314	   BYT(MUD(M.CPARW),1,6) _ 1
  1315	   CPARW.CHG
  1316	
  1317	CH.PRIV: GET.MUD.DATA
  1318	   BYT(MUD(M.CPARW),1,19) _ ACCT.SUP.BIT(PRIV)
  1319	   BYT(MUD(M.CPARW),1,23) _ TYM.SH.BIT(PRIV)
  1320	   CPARW.CHG
  1321	
  1322	END
  1323	IF ANS # 1 THEN ERROR(MUD.ERR)
  1324	GET.CIR(MUD.CIR,1)
  1325	EIF ANS = NIM THEN ERROR(NAME.NT.MUD)
  1326	   ORIF ANS = AIM THEN ERROR(NAME.IN.MUD)
  1327	ORIF ANS = MFB THEN ERROR(MUD.BUSY)
  1328	ELSE ERROR(MUD.ERR)
  1329	END MUDUP
  1330	
  1331	
  1332	
  1333	%GET.MUD.DATA
  1334	M.KIND _ M.G.MUD
  1335	SEND.CT.AND.NAME
  1336	SEND.M.EOF
  1337	GET.CIR(MUD.CIR,1)
  1338	IF ANS = 0 THEN DO
  1339	   GET.CIR(MUD.CIR,3); MUD(M.GAN) _ ANS
  1340	   GET.CIR(MUD.CIR,3) ; MUD(M.UUN) _ ANS
  1341	   GET.CIR(MUD.CIR,3); MUD(M.CPARW) _ ANS
  1342	RETURN
  1343	END
  1344	END GET.MUD.DATA
  1345	
  1346	
  1347	
  1348	%COMPRESS
  1349	LOCAL N.CH,N.WD
  1350	P1 _ BYPT(USER,1,6)
  1351	N.CH _ N.WD _ 0
  1352	REPEAT 12 DO
  1353	   EIF CHR _ NCHV P1 = SIX.B($ ) THEN NULL
  1354	   ORIF SIX.B($A) <= CHR <= SIX.B($Z) THEN CHR-_32
  1355	   ORIF SIX.B($0) <= CHR <= SIX.B($9) THEN CHR+_15
  1356	ORIF CHR = SIX.B($-) THEN CHR _ 28
  1357	   ORIF CHR = SIX.B($.) THEN CHR _ 29
  1358	   ORIF CHR = SIX.B($/) THEN CHR _ 30
  1359	   ORIF CHR = SIX.B($:) THEN CHR _ 41
  1360	   ORIF CHR = SIX.B($@) OR CHR = SIX.B($*) THEN CHR _ 42
  1361	   ORIF CHR = SIX.B($') THEN CHR _ 43
  1362	   ELSE CHR _ 44
  1363	   EIF INC N.CH = 1 THEN C.USER(N.WD) _ CHR * 45
  1364	   ORIF N.CH = 2 OR N.CH = 3 THEN C.USER(N.WD) _ (C.USER(N.WD)+CHR)*45
  1365	   ELSE DO
  1366		C.USER(N.WD) + _ CHR
  1367		N.CH _ 0
  1368		INC N.WD
  1369		END
  1370	END
  1371	EIF C.USER(1) = 0 THEN FIRSTOF24(C.USER(0)) _ 1
  1372	ORIF C.USER(2) = 0 THEN FIRSTOF24(C.USER(1)) _ 1
  1373	ELSE NULL
  1374	RETURN
  1375	END COMPRESS
  1376	
  1377	
  1378	
  1379	%MAKE.CPARW
  1380	RETURN
  1381	END MAKE.CPARW
  1382	
  1383	
  1384	
  1385	%SEND.CIR(CIR.NO,TIMES)
  1386	LOCAL GOOD:
  1387	HW(TMP,0) _ CIR.NO; HW(TMP,1) _ 4
  1388	REPEAT TIMES DO
  1389	   EXU(OCT 42, TMP, NCHV P1, GOOD)
  1390		ERROR(AUX.ERR)
  1391	GOOD: NULL
  1392	END
  1393	RETURN
  1394	END SEND.CIR
  1395	
  1396	
  1397	END TENUPDATE

TENUPD
SYMBOL CROSS REFERENCE

A	   893#	   893	   894	   897	  1031#	  1031	  1033
AC	  1014#	  1014	  1016
ACC	   985#	   987	   988	   990	   991
ACCTCI	   218#	   492	   502	   513	   559	   582	   592	   596	   607	   611	   621	   629	   637	   671
	  1081	  1106	  1124	  1127	  1131
ACCTSU	   265#	   375	   461	   529	  1055	  1318
ACCTSY	   264#	   499	   550	   588	   602	   617	   633	   666	   743
ACHAN	   123#	  1116	  1127
ADD	   159#	   511	  1166	  1167	  1217
ADDU	   224#	   511	   517
ADDUSR	   142#	   540	   551	   560	   565	   767	  1288
AEFERR	    51#
AIM	   183#	  1326
ALPHA	   266#	   310	   359	   435	   453	   568	   668	   670	  1066	  1128
ALTLOC	    72#
ANS	   117#	   503	   504	   509	   560	   561	   566	   593	   594	   608	   609	   622	   623	   627
	   638	   639	   640	   672	   673	   680	  1082	  1084	  1132	  1281	  1286	  1295	  1303	  1310
	  1315	  1320	  1323	  1325	  1326	  1327	  1338	  1339	  1340	  1341
ARGCNT	    81#
ARGERR	    57#
AUXERR	   412#	  1085	  1116	  1127	  1390
B	  1031#	  1031	  1034	  1036	  1038	  1040
BADCHR	   125	   686#	   698
BADCOD	   408#	   905
BADNAM	   410#	   495
BADSIT	   404#	   574	  1226
BADUUO	   411#	  1017
BILLER	  1258#	  1260	  1266#
BILLFI	   405#
BILLUS	   133	   507	   565	   679	  1257#
BLOCK	    68
BUFDUM	    63
BUILD	   107	  1115	  1126
BYPT	   107	   469	   482	   740	   741	   750	   771	   772	  1025	  1026	  1050	  1082	  1092	  1103
	  1105	  1164	  1169	  1172	  1178	  1182	  1186	  1187	  1190	  1194	  1198	  1199	  1221	  1234
	  1350
CALLUU	   128	   988	   991	  1014#
CFN	    62#
CHANGE	   133	   160#	   568	  1142	  1175	  1207#	  1224
CHARAC	    25#	   308	   699	   896	  1145	  1151
CHBILL	  1258#	  1260	  1261	  1262	  1263	  1264	  1267
CHCMDS	   206#	   569
CHCOM	  1312	  1312#
CHCOMM	   153#	   541
CHDIST	   146#	   611	   616	   618	   622	   759	  1189	  1237
CHDUL	   116#	   549	   563	   664	   678	   782	   808	   833	   838	   841	   865	   866	   869	   972
	   973	   975	   976
CHECK	   163#	   448	   449	  1307
CHECKO	   133	   496	   537	   575	   586	   601	   615	   632	   646	  1139#
CHG	   114#	   569	   570	  1175	  1224
CHHOME	   148#	   572	   575	  1177	  1225
CHKERR	   112	   707	   721	   725	   818	   823	   833	   838	   877#	   995	  1001	  1005	  1151	  1267
CHKIOE	   130	   876#	  1150	  1266
TENUPD
SYMBOL CROSS REFERENCE

CHLUD	   118#	   478	   497	   506	   547	   564	   586	   601	   615	   625	   632	   639	   646	   650
	   659	   665	   675	   677	   747	   751	   757	   761	   765	   778	   780	   791	   794	   803
	   809	   818	   823	   826	   850	   853	   918	   919	   946	   959	   961	   964	   965
CHNAME	   143#	   642	   645	   667	   672	   679	   784	  1197	  1245	  1297
CHOOSE	   107	   436	   454	   569	  1067
CHOUT	   121#	   539	   579	   645	   699	   895	   896	  1145	  1151
CHPASS	   150#	   577	   577#	   580	  1283
CHPRIV	   144#	   582	   587	   589	   593	   749	  1181	  1229	  1317
CHR	   115#	   712	   713	   716	   717	   740	   741	   750	   760	   764	   771	   772	   904	   905
	   906	  1007	  1025	  1026	  1039	  1041	  1050	  1353	  1354	  1355	  1356	  1357	  1358	  1359
	  1360	  1361	  1362	  1363	  1364	  1366
CHROUT	   109	   458	   470	   482	   879	   894	   909	  1035	  1072	  1164	  1169	  1172	  1173	  1178
	  1182	  1186	  1187	  1190	  1194	  1198	  1199	  1221	  1234
CHRUB	   147#	   629	   634	   638	   763	  1193	  1241
CHSTR	   145#	   596	   603	   608	   753	  1185	  1233
CHUFD	   984#	   995	   997	   999
CIMGIO	   267#	   295	   712	   713	   716	   760	   764	   904	   905	   906	  1007	  1039	  1041
CIR	   216#	   298	   304	   432	   697	   739	   750	   756	   760	   764	   769	   784	   787	   878
	   903	  1006	  1032	  1049
CIRNO	  1385#	  1385	  1387
CKACIR	   268#	   492	   513	   582	   596	   611	   629
CKMCIR	   270#	   441	   448	   492	   513	   572	   577	   582	   611
CKNAME	   272#	   457	   494	   584	   612	   643
CLIBUF	    70
CLOBUF	    70
CLOSE	    63	   497	   506	   547	   549	   563	   564	   586	   601	   615	   625	   632	   639	   646
	   650	   659	   664	   665	   675	   677	   678	   747	   751	   757	   761	   765	   778	   780
	   782	   791	   794	   803	   808	   809	   850	   853	   866	   869	   895	   918	   946	   961
	   965	   973	   976	  1264
CLOSEA	    64	   539	   579	   645
CMD	   114#	   436	   437	  1159	  1162	  1167	  1213
CNFERR	    41#
CNT	  1123#	  1129	  1130	  1132	  1134
CODE	   120#	   728	   736#	   736	   740	   744	   905
COMPRE	   135	  1274	  1300	  1348#
CORERR	    60#	   880
CP	    66
CPARW	   119#	  1293
CPARWC	   274#	  1315	  1320
CPW	    95#	    96
CR	   276#	   338	   879	   894	   909	  1072
CT	   119#	  1275	  1280	  1283	  1284	  1288	  1289	  1297	  1298	  1307	  1315	  1320	  1335
CUD10P	   277#	   694
CUSER	   120#	  1280	  1284	  1294	  1298	  1301	  1307	  1315	  1320	  1335	  1363	  1364	  1366	  1371
	  1372
DATE	   117#	   702	   703	   704	  1259
DATOUT	   107	  1146
DAY	   117#	   703
DBLK	   116#	   482	   549	   563	   664	   678	   782	   808	   866	   867	   868	   869	   972	   973
	   974	   976
DBLKUP	   278#	   329	   972
DDTREM	  1161	  1161#
DELERR	   407#	   991
TENUPD
SYMBOL CROSS REFERENCE

DELETE	    69	   490	   492#	  1001	  1005	  1278	  1278#
DELFIL	   128	   498	   983#
DELUSR	   141#	   500	   503	   507	   508	   544	   746	  1276	  1279
DEVNAM	    89#
DIDIT	  1015#	  1016	  1018#
DINDEX	   116#	   482	   548	   549	   563	   664	   678	   781	   782	   808	   866	   867	   868	   869
	   870	   972	   973	   974	   977
DIRECT	    20#	   818	   823	   833	   838	   995	  1145	  1151	  1260	  1267
DISP	   437	   437#
DIST	   122#	   523	   528	   555	   614	   615	   620	   760	   761	   774	  1219	  1238
DISTBI	   280#	   615	   625	   761
DLOC	   116#	   549	   563	   664	   678	   728	   782	   808	   862	   865	   972
DOVBLK	   116#	   728	   863	   869	   972
DSKB	   281#	   598	   754
DUL	   282#	   300	   316	   349	   549	   664	   678	   782	   808	   867	   868	   869	   974
DULLOO	   128	   482	   543	   657	   780	   801	   861#
DULNAM	   116#	   726	   836
DULOVE	   283#	   869
DULREA	   285#	   866	   869
DULWRI	   286#	   329	   973	   976
DUMMY	   205#	   206
ENDUFD	  1005	  1005#
EOFERR	    53#	   877	   887
ERASE	    66
ERFLG	  1208#	  1209	  1222	  1227	  1231	  1235	  1239	  1243	  1248
ERRNUM	    72#	   877	   880	   889	   906	   986	  1150	  1266
ERROR	   127	   442	   449	   457	   494	   495	   509	   515	   517	   518	   545	   566	   573	   574
	   578	   584	   594	   597	   599	   609	   612	   627	   630	   640	   643	   652	   661	   680
	   878	   889	   897	   902#	  1017	  1085	  1116	  1127	  1226	  1323	  1325	  1326	  1327	  1328
	  1390
ERRTAB	   253#	   894	   909
EXCHOL	   287#	   656	   663	  1299	  1302
EXTARG	    84#	   362	   364	   723	   727	   994	  1000	  1144
EXTQ	    87#
EXU	    62	   694	   702	  1016	  1084	  1389
FBSERR	    50#
FIDP	    74#	   879
FILEBU	   406#
FILLIN	   288#	   536	   547
FILSIZ	    86#
FINDDR	   292#	   548	   781
FINDLR	   129	   542	   654	   768	   797	   937#
FINDNA	   290#	   456	   493	   514	   583	   596	   611	   629	   642
FINDST	   129	   599	   755	   925#
FIRSTO	   293#	  1371	  1372
FIXCP	   294#	   319	   324	   329	   850	   865	   869	   964	   972	   975
FMDERR	    37#	   882
FNFERR	    47#	   884	  1150	  1266
FNMAX	    31#
FNMIN	    30#	    32
FOUND	   121#	   456	   457	   493	   494	   514	   515	   583	   584	   596	   597	   611	   612	   629
	   630	   642	   643	   730	   742	   746	   749	   753	   759	   763	   767	   786
FREE	    97#
TENUPD
SYMBOL CROSS REFERENCE

FROMCI	   427	   432#
FROMTT	   125	   429#
GAN	   123#	   476	   481	   521	   526	   553
GCIRNU	   295#	   304	   740	   741	   750	   771	   772	  1050
GCIRWD	   297#	   298	   788
GET	    70	   157#	   441
GETACI	   131	   492	   513	   582	   596	   611	   629	   710	  1122#
GETCIR	   132	   502	   559	   592	   607	   621	   637	   671	  1079#	  1131	  1281	  1286	  1295	  1303
	  1309	  1315	  1320	  1324	  1337	  1339	  1340	  1341
GETCMD	   429	   434#	   436	   441	   448	   454	   477	   486	   492	   513	   569	   572	   577	   582
	   596	   611	   629	   684	   686	   910#	   910	  1215#	  1215	  1218	  1225	  1229	  1233	  1237
	  1241	  1245
GETCNA	   298#	   742
GETDIS	   299#	   523	   614	   774	  1219	  1238
GETDOV	   300#	   869	   972
GETGAN	   301#	   476	   521
GETHSI	   306#	   574	  1226
GETLIN	    65	   435
GETLOV	   302#	   324	   960
GETM	   151#	   272	   442	   516	   573	   578	  1276	  1305
GETMCI	   131	   441	   448	   492	   513	   572	   577	   582	   611	   709	  1112#
GETMOD	   132	   531	  1057	  1063#
GETMUD	   135	  1305	  1312	  1317	  1333#
GETNEW	   303#	   574	   579	   613	   645
GETNUM	   108	   304#	   523	   574	   614	   774	  1025	  1026	  1212	  1219	  1226	  1238
GETOCT	   108	   476	   521	   522
GETPAS	   308#	   539	   579	   645
GETPBI	   131	   524	   585	   775	  1048#	  1220	  1230
GETSTR	   130	   535	   600	   756	   776	  1023#	  1221	  1234
GETTNA	   310#	   441	   448	   456	   493	   514	   572	   577	   583	   596	   611	   629	   642	   645
GETTOK	   108	   435	   441	   448	   453	   456	   493	   514	   568	   572	   577	   583	   596	   611
	   629	   642	   645	  1066
GLBCMX	    94#	    96
GLBSZ	    96#	    97	    99
GLCNT	   100#
GOOD	  1080#	  1084	  1086#	  1386#	  1389	  1391#
HASH	   109	   848
HELP	   156#	   439
HIGHJO	   985#	   988	   989	   990
HIGHUF	   312#	   999
HSYS	   117#	   574	  1179	  1226
IFDERR	    40#	   883
IMAGE	    99#
IMGIO	   109	   712	   713	   716	   740	   741	   742	   750	   760	   764	   771	   772	   788	   904
	   905	   906	  1007	  1025	  1026	  1039	  1041	  1050
INDEX	   114#	   464	   465	   469	   471	   472	   601	   728	   757	   928	   929	   930	   931	   997
	   998	   999	  1000	  1002
INITBI	   313#	   465
INITTT	   108	   698
INITUP	   127	   429	   432	   691#
INPUT	     7#	   818	   823	   833	   838	   995
INREAD	   350#	   478	   818	   823	   833	   838	   849	   853	   864	   869	   918	   946
INSTR9	   315#	  1114
TENUPD
SYMBOL CROSS REFERENCE

INSTRP	   314#	  1125
INTCMD	   195#	   436
INUPDA	   389#	   497	   506	   547	   549	   563	   564	   586	   601	   615	   625	   632	   639	   646
	   650	   659	   664	   665	   675	   677	   678	   747	   751	   757	   761	   765	   778	   780
	   782	   791	   794	   803	   808	   809	   959	   963	   972	   975
INVALD	   316#	   563
INVALI	   161#	   492	  1161	  1215
INVALL	   318#	   564	   675	   780
INVALU	   219#	   434	   490	   505	   508
IOADR	   112#	   477	   877
IOCS	    63	   693
IOTAB	   112#	   707	   708	   721	   722	   723	   725	   726	   727	   821	   822	   823	   836	   837
	   838	   993	   994	   995	   996	  1005	  1143	  1144	  1145	  1151
IUSERR	    48#	   885
KIND	  1257#	  1257	  1259	  1273#	  1273	  1276
LBLK	   118#	   456	   458	   459	   461	   462	   465	   466	   469	   471	   472	   478	   481	   493
	   495	   497	   506	   514	   536	   547	   549	   564	   583	   586	   596	   601	   611	   615
	   625	   629	   632	   639	   642	   646	   647	   650	   655	   659	   665	   675	   677	   747
	   751	   757	   761	   765	   778	   780	   782	   789	   791	   794	   798	   803	   809	   850
	   851	   852	   853	   854	   862	   867	   917	   918	   919	   920	   929	   931	   942	   946
	   947	   948	   949	   953	   959	   960	   961	   962	   965	   991	   993	   996	  1008	  1173
	  1195	  1242	  1262
LBLKUP	   319#	   328	   330	   497	   547	   564	   625	   639	   665	   675	   747	   751	   757	   761
	   765	   778	   780	   791	   809	   959
LCMDS	   209#	   454
LINDEX	   118#	   456	   458	   459	   461	   462	   465	   466	   469	   471	   472	   478	   481	   493
	   495	   497	   506	   514	   536	   547	   549	   564	   583	   586	   596	   601	   611	   615
	   625	   629	   632	   639	   642	   646	   647	   649	   650	   655	   658	   659	   665	   675
	   676	   677	   747	   751	   757	   761	   765	   778	   780	   782	   789	   791	   793	   794
	   798	   802	   803	   809	   850	   851	   852	   853	   854	   862	   867	   917	   918	   919
	   920	   929	   931	   940	   942	   943	   946	   947	   948	   949	   953	   960	   961	   962
	   966	   991	   993	   996	  1008	  1173	  1195	  1242	  1262
LIST	   164#	   453
LISTAB	   107	   439	  1071
LISTIN	   133	  1141	  1148	  1157#
LLEN	    93#	    94
LNGERR	    54#
LOCHAS	   118#	   497	   506	   547	   564	   586	   601	   615	   625	   632	   639	   646	   647	   649
	   650	   658	   659	   665	   675	   676	   677	   747	   751	   757	   761	   765	   778	   780
	   789	   791	   793	   794	   802	   803	   809	   850	   959
LOCOLD	   124#	   647	   649	   658	   676	   729	   789	   793	   802
LOCWPF	    75#	    78	    79	    81	    82	    83	    84	    85	    86
LOKUPD	   127	   549	   563	   664	   678	   782	   808	   831#	   864	   869	   972	   975
LOKUPL	   127	   478	   497	   506	   547	   564	   586	   601	   615	   625	   632	   639	   646	   650
	   659	   665	   675	   677	   747	   751	   757	   761	   765	   778	   780	   791	   794	   803
	   809	   815#	   849	   853	   918	   946	   959	   963
LOLDIN	   124#	   647	   649	   658	   676	   729	   789	   793	   802
LOVBLK	   118#	   321#	   848	   853	   918	   946	   960
LPROJE	   168#	   475
LSAVE	   119#	   456	   476	   493	   514	   519	   521	   522	   523	   524	   526	   527	   528	   532
	   534	   536	   547	   583	   596	   611	   625	   629	   639	   642	   655	   665	   770	   771
	   772	   773	   774	   775	   778	   798	   809	  1170	  1171	  1172	  1183	  1187	  1191	  1219
	  1220	  1221	  1230	  1234	  1238	  1292
TENUPD
SYMBOL CROSS REFERENCE

LUD	   322#	   324	   330	   345	   348	   353	   370	   456	   459	   461	   462	   465	   471	   472
	   481	   493	   495	   497	   514	   536	   547	   549	   564	   583	   586	   596	   601	   611
	   615	   625	   629	   642	   646	   655	   665	   675	   747	   751	   757	   761	   778	   780
	   782	   791	   798	   809	   851	   852	   853	   862	   867	   918	   919	   920	   929	   942
	   946	   947	   949	   960	   962	   991	   993	   996	  1262
LUDCL	   323#	   328	   330	   497	   547	   564	   625	   639	   665	   675	   747	   751	   757	   761
	   765	   778	   780	   791	   809	   961	   965
LUDLOO	   128	   456	   493	   514	   583	   596	   611	   629	   642	   648	   742	   786	   792	   846#
LUDNAM	   118#	   722	   821
LUDOK	   419#
LUDOVE	   324#	   853	   918	   946
LUDREA	   326#	   478	   850	   853	   918	   919	   946
LUDREV	   420#	   506	   564	   650	   659	   675	   677	   780	   794	   803
LUDSEQ	   127	   480	   915#
LUDWRI	   327#	   328	   330	   497	   547	   564	   625	   639	   665	   675	   747	   751	   757	   761
	   765	   778	   780	   791	   809	   961	   965
LUSER	   169#	   455
MAKECH	   328#	   586	   601	   615	   632	   646
MAKECP	   135	  1293	  1379#
MAKEDO	   130	   548	   781	   971#
MAKEDU	   329#	   549	   563	   664	   678	   782	   808
MAKELO	   129	   944	   958#
MAKELU	   317#	   318	   328	   330	   497	   547	   625	   639	   665	   747	   751	   757	   761	   765
	   778	   791	   809
MAKESI	   109	   441	   448	   456	   493	   514	   572	   577	   583	   596	   611	   629	   642	   645
MAKEVA	   330#	   506	   650	   659	   677	   794	   803
MAXARG	    76#	    79
MAXCMD	   332#	   744
MAXSIT	   333#	   574	  1226
MAXWPF	    79#
MCHCPA	   175#	   274
MCHNAM	   176#	  1297
MCHPAS	   173#	  1283
MCHSYS	   178#
MCKUNQ	   177#	  1307
MCPARW	   249#	   445	   528	   529	   530	  1313	  1314	  1318	  1319	  1341
MDEL	   174#	  1279
MEOF	   335#	   358
MFB	   184#	  1327
MGAN	   246#	   443	   526	  1339
MGMUD	   179#	  1334
MHOME	   248#	   446
MINARG	    77#	    78
MINCMD	   331#	   744
MKIND	   120#	  1279	  1280	  1283	  1284	  1288	  1290	  1297	  1298	  1307	  1315	  1320	  1334	  1335
MMISC	   185#
MNEW	   172#	  1288
MODE	   815#	   815	   818	   823	   831#	   831	   833	   838	  1064#	  1067	  1068
MODEBI	   334#	   375	   463	  1068
MODES	   211#	   463	  1067	  1071	  1171	  1183	  1220	  1230
MSG	    71	   435	   436	   441	   443	   444	   445	   446	   448	   454	   456	   459	   460	   461
	   462	   463	   468	   471	   472	   476	   486	   493	   506	   514	   521	   522	   523	   564
	   569	   572	   574	   577	   579	   583	   596	   611	   613	   614	   629	   642	   645	   650
TENUPD
SYMBOL CROSS REFERENCE

	   659	   675	   677	   686	   701	   774	   780	   794	   803	   879	   881	   882	   883	   884	   885
	   886	   887	   889	  1025	  1026	  1033	  1066	  1071	  1211	  1219	  1226	  1238	  1281	  1286
	  1295	  1303	  1315	  1320
MUD	   123#	   443	   444	   445	   446	   526	   527	   528	   529	   530	  1313	  1314	  1318	  1319
	  1339	  1340	  1341
MUDBUS	   414#	  1327
MUDCIR	   217#	   441	   448	   492	   513	   572	   577	   582	   611	  1094	  1113	  1116	  1281	  1286
	  1295	  1303	  1309	  1315	  1320	  1324	  1337	  1339	  1340	  1341
MUDERR	   413#	  1323	  1328
MUDGOO	   336#	  1281	  1286	  1295	  1303	  1315	  1320
MUDOK	   417#	  1281	  1286	  1295	  1303	  1315	  1320
MUDREV	   418#
MUDUP	   131	   442	   449	   457	   494	   505	   508	   516	   540	   541	   544	   562	   573	   575
	   578	   580	   584	   587	   612	   616	   624	   643	   645	   651	   660	   674	  1273#
MUUN	   247#	   444	   527	  1340
N	  1079#	  1079	  1083	  1091#	  1091	  1093	  1094	  1101#	  1101	  1104	  1106
NAMARG	    83#	   708	   722	   726	   821	   836	   993	   998	  1143
NAMEHA	   122#	   506	   519	   647	   649	   650	   658	   659	   676	   677	   770	   789	   793	   794
	   802	   803	   851
NAMEIN	   396#	   398#	   400#	   449	   515	   518	   545	   652	   767	   780	   786	   795	  1326
NAMENT	   397#	   399#	   401#	   442	   449	   457	   494	   517	   573	   578	   584	   597	   612	   630
	   643	   661	   746	   749	   753	   759	   763	   804	  1325
NAMEOU	   338#	   385	   482	  1198	  1199
NCH	  1349#	  1351	  1363	  1364	  1367
NCHANG	   192#	   206	   569	   570	  1175	  1224
NDULBL	   340#	   841
NEW	    14#
NEWU	   223#	   538	   544	   562
NEWUSE	   222#	   434	   511	   517	   518	   538	   544	   562
NICMDS	   188#	   195	   436	   437	  1159	  1213
NIM	   182#	  1325
NLISTS	   191#	   209	   454
NLUDBL	   341#	   826
NMODES	   190#	   211	  1067	  1071
NO	   342#	  1142	  1250
NOFFIC	   214#	   434	   730	   738	   817	   832
NOTTHE	   343#	   436	   441	   448	   454	   492	   513	   518	   572	   577	   582	   596	   611	   629
	   657	   852	   868	   931
NUCMDS	   189#	   198	   439
NUM	   344#	   359	   500	   551	   553	   554	   555	   556	   557	   558	   589	   591	   603	   605
	   606	   618	   620	   634	   636	   667	   669	  1102	  1134
NUMB	   902#	   902	   904	   905	   906	   909
NUMBER	   121#	   740	   741	   750	   760	   764	   771	   772	  1025	  1026	  1050	  1051
NUMOUT	   108	   445	   446	   459	   471	   472	   701	   889	  1170	  1172	  1179	  1187	  1191	  1219
	  1221	  1226	  1234	  1238
NWD	  1349#	  1351	  1363	  1364	  1366	  1368
OCTOUT	   108	   443	   444	   458	  1034	  1036	  1173
OCTWDO	   346#	   458	  1173
OENTSI	   124#	   647	   665	   729	   789	   809
OFFALT	    72
OK	   395#	   504	   561	   623	   639	   673	   811
OLD	    15#
OLDHAS	   124#	   647	   649	   658	   676	   729	   789	   793	   802
TENUPD
SYMBOL CROSS REFERENCE

OLDNAM	   122#	   644	   656	   663	   668	   678	   728	   729	   784	   799	   800	   806	   807	  1198
	  1299	  1302
OLUDUP	   131	   432	   503	   560	   593	   608	   622	   638	   672	   736#
ONALT	    72
ONALTC	    72
ONES	   692#	   704	   705
OP	   115#	   712	   713	   716	   740	   741	   750	   760	   764	   771	   772	   904	   905	   906
	  1007	  1025	  1026	  1039	  1041	  1050
OPEN	    63	   539	   579	   645	   699	   818	   823	   833	   838	   896	   995	  1145	  1151	  1260
	  1267
OTHERL	   152#	   432
OUT	   107	   458	   894	   909	  1162	  1164	  1167	  1169	  1170	  1171	  1172	  1173	  1177	  1178
	  1179	  1181	  1182	  1183	  1185	  1186	  1187	  1189	  1190	  1191	  1193	  1194	  1195	  1197
	  1198	  1199	  1219	  1220	  1221	  1226	  1230	  1234	  1238	  1242
OUTMSG	    10#
OUTPUT	     9#	   308	   699	   896	  1151	  1267
OVBIT	   347#	   961	   973
OVDBIT	   349#	   973
OVLBIT	   348#	   961
P	   121#	   435
P1	   121#	   469	   470	   482	   706	   707	   720	   721	   724	   725	   740	   741	   742	   750
	   771	   772	   788	  1025	  1026	  1050	  1082	  1083	  1084	  1092	  1093	  1103	  1104	  1105
	  1164	  1169	  1172	  1178	  1182	  1186	  1187	  1190	  1194	  1198	  1199	  1221	  1234	  1350
	  1353	  1389
PACK	    26#
PASSIN	   109	   539	   579	   645
PASSW	   117#	  1285	  1291
PLNCHK	    64
PLNW	    64
PPNARG	    82#	   993	   996
PPNOUT	   345#	   458	  1173
PRINT	    71
PRINTC	    71
PRIV	   122#	   524	   529	   530	   532	   556	   586	   591	   750	   751	   775	  1051	  1054	  1055
	  1056	  1068	  1220	  1230	  1318	  1319
PRTERR	    49#	   886
PRVARG	    85#
PUT	    70
PUTC	    70
PUTX	    70
QUERY	   108	   631	  1055	  1056	  1142	  1242	  1249	  1250
QUIT	   165#	   488
R	    65
RB	    67	   478	   497	   506	   547	   549	   563	   564	   586	   601	   615	   625	   632	   639
	   646	   650	   659	   664	   665	   675	   677	   678	   747	   751	   757	   761	   765	   778
	   780	   782	   791	   794	   803	   808	   809	   850	   853	   866	   869	   918	   919	   946
	   959	   972	   997	   999
RECEIV	   229#	   295	   297	   716	   760	   764
RELEAS	    68
REMOVE	   162#	   490	  1162	  1215
RENAME	    69
RESTOR	   351#	   649	   658	   676	   793	   802
REVERS	   149#	   505	   562	   624	   651	   660	   674
TENUPD
SYMBOL CROSS REFERENCE

RUB	   122#	   631	   632	   636	   764	   765	  1242
RUBBIT	   353#	   379	   632	   639	   765
SAVEOL	   354#	   647	   789
SEND	   228#	   713	   904	   905	   906	  1007	  1039	  1041
SENDAC	   132	   500	   501	   551	   552	   553	   554	   555	   556	   557	   558	   589	   590	   591
	   603	   604	   605	   606	   618	   619	   620	   634	   635	   636	   667	   668	   669	   670
	  1101#	  1128	  1134
SENDCI	   134	  1094	  1106	  1385#
SENDCT	   356#	  1280	  1284	  1298	  1307	  1315	  1320	  1335
SENDME	   358#	  1308	  1315	  1320	  1336
SENDMU	   134	  1091#	  1280	  1284	  1285	  1289	  1290	  1291	  1292	  1293	  1294	  1298	  1301	  1307
	  1308	  1315	  1320	  1335	  1336
SENDOW	   130	  1008	  1031#
SENDSY	   359#	   501	   552	   590	   604	   619	   635
SEQUEN	    19#	   308	   699	   896
SETCFN	    62
SETCP	    66	   497	   506	   547	   549	   563	   564	   586	   601	   615	   625	   632	   639	   646
	   650	   659	   664	   665	   675	   677	   678	   747	   751	   757	   761	   765	   778	   780
	   782	   791	   794	   803	   808	   809	   850	   853	   865	   869	   918	   946	   959	   964
	   972	   975	  1261
SETFID	    63	   707	   721	   725
SETPRM	    65
SETRUB	   361#	   631	  1242
SETRWE	    71
SETSIT	   362#	   822	   837
SETTAB	    64
SETTER	    65
SETUPT	   227#	   712
SIMPLE	   409#	   878	   889	   906
SITBYT	   364#	   822	   837
SITE	   120#	   730	   737#	   741	   743	   822	   837
SITE31	   120#	   723	   822	   837
SIXB	   365#	  1353	  1354	  1355	  1356	  1357	  1358	  1359	  1360	  1361
SIZE	    66	   826	   841	  1261
SIZEBL	   366#	   388	   478	   497	   506	   547	   548	   549	   563	   564	   586	   601	   615	   625
	   632	   639	   646	   650	   659	   664	   665	   675	   677	   678	   747	   751	   757	   761
	   765	   778	   780	   781	   782	   791	   794	   803	   808	   809	   826	   841	   850	   853
	   865	   866	   869	   918	   919	   943	   946	   949	   959	   961	   962	   964	   965	   972
	   973	   974	   975	   976	   984
SIZEDU	   117#	   367#	   548	   781	   841	   870	   972	   975
SIZEIN	   369#	   465
SIZELU	   119#	   370#	   456	   466	   493	   514	   583	   596	   611	   629	   642	   647	   789	   826
	   854	   917	   931	   948	   949	   953	   960	   964
SIZENE	   368#	   534	   536	   547	   773	   778	   943	   948	   949
SIZEST	   371#	   466	   536	   547	   601	   757	   778	   930
SIZEUF	   372#	  1002
START	   427	   427#
STRINF	   122#	   536	   547	   557	   558	   598	   601	   605	   606	   754	   757	   778	   929	  1024
	  1025	  1026
STRING	   123#	  1114	  1125
STRNTT	   403#	   599	   755
STRTHE	   402#
TABOFF	    65
TENUPD
SYMBOL CROSS REFERENCE

TCHG	  1208#	  1212	  1217	  1225	  1226	  1229	  1230	  1233	  1234	  1237	  1238	  1241	  1242
TEL	    32#	   435
TELERR	    55#
TENS	   692#	   704	   705
TENUPD	   102	   104#
TERROR	   132	   893#	   991
THERE	   386#	   442	   449	   456	   457	   461	   462	   482	   493	   494	   514	   515	   516	   543
	   573	   578	   583	   584	   596	   597	   599	   611	   612	   629	   630	   642	   643	   648
	   746	   749	   753	   755	   759	   763	   767	   780	   786	   792	   801	   856	   872	   933
	  1113	  1124	  1171	  1183	  1195	  1220	  1230	  1242
THISLI	   114#
THISSY	   114#	   499	   501	   550	   552	   588	   590	   602	   604	   617	   619	   633	   635	   666
	   669	   696
TIMES	  1385#	  1385	  1388
TMFERR	    36#	   880	   881
TMP	   121#	   454	   455	   464	   465	   466	   467	   475	   501	   516	   520	   552	   590	   604
	   619	   635	   703	   713	   714	   715	   717	   728	  1016	  1018	  1038	  1039	  1040	  1041
	  1081	  1084	  1259	  1263	  1387	  1389
TOKEN	   110#	   441	   448	   456	   493	   514	   572	   577	   583	   596	   611	   629	   642	   645
	   700
TTDIST	   373#	  1170	  1191	  1219	  1238
TTERR	  1140#	  1145	  1150#
TTEXT	   117#	   705	  1144
TTF	  1157#	  1157	  1161	  1166	  1173	  1177	  1181	  1185	  1189	  1193	  1197
TTFNAM	   117#	   708	  1143
TTHOME	   374#	  1179	  1226
TTMSGS	   422#	   506	   564	   650	   659	   675	   677	   780	   794	   803	  1281	  1286	  1295	  1303
	  1315	  1320
TTPRIV	   375#	  1171	  1183	  1220	  1230
TTRUBO	   379#	  1195	  1242
TTSTRO	   381#	  1172	  1187	  1221	  1234
TTUSER	   385#	  1164	  1169	  1178	  1182	  1186	  1190	  1194
TTYF	   215#	   429	   432	   697	   739	   742	   750	   756	   769	   784	   787	   878	   903	  1006
	  1025	  1026	  1032	  1049
TTYLEN	    70
TYMSHB	   387#	   462	   530	  1056	  1171	  1183	  1220	  1230	  1319
TYPE	  1101#	  1101	  1102
UCANCE	   220#	   505	   508
UCMDS	   198#	   439
UFD	   125#	   727	   994
UFDBLK	   984#	   997	   998	   999	  1000
UFDREA	   388#	   997	   999
UPDATE	     8#	   818	   823	   833	   838	  1145	  1260
UREMOV	   221#	   490
USER	   121#	   441	   448	   456	   493	   501	   514	   549	   552	   572	   577	   583	   590	   596
	   604	   611	   619	   629	   635	   642	   644	   645	   656	   663	   664	   670	   742	   782
	   784	   788	   799	   800	   806	   807	   808	   848	  1164	  1169	  1178	  1182	  1186	  1190
	  1194	  1199	  1299	  1302	  1350
USRNAM	    88#
USRTAB	   985#	   998	  1000	  1001
UUN	   123#	   522	   527	   554
VALIDA	   158#	   513	  1166	  1217
VALUSE	   511	   513#
TENUPD
SYMBOL CROSS REFERENCE

VERSIO	   390#	   701
W	    66	  1262	  1263
WB	    67	   497	   506	   547	   549	   563	   564	   586	   601	   615	   625	   632	   639	   646
	   650	   659	   664	   665	   675	   677	   678	   747	   751	   757	   761	   765	   778	   780
	   782	   791	   794	   803	   808	   809	   961	   965	   973	   976
WD	  1091#	  1091	  1092	  1101#	  1101	  1103	  1105
WDDIST	   234#	   280	   373	   459	   523	   528	   625	   774	  1219	  1238
WDHASH	   240#	   318	   330	   497	   519	   646	   747	   770	   791	   851	   920	   947
WDINIT	   236#	   313
WDNAME	   235#	   482	   549	   664	   678	   782	   808
WDPPN	   232#	   288	   290	   300	   301	   302	   316	   321	   345	   348	   349	   481	   495	   522
	   526	   527	   549	   655	   665	   771	   772	   778	   782	   798	   809	   852	   853	   862
	   867	   868	   869	   918	   919	   942	   946	   962	   974	   991	   993	   996	  1008	  1230
	  1262	  1292
WDPRIV	   239#	   375	   461	   462	   463	   524	   532	   586	   751	   775	  1220
WDQIN	   242#	   381
WDQOUT	   243#	   381	  1025
WDRUB	   238#	   353	   639
WDSIZE	   237#	   370	   534	   773
WDSNAM	   233#	   929
WDSTRN	   241#	   288	   381	   464	   466	   598	   754	   778	   928	  1024
WFID	    63	   879
WHAT	   391#	   436	   454	   486	   569	   686
WORD	    24#	   818	   823	   833	   838	   995	  1260	  1267
WPF	    78#	   112	   985
WRITEB	  1262	  1262#	  1268
WRITIT	  1146	  1146#	  1152
WX	    66
YES	   392#	  1249   !_