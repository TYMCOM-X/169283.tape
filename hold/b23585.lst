    P R O G R A M   S A L P G 1 		COBOL (005002,112001)	17-JUL-73  22:21		PAGE 1
    B23585.CBL    17-JUL-73  22:21

    0001    IDENTIFICATION DIVISION.
    0002    PROGRAM-ID. SALPG1.
    0003    AUTHOR. JOHN DOE.
    0004    INSTALLATION. ABC COMPANY, WIDGET DIVISION.
    0005    DATE-WRITTEN. 03/01/73.
    0006    DATE-COMPILED. 17-JUL-73. 
    0007    SECURITY. NONE.
    0008    REMARKS. THIS PROGRAM WILL PRODUCE A SIMPLE REPORT OF SALARY
    0009           AND WAGE INFORMATION.
    0010    ENVIRONMENT DIVISION.
    0011    CONFIGURATION SECTION.
    0012    SOURCE-COMPUTER. DECsystem-10. 
    0013    OBJECT-COMPUTER. PDP-10.
    0014           SEGMENT-LIMIT IS 20.
    0015    SPECIAL-NAMES.
    0016           CHANNEL (1) IS TOP-OF-PAGE.
    0017    INPUT-OUTPUT SECTION.
    0018    FILE-CONTROL.
    0019           SELECT EMPLOYEE-FILE ASSIGN TO DSK
    0020           RECORDING MODE IS ASCII.
    0021           SELECT RATE-FILE ASSIGN TO DSK
    0022           RECORDING MODE IS ASCII.
    0023           SELECT SALARY-REPORT ASSIGN TO DSK
    0024           RECORDING MODE IS ASCII.
    0025    DATA DIVISION.
    0026    FILE SECTION.
    0027    FD  EMPLOYEE-FILE
    0028           LABEL RECORDS ARE STANDARD
    0029           VALUE OF IDENTIFICATION IS "B21180EMP".
    0030    01      EMPREC.
    0031           05 NAME   PIC X(15).
    0032           05 EMPNUM PIC X(5).
    0033           05 HOURS  PIC 99V9.
    0034           05 S-CODE.
    0035              10 S-CD-1 PIC X.
    0036              10 S-CD-2 PIC X.
    0037    FD RATE-FILE
    0038           LABEL RECORDS ARE STANDARD
    0039           VALUE OF IDENTIFICATION IS "B21180RAT".
    0040    01      RATE-REC PIC X(7).
    0041    FD SALARY-REPORT
    0042           LABEL RECORDS ARE STANDARD
    0043           VALUE OF IDENTIFICATION IS "B21180RPT".
    0044    01      SALARY-REC PIC X(46).
    0045    WORKING-STORAGE SECTION.
    0046    77  COMPUTED-AMT PIC S9(5)V99 COMP, VALUE ZERO.
    0047    77  LINE-COUNT PIC S9(3) COMP, VALUE ZERO.
    0048    01  DATER.
    0049           05 YR PIC XX.
    0050           05 MO PIC XX.
    0051           05 DA PIC XX.
    0052           05 FILLER PIC X(6).
    0053    01  TOTAL.
    0054           05 HOURS  PIC S9(4)V9 COMP, VALUE ZERO.
    0055           05 AMOUNT PIC S9(6)V99 COMP, VALUE ZERO.
    0056    01  RATE-TABLE.    P R O G R A M   S A L P G 1 		COBOL (005002,112001)	17-JUL-73  22:21		PAGE 1-1
    B23585.CBL    17-JUL-73  22:21

    0057           05 RT-TBL OCCURS 18 TIMES INDEXED BY IDX.
    0058              10 S-CODE.
    0059                 15 S-CD-1 PIC X.
    0060                 15 S-CD-2 PIC X.
    0061              10 RATE  PIC S9(3)V99.
    0062    01  SALREC.
    0063           05 NAME   PIC X(15).
    0064           05 FILLER PIC X(3) VALUE SPACE.
    0065           05 EMPNUM PIC X(5).
    0066           05 FILLER PIC X(4) VALUE SPACE.
    0067           05 HOURS  PIC ZZ.Z.
    0068           05 FILLER PIC X(4) VALUE SPACE.
    0069           05 S-CODE PIC XX.
    0070           05 AMOUNT PIC $$$$$$.99.
    0071    01  HDG-1.
    0072           05 MO     PIC XX.
    0073           05 FILLER PIC X VALUE '/'.
    0074           05 DA     PIC XX.
    0075           05 FILLER PIC X VALUE '/'.
    0076           05 YR     PIC XX.
    0077           05 FILLER PIC X(30) VALUE
    0078              '    WEEKLY SALARY ANALYSIS    '.
    0079           05 FILLER PIC X(5) VALUE 'PAGE '.
    0080           05 PG-NUM PIC 999.
    0081    01  HDG-2  PIC X(46) VALUE
    0082           ' EMPLOYEE NAME      EMP.   HRS.   SAL.   GROSS'.
    0083    01  HDG-3 PIC X(46) VALUE
    0084           '                    NO.           CODE  AMOUNT'.
    0085    01  TRLR-1 PIC X(46) VALUE
    0086           '                           ----       --------'.
    0087    01  TRLR-2.
    0088           05 FILLER PIC X(7) VALUE '  TOTAL'.
    0089           05 FILLER PIC X(18) VALUE SPACE.
    0090           05 HOURS  PIC Z(4).Z.
    0091           05 FILLER PIC X(5) VALUE SPACE.
    0092           05 AMOUNT PIC $(7).99.
    0093    01  TRLR-3 PIC X(46) VALUE
    0094           '                END OF REPORT                 '.
    0095    PROCEDURE DIVISION.
    0096    FIRST-OVERLAY SECTION 75.
    0097    HOUSE-KEEP.
    0098           OPEN INPUT EMPLOYEE-FILE.
    0099           OPEN INPUT RATE-FILE.
    0100           OPEN OUTPUT SALARY-REPORT.
    0101           SET IDX, PG-NUM TO ZERO.
    0102           MOVE TODAY  TO DATER.
    0103           MOVE CORRESPONDING DATER TO HDG-1.
    0104    RESIDENT SECTION 05.
    0105    RESIDENT-BEGIN.
    0106           PERFORM HOUSE-KEEP.
    0107           PERFORM BUILD-RATE-TABLE THRU BUILD-EXIT.
    0108    PAGE-HDG.
    0109           MOVE ZERO TO LINE-COUNT.
    0110           ADD 1 TO PG-NUM.
    0111           WRITE SALARY-REC FROM HDG-1 AFTER ADVANCING TOP-OF-PAGE.
    0112           WRITE SALARY-REC FROM HDG-2 AFTER ADVANCING 2 LINES.    P R O G R A M   S A L P G 1 		COBOL (005002,112001)	17-JUL-73  22:21		PAGE 1-2
    B23585.CBL    17-JUL-73  22:21

    0113           MOVE ALL SPACE TO SALARY-REC, WRITE SALARY-REC.
    0114           WRITE SALARY-REC FROM HDG-3 BEFORE ADVANCING 2 LINES.
    0115    MAIN-PGM.
    0116           READ EMPLOYEE-FILE AT END CLOSE EMPLOYEE-FILE,
    0117                  GO TO WRITE-TRLRS.
    0118           MOVE CORRESPONDING EMPREC TO SALREC.
    0119           ADD HOURS IN EMPREC TO HOURS IN TOTAL.
    0120           MOVE ZERO TO IDX.
    0121           PERFORM SEARCH-RATES THRU SEARCH-EXIT.
    0122           ADD COMPUTED-AMT TO AMOUNT IN TOTAL.
    0123           MOVE COMPUTED-AMT TO AMOUNT IN SALREC.
    0124           WRITE SALARY-REC FROM SALREC.
    0125           ADD 1 TO LINE-COUNT.
    0126           IF LINE-COUNT GREATER 19, PERFORM PAGE-HDG.
    0127           GO TO MAIN-PGM.
    0128    SEARCH-RATES.
    0129           ADD 1 TO IDX.
    0130           IF IDX GREATER 18, MOVE ZERO TO COMPUTED-AMT,
    0131                              GO TO SEARCH-EXIT.
    0132           IF S-CODE IN EMPREC NOT = S-CODE IN RT-TBL (IDX),
    0133              GO TO SEARCH-RATES.
    0134           IF S-CD-1 IN RT-TBL (IDX) = 'H',
    0135             COMPUTE COMPUTED-AMT ROUNDED = HOURS IN EMPREC * RATE (IDX)
    0136            ELSE MOVE RATE (IDX) TO COMPUTED-AMT.
    0137    SEARCH-EXIT.
    0138           EXIT.
    0139    THIRD-OVERLAY SECTION 40.
    0140    WRITE-TRLRS.
    0141           WRITE SALARY-REC FROM TRLR-1.
    0142           MOVE CORRESPONDING TOTAL TO TRLR-2.
    0143           WRITE SALARY-REC FROM TRLR-2.
    0144           WRITE SALARY-REC FROM TRLR-3 AFTER ADVANCING 2 LINES.
    0145           CLOSE SALARY-REPORT.
    0146           DISPLAY '*** END OF JOB, TYPE SALPG1.RPT FOR SALARY REPORT.'.
    0147           STOP RUN.
    0148    SECOND-OVERLAY SECTION 35.
    0149    BUILD-RATE-TABLE.
    0150           SET IDX UP BY 1.
    0151           IF IDX GREATER 18, GO TO BUILD-EXIT.
    0152           READ RATE-FILE INTO RT-TBL (IDX),
    0153              AT END CLOSE RATE-FILE, GO TO BUILD-EXIT.
    0154           GO TO BUILD-RATE-TABLE.
    0155    BUILD-EXIT.
    0156           EXIT.

NO ERRORS DETECTED
