BTITLEDERROR.  V.32(426)   ERROR ROUTINES-FORTRAN IV	MACRO 46-6 08:54 18-APR-73 PAGE 1
ERROR.MAC	18-APR-73 08:54		1-JUN-72	D. M. NIXON/DMN

BC				TITLE ERROR.  V.32(426)   ERROR ROUTINES-FORTRAN IV
BSUBTTLC				SUBTTL	1-JUN-72	D. M. NIXON/DMN
BC				;***COPYRIGHT 1969,1970,1971,1972 DIGITAL EQUIPMENT CORP., MAYNARD, MASS.***
BC
BC				;REENT==1 GIVES RE-ENTRANT FORTRAN OP SYSTEM /DMN
BIFNDEFREENTC				IFNDEF REENT,<REENT==0>
BIFNREENTC				IFN REENT,<	HISEG	>
BC				;WATCH==1 MEANS USER WILL USE WATCH COMMAND TO MONITOR CPU TIME
BIFNDEFWATCHC				IFNDEF WATCH,<WATCH==0>
BIFNDEFASTFLC				IFNDEF ASTFL,<ASTFL==1	;GIVES ASTERISK FILL ON FORMAT OVERFLOW>
BC
BENTRYERROR.ERRFI.ERRIN.ITYPM.C				ENTRY	ERROR.,ERRFI.,ERRIN.,ITYPM.
BINTERNLOGEN.ILLCH.INIER.DEVER.TBLER.ILLFN.ILLPS.AROPN.C				INTERN	LOGEN.,ILLCH.,INIER.,DEVER.,TBLER.,ILLFN.,ILLPS.,AROPN.
BINTERNMSNG.NOROM.LISTB.REDER.ENDTP.FMTER.C				INTERN	MSNG.,NOROM.,LISTB.,REDER.,ENDTP.,FMTER.
BINTERNILUUO.BPHSE.ILLMG.NMLER.DUMER.ILRED.C				INTERN	ILUUO.,BPHSE.,ILLMG.,NMLER.,DUMER.,ILRED.
BINTERNPARER.WLKER.BUFER.RANER.BTLER.ASTRK.C				INTERN	PARER.,WLKER.,BUFER.,RANER.,BTLER.,ASTRK.
BIFEREENTENTRYTYPER.C				IFE REENT,<	ENTRY	TYPER.>
BIFNREENTC				IFN REENT,<	ENTRY	.TYPER>
BEXTERNEXITP.TEMP.UUOH.UUOL.DEVIC.FMTEN.FMTBG.INIT.DEPOT.C				EXTERN	EXITP.,TEMP.,UUOH.,UUOL.,DEVIC.,FMTEN.,FMTBG.,INIT.,DEPOT.
BEXTERNERRTB.ERRMX.XCTTM.ERRCT.DAYTM.DYNCH.DVNUM.FNM.ASVAR.C				EXTERN	ERRTB.,ERRMX.,XCTTM.,ERRCT.,DAYTM.,DYNCH.,DVNUM.,FNM.,ASVAR.
BIFNREENTC				IFN REENT,<EXTERN SAVEAC>
BC
BMLONC				MLON
BC				;ACCUMULATORS
BC
BAC			000001	A=1				;UTILITY
BBC			000002	B=2				;UTILITY - BUT CONTAINS ILLEGAL CHAR ON PUSHJ P,ERROR.
BCC			000003	C=3				;UTILITY
BDC			000004	D=4				;UTILITY
BMC			000007	M=7				;POINTER TO BUFFER HEADER
BIC			000011	I=11				;FLAG REGISTER
BPC			000017	P=17				;PUSHDOWN POINTER
BIFNREENTC				IFN REENT,<LOW=16>
BIFEREENTLOWC			000000	IFE REENT,<LOW=0>
BC
BINTERNERRLN.C				INTERN ERRLN.			;LOADER WILL OBJECT IF CHANGED
BERRLN.C			000020	ERRLN.==20			;LENGTH OF ERROR TABLE
BC
BC				;EACH ERROR ROUTINE IS CALLED BY A PUSHJ P,
BC
BC				;ACCUMULATORS 2,7,11 AND 17 CONTAIN INFORMATION WHICH IS
BC				;USED IN PRINTING OUT CERTAIN OF THE ERROR MESSAGES.
BC
BSUBTTLDERROR.  V.32(426)   ERROR ROUTINES-FORTRAN IV	MACRO 46-6 08:54 18-APR-73 PAGE 2
ERROR.MAC	18-APR-73 08:54		ERROR MESSAGE TYPE -OUT ROUTINE

BC				SUBTTL	ERROR MESSAGE TYPE -OUT ROUTINE
B%OPC			700000	%OP==(7B2)
BC
B%AC			000000	%A==0			;ASCIZ
B%AIC			000001	%AI==1			;ASCII WORD
B%SC			000002	%S==2			;SIXBIT WORD
B%ACC			000003	%AC==3			;ASCII CHAR.
B%SCC			000004	%SC==4			;SIXBIT CHARACTER
B%OC			000005	%O==5			;OCTAL
B%DC			000006	%D==6			;DECIMAL
B%TC			000007	%T==7			;TIME
B%EC			000010	%E==10			;ERRMSG
B%OOC			000011	%OO==11			;OCTAL  BOTH HALVES
B%NOC			000012	%NO==12			;OCTAL WITHOUT LEADING ZEROS
BC
B%JC			040000	%J==(1B3)		;JUMP TO NEW ARG. LIST
B%QC			020000	%Q==(1B4)		;CR-LF-?
B%LC			010000	%L==(1B5)		;INDEX BY LOW SEGMENT OF SET
BC
B%%PC			000001	%%P==1			;PRLOC
B%%FC			000002	%%F==2			;FMPT
B%%CRC			000003	%%CR==3			;TCRLF
BC
BSKPARGAOSPC	000000'	350017	000000	SKPARG:	AOS	(P)		;SKIP THE NEXT ARG
BNXTARGAOSAPC	000001'	354017	000000	NXTARG:	AOSA	(P)		;ADVANCE POINTER
BJMPARGHRRMAPC	000002'	542057	000000	JMPARG:	HRRM	A,(P)		;SET NEW POINTER
BC
BTYPARGLDBAPOINTPC	000003'	135040	000655'	TYPARG:	LDB	A,[POINT 3,@(P),2]
BCAIEAC	000004'	302040	000007		CAIE	A,7		;IS IT ERROR ARGUMENTS?
BPOPJPC	000005'	263740	000000		POPJ	P,		;NO,SO JUST RETURN
BMOVEAPC	000006'	200077	000000		MOVE	A,@(P)		;GET ARG.
BTLNEA%JC	000007'	603040	040000		TLNE	A,%J		;NEW ARG LIST?
BJRSTJMPARGC	000010'	254000	000002'		JRST	JMPARG		;YES
BTLNEA%QC	000011'	603040	020000		TLNE	A,%Q		;CR-LF-?
BPUSHJPCRLFQC	000012'	260740	000445'		PUSHJ	P,CRLFQ		;YES
BIFNREENTC				IFN REENT,<TLNE	A,%L		;INDEX BY LOW SEGMENT
BC					ADDI	A,(LOW)		;YES>
BLDBCPOINTPC	000013'	135140	000656'		LDB	C,[POINT 6,@(P),12]
BJRSTTYPTABCC	000014'	254023	000015'		JRST	@TYPTAB(C)	;GO TO CORRECT ROUTINE
BC
BTYPTAB%AASCIZ.C	000015'	000000	000051'	TYPTAB:	%A_14	,,ASCIZ.	;ASCIZ STRING
B%AIASCII.C	000016'	010000	000063'		%AI_14	,,ASCII.	;ASCII WORD
B%SSIXBT.C	000017'	020000	000071'		%S_14	,,SIXBT.	;SIXBIT
B%ACASCIICC	000020'	030000	000103'		%AC_14	,,ASCIIC	;ASCII CHAR.
B%SCSIXBTCC	000021'	040000	000102'		%SC_14	,,SIXBTC	;SIXBIT CHAR.
B%OOCTAL.C	000022'	050000	000111'		%O_14	,,OCTAL.	;OCTAL
B%DDECIMAC	000023'	060000	000131'		%D_14	,,DECIMAL	;DECIMAL
B%TPNTTIMC	000024'	070000	000556'		%T_14	,,PNTTIM	;TIME
B%EERRMSGC	000025'	100000	000465'		%E_14	,,ERRMSG	;ERROR 
B%OOOOCTALC	000026'	110000	000107'		%OO_14	,,OOCTAL	;OCTAL FULL WORD
B%NONOCTALC	000027'	120000	000120'		%NO_14	,,NOCTAL	;OCTAL WITHOUT LEADING ZEROS
ERROR.  V.32(426)   ERROR ROUTINES-FORTRAN IV	MACRO 46-6 08:54 18-APR-73 PAGE 3
ERROR.MAC	18-APR-73 08:54		ERROR MESSAGE TYPE -OUT ROUTINE

BC
BITYPM.MOVEIADYNCH.LOWC	000030'	201040	000000*	ITYPM.:	MOVEI	A,DYNCH.(LOW)	;START OF DEVCHR TABLE
BHRLIAC	000031'	505040	777761		HRLI	A,-17		;NUMBER OF POSSIBLE CHANNELS
BMOVECAC	000032'	200141	000000		MOVE	C,(A)		;GET STORED WORD
BTLNNCC	000033'	607140	010000		TLNN	C,(1B5)		;IS IT USER CONSOL TTY
BAOBJNAC	000034'	253040	000032'		AOBJN	A,.-2		;NO TRY AGAIN
BSUBIADYNCH.LOWC	000035'	275040	000030*		SUBI	A,DYNCH.(LOW)	;GET CHANNEL NUMBER
BMOVSICCLOSEC	000036'	205140	070000		MOVSI	C,(CLOSE)	;SET UP CLOSE UUO
BDPBAPOINTCC	000037'	137040	000657'		DPB	A,[POINT 4,C,12];PUT IN CHANNEL NUMBER
BTRNNAC	000040'	606040	777760		TRNN	A,-20		;JUST IN CASE
BXCTCC	000041'	256000	000003		XCT	C		;OUTPUT CURRENT TTY BUFFER
BJRSTTYPARGC	000042'	254000	000003'		JRST	TYPARG		;AND OUTPUT MESSAGE
BC
BTYPSXBADDICC	000043'	271140	000040	TYPSXB:	ADDI	C," "		;MAKE ASCII
BTYPCHRJUMPECCPOPJC	000044'	322140	000046'	TYPCHR:	JUMPE	C,CPOPJ		;IGNORE NULS
BTTCALLCC	000045'	051040	000003		TTCALL	1,C
BCPOPJPOPJPC	000046'	263740	000000	CPOPJ:	POPJ	P,
BC
BTYPMESTTCALLAC	000047'	051141	000000	TYPMES:	TTCALL	3,(A)		;OUTPUT MESSAGE
BPOPJPC	000050'	263740	000000		POPJ	P,
BC
BASCIZ.TLNEAC	000051'	603040	000020	ASCIZ.:	TLNE	A,(@)		;INDIRECT BIT ON?
BMOVEAAC	000052'	200041	000000		MOVE	A,(A)		;YES
BPUSHJPTYPMESC	000053'	260740	000047'		PUSHJ	P,TYPMES
BC
BMOR2DOMOVEAPC	000054'	200077	000000	MOR2DO:	MOVE	A,@(P)		;GET ARG AGAIN
BTLNNAC	000055'	607040	000017		TLNN	A,17		;FINISHED WITH IT?
BJRSTNXTARGC	000056'	254000	000001'		JRST	NXTARG		;YES,GET NEXT ARG
BLDBCPOINTAC	000057'	135140	000660'		LDB	C,[POINT 4,A,17]
BCAIGCNXTBLNC	000060'	307140	000003		CAIG	C,NXTBLN	;VALID COMMAND?
BJRSTNXTABCC	000061'	254023	000137'		JRST	@NXTAB-1(C)	;YES, DO NEXT COMMAND
BJRSTNXTARGC	000062'	254000	000001'		JRST	NXTARG		;NO, TRY NEXT ARG
BC
BASCII.HRLIAPOINTC	000063'	505040	440700	ASCII.:	HRLI	A,(POINT 7)	;FORM BYTE POINTER
BILDBCAC	000064'	134140	000001		ILDB	C,A
BPUSHJPTYPCHRC	000065'	260740	000044'		PUSHJ	P,TYPCHR
BTLNEAC	000066'	603040	760000		TLNE	A,760000
BJRSTASCII.C	000067'	254000	000064'		JRST	ASCII.+1
BJRSTMOR2DOC	000070'	254000	000054'		JRST	MOR2DO
BC
BSIXBT.TLNEAC	000071'	603040	000020	SIXBT.:	TLNE	A,(@)		;INDIRECT BIT ON?
BMOVEAAC	000072'	200041	000000		MOVE	A,(A)		;YES
BHRLIAPOINTC	000073'	505040	440600		HRLI	A,(POINT 6)	;FORM BYTE POINTER TO WORD
BSIXBT1ILDBCAC	000074'	134140	000001	SIXBT1:	ILDB	C,A
BJUMPECMOR2DOC	000075'	322140	000054'		JUMPE	C,MOR2DO	;STOP ON BLANK
BPUSHJPTYPSXBC	000076'	260740	000043'		PUSHJ	P,TYPSXB
BTLNEAC	000077'	603040	770000		TLNE	A,770000	;TEST FOR END
BJRSTSIXBT1C	000100'	254000	000074'		JRST	SIXBT1		;NOT THERE YET
BJRSTMOR2DOC	000101'	254000	000054'		JRST	MOR2DO		;SEE IF FINISHED
BC
BSIXBTCSKIPACAC	000102'	334141	000000	SIXBTC:	SKIPA	C,(A)		;GET SIXBIT CHAR.
BASCIICSKIPACAC	000103'	334141	000000	ASCIIC:	SKIPA	C,(A)		;GET ASCII CHAR.
BADDICC	000104'	271140	000040		ADDI	C,40		;MAKE SIXBIT TO ASCII
BPUSHJPTYPCHRDERROR.  V.32(426)   ERROR ROUTINES-FORTRAN IV	MACRO 46-6 08:54 18-APR-73 PAGE 3-2
ERROR.MAC	18-APR-73 08:54		ERROR MESSAGE TYPE -OUT ROUTINE

BC	000105'	260740	000044'		PUSHJ	P,TYPCHR
BJRSTMOR2DOC	000106'	254000	000056'		JRST	MOR2DO+2	;SEE IF FINISHED
BC
BOOCTALHRLIAPOINTC	000107'	505040	440300	OOCTAL:	HRLI	A,(POINT 3,)
BJRSTOCTAL.C	000110'	254000	000112'		JRST	OCTAL.+1
BC
BOCTAL.HRLIAPOINTC	000111'	505040	220300	OCTAL.:	HRLI	A,(POINT 3,,17)
BILDBCAC	000112'	134140	000001		ILDB	C,A
BADDICC	000113'	271140	000060		ADDI	C,"0"
BPUSHJPTYPCHRC	000114'	260740	000044'		PUSHJ	P,TYPCHR
BTLNEAC	000115'	603040	770000		TLNE	A,770000
BJRSTOCTAL.C	000116'	254000	000112'		JRST	OCTAL.+1
BJRSTMOR2DOC	000117'	254000	000054'		JRST	MOR2DO
BC
BNOCTALHRRZBAC	000120'	550101	000000	NOCTAL:	HRRZ	B,(A)
BPUSHPMOR2DOC	000121'	261740	000661'		PUSH	P,[MOR2DO]
BNOCT01IDIVIBC	000122'	231100	000010	NOCT01:	IDIVI	B,^D8
BHRLMBPC	000123'	506157	000000		HRLM	B+1,(P)
BJUMPEBNOCT02C	000124'	322100	000126'		JUMPE	B,NOCT02
BPUSHJPNOCT01C	000125'	260740	000122'		PUSHJ	P,NOCT01
BNOCT02HLRZCPC	000126'	554157	000000	NOCT02:	HLRZ	C,(P)
BADDICC	000127'	271140	000060		ADDI	C,"0"
BJRSTTYPCHRC	000130'	254000	000044'		JRST	TYPCHR
BC
BDECIMAMOVEBAC	000131'	200101	000000	DECIMA:	MOVE	B,(A)
BJUMPGEBDECIM1C	000132'	325100	000136'		JUMPGE	B,DECIM1	;TEST FOR NEGATIVE
BMOVMBBC	000133'	214100	000002		MOVM	B,B		;MAKE POSITIVE
BMOVEICC	000134'	201140	000055		MOVEI	C,"-"		;AND TYPE THE SIGN
BPUSHJPTYPCHRC	000135'	260740	000044'		PUSHJ	P,TYPCHR
BDECIM1PUSHJPERRNUMC	000136'	260740	000610'	DECIM1:	PUSHJ	P,ERRNUM
BJRSTMOR2DOC	000137'	254000	000054'		JRST	MOR2DO
BC
BNXTAB%%PPRLOCC	000140'	010000	000162'	NXTAB:	%%P_14	,,PRLOC
B%%FFMPTC	000141'	020000	000143'		%%F_14	,,FMPT
B%%CRTCRLFC	000142'	030000	000442'		%%CR_14	,,TCRLF
BC
BNXTABNXTBLNC			000003		NXTBLN==.-NXTAB
ERROR.  V.32(426)   ERROR ROUTINES-FORTRAN IV	MACRO 46-6 08:54 18-APR-73 PAGE 4
ERROR.MAC	18-APR-73 08:54		ERROR MESSAGE TYPE -OUT ROUTINE

BC				;THIS SUBROUTINE PRINTS OUT THE FORMAT ASSOCIATED WITH THE ERROR
BC				;THE BEG. ADD OF THE FORMAT IS IN FMTBG. THE END ADD.IS IN FMTEN.
BC
BC
BFMPTPUSHJPTYPARGC	000143'	260740	000003'	FMPT:	PUSHJ	P,TYPARG
B%ACRLF%OPC	000144'	700000	000441'		%A,	CRLF	(%OP)
BLDBBPOINTMC	000145'	135100	000662'		LDB	B,[POINT 6,1(M),11]	;PICK UP MODE
BCAINBC	000146'	306100	000044		CAIN	B,44		;DON'T PRINT FORMAT IF BINARY
BJRSTPRLOCC	000147'	254000	000162'		JRST	PRLOC		;JUST USER LOC
BHRRZBFMTEN.LOWC	000150'	550100	000000*		HRRZ	B,FMTEN.(LOW)	;END ADDRESS OF FORMAT
BHRRZAFMTBG.LOWC	000151'	550040	000000*		HRRZ	A,FMTBG.(LOW)	;BEG. ADDRESS OF FORMAT
BSUBIBAC	000152'	275101	000001		SUBI	B,1(A)		;OBTAIN THE NO. OF WORDS IN THE FMT.
BIMULIBC	000153'	221100	000005		IMULI	B,5		;OBTAIN THE TOTAL NO OF CHAR. IN FMT
BCAILEBC	000154'	303100	000110		CAILE	B,^D72		;PRINT A MAX. OF 72 CHAR.
BMOVEIBC	000155'	201100	000110		MOVEI	B,^D72		;SET MAX. CHAR. AT 72
BMOVEAFMTBG.LOWC	000156'	200040	000151*		MOVE	A,FMTBG.(LOW)	;POINTER TO FIRST CHAR. IN FMT.
BILDBCAC	000157'	134140	000001		ILDB	C,A		;LOAD CHAR INTO AC
BPUSHJPTYPCHRC	000160'	260740	000044'		PUSHJ	P,TYPCHR	;DEPOSIT CHARACTER INTO OUTPUT BUFFER
BSOJGBC	000161'	367100	000157'		SOJG	B,.-2		;GET ANOTHER CHAR. IF THERE IS ONE
BPRLOCPUSHJPUSRLOCC	000162'	260740	000411'	PRLOC:	PUSHJ	P,USRLOC	;JUMP TO TYPE USERS LOCATION
BCLSEAOSBERRTB.ERRLN.LOWC	000163'	350100	000017*	CLSE:	AOS	B,ERRTB.+ERRLN.-1(LOW)	;GET LAST ERROR SLOT
BHLLBLSTERRC	000164'	500100	000627'		HLL	B,LSTERR	;FILL IN ADDRESS OF ERROR MESSAGE
BMOVEMBERRTB.ERRLN.LOWC	000165'	202100	000017*		MOVEM	B,ERRTB.+ERRLN.-1(LOW)	;STORE BACK
BAOSERRCT.LOWC	000166'	350000	000000*		AOS	ERRCT.(LOW)	;BUMP TOTAL ERROR COUNT
BPUSHJPEXITP.LOWC	000167'	260740	000000*		PUSHJ	P,EXITP.(LOW)	;CLOSE OUT USERS JOB, BUT DON'T CHANGE (LOW)
BC
BC
BC				;END OF FILE ON INPUT
BC				;THE DEV. NAME IS IN SIXBIT AND IS IN THE GLOBAL WORD DEVIC.
BC
BLOGEN.PUSHJPITYPM.C	000170'	260740	000030'	LOGEN.:	PUSHJ	P,ITYPM.
B%AASCIZ%OP%QC	000171'	720000	000663'		%A,	[ASCIZ /END OF FILE ON /] (%OP+%Q)      
B%SDEVIC.%OP%L%%FC	000172'	710102	000000*		%S,	DEVIC.	(%OP+%L+%%F)
BC
BC
BC				;IMPROPER FORMAT CONSTRUCTION, MIS-MATCHED ( )'S
BC
BFMTER.PUSHJPITYPM.C	000173'	260740	000030'	FMTER.: PUSHJ   P,ITYPM.
B%AASCIZ%OP%%FC	000174'	700002	000667'	        %A,     [ASCIZ /?ERROR IN FORMAT /] (%OP+%%F)
BC
BC				;A CHARACTER IN THE FORMAT STRING IS ILLEGAL.
BC				;THE CHAR. IS IN SIXBIT AND IS IN AC 2.
BC
BERROR.PUSHJPITYPM.C	000175'	260740	000030'	ERROR.:	PUSHJ	P,ITYPM.
B%AILCHAR%OP%QC	000176'	720000	000435'		%A,	ILCHAR	(%OP+%Q)	;ILLEGAL FORMAT MESSAGE
B%SCB%OPC	000177'	700200	000002		%SC,	B	(%OP)		;TYPE CHAR.
B%AASCIZ%OP%%FC	000200'	700002	000673'		%A,	[ASCIZ / IN FORMAT/] (%OP+%%F)
ERROR.  V.32(426)   ERROR ROUTINES-FORTRAN IV	MACRO 46-6 08:54 18-APR-73 PAGE 5
ERROR.MAC	18-APR-73 08:54		ERROR MESSAGE TYPE -OUT ROUTINE

BC
BC				;ILLEGAL CHARACTER IN INPUT STRING
BC				;THE CHAR. IS IN SEVEN-BIT AND IS IN THE CURRENT INPUT BUFFER.
BILLCH.PUSHJPITYPM.C	000201'	260740	000030'	ILLCH.:	PUSHJ	P,ITYPM.
B%AILCHAR%OP%QC	000202'	720000	000435'		%A,	ILCHAR	(%OP+%Q)
BLDBCMC	000203'	135147	000001		LDB	C,1(M)		;GET ILLEGAL CHARACTER
BCAILCC	000204'	301140	000040		CAIL	C,40		;IS IT A NON-PRINTING CHAR.
BJRSTILLCH1C	000205'	254000	000212'		JRST	ILLCH1		;NO
BMOVEBCC	000206'	200100	000003		MOVE	B,C		;SAVE CHAR.
BMOVEICC	000207'	201140	000136		MOVEI	C,"^"
BPUSHJPTYPCHRC	000210'	260740	000044'		PUSHJ	P,TYPCHR
BMOVEICBC	000211'	201142	000100		MOVEI	C,100(B)	;RESTORE AS A PRINTING CHAR.
BILLCH1PUSHJPTYPCHRC	000212'	260740	000044'	ILLCH1:	PUSHJ	P,TYPCHR	;TYPE IT
BPUSHJPTYPARGC	000213'	260740	000003'		PUSHJ	P,TYPARG
B%AASCIZ%OP%%FC	000214'	700002	000676'		%A,	[ASCIZ /,IN INPUT STRING /] (%OP+%%F)
BC
BC				;DEVICE NOT AVAILABLE ON INITIALIZATION
BC				;THE DEV. NAME IS IN SIXBIT AND IN LOCATION INIT.+1
BC
BINIER.PUSHJPITYPM.C	000215'	260740	000030'	INIER.:	PUSHJ	P,ITYPM.
B%SINIT.%OP%Q%LC	000216'	730100	000001*		%S,	INIT.+1	(%OP+%Q+%L)
B%AASCIZ%OP%%PC	000217'	700001	000702'		%A,	[ASCIZ /NOT AVAILABLE/] (%OP+%%P)
BC
BC				;NON-EXISTENT DEVICE SELECTED
BC				;THE DEV. NO. IS IN OCTAL AND IS IN AC 0.
BC
BDEVER.PUSHJPITYPM.C	000220'	260740	000030'	DEVER.:	PUSHJ	P,ITYPM.
B%AASCIZ%OP%QC	000221'	720000	000705'		%A,	[ASCIZ /DEVICE NUMBER /] (%OP+%Q)
B%D%OPC	000222'	700300	000000		%D,	0	(%OP)
B%AASCIZ%OP%%PC	000223'	700001	000710'		%A,	[ASCIZ / IS ILLEGAL/] (%OP+%%P)
BC
BC				;TOO MANY DEVICES REQUESTED
BC
BTBLER.PUSHJPITYPM.C	000224'	260740	000030'	TBLER.:	PUSHJ	P,ITYPM.
B%AASCIZ%OP%Q%%PC	000225'	720001	000713'		%A,	[ASCIZ /MORE THAN 15 DEVICES REQUESTED/] (%OP+%Q+%%P)
BC
BC				;ILLEGAL POSITION IN POSITION STATEMENT
BC
BILLPS.AOSASVAR.LOWC	000226'	350000	000000*	ILLPS.:	AOS	ASVAR.(LOW)	;RESET POSITION
BPUSHJPITYPM.C	000227'	260740	000030'		PUSHJ	P,ITYPM.
B%AASCIZ%OP%QC	000230'	720000	000722'		%A,	[ASCIZ	/ILLEGAL FILE POSITION: /] (%OP+%Q)
B%DASVAR.%OP%L%%PC	000231'	710301	000226*		%D,	ASVAR.		(%OP+%L+%%P)
BC
BC				;UNIT NUMBER IN USE
BC
BAROPN.PUSHJPITYPM.C	000232'	260740	000030'	AROPN.:	PUSHJ	P,ITYPM.
B%AASCIZ%OP%QC	000233'	720000	000727'		%A,	[ASCIZ	/UNIT NUMBER /] (%OP+%Q)
B%DDVNUM.%OP%LC	000234'	710300	000000*		%D,	DVNUM.		(%OP+%L)
B%AASCIZ%OP%%PC	000235'	700001	000732'		%A,	[ASCIZ	/ IN USE/] (%OP+%%P)
BC
BC				;ILLEGAL FILE NAME IN OPEN STATEMENT
BC
BILLFN.PUSHJPITYPM.C	000236'	260740	000030'	ILLFN.:	PUSHJ	P,ITYPM.
B%AASCIZ%OP%QDERROR.  V.32(426)   ERROR ROUTINES-FORTRAN IV	MACRO 46-6 08:54 18-APR-73 PAGE 5-2
ERROR.MAC	18-APR-73 08:54		ERROR MESSAGE TYPE -OUT ROUTINE

BC	000237'	720000	000734'		%A,	[ASCIZ	/ILLEGAL FILE NAME: /] (%OP+%Q)
B%AFNM.%OP%L%%PC	000240'	710021	000000*		%A,	@FNM.	(%OP+%L+%%P)
ERROR.  V.32(426)   ERROR ROUTINES-FORTRAN IV	MACRO 46-6 08:54 18-APR-73 PAGE 6
ERROR.MAC	18-APR-73 08:54		ERROR MESSAGE TYPE -OUT ROUTINE

BC				;LOOKUP OR ENTER  ERROR
BC				;THE FILE NAME IS IN SIXBIT AND IS IN THE GLOBAL WORD TEMP.
BC				;THE DEV. NAME IS IN SIXBIT AND IS IN THE GLOBAL WORD DEVIC.
BC
BNOROM.HRRZTEMP.LOWC	000241'	550000	000003*	NOROM.:	HRRZ	0,TEMP.+3(LOW)	;GET ERROR CODE
BJUMPNMSNG1C	000242'	326000	000246'		JUMPN	0,MSNG1		;COMMON ERROR IF NOT CODE 0
BMOVEIASCIZC	000243'	201000	000740'		MOVEI	0,[ASCIZ /(0) NO ROOM/]
BJRSTMSNG2C	000244'	254000	000252'		JRST	MSNG2		;JOIN ERROR PRINTER
BC
BMSNG.HRRZTEMP.LOW0245'	550000	000003*	MSNG.:	HRRZ	0,TEMP.+3(LOW)	;GET ERROR CODE
BMSNG1ADDITABLEC	000246'	271000	000313'	MSNG1:	ADDI	0,TABLE		;GET MESSAGE
BCAILETABLNDC	000247'	303000	000334'		CAILE	0,TABLND	;IN BOUNDS?
BMOVEITABLNDC	000250'	201000	000334'		MOVEI	0,TABLND	;NO, USE CATCHALL MESSAGE
BMOVEC	000251'	200020	000000		MOVE	0,@0		;GET ADDRESS OF MESSAGE
BMSNG2LSHCC	000252'	242140	777777	MSNG2:	LSH	C,-1		;RESTORE CHANNEL NUMBER
BDEVNAMCC	000253'	047140	000064		DEVNAME	C,		;GET DEVICE NAME
BMOVECDEVIC.LOWC	000254'	200140	000172*		MOVE	C,DEVIC.(LOW)	;ON ERROR, USE LOGICAL DEVICE NAME
BMOVEMCTEMP.LOWC	000255'	202140	000004*		MOVEM	C,TEMP.+4(LOW)	;SAVE FOR MESSAGE
BPUSHJPITYPM.C	000256'	260740	000030'		PUSHJ	P,ITYPM.
B%AASCIZ%OP%QC	000257'	720000	000743'		%A,	[ASCIZ /FILE /] (%OP+%Q)
BMOVEBPC	000260'	200117	777777		MOVE	B,-1(P)		;GET PPN WORD
BJUMPEBMSNG3C	000261'	322100	000271'		JUMPE	B,MSNG3		;USERS OWN DIRECTORY
BTLNEBC	000262'	603100	777777		TLNE	B,-1		;IS IT A USER NAME OR PPN
BJRSTMSNG3C	000263'	254000	000271'		JRST	MSNG3		;PPN
BPUSHJPITYPM.C	000264'	260740	000030'		PUSHJ	P,ITYPM.
B%AASCIZ%OPC	000265'	700000	000745'		%A,	[ASCIZ /(/] (%OP)
B%SB%OPC	000266'	700120	000002		%S,	@B (%OP)
B%AASCIZ%OPC	000267'	700000	000746'		%A,	[ASCIZ /)/] (%OP)
BSETZBC	000270'	400100	000000		SETZ	B,
BMSNG3PUSHJPITYPM.C	000271'	260740	000030'	MSNG3:	PUSHJ	P,ITYPM.
B%STEMP.%OP%LC	000272'	710100	000004*		%S,	TEMP.+4 (%OP+%L)
B%AASCIZ%OPC	000273'	700000	000747'		%A,	[ASCIZ /:/] (%OP)
B%STEMP.%OP%LC	000274'	710100	000002*		%S,	TEMP.+2 (%OP+%L)
B%AASCIZ%OPC	000275'	700000	000750'		%A,	[ASCIZ /./] (%OP)
B%SINIT.%OP%LC	000276'	710100	000001*		%S,	INIT.+1 (%OP+%L)
BJUMPEBMSNG4C	000277'	322100	000307'		JUMPE	B,MSNG4
BHLRMBTEMP.LOWC	000300'	546100	000001*		HLRM	B,TEMP.+1(LOW)
BPUSHJPITYPM.C	000301'	260740	000030'		PUSHJ	P,ITYPM.
B%AASCIZ%OPC	000302'	700000	000751'		%A,	[ASCIZ /[/] (%OP)
B%NOTEMP.%OP%LC	000303'	710500	000001*		%NO,	TEMP.+1 (%OP+%L)
B%AASCIZ%OPC	000304'	700000	000752'		%A,	[ASCIZ /,/] (%OP)
B%NOB%OPC	000305'	700500	000002		%NO,	B (%OP)
B%AASCIZ%OPC	000306'	700000	000753'		%A,	[ASCIZ /]/] (%OP)
BMSNG4PUSHJPITYPM.C	000307'	260740	000030'	MSNG4:	PUSHJ	P,ITYPM.
B%AASCIZ%OPC	000310'	700000	000754'		%A,	[ASCIZ / ON DEVICE /] (%OP)
B%SDEVIC.%OP%LC	000311'	710100	000254*		%S,	DEVIC. (%OP+%L)
B%A%OP%%PC	000312'	700021	000000		%A,	@0 (%OP+%%P)
BC
BTABLEASCIZC	000313'	000000	000757'	TABLE:	[ASCIZ / (0) WAS NOT FOUND/]
BASCIZC	000314'	000000	000763'		[ASCIZ / (1) NO DIRECTORY FOR PROJECT-PROGRAMMER NUMBER/]
BASCIZC	000315'	000000	000775'		[ASCIZ / (2) PROTECTION FAILURE/]
BASCIZC	000316'	000000	001002'		[ASCIZ / (3) FILE WAS BEING MODIFIED/]
BASCIZC	000317'	000000	001010'		[ASCIZ / (4) ENTER WITH DIFFERENT FILENAME/]
BASCIZDERROR.  V.32(426)   ERROR ROUTINES-FORTRAN IV	MACRO 46-6 08:54 18-APR-73 PAGE 6-2
ERROR.MAC	18-APR-73 08:54		ERROR MESSAGE TYPE -OUT ROUTINE

BC	000320'	000000	001017'		[ASCIZ / (5) ILLEGAL SEQUENCE OF UUOS/]
BASCIZC	000321'	000000	001025'		[ASCIZ / (6) BAD UFD OR BAD RIB/]
BASCIZC	000322'	000000	001032'		[ASCIZ / (7)/]
BASCIZC	000323'	000000	001033'		[ASCIZ / (10)/]
BASCIZC	000324'	000000	001035'		[ASCIZ / (11)/]
BASCIZC	000325'	000000	001037'		[ASCIZ / (12)/]
BASCIZC	000326'	000000	001041'		[ASCIZ / (13)/]
BASCIZC	000327'	000000	001043'		[ASCIZ / (14) NO ROOM OR QUOTA EXCEEDED/]
BASCIZC	000330'	000000	001052'		[ASCIZ / (15) WRITE LOCK ERROR/]
BASCIZC	000331'	000000	001057'		[ASCIZ / (16) NOT ENOUGH MONITOR TABLE SPACE/]
BASCIZC	000332'	000000	001067'		[ASCIZ / (17) PARTIAL ALLOCATION ONLY/]
BASCIZC	000333'	000000	001075'		[ASCIZ / (20) BLOCK NOT FREE ON ALLOCATION/]
BC
BTABLNDASCIZC	000334'	000000	001104'	TABLND:	[ASCIZ / (?) LOOKUP OR ENTER ERROR/]
BC
ERROR.  V.32(426)   ERROR ROUTINES-FORTRAN IV	MACRO 46-6 08:54 18-APR-73 PAGE 7
ERROR.MAC	18-APR-73 08:54		ERROR MESSAGE TYPE -OUT ROUTINE

BC				;WRITE PROTECTION ERROR
BC				;THE DEV. NAME IS IN SIXBIT AND IS IN THE GLOBAL WORD DEVIC.
BC
BWLKER.PUSHJPITYPM.C	000335'	260740	000030'	WLKER.:	PUSHJ	P,ITYPM.
B%SDEVIC.%OP%Q%LC	000336'	730100	000311*		%S,	DEVIC.	(%OP+%Q+%L)
B%AASCIZ%OP%%PC	000337'	700001	001112'		%A,	[ASCIZ /  WRITE PROTECTED/] (%OP+%%P)
BC
BC				;DATA LIST TOO LONG ON BINARY TAPE READ
BC				;THE DEV. NAME IS IN SIXBIT AND IS IN THE GLOBAL WORD DEVIC.
BC
BLISTB.PUSHJPITYPM.C	000340'	260740	000030'	LISTB.:	PUSHJ	P,ITYPM.
B%AASCIZ%OP%QC	000341'	720000	001116'		%A,	[ASCIZ /TAPE RECORD TOO SHORT ON UNIT /] (%OP+%Q)
B%SDEVIC.%OP%L%%PC	000342'	710101	000336*		%S,	DEVIC.	(%OP+%L+%%P)
BC
BC
BC				;DATA MISSED ERROR
BC				;THE DEV. NAME IS IN SIXBIT AND IS IN THE GLOBAL WORD DEVIC.
BC				;AC 11 IS THE FLAG WHICH SAYS EITHER INPUT OR OUTPUT
BC
BC
BC
BREDER.LSHIC	000343'	242440	777735	REDER.:	LSH	I,-43		;INPUT OR OUTPUT BIT
BMOVEBINIC	000344'	200111	000453'		MOVE	B,IN(I)		;MOVE INPUT OR OUTPT MESS. TO B
BPUSHJPITYPM.C	000345'	260740	000030'		PUSHJ	P,ITYPM.
B%SB%OP%QC	000346'	720100	000002		%S,	B	(%OP+%Q)
B%AASCIZ%OPC	000347'	700000	001125'		%A,	[ASCIZ /DEVICE ERROR ON /] (%OP)
B%SDEVIC.%OP%L%%PC	000350'	710101	000342*		%S,	DEVIC.	(%OP+%L+%%P)
BC
BC				;BLOCK TOO LARGE ERROR (QUOTA EXCEEDED ON DSK) 
BC				;THE DEV. NAME IS IN SIXBIT AND IS IN THE GLOBAL WORD DEVIC.
BC
BBTLER.PUSHJPITYPM.C	000351'	260740	000030'	BTLER.:	PUSHJ	P,ITYPM.
B%AASCIZ%OP%QC	000352'	720000	001131'		%A,	[ASCIZ /BLOCK TOO LARGE OR QUOTA EXCEEDED ON /]	(%OP+%Q)
B%SDEVIC.%OP%L%%PC	000353'	710101	000350*		%S,	DEVIC.	(%OP+%L+%%P)
ERROR.  V.32(426)   ERROR ROUTINES-FORTRAN IV	MACRO 46-6 08:54 18-APR-73 PAGE 8
ERROR.MAC	18-APR-73 08:54		ERROR MESSAGE TYPE -OUT ROUTINE

BC				;END OF TAPE
BC				;THE DEV. NAME IS IN SIXBIT AND IS IN THE GLOBAL WORD DEVIC.
BC
BENDTP.PUSHJPITYPM.C	000354'	260740	000030'	ENDTP.:	PUSHJ	P,ITYPM.
B%AASCIZ%OP%QC	000355'	720000	001141'		%A,	[ASCIZ /END OF TAPE ON /] (%OP+%Q)
B%SDEVIC.%OP%L%%PC	000356'	710101	000353*		%S,	DEVIC.	(%OP+%L+%%P)
BC
BC				;BINARY MODE PHASE ERROR
BC				;THE DEV. NAME IS IN SIXBIT AND IS IN THE GLOBAL WORD DEVIC.
BC
BBPHSE.PUSHJPITYPM.C	000357'	260740	000030'	BPHSE.:	PUSHJ	P,ITYPM.
B%AASCIZ%OP%QC	000360'	720000	001145'		%A,	[ASCIZ /ILLEGAL PHYSICAL RECORD COUNT, TAPE /] (%OP+%Q)
B%SDEVIC.%OP%L%%PC	000361'	710101	000356*		%S,	DEVIC.	(%OP+%L+%%P)
BC
BC				;ILLEGAL MAG TAPE OPERATION
BC				;THE DEV. NAME IS IN SIXBIT AND IS IN THE GLOBAL WORD DEVIC.
BC
BILLMG.PUSHJPITYPM.C	000362'	260740	000030'	ILLMG.:	PUSHJ	P,ITYPM.
B%AASCIZ%OP%QC	000363'	720000	001155'		%A,	[ASCIZ /ILLEGAL MAGNETIC TAPE OPERATION, TAPE /] (%OP+%Q)
B%SDEVIC.%OP%L%%PC	000364'	710101	000361*		%S,	DEVIC.	(%OP+%L+%%P)
BC
BC				;NAMELIST SYNTAX ERROR
BC
BNMLER.PUSHJPITYPM.C	000365'	260740	000030'	NMLER.:	PUSHJ	P,ITYPM.
B%AASCIZ%OP%Q%%PC	000366'	720001	001165'		%A,	[ASCIZ /NAMELIST SYNTAX ERROR/] (%OP+%Q+%%P)
BC
BC				;REREAD DONE BEFORE READ
BC
BILRED.PUSHJPITYPM.C	000367'	260740	000030'	ILRED.:	PUSHJ	P,ITYPM.
B%AASCIZ%OP%Q%%PC	000370'	720001	001172'		%A,	[ASCIZ /REREAD EXECUTED BEFORE FIRST READ/] (%OP+%Q+%%P)
BC
BC				;PARITY ERROR
BC				;THE DEV. NAME IS IN SIXBIT AND IS IN THE GLOBAL WORD DEVIC.
BC
BPARER.PUSHJPITYPM.C	000371'	260740	000030'	PARER.:	PUSHJ	P,ITYPM.
B%AASCIZ%OP%QC	000372'	720000	001201'		%A,	[ASCIZ /PARITY ERROR ON /] (%OP+%Q)
B%SDEVIC.%OP%L%%PC	000373'	710101	000364*		%S,	DEVIC.	(%OP+%L+%%P)
BC
BC				;DUMMY ROUTINE LOADED INSTEAD OF REAL ONE
BC				;AC 2 CONTAINS THE ADD. OF THE PROG. NAME 
BC
BDUMER.MOVEBBC	000374'	200102	000000	DUMER.:	MOVE	B,0(B)		;GET PROG. NAME FROM DUMMY ROUTINE
BPUSHJPITYPM.C	000375'	260740	000030'		PUSHJ	P,ITYPM.
B%AIB%OP%QC	000376'	720040	000002		%AI,	B	(%OP+%Q)
B%AASCIZ%OP%%PC	000377'	700001	001205'		%A,	[ASCIZ / NOT LOADED/] (%OP+%%P)
ERROR.  V.32(426)   ERROR ROUTINES-FORTRAN IV	MACRO 46-6 08:54 18-APR-73 PAGE 9
ERROR.MAC	18-APR-73 08:54		ERROR MESSAGE TYPE -OUT ROUTINE

BC				;ILLEGAL USER UUO TO FORTRAN OP SYSTEM
BC				;AC 0 CONTAINS THE ADD. OF THE UUO WHICH IS IN OCTAL.
BC				;THE USERS LOC. IS IN THE GLOBAL UUOH.(LOW) AND IS IN OCTAL.
BC
BC
BC
BILUUO.SOSUUOH.LOWC	000400'	370000	000000*	ILUUO.:	SOS	UUOH.(LOW)	;P.C. NOW POINTS TO USERS LOC
BMOVEBUUOH.LOWC	000401'	200120	000400*		MOVE	B,@UUOH.(LOW)	;CONTENTS OF UUOH.
BMOVEUUOH.LOWC	000402'	200000	000401*		MOVE	0,UUOH.(LOW)	;AND ADDRESS OF UUO
BPUSHJPITYPM.C	000403'	260740	000030'		PUSHJ	P,ITYPM.
B%AASCIZ%OP%QC	000404'	720000	001210'		%A,	[ASCIZ /ILLEGAL USER UUO /] (%OP+%Q)
B%OOB%OPC	000405'	700440	000002		%OO,	B	(%OP)
B%AASCIZ%OPC	000406'	700000	001214'		%A,	[ASCIZ /AT USER /] (%OP)
B%O%OPC	000407'	700240	000000		%O,	0	(%OP)
BJRSTCLSEC	000410'	254000	000163'		JRST	CLSE		;EXIT FROM PROGRAM.
BC
BC				;PRINT USER LOCATION
BC				;THE USERS LOC. IS IN THE GLOBAL UUOH.(LOW) AND IS IN OCTAL.
BC
BUSRLOCSOSUUOH.LOWC	000411'	370000	000402*	USRLOC:	SOS	UUOH.(LOW)	;P.C. NOW POINTS TO USER'S LOCATION+0
BMOVEUUOH.LOWC	000412'	200000	000411*		MOVE	0,UUOH.(LOW)	;GET ADDRESS
BPUSHJPITYPM.C	000413'	260740	000030'		PUSHJ	P,ITYPM.
B%AASCIZC					%A,	[ASCIZ /
B%OPC	000414'	700000	001216'	LAST FORTRAN I-O AT USER LOC /] (%OP)
B%O%OPC	000415'	700240	000000		%O,	0	(%OP)
BPOPJPC	000416'	263740	000000		POPJ	P,
BC
ERROR.  V.32(426)   ERROR ROUTINES-FORTRAN IV	MACRO 46-6 08:54 18-APR-73 PAGE 10
ERROR.MAC	18-APR-73 08:54		ERROR MESSAGE TYPE -OUT ROUTINE

BC				;NOT ENOUGH CORE FOR BUFFERS, CAUSED BY BUFFER PROGRAM OR RANDOM ACCESS
BC
BBUFER.PUSHJPITYPM.C	000417'	260740	000030'	BUFER.:	PUSHJ	P,ITYPM.
B%AASCIZ%OP%Q%%PC	000420'	720001	001225'		%A,	[ASCIZ /NOT ENOUGH CORE FOR BUFFERS/] (%OP+%Q+%%P)
BC
BC
BC				;RANDOM ACCESS DEVICE MUST BE DSK TYPE
BC				;DEVICE NUMBER IS IN DVNUM. IN OCTAL
BC
BRANER.PUSHJPITYPM.C	000421'	260740	000030'	RANER.:	PUSHJ	P,ITYPM.
B%AASCIZ%OP%QC	000422'	720000	000705'		%A,	[ASCIZ /DEVICE NUMBER /] (%OP+%Q)
B%DDVNUM.%OP%LC	000423'	710300	000234*		%D,	DVNUM.		(%OP+%L)
B%AASCIZ%OP%%PC	000424'	700001	001233'		%A,	[ASCIZ / MUST BE DSK FOR RANDOM ACCESS/] (%OP+%%P)
BC
BC				;ASTRK. OUTPUTS ASTERISKS IF THE FORMAT FIELD IS TOO SMALL FOR
BC				;THE NUMBER TO BE OUTPUT
BC				;EXPECTS FIELD WIDTH IN AC 4 (NUMBER OF * TO GO OUT)
BACWC			000004		ACW==4
BASTRK.C	000425'			ASTRK.:
BIFEASTFLC				IFE ASTFL,<HALT	.+1		;HALT IF GET HERE, RETURN ON CONTINUE>
BIFNASTFLMOVEIC	000425'	201000	000052	IFN ASTFL,<MOVEI 0,"*"		;SET UP *
BPUSHJPDEPOT.C	000426'	260740	000000*		PUSHJ	P,DEPOT.	;OUTPUT IT
BSOJGACWC	000427'	367200	000426'		SOJG	ACW,.-1		;LOOP
BAOSACWERRTB.ERRLN.LOWC	000430'	350200	000016*		AOS	ACW,ERRTB.+ERRLN.-2(LOW)
BHLLACWLSTERRC	000431'	500200	000626'		HLL	ACW,LSTERR-1	;GET TEXT OF MESSAGE
BMOVEMACWERRTB.ERRLN.LOWC	000432'	202200	000016*		MOVEM	ACW,ERRTB.+ERRLN.-2(LOW)	;SAVE IN TABLE
BAOSERRCT.LOWC	000433'	350000	000166*		AOS	ERRCT.(LOW)	;INCREMENT ERRORS>
BPOPJPC	000434'	263740	000000		POPJ	P,		;TIL DONE
BC
ERROR.  V.32(426)   ERROR ROUTINES-FORTRAN IV	MACRO 46-6 08:54 18-APR-73 PAGE 11
ERROR.MAC	18-APR-73 08:54		ERROR MESSAGE TYPE -OUT ROUTINE

BC
BC
BILCHARASCIZC	000435'	446311	442616	ILCHAR:	ASCIZ	/ILLEGAL CHARACTER /
	000436'	406304	041620
	000437'	406450	141650
	000440'	426444	000000
BC
BCRLFASCIZC	000441'			CRLF:	ASCIZ	/
BC	000441'	064240	000000	/
BTCRLFMOVEIACRLFC	000442'	201040	000441'	TCRLF:	MOVEI	A,CRLF
BPUSHJPTYPMESC	000443'	260740	000047'		PUSHJ	P,TYPMES
BJRSTNXTARGC	000444'	254000	000001'		JRST	NXTARG
BC
BC
BCRLFQTTCALLC	000445'	051540	000000	CRLFQ:	TTCALL	13,0		;TURN OFF ^O
BJFCLC	000446'	255000	000000		  JFCL
BMOVEIAASCIZC					MOVEI	A,[ASCIZ /
BC	000447'	201040	001242'	? /]
BPUSHJPTYPMESC	000450'	260740	000047'		PUSHJ	P,TYPMES
BMOVEAPC	000451'	200077	777777		MOVE	A,@-1(P)
BPOPJPC	000452'	263740	000000		POPJ	P,
BC
BC
BINSIXBITC	000453'	515660	656400	IN:	SIXBIT	/INPUT/
BSIXBITC	000454'	576564	606400		SIXBIT	/OUTPT/
BC
BC
ERROR.  V.32(426)   ERROR ROUTINES-FORTRAN IV	MACRO 46-6 08:54 18-APR-73 PAGE 12
ERROR.MAC	18-APR-73 08:54		ERROR MESSAGE TYPE -OUT ROUTINE

BC				;INITIALIZE ERROR ROUTINE- PUSHJ P,ERRINI
BC				;TABLE IS CLEARED BY RESET. UUO IN FORSE
BC
BOPDEFCALLIMSTIMEC				OPDEF  MSTIME [CALLI 23]	;GET TIME OF DAY IN MILLISECONDS
BOPDEFCALLIRUNTIMC				OPDEF RUNTIM [CALLI 27]		;GET EXECUTION TIME IN MILLISECONDS
BC
BERRIN.C	000455'			ERRIN.:
BIFEWATCHMSTIMEAC	000455'	047040	000023	IFE WATCH,<MSTIME A,
BMOVEMADAYTM.LOWC	000456'	202040	000000*		MOVEM	A,DAYTM.(LOW)	;GET TIME OF DAY (MILLISECONDS)
BMOVEIAC	000457'	201040	000000		MOVEI	A,0
BRUNTIMAC	000460'	047040	000027		RUNTIME	A,		;GET TOTAL RUNTIME SO FAR
BMOVEMAXCTTM.LOWC	000461'	202040	000000*		MOVEM	A,XCTTM.(LOW)	; AND SAVE AS EXECUTION TIME>
BMOVEIC	000462'	201000	000002		MOVEI	0,2
BMOVEMERRMX.LOWC	000463'	202000	000000*		MOVEM	0,ERRMX.(LOW)	;SET UP MAXIMUM ERROR NUMBER
BPOPJPC	000464'	263740	000000		POPJ	P,		;RETURN
BC
BC				;THIS IS THE PRELIMINARY ERRMSG ROUTINE TO BE USED BY
BC				;OVTRAP, TYPER., AND MISC. MATH ROUTINES IN LIB40.
BC
BERRMSGMOVEAAC	000465'	200041	000000	ERRMSG:	MOVE	A,(A)		;GET ERROR POINTERS
BTLNNAC	000466'	607040	777777		TLNN	A,-1		;STANDARD ERROR MESSAGE NEEDED?
BMOVEANO.TABAC	000467'	200041	000620'		MOVE	A,NO.TAB-1(A)	;YES, GET STANDARD MESSAGE
BHRRZBAC	000470'	550100	000001		HRRZ	B,A		;GET ERROR NUMBER ONLY
BCAILEBC	000471'	303100	000000		CAILE	B,0		;TEST FOR INSIDE TABLE RANGE
BCAILEBERRLN.C	000472'	303100	000020		CAILE	B,ERRLN.
BJRSTERRMS2C	000473'	254000	000503'		JRST	ERRMS2		;OUTSIDE
BIFNREENTC				IFN REENT,<ADDI	A,(LOW)>
BHRRZBERRTB.AC	000474'	550101	777777*		HRRZ	B,ERRTB.-1(A)	;GET ERROR COUNT
BCAIEBC	000475'	302100	777777		CAIE	B,777777	;WILL INDEXING IT OVERFLOW?
BAOSERRTB.AC	000476'	350001	777777*		AOS	ERRTB.-1(A)	;NO, DO SO
BHLLMAERRTB.AC	000477'	502041	777777*		HLLM	A,ERRTB.-1(A)	;SAVE ADDRESS IN TABLE
BAOSERRCT.LOWC	000500'	350000	000433*		AOS	ERRCT.(LOW)	;INDEX ERROR COUNTER
BCAMLBERRMX.LOWC	000501'	311100	000463*		CAML	B,ERRMX.(LOW)	;PRINT MESSAGE IF NOT TOO MANY ERRORS
BJRSTSKPARGC	000502'	254000	000000'		JRST	SKPARG		;SUPPRESS TYPE OUT
BERRMS2MOVEBAC	000503'	200100	000001	ERRMS2:	MOVE	B,A
BMOVEIACRLFC	000504'	201040	000441'		MOVEI	A,CRLF
BPUSHJPTYPMESC	000505'	260740	000047'		PUSHJ	P,TYPMES
BHLRZABC	000506'	554040	000002		HLRZ	A,B
BPUSHJPTYPMESC	000507'	260740	000047'		PUSHJ	P,TYPMES
BMOVEIAASCIZC	000510'	201040	001243'		MOVEI	A,[ASCIZ /	PC=/]
BPUSHJPTYPMESC	000511'	260740	000047'		PUSHJ	P,TYPMES
BJRSTMOR2DOC	000512'	254000	000054'		JRST	MOR2DO
BC
ERROR.  V.32(426)   ERROR ROUTINES-FORTRAN IV	MACRO 46-6 08:54 18-APR-73 PAGE 13
ERROR.MAC	18-APR-73 08:54		ERROR MESSAGE TYPE -OUT ROUTINE

BC				;TYPE EXECUTION SUMMARY
BERRFI.TTCALLC	000513'	051540	000000	ERRFI.:	TTCALL	13,0		;TURN OFF ^O, SOMETIMES
BJFCLC	000514'	255000	000000		  JFCL
BIFEWATCHSETZBC	000515'	400100	000000	IFE WATCH,<SETZ	B,
BRUNTIMBC	000516'	047100	000027		RUNTIME	B,		;GET TOTAL RUN TIME
BSUBBXCTTM.LOWC	000517'	274100	000461*		SUB	B,XCTTM.(LOW)	;GET TIME FOR THIS PROGRAM
BPUSHJPTYPARGC	000520'	260740	000003'		PUSHJ	P,TYPARG
B%AASCIZC					%A,	[ASCIZ /
BC				
B%OPC	000521'	700000	001244'	CPU TIME: /] (%OP)
B%TB%OPC	000522'	700340	000002		%T,	B	(%OP)
BMSTIMEBC	000523'	047100	000023		MSTIME	B,		;GET TIME OF DAY
BSUBBDAYTM.LOWC	000524'	274100	000456*		SUB	B,DAYTM.(LOW)	;GET TIME FOR THIS PROGRAM
BJUMPGEBC	000525'	325100	000527'		JUMPGE	B,.+2
BADDBC	000526'	270100	001247'		ADD	B,[^D1000*^D3600*^D24]	;ADD MILLISECONDS IN A DAY
BPUSHJPTYPARGC	000527'	260740	000003'		PUSHJ	P,TYPARG
B%AASCIZ%OPC	000530'	700000	001250'		%A,	[ASCIZ /	ELAPSED TIME: /] (%OP)
B%TB%OPC	000531'	700340	000002		%T,	B	(%OP)
BC
BC				>
BSKIPNERRCT.LOWC	000532'	336000	000500*		SKIPN	ERRCT.(LOW)	;ANY ERRORS?
BJRSTERRFN9C	000533'	254000	000553'		JRST	ERRFN9		;NO, SAY SO
BPUSHJPTYPARGC	000534'	260740	000003'		PUSHJ	P,TYPARG
B%AASCIZC					%A,	[ASCIZ /
BC				
BC				NO. OF ERRORS		ERROR TYPE
B%OPC	000535'	700000	001254'	/]	(%OP)
BMOVSIDERRLN.C	000536'	205200	777760		MOVSI	D,-ERRLN.	;GET LENGTH OF TABLE
BIFNREENTC				IFN REENT,<ADDI	D,(LOW)>
BERRFN1HRRZBERRTB.DC	000537'	550104	000000*	ERRFN1:	HRRZ	B,ERRTB.(D)	;GET ERROR COUNT FOR THIS MESSAGE
BJUMPEBERRFN2C	000540'	322100	000551'		JUMPE	B,ERRFN2	;TRANSFER IF NONE
BPUSHJPERRNUMC	000541'	260740	000610'		PUSHJ	P,ERRNUM	;PRINT NUMBER
BMOVEICC	000542'	201140	000011		MOVEI	C,11		;PRINT TAB
BPUSHJPTYPCHRC	000543'	260740	000044'		PUSHJ	P,TYPCHR
BPUSHJPTYPCHRC	000544'	260740	000044'		PUSHJ	P,TYPCHR
BHLRZAERRTB.DC	000545'	554044	000537*		HLRZ	A,ERRTB.(D)	;GET ADDRESS OF MESSAGE
BPUSHJPTYPMESC	000546'	260740	000047'		PUSHJ	P,TYPMES	;PRINT MESSAGE
BMOVEIACRLFC	000547'	201040	000441'		MOVEI	A,CRLF		;FINISH WITH CR-LF
BPUSHJPTYPMESC	000550'	260740	000047'		PUSHJ	P,TYPMES
BERRFN2AOBJNDERRFN1C	000551'	253200	000537'	ERRFN2:	AOBJN	D,ERRFN1	;LOOP UNTIL FINISHED
BPOPJPC	000552'	263740	000000		POPJ	P,		;ERROR SUMMARY COMPLETED
BC
BERRFN9PUSHJPTYPARGC	000553'	260740	000003'	ERRFN9:	PUSHJ	P,TYPARG
B%AASCIZC					%A,	[ASCIZ /
BC				NO EXECUTION ERRORS DETECTED
B%OPC	000554'	700000	001263'	/]	(%OP)
BPOPJPC	000555'	263740	000000		POPJ	P,		;ERROR SUMMARY COMPLETED
BC
ERROR.  V.32(426)   ERROR ROUTINES-FORTRAN IV	MACRO 46-6 08:54 18-APR-73 PAGE 14
ERROR.MAC	18-APR-73 08:54		ERROR MESSAGE TYPE -OUT ROUTINE

BC				;PRINT TIME IN FORMAT - HH:MM:SS.HH
BC
BPNTTIMMOVEBAC	000556'	200101	000000	PNTTIM:	MOVE	B,(A)
BADDIBC	000557'	271100	000005		ADDI	B,5		;ROUND NUMBER TO HUNDREDTHS OF SECONDS
BIDIVIBC	000560'	231100	001750		IDIVI	B,^D1000	;CHANGE MILLISECONDS INTO SECONDS
BPUSHPBC	000561'	261740	000003		PUSH	P,B+1		;SAVE THOUSANDTHS OF A SECOND
BIDIVIBC	000562'	231100	000074		IDIVI	B,^D60		;CHANGE SECONDS TO MINUTES
BPUSHPBC	000563'	261740	000003		PUSH	P,B+1		;SAVE SECONDS
BJUMPEBPNTTM2C	000564'	322100	000577'		JUMPE	B,PNTTM2	;SUPPRESS MINUTES IF NONE
BIDIVIBC	000565'	231100	000074		IDIVI	B,^D60		;CHANGE MINUTES TO HOURS
BPUSHPBC	000566'	261740	000003		PUSH	P,B+1		;SAVE MINUTES
BJUMPEBPNTTM1C	000567'	322100	000573'		JUMPE	B,PNTTM1	;SUPPRESS HOURS IF NONE
BPUSHJPERRNUMC	000570'	260740	000610'		PUSHJ	P,ERRNUM	;PRINT HOURS
BMOVEICC	000571'	201140	000072		MOVEI	C,":"		;SEPARATE BY COLON
BPUSHJPTYPCHRC	000572'	260740	000044'		PUSHJ	P,TYPCHR
BPNTTM1POPPBC	000573'	262740	000002	PNTTM1:	POP	P,B		;GET MINUTES BACK
BPUSHJPERRNUMC	000574'	260740	000610'		PUSHJ	P,ERRNUM	;PRINT MINUTES
BMOVEICC	000575'	201140	000072		MOVEI	C,":"		;SEPARATE BY COLON
BPUSHJPTYPCHRC	000576'	260740	000044'		PUSHJ	P,TYPCHR
BPNTTM2POPPBC	000577'	262740	000002	PNTTM2:	POP	P,B		;GET SECONDS BACK
BPUSHJPERRNUMC	000600'	260740	000610'		PUSHJ	P,ERRNUM	;PRINT INTEGER PART
BMOVEICC	000601'	201140	000056		MOVEI	C,"."
BPUSHJPTYPCHRC	000602'	260740	000044'		PUSHJ	P,TYPCHR	;TYPE DECIMAL POINT
BPOPPBC	000603'	262740	000002		POP	P,B		;GET THOUSANDS BACK
BIDIVIBC	000604'	231100	000012		IDIVI	B,^D10		;CHANGE TO HUNDREDTHS
BMOVEIAC	000605'	201040	000002		MOVEI	A,2		;FORCE TWO DIGITS OUT
BPUSHJPERRNM1C	000606'	260740	000611'		PUSHJ	P,ERRNM1	;TYPE TWO DIGITS
BJRSTMOR2DOC	000607'	254000	000054'		JRST	MOR2DO		;SEE IF FINISHED
BC
BC				;TYPE A DECIMAL NUMBER
BERRNUMSETZAC	000610'	400040	000000	ERRNUM:	SETZ	A,		;FOR THIS ENTRY FORCE NO DIGITS OUT
BERRNM1IDIVIBC	000611'	231100	000012	ERRNM1:	IDIVI	B,^D10
BHRLMBPC	000612'	506157	000000		HRLM	B+1,(P)
BSOJGAC	000613'	367040	000615'		SOJG	A,.+2
BJUMPEBC	000614'	322100	000616'		JUMPE	B,.+2
BPUSHJPERRNM1C	000615'	260740	000611'		PUSHJ	P,ERRNM1
BHLRZCPC	000616'	554157	000000		HLRZ	C,(P)
BADDICC	000617'	271140	000060		ADDI	C,"0"
BJRSTTYPCHRC	000620'	254000	000044'		JRST	TYPCHR		;OUTPUT THE CHARACTER
BSUBTTLDERROR.  V.32(426)   ERROR ROUTINES-FORTRAN IV	MACRO 46-6 08:54 18-APR-73 PAGE 15
ERROR.MAC	18-APR-73 08:54		STANDARD MESSAGES

BC				SUBTTL	STANDARD MESSAGES
BC
BNO.TABC	000621'			NO.TAB:
BASCIZC	000621'	001272'	000001		[ASCIZ /INTEGER OVERFLOW/]	,,1
BASCIZC	000622'	001276'	000002		[ASCIZ /INTEGER DIVIDE CHECK/]	,,2
BASCIZC	000623'	001303'	000003		[ASCIZ /FLOATING OVERFLOW/]	,,3
BASCIZC	000624'	001307'	000004		[ASCIZ /FLOATING UNDERFLOW/]	,,4
BASCIZC	000625'	001313'	000005		[ASCIZ /FLOATING DIVIDE CHECK/]	,,5
BC				;ATTEMPT TO TAKE SQRT OF NEGATIVE ARG	,,6
BC				;ACOS OF ARG >1.0 IN MAGNITUDE		,,7
BC				;ASIN OF ARG >1.0 IN MAGNITUDE		,,10
BC				;ATTEMPT TO TAKE LOG OF NEGATIVE ARG	,,11
BC				;ATTEMPT TO TAKE DSQRT OF NEGATIVE ARG	,,12
BC				;ATTEMPT TO TAKE DLOG OF NEGATIVE ARG	,,13
BC				;INVALID PARAMETER FOR BUFFER SUBROUTINES	,,14
BIFNASTFLASCIZERRLN.C	000626'	001320'	000017	IFN ASTFL,<[ASCIZ /OUTPUT FIELD WIDTH OVERFLOW/] ,,ERRLN.-1>
BLSTERRASCIZERRLN.C	000627'	001326'	000020	LSTERR:	[ASCIZ ?FATAL I/O ERROR?]	,,ERRLN.
BC
BC
BC				;OVER/UNDERFLOW ERROR TYPEOUT (MIMIC OVTRAP)
BC				;NO NUMBER FIXUPS ARE DONE.
BC				;TYPER. EXPECTS ITS ARGUMENT IN AC 0
BC
BIFEREENTTYPER.C	000630'			IFE REENT,<TYPER.:>
BIFNREENTC				IFN REENT,<.TYPER:>
BPUSHPDC	000630'	261740	000004		PUSH	P,D		;SAVE D
BTLNEC	000631'	603000	777777		TLNE	0,-1		;IS THIS A CALL FROM A MATH ROUTINE?
BIFEREENTSKIPADC	000632'	334200	000016	IFE REENT,<SKIPA D,16		;YES, GET ADDR. OF CALL TO ROUTINE>
BIFNREENTC				IFN REENT,<SKIPA D,SAVEAC+16(LOW)	;AS ABOVE>
BMOVEDPC	000633'	200217	777777		MOVE	D,-1(P)		;NO, GET ADDR OF PUSHJ
BSUBIDC	000634'	275200	000001		SUBI	D,1		;GET ADDRESS RIGHT
BPUSHPBC	000635'	261740	000002		PUSH	P,B		;SAVE AN AC
BPUSHPCC	000636'	261740	000003		PUSH	P,C
BTLNEC	000637'	603000	777777		TLNE	0,-1		;DO WE NEED A MESSAGE FIX UP?
BJRSTC	000640'	254000	000643'		JRST	.+3		;NO, MESSAGE SUPPLIED
BMOVECC	000641'	200140	000000		MOVE	C,0		;CANNOT INDEX WITH AC0
BMOVENO.TABCC	000642'	200003	000620'		MOVE	0,NO.TAB-1(C)	;GET STANDARD MESSAGE
BTRNNC	000643'	606000	777777		TRNN	0,-1		;FATAL I/O ERROR?
BHRROSDC	000644'	563000	000004		HRROS	D		;SIGNAL TO GO TO CLSE
BPUSHJPITYPM.C	000645'	260740	000030'		PUSHJ	P,ITYPM.
B%E%OPC	000646'	700400	000000		%E,	0	(%OP)	;NO. OF MESSAGE IN AC0
B%OD%OP%%CRC	000647'	700243	000004		%O,	D	(%OP+%%CR)	;PC IN D
BPOPPCC	000650'	262740	000003		POP	P,C
BPOPPBC	000651'	262740	000002		POP	P,B		;RESTORE AC
BJUMPLDCLSEC	000652'	321200	000163'		JUMPL	D,CLSE		;JUMP IF FATAL I/O ERROR
BPOPPDC	000653'	262740	000004		POP	P,D		;RESTORE D
BIFNREENTC				IFN REENT,<XCT	UUOL.(LOW)	;RESTORE AC16>
BPOPJPC	000654'	263740	000000		POPJ	P,		;RETURN
BC
BC
BENDC					END
BERROR.  V.32(426)   ERROR ROUTINES-FORTRAN IV	MACRO 46-6 08:54 18-APR-73
ERROR.MAC	18-APR-73 08:54		C
ERROR.  V.32(426)   ERROR ROUTINES-FORTRAN IV	MACRO 46-6 08:54 18-APR-73 PAGE 15-2
ERROR.MAC	18-APR-73 08:54		STANDARD MESSAGES

NO ERRORS DETECTED
PROGRAM BREAK IS 001332
3K CORE USED
ERROR.  V.32(426)   ERROR ROUTINES-FORTRAN IV	MACRO 46-6 08:54 18-APR-73 PAGE 16
ERROR.MAC	18-APR-73 08:54		SYMBOL TABLE

A		000001		ILLCH1		000212'		TYPARG		000003'		
ACW		000004	SPD	ILLFN.		000236'	INT	TYPCHR		000044'		
AROPN.		000232'	INT	ILLMG.		000362'	INT	TYPER.		000630'	ENT	
ASCII.		000063'		ILLPS.		000226'	INT	TYPMES		000047'		
ASCIIC		000103'		ILRED.		000367'	INT	TYPSXB		000043'		
ASCIZ.		000051'		ILUUO.		000400'	INT	TYPTAB		000015'		
ASTFL		000001	SPD	IN		000453'		USRLOC		000411'		
ASTRK.		000425'	INT	INIER.		000215'	INT	UUOH.		000412'	EXT	
ASVAR.		000231'	EXT	INIT.		000000	EXT	UUOL.		000000	EXT	
B		000002		ITYPM.		000030'	ENT	WATCH		000000	SPD	
BPHSE.		000357'	INT	JMPARG		000002'		WLKER.		000335'	INT	
BTLER.		000351'	INT	LISTB.		000340'	INT	XCTTM.		000517'	EXT	
BUFER.		000417'	INT	LOGEN.		000170'	INT	%%CR		000003	SPD	
C		000003		LOW		000000		%%F		000002	SPD	
CLSE		000163'		LSTERR		000627'		%%P		000001	SPD	
CPOPJ		000046'		M		000007		%A		000000	SPD	
CRLF		000441'		MOR2DO		000054'		%AC		000003	SPD	
CRLFQ		000445'		MSNG.		000245'	INT	%AI		000001	SPD	
D		000004		MSNG1		000246'		%D		000006	SPD	
DAYTM.		000524'	EXT	MSNG2		000252'		%E		000010	SPD	
DECIM1		000136'		MSNG3		000271'		%J		040000	SPD	
DECIMA		000131'		MSNG4		000307'		%L		010000	SPD	
DEPOT.		000426'	EXT	MSTIME	047000	000023		%NO		000012	SPD	
DEVER.		000220'	INT	NMLER.		000365'	INT	%O		000005	SPD	
DEVIC.		000373'	EXT	NO.TAB		000621'		%OO		000011	SPD	
DEVNAM	047000	000064		NOCT01		000122'		%OP		700000	SPD	
DUMER.		000374'	INT	NOCT02		000126'		%Q		020000	SPD	
DVNUM.		000423'	EXT	NOCTAL		000120'		%S		000002	SPD	
DYNCH.		000035'	EXT	NOROM.		000241'	INT	%SC		000004	SPD	
ENDTP.		000354'	INT	NXTAB		000140'		%T		000007	SPD	
ERRCT.		000532'	EXT	NXTARG		000001'		
ERRFI.		000513'	ENT	NXTBLN		000003	SPD	
ERRFN1		000537'		OCTAL.		000111'		
ERRFN2		000551'		OOCTAL		000107'		
ERRFN9		000553'		P		000017		
ERRIN.		000455'	ENT	PARER.		000371'	INT	
ERRLN.		000020	SIN	PNTTIM		000556'		
ERRMS2		000503'		PNTTM1		000573'		
ERRMSG		000465'		PNTTM2		000577'		
ERRMX.		000501'	EXT	PRLOC		000162'		
ERRNM1		000611'		RANER.		000421'	INT	
ERRNUM		000610'		REDER.		000343'	INT	
ERROR.		000175'	ENT	REENT		000000	SPD	
ERRTB.		000545'	EXT	RUNTIM	047000	000027		
EXITP.		000167'	EXT	SIXBT.		000071'		
FMPT		000143'		SIXBT1		000074'		
FMTBG.		000156'	EXT	SIXBTC		000102'		
FMTEN.		000150'	EXT	SKPARG		000000'		
FMTER.		000173'	INT	TABLE		000313'		
FNM.		000240'	EXT	TABLND		000334'		
I		000011		TBLER.		000224'	INT	
ILCHAR		000435'		TCRLF		000442'		
ILLCH.		000201'	INT	TEMP.		000000	EXT	
6 RÊ