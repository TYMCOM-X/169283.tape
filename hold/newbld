-R COBAID

PROGRAM-ID: SBUILD

COBOL SUPPORT SYSTEM ACTIVE

SUBSYSTEM? BUILD

COBOL PROGRAM BUILDER ACTIVE

FUNCTION? IDENTIFICATION

AUTHOR. JOHN SMITH.
INSTALLATION. NAVY.
DATE-WRITTEN. 2/28/73.
DATE-COMPILED. 2/28/73.
SECURITY. NONE.
REMARKS. TEST PROGRAM.

FUNCTION? ENVIRONMENT
IS THE STANDARD ENVIRONMENT DIVISION SUFFICIENT?
? LIST

ENVIRONMENT DIVISION.
CONFIGURATION SECTION.
SOURCE-COMPUTER. PDP-10.
OBJECT-COMPUTER. PDP-10.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
        SELECT XXX ASSIGN TO DSK
        RECORDING MODE IS ASCII.
(WHERE XXX IS A NAME SUPPLIED BY THE USER)
(ANY NUMBER OF SELECT STATEMENTS ARE ALLOWED.)


? YES

TYPE <CR> WHEN DONE

SELECT POP-FILE
SELECT CARDS-IN-FILE
SELECT CARDS-OUT-FILE
SELECT 

COBOL PROGRAM BUILDER ACTIVE

FUNCTION? DATA

DATA DIVISION BUILDER ACTIVE

COMMAND? BUILD

FD POP-FILE
BLOCK CONTAINS 
RECORD CONTAINS 
LABEL RECORDS ARE STANDARD
VALUE OF IDENTIFICATION IS "POPFILDAT".
VALUE OF DATE-WRITTEN IS 
DATA RECORDS ARE 
ENTER YOUR RECORD DESCRIPTIONS HERE (<CR> WHEN DONE):
? 01 POP-RECORD.
? 02 POP-REC-COLUMN-1 PIC X.
? 02 FILLER           PIC X.
? 02 POP-REC-COLUMN-3-7  PIC XXXXX.
? 02 FILLER           PIC X(73).
? 

FD CARDS-IN-FILE
BLOCK CONTAINS 
RECORD CONTAINS 
LABEL RECORDS ARE STANDARD
VALUE OF IDENTIFICATION IS "CARDINDAT".
VALUE OF DATE-WRITTEN IS 
DATA RECORDS ARE 
ENTER YOUR RECORD DESCRIPTIONS HERE (<CR> WHEN DONE):
? 01 CARDS-IN-RECORD.
? 02 CARDS-IN-REC-TEST-NO  PIC X(5).
? 02 FILLER                PIC X(75).
? 

FD CARDS-OUT-FILE
BLOCK CONTAINS 
RECORD CONTAINS 
LABEL RECORDS ARE STANDARD
VALUE OF IDENTIFICATION IS "CARDOTDAT".
VALUE OF DATE-WRITTEN IS 
DATA RECORDS ARE 
ENTER YOUR RECORD DESCRIPTIONS HERE (<CR> WHEN DONE):
? 01 CARDS-OUT-RECORD  PIC X(80).
? 

FD 

COMMAND? END

COBOL PROGRAM BUILDER ACTIVE

FUNCTION? WORKING-STORAGE
30 CHRS
*/
WORKING-STORAGE SECTION.
*APPEND
77 WS-SEARCH-OR-PUNCH          PIC X   VALUE "S".
77 WS-TEST-NO-SAVE             PIC X(5)  VALUE "     ".
77 END-OF-CARDS-IN-FILE        PIC X    VALUE "N".
01 WS-COUNTERS.
    02 CARDS-OUT-COUNT   PIC S9(7)  VALUE +0000000.
    02 CARDS-IN-COUNT    PIC S9(7)  VALUE +0000000.
*GO
SBUILD.WKS
330 CHRS

COBOL SUPPORT SYSTEM ACTIVE

SUBSYSTEM? BUILD

COBOL PROGRAM BUILDER ACTIVE

FUNCTION? PROCEDURE
SBUILD.PRD EXISTS. DO YOU WANT TO ADD TO IT? YES
2135 CHRS
*/
PROCEDURE DIVISION.
 000-INITIALIZE-FILES.
        OPEN INPUT POP-FILE CARDS-IN-FILE.
        OPEN OUTPUT CARDS-OUT-FILE.
        PERFORM 030-READ-A-CARD THRU 030-END-READ-CARD
        GO TO 040-READ-A-POP-RECORD.
 DETAP     010-DECIDE                        00001 03 05 05
 RL1                                 0   0   0   0   0
 RL2                                 1   2   3   4   5   $
 CONDITION SECTION
 C POP-REC-COLUMN-1 EQUAL TO "T"     Y   Y   Y   N   N
 C POP-REC-COLUMN-3-7 :
   CARDS-IN-REC-TEST-NO              >   =   <   -   -
 * RULE 1 GREATER
 * RULE 3 LESS
 C WS-SEARCH-OR-PUNCH EQUAL TO       -   -   -   "S" "P"
 ACTION SECTION
 A MOVE "S" TO WS-SEARCH-OR-PUNCH            X
 A MOVE "P" TO WS-SEARCH-OR-PUNCH        X
 A PERFORM 015-NOT-FOUND             X
 A PERFORM 020-PUNCH-A-CARD              X           X
 A PERFORM 030-READ-A-CARD THRU
           030-END-READ-CARD         X   X
 A GO TO 040-READ-A-POP-RECORD           X   X   X   X
 A GO TO 010-DECIDE                  X
 TEND
 015-NOT-FOUND.
     DISPLAY CARDS-IN-REC-TEST-NO  " NOT FOUND, BYPASSED".
 020-PUNCH-A-CARD.
        MOVE POP-RECORD TO CARDS-OUT-RECORD
        WRITE CARDS-OUT-RECORD
        ADD +1 TO CARDS-OUT-COUNT.
 030-READ-A-CARD.
        IF  END-OF-CARDS-IN-FILE = "Y"
        GO TO 050-END-OF-JOB.
        READ CARDS-IN-FILE 
          AT END
        MOVE "Y" TO END-OF-CARDS-IN-FILE
        GO TO 030-END-READ-CARD.
        IF CARDS-IN-REC-TEST-NO NOT GREATER THAN WS-TEST-NO-SAVE
           DISPLAY  CARDS-IN-REC-TEST-NO
        " OUT OF SEQUENCE, BYPASSED"
        GO TO 030-READ-A-CARD.
        ADD +1 TO CARDS-IN-COUNT
        MOVE CARDS-IN-REC-TEST-NO TO WS-TEST-NO-SAVE.
 030-END-READ-CARD. EXIT.
 040-READ-A-POP-RECORD.
        READ POP-FILE
          AT END
        DISPLAY  "POP FILE AT END BEFORE CARDS IN"
        GO TO 050-END-OF-JOB.
        GO TO 010-DECIDE.
 050-END-OF-JOB.
        DISPLAY "CARDS-IN-COUNT = " CARDS-IN-COUNT.
        DISPLAY "CARDS-OUT-COUNT = " CARDS-OUT-COUNT.
        CLOSE POP-FILE CARDS-IN-FILE CARDS-OUT-FILE
        STOP RUN.
 PGM END.
*GO

COBOL SUPPORT SYSTEM ACTIVE

SUBSYSTEM? BUILD

COBOL PROGRAM BUILDER ACTIVE

FUNCTION? MAKE

FUNCTION? END

COBOL SUPPORT SYSTEM ACTIVE

SUBSYSTEM? QUIT

-MOD SBUILD.CBL
3665 CHRS
*1/
IDENTIFICATION DIVISION.
*1INSERT
 D*OPTNS YSCMP
*EX
SBUILD.CBL
3675 CHRS
-R COBAID

PROGRAM-ID: SBUILD

COBOL SUPPORT SYSTEM ACTIVE

SUBSYSTEM? DETAP

INPUT FILE: SBUILD.CBL

OUTPUT FILE: SRUN.CBL

COBOL SUPPORT SYSTEM ACTIVE

SUBSYSTEM? QUIT

-COMPILE SRUN
COBOL:  SBUILD

EXIT

-
