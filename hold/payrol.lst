    P R O G R A M   P A Y R O L 		COBOL 50A(107000)	21-MAY-73  06:16		PAGE 1
    PAYROL.CBL    21-MAY-73  06:15

    0001    IDENTIFICATION DIVISION.
    0002    PROGRAM-ID. PAYROLL.
    0003    AUTHOR. WK SELPH.
    0004    DATE-WRITTEN. MAY 11, 1973.
    0005    REMARKS.  ASSIGNMENT TWO.
    0006    ENVIRONMENT DIVISION.
    0007    CONFIGURATION SECTION.
    0008    SOURCE-COMPUTER. DECsystem-10. 
    0009    OBJECT-COMPUTER. DECSYSTEM-10.
    0010    INPUT-OUTPUT SECTION.
    0011    FILE-CONTROL.
    0012           SELECT PAYFIL ASSIGN TO DSK
    0013           RECORDING MODE IS ASCII.
    0014           SELECT YTDMST ASSIGN TO DSK
    0015           RECORDING MODE IS ASCII.
    0016           SELECT YTDOUT ASSIGN TO DSK
    0017           RECORDING MODE IS ASCII.
    0018           SELECT PAYREP ASSIGN TO DSK
    0019           RECORDING MODE IS ASCII.
    0020           SELECT CHECKS ASSIGN TO DSK
    0021           RECORDING MODE IS ASCII.
    0022    I-O-CONTROL.
    0023    SAME RECORD AREA FOR YTDMST YTDOUT.
    0024    DATA DIVISION.
    0025    FILE SECTION.
    0026    FD PAYFIL
    0027           LABEL RECORDS ARE STANDARD
    0028           VALUE OF IDENTIFICATION IS "PAYFILDAT".
    0029    01 PAYIN.
    0030      03 SSNO     PIC 9(9).
    0031      03 LNAME    PIC X(15).
    0032      03 FNAME    PIC X(10).
    0033      03 HOURS    PIC 99V9.
    0034      03 RATE     PIC 99V999.
    0035    FD YTDMST
    0036           LABEL RECORDS ARE STANDARD
    0037           VALUE OF IDENTIFICATION IS "YTDMSTHIS".
    0038    01 MSTIN.
    0039      03 SSNO     PIC 9(9).
    0040      03 EMPLOYEE-NO   PIC 9(6).
    0041      03 DEPT-NO  PIC 9999.
    0042      03 EXEMPTIONS   PIC 99.
    0043    03   YTD-GROSS-WH  PIC 9(5)V99.
    0044      03 YTD-FIT-WH   PIC 9999V99.
    0045      03 YTD-FICA-WH   PIC 999V99.
    0046      03 YTD-INS-WH   PIC 999V99.
    0047    FD YTDOUT
    0048           LABEL RECORDS ARE STANDARD
    0049           VALUE OF IDENTIFICATION IS "YTDOUTHIS".
    0050    01 YTDREC   PIC X(44).
    0051    FD PAYREP
    0052           LABEL RECORDS ARE STANDARD
    0053           VALUE OF IDENTIFICATION IS "PAYREPDAT".
    0054    01 PAYREP-REC   PIC X(70).
    0055    FD CHECKS
    0056           LABEL RECORDS ARE STANDARD    P R O G R A M   P A Y R O L 		COBOL 50A(107000)	21-MAY-73  06:16		PAGE 1-1
    PAYROL.CBL    21-MAY-73  06:15

    0057           VALUE OF IDENTIFICATION IS "PAYCHECKS".
    0058    01 CHECKS-REC PIC IS X(70).
    0059    WORKING-STORAGE SECTION.
    0060    77 BEG-CHK-NO           PIC 9(6) VALUE ZERO.
    0061    77 CUR-DATE             PIC X(20) VALUE SPACES.
    0062    77 END-PAY-PD   PIC X(20)   VALUE SPACES.
    0063    77 GROSS        PIC S9999V99   VALUE ZEROES.
    0064    77 FICA         PIC S9999V99   VALUE ZEROES.
    0065    77 FIT          PIC S9999V99   VALUE ZEROES.
    0066    77 INS          PIC S9999V99   VALUE ZEROES.
    0067    77 NET          PIC S9999V99   VALUE ZEROES.
    0068    01 HEAD-1.
    0069      03 FILLER    PIC X(30)   VALUE SPACES.
    0070      03 FILLER    PIC X(40)   VALUE "PAYROLL REPORT".
    0071    01 HEAD-2.
    0072      03 FILLER     PIC X(30)    VALUE "SOC-SEC        FIRST     LAST ".
    0073      03 FILLER      PIC X(30)    VALUE "           HOURS   HOURLY     ".
    0074      03   FILLER    PIC X(10)   VALUE "   GROSS  ".
    0075    01 HEAD-3.
    0076      03 FILLER      PIC X(30)    VALUE "NUMBER        NAME      NAME ".
    0077      03 FILLER      PIC X(27)    VALUE "           WKD      RATE".
    0078      03 FILLER     PIC X(10)    VALUE "      PAY ".
    0079    01 HEAD-4.
    0080      03 FILLER    PIC X(30)   VALUE "           FIT-WH        FICA-".
    0081      03 FILLER     PIC X(30)    VALUE "WH       INS-WH    NET".
    0082    01 PLINE-1.
    0083      03 FILLER     PIC X   VALUE SPACE.
    0084      03 SSNO       PIC 999B99B9999.
    0085      03 FILLER     PIC XXX   VALUE SPACES.
    0086      03 FNAME      PIC X(10)   VALUE SPACES.
    0087      03 LNAME      PIC X(15)   VALUE SPACES.
    0088      03 HOURS      PIC ZZZ.9.
    0089      03 FILLER      PIC XXX    VALUE SPACES.
    0090      03 RATE      PIC ZZZZ9.999.
    0091      03 GROSSPAY   PIC ZZ,ZZZ.99.
    0092    01 PLINE-2.
    0093      03 FILLER     PIC X(8)   VALUE SPACES.
    0094      03 FIT-WH     PIC ZZ,ZZZ.99.
    0095      03 FILLER     PIC X(6)   VALUE SPACES.
    0096      03 FICA-WH    PIC Z,ZZZ.99.
    0097      03 INS-WH     PIC ZZ,ZZZ,ZZZ.99.
    0098      03 FILLER     PIC XXX     VALUE SPACES.
    0099      03 NETPAY     PIC ZZ,ZZZ.99.
    0100    01 CLINE-1.
    0101      03 FILLER     PIC X   VALUE SPACE.
    0102      03 MSG-1      PIC X(10)   VALUE SPACES.
    0103      03 MSG-2     PIC ZZZZZ9  VALUE ZEROES.
    0104      03 FILLER     PIC X(18)   VALUE SPACES.
    0105      03 MSG-3      PIC X(15)   VALUE SPACES.
    0106      03 CK-DATE    PIC X(20)   VALUE SPACES.
    0107    01 CLINE-2.
    0108      03 FILLER     PIC X(11)    VALUE " PAY TO:   ".
    0109      03 FNAME     PIC X(15)   VALUE SPACES.
    0110      03 LNAME     PIC X(31)   VALUE SPACES.
    0111      03 NETPAY     PIC $*,***,***.99.
    0112    PROCEDURE DIVISION.    P R O G R A M   P A Y R O L 		COBOL 50A(107000)	21-MAY-73  06:16		PAGE 1-2
    PAYROL.CBL    21-MAY-73  06:15

    0113    STARTER.
    0114           DISPLAY "ENTER BEGINNING CHECK NUMBER:  " WITH NO ADVANCING.
    0115           ACCEPT BEG-CHK-NO.
    0116           DISPLAY "ENTER CURRENT DATE:  " WITH NO ADVANCING.
    0117           ACCEPT CUR-DATE.
    0118           DISPLAY "ENTER ENDING PAY PERIOD DATE:  " WITH NO ADVANCING.
    0119           ACCEPT END-PAY-PD.
    0120           OPEN INPUT PAYFIL, YTDMST
    0121               OUTPUT YTDOUT, PAYREP, CHECKS.
    0122    DO-HEADERS.
    0123           
    0124           WRITE PAYREP-REC FROM HEAD-1 AFTER ADVANCING 4.
    0125           WRITE PAYREP-REC FROM HEAD-2 AFTER ADVANCING 2.
    0126           WRITE PAYREP-REC FROM HEAD-3 AFTER ADVANCING 1.
    0127           WRITE PAYREP-REC FROM HEAD-4 AFTER ADVANCING 2.
    0128    READ-EM.
    0129           READ YTDMST, AT END GO TO END-OF-JOB.
    0130           READ PAYFIL, AT END GO TO END-OF-JOB.
    0131    DO-PAY.
    0132           COMPUTE GROSS ROUNDED  = HOURS IN PAYIN * RATE IN PAYIN.
    0133           COMPUTE FICA ROUNDED = GROSS * .04.
    0134           COMPUTE FIT ROUNDED = ( GROSS - ( EXEMPTIONS * 13)) * .15.
    0135           COMPUTE INS = 5.40 * EXEMPTIONS.
    0136                   IF INS > 14.00, MOVE 14.00 TO INS.
    0137           COMPUTE NET = GROSS - FICA - INS - FIT.
    0138    BUILDPAY.
    0139           MOVE CORRESPONDING PAYIN TO PLINE-1.
    0140           MOVE CORRESPONDING PAYIN TO CLINE-2.
    0141           MOVE GROSS TO GROSSPAY.
    0142           MOVE NET TO NETPAY IN PLINE-2, NETPAY IN CLINE-2.
    0143           EXAMINE SSNO IN PLINE-1 REPLACING ALL " " BY "-".
    0144           WRITE PAYREP-REC FROM PLINE-1 AFTER ADVANCING 2.
    0145           MOVE FIT TO FIT-WH.
    0146           MOVE FICA TO FICA-WH.
    0147           MOVE INS TO INS-WH.
    0148           WRITE PAYREP-REC FROM PLINE-2 AFTER ADVANCING 1.
    0149    DO-CHECKS.
    0150           MOVE " CHECK NO." TO MSG-1.
    0151           MOVE BEG-CHK-NO TO MSG-2.
    0152           MOVE "CURRENT DATE: " TO MSG-3.
    0153           MOVE CUR-DATE TO CK-DATE.
    0154           WRITE CHECKS-REC FROM CLINE-1 AFTER ADVANCING 7.
    0155           MOVE "EMP NO.  " TO MSG-1.
    0156           MOVE EMPLOYEE-NO TO MSG-2.
    0157           MOVE "PAY PERIOD:   " TO MSG-3.
    0158           MOVE END-PAY-PD TO CK-DATE.
    0159           WRITE CHECKS-REC FROM CLINE-1 AFTER ADVANCING 1.
    0160           WRITE CHECKS-REC FROM CLINE-2 AFTER ADVANCING 3.
    0161           ADD 1 TO BEG-CHK-NO.
    0162    DO-TYD.
    0163           ADD GROSS TO YTD-GROSS-WH.
    0164           ADD FIT TO YTD-FIT-WH.
    0165           ADD FICA TO YTD-FICA-WH.
    0166           ADD INS TO YTD-INS-WH.
    0167           WRITE YTDREC FROM MSTIN.
    0168           GO TO READ-EM.    P R O G R A M   P A Y R O L 		COBOL 50A(107000)	21-MAY-73  06:16		PAGE 1-3
    PAYROL.CBL    21-MAY-73  06:15

    0169    END-OF-JOB.
    0170           CLOSE PAYFIL, YTDMST, YTDOUT, PAYREP, CHECKS.
    0171           STOP RUN.    P R O G R A M   P A Y R O L 		COBOL 50A(107000)	21-MAY-73  06:16		PAGE W-1
    PAYROL.CBL    21-MAY-73  06:15

WARNINGS:

    0165  MOST SIGNIFICANT DIGITS TRUNCATED ON YTD-FICA-WH
    0166  MOST SIGNIFICANT DIGITS TRUNCATED ON YTD-INS-WH


NO FATAL ERRORS, 2 WARNINGS
    