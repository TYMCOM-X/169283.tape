    P R O G R A M   G S I 		COBOL 4(56)	13-APR-73  06:27		PAGE 1

    0001    IDENTIFICATION DIVISION.
    0002    PROGRAM-ID. GSI.
    0003    AUTHOR. BISIAUX.
    0004    REMARKS. CHANGEMENT DU NO DE CLIENT SUR FICHIER RELEVES.
    0005    ENVIRONMENT DIVISION.
    0006    CONFIGURATION SECTION.
    0007    SOURCE-COMPUTER. DECsystem-10. 
    0008    OBJECT-COMPUTER. PDP-10.
    0009    INPUT-OUTPUT SECTION.
    0010    FILE-CONTROL.
    0011           SELECT FICIN ASSIGN TO DSK
    0012           RECORDING MODE IS ASCII.
    0013           SELECT FICOUT ASSIGN TO DSK
    0014           RECORDING MODE IS ASCII.
    0015           SELECT FICMVT ASSIGN TO DSK
    0016           RECORDING MODE IS ASCII.
    0017           SELECT FICANO ASSIGN TO DSK
    0018           RECORDING MODE IS ASCII.
    0019    DATA DIVISION.
    0020    FILE SECTION.
    0021    FD FICIN
    0022           RECORD CONTAINS 40
    0023           LABEL RECORD STANDARD
    0024           VALUE OF IDENTIFICATION IS "FICIN DAT".
    0025    01 ENTREE PIC X(40).
    0026    FD FICOUT
    0027           RECORD CONTAINS 40
    0028           LABEL RECORD STANDARD
    0029           VALUE OF IDENTIFICATION IS "FICOUTDAT".
    0030    01 SORTIE PIC X(40).
    0031    FD FICMVT
    0032           RECORD CONTAINS 80
    0033           LABEL RECORD STANDARD
    0034           VALUE OF IDENTIFICATION IS "FICMVTDAT".
    0035    01 DONMVT PIC X(80).
    0036    FD FICANO
    0037           RECORD CONTAINS 133
    0038           LABEL RECORD STANDARD
    0039           VALUE OF IDENTIFICATION IS "FICANODAT".
    0040    01 IMP.
    0041                   02 SAUT PIC X.
    0042                   02 LIGNE PIC X(132).
    0043    WORKING-STORAGE SECTION.
    0044    77 CTRLIGNE PIC S99 COMP VALUE 70.
    0045    77 CTRPAGE PIC S9(6) COMP VALUE 0.
    0046    77 FINMVT PIC X VALUE LOW-VALUE.
    0047    77 FINPERM PIC X VALUE LOW-VALUE.
    0048    77 CTRMVT PIC S9(9) VALUE 0.
    0049    77 CTRPER PIC S9(9) VALUE 0.
    0050    01 MOUV.
    0051           02 CARMVT PIC XX.
    0052           02 SOCMVT PIC XXX.
    0053           02 ANCMVT PIC X(12).
    0054           02 NOUMVT PIC X(12).
    0055           02 FILLER PIC X(51).
    0056    01 PERM.    P R O G R A M   G S I 		COBOL 4(56)	13-APR-73  06:27		PAGE 1-1

    0057           02 FILLER PIC XX.
    0058           02 SOCPERM PIC XXX.
    0059           02 CPTPERM PIC X(12).
    0060           02 FILLER PIC X(23).
    0061    01 LIGTIT1.
    0062           02 FILLER PIC X VALUE "1".
    0063           02 FILLER PIC X(18) VALUE "   ETS. S.S. WHITE".
    0064           02 FILLER PIC X(60) VALUE SPACES.
    0065           02 FILLER PIC X(5) VALUE "DATE ".
    0066           02 DATPARM PIC X(8).
    0067           02 FILLER PIC X(20) VALUE SPACES.
    0068           02 FILLER PIC X(5) VALUE "PAGE".
    0069           02 NUMPAGE PIC Z(5)9.
    0070           02 FILLER PIC X(10) VALUE SPACES.
    0071    01 LIGTIT2.
    0072           02 FILLER PIC X VALUE "-".
    0073           02 FILLER PIC X(42) VALUE SPACES.
    0074           02 FILLER PIC X(46) VALUE "MODIFICATION DU CODE CLIENT
    0075  -        "AU FICHIER COMPTES".
    0076    01 LIGTIT3.
    0077           02 FILLER PIC X VALUE "-".
    0078           02 FILLER PIC X(60) VALUE SPACES.
    0079           02 FILLER PIC X(38) VALUE "STE      ANCIEN CODE      NO
    0080  -        "UVEAU CODE".
    0081    01 LIGBAN.
    0082           02 FILLER PIC X(4) VALUE "0   ".
    0083           02 LIBEL PIC X(57).
    0084           02 S-STE PIC XXX.
    0085           02 FILLER PIC X(6) VALUE SPACES.
    0086           02 S-ANCOD PIC X(12).
    0087           02 FILLER PIC X(6) VALUE SPACES.
    0088           02 S-NOCOD PIC X(12).
    0089    PROCEDURE DIVISION.
    0090    USER-FIRST-PARAGRAPH.
    0091           OPEN INPUT FICIN FICMVT OUTPUT FICOUT FICANO.
    0092    LECPERM.
    0093           IF FINPERM = HIGH-VALUE GO TO SLECPERM.
    0094           READ FICIN INTO PERM AT END MOVE HIGH-VALUE TO FINPERM
    0095           SOCPERM CPTPERM.
    0096           ADD 1 TO CTRPER.
    0097    FLECPERM. EXIT.
    0098    LECMVT.
    0099           IF FINMVT = HIGH-VALUE GO TO FLECMVT.
    0100           READ FICMVT INTO MOUV AT END MOVE HIGH-VALUE TO FINMVT SOCMVT
    0101           ANCMVT.
    0102           ADD 1 TO CTRMVT.
    0103    FLECMVT. EXIT.
    0104    SLECPERM.
    0105           IF FINMVT = HIGH-VALUE GO TO FINTRA.
    0106    S1.     IF FINPERM = HIGH-VALUE AND FINMVT = HIGH-VALUE
    0107           GO TO FINTRA.
    0108           IF FINPERM = HIGH-VALUE GO TO COMPARE.
    0109           IF FINMVT = HIGH-VALUE 
    0110           PERFORM LECPERM THRU FLECPERM
    0111           PERFORM ECRPERM THRU FECRPERM
    0112           GO TO S1.    P R O G R A M   G S I 		COBOL 4(56)	13-APR-73  06:27		PAGE 1-2

    0113    COMPARE.
    0114           IF CARMVT NOT = "40"
    0115           DISPLAY "CODE CARTE INVALIDE" CARMVT "COMPTE " ANCMVT
    0116           PERFORM LECMVT THRU FLECMVT GO TO S1.
    0117           IF SOCMVT < SOCPERM
    0118           MOVE "MODIFICATION IMPOSSIBLE - CODE CLIENT INEXISTANT"
    0119           TO LIBEL
    0120           PERFORM ECRLIST THRU FECRLIST
    0121           PERFORM LECMVT THRU FLECMVT
    0122           GO TO S1.
    0123           IF SOCMVT > SOCPERM 
    0124           PERFORM ECRPERM THRU FECRPERM
    0125           PERFORM LECPERM THRU FLECPERM
    0126           GO TO S1.
    0127           IF ANCMVT < CPTPERM
    0128           MOVE "MODIFICATION IMPOSSIBLE - CODE CLIENT INEXISTANT" 
    0129            TO LIBEL
    0130           PERFORM ECRLIST THRU FECRLIST
    0131           PERFORM LECMVT  THRU FLECMVT
    0132           GO TO S1.
    0133           IF ANCMVT > CPTPERM
    0134           PERFORM ECRPERM THRU FECRPERM
    0135           PERFORM LECPERM THRU FLECPERM
    0136           GO TO S1.
    0137           MOVE NOUMVT TO CPTPERM.
    0138           MOVE "MODIFICATION EFFECTUEE " TO LIBEL.
    0139           PERFORM ECRLIST THRU FECRLIST.
    0140           PERFORM ECRPERM THRU FECRPERM.
    0141           PERFORM LECPERM THRU FLECPERM.
    0142           PERFORM LECMVT  THRU FLECMVT.
    0143           GO TO S1.
    0144    ECRPERM.
    0145           WRITE SORTIE FROM PERM.
    0146    FECRPERM.
    0147           EXIT.
    0148    ECRLIST.
    0149           IF CTRLIGNE > 60 PERFORM TITRE THRU FTITRE.
    0150           MOVE SOCMVT TO S-STE.
    0151           MOVE ANCMVT TO S-ANCOD.
    0152           MOVE NOUMVT TO S-NOCOD. MOVE LIGBAN TO IMP.
    0153           PERFORM ECRLIG THRU FECRLIG.
    0154    FECRLIST.
    0155           EXIT.
    0156    ECRLIG.
    0157           IF SAUT = "-" WRITE IMP AFTER 3
    0158           ADD 3 TO CTRLIGNE.
    0159           IF SAUT = "0" WRITE IMP AFTER 2
    0160           ADD 2 TO CTRLIGNE.
    0161    FECRLIG. EXIT.
    0162    TITRE.
    0163           MOVE 0 TO CTRLIGNE.
    0164           ADD 1 TO CTRPAGE.
    0165           MOVE CTRPAGE TO NUMPAGE.
    0166           MOVE LIGTIT1 TO IMP.
    0167           PERFORM ECRLIG THRU FECRLIG.
    0168           MOVE LIGTIT2 TO IMP.    P R O G R A M   G S I 		COBOL 4(56)	13-APR-73  06:27		PAGE 1-3

    0169           PERFORM ECRLIG THRU FECRLIG.
    0170           MOVE LIGTIT3 TO IMP.
    0171           PERFORM ECRLIG THRU FECRLIG.
    0172    FTITRE. EXIT.
    0173    FINTRA.
    0174           DISPLAY "NOMBRE ENR. FICHIER " CTRPER.
    0175           DISPLAY "NOMBRE ENR. MVT. " CTRMVT.
    0176           MOVE SPACE TO S-STE S-ANCOD S-NOCOD.
    0177           MOVE "FIN DE MODIFICATION " TO LIBEL.
    0178           MOVE LIGBAN TO IMP.
    0179           PERFORM ECRLIG THRU FECRLIG.
    0180           CLOSE FICIN FICOUT FICMVT FICANO.
    0181           STOP RUN.

NO ERRORS DETECTED
   