    P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 1
    COBRG.CBL    12-JUN-72  00:00

    0001    IDENTIFICATION DIVISION.
    0002    PROGRAM-ID.  COBRG      COBOL REPORT GENERATOR VERSION 1A, EDIT 2.
    0003    AUTHOR. AL BLACKINGTON/CAM.
    0004    INSTALLATION. DIGITAL EQUIPMENT CORP.
    0005    DATE-WRITTEN.  FEB - MAR 1968; CONVERTED TO COBOL-68 OCTOBER 1970.
    0006    DATE-COMPILED. 31-MAY-73. 
    0007    SECURITY. COPYRIGHT 1970,1971,1972, DIGITAL EQUIPMENT CORP., MAYNARD, MA.
    0008  
    0009    REMARKS.
    0010  	IF LINE-PRINTER HAS ONLY 120 COLUMNS, CHANGE VALUE OF 'PRINTER-SIZE' TO 120.
    0011  
    0012  	NO LINE NUMBERS ARE PUNCHED ON THE OUTPUT CARDS.  IF DESIRED,
    0013  	SEE 'PUNCH-REC' IN DATA DIVISION, AND 'PUNCH-CARD' & 'PUNCH-TOP-FORM' IN PROCEDURE
    0014  	DIVISION.
    0015  
    0016    ENVIRONMENT DIVISION.
    0017    CONFIGURATION SECTION.
    0018    OBJECT-COMPUTER. DECsystem-10; SEGMENT-LIMIT IS 1.
    0019    SPECIAL-NAMES.  CHANNEL (1) IS TOP-OF-FORM.
    0020  
    0021    INPUT-OUTPUT SECTION.
    0022    FILE-CONTROL.
    0023  	SELECT CARD		ASSIGN TO DSK.
    0024  	SELECT GENERATED-PROG	ASSIGN TO DSK.
    0025  	SELECT LISTING		ASSIGN TO DSK.
    0026  	SELECT TRAN-FILE-IN	ASSIGN TO DSK;
    0027  		ACCESS MODE IS RANDOM;
    0028  		FILE-LIMIT IS 999;
    0029  		ACTUAL KEY IS TRAN-KEY.
    0030  	SELECT TRAN-FILE-OUT	ASSIGN TO DSK.
    0031      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 2
    COBRG.CBL    12-JUN-72  00:00

    0032    DATA DIVISION.
    0033    FILE SECTION.
    0034  
    0035    FD  GENERATED-PROG
    0036  	LABEL RECORDS ARE STANDARD
    0037  	VALUE OF IDENTIFICATION IS CBL-VAL-ID
    0038  	DATA RECORD IS PUNCH-REC.
    0039  
    0040    01  PUNCH-REC DISPLAY-7.
    0041  * 	IF LINE NUMBERS WANTED, PUT:
    0042  * 		02 PUNCH-1-6 PIC X(6).
    0043  * 		02 FILLER    PIC X.
    0044  
    0045  	02 PUNCH-8		PICTURE X.
    0046  	02 FILLER		PICTURE XX.
    0047  	02 PUNCH-11		PICTURE X.
    0048  	02 PUNCH-12		PICTURE X.
    0049  	02 PUNCH-13		PICTURE X.
    0050  	02 PUNCH-14		PICTURE X.
    0051  	02 PUNCH-15		PICTURE X.
    0052  	02 PUNCH-16		PICTURE X.
    0053  	02 PUNCH-17		PICTURE X.
    0054  	02 PUNCH-18		PICTURE X.
    0055  	02 PUNCH-19		PICTURE X.
    0056  	02 PUNCH-20		PICTURE X.
    0057  	02 PUNCH-21		PICTURE X.
    0058  	02 PUNCH-22		PICTURE X.
    0059  	02 PUNCH-23		PICTURE X.
    0060  	02 PUNCH-24		PICTURE X.
    0061  	02 PUNCH-25		PICTURE X.
    0062  	02 PUNCH-26		PICTURE X.
    0063  	02 PUNCH-27		PICTURE X.
    0064  	02 PUNCH-28		PICTURE X.
    0065  	02 PUNCH-29		PICTURE X.
    0066  	02 FILLER		PICTURE XX.
    0067  	02 PUNCH-32		PICTURE X.
    0068  	02 PUNCH-33		PICTURE X.
    0069  	02 FILLER		PICTURE X(3).
    0070  	02 PUNCH-37		PICTURE X.
    0071  	02 PUNCH-38		PICTURE X.
    0072  	02 PUNCH-39		PICTURE X.
    0073  	02 PUNCH-40		PICTURE X.
    0074  	02 PUNCH-41		PICTURE X.
    0075  	02 FILLER		PICTURE XX.
    0076  	02 PUNCH-44		PICTURE X.
    0077  	02 PUNCH-45		PICTURE X.
    0078  	02 PUNCH-46		PICTURE X.
    0079  	02 PUNCH-47		PICTURE X.
    0080  	02 PUNCH-48		PICTURE X.
    0081  	02 PUNCH-49		PICTURE X.
    0082  	02 PUNCH-50		PICTURE X.
    0083  	02 FILLER		PICTURE XXX.
    0084  	02 PUNCH-54		PICTURE X.
    0085  	02 PUNCH-55		PICTURE X.
    0086  	02 PUNCH-56		PICTURE X.
    0087  	02 FILLER		PICTURE XX.    P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 2-1
    COBRG.CBL    12-JUN-72  00:00

    0088  	02 PUNCH-59		PICTURE X.
    0089  	02 PUNCH-60		PICTURE X.
    0090  	02 PUNCH-61		PICTURE X.
    0091  	02 PUNCH-62		PICTURE X.
    0092  	02 PUNCH-63		PICTURE X.
    0093  	02 PUNCH-64		PICTURE X.
    0094  	02 PUNCH-65		PICTURE X.
    0095  	02 FILLER		PICTURE XX.
    0096  	02 PUNCH-68		PICTURE X.
    0097  	02 PUNCH-69		PICTURE X.
    0098  	02 FILLER		PICTURE XX.
    0099  	02 PUNCH-72		PICTURE X.
    0100  	02 FILLER		PICTURE X(15).
    0101  
    0102  	66 PUNCH-8-11  RENAMES PUNCH-8  THRU PUNCH-11.
    0103  	66 PUNCH-8-18  RENAMES PUNCH-8  THRU PUNCH-18.
    0104  	66 PUNCH-8-23  RENAMES PUNCH-8  THRU PUNCH-23.
    0105  	66 PUNCH-8-24  RENAMES PUNCH-8  THRU PUNCH-24.
    0106  	66 PUNCH-8-72  RENAMES PUNCH-8  THRU PUNCH-72.
    0107  	66 PUNCH-12-16 RENAMES PUNCH-12 THRU PUNCH-16.
    0108  	66 PUNCH-12-20 RENAMES PUNCH-12 THRU PUNCH-20.
    0109  	66 PUNCH-12-24 RENAMES PUNCH-12 THRU PUNCH-24.
    0110  	66 PUNCH-12-28 RENAMES PUNCH-12 THRU PUNCH-28.
    0111  	66 PUNCH-12-37 RENAMES PUNCH-12 THRU PUNCH-37.
    0112  	66 PUNCH-12-39 RENAMES PUNCH-12 THRU PUNCH-39.
    0113  	66 PUNCH-12-44 RENAMES PUNCH-12 THRU PUNCH-44.
    0114  	66 PUNCH-12-45 RENAMES PUNCH-12 THRU PUNCH-45.
    0115  	66 PUNCH-12-72 RENAMES PUNCH-12 THRU PUNCH-72.
    0116  	66 PUNCH-16-72 RENAMES PUNCH-16 THRU PUNCH-72.
    0117  	66 PUNCH-17-40 RENAMES PUNCH-17 THRU PUNCH-40.
    0118  	66 PUNCH-24-39 RENAMES PUNCH-24 THRU PUNCH-39.
    0119  	66 PUNCH-40-47 RENAMES PUNCH-40 THRU PUNCH-47.
    0120  	66 PUNCH-40-72 RENAMES PUNCH-40 THRU PUNCH-72.
    0121  	66 PUNCH-41-44 RENAMES PUNCH-41 THRU PUNCH-44.
    0122  	66 PUNCH-41-72 RENAMES PUNCH-41 THRU PUNCH-72.
    0123  	66 PUNCH-45-48 RENAMES PUNCH-45 THRU PUNCH-48.
    0124  	66 PUNCH-45-69 RENAMES PUNCH-45 THRU PUNCH-69.
    0125  	66 PUNCH-46-55 RENAMES PUNCH-46 THRU PUNCH-55.
    0126  	66 PUNCH-48-54 RENAMES PUNCH-48 THRU PUNCH-54.
    0127  	66 PUNCH-49-72 RENAMES PUNCH-49 THRU PUNCH-72.
    0128  	66 PUNCH-55-68 RENAMES PUNCH-55 THRU PUNCH-68.
    0129  	66 PUNCH-56-65 RENAMES PUNCH-56 THRU PUNCH-65.
    0130  	66 PUNCH-56-69 RENAMES PUNCH-56 THRU PUNCH-69.
    0131      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 3
    COBRG.CBL    12-JUN-72  00:00

    0132    FD  LISTING
    0133  	LABEL RECORDS ARE STANDARD
    0134  	VALUE OF IDENTIFICATION IS LIST-FILE-EXT.
    0135  
    0136    01  P-L DISPLAY-7.
    0137  	02 PL-1-20		PICTURE X(20).
    0138  	02 FILLER		PICTURE X(100).
    0139    01  PL-N  DISPLAY-7.
    0140  	02 PL-CODE		PICTURE X.
    0141  	02 FILLER		PICTURE X.
    0142  	02 PL-ID		PICTURE X(6).
    0143  	02 FILLER		PICTURE X(4).
    0144  	02 PL-BLOCKING		PICTURE XXX.
    0145  	02 FILLER		PICTURE X(6).
    0146  	02 PL-INPUT-DEV		PICTURE X(6).
    0147  	02 FILLER		PICTURE XX.
    0148  	02 PL-OUTPUT-DEV	PICTURE X(6).
    0149  	02 FILLER		PICTURE X(4).
    0150  	02 PL-IN-VAL		PICTURE X(9).
    0151  	02 FILLER		PICTURE X(4).
    0152  	02 PL-OUT-VAL		PICTURE X(9).
    0153  	02 FILLER		PICTURE XX.
    0154  	02 PL-DATE		PICTURE X(9).
    0155  	02 FILLER		PICTURE XX.
    0156  	02 PL-AUTHOR 		PICTURE X(20).
    0157    01  PL-B  DISPLAY-7.
    0158  	02 FILLER		PICTURE X(4).
    0159  	02 PL-LEVEL		PICTURE X.
    0160  	02 FILLER		PICTURE X(7).
    0161  	02 PL-SPB		PICTURE X.
    0162  	02 PL-SKB		PICTURE X.
    0163  	02 FILLER		PICTURE X(5).
    0164  	02 PL-SPA		PICTURE X.
    0165  	02 PL-SKA		PICTURE X.
    0166  	02 FILLER		PICTURE X(5).
    0167  	02 PL-BRK-SIZE		PICTURE XXX.
    0168  	02 FILLER		PICTURE X(4).
    0169  	02 PL-BRK-NAME		PICTURE X(24).
    0170    01  PL-A DISPLAY-7.
    0171  	02 FILLER		PICTURE X(3).
    0172  	02 PL-AC-NUM 		PICTURE X.
    0173  	02 FILLER		PICTURE X(3).
    0174  	02 PL-AC-SIZE		PICTURE XX.
    0175  	02 FILLER		PICTURE X(4).
    0176  	02 PL-AC-POINT		PICTURE XX.
    0177  	02 FILLER		PICTURE X(7).
    0178  	02 PL-AC-IN-NAME	PICTURE X(24).
    0179  	02 FILLER		PICTURE X(4).
    0180  	02 PL-AC-OUT-NAME	PICTURE X(24).
    0181      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 4
    COBRG.CBL    12-JUN-72  00:00

    0182    01  PL-H  DISPLAY-7.
    0183  	02 FILLER		PICTURE X(3).
    0184  	02 PL-PAGE-SIZE		PICTURE X.
    0185  	02 FILLER		PICTURE XX.
    0186  	02 PL-PAGE-LOC		PICTURE XXX.
    0187  	02 FILLER		PICTURE X(3).
    0188  	02 PL-HDR-SP 		PICTURE X.
    0189  	02 PL-HDR-SK 		PICTURE X.
    0190  	02 FILLER		PICTURE X(4).
    0191  	02 PL-PAGE-RESET	PICTURE X(10).
    0192  	02 FILLER		PICTURE X.
    0193  	02 PL-HDRS.
    0194  	  03 PL-HDR-1		PIC X(30).
    0195  	  03 PL-HDR-2		PIC X(30).
    0196  	  03 FILLER		PIC X(31).
    0197  	02 PL-HDRS-1 REDEFINES PL-HDRS.
    0198  	  03 PL-HDR-3		PIC X(33).
    0199  	  03 PL-HDR-4		PIC X(33).
    0200  	  03 FILLER		PIC X(25).
    0201  	02 PL-HDRS-2 REDEFINES PL-HDRS.
    0202  	  03 FILLER		PIC X(61).
    0203  	  03 PL-ERROR		PIC X(30).
    0204    01  PL-T DISPLAY-7.
    0205  	02 FILLER		PICTURE X(7).
    0206  	02 PL-T-AC-NUM		PICTURE X.
    0207  	02 FILLER		PICTURE X(11).
    0208  	02 PL-T-LEVELS		PICTURE X(11).
    0209  	02 FILLER		PICTURE X(4).
    0210  	02 PL-T-OUT-NAME	PICTURE X(24).
    0211    01  PL-L DISPLAY-7.
    0212  	02 FILLER		PICTURE X(4).
    0213  	02 PL-L-WHEN 		PICTURE X.
    0214  	02 FILLER		PICTURE X(5).
    0215  	02 PL-L-IN-NAME		PICTURE X(24).
    0216  	02 FILLER		PICTURE X(8).
    0217  	02 PL-L-OUT-NAME	PICTURE X(24).
    0218      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 5
    COBRG.CBL    12-JUN-72  00:00

    0219    FD  CARD
    0220  	LABEL RECORDS ARE STANDARD
    0221  	VALUE OF IDENTIFICATION IS CARD-FILE-EXT.
    0222  
    0223    01	CARD-RECORD; DISPLAY-7.
    0224  	02 CARD-CODE		PIC X.
    0225  	02 FILLER		PIC X(79).
    0226    FD  TRAN-FILE-IN
    0227  	BLOCK CONTAINS 1 RECORD
    0228  	LABEL RECORDS ARE STANDARD
    0229  	VALUE OF IDENTIFICATION IS TRAN-VAL-ID-IN.
    0230  
    0231    01  TRAN-RECORD-IN; DISPLAY-7.
    0232  	02 TRAN-EOF-IN		PICTURE X.
    0233  	02 TRAN-CHAR PIC X; OCCURS 79 TIMES.
    0234  
    0235    FD	TRAN-FILE-OUT
    0236  	BLOCK CONTAINS 1 RECORD
    0237  	LABEL RECORDS ARE STANDARD
    0238  	VALUE OF IDENTIFICATION IS TRAN-VAL-ID-OUT.
    0239  
    0240    01	TRAN-RECORD-OUT; DISPLAY-7.
    0241  	02 TRAN-EOF-OUT		PICTURE X.
    0242  	02 FILLER		PICTURE X(79).
    0243      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 6
    COBRG.CBL    12-JUN-72  00:00

    0244    WORKING-STORAGE SECTION.
    0245  
    0246  
    0247    77	JOB-NUMBER	PIC S999; COMP.
    0248    77	EOF-FLAG		PICTURE X.
    0249  	88 MORE-INPUT VALUE SPACE.
    0250  	88 NO-MORE-INPUT VALUE "X".
    0251    77  HOLD-X			PICTURE X.
    0252    77  HOLD-N REDEFINES HOLD-X; PICTURE 9.
    0253    77  LEVEL			PICTURE S99; COMPUTATIONAL.
    0254    77  INDX 			PICTURE S99; COMPUTATIONAL.
    0255    77  INDX-1			PICTURE S99; COMPUTATIONAL.
    0256    77  LINE-NUMBER		PICTURE S9(6); COMP.
    0257    77  LINE-COUNT		PICTURE S999; COMPUTATIONAL.
    0258    77  PAGE-COUNT		PICTURE S999; COMP.
    0259    77  H-CARD-COUNT 		PICTURE S9; COMPUTATIONAL.
    0260    77  A-CARD-COUNT 		PICTURE S99; COMPUTATIONAL.
    0261    77  LOW-INDX		PICTURE S99; COMPUTATIONAL.
    0262    77  PREV-CARD-CODE		PICTURE X.
    0263    77  TEST-FOR-DETAIL		PICTURE X.
    0264  	88 THERE-IS-NO-DETAIL VALUE "N".
    0265    77  HOLD-Y			PICTURE X.
    0266    77  HEADER-1		PICTURE X(120).
    0267    77  HEADER-2		PICTURE X(120).
    0268    77  HOLD-I-KEY		PICTURE S9(7); COMPUTATIONAL.
    0269    77  HOLD-P-KEY		PICTURE S9(7); COMPUTATIONAL.
    0270    77  TRAN-KEY		PICTURE S9(7); COMPUTATIONAL.
    0271    77	TFO-RECORD-NUMBER	PICTURE S9(10); COMPUTATIONAL.
    0272    77	HI-TRAN-LIMIT		PICTURE S9(10); COMPUTATIONAL; VALUE 999.
    0273    77	HIGHEST-SPACE		PICTURE S9; COMPUTATIONAL; VALUE 9.
    0274    77	HIGHEST-CHANNEL		PICTURE S9; COMPUTATIONAL; VALUE 8.
    0275    77	PRINTER-SIZE		PICTURE S999; COMP; VALUE 132.
    0276  
    0277    77	I INDEX.
    0278    77	J INDEX.
    0279    77	CHAR			PICTURE X; DISPLAY-7.
    0280    77	IN-DEVICE		PICTURE X(7).
    0281    77	OUT-DEVICE		PICTURE X(7).
    0282    77	IN-VAL-ID		PICTURE X(9).
    0283    77	OUT-VAL-ID		PICTURE X(9).
    0284    77	TRAN-VAL-ID-OUT		PICTURE X(9).
    0285      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 7
    COBRG.CBL    12-JUN-72  00:00

    0286    01	COMMAND; DISPLAY-7.
    0287  	02 COMMAND-CHAR OCCURS 72 TIMES; PICTURE X.
    0288  
    0289    01	FILE-AND-EXT; DISPLAY-7.
    0290  	02 FILE-EXT-CHAR OCCURS 9 TIMES; PICTURE X.
    0291  
    0292    01	CARD-FILE-EXT.
    0293  	02 CARD-FILE-NAME	PICTURE X(6).
    0294  	02 CARD-EXT-NAME	PICTURE XXX.
    0295    01	LIST-FILE-EXT.
    0296  	02 LIST-FILE-NAME	PICTURE X(6).
    0297  	02 LIST-EXT-NAME	PICTURE XXX.
    0298  
    0299    01	TRAN-VAL-ID-IN.
    0300  	02 TRAN-JOB-NUM		PICTURE 999.
    0301  	02 FILLER		PICTURE X(6); VALUE "CRGTMP".
    0302  
    0303    01	CBL-VAL-ID.
    0304  	02 CBL-VAL-ID-FILE	PICTURE X(6).
    0305  	02 CBL-VAL-ID-EXT	PICTURE XXX; VALUE "CBL".
    0306  
    0307    01  N-CARD DISPLAY-7.
    0308  	02 CARD-ID 		PICTURE X(6).
    0309  	02 CARD-BLOCKING	PICTURE 999.
    0310  	02 CARD-IN-DEV		PIC X(6).
    0311  	02 CARD-OUT-DEV		PIC X(6).
    0312  	02 CARD-IN-VAL-ID	PIC X(9).
    0313  	02 CARD-OUT-VAL-ID	PIC X(9).
    0314  	02 CARD-DATE 		PICTURE X(9).
    0315  	02 CARD-AUTHOR		PICTURE X(20).
    0316      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 8
    COBRG.CBL    12-JUN-72  00:00

    0317    01  B-CARD REDEFINES N-CARD; DISPLAY-7.
    0318  	02 CARD-LEVEL		PICTURE X.
    0319  	02 CARD-SPACING.
    0320  		03 CARD-SPB		PICTURE 9.
    0321  		03 CARD-SKB		PICTURE 9.
    0322  		03 CARD-SPA		PICTURE 9.
    0323  		03 CARD-SKA		PICTURE 9.
    0324  	02 CARD-BRK-SIZE	PICTURE 999.
    0325  	02 CARD-BRK-NAME	PICTURE X(24).
    0326    01  H-CARD REDEFINES N-CARD; DISPLAY-7.
    0327  	02 CARD-PAGE-SIZE	PICTURE 9.
    0328  	02 CARD-PAGE-LOC	PICTURE 999.
    0329  	02 CARD-HDR-SP		PICTURE 9.
    0330  	02 CARD-HDR-SK		PICTURE 9.
    0331  	02 CARD-HDRS.
    0332  	  03 CARD-HDR-1		PICTURE X(30).
    0333  	  03 CARD-HDR-2		PICTURE X(30).
    0334  	  03 FILLER		PICTURE X(6).
    0335  	02 CARD-PAGE-RESET.
    0336  	  03 CPR OCCURS 10 TIMES; PICTURE X.
    0337    01  A-CARD REDEFINES N-CARD; DISPLAY-7.
    0338  	02 CARD-AC-NUM		PICTURE 9.
    0339  	02 CARD-AC-SIZE		PICTURE 99.
    0340  	02 CARD-AC-POINT	PICTURE 99.
    0341  	02 CARD-AC-IN-NAME	PICTURE X(24).
    0342  	02 CARD-AC-OUT-NAME	PICTURE X(24).
    0343    01  T-CARD REDEFINES N-CARD; DISPLAY-7.
    0344  	02 CARD-T-AC-NUM	PICTURE 9.
    0345  	02 CARD-T-OUT-NAME	PICTURE X(24).
    0346  	02 CARD-T-LEVELS.
    0347  		04 CTL OCCURS 11 TIMES; PICTURE X.
    0348    01  L-CARD REDEFINES N-CARD; DISPLAY-7.
    0349  	02 CARD-L-WHEN		PICTURE X.
    0350  	02 CARD-L-IN-NAME	PICTURE X(24).
    0351  	02 CARD-L-OUT-NAME	PICTURE X(24).
    0352  
    0353    01	IO-CARD REDEFINES N-CARD; PICTURE X(80); DISPLAY-7.
    0354  
    0355    01	MISC-CARD-STUFF REDEFINES N-CARD; DISPLAY-7.
    0356  * 	REDEFINITION OF CARD-LEVEL:
    0357  	02 CL-REDEF		PICTURE 9.
    0358    01	H2-CARD REDEFINES N-CARD; DISPLAY-7.
    0359  	02 CARD-HDR-3		PICTURE X(33).
    0360  	02 CARD-HDR-4		PICTURE X(33).
    0361  
    0362    01	MORE-MISC-CARD-STUFF REDEFINES N-CARD; DISPLAY-7.
    0363  * 	REDEFINITION OF CARD-L-WHEN:
    0364  	02 CARD-L-WHEN-N	PICTURE 9.
    0365      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 9
    COBRG.CBL    12-JUN-72  00:00

    0366    01	SET-PERIOD.
    0367  	02 SPER-1		PICTURE X.
    0368  	02 FILLER		PICTURE X(5).
    0369  	02 SPER-7		PICTURE X.
    0370  	02 FILLER		PICTURE XX.
    0371  	02 SPER-10		PICTURE X.
    0372  	02 FILLER		PICTURE X(10).
    0373  	02 SPER-21		PICTURE X.
    0374  	02 FILLER		PICTURE XXX.
    0375  	02 SPER-25		PICTURE X.
    0376    01	DUMMY-SPER REDEFINES SET-PERIOD.
    0377  	02 SPER OCCURS 25 TIMES; PICTURE X.
    0378    66	SPER-1-7 RENAMES SPER-1 THRU SPER-7.
    0379    66	SPER-1-10 RENAMES SPER-1 THRU SPER-10.
    0380    66	SPER-1-21 RENAMES SPER-1 THRU SPER-21.
    0381    66	SPER-1-25 RENAMES SPER-1 THRU SPER-25.
    0382  
    0383  
    0384    01	NOT-AN-N-CARD;	DISPLAY-7.
    0385  	02 FILLER	PICTURE X(7);	VALUE "NOT AN ".
    0386  	02 FILLER	PICTURE X;	VALUE QUOTE.
    0387  	02 FILLER	PICTURE X;	VALUE "N".
    0388  	02 FILLER	PICTURE X;	VALUE QUOTE.
    0389  	02 FILLER	PICTURE X(5);	VALUE " CARD".
    0390  	02 FILLER	PICTURE X(15);	VALUE SPACES.
    0391  
    0392    01	MORE-THAN-1-BATCH;	DISPLAY-7.
    0393  	02 FILLER	PICTURE X(21);	VALUE "MORE THAN 1 BATCH OF ".
    0394  	02 FILLER	PICTURE X;	VALUE QUOTE.
    0395  	02 MT1B-A	PICTURE X.
    0396  	02 FILLER	PICTURE X;	VALUE QUOTE.
    0397  	02 FILLER	PICTURE X(6);	VALUE " CARDS".
    0398      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 10
    COBRG.CBL    12-JUN-72  00:00

    0399    01  BREAK-FIELDS.
    0400  	02 BF-ENTRY OCCURS 25 TIMES; INDEXED BY BF-INDX.
    0401  	  03 BF-LEVEL		PICTURE X.
    0402  	  03 BF-SIZE		PICTURE 999.
    0403  	  03 BF-NAME 		PICTURE X(24).
    0404  
    0405  * 	ONE ENTRY OF PRINTER CONTROL INFORMATION FOR EACH LEVEL OF BREAK
    0406    01  SKIP-TABLE.
    0407  	02 ST-ENTRY OCCURS 11 TIMES.
    0408  	  03 ST-SKIP-A		PICTURE X.
    0409  	  03 ST-SKIP-B		PICTURE X.
    0410  	  03 ST-SPACE-A		PICTURE X.
    0411  	  03 ST-SPACE-B		PICTURE X.
    0412  
    0413  * 	TABLE OF ACCUMULATOR DEFINITIONS
    0414  
    0415    01  ACCUM-TABLE.
    0416  	02 AT-ENTRY OCCURS 10 TIMES.
    0417  	  03 AC-SIZE 		PICTURE 99.
    0418  	  03 AC-DECIMAL		PICTURE 99.
    0419  	  03 AC-IN-NAME		PICTURE X(24).
    0420  	  03 AC-LIST-NAME	PICTURE X(24).
    0421  	  03 AC-PICTURE		PICTURE X(13).
    0422  * 	THE FOLLOWING ITEM RESETS ACCUM-TABLE
    0423    01	AT-RESET.
    0424  	02 FILLER		PICTURE 9999; VALUE ZEROES.
    0425  	02 FILLER		PICTURE X(61); VALUE SPACES.
    0426  
    0427  * 	THIS TABLE IS FOR THE PRINT-OUTPUT FILE.
    0428FOR EACH ACCUMULATOR (0-9, TABLE BTT-PRINT), SPECIFY ON WHICH BREAKS
    0429  * 		TO PRINT TOTALS
    0430    01	BREAK-TOTALS-TABLE.
    0431  	02 BTT-PRINT OCCURS 10 TIMES.
    0432  	  03 BTTP-FLAGS.
    0433  		04 BTTPF OCCURS 11 TIMES; PICTURE X.
    0434  	  03 BTTP-NAME		PICTURE X(24).
    0435  
    0436    01  HOLD-FLAGS.
    0437  	02 H-FLGS OCCURS 11 TIMES; PICTURE X.
    0438  
    0439  * 	TABLE OF LIST INFORMATION
    0440  
    0441    01  LIST-TABLE; DISPLAY-7.
    0442  	02 LT-ENTRY OCCURS 50 TIMES; INDEXED BY LT-INDX.
    0443  	  03 LT-IN-NAME		PICTURE X(24).
    0444  	  03 LT-OUT-NAME	PICTURE X(24).
    0445  	  03 LT-WHEN 		PICTURE X.
    0446      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 11
    COBRG.CBL    12-JUN-72  00:00

    0447  * 	TABLE OF EMIT INFORMATION
    0448  
    0449    01	EMIT-TABLE; DISPLAY-7.
    0450  	02 EM-ENTRY OCCURS 50 TIMES; INDEXED BY EM-INDX.
    0451  	  03 EM-WHEN		PICTURE X.
    0452  	  03 EM-IN-NAME		PICTURE X(24).
    0453  	  03 EM-OUT-NAME	PICTURE X(24).
    0454  
    0455  * 	TABLE OF HEADER INFORMATION.
    0456  
    0457    01  HEADER-INFO.
    0458  	02 PAGE-SIZE		PICTURE 9.
    0459  	02 PAGE-LOC		PICTURE 999.
    0460  	02 HDR-SP		PICTURE 9.
    0461  	02 HDR-SK		PICTURE 9.
    0462  	02 HEADER-RESET.
    0463  	  03 HR-WHEN OCCURS 11 TIMES; PICTURE X.
    0464  	02 PAGE-HDR-1		PICTURE X(30).
    0465  	02 PAGE-HDR-2		PICTURE X(30).
    0466  	02 PAGE-HDR-3		PICTURE X(33).
    0467  	02 PAGE-HDR-4		PICTURE X(33).
    0468  
    0469  * 	TABLE OF DEFINED BREAKS.
    0470  
    0471    01  BREAK-TABLE.
    0472  	02 BT-ENTRY.
    0473  	  03 BREAKS OCCURS 11 TIMES; PICTURE X.
    0474  	02 NEXT-BREAK OCCURS 11 TIMES; PICTURE X.
    0475  
    0476    01  CHANNEL-TABLE.
    0477  	02 CHAN-ENTRY OCCURS   9 TIMES; PICTURE X.
    0478  	02 SPACE-ENTRY OCCURS 10 TIMES; PICTURE X.
    0479      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 12
    COBRG.CBL    12-JUN-72  00:00

    0480    01  CHANNEL-LINE.
    0481  	02 FILLER		PICTURE X(9)  VALUE "CHANNEL (".
    0482  	02 CHL-NUMBER-A		PICTURE X.
    0483  	02 FILLER		PICTURE X(13) VALUE ") IS CHANNEL-".
    0484  	02 CHL-NUMBER-B		PICTURE X.
    0485  
    0486  
    0487  
    0488    01  SAVE-FIELD-AC.
    0489  	02 FILLER		PICTURE X(9)  VALUE "77  SAVE-".
    0490  	02 SFA-NUM		PICTURE 99.
    0491  	02 FILLER		PICTURE X(21) VALUE SPACES.
    0492  	02 FILLER		PICTURE X(8)  VALUE "PICTURE ".
    0493  	02 SFA-SIZE.
    0494  	  03 FILLER		PICTURE XX.
    0495  	  03 SFAS-A.
    0496  		04 SFAS-B.
    0497  	 05 SFAS-C		PICTURE X.
    0498  	 05 FILLER		PICTURE X.
    0499  		04 FILLER		PICTURE X.
    0500  	  03 FILLER		PICTURE XX.
    0501  	02 FILLER		PICTURE X(17) VALUE SPACES.
    0502  
    0503    01  PROG-ID-LINE.
    0504  	02 FILLER		PICTURE X(12)  VALUE "PROGRAM-ID. ".
    0505  	02 PID-NAME		PICTURE X(7).
    0506      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 13
    COBRG.CBL    12-JUN-72  00:00

    0507    01  DATE-WRITTEN-LINE.
    0508  	02 FILLER		PICTURE X(14) VALUE "DATE-WRITTEN. ".
    0509  	02 DWL-DATE		PICTURE X(10).
    0510  
    0511    01  AUTHOR-LINE.
    0512  	02 FILLER		PICTURE X(8)  VALUE "AUTHOR. ".
    0513  	02 AU-NAME		PICTURE X(21).
    0514  
    0515    01  SELECT-CLAUSE.
    0516  	02 FILLER		PICTURE X(7)  VALUE "SELECT ".
    0517  	02 SEL-NAME		PICTURE X(7).
    0518  	02 FILLER		PICTURE X(14) VALUE SPACES.
    0519  	02 FILLER		PICTURE X(10) VALUE "ASSIGN TO ".
    0520  	02 SEL-DEVICE		PICTURE X(7).
    0521  
    0522    01  BLOCK-CONTAINS-LINE.
    0523  	02 FILLER		PICTURE X(15); VALUE "BLOCK CONTAINS ".
    0524  	02 BLC-VALUE		PICTURE Z9.
    0525  	02 FILLER		PICTURE X(8); VALUE " RECORDS".
    0526  
    0527    01	VALUE-OF-ID-LINE.
    0528  	02 FILLER		PICTURE X(27); VALUE "VALUE OF IDENTIFICATION IS ".
    0529  	02 FILLER		PICTURE X; VALUE QUOTE.
    0530  	02 VIDL-NAME		PICTURE X(9).
    0531  	02 FILLER		PICTURE X; VALUE QUOTE.
    0532  	02 FILLER		PICTURE X; VALUE ".".
    0533  
    0534    01  FILLER-LINE.
    0535  	02 FILLER		PICTURE X(9); VALUE "02 FILLER".
    0536  	02 FILLER		PICTURE X(19); VALUE SPACES.
    0537  	02 FILLER		PICTURE X(10); VALUE "PICTURE X(".
    0538  	02 FILL-LINE-1.
    0539  	  03 FL-AMT-1A		PIC X.
    0540  	  03 FL-AMT-1B		PIC XXXX.
    0541  	02 FILL-LINE-2 REDEFINES FILL-LINE-1.
    0542  	  03 FL-AMT-2A		PIC XX.
    0543  	  03 FL-AMT-2B		PIC XXX.
    0544  	02 FILL-LINE-3 REDEFINES FILL-LINE-1.
    0545  	  03 FL-AMT-3A		PIC XXX.
    0546  	  03 FL-AMT-3B		PIC XX.
    0547      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 14
    COBRG.CBL    12-JUN-72  00:00

    0548    01  PAGE-COUNT-LINE.
    0549  	02 FILLER		PICTURE X(14) VALUE "02 HEADER-PAGE".
    0550  	02 FILLER		PICTURE X(14) VALUE SPACES.
    0551  	02 FILLER		PICTURE X(8)  VALUE "PICTURE ".
    0552  	02 PCL-SIZE.
    0553  	  03 FILLER		PICTURE XX.
    0554  	  03 PCLS-1		PICTURE 9.
    0555  	  03 FILLER		PICTURE X(3).
    0556  	02 FILLER		PICTURE X(19) VALUE SPACES.
    0557  
    0558    01  HDR-VALUE-LINE.
    0559  	02 FILLER		PIC X(15); VALUE "02 FILL PIC X(3".
    0560  	02 HDR-Q-SIZE		PIC X.
    0561  	02 FILLER		PIC X(9); VALUE "); VALUE ".
    0562  	02 HDR-Q-1		PICTURE X.
    0563  	02 HDR-VALUE		PICTURE X(30).
    0564  	02 HDR-Q-2		PIC X.
    0565  	02 HDR-Q-3		PIC X(4).
    0566    01	HDR-VALUE-LINE-REDEF REDEFINES HDR-VALUE-LINE.
    0567  	02 FILLER		PIC X(25).
    0568  	02 HDR-Q-4		PIC X.
    0569  	02 HDR-VALUE-1		PIC X(33).
    0570  	02 HDR-Q-5		PIC X.
    0571  	02 HDR-Q-6		PIC X.
    0572  
    0573    01  HOLD-PC-A.
    0574  	02 HPC-K		PICTURE X.
    0575  	02 HPC-L		PICTURE X(12).
    0576  	01 DUMMY-1 REDEFINES HOLD-PC-A.
    0577  	02 HPC-A.
    0578  	  03 FILLER		PICTURE X(3).
    0579  	  03 HPC-B.
    0580  		04 FILLER		PICTURE X.
    0581  		04 HPC-C 		PICTURE 9.
    0582  	  03 FILLER		PICTURE X.
    0583  	02 HPC-D.
    0584  	  03 FILLER		PICTURE X(3).
    0585  	  03 HPC-E.
    0586  		04 HPC-F 		PICTURE 9.
    0587  		04 FILLER		PICTURE X.
    0588  	  03 FILLER		PICTURE XX.
    0589    01  HOLD-PC-B.
    0590  	02 HPC-G		PICTURE X     VALUE "S".
    0591  	02 HPC-H		PICTURE X(7).
    0592  	02 FILLER		PICTURE X(5)  VALUE SPACES.
    0593  
    0594    01  ZZ-TABLE	   PICTURE X(18); VALUE "Z9.   ZZ9.  ZZZ9. ".
    0595  	01 DUMMY-2 REDEFINES ZZ-TABLE.
    0596  	  02 ZZT-X OCCURS 3 TIMES;	PICTURE X(6).
    0597  
    0598    01  XX-TABLE	   PICTURE X(21); VALUE "X.     XX.    XXX.   ".
    0599  	 01 DUMMY-3 REDEFINES XX-TABLE.
    0600  	  02 XXT-X OCCURS 3 TIMES;	PICTURE X(7).
    0601      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 15
    COBRG.CBL    12-JUN-72  00:00

    0602    01  TEMP-3.
    0603  	02 FILLER		PICTURE X.
    0604  	02 TEMP-2.
    0605  	  03 FILLER		PICTURE X.
    0606  	  03 TEMP-1		PICTURE 9.
    0607    01	TEMP-3N REDEFINES TEMP-3; PIC S999.
    0608  
    0609  
    0610    01  ACCUM-02-LINE.
    0611  	02 FILLER		PICTURE X(3) VALUE "02 ".
    0612  	02 FILLER		PICTURE X(12); VALUE "ACCUMULATOR-".
    0613  	02 AL-AC		PICTURE 9.
    0614  	02 FILLER		PICTURE X(13) VALUE SPACES.
    0615  	02 FILLER		PICTURE X(8)  VALUE "PICTURE ".
    0616  	02 AL-PICTURE		PICTURE X(13).
    0617  
    0618  
    0619    01  ADD-TO-LEVEL-0.
    0620  	02 FILLER		PICTURE X(4) VALUE "ADD ".
    0621  	02 AL0-NAME		PICTURE X(24).
    0622  	02 FILLER		PICTURE X(16); VALUE " TO ACCUMULATOR-".
    0623  	02 AL0-AC		PICTURE 9.
    0624  	02 FILLER		PICTURE X(10); VALUE " OF LEVEL-".
    0625  	02 AL0-LOWEST		PICTURE X.
    0626  	02 FILLER		PICTURE X(5); VALUE "-ACS.".
    0627  
    0628  
    0629    01  ADD-TO-NEXT-LINE.
    0630  	02 FILLER		PICTURE X(24); VALUE "ADD CORRESPONDING LEVEL-".
    0631  	02 AN-LEVEL-A		PICTURE 9.
    0632  	02 FILLER		PICTURE X(14); VALUE "-ACS TO LEVEL-".
    0633  	02 AN-LEVEL-B		PICTURE X.
    0634  	02 FILLER		PICTURE X(5); VALUE "-ACS.".
    0635  
    0636    01  LIST-AC-LINE.
    0637  	02 FILLER		PICTURE X(5)  VALUE "MOVE ".
    0638  	02 LAC-IN-NAME		PICTURE X(24).
    0639  	02 FILLER		PICTURE X(4)  VALUE " TO ".
    0640  	02 LAC-OUT-NAME		PICTURE X(25).
    0641  	02 FILLER		PICTURE X     VALUE SPACES.
    0642      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 16
    COBRG.CBL    12-JUN-72  00:00

    0643    01  SAVE-FIELD-LINE.
    0644  	02 FILLER		PICTURE X(5)  VALUE "MOVE ".
    0645  	02 SF-NAME		PICTURE X(24).
    0646  	02 FILLER		PICTURE X(9)  VALUE " TO SAVE-".
    0647  	02 SF-NUMBER 		PICTURE XX.
    0648  	02 FILLER		PICTURE X     VALUE ".".
    0649  	02 FILLER		PICTURE X(19) VALUE SPACES.
    0650  
    0651  
    0652    01  GO-TO-LINE.
    0653  	02 FILLER		PICTURE X(10) VALUE "    GO TO ".
    0654  	02 FILLER		PICTURE X(6)  VALUE "LEVEL-".
    0655  	02 LOW-BREAK 		PICTURE X.
    0656  	02 FILLER		PICTURE X(7)  VALUE "-BREAK.".
    0657  
    0658  
    0659    01  GO-TO-HI.
    0660  	02 FILLER		PICTURE X(10) VALUE "GO TO RESE".
    0661  	02 FILLER		PICTURE X(8)  VALUE "T-LEVEL-".
    0662  	02 HIGH-BREAK		PICTURE X.
    0663  	02 FILLER		PICTURE X     VALUE ".".
    0664  
    0665  
    0666    01  IF-LINE.
    0667  	02 IFL-1		PICTURE XXX.
    0668  	02 FILLER		PICTURE X(5)  VALUE "SAVE-".
    0669  	02 IFL-3		PICTURE XX.
    0670  	02 FILLER		PICTURE X(17) VALUE " IS NOT EQUAL TO ".
    0671  	02 IFL-2		PICTURE X(24).
    0672  
    0673  
    0674    01  AC-TOTAL-LINE.
    0675  	02 FILLER		PICTURE X(17); VALUE "MOVE ACCUMULATOR-".
    0676  	02 ACTL-2		PICTURE 9.
    0677  	02 FILLER		PICTURE X(10); VALUE " OF LEVEL-".
    0678  	02 ACTL-1		PICTURE X.
    0679  	02 FILLER		PICTURE X(8); VALUE "-ACS TO ".
    0680  	02 ACTL-3		PICTURE X(25).
    0681  
    0682    01	SET-LINE-COUNT.
    0683  	02 FILLER		PICTURE X(5) VALUE "MOVE ".
    0684  	02 SLC-AMOUNT		PICTURE 99.
    0685  	02 FILLER		PICTURE X(15) VALUE " TO LINE-COUNT.".
    0686      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 17
    COBRG.CBL    12-JUN-72  00:00

    0687    01  HEADER.
    0688  	02 FILLER		PICTURE X(46) VALUE SPACES.
    0689  	02 FILLER		PICTURE X(10) VALUE "P R O G R ".
    0690  	02 FILLER		PICTURE X(7)  VALUE "A M    ".
    0691  	02 HEADER-NAME		PICTURE XBXBXBXBXBX.
    0692  	02 FILLER		PICTURE X(37) VALUE SPACES.
    0693  	02 FILLER		PICTURE X(5)  VALUE "PAGE ".
    0694  	02 HEADER-PAGE		PICTURE ZZ9-.
    0695      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 18
    COBRG.CBL    12-JUN-72  00:00

    0696    PROCEDURE DIVISION.
    0697  
    0698    MAIN-BODY SECTION.
    0699  * 	THIS SECTION CONTAINS THE ENTIRE MAIN-LINE CODING.
    0700  
    0701    START.
    0702  	PERFORM INITIALIZE-IO THRU IIO-EXIT.
    0703    RESTART.
    0704  	PERFORM INITIALIZE-TABLES.
    0705  	OPEN OUTPUT TRAN-FILE-OUT; MOVE 1 TO TFO-RECORD-NUMBER.
    0706  	PERFORM READ-IN-DATA-CARDS.
    0707  	CLOSE TRAN-FILE-OUT.
    0708    ERROR-SW. GO TO START-OUTPUT.  NOTE IF ANY ERRORS WERE DETECTED
    0709  		IN THE INPUT, THIS WILL GO TO INPUT-ERROR.
    0710    INPUT-ERROR. DISPLAY "?ERRORS IN PROGRAM ", PID-NAME.
    0711  	GO TO END-TEST.
    0712    START-OUTPUT.
    0713  	OPEN OUTPUT GENERATED-PROG; MOVE SPACES TO PUNCH-REC.
    0714  	DISPLAY "GENERATING ", PID-NAME.
    0715  	OPEN INPUT TRAN-FILE-IN.
    0716  	PERFORM PUT-OUT-ID-ED THRU POIDED-EXIT.
    0717  	PERFORM PUT-OUT-DD THRU PODD-EXIT.
    0718  	PERFORM PUT-OUT-READ THRU POR-EXIT.
    0719  	IF LOW-BREAK IS EQUAL TO SPACE OR "F"
    0720  		MOVE "NOTE NO BREAK COMPARISONS." TO PUNCH-12-72;
    0721  		PERFORM PUNCH-CARD;
    0722  	ELSE
    0723  		PERFORM PUT-OUT-BREAK-TESTS THRU POBT-EXIT VARYING LEVEL
    0724  		    FROM 10 BY -1 UNTIL LEVEL IS EQUAL TO ZERO.
    0725  
    0726  	PERFORM PUT-OUT-DETAIL-PRINT.
    0727  
    0728  	IF LOW-BREAK IS NOT EQUAL TO SPACE
    0729  		PERFORM PUNCH-TOP-FORM;
    0730  		PERFORM PUT-OUT-BREAK-PRINTS THRU POBP-EXIT VARYING LEVEL
    0731  		    FROM 1 BY 1 UNTIL LEVEL IS > 11;
    0732  		PERFORM PUNCH-TOP-FORM;
    0733  		PERFORM PUT-OUT-RESETS THRU PORES-EXIT VARYING LEVEL
    0734  		    FROM 11 BY -1 UNTIL LEVEL IS EQUAL TO ZERO.
    0735  
    0736  	PERFORM PUNCH-TOP-FORM.
    0737  	PERFORM PUT-OUT-SUBROUTINES.
    0738  	PERFORM PUT-OUT-FINISH.
    0739  
    0740  	CLOSE GENERATED-PROG, TRAN-FILE-IN.
    0741  
    0742    END-TEST.
    0743  	MOVE SPACES TO P-L; WRITE P-L BEFORE TOP-OF-FORM.
    0744  	IF MORE-INPUT GO TO RESTART.
    0745    FINISH.
    0746  	CLOSE CARD, LISTING.
    0747  	STOP RUN.
    0748      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 19
    COBRG.CBL    12-JUN-72  00:00

    0749  * 	THIS SECTION CONTAINS SUBROUTINES USED BY MORE THAN ONE
    0750  * 		NON-RESIDENT SECTION.
    0751  
    0752    COMMON-ROUTINES SECTION.
    0753  
    0754    PUNCH-TOP-FORM.
    0755  	MOVE SPACES TO PUNCH-REC.
    0756  	ADD 100 TO LINE-NUMBER.
    0757  * 	IF LINE-NUMBERS DESIRED, PUT HERE: 'MOVE LINE-NUMBER TO PUNCH-1-6.'
    0758  	WRITE PUNCH-REC BEFORE TOP-OF-FORM.
    0759  	MOVE SPACES TO PUNCH-REC.
    0760  
    0761  
    0762  
    0763    PUNCH-BLANK-CARD. NOTE THAT SINCE THE PUNCH-CARD ROUTINE ALWAYS
    0764  	CLEARS THE RECORD AFTER WRITING, WE WILL WRITE A BLANK
    0765  	RECORD (UNLESS SOMEONE PUT SOMETHING IN IT).
    0766  
    0767  
    0768    PUNCH-CARD.
    0769  	ADD 100 TO LINE-NUMBER.
    0770  * 	IF LINE-NUMBERS WANTED, 'MOVE LINE-NUMBER TO PUNCH-1-6' GOES HERE
    0771  	WRITE PUNCH-REC.
    0772  	MOVE SPACES TO PUNCH-REC.
    0773  
    0774    PRINT-ONLY.
    0775  	WRITE P-L.
    0776  	SUBTRACT 1 FROM LINE-COUNT.
    0777  	IF LINE-COUNT IS POSITIVE GO TO CLEAR-PRINT.
    0778  
    0779    PRINT-HDR.
    0780  	MOVE SPACES TO P-L; WRITE P-L BEFORE TOP-OF-FORM.
    0781    PH-A.
    0782  	ADD 1 TO PAGE-COUNT; MOVE PAGE-COUNT TO HEADER-PAGE.
    0783  	WRITE P-L FROM HEADER BEFORE 2.
    0784  	MOVE 56 TO LINE-COUNT.
    0785  
    0786    CLEAR-PRINT.
    0787  	MOVE SPACES TO P-L.
    0788  
    0789    PP-EXIT.  EXIT.
    0790  
    0791  
    0792    PRINT-2.
    0793  	WRITE P-L BEFORE 2.
    0794  	SUBTRACT 2 FROM LINE-COUNT.
    0795  	IF LINE-COUNT IS POSITIVE GO TO CLEAR-PRINT;
    0796  		ELSE GO TO PRINT-HDR.
    0797      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 20
    COBRG.CBL    12-JUN-72  00:00

    0798    ERROR-OUT.
    0799  	ALTER ERROR-SW TO PROCEED TO INPUT-ERROR.
    0800    ERROR-OUT-A.
    0801  	ALTER PRINT-THE-LINE TO PROCEED TO PP-EXIT.
    0802  	PERFORM PRINT-ONLY THRU PP-EXIT.
    0803    EO-EXIT.   EXIT.
    0804  
    0805  
    0806    PRINT-THE-LINE. GO TO PRINT-ONLY.   NOTE IF ANY ERRORS WERE FOUND
    0807  		IN THE CARD, THE CARD HAS BEEN PRINTED, AND THIS WILL
    0808  		GO TO PP-EXIT.
    0809  
    0810  
    0811    SUB-HEADING.
    0812  	IF LINE-COUNT IS NOT GREATER THAN 5
    0813  		WRITE P-L; PERFORM PRINT-HDR THRU PP-EXIT;
    0814  	ELSE
    0815  		WRITE P-L BEFORE 2.
    0816  	MOVE HEADER-1 TO P-L; WRITE P-L.
    0817  	MOVE HEADER-2 TO P-L; WRITE P-L BEFORE 2.
    0818  	SUBTRACT 5 FROM LINE-COUNT.
    0819  	MOVE SPACES TO P-L.
    0820    SUB-HEAD-EXIT.	EXIT.
    0821      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 21
    COBRG.CBL    12-JUN-72  00:00

    0822  * 	THIS SECTION CONTAINS THE INITIALIZATION ROUTINES.
    0823  
    0824    INITIALIZATION SECTION 01.
    0825  
    0826    INITIALIZE-IO.
    0827  	ENTER MACRO NUMJOB USING JOB-NUMBER.
    0828  	MOVE JOB-NUMBER TO TRAN-JOB-NUM; MOVE TRAN-VAL-ID-IN TO TRAN-VAL-ID-OUT.
    0829  	PERFORM GET-COMMAND.
    0830  	OPEN INPUT CARD.
    0831  	OPEN OUTPUT LISTING.
    0832  	ALTER IIO-SW TO PROCEED TO IIO-EXIT.
    0833  	GO TO READ-N-CARD.
    0834  
    0835  
    0836    NO-N-CARD.
    0837  	MOVE N-CARD TO P-L; MOVE NOT-AN-N-CARD TO PL-ERROR.
    0838  	PERFORM PRINT-ONLY THRU PP-EXIT.
    0839  	ALTER IIO-SW TO PROCEED TO SKIP-IIO.
    0840  
    0841  
    0842    READ-N-CARD.
    0843  	READ CARD; AT END GO TO FINISH.
    0844  	IF CARD-CODE IS NOT EQUAL TO "N" GO TO NO-N-CARD.
    0845  
    0846  
    0847    IIO-SW. GO TO. NOTE THIS WILL GO TO SKIP-IIO OR IIO-EXIT.
    0848    SKIP-IIO.
    0849  	MOVE SPACES TO P-L; WRITE P-L BEFORE TOP-OF-FORM.
    0850    IIO-EXIT.   EXIT.
    0851      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 22
    COBRG.CBL    12-JUN-72  00:00

    0852    INITIALIZE-TABLES.
    0853  
    0854  	MOVE ZEROES TO LT-INDX, BF-INDX, EM-INDX.
    0855  	MOVE ZERO TO A-CARD-COUNT, H-CARD-COUNT.
    0856  	MOVE "N" TO TEST-FOR-DETAIL.
    0857  	MOVE ZERO TO PAGE-COUNT.
    0858  	MOVE SPACES TO BREAK-FIELDS,  BREAK-TOTALS-TABLE.
    0859  	PERFORM RESET-ACCUM-TABLE VARYING INDX FROM 1 BY 1
    0860  		UNTIL INDX > 10.
    0861  	MOVE SPACES TO LIST-TABLE, SKIP-TABLE, EMIT-TABLE.
    0862  	MOVE SPACES TO HEADER-INFO.
    0863  	MOVE ZEROES TO PAGE-SIZE, PAGE-LOC.
    0864  	MOVE SPACES TO BREAK-TABLE.
    0865  	MOVE 00     TO BLC-VALUE.
    0866  	MOVE SPACES TO CHANNEL-TABLE.
    0867  	MOVE SPACE TO LOW-BREAK, HIGH-BREAK.
    0868  	MOVE ZEROES TO HOLD-I-KEY, HOLD-P-KEY.
    0869  	MOVE 1 TO TRAN-KEY.
    0870  	MOVE SPACE TO EOF-FLAG.
    0871  	ALTER ERROR-SW TO PROCEED TO START-OUTPUT.
    0872  
    0873    RESET-ACCUM-TABLE.
    0874  	MOVE AT-RESET TO AT-ENTRY (INDX).
    0875      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 23
    COBRG.CBL    12-JUN-72  00:00

    0876  * 	SCAN COMMAND FOR 'FILE.EXT'.
    0877  
    0878    SCAN-FILE-EXT.
    0879  	MOVE	SPACES TO FILE-AND-EXT; MOVE 1 TO J.
    0880    SFE-1.
    0881  	PERFORM SFE-9.
    0882  	IF CHAR = " " OR "_" OR "?" GO TO SFE-EXIT.
    0883  	IF CHAR = "." MOVE 7 TO J; GO TO SFE-2.
    0884  	IF J < 7
    0885  		MOVE CHAR TO FILE-EXT-CHAR (J);
    0886  		SET J UP BY 1.
    0887  	GO TO SFE-1.
    0888  
    0889    SFE-2.
    0890  	PERFORM SFE-9.
    0891  	IF CHAR = " " OR "_" OR "." OR "?" GO TO SFE-EXIT.
    0892  	IF J < 10
    0893  		MOVE CHAR TO FILE-EXT-CHAR (J);
    0894  		SET J UP BY 1.
    0895  	GO TO SFE-2.
    0896  
    0897    SFE-9.
    0898  	IF I > 71
    0899  		MOVE SPACE TO CHAR;
    0900  	ELSE SET I UP BY 1; MOVE COMMAND-CHAR (I) TO CHAR.
    0901  
    0902  	IF CHAR = " " OR "_" OR "." NEXT SENTENCE; ELSE
    0903  	IF CHAR NOT > "Z" AND NOT < "A" OR
    0904  		CHAR NOT > "9" AND NOT < "0" NEXT SENTENCE;
    0905  	ELSE MOVE "?" TO CHAR.
    0906  
    0907    SFE-EXIT. EXIT.
    0908  
    0909  * 	SCAN COMMAND FOR 'FILE.EXT_FILE.EXT'
    0910  
    0911    GET-COMMAND.
    0912  	DISPLAY "*"; ACCEPT COMMAND.
    0913  	MOVE ZERO TO I; PERFORM SCAN-FILE-EXT THRU SFE-EXIT.
    0914  	IF CHAR NOT EQUAL TO "_"
    0915  		DISPLAY "?BAD COBRG COMMAND";
    0916  		GO TO GET-COMMAND.
    0917  	MOVE FILE-AND-EXT TO LIST-FILE-EXT.
    0918  
    0919  	PERFORM SCAN-FILE-EXT THRU SFE-EXIT.
    0920  	IF CHAR NOT = SPACE
    0921  		DISPLAY "?BAD COBRG COMMAND";
    0922  		GO TO GET-COMMAND.
    0923  	MOVE FILE-AND-EXT TO CARD-FILE-EXT.
    0924  
    0925  	IF CARD-FILE-NAME = SPACES
    0926  		DISPLAY "?NO INPUT FILE NAME";
    0927  		GO TO GET-COMMAND.
    0928  
    0929  	IF LIST-FILE-NAME = SPACES MOVE CARD-FILE-NAME TO LIST-FILE-NAME.
    0930  	IF LIST-EXT-NAME = SPACES MOVE "LST" TO LIST-EXT-NAME.
    0931      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 24
    COBRG.CBL    12-JUN-72  00:00

    0932  * 	THIS SECTION READS THE PARAMETER FILE; IT IS ENTERED AFTER
    0933  * 		THE "N" CARD HAS BEEN READ.
    0934  
    0935  
    0936    READ-IN-DATA-CARDS SECTION.
    0937  
    0938    START.
    0939  	ENTER MACRO FORMN USING CARD-RECORD, N-CARD.
    0940  	MOVE "          BLOCKING   INPUT   OUTPUT      INPUT        OUTPUT"
    0941  				TO HEADER-1.
    0942  	MOVE "   NAME    FACTOR    DEVICE  DEVICE   VALUE OF ID  VALUE OF ID
    0943  - 			"   DATE     AUTHOR" TO HEADER-2.
    0944  	MOVE CARD-ID TO HEADER-NAME.
    0945  	PERFORM PH-A THRU PP-EXIT.
    0946  	IF CARD-IN-DEV = SPACES MOVE "DSK" TO CARD-IN-DEV.
    0947  	IF CARD-OUT-DEV = SPACES MOVE "DSK" TO CARD-OUT-DEV.
    0948  	PERFORM SUB-HEADING THRU SUB-HEAD-EXIT.
    0949  
    0950  	MOVE CARD-CODE      TO PL-CODE.
    0951  	MOVE CARD-ID        TO PL-ID, CBL-VAL-ID-FILE.
    0952  	MOVE CARD-BLOCKING  TO PL-BLOCKING, BLC-VALUE.
    0953  	MOVE CARD-IN-DEV    TO PL-INPUT-DEV.
    0954  	MOVE CARD-OUT-DEV   TO PL-OUTPUT-DEV.
    0955  	MOVE CARD-IN-VAL-ID TO PL-IN-VAL, IN-VAL-ID.
    0956  	MOVE CARD-OUT-VAL-ID TO PL-OUT-VAL, OUT-VAL-ID.
    0957  	MOVE CARD-DATE      TO PL-DATE.
    0958  	MOVE CARD-AUTHOR    TO PL-AUTHOR.
    0959  
    0960  	MOVE CARD-ID TO SPER-1-7.
    0961  	PERFORM MOVE-PERIOD VARYING INDX FROM 7 BY -1 UNTIL INDX LESS THAN 1.
    0962  	MOVE SPER-1-7 TO PID-NAME.
    0963  
    0964  	MOVE CARD-DATE TO SPER-1-10.
    0965  	PERFORM MOVE-PERIOD VARYING INDX FROM 10 BY -1 UNTIL INDX < 1.
    0966  	MOVE SPER-1-10 TO DWL-DATE.
    0967  
    0968  	MOVE CARD-AUTHOR TO SPER-1-21.
    0969  	PERFORM MOVE-PERIOD VARYING INDX FROM 21 BY -1 UNTIL INDX < 1.
    0970  	MOVE SPER-1-21 TO AU-NAME.
    0971  
    0972  	MOVE CARD-IN-DEV TO SPER-1-7.
    0973  	PERFORM MOVE-PERIOD VARYING INDX FROM 7 BY -1 UNTIL INDX < 1.
    0974  	MOVE SPER-1-7 TO IN-DEVICE.
    0975  	MOVE CARD-OUT-DEV TO SPER-1-7.
    0976  	PERFORM MOVE-PERIOD VARYING INDX FROM 7 BY -1 UNTIL INDX < 1.
    0977  	MOVE SPER-1-7 TO OUT-DEVICE.
    0978  
    0979  	IF CARD-ID IS EQUAL TO SPACES
    0980  		MOVE "NO PROG-ID" TO PL-ERROR;
    0981  		PERFORM ERROR-OUT THRU EO-EXIT.
    0982  
    0983  
    0984    CHECK-BLOCKING.
    0985  	IF CARD-BLOCKING IS NOT NUMERIC
    0986  		MOVE "IMPROPER BLOCKING FACTOR" TO PL-ERROR;
    0987  		MOVE 01 TO BLC-VALUE;    P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 24-1
    COBRG.CBL    12-JUN-72  00:00

    0988  		PERFORM PRINT-ONLY THRU PP-EXIT.
    0989  
    0990  	PERFORM PRINT-2 THRU PP-EXIT.
    0991  	MOVE "N" TO PREV-CARD-CODE.
    0992      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 25
    COBRG.CBL    12-JUN-72  00:00

    0993    READ-NEXT-CARD.
    0994  	ALTER PRINT-THE-LINE TO PROCEED TO PRINT-ONLY.
    0995  	READ CARD; AT END
    0996  		MOVE "X" TO EOF-FLAG; GO TO FINISH-RIDC.
    0997    READ-NC-0.
    0998  	IF NO-MORE-INPUT OR CARD-CODE EQUALS "N"
    0999  		GO TO FINISH-RIDC.
    1000  	IF CARD-CODE EQUALS "1" MOVE "I" TO CARD-CODE; ELSE
    1001  	IF CARD-CODE EQUALS "0" MOVE "O" TO CARD-CODE.
    1002  	IF CARD-CODE EQUALS "I" OR "O" GO TO DATA-RECORD-CARD.
    1003  	IF CARD-CODE IS EQUAL TO PREV-CARD-CODE GO TO READ-NC-B;
    1004  		ELSE MOVE CARD-CODE TO PREV-CARD-CODE.
    1005  	IF CARD-CODE IS EQUAL TO "B" GO TO BREAK-CARD.
    1006  	IF CARD-CODE IS EQUAL TO "H" GO TO HEADER-CARD.
    1007  	IF CARD-CODE IS EQUAL TO "A" GO TO ACCUM-CARD.
    1008  	IF CARD-CODE IS EQUAL TO "L" GO TO LIST-CARD.
    1009  	IF CARD-CODE IS EQUAL TO "T" GO TO TOTAL-CARD.
    1010  	IF CARD-CODE IS EQUAL TO "E" GO TO EMIT-CARD;   ELSE
    1011  		MOVE SPACES TO HEADER-1, HEADER-2;
    1012  		PERFORM PRINT-2 THRU PP-EXIT;
    1013  		GO TO READ-NC-C.
    1014    READ-NC-B.
    1015  	IF CARD-CODE IS EQUAL TO "B" GO TO BREAK-CARD-0.
    1016  	IF CARD-CODE IS EQUAL TO "H" GO TO HEADER-CARD-0.
    1017  	IF CARD-CODE IS EQUAL TO "A" GO TO ACCUM-CARD-0.
    1018  	IF CARD-CODE IS EQUAL TO "L" GO TO LIST-CARD-0.
    1019  	IF CARD-CODE IS EQUAL TO "T" GO TO TOTAL-CARD-0.
    1020  	IF CARD-CODE IS EQUAL TO "E" GO TO EMIT-CARD-0.
    1021  
    1022    READ-NC-C.
    1023  	MOVE N-CARD TO P-L; MOVE "IMPROPER INPUT CARD" TO PL-ERROR.
    1024  	PERFORM ERROR-OUT THRU EO-EXIT.
    1025    CYCLE-BACK.
    1026  	PERFORM PRINT-THE-LINE THRU PP-EXIT.
    1027  	GO TO READ-NEXT-CARD.
    1028  
    1029    MOVE-PERIOD.
    1030  	IF SET-PERIOD = SPACES MOVE 0 TO INDX;
    1031  	ELSE IF SPER (INDX) = SPACE NEXT SENTENCE;
    1032  	ELSE IF SPER (INDX) = "." MOVE 0 TO INDX;
    1033  	ELSE SET INDX UP BY 1;
    1034  		MOVE "." TO SPER (INDX);
    1035  		MOVE 0 TO INDX.
    1036      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 26
    COBRG.CBL    12-JUN-72  00:00

    1037    SET-UP-PICTURES.
    1038  	IF AC-SIZE (INDX) IS EQUAL TO ZERO GO TO SUPIC-EXIT.
    1039  	SUBTRACT AC-DECIMAL (INDX) FROM AC-SIZE (INDX)
    1040  		GIVING LEVEL.
    1041  	IF LEVEL IS EQUAL TO ZERO GO TO SUPIC-B.
    1042  	IF LEVEL IS LESS THAN 10
    1043  		MOVE " S9( )"  TO HPC-A; MOVE LEVEL TO HPC-C;
    1044  	ELSE
    1045  		MOVE "S9(  )"  TO HPC-A; MOVE LEVEL TO HPC-B.
    1046  
    1047  	MOVE AC-DECIMAL (INDX) TO LEVEL.
    1048  	IF LEVEL IS EQUAL TO ZERO
    1049  		MOVE ".     " TO HPC-D; GO TO SUPIC-A.
    1050  	IF LEVEL IS LESS THAN 10
    1051  		MOVE "V9( ). " TO HPC-D; MOVE LEVEL TO HPC-F;
    1052  	ELSE
    1053  		MOVE "V9(  )." TO HPC-D; MOVE LEVEL TO HPC-E.
    1054    SUPIC-A.
    1055  	IF HPC-K IS EQUAL TO SPACE MOVE HPC-L TO HOLD-PC-A.
    1056  	MOVE HOLD-PC-A TO AC-PICTURE (INDX).
    1057  	GO TO SUPIC-EXIT.
    1058  
    1059    SUPIC-B.
    1060  	MOVE AC-DECIMAL (INDX) TO LEVEL.
    1061  	IF LEVEL IS LESS THAN 10
    1062  		MOVE "V9( ). " TO HPC-D; MOVE LEVEL TO HPC-F;
    1063  	ELSE
    1064  		MOVE "V9(  )." TO HPC-D; MOVE LEVEL TO HPC-E.
    1065  	MOVE HPC-D TO HPC-H.
    1066  
    1067  	MOVE HOLD-PC-B TO AC-PICTURE (INDX).
    1068  
    1069    SUPIC-EXIT.  EXIT.
    1070  
    1071  
    1072  
    1073    SETUP-NEXT-BREAK.
    1074  	MOVE BREAKS (LEVEL) TO HOLD-X.
    1075  	IF HOLD-X IS EQUAL TO SPACE GO TO SNB-EXIT.
    1076  	ADD 1, LEVEL GIVING INDX.
    1077    SNB-1.
    1078  	IF INDX IS EQUAL TO 12 GO TO SNB-EXIT.
    1079  	MOVE BREAKS (INDX) TO HOLD-X.
    1080  	IF HOLD-X IS EQUAL TO SPACE
    1081  		ADD 1 TO INDX; GO TO SNB-1.
    1082  	MOVE HOLD-X TO NEXT-BREAK (LEVEL).
    1083    SNB-EXIT. EXIT.
    1084  
    1085    GET-LOW-BREAK.
    1086  	MOVE BREAKS (INDX) TO LOW-BREAK.
    1087    GET-HIGH-BREAK.
    1088  	MOVE BREAKS (INDX) TO HIGH-BREAK.
    1089      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 27
    COBRG.CBL    12-JUN-72  00:00

    1090    FINISH-RIDC.
    1091  	PERFORM SETUP-NEXT-BREAK THRU SNB-EXIT VARYING LEVEL FROM 01
    1092  		BY 1 UNTIL LEVEL IS GREATER THAN 10.
    1093  	IF BT-ENTRY IS NOT EQUAL TO SPACES
    1094  		PERFORM GET-LOW-BREAK VARYING INDX FROM 01 BY 1
    1095  		   UNTIL LOW-BREAK IS NOT EQUAL TO SPACE;
    1096  		MOVE INDX TO LOW-INDX;
    1097  		MOVE LOW-BREAK TO AL0-LOWEST;
    1098  		PERFORM GET-HIGH-BREAK VARYING INDX FROM 11 BY -1
    1099  		   UNTIL HIGH-BREAK IS NOT EQUAL TO SPACE.
    1100  
    1101  	PERFORM SET-UP-PICTURES THRU SUPIC-EXIT VARYING INDX FROM 01
    1102  		BY 1 UNTIL INDX > 10.
    1103      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 28
    COBRG.CBL    12-JUN-72  00:00

    1104  * 	THIS SECTION PROCESSES A "B" RECORD.
    1105  
    1106    BREAK-CARD SECTION 03.
    1107  
    1108    START.
    1109  	MOVE "         PRINTER-CONTROL     BREAK" TO HEADER-1.
    1110  	MOVE "  LEVEL   BEFORE  AFTER   SIZE   NAME" TO HEADER-2.
    1111  	PERFORM SUB-HEADING THRU SUB-HEAD-EXIT.
    1112  
    1113  
    1114    BREAK-CARD-0.
    1115  	ENTER MACRO FORMB USING CARD-RECORD, B-CARD.
    1116  	MOVE "B"	    TO PL-CODE.
    1117  	MOVE CARD-LEVEL     TO PL-LEVEL.
    1118  	MOVE CARD-SPB       TO PL-SPB.
    1119  	MOVE CARD-SKB       TO PL-SKB.
    1120  	MOVE CARD-SPA       TO PL-SPA.
    1121  	MOVE CARD-SKA       TO PL-SKA.
    1122  
    1123  	IF CARD-LEVEL IS NOT EQUAL TO "F"
    1124  		MOVE CARD-BRK-NAME  TO PL-BRK-NAME;
    1125  		MOVE CARD-BRK-SIZE  TO PL-BRK-SIZE.
    1126  
    1127  	IF BF-INDX IS EQUAL TO 25
    1128  		MOVE "TOO MANY BREAKS" TO PL-ERROR;
    1129  		PERFORM ERROR-OUT THRU EO-EXIT;
    1130  		GO TO READ-NEXT-CARD.
    1131  	ADD 1 TO BF-INDX.
    1132  
    1133  	IF CARD-LEVEL = "F"
    1134  		MOVE 11 TO INDX; MOVE "F" TO BREAKS (11);
    1135  		GO TO BREAK-CARD-A;
    1136  	ELSE
    1137  	IF CARD-LEVEL IS LESS THAN 0 OR GREATER THAN 9
    1138  		MOVE "IMPROPER LEVEL" TO PL-ERROR;
    1139  		PERFORM ERROR-OUT THRU EO-EXIT;
    1140  	ELSE
    1141  		ADD CL-REDEF, 01 GIVING INDX;
    1142  		MOVE CARD-LEVEL TO BREAKS (INDX).
    1143  
    1144  	IF CARD-BRK-NAME IS EQUAL TO SPACES
    1145  		MOVE "NO NAME GIVEN" TO PL-ERROR;
    1146  		PERFORM ERROR-OUT THRU EO-EXIT.
    1147  	IF CARD-BRK-SIZE IS EQUAL TO ZERO
    1148  		MOVE "IMPROPER FIELD SIZE" TO PL-ERROR;
    1149  		PERFORM ERROR-OUT THRU EO-EXIT;
    1150  	ELSE
    1151  	IF CARD-BRK-SIZE IS NUMERIC NEXT SENTENCE;  ELSE
    1152  		MOVE "IMPROPER FIELD SIZE" TO PL-ERROR;
    1153  		PERFORM ERROR-OUT THRU EO-EXIT.
    1154      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 29
    COBRG.CBL    12-JUN-72  00:00

    1155    BREAK-CARD-A.
    1156  	IF CARD-SPACING IS NOT EQUAL TO SPACES AND
    1157  		ST-ENTRY (INDX) IS NOT EQUAL TO SPACES
    1158  		MOVE "SPACING TAKEN FROM ABOVE" TO PL-ERROR;
    1159  		PERFORM ERROR-OUT-A THRU EO-EXIT;
    1160  		GO TO FILL-IN-BF.
    1161  	IF CARD-SPACING IS EQUAL TO SPACES AND
    1162  		ST-ENTRY (INDX) IS NOT EQUAL TO SPACES GO TO FILL-IN-BF.
    1163  
    1164  	IF CARD-SPB IS NOT NUMERIC OR CARD-SPB IS GREATER THAN HIGHEST-SPACE OR
    1165  		CARD-SPA IS NOT NUMERIC OR CARD-SPA IS GREATER THAN HIGHEST-SPACE OR
    1166  		CARD-SKA IS NOT NUMERIC OR CARD-SKA IS GREATER THAN HIGHEST-CHANNEL OR
    1167  		CARD-SKB IS NOT NUMERIC OR CARD-SKB IS GREATER THAN HIGHEST-CHANNEL
    1168  		MOVE "IMPROPER SPACE OR SKIP" TO PL-ERROR;
    1169  		PERFORM ERROR-OUT THRU EO-EXIT; GO TO FILL-IN-BF;
    1170  	ELSE
    1171  		ADD CARD-SKA, 01 GIVING INDX-1;
    1172  		MOVE CARD-SKA TO CHAN-ENTRY (INDX-1);
    1173  		ADD CARD-SKB, 01 GIVING INDX-1;
    1174  		MOVE CARD-SKB TO CHAN-ENTRY (INDX-1).
    1175  
    1176  	IF CARD-SPA IS NOT EQUAL TO 0 AND CARD-SKA IS NOT EQUAL TO 0
    1177  	OR CARD-SPB IS NOT EQUAL TO 0 AND CARD-SKB IS NOT EQUAL TO 0
    1178  		MOVE "BOTH SPACE AND SKIP" TO PL-ERROR;
    1179  		PERFORM ERROR-OUT-A THRU EO-EXIT.
    1180  
    1181  	ADD CARD-SPA, 1 GIVING INDX-1; MOVE CARD-SPA TO SPACE-ENTRY (INDX-1).
    1182  	ADD CARD-SPB, 1 GIVING INDX-1; MOVE CARD-SPB TO SPACE-ENTRY (INDX-1).
    1183  	MOVE CARD-SPB TO ST-SPACE-B (INDX).
    1184  	MOVE CARD-SPA TO ST-SPACE-A (INDX).
    1185  	MOVE CARD-SKA TO ST-SKIP-A  (INDX).
    1186  	MOVE CARD-SKB TO ST-SKIP-B  (INDX).
    1187  
    1188    FILL-IN-BF.
    1189  	IF CARD-LEVEL IS NOT EQUAL TO "F"
    1190  		MOVE CARD-LEVEL     TO BF-LEVEL (BF-INDX);
    1191  		MOVE CARD-BRK-NAME  TO BF-NAME  (BF-INDX);
    1192  		MOVE CARD-BRK-SIZE  TO BF-SIZE  (BF-INDX).
    1193  
    1194  	PERFORM PRINT-THE-LINE THRU PP-EXIT.
    1195  	GO TO READ-NEXT-CARD.
    1196      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 30
    COBRG.CBL    12-JUN-72  00:00

    1197  * 	THIS SECTION PROCESSES AN "H" CARD.
    1198  
    1199    HEADER-CARD SECTION 04.
    1200  
    1201    START.
    1202  	MOVE "   PAGE   HEADER" TO HEADER-1.
    1203  	MOVE " SIZE LOC CONTROL RESET PAGE   HEADING" TO HEADER-2.
    1204  	PERFORM SUB-HEADING THRU SUB-HEAD-EXIT.
    1205  
    1206  
    1207    HEADER-CARD-0.
    1208  	ADD 1 TO H-CARD-COUNT.
    1209  	MOVE "H" TO PL-CODE.
    1210  	IF H-CARD-COUNT IS GREATER THAN 2
    1211  		MOVE 3 TO H-CARD-COUNT;
    1212  		MOVE "TOO MANY HEADER CARDS" TO PL-ERROR;
    1213  		PERFORM ERROR-OUT-A THRU EO-EXIT;
    1214  		GO TO CYCLE-BACK.
    1215  
    1216  	MOVE "H" TO PL-CODE.
    1217      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 31
    COBRG.CBL    12-JUN-72  00:00

    1218  	IF H-CARD-COUNT IS EQUAL TO 2
    1219  		ENTER MACRO FORMH2 USING CARD-RECORD, H2-CARD;
    1220  		MOVE CARD-HDR-3 TO PAGE-HDR-3, PL-HDR-3;
    1221  		MOVE CARD-HDR-4 TO PAGE-HDR-4, PL-HDR-4;
    1222  		GO TO CYCLE-BACK.
    1223  
    1224  	ENTER MACRO FORMH1 USING CARD-RECORD, H-CARD.
    1225  	MOVE CARD-HDR-1 TO PL-HDR-1, PAGE-HDR-1.
    1226  	MOVE CARD-HDR-2 TO PL-HDR-2, PAGE-HDR-2.
    1227  
    1228  	MOVE CARD-PAGE-SIZE	TO PL-PAGE-SIZE.
    1229  	MOVE CARD-PAGE-LOC	TO PL-PAGE-LOC.
    1230  	MOVE CARD-HDR-SP	TO PL-HDR-SP.
    1231  	MOVE CARD-HDR-SK	TO PL-HDR-SK.
    1232  	MOVE CARD-PAGE-RESET TO PL-PAGE-RESET.
    1233  
    1234  	IF CARD-PAGE-SIZE IS NOT NUMERIC
    1235  		MOVE "IMPROPER PAGE SIZE" TO PL-ERROR;
    1236  		PERFORM ERROR-OUT THRU EO-EXIT.
    1237  
    1238  	MOVE CARD-PAGE-SIZE TO PAGE-SIZE.
    1239  	MOVE CARD-PAGE-LOC TO PAGE-LOC.
    1240  
    1241  	IF CARD-PAGE-LOC EQUALS SPACES AND CARD-PAGE-SIZE EQUALS ZERO
    1242  		GO TO HEADER-CARD-C.
    1243  
    1244  	IF CARD-PAGE-LOC IS NUMERIC NEXT SENTENCE;  ELSE
    1245  		MOVE "IMPROPER PAGE LOC" TO PL-ERROR;
    1246  		PERFORM ERROR-OUT THRU EO-EXIT;
    1247  		GO TO HEADER-CARD-C.
    1248  
    1249  	IF PAGE-SIZE IS EQUAL TO ZERO AND PAGE-LOC IS NOT EQUAL TO ZERO
    1250  		MOVE "NO PAGE SIZE" TO PL-ERROR;
    1251  		PERFORM ERROR-OUT THRU EO-EXIT;
    1252  		GO TO HEADER-CARD-C.
    1253  	IF CARD-PAGE-LOC IS GREATER THAN 133 - PAGE-SIZE
    1254  		MOVE "PAGE LOC TOO FAR RIGHT" TO PL-ERROR;
    1255  		PERFORM ERROR-OUT THRU EO-EXIT.
    1256      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 32
    COBRG.CBL    12-JUN-72  00:00

    1257    HEADER-CARD-C.
    1258  	IF CARD-HDR-SP IS NOT NUMERIC OR CARD-HDR-SP IS GREATER THAN HIGHEST-SPACE
    1259  		MOVE "IMPROPER HEADER SPACING" TO PL-ERROR;
    1260  		PERFORM ERROR-OUT THRU EO-EXIT;
    1261  	ELSE
    1262  		ADD CARD-HDR-SP, 1 GIVING INDX-1;
    1263  		MOVE CARD-HDR-SP TO HDR-SP, SPACE-ENTRY (INDX-1).
    1264  
    1265  	IF CARD-HDR-SK IS NOT NUMERIC OR CARD-HDR-SK IS GREATER THAN HIGHEST-CHANNEL
    1266  		MOVE "IMPROPER HEADER SKIPPING" TO PL-ERROR;
    1267  		PERFORM ERROR-OUT THRU EO-EXIT;
    1268  	ELSE
    1269  		ADD CARD-HDR-SK, 1 GIVING INDX-1;
    1270  		MOVE CARD-HDR-SK TO HDR-SK, CHAN-ENTRY (INDX-1).
    1271  	IF HDR-SK IS NOT EQUAL TO ZERO AND HDR-SP IS NOT EQUAL TO ZERO
    1272  		MOVE "BOTH SPACE AND SKIP" TO PL-ERROR;
    1273  		PERFORM ERROR-OUT-A THRU EO-EXIT.
    1274  
    1275  	PERFORM TEST-PAGE-RESET THRU TPR-EXIT VARYING INDX FROM 01
    1276  		BY 1 UNTIL INDX IS GREATER THAN 10.
    1277  
    1278  	MOVE CARD-HDR-1 TO PAGE-HDR-1.
    1279  	MOVE CARD-HDR-2 TO PAGE-HDR-2.
    1280  
    1281  	GO TO CYCLE-BACK.
    1282  
    1283    TEST-PAGE-RESET.
    1284  	MOVE CPR (INDX) TO HOLD-X.
    1285  	IF HOLD-X IS EQUAL TO SPACE GO TO TPR-EXIT.
    1286  
    1287  	IF HOLD-X IS LESS THAN ZERO OR GREATER THAN 9
    1288  		MOVE "IMPROPER BREAK FOR RESET" TO PL-ERROR;
    1289  		PERFORM ERROR-OUT THRU EO-EXIT;
    1290  		GO TO TPR-EXIT;
    1291  	ELSE
    1292  		ADD HOLD-N, 01 GIVING LEVEL.
    1293  	IF BREAKS (LEVEL) IS EQUAL TO SPACE
    1294  		MOVE "NON-EXISTENT BREAK FOR RESET" TO PL-ERROR;
    1295  		PERFORM ERROR-OUT THRU EO-EXIT;
    1296  		GO TO TPR-EXIT.
    1297  
    1298  	IF HR-WHEN (LEVEL) IS EQUAL TO HOLD-X
    1299  		MOVE "SAME BREAK NOTED TWICE" TO PL-ERROR;
    1300  		PERFORM ERROR-OUT THRU EO-EXIT;
    1301  	ELSE
    1302  		MOVE HOLD-X TO HR-WHEN (LEVEL).
    1303  
    1304    TPR-EXIT.  EXIT.
    1305      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 33
    COBRG.CBL    12-JUN-72  00:00

    1306  * 	THIS SECTION PROCESSES AN "A" CARD.
    1307  
    1308    ACCUM-CARD SECTION 05.
    1309  
    1310    START.
    1311  	MOVE "    ACCUMULATOR" TO HEADER-1.
    1312  	MOVE "   #  SIZE  POINT     INPUT NAME                  LISTING NAME"
    1313  		TO HEADER-2.
    1314  	PERFORM SUB-HEADING THRU SUB-HEAD-EXIT.
    1315  
    1316  
    1317    ACCUM-CARD-0.
    1318  	ENTER MACRO FORMA USING CARD-RECORD, A-CARD.
    1319  	ADD 1 TO A-CARD-COUNT.
    1320  	MOVE "A"		 TO PL-CODE.
    1321  	MOVE CARD-AC-NUM	 TO PL-AC-NUM.
    1322  	MOVE CARD-AC-SIZE	 TO PL-AC-SIZE.
    1323  	MOVE CARD-AC-POINT	 TO PL-AC-POINT.
    1324  	MOVE CARD-AC-IN-NAME     TO PL-AC-IN-NAME.
    1325  	MOVE CARD-AC-OUT-NAME    TO PL-AC-OUT-NAME.
    1326  	IF CARD-AC-SIZE IS NOT NUMERIC GO TO AC-CARD-A.
    1327  
    1328  	IF CARD-AC-SIZE IS EQUAL TO ZERO OR GREATER THAN 18
    1329  		NEXT SENTENCE ELSE GO TO AC-CARD-B.
    1330    AC-CARD-A.
    1331  		MOVE "IMPROPER AC SIZE" TO PL-ERROR;
    1332  		MOVE ZERO TO CARD-AC-SIZE;
    1333  		PERFORM ERROR-OUT THRU EO-EXIT.
    1334  
    1335    AC-CARD-B.
    1336  	IF CARD-AC-NUM IS LESS THAN ZERO OR GREATER THAN 9
    1337  		MOVE "IMPROPER AC NUMBER" TO PL-ERROR;
    1338  		PERFORM ERROR-OUT THRU EO-EXIT;
    1339  		MOVE ZERO TO CARD-AC-SIZE.
    1340  	ADD CARD-AC-NUM, 01 GIVING INDX.
    1341  	IF AC-SIZE (INDX) IS NOT EQUAL TO ZERO
    1342  		MOVE "DUPLICATE AC" TO PL-ERROR;
    1343  		PERFORM ERROR-OUT THRU EO-EXIT;
    1344  		MOVE ZERO TO CARD-AC-SIZE.
    1345  
    1346  	IF CARD-AC-POINT IS NOT NUMERIC OR
    1347  		CARD-AC-POINT IS GREATER THAN CARD-AC-SIZE
    1348  		MOVE "IMPROPER POINT LOCATION" TO PL-ERROR;
    1349  		PERFORM ERROR-OUT THRU EO-EXIT;
    1350  		MOVE ZERO TO CARD-AC-SIZE.
    1351  
    1352  	IF CARD-AC-IN-NAME IS EQUAL TO SPACES
    1353  		MOVE "NO INPUT NAME" TO PL-ERROR;
    1354  		PERFORM ERROR-OUT THRU EO-EXIT;
    1355  		MOVE ZERO TO CARD-AC-SIZE.
    1356  
    1357  	IF CARD-AC-SIZE IS EQUAL TO ZERO GO TO CYCLE-BACK.
    1358  
    1359  	MOVE CARD-AC-SIZE TO AC-SIZE (INDX).
    1360  	MOVE CARD-AC-POINT TO AC-DECIMAL (INDX).
    1361  	MOVE CARD-AC-IN-NAME TO AC-IN-NAME (INDX).    P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 33-1
    COBRG.CBL    12-JUN-72  00:00

    1362  	MOVE CARD-AC-OUT-NAME TO AC-LIST-NAME (INDX).
    1363  
    1364  	GO TO CYCLE-BACK.
    1365      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 34
    COBRG.CBL    12-JUN-72  00:00

    1366  * 	THIS SECTION PROCESSES A "T" CARD.
    1367  
    1368    TOTAL-CARD SECTION 06.
    1369  
    1370    START.
    1371  	MOVE "   AC NUMBER       WHEN           OUTPUT NAME"
    1372  		TO HEADER-2; MOVE SPACES TO HEADER-1.
    1373  	PERFORM SUB-HEADING THRU SUB-HEAD-EXIT.
    1374  
    1375  
    1376    TOTAL-CARD-0.
    1377  	ENTER MACRO FORMT USING CARD-RECORD, T-CARD.
    1378  	MOVE "T"	       TO PL-CODE.
    1379  	MOVE CARD-T-AC-NUM     TO PL-T-AC-NUM.
    1380  	MOVE CARD-T-LEVELS     TO PL-T-LEVELS.
    1381  	MOVE CARD-T-OUT-NAME   TO PL-T-OUT-NAME.
    1382  
    1383  	IF CARD-T-AC-NUM IS LESS THAN ZERO OR GREATER THAN 9
    1384  		MOVE "IMPROPER AC NUMBER" TO PL-ERROR;
    1385  		PERFORM ERROR-OUT THRU EO-EXIT;
    1386  		MOVE ZERO TO INDX;
    1387  	ELSE
    1388  		ADD CARD-T-AC-NUM, 01 GIVING INDX;
    1389  		MOVE CARD-T-OUT-NAME TO BTTP-NAME (INDX);
    1390  		IF AC-SIZE (INDX) IS EQUAL TO ZERO
    1391  		MOVE "NON-EXISTENT AC" TO PL-ERROR;
    1392  		PERFORM ERROR-OUT THRU EO-EXIT.
    1393  
    1394  	IF CARD-T-OUT-NAME IS EQUAL TO SPACES
    1395  		MOVE "NO OUTPUT NAME" TO PL-ERROR;
    1396  		PERFORM ERROR-OUT THRU EO-EXIT.
    1397  
    1398  	IF CARD-T-LEVELS IS EQUAL TO SPACES
    1399  		MOVE "NO BREAKS SPECIFIED" TO PL-ERROR;
    1400  		PERFORM ERROR-OUT THRU EO-EXIT;
    1401  	ELSE
    1402  		IF INDX IS NOT EQUAL TO ZERO
    1403  		MOVE SPACES TO HOLD-FLAGS;
    1404  		PERFORM TEST-T-FLAGS THRU TTF-EXIT VARYING LEVEL FROM 01
    1405  			BY 1 UNTIL LEVEL IS GREATER THAN 11.
    1406  
    1407    END-T-CARD.
    1408  	PERFORM PRINT-THE-LINE THRU PP-EXIT.
    1409  
    1410  	GO TO READ-NEXT-CARD.
    1411      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 35
    COBRG.CBL    12-JUN-72  00:00

    1412    TEST-T-FLAGS.
    1413  	MOVE CTL (LEVEL) TO HOLD-X.
    1414  	IF HOLD-X IS EQUAL TO SPACE GO TO TTF-EXIT.
    1415  	IF HOLD-X IS EQUAL TO "F"
    1416  		MOVE 11 TO INDX-1; MOVE "F" TO BREAKS (11);	ELSE
    1417  	IF HOLD-X IS LESS THAN 0 OR GREATER THAN 9
    1418  		MOVE "IMPROPER BREAK" TO PL-ERROR;
    1419  		PERFORM ERROR-OUT THRU EO-EXIT;
    1420  		GO TO TTF-EXIT;
    1421  	ELSE
    1422  		ADD HOLD-N, 01 GIVING INDX-1.
    1423  
    1424  	MOVE HOLD-X TO BTTPF (INDX, INDX-1).
    1425  
    1426  	IF H-FLGS (INDX-1) IS EQUAL TO SPACE
    1427  		MOVE HOLD-X TO H-FLGS (INDX-1);
    1428  	ELSE
    1429  		MOVE "DUPLICATE BREAKS" TO PL-ERROR;
    1430  		PERFORM ERROR-OUT THRU EO-EXIT.
    1431  
    1432    TTF-EXIT. EXIT.
    1433      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 36
    COBRG.CBL    12-JUN-72  00:00

    1434  	NOTE THIS SECTION PROCESSES AN "L" CARD.
    1435  
    1436    LIST-CARD SECTION 07.
    1437  
    1438    START.
    1439  	MOVE "   WHEN   INPUT NAME                      OUTPUT NAME"
    1440  		TO HEADER-2; MOVE SPACE TO HEADER-1.
    1441  	PERFORM SUB-HEADING THRU SUB-HEAD-EXIT.
    1442  
    1443  
    1444    LIST-CARD-0.
    1445  	ENTER MACRO FORML USING CARD-RECORD, L-CARD.
    1446  	MOVE "L"		TO PL-CODE.
    1447  	MOVE CARD-L-WHEN	TO PL-L-WHEN.
    1448  	MOVE CARD-L-IN-NAME	TO PL-L-IN-NAME.
    1449  	MOVE CARD-L-OUT-NAME    TO PL-L-OUT-NAME.
    1450  
    1451      IF LT-INDX IS EQUAL TO 50
    1452  		MOVE "TOO MANY LIST CARDS" TO PL-ERROR;
    1453  		PERFORM ERROR-OUT THRU EO-EXIT;
    1454  		GO TO CYCLE-BACK.
    1455  
    1456      ADD 1 TO LT-INDX.
    1457  
    1458  	MOVE CARD-L-WHEN TO LT-WHEN (LT-INDX).
    1459  	MOVE CARD-L-IN-NAME TO LT-IN-NAME (LT-INDX).
    1460  	MOVE CARD-L-OUT-NAME TO LT-OUT-NAME (LT-INDX).
    1461  
    1462      IF CARD-L-WHEN IS EQUAL TO "A" NEXT SENTENCE; ELSE
    1463  	IF CARD-L-WHEN IS LESS THAN 0 OR GREATER THAN 9
    1464  		MOVE "IMPROPER BREAK NUMBER" TO PL-ERROR;
    1465  		PERFORM ERROR-OUT THRU EO-EXIT;
    1466  	ELSE
    1467  		ADD 1, CARD-L-WHEN-N GIVING INDX;
    1468  		IF BREAKS (INDX) EQUAL TO SPACE
    1469  		MOVE "UNDEFINED BREAK LEVEL" TO PL-ERROR;
    1470  		PERFORM ERROR-OUT THRU EO-EXIT.
    1471  
    1472  	IF CARD-L-IN-NAME IS EQUAL TO SPACES
    1473  		MOVE "NO INPUT NAME" TO PL-ERROR;
    1474  		PERFORM ERROR-OUT THRU EO-EXIT.
    1475  	IF CARD-L-OUT-NAME IS EQUAL TO SPACES
    1476  		MOVE "NO OUTPUT NAME" TO PL-ERROR;
    1477  		PERFORM ERROR-OUT THRU EO-EXIT.
    1478  
    1479          GO TO CYCLE-BACK.
    1480      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 37
    COBRG.CBL    12-JUN-72  00:00

    1481  * 	PROCESS 'E' RECORD
    1482  
    1483    EMIT-CARD SECTION 08.
    1484  
    1485    START.
    1486  	MOVE "  BREAK   INPUT NAME                      OUTPUT NAME" TO HEADER-2.
    1487  	MOVE SPACES TO HEADER-1.
    1488  	PERFORM SUB-HEADING THRU SUB-HEAD-EXIT.
    1489  
    1490    EMIT-CARD-0.
    1491  	ENTER MACRO FORML USING CARD-RECORD, L-CARD.
    1492  	MOVE "E"             TO PL-CODE.
    1493  	MOVE CARD-L-WHEN     TO PL-L-WHEN.
    1494  	MOVE CARD-L-IN-NAME  TO PL-L-IN-NAME.
    1495  	MOVE CARD-L-OUT-NAME TO PL-L-OUT-NAME.
    1496  
    1497  	IF EM-INDX IS EQUAL TO 50
    1498  		MOVE "TOO MANY EMIT CARDS" TO PL-ERROR;
    1499  		PERFORM ERROR-OUT THRU EO-EXIT;
    1500  		GO TO CYCLE-BACK.
    1501  
    1502  	SET EM-INDX UP BY 1.
    1503  
    1504  	MOVE CARD-L-WHEN TO EM-WHEN (EM-INDX).
    1505  	MOVE CARD-L-IN-NAME TO EM-IN-NAME (EM-INDX).
    1506  	MOVE CARD-L-OUT-NAME TO EM-OUT-NAME (EM-INDX).
    1507  
    1508  	IF CARD-L-WHEN = "F" MOVE "F" TO BREAKS (11);
    1509  	ELSE
    1510  	IF CARD-L-WHEN IS LESS THAN "0" OR > "9"
    1511  		MOVE "IMPROPER BREAK NUMBER" TO PL-ERROR;
    1512  		PERFORM ERROR-OUT THRU EO-EXIT;
    1513  	ELSE
    1514  	ADD 1, CARD-L-WHEN-N GIVING INDX;
    1515  	IF BREAKS (INDX) IS EQUAL TO SPACES
    1516  		MOVE "UNDEFINED BREAK NUMBER" TO PL-ERROR;
    1517  		PERFORM ERROR-OUT THRU EO-EXIT.
    1518  
    1519  	IF CARD-L-IN-NAME = SPACES
    1520  		MOVE "NO INPUT NAME" TO PL-ERROR;
    1521  		PERFORM ERROR-OUT THRU EO-EXIT.
    1522  	IF CARD-L-OUT-NAME = SPACES
    1523  		MOVE "NO OUTPUT NAME" TO PL-ERROR;
    1524  		PERFORM ERROR-OUT THRU EO-EXIT.
    1525  
    1526  	GO TO CYCLE-BACK.
    1527      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 38
    COBRG.CBL    12-JUN-72  00:00

    1528  * 	THIS SECTION PROCESSES AN "I" OR "O" RECORD.
    1529  
    1530    DATA-RECORD-CARD SECTION 09.
    1531  
    1532    START.
    1533  	IF CARD-CODE IS EQUAL TO "O" GO TO DRC-A.
    1534  
    1535  	IF HOLD-I-KEY IS NOT EQUAL TO ZERO
    1536  		MOVE "I" TO MT1B-A; MOVE MORE-THAN-1-BATCH TO PL-ERROR;
    1537  		GO TO CYCLE-BACK.
    1538  	MOVE TFO-RECORD-NUMBER TO HOLD-I-KEY; MOVE "I" TO PREV-CARD-CODE
    1539  	GO TO DRC-C.
    1540  
    1541    DRC-A.
    1542  	IF HOLD-P-KEY IS NOT EQUAL TO ZERO
    1543  		MOVE "O" TO MT1B-A; MOVE MORE-THAN-1-BATCH TO PL-ERROR;
    1544  		GO TO CYCLE-BACK.
    1545  	MOVE TFO-RECORD-NUMBER TO HOLD-P-KEY; MOVE "O" TO PREV-CARD-CODE.
    1546  
    1547    DRC-C.
    1548  	ENTER MACRO FORMI USING CARD-RECORD, IO-CARD.
    1549  	MOVE IO-CARD TO TRAN-RECORD-OUT.
    1550  	PERFORM WRITE-TRAN THRU WT-EXIT.
    1551  	READ CARD; AT END MOVE "X" TO EOF-FLAG, CARD-CODE.
    1552  	IF CARD-CODE IS EQUAL TO "1" MOVE "I" TO CARD-CODE; ELSE
    1553  	IF CARD-CODE IS EQUAL TO "0" MOVE "O" TO CARD-CODE.
    1554  	IF CARD-CODE IS EQUAL TO PREV-CARD-CODE GO TO DRC-C.
    1555  
    1556  	MOVE "\" TO TRAN-EOF-OUT.
    1557  	PERFORM WRITE-TRAN THRU WT-EXIT.
    1558  	GO TO READ-NC-0.
    1559  
    1560  
    1561    WRITE-TRAN.
    1562  	IF TFO-RECORD-NUMBER = HI-TRAN-LIMIT GO TO WT-EXIT.
    1563  	IF TFO-RECORD-NUMBER = HI-TRAN-LIMIT - 1 GO TO PANIC-50.
    1564    WRITE-TRAN-1.
    1565  	WRITE TRAN-RECORD-OUT.
    1566  	ADD 1 TO TFO-RECORD-NUMBER.
    1567    WT-EXIT. EXIT.
    1568  
    1569    PANIC-50.
    1570  	MOVE SPACES TO P-L; WRITE P-L BEFORE 2.
    1571  	MOVE "*** TOO MANY RECORD CARDS ***" TO P-L; WRITE P-L.
    1572    P50-LOOP.
    1573  	READ CARD; AT END MOVE "X" TO EOF-FLAG.
    1574  	IF NO-MORE-INPUT OR CARD-CODE EQUALS "N"
    1575  		MOVE "\" TO TRAN-EOF-OUT; GO TO WRITE-TRAN-1;
    1576  	ELSE
    1577  		GO TO P50-LOOP.
    1578      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 39
    COBRG.CBL    12-JUN-72  00:00

    1579  * 	THIS SECTION PUTS OUT THE IDENTIFICATION AND ENVIRONMENT DIVISIONS.
    1580  
    1581    PUT-OUT-ID-ED SECTION 10.
    1582  
    1583    START.
    1584  	MOVE ZEROES TO LINE-NUMBER.
    1585  	MOVE "IDENTIFICATION DIVISION." TO PUNCH-8-72.
    1586  	PERFORM PUNCH-CARD.
    1587  	MOVE PROG-ID-LINE TO PUNCH-8-72.
    1588  	PERFORM PUNCH-CARD.
    1589  	IF AU-NAME IS NOT EQUAL TO SPACES
    1590  		MOVE AUTHOR-LINE TO PUNCH-8-72;
    1591  		PERFORM PUNCH-CARD.
    1592  	IF DWL-DATE IS NOT EQUAL TO SPACES
    1593  		MOVE DATE-WRITTEN-LINE TO PUNCH-8-72;
    1594  		PERFORM PUNCH-CARD.
    1595  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    1596  
    1597  
    1598  * 	PUT OUT ENVIRONMENT DIVISION.
    1599  
    1600  
    1601  	MOVE 1000 TO LINE-NUMBER.
    1602  	MOVE "ENVIRONMENT DIVISION." TO PUNCH-8-72.
    1603  	PERFORM PUNCH-CARD.
    1604  	MOVE "CONFIGURATION SECTION." TO PUNCH-8-72.
    1605  	PERFORM PUNCH-CARD.
    1606  
    1607  * 	SPECIAL-NAMES PARAGRAPH
    1608  
    1609  	MOVE "SPECIAL-NAMES.  " TO PUNCH-8-23.
    1610  	PERFORM PUNCH-CARD.
    1611  	PERFORM CHANNEL-OUT VARYING INDX FROM 3 BY 1
    1612  		UNTIL INDX IS GREATER THAN HIGHEST-CHANNEL.
    1613  	MOVE "CHANNEL (1) IS TOP-OF-FORM." TO PUNCH-12-72.
    1614  	PERFORM PUNCH-CARD.
    1615  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    1616  * 	GET READY FOR 'SELECT' CLAUSES
    1617  
    1618  	MOVE "INPUT-OUTPUT SECTION." TO PUNCH-8-72.
    1619  	PERFORM PUNCH-CARD.
    1620  	MOVE "FILE-CONTROL.   " TO PUNCH-8-23.
    1621  	PERFORM PUNCH-CARD.
    1622      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 40
    COBRG.CBL    12-JUN-72  00:00

    1623  * 	PUNCH OUT "SELECT" CLAUSES.
    1624  
    1625  	MOVE "IN-FILE" TO SEL-NAME.
    1626  	MOVE IN-DEVICE TO SEL-DEVICE.
    1627  	MOVE SELECT-CLAUSE TO PUNCH-12-72.
    1628  	PERFORM PUNCH-CARD.
    1629  	MOVE "L-PRINT" TO SEL-NAME.
    1630  	MOVE OUT-DEVICE TO SEL-DEVICE.
    1631  	MOVE SELECT-CLAUSE TO PUNCH-12-72.
    1632  	PERFORM PUNCH-CARD.
    1633  
    1634  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    1635  
    1636    POIDED-EXIT. EXIT.
    1637  
    1638  
    1639  * 	SUBROUTINE USED TO PUNCH OUT 'CHANNEL (N) IS NAME'
    1640  
    1641    CHANNEL-OUT.
    1642  	MOVE CHAN-ENTRY (INDX) TO HOLD-X.
    1643  	IF HOLD-X IS EQUAL TO SPACE
    1644  		ADD HDR-SK, 01 GIVING INDX-1;
    1645  		IF INDX-1 IS EQUAL TO INDX MOVE HDR-SK TO HOLD-X.
    1646  	IF HOLD-X IS NOT EQUAL TO SPACE
    1647  		MOVE HOLD-X  TO CHL-NUMBER-A, CHL-NUMBER-B;
    1648  		MOVE CHANNEL-LINE TO PUNCH-12-72;
    1649  		PERFORM PUNCH-CARD.
    1650      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 41
    COBRG.CBL    12-JUN-72  00:00

    1651  * 	THIS SECTION PUTS OUT THE DATA DIVISION.
    1652  
    1653    PUT-OUT-DD SECTION 12.
    1654  
    1655    START.
    1656  	MOVE 010000 TO LINE-NUMBER.
    1657  	MOVE "DATA DIVISION.  " TO PUNCH-8-23.
    1658  	PERFORM PUNCH-CARD.
    1659  	MOVE "FILE SECTION.   " TO PUNCH-8-23.
    1660  	PERFORM PUNCH-CARD.
    1661  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    1662  
    1663  	MOVE "FD  IN-FILE" TO PUNCH-8-18.
    1664  	PERFORM PUNCH-CARD.
    1665  
    1666  	IF BLC-VALUE IS NOT EQUAL " 0 "
    1667  		MOVE BLOCK-CONTAINS-LINE TO PUNCH-12-72;
    1668  		PERFORM PUNCH-CARD.
    1669  
    1670  	MOVE IN-VAL-ID TO VIDL-NAME.
    1671  	PERFORM PUT-OUT-LR-DR.
    1672  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    1673  
    1674  	IF HOLD-I-KEY IS NOT EQUAL TO ZERO
    1675  		MOVE HOLD-I-KEY TO TRAN-KEY;
    1676  		PERFORM PUNCH-RECORD-CARDS THRU PRC-EXIT.
    1677  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    1678  
    1679  	MOVE "FD  L-PRINT" TO PUNCH-8-18.
    1680  	PERFORM PUNCH-CARD.
    1681  	MOVE OUT-VAL-ID TO VIDL-NAME; PERFORM PUT-OUT-LR-DR.
    1682  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    1683  	MOVE "01  PRINT-LINE; DISPLAY-7." TO PUNCH-8-72.
    1684  	PERFORM PUNCH-CARD.
    1685      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 42
    COBRG.CBL    12-JUN-72  00:00

    1686  	IF PAGE-SIZE IS EQUAL TO ZERO MOVE PRINTER-SIZE TO TEMP-3N;
    1687  		GO TO PUT-OUT-DD-B.
    1688  
    1689  	SUBTRACT 1 FROM PAGE-LOC GIVING TEMP-3N.
    1690  	PERFORM PUT-OUT-FILLER THRU POF-EXIT.
    1691  
    1692  	IF PAGE-SIZE IS EQUAL TO 1
    1693  		MOVE "9." TO PCL-SIZE;  ELSE
    1694  	IF PAGE-SIZE IS GREATER THAN 4
    1695  		MOVE "Z( )9." TO PCL-SIZE;
    1696  		SUBTRACT 1 FROM PAGE-SIZE GIVING PCLS-1; ELSE
    1697  	SUBTRACT 01 FROM PAGE-SIZE GIVING INDX;
    1698  		MOVE ZZT-X (INDX) TO PCL-SIZE.
    1699  
    1700  	MOVE PAGE-COUNT-LINE TO PUNCH-12-72.
    1701  	PERFORM PUNCH-CARD.
    1702  
    1703  	COMPUTE TEMP-3N = PRINTER-SIZE - (PAGE-LOC - 1 + PAGE-SIZE).
    1704  
    1705    PUT-OUT-DD-B.
    1706  	PERFORM PUT-OUT-FILLER THRU POF-EXIT.
    1707      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 43
    COBRG.CBL    12-JUN-72  00:00

    1708  * 	NOW WE PUNCH OUT THE WORKING-STORAGE SECTION.
    1709  
    1710    PUT-OUT-DD-C.
    1711  	PERFORM PUNCH-TOP-FORM.
    1712  	MOVE 100000 TO LINE-NUMBER.
    1713  
    1714  	MOVE "WORKING-STORAGE SECTION." TO PUNCH-8-72.
    1715  	PERFORM PUNCH-CARD.
    1716  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    1717  
    1718  	IF PAGE-SIZE IS NOT EQUAL TO ZERO
    1719  		MOVE "77  PAGE-COUNT  " TO PUNCH-8-23;
    1720  		MOVE "S9( ); " TO HPC-D; MOVE PAGE-SIZE TO HPC-F;
    1721  		MOVE "PICTURE " TO PUNCH-40-47; MOVE HPC-D TO PUNCH-48-54
    1722  		MOVE "COMPUTATIONAL." TO PUNCH-56-69;
    1723  		PERFORM PUNCH-CARD.
    1724  	MOVE "77  LINE-COUNT  " TO PUNCH-8-23.
    1725  	MOVE "PICTURE S99;    COMPUTATIONAL." TO PUNCH-40-72.
    1726  	PERFORM PUNCH-CARD.
    1727  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    1728  
    1729  	PERFORM PUT-OUT-SAVES THRU POS-EXIT VARYING INDX FROM 01 BY 1
    1730  		UNTIL INDX IS GREATER THAN BF-INDX.
    1731  
    1732    PUT-OUT-DD-D.
    1733  	MOVE 105000 TO LINE-NUMBER.
    1734  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    1735  
    1736  	MOVE "01  OUTPUT-LINE; DISPLAY-7." TO PUNCH-8-72.
    1737  	PERFORM PUNCH-CARD.
    1738  	IF HOLD-P-KEY IS NOT EQUAL TO ZERO
    1739  		MOVE HOLD-P-KEY TO TRAN-KEY;
    1740  		PERFORM PUNCH-RECORD-CARDS THRU PRC-EXIT.
    1741  	PERFORM PUNCH-CARD.
    1742  
    1743  	IF A-CARD-COUNT IS NOT EQUAL TO ZERO
    1744  		PERFORM PUT-OUT-ACS VARYING LEVEL FROM 01 BY 1
    1745  		UNTIL LEVEL IS GREATER THAN 11.
    1746  
    1747  	MOVE 150000 TO LINE-NUMBER.
    1748  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    1749  	IF H-CARD-COUNT IS EQUAL TO ZERO GO TO PUT-OUT-DD-Z.
    1750  	MOVE "01  HEADER." TO PUNCH-8-72.
    1751  	PERFORM PUNCH-CARD.
    1752  	MOVE QUOTE TO HDR-Q-1, HDR-Q-2.
    1753  	MOVE ".   " TO HDR-Q-3.
    1754  	MOVE ZERO TO HDR-Q-SIZE.
    1755  	MOVE PAGE-HDR-1 TO HDR-VALUE; PERFORM PUT-OUT-HEADER.
    1756  	MOVE PAGE-HDR-2 TO HDR-VALUE; PERFORM PUT-OUT-HEADER.
    1757  	MOVE QUOTE TO HDR-Q-4, HDR-Q-5.
    1758  	MOVE "." TO HDR-Q-6.
    1759  	MOVE "3" TO HDR-Q-SIZE.
    1760  	MOVE PAGE-HDR-3 TO HDR-VALUE-1; PERFORM PUT-OUT-HEADER.
    1761  	MOVE PAGE-HDR-4 TO HDR-VALUE-1; PERFORM PUT-OUT-HEADER.
    1762      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 44
    COBRG.CBL    12-JUN-72  00:00

    1763    PUT-OUT-DD-Z.
    1764  	PERFORM PUNCH-TOP-FORM.
    1765  	GO TO PODD-EXIT.
    1766  
    1767    PUT-OUT-LR-DR.
    1768  	IF VIDL-NAME = SPACES
    1769  		MOVE "LABEL RECORDS ARE OMITTED." TO PUNCH-12-37;
    1770  	ELSE
    1771  		MOVE "LABEL RECORDS ARE STANDARD" TO PUNCH-12-37;
    1772  		PERFORM PUNCH-CARD;
    1773  		MOVE VALUE-OF-ID-LINE TO PUNCH-12-72.
    1774  	PERFORM PUNCH-CARD.
    1775  
    1776  
    1777    PUT-OUT-HEADER.
    1778  	MOVE HDR-VALUE-LINE TO PUNCH-12-72.
    1779  	PERFORM PUNCH-CARD.
    1780  
    1781  
    1782  
    1783  * 	PUT OUT '77 SAVE-NN  PICTURE X(N).'
    1784  
    1785    PUT-OUT-SAVES.
    1786  	MOVE BF-SIZE (INDX) TO TEMP-3.
    1787  	IF TEMP-3 IS EQUAL TO SPACES GO TO POS-EXIT.
    1788  	IF TEMP-3 IS LESS THAN "004"
    1789  		MOVE TEMP-2 TO LEVEL; MOVE XXT-X (LEVEL) TO SFA-SIZE;
    1790  	ELSE
    1791  		IF TEMP-3 IS LESS THAN "010"
    1792  		MOVE "X( ).  " TO SFA-SIZE; MOVE TEMP-1 TO SFAS-C;
    1793  	ELSE
    1794  		IF TEMP-3 IS LESS THAN "100"
    1795  		MOVE "X(  ). " TO SFA-SIZE; MOVE TEMP-2 TO SFAS-B;
    1796  	ELSE
    1797  		MOVE "X(   )." TO SFA-SIZE; MOVE TEMP-3 TO SFAS-A.
    1798  
    1799  	MOVE INDX TO SFA-NUM.
    1800  
    1801  	MOVE SAVE-FIELD-AC TO PUNCH-8-72.
    1802  	PERFORM PUNCH-CARD.
    1803  
    1804    POS-EXIT. EXIT.
    1805      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 45
    COBRG.CBL    12-JUN-72  00:00

    1806  * 	PUT OUT '02 FILLER   PICTURE X(N).'
    1807  
    1808    PUT-OUT-FILLER.
    1809  	IF TEMP-3N = ZERO GO TO POF-EXIT.
    1810  
    1811  	IF TEMP-3N < 10
    1812  		MOVE TEMP-1 TO FL-AMT-1A;
    1813  		MOVE ")." TO FL-AMT-1B;
    1814  	ELSE IF TEMP-3N < 100
    1815  		MOVE TEMP-2 TO FL-AMT-2A;
    1816  		MOVE ")." TO FL-AMT-2B;
    1817  	ELSE
    1818  		MOVE TEMP-3 TO FL-AMT-3A;
    1819  		MOVE ")." TO FL-AMT-3B.
    1820  
    1821  	MOVE FILLER-LINE TO PUNCH-12-72.
    1822  	PERFORM PUNCH-CARD.
    1823  
    1824    POF-EXIT.  EXIT.
    1825  
    1826    PUT-OUT-ACS.
    1827  	MOVE BREAKS (LEVEL) TO HOLD-X.
    1828  	IF HOLD-X IS NOT EQUAL TO SPACE
    1829  		PERFORM PUNCH-CARD;
    1830  		MOVE "01  LEVEL- -ACS; COMPUTATIONAL." TO PUNCH-8-72;
    1831  		MOVE HOLD-X TO PUNCH-18;
    1832  		PERFORM PUNCH-CARD;
    1833  		PERFORM POA-1 THRU POA-EXIT VARYING INDX FROM 01 BY 1
    1834  		UNTIL INDX IS GREATER THAN 10.
    1835  
    1836    POA-1.
    1837  	IF AC-SIZE (INDX) IS EQUAL TO ZERO GO TO POA-EXIT.
    1838  
    1839  	MOVE AC-PICTURE (INDX) TO AL-PICTURE.
    1840  	SUBTRACT 1 FROM INDX GIVING AL-AC.
    1841  	MOVE ACCUM-02-LINE TO PUNCH-12-72.
    1842  	PERFORM PUNCH-CARD.
    1843  
    1844    POA-EXIT. EXIT.
    1845  
    1846  
    1847    PODD-EXIT. EXIT.
    1848      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 46
    COBRG.CBL    12-JUN-72  00:00

    1849    PUNCH-RECORD-CARDS.
    1850  	READ TRAN-FILE-IN; INVALID KEY
    1851  		DISPLAY "?BAD TRAN KEY"; STOP RUN.
    1852  	ADD 1 TO TRAN-KEY.
    1853  	IF TRAN-EOF-IN EQUALS "\" GO TO PRC-EXIT.
    1854  	PERFORM JAM-NULLS VARYING INDX FROM 79 BY -1 UNTIL INDX < 1.
    1855  	MOVE TRAN-RECORD-IN TO PUNCH-REC.
    1856  	PERFORM PUNCH-CARD.
    1857  	GO TO PUNCH-RECORD-CARDS.
    1858  
    1859    PRC-EXIT. EXIT.
    1860  
    1861  
    1862    JAM-NULLS.
    1863  	IF TRAN-CHAR (INDX) = SPACE MOVE LOW-VALUE TO TRAN-CHAR (INDX);
    1864  		ELSE MOVE ZERO TO INDX.
    1865      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 47
    COBRG.CBL    12-JUN-72  00:00

    1866  * 	THIS SECTION PUTS OUT THE READ STATEMENT.
    1867  
    1868    PUT-OUT-READ SECTION 14.
    1869  
    1870    START.
    1871  	MOVE 300000 TO LINE-NUMBER.
    1872  	MOVE "PROCEDURE DIVISION." TO PUNCH-8-72.
    1873  	PERFORM PUNCH-CARD.
    1874  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    1875  	MOVE "ONLY SECTION." TO PUNCH-8-72.
    1876  	PERFORM PUNCH-CARD.
    1877  	MOVE "START." TO PUNCH-8-72.
    1878  	PERFORM PUNCH-CARD.
    1879  	MOVE "OPEN INPUT IN-FILE." TO PUNCH-12-72.
    1880  	PERFORM PUNCH-CARD.
    1881  	MOVE "OPEN OUTPUT L-PRINT." TO PUNCH-12-72.
    1882  	PERFORM PUNCH-CARD.
    1883  	MOVE "MOVE SPACES TO OUTPUT-LINE." TO PUNCH-12-72.
    1884  	PERFORM PUNCH-CARD.
    1885  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    1886  
    1887  
    1888  	IF PAGE-SIZE IS NOT EQUAL TO ZERO
    1889  		MOVE "MOVE ZERO TO PAGE-COUNT." TO PUNCH-12-72;
    1890  		PERFORM PUNCH-CARD.
    1891  	MOVE "PERFORM PL-HDR THRU PL-EXIT." TO PUNCH-12-39.
    1892  	PERFORM PUNCH-CARD.
    1893  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    1894  
    1895  	MOVE "READ-IN." TO PUNCH-8-23.
    1896  	PERFORM PUNCH-CARD.
    1897  
    1898  	IF LOW-BREAK IS EQUAL TO SPACE
    1899  		MOVE "READ IN-FILE; AT END GO TO FINISH." TO PUNCH-12-72;
    1900  	ELSE IF HIGH-BREAK IS EQUAL TO "F"
    1901  		MOVE "READ IN-FILE; AT END GO TO LEVEL- -BREAK." TO PUNCH-12-72;
    1902  		MOVE LOW-BREAK TO PUNCH-45;
    1903  	ELSE
    1904  		MOVE "READ IN-FILE; AT END" TO PUNCH-12-72;
    1905  		PERFORM PUNCH-CARD;
    1906  		MOVE "ALTER LEVEL- -SW TO PROCEED TO FINISH;" TO PUNCH-16-72;
    1907  		MOVE HIGH-BREAK TO PUNCH-28;
    1908  		PERFORM PUNCH-CARD;
    1909  		MOVE "GO TO LEVEL- -BREAK." TO PUNCH-16-72;
    1910  		MOVE LOW-BREAK TO PUNCH-28.
    1911  	PERFORM PUNCH-CARD.
    1912  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    1913      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 48
    COBRG.CBL    12-JUN-72  00:00

    1914  	IF LOW-BREAK IS EQUAL TO SPACE GO TO POR-EXIT.
    1915  	MOVE "INIT-SW. GO TO RESET-INIT." TO PUNCH-8-72.
    1916  	PERFORM PUNCH-CARD.
    1917  	MOVE "    NOTE AFTER THE FIRST READ, INIT-SW WILL GO TO COMPARE."
    1918  	  TO PUNCH-12-72; PERFORM PUNCH-CARD.
    1919  	MOVE "RESET-INIT. ALTER INIT-SW TO PROCEED TO COMPARE."
    1920  		TO PUNCH-8-72; PERFORM PUNCH-CARD.
    1921  	MOVE GO-TO-HI TO PUNCH-12-39.
    1922  	PERFORM PUNCH-CARD.
    1923  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    1924  	MOVE "COMPARE." TO PUNCH-8-23.
    1925  	PERFORM PUNCH-CARD.
    1926  
    1927    POR-EXIT. EXIT.
    1928      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 49
    COBRG.CBL    12-JUN-72  00:00

    1929  	NOTE THIS SECTION PUTS OUT THE BREAK TESTING STATEMENTS.
    1930  
    1931    PUT-OUT-BREAK-TESTS SECTION 16.
    1932  
    1933    START.
    1934  	MOVE BREAKS (LEVEL) TO HOLD-X.
    1935  	IF HOLD-X IS EQUAL TO SPACE GO TO POBT-EXIT.
    1936  
    1937  	MOVE "IF " TO IFL-1.
    1938  	PERFORM FIND-ALL-FIELDS VARYING INDX FROM 01 BY 1 UNTIL
    1939  		INDX IS GREATER THAN BF-INDX.
    1940  
    1941  	MOVE NEXT-BREAK (LEVEL) TO HOLD-Y.
    1942  	MOVE "    ALTER LEVEL- -SW TO PROCEED TO RESET-LEVEL- ;"
    1943  		TO PUNCH-12-72.
    1944  	MOVE HOLD-X TO PUNCH-28, PUNCH-59.
    1945  	PERFORM PUNCH-CARD.
    1946  
    1947  	MOVE GO-TO-LINE TO PUNCH-12-39.
    1948  	PERFORM PUNCH-CARD.
    1949  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    1950  
    1951    POBT-EXIT. EXIT.
    1952  
    1953  
    1954  
    1955    FIND-ALL-FIELDS.
    1956  	IF BF-LEVEL (INDX) IS EQUAL TO HOLD-X
    1957  		MOVE BF-NAME (INDX) TO IFL-2;
    1958  		MOVE INDX TO IFL-3;
    1959  		MOVE IF-LINE TO PUNCH-12-72;
    1960  		PERFORM PUNCH-CARD;
    1961  		MOVE "OR " TO IFL-1.
    1962      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 50
    COBRG.CBL    12-JUN-72  00:00

    1963  * 	THIS SECTION PUTS OUT THE DETAIL PRINTING STATEMENTS.
    1964  
    1965    PUT-OUT-DETAIL-PRINT SECTION 18.
    1966  
    1967    START.
    1968  	MOVE "PRINT-DETAIL.   " TO PUNCH-8-23.
    1969  	PERFORM PUNCH-CARD.
    1970  
    1971  	PERFORM PUT-OUT-ALL-LISTS VARYING INDX-1 FROM 01 BY 1
    1972  		UNTIL INDX-1 IS GREATER THAN LT-INDX.
    1973  	PERFORM LIST-ALL-ACS VARYING INDX-1 FROM 01 BY 1
    1974  		UNTIL INDX-1 IS GREATER THAN 10.
    1975  
    1976  	IF THERE-IS-NO-DETAIL GO TO PODP-Z.
    1977  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    1978  	MOVE "MOVE OUTPUT-LINE TO PRINT-LINE." TO PUNCH-12-72.
    1979  	PERFORM PUNCH-CARD.
    1980  	MOVE "PERFORM PRINT-1 THRU PL-EXIT." TO PUNCH-12-72.
    1981  	PERFORM PUNCH-CARD.
    1982  	MOVE "MOVE SPACES TO OUTPUT-LINE." TO PUNCH-12-72.
    1983  	PERFORM PUNCH-CARD.
    1984  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    1985  	GO TO PODP-Z.
    1986  
    1987  
    1988  
    1989    PUT-OUT-ALL-LISTS.
    1990  	IF LT-WHEN (INDX-1) IS EQUAL TO "A"
    1991  		MOVE LT-IN-NAME (INDX-1) TO LAC-IN-NAME;
    1992  		MOVE LT-OUT-NAME (INDX-1) TO SPER-1-25;
    1993  		PERFORM MOVE-PERIOD VARYING INDX FROM 24 BY -1 UNTIL INDX < 1;
    1994  		MOVE SPER-1-25 TO LAC-OUT-NAME;
    1995  		MOVE LIST-AC-LINE TO PUNCH-12-72;
    1996  		PERFORM PUNCH-CARD;
    1997  		MOVE "Y" TO TEST-FOR-DETAIL.
    1998  
    1999  
    2000    LIST-ALL-ACS.
    2001  	MOVE AC-LIST-NAME (INDX-1) TO SPER-1-25.
    2002  	IF SPER-1-25 IS NOT EQUAL TO SPACES
    2003  		PERFORM MOVE-PERIOD VARYING INDX FROM 24 BY -1 UNTIL INDX < 1;
    2004  		MOVE SPER-1-25 TO LAC-OUT-NAME;
    2005  		MOVE AC-IN-NAME (INDX-1) TO LAC-IN-NAME;
    2006  		MOVE LIST-AC-LINE TO PUNCH-12-72;
    2007  		PERFORM PUNCH-CARD;
    2008  		MOVE "Y" TO TEST-FOR-DETAIL.
    2009  
    2010    DETAIL-ADDS.
    2011  	IF AC-SIZE (INDX) IS NOT EQUAL TO ZERO
    2012  		MOVE AC-IN-NAME (INDX) TO AL0-NAME;
    2013  		SUBTRACT 1 FROM INDX GIVING AL0-AC;
    2014  		MOVE ADD-TO-LEVEL-0 TO PUNCH-12-72;
    2015  		PERFORM PUNCH-CARD.
    2016      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 51
    COBRG.CBL    12-JUN-72  00:00

    2017    PODP-Z.
    2018  	IF LOW-BREAK IS EQUAL TO SPACE
    2019  		MOVE BREAKS (11) TO AL0-LOWEST;
    2020  	ELSE
    2021  		MOVE LOW-BREAK TO AL0-LOWEST.
    2022  	IF AL0-LOWEST IS NOT EQUAL TO SPACE
    2023  		PERFORM DETAIL-ADDS VARYING INDX FROM 01 BY 1
    2024  		UNTIL INDX IS GREATER THAN 10.
    2025  
    2026  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    2027  
    2028  	MOVE "GO TO READ-IN." TO PUNCH-12-39.
    2029  	PERFORM PUNCH-CARD.
    2030      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 52
    COBRG.CBL    12-JUN-72  00:00

    2031  * 	THIS SECTION PUTS OUT THE STATEMENTS WHICH PRINT TOTALS
    2032  * 		ON THE BREAK.
    2033  
    2034    PUT-OUT-BREAK-PRINTS SECTION 20.
    2035  
    2036    START.
    2037  	MOVE BREAKS (LEVEL) TO HOLD-X.
    2038  	IF HOLD-X IS EQUAL TO SPACE GO TO POBP-EXIT.
    2039  
    2040  	MOVE "LEVEL- -BREAK.  " TO PUNCH-8-23.
    2041  	MOVE HOLD-X TO PUNCH-14.
    2042  	PERFORM PUNCH-CARD.
    2043  
    2044  	IF LEVEL EQUALS 11 AND ST-ENTRY (11) EQUALS SPACES
    2045  		MOVE "1001" TO ST-ENTRY (11).
    2046  
    2047  	IF ST-SKIP-B (LEVEL) IS EQUAL TO ZERO GO TO POBP-A.
    2048  	MOVE "MOVE SPACES TO PRINT-LINE." TO PUNCH-12-39.
    2049  	PERFORM PUNCH-CARD.
    2050  	MOVE "PERFORM PRINT-CH-  THRU PL-EXIT." TO PUNCH-12-72.
    2051  	MOVE ST-SKIP-B (LEVEL) TO PUNCH-29.
    2052  	PERFORM PUNCH-CARD.
    2053  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    2054  	GO TO POBP-B.
    2055  
    2056    POBP-A.
    2057  	IF ST-SPACE-B (LEVEL) IS EQUAL TO ZERO GO TO POBP-B.
    2058  	MOVE "MOVE SPACES TO PRINT-LINE." TO PUNCH-12-39.
    2059  	PERFORM PUNCH-CARD.
    2060  
    2061  	MOVE "PERFORM PRINT-  THRU PL-EXIT." TO PUNCH-12-72.
    2062  	MOVE ST-SPACE-B (LEVEL) TO PUNCH-26.
    2063  	PERFORM PUNCH-CARD.
    2064  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    2065  
    2066    POBP-B.
    2067  	ALTER POBP-C TO PROCEED TO POBP-H.
    2068  	IF A-CARD-COUNT IS NOT EQUAL TO ZERO
    2069  		PERFORM POBP-MOVE VARYING INDX-1 FROM 01 BY 1
    2070  		UNTIL INDX-1 IS GREATER THAN 10.
    2071  
    2072  	PERFORM POBP-EMIT VARYING INDX-1 FROM 1 BY 1
    2073  		UNTIL INDX-1 IS GREATER THAN EM-INDX.
    2074  
    2075  	IF HR-WHEN (LEVEL) IS NOT EQUAL TO SPACE
    2076  		AND PAGE-SIZE IS NOT EQUAL TO ZERO
    2077  		MOVE "MOVE ZERO TO PAGE-COUNT." TO PUNCH-12-39;
    2078  		PERFORM PUNCH-CARD.
    2079      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 53
    COBRG.CBL    12-JUN-72  00:00

    2080    POBP-C. GO TO POBP-D. NOTE IF NO TOTALS ARE PRINTED AT THIS
    2081  		BREAK, THIS WILL GO TO POBP-H.
    2082  
    2083    POBP-D.
    2084  	MOVE "MOVE OUTPUT-LINE TO PRINT-LINE." TO PUNCH-12-72.
    2085  	PERFORM PUNCH-CARD.
    2086  	IF ST-SKIP-A (LEVEL) IS NOT EQUAL TO ZERO
    2087  		MOVE "PERFORM PRINT-CH-  THRU PL-EXIT." TO PUNCH-12-72;
    2088  		MOVE ST-SKIP-A (LEVEL) TO PUNCH-29;
    2089  		GO TO POBP-E.
    2090  
    2091  	MOVE "PERFORM PRINT-  THRU PL-EXIT." TO PUNCH-12-72.
    2092  	MOVE ST-SPACE-A (LEVEL) TO TEMP-1; MOVE TEMP-1 TO PUNCH-26.
    2093  
    2094    POBP-E.
    2095  	PERFORM PUNCH-CARD.
    2096  	MOVE "MOVE SPACES TO OUTPUT-LINE." TO PUNCH-12-72.
    2097  	PERFORM PUNCH-CARD.
    2098  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    2099      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 54
    COBRG.CBL    12-JUN-72  00:00

    2100    POBP-H.
    2101  	MOVE BREAKS (LEVEL) TO HOLD-X.
    2102  
    2103  	IF LEVEL IS EQUAL TO 11 NEXT SENTENCE; ELSE
    2104  
    2105  	MOVE NEXT-BREAK (LEVEL) TO AN-LEVEL-B;
    2106  	IF AN-LEVEL-B IS NOT EQUAL TO SPACE AND
    2107  		A-CARD-COUNT IS NOT EQUAL TO ZERO
    2108  		MOVE HOLD-X TO AN-LEVEL-A;
    2109  		MOVE ADD-TO-NEXT-LINE TO PUNCH-12-72;
    2110  		PERFORM PUNCH-CARD;
    2111  		PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    2112  
    2113  	IF HOLD-X = "F"
    2114  		MOVE "GO TO FINISH." TO PUNCH-12-24;
    2115  	ELSE
    2116  	IF NEXT-BREAK (LEVEL) = SPACE
    2117  		MOVE "LEVEL- -SW. GO TO. NOTE GO TO RESET-LEVEL-  OR FINISH."
    2118  			TO PUNCH-8-72;
    2119  		MOVE HOLD-X TO PUNCH-14, PUNCH-50;
    2120  	ELSE
    2121  		MOVE "LEVEL- -SW. GO TO. NOTE GO TO RESET-LEVEL-  OR
    2122  - 			" LEVEL- -BREAK." TO PUNCH-8-72;
    2123  		MOVE HOLD-X TO PUNCH-14, PUNCH-50;
    2124  		MOVE NEXT-BREAK (LEVEL) TO PUNCH-61.
    2125  
    2126    POBP-I.
    2127  	PERFORM PUNCH-CARD.
    2128  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    2129  
    2130  
    2131    POBP-EXIT. EXIT.
    2132      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 55
    COBRG.CBL    12-JUN-72  00:00

    2133    POBP-MOVE.
    2134  	IF BTTPF (INDX-1, LEVEL) IS NOT EQUAL TO SPACE
    2135  		ALTER POBP-C TO PROCEED TO POBP-D;
    2136  		MOVE HOLD-X TO ACTL-1;
    2137  		MOVE BTTP-NAME (INDX-1) TO SPER-1-25;
    2138  		PERFORM MOVE-PERIOD VARYING INDX FROM 24 BY -1 UNTIL INDX < 1;
    2139  		MOVE SPER-1-25 TO ACTL-3;
    2140  		SUBTRACT 1 FROM INDX-1 GIVING ACTL-2;
    2141  		MOVE AC-TOTAL-LINE TO PUNCH-12-72;
    2142  		PERFORM PUNCH-CARD.
    2143  
    2144  
    2145    POBP-ADD.
    2146  	IF AC-SIZE (INDX) IS NOT EQUAL TO ZERO
    2147  		SUBTRACT 1 FROM INDX GIVING AN-LEVEL-A;
    2148  		MOVE INDX TO AN-LEVEL-B;
    2149  		MOVE ADD-TO-NEXT-LINE TO PUNCH-12-72;
    2150  		PERFORM PUNCH-CARD.
    2151  
    2152    POBP-EMIT.
    2153  	MOVE EM-WHEN (INDX-1) TO HOLD-X.
    2154  	IF LEVEL = 11 AND HOLD-X = "F" OR HOLD-N = LEVEL - 1
    2155  		ALTER POBP-C TO PROCEED TO POBP-D;
    2156  		MOVE "MOVE " TO PUNCH-12-16;
    2157  		MOVE EM-IN-NAME (INDX-1) TO PUNCH-17-40;
    2158  		MOVE " TO " TO PUNCH-41-44;
    2159  		MOVE EM-OUT-NAME (INDX-1) TO SPER-1-25;
    2160  		PERFORM MOVE-PERIOD VARYING INDX FROM 24 BY -1 UNTIL INDX < 1;
    2161  		MOVE SPER-1-25 TO PUNCH-45-69;
    2162  		PERFORM PUNCH-CARD.
    2163      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 56
    COBRG.CBL    12-JUN-72  00:00

    2164  * 	THIS SECTION PUTS OUT THE STATEMENTS WHICH RESET THE BREAK.
    2165  
    2166    PUT-OUT-RESETS SECTION 22.
    2167  
    2168    START.
    2169  	MOVE BREAKS (LEVEL) TO HOLD-X.
    2170  	IF HOLD-X IS EQUAL TO SPACE GO TO PORES-EXIT.
    2171  
    2172  	MOVE "RESET-LEVEL- .  " TO PUNCH-8-23.
    2173  	MOVE HOLD-X TO PUNCH-20.
    2174  	PERFORM PUNCH-CARD.
    2175  
    2176  	IF A-CARD-COUNT IS NOT EQUAL TO ZERO
    2177  		MOVE "MOVE LOW-VALUES TO LEVEL- -ACS." TO PUNCH-12-72;
    2178  		MOVE HOLD-X TO PUNCH-37;
    2179  		PERFORM PUNCH-CARD.
    2180  
    2181  	PERFORM PORES-SAVE VARYING INDX FROM 01 BY 1
    2182  		UNTIL INDX IS GREATER THAN BF-INDX.
    2183  
    2184  	PERFORM PORES-SETUP VARYING INDX-1 FROM 01 BY 1
    2185  		UNTIL INDX-1 IS GREATER THAN LT-INDX.
    2186  
    2187  	IF LEVEL = 11 GO TO PORES-1.
    2188  
    2189  	MOVE NEXT-BREAK (LEVEL) TO HOLD-Y.
    2190  	IF HOLD-Y IS EQUAL TO SPACE  NEXT SENTENCE; ELSE
    2191  		MOVE "ALTER LEVEL- -SW TO PROCEED TO LEVEL- -BREAK."
    2192  		TO PUNCH-12-72;
    2193  		MOVE HOLD-X TO PUNCH-24; MOVE HOLD-Y TO PUNCH-49;
    2194  		PERFORM PUNCH-CARD.
    2195  
    2196    PORES-1.
    2197  	IF HOLD-X IS EQUAL TO LOW-BREAK
    2198  		MOVE "GO TO PRINT-DETAIL." TO PUNCH-12-72;
    2199  		PERFORM PUNCH-CARD.
    2200  
    2201  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    2202  
    2203    PORES-EXIT. EXIT.
    2204  
    2205  
    2206    PORES-SAVE.
    2207  	IF BF-LEVEL (INDX) IS EQUAL TO HOLD-X
    2208  		MOVE BF-NAME (INDX) TO SF-NAME;
    2209  		MOVE INDX TO SF-NUMBER;
    2210  		MOVE SAVE-FIELD-LINE TO PUNCH-12-72;
    2211  		PERFORM PUNCH-CARD.
    2212  
    2213  
    2214    PORES-SETUP.
    2215  	IF LT-WHEN (INDX-1) IS EQUAL TO HOLD-X
    2216  		MOVE LT-IN-NAME (INDX-1) TO LAC-IN-NAME;
    2217  		MOVE LT-OUT-NAME (INDX-1) TO SPER-1-25;
    2218  		PERFORM MOVE-PERIOD VARYING INDX FROM 25 BY -1 UNTIL INDX < 1;
    2219  		MOVE SPER-1-25 TO LAC-OUT-NAME;    P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 56-1
    COBRG.CBL    12-JUN-72  00:00

    2220  		MOVE LIST-AC-LINE TO PUNCH-12-72;
    2221  		PERFORM PUNCH-CARD.
    2222      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 57
    COBRG.CBL    12-JUN-72  00:00

    2223  * 	THIS SECTION PUTS OUT THE FINALIZATION STATEMENTS.
    2224  
    2225    PUT-OUT-FINISH SECTION 24.
    2226  
    2227    START.
    2228  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD 2 TIMES.
    2229  	MOVE "FINISH." TO PUNCH-8-72.
    2230  	PERFORM PUNCH-CARD.
    2231  	MOVE "CLOSE IN-FILE." TO PUNCH-12-39.
    2232  	PERFORM PUNCH-CARD.
    2233  	MOVE "CLOSE L-PRINT." TO PUNCH-12-39.
    2234  	PERFORM PUNCH-CARD.
    2235  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    2236  
    2237  	MOVE "STOP RUN." TO PUNCH-12-20.
    2238  	PERFORM PUNCH-CARD.
    2239      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 58
    COBRG.CBL    12-JUN-72  00:00

    2240  * 	THIS SECTION PUTS OUT THE PRINTING SUBROUTINES.
    2241  
    2242    PUT-OUT-SUBROUTINES SECTION 26.
    2243  
    2244    START.
    2245  	PERFORM PUT-OUT-CHANS VARYING INDX FROM 3 BY 1 UNTIL
    2246  		INDX IS GREATER THAN HIGHEST-CHANNEL + 1.
    2247  
    2248  	MOVE 1 TO SPACE-ENTRY (2).
    2249  	PERFORM PUT-OUT-SPACES THRU POSPACE-EXIT VARYING INDX FROM 2 BY 1 UNTIL
    2250  		INDX IS GREATER THAN HIGHEST-SPACE + 1.
    2251  
    2252  	MOVE "PL-HDR. MOVE SPACES TO PRINT-LINE." TO PUNCH-8-72.
    2253  	PERFORM PUNCH-CARD.
    2254  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    2255  
    2256  	MOVE "PRINT-CH-1. WRITE PRINT-LINE BEFORE TOP-OF-FORM."
    2257  		TO PUNCH-8-72; PERFORM PUNCH-CARD.
    2258  
    2259  	IF H-CARD-COUNT IS EQUAL TO ZERO GO TO POSUB-Z.
    2260  	MOVE "MOVE HEADER TO PRINT-LINE." TO PUNCH-12-39.
    2261  	PERFORM PUNCH-CARD.
    2262  	IF PAGE-SIZE IS NOT EQUAL TO ZERO
    2263  		MOVE "ADD 1 TO PAGE-COUNT; MOVE PAGE-COUNT TO HEADER-PAGE."
    2264  	  TO PUNCH-12-72; PERFORM PUNCH-CARD.
    2265  
    2266  	IF HDR-SP = 1 MOVE "WRITE PRINT-LINE." TO PUNCH-12-28;
    2267  	ELSE
    2268  		MOVE "WRITE PRINT-LINE BEFORE ADVANCING" TO PUNCH-12-44;
    2269  		IF HDR-SK IS NOT EQUAL TO ZERO
    2270  		MOVE "CHANNEL- ." TO PUNCH-46-55;
    2271  		MOVE HDR-SK TO PUNCH-54;
    2272  	ELSE
    2273  		MOVE "  LINES.  "  TO PUNCH-46-55;
    2274  		MOVE HDR-SP TO PUNCH-46.
    2275  
    2276  	PERFORM PUNCH-CARD.
    2277  	SUBTRACT HDR-SP FROM 56 GIVING SLC-AMOUNT.
    2278  	MOVE SET-LINE-COUNT TO PUNCH-12-72.
    2279  	PERFORM PUNCH-CARD.
    2280  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    2281  	GO TO POSUB-Z.
    2282      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE 59
    COBRG.CBL    12-JUN-72  00:00

    2283    PUT-OUT-CHANS.
    2284  	MOVE CHAN-ENTRY (INDX) TO HOLD-X.
    2285  	IF HOLD-X IS NOT EQUAL TO SPACE
    2286  		MOVE "PRINT-CH- . WRITE PRINT-LINE BEFORE ADVANCING CHANNEL- ."
    2287  		TO PUNCH-8-72;
    2288  		MOVE HOLD-X TO PUNCH-17, PUNCH-62;
    2289  		PERFORM PUNCH-CARD;
    2290  		MOVE "IF LINE-COUNT IS POSITIVE GO TO PL-EXIT; ELSE GO TO PL-HDR."
    2291  		TO PUNCH-12-72;
    2292  		PERFORM PUNCH-CARD;
    2293  		PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    2294  
    2295  
    2296    PUT-OUT-SPACES.
    2297  	MOVE SPACE-ENTRY (INDX) TO HOLD-X.
    2298  	IF HOLD-X IS EQUAL TO SPACE GO TO POSPACE-EXIT.
    2299  
    2300  	IF HOLD-X IS EQUAL TO 1
    2301  		MOVE "PRINT-1. WRITE PRINT-LINE." TO PUNCH-8-72;
    2302  	ELSE
    2303  		MOVE "PRINT- . WRITE PRINT-LINE BEFORE   LINES;" TO
    2304  		PUNCH-8-72;
    2305  		MOVE HOLD-X TO PUNCH-14, PUNCH-41.
    2306  	PERFORM PUNCH-CARD.
    2307  
    2308  	MOVE "SUBTRACT   FROM LINE-COUNT." TO PUNCH-12-72.
    2309  	MOVE HOLD-X TO PUNCH-21.
    2310  	PERFORM PUNCH-CARD.
    2311  
    2312  	MOVE "IF LINE-COUNT IS POSITIVE GO TO PL-EXIT; ELSE GO TO PL-HDR."
    2313  		TO PUNCH-12-72.
    2314  	PERFORM PUNCH-CARD.
    2315  	PERFORM PUNCH-BLANK-CARD THRU PUNCH-CARD.
    2316  
    2317    POSPACE-EXIT.  EXIT.
    2318  
    2319  
    2320    POSUB-Z.
    2321  	MOVE "PL-EXIT.  EXIT. " TO PUNCH-8-23.
    2322  	PERFORM PUNCH-CARD.
    2323      P R O G R A M   C O B R G 		COBOL (005001,107000)	31-MAY-73  11:15		PAGE W-1
    COBRG.CBL    12-JUN-72  00:00

WARNINGS:

    0317  REDEFINITION IS NOT THE SAME SIZE AS THE REDEFINED ITEM
    0326  REDEFINITION IS NOT THE SAME SIZE AS THE REDEFINED ITEM
    0337  REDEFINITION IS NOT THE SAME SIZE AS THE REDEFINED ITEM
    0343  REDEFINITION IS NOT THE SAME SIZE AS THE REDEFINED ITEM
    0348  REDEFINITION IS NOT THE SAME SIZE AS THE REDEFINED ITEM
    0353  REDEFINITION IS NOT THE SAME SIZE AS THE REDEFINED ITEM
    0355  REDEFINITION IS NOT THE SAME SIZE AS THE REDEFINED ITEM
    0358  REDEFINITION IS NOT THE SAME SIZE AS THE REDEFINED ITEM
    0362  REDEFINITION IS NOT THE SAME SIZE AS THE REDEFINED ITEM
    0952  MOST SIGNIFICANT DIGITS TRUNCATED ON BLC-VALUE
    1043  MOST SIGNIFICANT DIGITS TRUNCATED ON HPC-C
    1051  MOST SIGNIFICANT DIGITS TRUNCATED ON HPC-F
    1062  MOST SIGNIFICANT DIGITS TRUNCATED ON HPC-F
    1538  MOST SIGNIFICANT DIGITS TRUNCATED ON HOLD-I-KEY
    1545  MOST SIGNIFICANT DIGITS TRUNCATED ON HOLD-P-KEY
    1840  MOST SIGNIFICANT DIGITS TRUNCATED ON AL-AC
    2013  MOST SIGNIFICANT DIGITS TRUNCATED ON AL0-AC
    2140  MOST SIGNIFICANT DIGITS TRUNCATED ON ACTL-2
    2141  RIGHT-MOST TRUNCATION ON PUNCH-12-72
    2147  MOST SIGNIFICANT DIGITS TRUNCATED ON AN-LEVEL-A
    2148  MOST SIGNIFICANT DIGITS TRUNCATED ON AN-LEVEL-B


NO FATAL ERRORS, 21 WARNINGS
5 2J