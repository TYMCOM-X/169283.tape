100:                                         'CCCCCCCCCCCCCCCCCCCCCCCCCCCCC
110 MARGIN 132
120:#####  'LLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLL  ########  ########  ######## 'RRRRRR   ########  ########  ######## 'RRRRRR
130:       'LLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLL  ########  ########  ######## 'RRRRRR   ########  ########  ######## 'RRRRRR
140: EXPENSES                                          'CCCCCCCCCCCCCCCCCC                       YEAR-TO-DATE
150: NO.               TITLE                     ACTUAL    BUDGET   VARIANCE   %        ACTUAL    BUDGET   VARIANCE   %
160:                                            --------  --------  --------           --------  --------  --------
170:---------------------------------------------------------------------------------------------------------------------
180:                                            ========  ========  ========            ========  ========  ========
190 FILES MTITLE,YTD, ,BUDGET
200 DIM T$(36),H$(11),M$(12),S$(16),L(36),Q(36),A(36,16),C(36,16)
210 DIM B(36,16),D(36,16),E(36,16),F(13),N(3),G(11,16),K(11,16)
220 DIM P(9),S(11,16),U(11,16)
230 PRINT "NAME OF MONTHLY TRANSACTION FILE";
240 INPUT F$
250 FILE #3,F$
260 MAT READ#1,T$,H$
270 PRINT "NUMBER OF MONTH (JAN=1, FEB=2)";
280 INPUT M
290 DATA JANUARY,FEBRUARY,MARCH,APRIL,MAY,JUNE,JULY,AUGUST,SEPTEMBER,OCTOBER,NOVEMBER,DECEMBER
300 MAT READ M$
310 MAT READ S$
320 DATA "RC 1762","RC 1801","R 1802","RC 1803","RC 1804"," RC 1805",
330 DATA "RC 1806","RC 1807","RC 1808","RC 1832","RC 1833","RC 1834","RC 1835"
340 DATA "RC 1836","RC 1838","SUMMARY"
350 FOR I=1 TO 36
360 READ #2,Q(I),E(I,1),E(I,2),E(I,3),E(I,4),E(I,5),E(I,6),E(I,7),E(I,8),E(I,9),E(I,10),E(I,11),E(I,12),E(I,13)
361 READ #2,E(I,14),E(I,15)
370 READ #3,L(I),A(I,1),A(I,2),A(I,3),A(I,4),A(I,5),A(I,6),A(I,7),A(I,8),A(I,9),A(I,10),A(I,11),A(I,12),A(I,13)
371 READ #3,A(I,14),A(I,15)
380 IF L(I)=Q(I) THEN 420
390 PRINT "INCORRECT ACCOUNT NUMBER OR ACCOUNT NUMBER ";L(I)
400 PRINT"IS OUT OF SEQUENCE.  CHECK MONTHLY TRANSACTION FILE."
410 GO TO 2630
420 PRINT L(I);
430 FOR H= 1 TO 15
440 C(I,H)=A(I,H)+E(I,H)
450 NEXT H
460 NEXT I
470 PRINT
480 PRINT "DO YOU WISH TO UPDATE THE YEAR TO DATE FILE (YES OR NO)";
490 INPUT A9$
500 IF A9$<>"YES" THEN 590
510 SCRATCH #2
520 FOR I=1 TO 36
530 WRITE #2,L(I);C(I,1);C(I,2);C(I,3);C(I,4);C(I,5);C(I,6);C(I,7);C(I,8);C(I,9);C(I,10);C(I,11);C(I,12);C(I,13);C(I,14);C(I,15)
540 NEXT I
550 PRINT "UPDATED YTD FILE WRITTEN."
560 PRINT"DO YOU WISH TO PRODUCE REPORTS";
570 INPUTA1$
580 IF A1$="NO" THEN 2630
590 FOR H=1 TO 15
600 FOR I=1 TO 36
610 MAT READ #4,F
620 FOR J=2 TO 13
630 D(I,H)=D(I,H)+F(J)
640 IF J=M+1 THEN 660
650 NEXT J
660 B(I,H)=F(J)
670 NEXT I
680 NEXT H
690 MAT READ N
700 FOR R=1 TO 16
710 X=1
720 N1=1
730 T=1
740 DATA 7,17,28
750 FOR I=X TO N(N1)
760 G(T,R)=G(T,R)+A(I,R)
770 K(T,R)=K(T,R)+B(I,R)
780 S(T,R)=S(T,R)+C(I,R)
790 U(T,R)=U(T,R)+D(I,R)
800 IF R=16 THEN 850
810 A(I,16)=A(I,16)+A(I,R)
820 B(I,16)=B(I,16)+B(I,R)
830 C(I,16)=C(I,16)+C(I,R)
840 D(I,16)=D(I,16)+D(I,R)
850 NEXT I
860 IF T<>1 THEN 980
870 G(2,R)=G(1,R)+A(8,R)
880 K(2,R)=K(1,R)+B(8,R)
890 S(2,R)=S(1,R)+C(8,R)
900 U(2,R)=U(1,R)+D(8,R)
910 IF R=16 THEN 960
920 A(8,16)=A(8,16)+A(8,R)
930 B(8,16)=B(8,16)+B(8,R)
940 C(8,16)=C(8,16)+C(8,R)
950 D(8,16)=D(8,16)+D(8,R)
960 X=N(N1)+2
970 GO TO 1040
980 IF T<>3 THEN 1070
990 G(4,R)=G(2,R)+G(3,R)
1000 K(4,R)=K(2,R)+K(3,R)
1010 S(4,R)=S(2,R)+S(3,R)
1020 U(4,R)=U(2,R)+U(3,R)
1030 X=N(N1)+1
1040 T=T+2
1050 N1=N1+1
1060 GO TO 750
1070 IF R=16 THEN 1140
1080 FOR I=29 TO 36
1090 A(I,16)=A(I,16)+A(I,R)
1100 B(I,16)=B(I,16)+B(I,R)
1110 C(I,16)=C(I,16)+C(I,R)
1120 D(I,16)=D(I,16)+D(I,R)
1130 NEXT I
1140 G(6,R)=G(5,R)+G(4,R)+A(29,R)
1150 K(6,R)=K(5,R)+K(4,R)+B(29,R)
1160 S(6,R)=S(5,R)+S(4,R)+C(29,R)
1170 U(6,R)=U(5,R)+U(4,R)+D(29,R)
1180 G(7,R)=A(31,R)+A(32,R)
1190 K(7,R)=B(31,R)+B(32,R)
1200 S(7,R)=C(31,R)+C(32,R)
1210 U(7,R)=D(31,R)+D(32,R)
1220 G(8,R)=A(36,R)-G(6,R)-A(30,R)-G(7,R)-A(29,R)
1230 K(8,R)=B(36,R)-K(6,R)-B(30,R)-K(7,R)-B(29,R)
1240 S(8,R)=C(36,R)-S(6,R)-C(30,R)-S(7,R)-C(29,R)
1250 U(8,R)=D(36,R)-D(30,R)-D(29,R)
1251 U(8,R)=U(8,R)-U(7,R)-U(6,R)
1260 G(9,R)=G(8,R)-A(33,R)-A(34,R)
1270 K(9,R)=K(8,R)-B(33,R)-B(34,R)
1280 S(9,R)=S(8,R)-C(33,R)-C(34,R)
1290 U(9,R)=U(8,R)-D(33,R)-D(34,R)
1300 G(10,R)=G(6,R)+A(30,R)+G(7,R)+A(33,R)+A(35,R)+A(34,R)
1310 K(10,R)=K(6,R)+B(30,R)+K(7,R)+B(33,R)+B(35,R)+B(34,R)
1320 S(10,R)=S(6,R)+C(30,R)+S(7,R)+C(33,R)+C(35,R)+C(34,R)
1330 U(10,R)=U(6,R)+D(30,R)+U(7,R)+D(33,R)+D(35,R)+D(34,R)
1340 G(11,R)=A(36,R)-G(10,R)
1350 K(11,R)=B(36,R)-K(10,R)
1360 S(11,R)=C(36,R)-S(10,R)
1370 U(11,R)=D(36,R)-U(10,R)
1380 NEXT R
1390 PRINT
1400 PRINT"CALCULATIONS COMPLETED."
1410 PRINT
1420 PRINT"ENTER THE BEGINNING AND ENDING REPORT NUMBERS SEPARATED BY A COMMA (I.E. 1,16)";
1430 INPUT W8,W9
1440 PRINT
1450 PRINT"TYPE ANY CHARACTER, POSITION TO THE TOP OF A NEW PAGE,"
1460 PRINT"AND HIT THE CARRIAGE RETURN"
1470 INPUT Q$
1480 DATA 7,8,17,28,29,32,34,35,36
1490 MAT READ P
1495 PRINT <PA>
1500 Y$="MASTER CHARGE BUDGET"
1510 FOR H=W8 TO W9
1520 Z$=M$(M)+" 1973  "+S$(H)
1530 PRINT H
1540 PRINT 
1550 PRINT
1560 PRINT
1570 PRINT
1580 PRINT  USING 100,Y$
1590 PRINT 
1600 PRINT  USING 100,Z$
1610 PRINT 
1620 PRINT
1630 PRINT
1640 PRINT  USING 140,M$(M)
1650 PRINT  USING 150,
1660 PRINT   USING 170,
1670 Y=1
1680 P1=1
1690 W=0
1700 FOR T=1 TO 10
1710 FOR I=Y TO P(P1)
1720 IF I<>30 THEN 1750
1730 IFS$(H)="RC 1801" THEN 1750
1740 IF S$(H)<>"SUMMARY" THEN 2560
1750 V=0
1760 Z=0
1770 IF D(I,H)=O THEN 1800
1780 V$=STR$(INT((-C(I,H)+D(I,H))/D(I,H)*1000+.5)/10)
1790 GO TO 1810
1800 V$="(0)"
1810 IF B(I,H)=0 THEN 1840
1820 Z$=STR$(INT((-A(I,H)+B(I,H))/B(I,H)*1000+.5)/10)
1830 GO TO 1850
1840 Z$="(0)"
1850 PRINT  USING 120,L(I),T$(I),A(I,H),B(I,H),-A(I,H)+B(I,H),Z$,C(I,H),D(I,H),-C(I,H)+D(I,H),V$
1860 NEXT I
1870 Z=0
1880 V=0
1890 IF K(T,H)=0 THEN 1920
1900 Z$=STR$(INT((-G(T,H)+K(T,H))/K(T,H)*1000+.5)/10)
1910 GO TO 1930
1920 Z$="(0)"
1930 IF U(T,H)=0 THEN 1960
1940 V$=STR$(INT((-S(T,H)+U(T,H))/U(T,H)*1000+.5)/10)
1950 GO TO 1970
1960 V$="(0)"
1970 IF T<>10 THEN 1990
1980 PRINT  USING 180,
1990 IF T>=8 THEN 2010
2000 PRINT  USING  160,
2010 IF T=8 THEN 2050
2020 IF T=9 THEN 2050
2030 PRINT  USING 130,H$(T),G(T,H),K(T,H),-G(T,H)+K(T,H),Z$,S(T,H),U(T,H),-S(T,H)+U(T,H),V$
2040 GO TO 2060
2050 PRINT USING 130,H$(T),G(T,H),K(T,H),G(T,H)-K(T,H),Z$,S(T,H),U(T,H),S(T,H)-U(T,H),V$
2060 IF T<>3+W THEN 2110
2070 IF T<>7 THEN 2080
2080 T=T+1
2090 W=4
2100 GO TO 1870
2110 Y=P(P1)+1
2120 P1=P1+1
2130 IF T<>6 THEN 2330
2140 IF S$(H)="RC 1801" THEN 2160
2150IF S$(H)<>"SUMMARY" THEN 2330
2160 PRINT
2168 PRINT
2169 PRINT
2170 PRINT
2180 PRINT
2190 PRINT H
2200 PRINT
2210 PRINT
2220 PRINT
2230 PRINT
2240 PRINT USING 100,Y$
2250 PRINT
2260 PRINT USING 100,Z$
2270 PRINT
2280 PRINT
2290 PRINT
2300 PRINT USING 140,M$(M)
2310 PRINT USING 150,
2320 PRINT USING 170,
2330 NEXT T
2340 T=11
2350 I=36
2360 IF D(I,H)=0 THEN 2390
2370 V$=STR$(INT((-C(I,H)+D(I,H))/D(I,H)*1000+.5)/10)
2380 GO TO 2400
2390 V$="(0)"
2400 IF B(I,H)=0 THEN 2430
2410 Z$=STR$(INT((-A(I,H)+B(I,H))/B(I,H)*1000+.5)/10)
2420 GO TO 2440
2430 Z$="(0)"
2440 PRINT  USING 120,L(I),T$(I),A(I,H),B(I,H),-A(I,H)+B(I,H),Z$,C(I,H),D(I,H),-C(I,H)+D(I,H),V$
2450 PRINT  USING 180,
2460 IF K(T,H)=0 THEN 2490
2470 Z$=STR$(INT((-G(T,H)+K(T,H))/K(T,H)*1000+.5)/10)
2480 GO TO 2500
2490 Z$="(0)"
2500 IF U(T,H)=0 THEN 2530
2510 V$=STR$(INT((-S(T,H)+U(T,H))/U(T,H)*1000+.5)/10)
2520 GO TO 2540
2530 V$="(0)"
2540 PRINT  USING 130,H$(T),G(T,H),K(T,H),-G(T,H)+K(T,H),Z$,S(T,H),U(T,H),-S(T,H)+U(T,H),V$
2550 PRINT   USING 180,
2551 FOR C3=1 TO 30
2552 PRINT
2553 NEXT C3
2555 GO TO 2590
2560 FOR C2= 1 TO 5
2570 PRINT
2580 NEXT C2
2590 NEXT H
2600 PRINT
2610 PRINT
2620 PRINT"REPORTS COMPLETED."
2630END
