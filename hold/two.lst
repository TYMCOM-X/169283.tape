    P R O G R A M   T W O 		COBOL (005001,107000)	23-MAY-73  12:22		PAGE 1
    TWO.CBL    01-MAY-73  18:17

    0001    IDENTIFICATION DIVISION.
    0002    PROGRAM-ID. TWO.
    0003    AUTHOR. K. PETZOLD.
    0004    INSTALLATION. DALLAS DISTRICT.
    0005    DATE-WRITTEN. 25 APRIL, 1973.
    0006    DATE-COMPILED. 23-MAY-73. 
    0007    REMARKS. ASSIGNMENT NUMBER TWO.
    0008    ENVIRONMENT DIVISION.
    0009    CONFIGURATION SECTION.
    0010    SOURCE-COMPUTER. DECsystem-10. 
    0011    OBJECT-COMPUTER. PDP-10.
    0012    INPUT-OUTPUT SECTION.
    0013    FILE-CONTROL.
    0014           SELECT PAYTRN ASSIGN TO DSK
    0015           RECORDING MODE IS ASCII.
    0016           SELECT YTDMAS ASSIGN TO DSK
    0017           RECORDING MODE IS ASCII.
    0018           SELECT OUTMAS ASSIGN TO DSK
    0019           RECORDING MODE IS ASCII.
    0020           SELECT PAYREP ASSIGN TO DSK
    0021           RECORDING MODE IS ASCII.
    0022           SELECT PAYCHK ASSIGN TO DSK
    0023           RECORDING MODE IS ASCII.
    0024    I-O-CONTROL.
    0025    SAME RECORD AREA FOR YTDMAS, OUTMAS.
    0026    DATA DIVISION.
    0027    FILE SECTION.
    0028    FD PAYTRN
    0029           LABEL RECORDS ARE STANDARD
    0030           VALUE OF IDENTIFICATION IS "PAYTRNDAT".
    0031    01 PAYTRNIN.
    0032           02 SOC-SEC-NO PIC IS 9(9).
    0033           02 LNAME PIC IS X(15).
    0034           02 FNAME PIC IS X(10).
    0035           02 HRSWKD PIC IS 99V9.
    0036           02 HOURLYRATE PIC IS 99V999.
    0037    FD YTDMAS
    0038           LABEL RECORDS ARE STANDARD
    0039           VALUE OF IDENTIFICATION IS "YTDMASHIS".
    0040    01 MASRECIN.
    0041           02 SOC-SEC-NO PIC IS 9(9).
    0042           02 EMPLOYEE-NO PIC IS 9(6).
    0043           02 DEPT-NO PIC IS 9999.
    0044           02 NUMBER-EXEMPTIONS PIC IS 99.
    0045           02 YTD-GROSS-WH PIC IS 9(5)V99.
    0046           02 YTD-FIT-WH PIC IS 9999V99.
    0047           02 YTD-FICA-WH PIC IS 999V99.
    0048           02 YTD-INS-WH PIC IS 999V99.
    0049    FD OUTMAS
    0050           LABEL RECORDS ARE STANDARD
    0051           VALUE OF IDENTIFICATION IS "OUTMASHIS".
    0052    01 MASRECOUT PIC IS X(44).
    0053    FD PAYREP
    0054           LABEL RECORDS ARE STANDARD
    0055           VALUE OF IDENTIFICATION IS "PAYREPOUT".
    0056    01 REGISTER-REC PIC IS X(70).    P R O G R A M   T W O 		COBOL (005001,107000)	23-MAY-73  12:22		PAGE 1-1
    TWO.CBL    01-MAY-73  18:17

    0057    FD PAYCHK
    0058           LABEL RECORDS ARE STANDARD
    0059           VALUE OF IDENTIFICATION IS "PAYCHKOUT".
    0060    01 CHECKS-REC PIC IS X(70).
    0061    WORKING-STORAGE SECTION.
    0062    77 BEG-CHK-NO           PIC 9(6) VALUE ZERO.
    0063    77 CUR-DATE             PIC X(20) VALUE SPACES.
    0064    77 END-PAY-PER          PIC X(20) VALUE SPACES.
    0065    77 GROSS-WS             PIC S9999V99 VALUE ZEROES COMP.
    0066    77 FICA-WS              PIC S9999V99 VALUE ZEROES COMP.
    0067    77 FIT-WS               PIC S9999V99 VALUE ZEROES COMP.
    0068    77 INS-WS               PIC S9999V99 VALUE ZEROES COMP.
    0069    77 NET-WS               PIC S9999V99 VALUE ZEROES COMP.
    0070    77 TEMP                 PIC 9(5)V99 VALUE ZEROES COMP.
    0071    77 TEMP1                PIC 999V99 VALUE ZEROES COMP.
    0072  * 
    0073    01 PAYHD-1.
    0074           02 FILLER       PIC X(30) VALUE SPACES.
    0075           02 FILLER       PIC X(40) VALUE "PAYROLL REPORT".
    0076    01 PAYHD-2.
    0077           02 FILLER       PIC X(30) VALUE "  SOC-SEC          FIRST      ".
    0078           02 FILLER       PIC X(30) VALUE "    LAST       HOURS   HOURLY ".
    0079           02 FILLER       PIC X(10) VALUE "  GROSS".
    0080    01 PAYHD-3.
    0081           02 FILLER       PIC X(30) VALUE "  NUMBER           NAME       ".
    0082           02 FILLER       PIC X(30) VALUE "    NAME        WKD     RATE  ".
    0083           02 FILLER       PIC X(10) VALUE "   PAY".
    0084    01 PAYHD-4.
    0085           02 FILLER       PIC X(30) VALUE "           FIT-WH        FICA-".
    0086           02 FILLER       PIC X(30) VALUE "WH       INS-WH     NET".
    0087    01 PAY-LN1.
    0088           02 FILLER       PIC X     VALUE SPACE.
    0089           02 SOC-SEC-NO   PIC 999B99B9999.
    0090           02 FILLER       PIC XXX VALUE SPACE.
    0091           02 FNAME        PIC X(15) VALUE SPACES.
    0092           02 LNAME        PIC X(11) VALUE SPACES.
    0093           02 HRSWKD       PIC Z(6).99.
    0094           02 HOURLYRATE   PIC ZZZ9.999.
    0095           02 GROSSPAY     PIC ZZ,ZZZ.99.
    0096    01 PAY-LN2.
    0097           02 FILLER       PIC X(8) VALUE SPACES.
    0098           02 FIT-WH       PIC ZZ,ZZZ.99.
    0099           02 FILLER       PIC X(6) VALUE SPACES.
    0100           02 FICA-WH      PIC Z,ZZZ.99.
    0101           02 INS-WH       PIC ZZ,ZZZ,ZZZ.99.
    0102           02 NETPAY       PIC Z,ZZZ,ZZZ.99.
    0103    01 CHK-LN1.
    0104           02 FILLER       PIC X VALUE SPACE.
    0105           02 CHK-EMP-MSG  PIC X(10) VALUE SPACES.
    0106           02 CHK-EMP-NO   PIC Z(5)9 VALUE ZEROES.
    0107           02 FILLER       PIC X(18) VALUE SPACES.
    0108           02 MSG-P        PIC X(15) VALUE SPACES.
    0109           02 CK-DATE      PIC X(20) VALUE SPACES.
    0110    01 CHK-LN2.
    0111           02 FILLER       PIC X(11) VALUE " PAY TO:   ".
    0112           02 FNAME        PIC X(15) VALUE SPACES.    P R O G R A M   T W O 		COBOL (005001,107000)	23-MAY-73  12:22		PAGE 1-2
    TWO.CBL    01-MAY-73  18:17

    0113           02 LNAME        PIC X(31) VALUE SPACES.
    0114           02 NETPAY       PIC $*,***,***.99.
    0115  * 
    0116    PROCEDURE DIVISION.
    0117    HSKPG.
    0118           DISPLAY "ENTER BEGINNING CHECK NUMBER: " WITH NO ADVANCING.
    0119           ACCEPT BEG-CHK-NO.
    0120           DISPLAY "ENTER CURRENT DATE: " WITH NO ADVANCING.
    0121           ACCEPT CUR-DATE.
    0122           DISPLAY "ENTER ENDING PAY PERIOD DATE: " WITH NO ADVANCING.
    0123           ACCEPT END-PAY-PER.
    0124  * 
    0125           OPEN INPUT PAYTRN, YTDMAS
    0126               OUTPUT OUTMAS, PAYREP, PAYCHK.
    0127  * 
    0128    HDG-RTN.
    0129           
    0130           WRITE REGISTER-REC FROM PAYHD-1 AFTER 4.
    0131           WRITE REGISTER-REC FROM PAYHD-2 AFTER 2.
    0132           WRITE REGISTER-REC FROM PAYHD-3 AFTER 1.
    0133           WRITE REGISTER-REC FROM PAYHD-4 AFTER 2.
    0134  * 
    0135    RD-FILES.
    0136           READ YTDMAS, AT END GO TO EOJ-RTN.
    0137           READ PAYTRN, AT END GO TO EOJ-RTN.
    0138  * 
    0139    COMPUTEPAY.
    0140           COMPUTE GROSS-WS ROUNDED  = HRSWKD IN PAYTRNIN * HOURLYRATE IN PAYTRNIN.
    0141           COMPUTE FICA-WS ROUNDED = GROSS-WS * .04.
    0142           COMPUTE FIT-WS ROUNDED = ( GROSS-WS - ( NUMBER-EXEMPTIONS * 13)) * .15.
    0143           COMPUTE INS-WS = 5.40 * NUMBER-EXEMPTIONS.
    0144                   IF INS-WS > 14.00, MOVE 14.00 TO INS-WS.
    0145           COMPUTE NET-WS = GROSS-WS - FICA-WS - INS-WS - FIT-WS.
    0146  * 
    0147    BUILDPAY.
    0148           MOVE CORRESPONDING PAYTRNIN TO PAY-LN1.
    0149           MOVE CORRESPONDING PAYTRNIN TO CHK-LN2.
    0150           MOVE GROSS-WS TO GROSSPAY.
    0151           MOVE NET-WS TO NETPAY IN PAY-LN2, NETPAY IN CHK-LN2.
    0152           EXAMINE SOC-SEC-NO IN PAY-LN1  REPLACING ALL " " BY "-".
    0153  * 
    0154           WRITE REGISTER-REC FROM PAY-LN1 AFTER 2.
    0155  * 
    0156           MOVE FIT-WS TO FIT-WH.
    0157           MOVE FICA-WS TO FICA-WH.
    0158           MOVE INS-WS TO INS-WH.
    0159  * 
    0160           WRITE REGISTER-REC FROM PAY-LN2 AFTER 1.
    0161  * 
    0162    BUILDCHK.
    0163           MOVE "CHECK NO. " TO CHK-EMP-MSG.
    0164           MOVE BEG-CHK-NO TO CHK-EMP-NO.
    0165           MOVE "CURRENT DATE: " TO MSG-P.
    0166           MOVE CUR-DATE TO CK-DATE.
    0167  * 
    0168           WRITE CHECKS-REC FROM CHK-LN1 AFTER 7.    P R O G R A M   T W O 		COBOL (005001,107000)	23-MAY-73  12:22		PAGE 1-3
    TWO.CBL    01-MAY-73  18:17

    0169  * 
    0170           MOVE "EMP NO.   " TO CHK-EMP-MSG.
    0171           MOVE EMPLOYEE-NO TO CHK-EMP-NO.
    0172           MOVE "PAY PERIOD: " TO MSG-P.
    0173           MOVE END-PAY-PER TO CK-DATE.
    0174  * 
    0175           WRITE CHECKS-REC FROM CHK-LN1 AFTER 1.
    0176           WRITE CHECKS-REC FROM CHK-LN2 AFTER 3.
    0177  * 
    0178           ADD 1 TO BEG-CHK-NO.
    0179  * 
    0180    BUILDMAS.
    0181           ADD GROSS-WS TO YTD-GROSS-WH.
    0182           ADD FIT-WS TO YTD-FIT-WH.
    0183           ADD FICA-WS TO YTD-FICA-WH.
    0184           ADD INS-WS TO YTD-INS-WH.
    0185  * 
    0186           WRITE MASRECOUT FROM MASRECIN.
    0187           GO TO RD-FILES.
    0188  * 
    0189    EOJ-RTN.
    0190           CLOSE PAYTRN, YTDMAS, OUTMAS, PAYREP, PAYCHK.
    0191           STOP RUN.    P R O G R A M   T W O 		COBOL (005001,107000)	23-MAY-73  12:22		PAGE W-1
    TWO.CBL    01-MAY-73  18:17

WARNINGS:

    0148  RIGHT-MOST TRUNCATION ON LNAME
    0183  MOST SIGNIFICANT DIGITS TRUNCATED ON YTD-FICA-WH
    0184  MOST SIGNIFICANT DIGITS TRUNCATED ON YTD-INS-WH


NO FATAL ERRORS, 3 WARNINGS
  