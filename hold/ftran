        SUBROUTINE FTRAN(COL,ETA,TEMP,INDETA)
       DIMENSION COL(1),ETA(1),TEMP(1),INDETA(1)
C DECLARATIONS MADE 6/19/73
C*S     START COMMON
        COMMON /MIPCOM/ V,AV,WDCNT,DUEL,IR,IK,RI,L,M,N
        COMMON /MIPCOM/ Q,QP,QPP,NETA,MAXETA,PRIM,NODUAL,NOPRIM
        COMMON /MIPCOM/ BIG,NPM,MP1,NP1,DELTA,UNB,ITYPE,ISTAR,IRP,IRPP
        COMMON /MIPCOM/ TOL,TOL1,OPTION,ISW,ID,CHSIN,ITER,OBVAL,OBJ1
        COMMON /OUTCOM/ JL,JR,NAML,VAL,NAMR,KR,PR
        COMMON /LINCNT/ LINE
C       LINE IS CURRENT LINE NO. IN CREATE FILE
        INTEGER DICT, OPTION, OBJ1
        INTEGER V,AV,CB,CN,WDCNT,DUEL ,PRIM,UNB,RI
C*E     END COMMON
C
C       COMMON DECLARATIONS FOR MIP
C
C
C
C       FTRAN PRE-MULTIPLIES THE VECTOR IN COL BY THE LAST
C       (NETA-NN+1) MATRICES IN THE ETA FILE.
C       IF THE ETA FILE IS EMPTY THE UPDATED COEFFICIENTS ARE
C       ALREADY IN COL.
C
CCOMMON DECLARATIONS HERE
C


        IF(NETA .EQ. 0) RETURN
C       NETA IS NUMBER OF MATRICES IN NETA

        DO 1000 I = 1,NETA
600     CALL GETETA(I,RI,ETA,TEMP,INDETA)
C       GETETA GETS THE I-TH MATRIX IN ETAFIL, AND RETURNS THE INDEX
C       TO THE NON-ELEMENTARYY COLUMN IN RI

700     DO 900 J = 1, M
        IF(J .EQ. RI) GO TO 800
        TEMP(J) = COL(J) +COL(RI) * ETA(J)
        GO TO 900
800     TEMP(J) = COL(J) *ETA(J)
900     CONTINUE
        
        DO 950 JJ = 1, M
950     COL(JJ) = TEMP(JJ)

1000    CONTINUE
D       WRITE (ID,9000) RI
D9000   FORMAT(' FTRAN  RI =',I5)
D       WRITE(ID,9100) (COL(J), J=1,M)
D9100   FORMAT(1X,'COL',/,(1X,G))


C      ADD PARAMETRIC PROGRAMMING HOOKS
C       COL NOW CONTAINS THE UPDATE COEFFICIENTS
        RETURN
        END
