01000 REM***INPUT
01010 PRINT "ENTER INPUT FILENAME";
01020 INPUT A$
01030 PRINT
01040 PRINT "SHOULD I UPDATE THE HISTORY FILE -- (LAST RUN OF QTR)";
01050 INPUT B$
01060 PRINT
01070 FILE #1, A$
01080 FILE #2,"HIST"
01081 FILE #3,"HISTF"
01082 FILE :4,"CONS"
01083 SCRATCH #3, :4
01084 SET  4 : LOF(4)
01090 READ #1,P2
01100 PRINT "AFTER PAUSE,SPACE TO NEW PAGE & HIT RETURN"
01110 INPUT A$
01115 D1=100
01120 DIM A(60,4)
01130 FOR Z9=1 TO P2
01135 READ #1, A(59,1)
01140 FOR R=1 TO 12
01150 READ #1,A(R,1)
01160 A(R,2) = A(,1)
01165 A(R,3)=A(R,1)
01170 A(R,4)=A(R,1)+A(R,2)+A(R,3)
01180 NEXT R
01182 READ #1, A(1,2)
01183 IF A(1,1)=A(1,2) THEN 1190
01185 PRINT "DATA IN ERROR --- CHECK DEPT. # ";A(1,1)
01187 STOP
01190 REM *** GET HISTORY DATA --- LOOK FOR MATCH ***
01200 READ #2,Z7,A(17,1),A(18,1),A(19,1)
01210 IF Z7=A(1,1) THEN 1250
01220 IF B$="NO" THEN 1200
01230 WRITE #3,Z7,A(17,1),A(18,1),A(19,1)
01240 GOTO 1200
01250 FOR C=1 TO 3
01260 READ #1,A(13,C),A(14,C),A(15,C),A(16,C)
01262 IF A(17,C)<>0 THEN 1270
01264 A(20,C)=0
01266 GOTO 1280
01270 A(20,C)=((A(17,C)-A(18,C))/A(17,C))*D1
01280 A(21,C)=A(13,C)+A(2,C)
01290 A(22,C)=(1-(A(14,C)/D1))
01300 A(23,C)=A(22,C)*A(21,C)
01310 A(24,C)=A(3,C)*A(23,C)/D1
01320 A(25,C)=A(21,C)+A(4,C)
01330 A(26,C)=A(23,C)+A(24,C)+A(5,C)
01340 A(27,C)=A(17,C)+A(25,C)
01350 A(28,C)=A(18,C)+A(26,C)
01360 A(29,C)=((A(27,C)-A(28,C))/A(27,C))*D1
01370 A(30,C)=(A(6,C)*A(15,C))/D1
01380 A(31,C)=(A(16,C)/A(15,C))*1
01390 A(32,C)=A(15,C)+A(16,C)+A(30,C)+A(7C)+A(8,C)
01400 A(33,C)=A(32,C)+A(19,C)
01410 A(34,C)=(1-(A(29,C)/D1))
01420 A(35,C)=(A(34,C)*A(15,C))/D1
01430 A(36,C)=(A(35,C)/A(15,C))*D1
01440 A(37,C)=A(34,C)*A(16,C)
01450 A(38,C)=(A(37,C)/A(15,C))*D1
01460 A(39,C)=A(34,C)*A(30,C)
01470 A(40,C)=(A(39,C)/A(15,C))*D1
01480 A(41,C)=(A(34,C)*A(7,C))/D1
01490 A(42,C)=(A(41,C)/(15,C))*D1
01500 A(43,C)=(A(34,C)*A(8,C))/D1
01510 A(44,C)=(A(43,C)/A(15,C))*1
0 A(4=A(20,C)-A(29,C)
01530 A(45,C)=A(49,C)*A(19,C)
01540 A(46,C)=A(45,C)/A(15,C)
01550 A(47,C)=(A(9,C)*A(23,C))/D1
01560 A(48,C)=(A(47,C)/A(15,C))*D1
01570 A(50,C)=A(35,C)+A(37,C)+A(39,C)+A(41,C)+A(43,C)+A(45,C)+A(47,C)
01580 A(51,C)=(A(50,C)/A(15,C))*D1
01590 A(52,C)=(A(10,C)*A(15,C))/D1
01600 A(53,C)=(A(11,C)*A(15,C))/D1
01610 A(54,C)=(A(12,C)*A(15,C))/D1
01620 A(55,C)=A(50,C)+A(52,C)+A(53,C)+A(54,C)
01630 A(56,C)=(A(55,C)/A(15,C))*D1
01640 A(58,C)=A(29,C)-A(38,C)-A(40,C)-A(42,C)-A(44,C)-A(46,C)+A(48,C)-A(10,C)-A(11,C)-A(12,C)
01650 A(57,C)=(A(58,C)*A(15,C))/D1
01660 A(17,C+1)=A(27,C)
01670 A(18,C+1)=A(28,C)
01680 A(19,C+1)=A(33,C)
01690 NEXC
01700 REM *** CALCUTE QURTERTOTAL ***
01710 FOR R=13 TO 58
01720 A(R,4)=A(R,1)+A(R,2)+A(R,3)
01730 NEXT R
01740 REM ********   OAKLEY,  FROM HERE TO 4000 YOU SHOULD ADD YOUR CALC**ULATIONS FOR QUARTER TOTALS ********
01750 A(17,4)=A(17,1)
01760 A(18,4)=A(18,1)
01770 A(20,4)=A(20,1)
01780 A(3,4)=A(3,1)
01781 A(9,4)=A(9,1)
01790 A(14,4)=((A(13,4)-A(23,4))/A(13,4))*D1
01800 A(10,4)=A(10,1)
01810 A(11,4)=A(11,1)
01820 A(12,4)=A(12,1)
01830 A(27,4)=A(17,4)+A(25,4)
01840 A(28,4)=A(18,4)+A(26,4)
01850 A(29,4)=((27,4)-A(28,4))/A(27,4))*D1
01860 A(19,4)=A(19,1)
01870 A(31,4)=(A(16,4)/A(15,4))*D1
01880 A(33,4)=A(32,4)+A(19,4)
01890 A(34,4)=(1-(A(29,4)/D1))
01900 A(35,4)=(A(34,4)*A(15,4))/D1
01910 A(36,4)=(A(35,4)/A(15,4))*D1
01920 A(37,4)=A(34,4)*A(16,4)
01930 A(38,4)=(A(37,4)/A(15,4))*D1
01940 A(39,4)=A(34,4)*A(30,4)
01950 A(40,4)=(A(39,4)/A(15,4))*D1
01960 A(41,4)=(A(34,4)*A(7,4))/D1
01970 A(42,4)=(A(41,4)/A(15,4))*D1
01980 A(43,4)=(A(34,4)*A(8,4))/D1
01990 A(44,4)=(A(43,4)/A(15,4))*D1
02000 A(49,4)=A(20,4)-A(29,4)
02010 A(45,4)=A(49,4)*A(19,4)
02020 A(46,4)=A(45,4)/A(15,4)
02030 A(47,4)=(A(9,4)*A(23,4))/D1
02040 A(48,4)=(A(47,4)/A(15,4))*D1
02050 A(50,4)=A(35,4)+A(37,4)+A(39,4)+A(41,4)+A(43,4)+A(45,4)+A(47,4)
02060 A(51,4)=(A(50,4)/A(15,4))*D1
02070 A(52,4)=(A(10,4)*A(15,4))/D1
02080 A(53,4)=(A(11,4)*A(15,4))/D1
02090 A(54,4)=(A(12,4)*A(15,4))/D1
02100 A(55,4)=A(50,4)+A(52,4)+A(53,4)+A(54,4)
02110 A(56,4)=(A(55,4)/A(15,4))*D1
02120 A(58,4)=A(29,4)-A(38,4)-A(40,4)-A(42,4)-A(44,4)-A(46,4)+A(48,4)-A(10,4)-A(11,4)-A(12,4)
02140 REM *** PUT NEW HISTORY TO FILE ***
02150 IF B$="NO" THEN 2170
02160 WRITE #3,Z7,A(27,3),A(28,3),A(33,3)
02170 REM***PRINT ROUTINE
02180 :                     THE J.L. HUDSON COMPANY
02190 :                      GROSS MARGIN ANALYSIS
02200 :                                           1             2             3           TOTAL
02210 :SALES                                  $########     $########     $########     $########
02220 :#                                       [[[[[[[[[     [[[[[[[[[     [[[[[[[[[     [[[[[[[[[
02230 : CUM. M.U.%                             ###.##%       ###.##%       ###.##%       ###.##%
02240 : MARKDOWNS @ COST                       ###.##        ###.##        ###.##        ###.##
02250 : EMPLOYEE DISCOUNTS                     ###.##        ###.##        ###.##        ###.##
02260 : ACTUAL SHORTAGE @ COST               ###.##        ###.##        ###.##        ###.##
02270 : OTHER @ COST                           ###.##        ###.##    ##        ###.##
02280 : YTD CUM. M.U.% IMPACT                  ###.##        ###.##        ###.##        ###.##
02290 : ENED DISCOUNTS                       ###.##        ###.##        ###.##        ###.##
02300 : SHORTAGE PROVISION                     ###.##        ###.##        ###.##        ###.##
02310 : WORKROOM COSTS                         ###.##        ###.##        ###.##        ###.##
02320 : OTHER                                  ###.##        ###.##        ###.##        ###.##
02330 : GROSS MARGIN %                         ###.##%       ###.##%       ###.##%       ###.##%
02340 : GROSS MARGIN $                        $########     $########     $########     $########
02350 :# [[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[
0236 INITIAL M.U.%                          ###.##%       ###.##%       ###.#      ###.##%
02370 : MARKDOWNS @ RETAIL                    $########    $########     $########     $########
02380 : MARKDOWNS @ RETAIL % TO SALES          ###.##%       ###.##%       ###.##%       ###.##%
02390 : EARNED DISCOUNTS % TO COST RECEIPTS    ###.##%       ###.##%       ###.##%       ###.##%
02400 : FREIGHT % TO COST RECEIPTS              ###.##%       ###.##%       ###.##%       ###.##%
02430 REM PRINT USING 2180
02440 REM PRINT USING 2190
02450 REM PRINT
02721 WRITE :4, A(1,1),A(59,1),A(15,1),A(15,2),A(15,3),A(15,4),A(29,1),A(29,2),A(29,3),A(29,4)
02722 FOR R  = 37 TO 47 STEP 2
02723 WRITE :4, A(R,1),A(R,2),A(R,3),A(R,4)
02724 NEXT R
02725 WRITE :4, A(10,1),A(10,2),A(10,3),A(10,4),A(11,1),A(11,2),A(11,3),(11,4)
02726 WRITE :4, A(12,1),A(12,2),A(12,3),A(12,4),A(57,1),A(57,2),A(57,3),A(57,4)
02727 WRITE :4, A(14,1),A(14,2),A(14,3),A(14,4),A(16,1),A(16,2),A(16,3),A(16,4)
02728 WRITE :4, A(9,1),A(9,2),A(9,3),A(9,4),A(3,1),A(3,2),A(3,3),A(3,4)
02729 WRITE :4, A(13,1),A(13,2),A(13,3),A(13,4),A(23,1),A(23,2),A(23,3),A(23,4),A(24,1),A(24,2),A(24,3),A(24,4)
02730 WRITE :4, A(27,1),A(27,2),A(27,3),A(27,4),A(28,1),A(28,2),A(28,3),A(28,4)
02731 WRITE :4, A(53,1),A(53,2),A(53,3),A(53,4)
02780 NEXT Z9
02790 IF B$="NO" THEN 2870
02791 IF END #2, GOTO 2800
02792 READ #2,A,B,C,D
02793 WRITE #3,A,B,C,D
02794 GOTO 2792
02800 REM CLOSE 1,2,3,4
02870 PRINT "REPORT IS COMPLETE -- FILES OK!"
02880 END

-
