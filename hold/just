BEGIN "JUSTIFY"

EXTERNAL PROCEDURE BYE;

DEFINE CR="'15&'12";
DEFINE NXTCHR="INPSTR[1 FOR 1]";

STRING ARRAY PAGE[1:PAGESIZE];

PROCEDURE GETWORD;
BEGIN
        LINE_INPUT(SOURCE,DELIM);
        WHILE (LOP(LINE)<9 AND LOP(LINE) GEQ 0) DO
                LINE_LINE[2 TO INF];
        PAGENUMBER_1; PAGELINE_PAGELINE+1; NLINES_NLINES+1;
        IF (EQU(LINE,NULL)) THEN GOTO NULLINE;
        IF LENGTH(LINE>MAXLENGTH) THEN OUTSTR("LINE "&CVS(NLINES)&" IS TOO LONG.&CR);
        ELSE BEGIN
                FOR I_1 STEP 1 UNTIL LINELENGTH DO BEGIN
                IF CHR_LINE[1 FOR 1]=" " DO NWORDS_NWORDS+1;
                WHILE LINE[I]=" " DO I_I+1;
        END ELSE
        IF CHR="L"-'100 THEN FORMFEED_TRUE
        ELSE FORMFEED_FALSE LOR FORMFEED;

END;

BOOLEAN PROCEDURE ANSWER;
WHILE TRUE DO BEGIN
        STR_INCHWL;
        IF EQU(STR,"Y") THEN RETURN(TRUE)
        ELSE IF EQU(STR,"N") THEN RETURN(FALSE);
        OUTSTR("REPLY 'Y' OR 'N': ");
END;

PROCEDURE REVERSE(STRING STR);
BEGIN STRING REVSTR;
        WHILE LENGTH(STR)>0 DO BEGIN
                REVSTR_REVSTR&STR[LENGTH(STR) FOR 1];
                STR_STR[1 FOR LENGTH(STR)-1];
        END;
RETURN(REVSTR);
END;

PROCEDURE STRIPBLANKS;
WHILE LENGTH(INPSTR)>0 AND NXTCHR=" "DO CHR_LOP(INPSTR);

PROCEDURE JUSTIFY;
BEGIN STRING NEWOUT,TOSS;
        IF LENGTH(NEWSTR)>MINIMUM THEN BEGIN
                IF NEWSTR[LENGTH(NEWSTR)-2 FOR 1]="." THEN
                NEWSTR_NEWSTR[1 TO LENGTH(NEWSTR)-1];
                NEWSTR_REVERSE(NEWSTR);

COMMENT - DECIDE ON BLANKS ;

                FOR BLANX_1 STEP 1 UNTIL BLANKSPERWORD DO BEGIN
                        I_REALLENGTH-LENGTH(NEWSTR)+1;
                        IF I GEQ WDCNT THEN I_WDCNT-1;
                        NEWOUT_NULL;
                        FOR J_1 STEP 1 UNTIL J DO BEGIN
                                NEWSTR_NEWSTR[LENGTH(TOSS_SCAN(NEWSTR(NOBLANKS,
                                BRCHAR))+1 TO INF];
                                NEWSTR_NEWSTR&TOSS;
                                NEWSTR_NEWSTR[LENGTH(TOSS_SCAN(NEWSTR(NOBLANKS,
                                NEWSTR_NEWSTR&TOSS&" ";
                        END;
                        NEWSTR_NEWOUT&NEWSTR;
                END;
                REVERSE(NEWSTR);
        END;
END;
