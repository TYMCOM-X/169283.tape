1 DIM M(100,4),D(4,3),C5(3)
30 H7=0
40 K1$="MC"
50 K$="AS"
55 K2$="ACY"
60 PRINT ":";
70 INPUT E$
80 L$=LEFT$(E$,1)
100 L6=INSTR(L$,"E")
110 IF L6<>0 THEN 150
120 REM USER IN BEGINNERS MODE
130 E=1
140 GO TO 160
150 E=2
155 E9=0
160 ON E GO TO 170,190
170 PRINT "ISSUING BODY";
180 GO TO 200
190 PRINT "ISS";
200 INPUT I$
210 ON E GO TO 220,240
220 PRINT "ANNUAL OR SEMI-ANNUAL";
230 GO TO 250
240 PRINT "A OR S";
250 INPUT T$
260 L$=LEFT$(T$,1)
270 F1=INSTR(K$,L$)
280 IF F1<>0 THEN 340
290 ON E GO TO 320,300
300 GOSUB 2440
310 GO TO 330
320 PRINT T$;"INCORRECT RESPONSE PLEASE RETYPE LINE"
330 ON E GO TO 220,240
340 ON E GO TO 350,370
350 PRINT "SPREAD";
360 GO TO 380
370 PRINT "SP";
380 INPUT S5$
390 LET H$=S5$
400 GOSUB 4850
410 IF F3=0 THEN 430
415 ON E GO TO 350,420
420 GOSUB 2440
425 ON E GO TO 350,370
430 G=1
440 ON E GO TO 450,470
450 PRINT "DATED DATE";
460 GO TO 480
470 PRINT "DD";
480 INPUT D1$,D2$,D3$
490 GOSUB 2100
500 IF D0<>1 GO TO 580
520 IF E=1 GO TO 570
530 GOSUB 2440
570 ON G GO TO 430,590,660,730
580 ON G GO TO 590,660,730,800
590 G=2
600 ON E GO TO 610,630
610 PRINT "DELIVERY DATE";
620 GO TO 640
630 PRINT "DL";
640 INPUT D1$,D2$,D3$
650 GO TO 490
660 G=3
670 ON E GO TO 680,700
680 PRINT "FIRST INTEREST DATE";
690 GO TO 710
700 PRINT "FI";
710 INPUT D1$,D2$,D3$
720 GO TO 490
730 G=4
740 ON E GO TO 750,770
750 PRINT "FIRST PRINCIPAL DATE";
760 GO TO 780
770 PRINT "FP";
780 INPUT D1$,D2$,D3$
790 GO TO 490
800 Y3=D(4,3)
801 ON E GO TO 810,830
810 PRINT " ENTER BY MATURITY OR COLUMN";
820 GO TO 840
830 PRINT " M OR C";
840 INPUT T5$
850 L$=LEFT$(T5$,1)
860 L7=INSTR(K1$,L$)
870 IF L7<>0 THEN 890
880 PRINT " ERROR IN RESPONSE TO LAST QUESTION RETYPE"
885 GO TO 800
890 GO TO 4000
2100 REM SUBROUTINE FCHECKS FOR ALPHA AND RANGES OF NUMERICS
2110 D0=0
2115 LET H$=D1$
2116 H7=1
2120 GOSUB 4850
2125 H7=0
2130 IF F3=0 THEN 2155
2140 ON G GO TO 440,600,670,740
2155 LET H$=D2$
2156 H7=1
2160 GOSUB 4850
2161 H7=0
2165 IF F3=0 THEN 2175
2170 ON G GO TO 440,600,670,740
2175 LET H$=D3$
2176 H7=1
2180 GOSUB 4850
2185 H7=0
2190 IF F3=0 THEN 2220
2200 ON G GO TO 440,600,670,740
2220 LET D(G,1)=VAL(D1$)
2230 LET D(G,2)=VAL(D2$)
2240 LET D(G,3)=VAL(D3$)
2320 IF D(G,1)<=12 GO TO 2360
2330 PRINT " MONTH OUT OF RANGE PLEASE RETYPE"
2340 D0=1
2350 GO TO 2430
2360 IF D(G,2)<=31 THEN 2400
2370 PRINT "DAY OUR OF RANGE PLEASE RETYPE"
2380D0=1
2390 GO TO 2430
2400 IF D(G,3)>1960 GO TO 2430
2410 PRINT "YEAR OUT OF RANGE PLEASE RETYPE"
2411 PRINT " YEAR MUST  BE GREATER THEN FIRST PRINCIPAL DATE"
2420 D0=1
2430 RETURN
2440 REM THIS ROUTINE COUNTS ERRORS MADE IN EXPERT MODE
2450 REM MORE THAN 3 ERRORS AND  USER SWITCHED TO BEGINNERS MODE
2460 E9=E9+1
2470 IF E9>=3 GO TO 2490
2480 GO TO 2510
2490 PRINT "TOO MANY ERRORS IN EXPERT MODE  SWITCHING TO LONG FORM"
2500 E=1
2510 RETURN
4000 J=1
4003 A=0
4005 J1=1
4010 Y3=Y3-1
4015 ON F1 GO TO 4065,4020
4020 IF Y1>6 THEN 4035
4025 F2=1
4030 GO TO 4040
4035 F2=2
4040 ON L7 GO TO 4045,4945
4045 Y$=STR$(Y3+J)
4050 F$=STR$(F2)
4055 PRINT Y$;",";F$;":";
4060 GO TO 4085
4065 ON L7 GO TO 4070,4945
4070 Y$=STR$(Y3+J)
4075 PRINT Y$;":";
4080 REM READ IN VARIABLES INPUT AT TERMINAL
4085 INPUT A$,B$,C$
4086 A7=LEN(A$)
4087 IF A7<>0 THEN 4095
4088 PRINT "A CARRIAGE RETURN IS NOT A VALID END TO THE INPUT MODE"
4089 PRINT " TO END INPUT TYPE   END,0,0     "
4090 ON F1 GO TO 4045,4070
4095 L5=INSTR(A$,"END")
4100 IF L5<>0 THEN 4830
4105 C1=INSTR(A$,"SKIP")
4110 IF C1<>0 THEN 4295
4115 REM USER IS INPUTTING VALUES CHECK FOR ALPHA CHARACTERS
4120 LET H$=A$
4125 GOSUB 4850
4130 IF F3=0 THEN 4140
4135 ON F1 GO TO 4070,4045
4140 LET H$=B$
4145 GOSUB 4850
4150 IF F3=O THEN 4160
4155 GO TO 4135
4160 LET H$=C$
4165 GOSUB 4850
4170 IF F3=0 GO TO 4180
4175 GO TO 4135
4180 REM ALL VALUES ARE NUMERIC
4185 REM CONVERT ALL STRINGS TO NUMERICS
4190 A=VAL(A$)
4195 B=VAL(B$)
4200 C=VAL(C$)
4205 IF A=0 THEN 4225
4210 IF C>1 THEN 4225
4215 PRINT "YIELD SHOULD BE A PERCENT PLEASE RETYPE LINE"
4220ON F1 GO TO 4070,4045
4225 M(J1,1)=Y3+J
4230 M(J1,2)=A
4235 M(J1,3)=B
4240 M(J1,4)=C
4245 J1=J1+1
4250 IF F1=2 THEN 4265
4255 J=J+1
4260 GO TO 4070
4265 F2=F2+1
4270 IF F2=2 THEN 4045
4275 F2=1
4280 J=J+1
4285 GO TO 4045
4290 REM THIS PORTION DEALS WITH SKIP OPTION
4295 Z1=LEN(A$)
4300 Z3=INSTR(A$,"TO")
4305 IF Z3<>0 THEN 4595
4310 Z4=4
4315 Z2=INSTR(Z4+1,A$," ")
4320 IF Z2=0 THEN 4335
4325 Z4=Z2
4330 GO TO 4315
4335 N1=Z1-Z4
4340 Z5=Z4+1
4345 Z$=MID$(A$,Z5,N1)
4350 LET H$=Z$
4355 H7=1
4360 GOSUB 4850
4365 H7=0
4370 IF F3=0 THEN 4380
4375 ON F1 GO TO 4070,4045
4380 N=VAL(Z$)
4385 IF J+N<=100 THEN 4405
4390 PRINT "NUMBER OF MATURITIES SKIPPED PUT OF RANGE"
4395 PRINT "PLEASE RETYPE RESPONSE"
4400 ON F1 GO TO 4070,4045
4405 REM CHECK TO SEE IF B$ AND C$ ARE NUMERIC
4410 LET H$=B$
4415 GOSUB 4850
4420 IF F3=0 THEN 4430
4425 ON F1 GO TO 4070,4045
4430 LET H$=C$
4435 GOSUB 4850
4440 IF F3=0 THEN 4450
4445 ON F1 GO TO 4070,4045
4450 B=VAL(B$)
4455 C=VAL(C$)
4460 IF B+C<>0 THEN 4470
4465 A=0
4470 ON F1 GO TO 4475,4525
4475 FOR K=J1 TO J1+N-1
4480 M(K,1)=Y3+K
4485 M(K,2)=A
4490 M(K,3)=B
4495 M(K,4)=C
4500 NEXT K
4505 J=J+N
4510 J1=J1+N
4515 GO TO 4070
4520 REM FOR SEMI-ANNUAL
4525 K1=F2
4530 FOR K=J1 TO J1+N-1
4535 M(K,1)=Y3+J
4540 M(K,2)=A
4545 M(K,3)=B
4550 M(K,4)=C
4555 K1=K1+1
4560 IF K1=2 THEN 4575
4565 K1=1
4570 J=J+1
4575 NEXT K
4580 J1=J1+N
4585 F2=K1
4590 GO TO 4045
4595 X1=Z3+2
4600 IF X1>Z1 THEN 4630
4605 X2=(Z1-X1)+1
4610 B1$=MID$(A$,X1,1)
4615 IF B1$<> " " THEN 4640
4620 X1=X1+1
4625 IF X1<=Z1 GO TO 4610
4630 PRINT "CANNOT INTERPRET INPUT ";A$+ " PLEASE RETYPE LINE"
4635 ON F1 GO TO 4070,4045
4640 X$=MID$(A$,X1,4)
4645 REM THIS SHOULD BE THE YEAR TO BE SKIPPED
4650 REM CHECK FOR NON NUMERICS
4655 LET H$=X$
4660 GOSUB 4850
4665 IF F3=0 THEN 4675
4670 ON F1 GO TO 4070,4045
4675 S=VAL(X$)
4680 IF X7<>0 THEN 4700
4685 IF S>Y3+J THEN 4700
4690 PRINT "YEAR ";S;"PRIOR TO LAST YEAR INPUT, RETYPE LINE"
4695 ON F1 GO TO 4070,4045
4700 T=S-(Y3+J)
4705 IF J+T<=100 THEN 4720
4710 PRINT "YEAR  ";S;" OUT OF RANGE PLEASE RETYPE LINE"
4715 ON F1 GO TO 4070,4045
4720 ON F1 GO TO 4725,4740
4725 LET N=T
4730 GO TO 4410
4735 REM THIS IS FOR SEMI-ANNUAL MATURITIES
4740 IF Z1=(X1+3) GO TO 4765
4745 X7=INSTR(X1+4,A$,"1")
4750 IF X7<>0 THEN 4775
4755 X7=INSTR(X1+4,A$,"2")
4760 IF X7<>0 THEN 4805
4765 PRINT "IMPROPER INPUT FOR SEMI-ANNUAL MATURITIES RETYPE LINE"
4766 PRINT "CORRECT FORMAT -  SKIP TO 1969 1,C,Y    -"
4770 ON F1 GO TO 4070,4045
4775 Q1=1
4780 IF Q1=F2 THEN 4795
4785 N=T*2-1
4790 GO TO 4410
4795 N=T*2
4800 GO TO 4410
4805 Q1=2
4810 IF Q1=F2 THEN 4795
4815 N=T*2+1
4820 GO TO 4410
4825 REM PRINT THE MATRIX CREATED
4830 FOR P=1 TO 15
4835 PRINT M(P,1),M(P,2),M(P,3),M(P,4)
4840 NEXT P
4845 GO TO 5655
4850 CHANGE H$ TO H
4855 H6=0
4860 FOR I=1 TO H(0)
4865 IF H(I)>57 THEN 4930
4870 IF H(I)<46 THEN 4930
4875 IF H(I)=47 THEN 4930
4880 IF H(I)=46 THEN 4890
4885 GO TO 4915
4890 IF H7<>1 THEN 4905
4895 PRINT "ILLEGAL DECIMAL POINT IN  "+H$
4900 GO TO 4935
4905 H6=H6+1
4910 IF H6>1 THEN 4895
4915 NEXT I
4920 F3=0
4925 GO TO 4940
4930 PRINT " ALPHABETIC CHARACTER ";CHR$(H(I))+"  IN "+H$
4935 F3=1
4940 RETURN
4945 PRINT "WHICH COLUMN";
4950 INPUT C$
4955 C6=LEN(C$)
4960 IF C6=0 GO TO 4825
4965 C$=LEFT$(C$,1)
4970 L9=INSTR(K2$,C$)
4975 IF C5(L9)=0 GO TO 4990
4980 PRINT "COLUMN "+C$+"  HAS ALREADY BEEN INPUT"
4985 GO TO 4945
4990 L9=L9+1
4995 IF L9<>0 GO TO 5010
5000 PRINT "ERROR IN LAST RESPONSE RETYPE"
5005 GO TO 4945
5010 J=1
5015 J1=1
5020 INPUT R$
5025 N=1
5030 F5=1
5035 P5=LEN(R$)
5040 IF P5=0 THEN 5645
5045 P=INSTR(R$,":")
5050 IF P<>0 THEN 5065
5055 PRINT R$ + "INCORRECT FORMAT  DOES NOT CONTAIN  COLON(:)"
5056 PRINT "AS A DELIMITER  RETYPE LINE"
5060 GO TO 5020
5065 R2$=MID$(R$,P+1,P5-P)
5070 IF P=1 THEN 5190
5075 R1$=LEFT$(R$,P-1)
5080 REM INTERPRET RIGHT HAND VERSION
5085 REM IF F1=2 THEN INPUT SHOULD BE IN SEMI-ANNUAL FORM
5090 ON F1 GO TO 5095,5360
5095 REM ANNUAL
5100 LET H$=R1$
5105 H7=1
5110 GOSUB 4850
5115 H7=0
5120 IF F3=0 GO TO 5130
5125 GO TO 5020
5130 R=VAL(R1$)
5135 IF R>=(Y3+J) THEN 5150
5140 PRINT "YEAR";R;" HAS ALREADY BEEN INPUT  RETYPE LINE"
5145 GO TO 5020
5150 T=R-(Y3+J)
5155 IF T=0 GO TO 5200
5160 FOR I=J1 TO J1+T-1
5165 IF M(I,1)<>0 THEN 5175
5170 M(I,1)=Y3+J
5175 J=J+1
5180 NEXT I
5185 J1=J1+T
5190 REM NOW AT CORRECT POINTER
5195 REM INTERPRET R2$
5200 K5=INSTR(R2$,"X")
5205 IF K5=0 GO TO 5265
5210 R3$=LEFT$(R2$,K5-1)
5215 LET H$=R3$
5220 H7=1
5225 GOSUB 4850
5230 H7=0
5235 IF F3=0 GO TO 5245
5240 GO TO 5020
5245 N=VAL(R3$)
5250 IF N<=100 GO TO 5275
5255 PRINT R3$+" IS TOO LARGE A MULTIPLE RETYPE LINE"
5260 GO TO 5020
5265 N=1
5270 K5=0
5275 K6=LEN(R2$)
5280 K7=K6-K5
5285 R4$=RIGHT$(R2$,K7)
5290 LET H$=R4$
5295 GOSUB 4850
5300 IF F3=0 GO TO 5310
5305 GO TO 5020
5310 R4=VAL(R4$)
5315 ON F1 GO TO 5320,5630
5320 FOR I=J1 TO J1+N-1
5325 IF M(I,1)<>0 GO TO 5335
5330 M(I,1)=Y3+J
5335 M(I,L9)=R4
5340 J=J+1
5345 NEXT I
5350 J1=J1+N
5355 GO TO 5020
5360 REM THIS IS FOR SEMI-ANNUA MATURITIES
5365 REM INTERPRET R1$ - SHOULD BE IN FORM 1969 1
5370 B1=INSTR(R1$," ")
5375 IF B1<>0 THEN 5395
5380 PRINT R1$+" IS THE WRONG FORMAT FOR SEMI-ANNUAL MATURITIES RETYPE"
5385 PRINT " CORRECT FORMAT IS 1969 1"
5390 GOTO 5020
5395 R3$=LEFT$(R1$,B1-1)
5400 LET H$=R3$
5405 H7=1
5410 GOSUB 4850
5415 H7=0
5420 IF F3=0 THEN 5430
5425 GO TO 5020
5430 R=VAL(R3$)
5435 IF R>=(Y3+J) THEN 5445
5440 GO TO 5140
5445 K5=LEN(R1$)
5450 K6=K5-B1
5455 IF K6<>0 THEN 5465
5460 GO TO 5380
5465 R4$=RIGHT$(R1$,K6)
5470 IF R4$="1" GO TO 5485
5475 IF R4$="2" GO TO 5495
5480 GO TO 5380
5485 Q1=1
5490 GO TO 5500
5495 Q1=2
5500 T=R-(Y3+J)
5505 IF T<>0 THEN 5525
5510 IF Q1=F2 THEN 5625
5515 N=1
5520 GO TO 5565
5525 IF Q1=F2 THEN 5545
5530 IF Q1>F2 THEN 5555
5535 N=T*2-1
5540 GO TO 5560
5545 N=T*2
5550 GO TO 5560
5555 N=T*2+1
5560 K1=F2
5565 FOR I=J1 TO J1+N-1
5570 IF M(I,1)<>0 THEN 5580
5575 M(I,1)=Y3+J
5580 IF F5=1 GO TO 5590
5585 M(I,L9)=R4
5590 K1=K1+1
5595 IF K1=2 THEN 5610
5600 K1=1
5605 J=J+1
5610 NEXT I
5615 J1=J1+N
5620 ON F5 GO TO 5625,5640
5625 GO TO 5190
5630 F5=F5+1
5635 GO TO 5560
5640 GO TO 5020
5645 C5(L9-1)=1
5650 GO TO 4945
5655 END
    