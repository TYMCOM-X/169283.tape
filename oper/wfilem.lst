WFILEM.F4	F40	V26(10)	15-MAY-73	15:24	PAGE 1


  		      C****************************************************************
WFILEM.F4	F40	V26(10)	15-MAY-73	15:24	PAGE 2


  		      C*     COPYRIGHT        TEKTRONIX, INC    1973
  		      C*                       BEAVERTON, OREGON
  		      C*     PLOT-10/DECISION MAKER RELEASE 1.0 - VERSION 1
  		      C*               MODIFICATION LEVEL 0
  		      C****************************************************************
  		            SUBROUTINE  WFILEM
  		      C
  		            COMMON /GAMA1/ IFNAME, WA(2560),IFILE3(2560)
  		            INTEGER WA
  		            DIMENSION FWA (1)
  		            EQUIVALENCE (FWA(1),WA(1))
  		      C
  		            INTEGER CWFI(7),EWFN(6),FNAA(8),FSIF(8),ENOS(14),SINI(8),NWFI(6)
  		            INTEGER ENWF(7)
  		      C
  		            DIMENSION IDIR1(40),IDIR2(40),IDIR3(40)
  		            DIMENSION NSEG1(2),NSEG2(2)
  		            DIMENSION FILE3 (1)
  		            EQUIVALENCE (FILE3(1),IFILE3(1))
  		      C
  		            DATA CWFI /
  		           *	4HCURR, 4HENT , 4HWORK, 4H FIL, 4HE IS, 4H :  , 4H     /
  		            DATA EWFN /
  		           *	4HENTE, 4HR WO, 4HRK F, 4HILE , 4HNAME, 4H :   /
  		            DATA FNAA /
  		           *	4HFILE, 4H NAM, 4HES A, 4HRE  , 4H    , 4H -AN, 4HD-  , 4H     /
  		            DATA FSIF/
  		           *	4HFILE, 4H SEG, 4HMENT, 4HS IN, 4H FIL, 4HE   , 4H    , 4H ARE /
  		            DATA ENOS /
  		           *	4HENTE, 4HR NA, 4HMES , 4HOF S, 4HEGME, 4HNTS , 4HFOR , 4HTHE ,
  		           *	4HNEW , 4HWORK, 4H FIL, 4HE FR, 4HOM  , 4H     /
  		            DATA SINI /
  		           *	4HSEGM, 4HENT , 4H    , 4H IS , 4HNOT , 4HIN F, 4HILE , 4H     /
  		            DATA NWFI /
  		           *	4HNEW , 4HWORK, 4H FIL, 4HE IS, 4H FUL, 4HL    /
  		            DATA ENWF /
  		           *	4HENTE, 4HR NE, 4HW WO, 4HRK F, 4HILE , 4HNAME , 4H :   /
  		            DATA  NSEG1(2), NSEG2(2) / 2*4H  =   /
  		            DATA  IDOLLR, IBLANK  / 4H$    , 4H      /
  		      C-----
  		            CALL NEWPAG
  		            CALL WRITEL (IBLANK, 0)
  		      C
  		      C			. GET TWO FILE NAMES
  		            CWFI (7) = IFNAME
  		            CALL WRITEL (CWFI, 28)
  		            NAME1 = IFNAME
  		            NOFILE = 1
  		      C
  		            CALL WRITEL (EWFN, 24)
  		            READ (5,1000) NAME2
  		            IF( NAME2 .EQ. IDOLLR )  GO TO 99999
  		            IF( NAME2 .EQ. IBLANK )  GO TO 100
WFILEM.F4	F40	V26(10)	15-MAY-73	15:24	PAGE 3


  		      C
  		            NOFILE = 2
  		            FNAA (5) = NAME1
  		            FNAA (8) = NAME2
  		            CALL WRITEL (FNAA, 32)
  		      C
  		            CALL WRITEL (EWFN, 24)
  		            READ (5,1000) NAMEN
  		            IF( NAMEN .EQ. IDOLLR )  GO TO 99999
  		            IF( NAMEN .EQ. IBLANK )  GO TO 100
  		      C
  		            NAME1 = NAME2
  		            NAME2 = NAMEN
  		            FNAA (5) = NAME1
  		            FNAA (8) = NAME2
  		            CALL WRITEL (FNAA, 32)
  		      C-----
  		      100   CONTINUE
  		      C			. GET NEW FILE NAME
  		            CALL WRITEL (ENWF, 28)
  		            READ (5,1000) NAME3
  		            IF( NAME3 .EQ. IDOLLR )  GO TO 99999
  		            IF( NAME3 .EQ. IBLANK )  NAME3 = NAME1
  		            NSAME = 0
  		            IF(NAME3 .EQ. NAME1  .OR.  NAME3 .EQ. NAME2)  NSAME = 1
  		            CALL ERASE
  		            CALL WRITEL (IBLANK,0)
  		      C-----
  		      C			. DISPLAY SEGMENTS IN FIRST FILE
  		            IFNAME = NAME1
  		            CALL READER
  		            CALL SEGDIR (IDIR1, I1)
  		            FSIF(7) = NAME1
  		            CALL WRITEL (FSIF, 32)
  		      C
  		            DO 130 I = 1, I1
  		            CALL WRITEL (IDIR1(I), 4)
  		      130   CONTINUE
  		      C
  		      C-----
  		      C			. DISPLAY SEGMENTS IN SECOND FILE
  		            IF( NOFILE .EQ. 1 )  GO TO 160
  		            IFNAME = NAME2
  		            CALL READER
  		            CALL SEGDIR (IDIR2, I2)
  		            FSIF (7) = NAME2
  		            CALL WRITEL (FSIF, 32)
  		      C
  		            DO 150 I = 1, I2
  		            CALL WRITEL (IDIR2 (I), 4)
  		      150   CONTINUE
  		      C
  		      C-----
WFILEM.F4	F40	V26(10)	15-MAY-73	15:24	PAGE 4


  		      160   CONTINUE
  		            NEWPTR = 0
  		            IF( NSAME  .EQ.  0 )  GO TO 180
  		      C			. APEND TO AN EXISTING FILE
  		            IFNAME = NAME3
  		            CALL READER
  		            CALL SEGDIR (IDIR3, I3)
  		            CALL SEGGET (IDIR3(I3), IWPTR)
  		            NEWPTR = FWA(IWPTR - 2) - 1
  		      C
  		            DO 170 I = 1, 2560
  		            IFILE3 (I) = WA(I)
  		      170   CONTINUE
  		      C-----
  		      180   CONTINUE
  		      C			. SELECT SEGMENTS FROM FIRST FILE
  		            IFNAME = NAME1
  		            CALL READER
  		            ENOS (14) = NAME1
  		            CALL WRITEL (ENOS, 56)
  		      C
  		      210   CONTINUE
  		            CALL WRITEL (IBLANK, 1)
  		            READ (5,1000) NSEG1(1)
  		            IF( NSEG1(1) .EQ. IDOLLR )  GO TO 99999
  		            IF( NSEG1(1) .EQ. IBLANK )  GO TO 300
  		            CALL WRITEL (NSEG1, 8)
  		            READ (5,1000) NSEGR
  		      C
  		            DO 220 I = 1, I1
  		            IF( IDIR1 (I) .EQ. NSEG1(1) )  GO TO 230
  		      220   CONTINUE
  		      C
  		      222   CONTINUE
  		            SINI (3) = NSEG1(1)
  		            SINI (8) = NAME1
  		            CALL WRITEL (SINI, 32)
  		            GO TO 210
  		      C
  		      230   CONTINUE
  		            CALL SEGGET (NSEG1, IWPTR)
  		            IF( IWPTR .LE. 0 )  GO TO 222
  		      C
  		            IF( NSEGR .EQ. IBLANK )  GO TO 240
  		            WA (IWPTR+2) = NSEGR
  		      240   CONTINUE
  		      C
  		            IST = IWPTR - 2
  		            LIMIT = FWA (IST) - 1
  		            ITEST = (LIMIT - IST + 1) + (NEWPTR + 1)
  		            IF( ITEST .LE. 2560 )   GO TO 250
  		            ITEST = -1
  		            GO TO 400
WFILEM.F4	F40	V26(10)	15-MAY-73	15:24	PAGE 5


  		      250   CONTINUE
  		      C
  		            K = 0
  		            DO 260 I = IST, LIMIT
  		            K = K + 1
  		            IFILE3 (NEWPTR + K) = WA (I)
  		      260   CONTINUE
  		      C
  		            LINK = NEWPTR + K + 1
  		            FILE3 (NEWPTR + 1) = LINK
  		            NEWPTR = LINK - 1
  		            GO TO 210
  		      C-----
  		      C
  		      300   CONTINUE
  		      C			. SELECT SEGMENTS FROM SECOND FILE
  		            IF( NOFILE .EQ. 1 )  GO TO 400
  		            IFNAME = NAME2
  		            CALL READER
  		            ENOS (14) = NAME2
  		            CALL WRITEL (ENOS, 56)
  		      C
  		      320   CONTINUE
  		            CALL WRITEL (IBLANK, 1)
  		            READ (5,1000) NSEG2(1)
  		            IF( NSEG2(1) .EQ. IDOLLR )  GO TO 99999
  		            IF( NSEG2 (1) .EQ. IBLANK )  GO TO 400
  		            CALL WRITEL (NSEG2, 8)
  		            READ (5,1000) NSEGR
  		      C
  		            DO 325 I = 1, I2
  		            IF( IDIR2 (I) .EQ. NSEG2(1) )  GO TO 330
  		      325   CONTINUE
  		      C
  		      326   CONTINUE
  		            SINI (3) = NSEG2(1)
  		            SINI (8) = NAME2
  		            CALL WRITEL (SINI,32)
  		            GO TO 320
  		      C
  		      330   CONTINUE
  		            CALL SEGGET (NSEG2, IWPTR)
  		            IF( IWPTR .LE. 0 )  GO TO 326
  		      C
  		            IF( NSEGR .EQ. IBLANK )  GO TO 340
  		            WA (IWPTR+2) = NSEGR
  		      340   CONTINUE
  		      C
  		            IST = IWPTR - 2
  		            LIMIT = FWA (IST) - 1
  		            ITEST = (LIMIT - IST + 1) + (NEWPTR + 1)
  		            IF( ITEST .LE. 2560 )  GO TO 350
  		            ITEST = -1
WFILEM.F4	F40	V26(10)	15-MAY-73	15:24	PAGE 6


  		            GO TO 400
  		      C
  		      350   CONTINUE
  		            K = 0
  		            DO 360 I = IST, LIMIT
  		            K = K + 1
  		            IFILE3 (NEWPTR + K) = WA (I)
  		      360   CONTINUE
  		      C
  		            LINK = NEWPTR + K + 1
  		            FILE3 (NEWPTR + 1) = LINK
  		            NEWPTR = LINK - 1
  		            GO TO 320
  		      C-----
  		      C			. FINAL OPERATIONS
  		      400   CONTINUE
  		            CALL NEWPAG
  		            CALL WRITEL (IBLANK, 0)
  		            IFILE3 (NEWPTR + 1) = 0
  		      C
  		            DO 410 I = 1, 2560
  		            WA (I) = IFILE3 (I)
  		      410   CONTINUE
  		      C
  		            CWFI (7) = NAME3
  		            CALL WRITEL (CWFI, 28)
  		      C
  		            CALL SEGDIR (IDIR3, I3)
  		            FSIF(7) = NAME3
  		            CALL WRITEL (FSIF, 32)
  		      C
  		            DO 420 I = 1, I3
  		            CALL WRITEL (IDIR3(I), 4)
  		      420   CONTINUE
  		      C
  		            IFNAME = NAME3
  		            CALL WRITER
  		            IF( ITEST .EQ. -1 )  CALL WRITEL (NWFI,24)
  		      C
  		            READ (5,1000) DUMMY
  		      99999 CONTINUE
  		            CALL NEWPAG
  		            RETURN
  		      C-----
  		      C
  		      1000  FORMAT (A4)
  		            END

CONSTANTS

0	000000000000	1	000000000034	2	000000000030	3	000000000040	4	000000000004
5	000000000070	6	000000000001	7	000000000010	

WFILEM.F4	F40	V26(10)	15-MAY-73	15:24	PAGE 7


COMMON

IFNAME	/GAMA1 /+0	WA    	/GAMA1 /+1	IFILE3	/GAMA1 /+5001	FWA   	/GAMA1 /+1	FILE3 	/GAMA1 /+5001

SUBPROGRAMS

NEWPAG	WRITEL	ERASE 	READER	SEGDIR	SEGGET	INT   	FLOAT 	WRITER	ALPHO.	ALPHI.	

SCALARS

WFILEM	654		IDOLLR	655		IBLANK	656		IFNAME	0		NAME1 	657	
NOFILE	660		NAME2 	661		NAMEN 	662		NAME3 	663		NSAME 	664	
I1    	665		I     	666		I2    	667		NEWPTR	670		I3    	671	
IWPTR 	672		NSEGR 	673		IST   	674		LIMIT 	675		ITEST 	676	
K     	677		LINK  	700		DUMMY 	701		

ARRAYS

WA    	1		IFILE3	5001		FWA   	1		CWFI  	702		EWFN  	711	
FNAA  	717		FSIF  	727		ENOS  	737		SINI  	755		NWFI  	765	
ENWF  	773		IDIR1 	1002		IDIR2 	1052		IDIR3 	1122		NSEG1 	1172	
NSEG2 	1174		FILE3 	5001		

 WFILEM
  