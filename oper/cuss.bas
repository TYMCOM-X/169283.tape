1 DIMA(60),B(60),C(60),D(60),E(60),I(60),N(60),S(60),X(60),Y(60),Z(60)
2 DIMW(60,19),F(100),G(100),H(100),J(6,2),K(6,6),L(10,10),O(6,2),P(6,6)
3 DIMQ(6,4),R(6,3),T(6,5),U(6,8),V(6,4),A$(6),B$(6),C$(13),M(6,6)
4 DIMG$(10),H$(8)
5 FORE=1TO10
6 READG$(E)
7 NEXTE
8 FORF=1TO8
9 READH$(F)
10 NEXTF
11 FORE=1TO10
12 READL(9,E)
13 NEXTE
20 DATA"TAPED"
21 DATA"BAR        #6-4/0     4     30-5347"
22 DATA"BAR        #6-4/0     5     30-5361"
23 DATA"BAR        #6-4/0     6     30-5363"
24 DATA"BAR        #6-350     4     30-5372"
25 DATA"BAR        #6-350     5     30-5373"
26 DATA"BAR        #6-350     6     30-5374"
27 DATA"BL BUS     #2-350     8     30-3781"
28 DATA"BL BUS    4/0-750     6     30-3568"
29 DATA"BL BUS     #2-750     8     30-3782"
30 DATA"#2AL-1/0AL     38-2049"
31 DATA"2/0CU-4/0AL    38-2050"
32 DATA"250CU-350AL    38-2051"
33 DATA"4/0AL          38-2065"
34 DATA"350AL-500CU    38-2056"
35 DATA"700AL-750CU    38-2057"
36 DATA"TERM COVERS    CAT #LO"
37 DATA"TERM COVERS    CAT #HO1"
38 DATA0,7.5,7.8,8.0,8.7,9.1,9.6,26.9,51.3,41.0
60 DATA68.64,199.12,52,46.4,138.5,154.5,110,104,.0624,.0676,1109
61 DATA598,1370," 25 KVA    "
62 DATA45.47,132.18,34.4,30.8,91.8,102.8,152,143,.0402,.0434,1234
63 DATA672,1445,"37.5KVA    "
64 DATA32.19,94.69,22,25.6,58.6,85.2,185,168,.0279,.0306,1300
65 DATA724,1565," 50 KVA    "
66 DATA21.41,63.11,14.65,17,39.1,56.7,255,243,.017,.0189,1561
67 DATA955,1860," 75 KVA    "
68 DATA16.07,47.3,11,12.75,29.3,42.5,312,305,.0119,.0143,1766
69 DATA1079,2063,"100 KVA    "
70 DATA14.08,43.12,6.9,15.6,18.5,52,393,416,.00811,.00784,2330
71 DATA1451,2544,"167 KVA    "
72 DATA2.572,2.572,2.82,.332,2.82,.332,1.22,.424,.526,"#2"
73 DATA1.682,1.682,1.78,.321,1.78,.321,.77,.5,.642,"1/0"
74 DATA1.299,.9148,1.337,.3075,.894,.294,.388,.670,.898,"4/0"
75 DATA.7663,.618,.7225,.289,.551,.284,.238,.913,1.381,"350"
76 DATA.3831,.309,.3612,.1445,.2755,.142,.119,1.826,2.762,"P350"
77 DATA.2554,.206,.2408,.0963,.1837,.0947,.08,2.739,4.143,"T350"
78 DATA" ","13X24","17X30","24X36","30X48","13*24","17*30","24*36"
79 DATA"30*48","  *  ",8.3,5.5,4.05,2.65,2,1.8,.1072,41.7,27.5,27.2
80 DATA13.2,.0701,52.9,36.7,36.8,21.1,.0381,77.7,56.1,57.1,40.2,.0258
81 DATA103,87.6,79.2,79.2,.0129,181,162,130,130,.0086,264,231,180,180
82 DATA7.5,5,3.6,2.3,1.7,1.4,.116,46.2,31.2,32.9,13.2,.0746,58.6,41.5
83 DATA44.6,21.1,.0392,86,63.6,69.6,40.2,.0255,114,98.2,96.2,87.6
84 DATA.0127,200,184,165,153,.0085,293,262,220,220
85 DATA382,312,295,382,312,295,446,357,338,446,357,338
86 DATA434,391,372,434,391,372,669,536,510,669,536,510
87 DATA762,625,594,762,625,594,892,715,680,892,715,680
88 DATA1050,830,790,955,755,720,1338,1072,1020,1215,975,925
89 DATA1590,1325,1260,1325,1105,1050,1785,1430,1360,1490,1190,1135
90 DATA2550,2080,1985,1960,1600,1525,2980,2385,2275,2290,1830,1750
91 DATA0
92 DATA0
93 DATA0,0
94 DATA0
95 DATA0
96 DATA0,1.2,12,10
97 DATA1,0,35
98 DATA1,6,2,0
99 DATA50,.85,.85,7.5,8,6
300 DATA"TRANSFORMER IDENTIFICATION MISSING OR OUT OF SEQUENCE",9999
301 DATA"TRANSFORMER IDENTIFICATION MISSING OR OUT OF SEQUENCE",9999
302 DATA"TRANSFORMER IDENTIFICATION MISSING OR OUT OF SEQUENCE",9999
303 D$="TRANSFORMER IDENTIFICATION MISSING OR OUT OF SEQUENCE"
304 F$=""
305 FORT=1TO6
306 READK(T,1),K(T,2),K(T,3),K(T,4),K(T,5),K(T,6),M(T,1),M(T,3),R(T,1)
307 READR(T,3),T(T,1),T(T,3),T(T,4),A$(T)
308 NEXTT
309 FORS=1TO6
310 READP(S,1),P(S,2),P(S,3),P(S,4),P(S,5),P(S,6)
311 READR(S,2),T(S,2),T(S,5),B$(S)
312 NEXTS
313 FORX=1TO10
314 READC$(X)
315 NEXTX
316 FORU=2TO1STEP-1
317 FORT=1TO6
318 READJ(T,U)
319 NEXTT
320 FORS=1TO6
321 READO(S,U),Q(S,U),Q(S,U+2),V(S,U),V(S,U+2)
322 NEXTS
323 NEXTU
324 FORT=1TO6
325 READL(T,3),L(T,4),L(T,5),L(T,6),L(T,7),L(T,8)
326 READU(T,3),U(T,4),U(T,5),U(T,6),U(T,7),U(T,8)
327 NEXTT
328 READP1,P3,O4,O2,O7,Q9,S1,S2,S3,S4,F7,F8,F9
329 READM7,M,Z8,Z1,J1,H1,I1,Z5,Z6,Z7
330 READA1,P2,F1,B1,M9,C1,D1,E1,K1,W5
331 K1=K1+P1
332 IFP3=0THEN379
333 IFZ1=1THEN882
334 IFP3=1THEN355
335 P(5,1)=.4982
336 P(5,2)=.3784
337 P(5,3)=.4135
338 P(5,4)=.279
339 P(5,5)=.276
340 P(5,6)=.273
341 R(5,2)=.119
342 T(5,2)=1.44
343 T(5,5)=2.00
344 B$(5)="700"
345 O(5,1)=.0145
346 O(5,2)=.0158
347 Q(5,1)=169
348 Q(5,2)=153
349 Q(5,3)=150
350 Q(5,4)=132
351 V(5,1)=149
352 V(5,2)=122
353 V(5,3)=149
354 V(5,4)=122
355 P(6,1)=.2491
356 P(6,2)=.1892
357 P(6,3)=.2068
358 P(6,4)=.1395
359 P(6,5)=.138
360 P(6,6)=.1365
361 R(6,2)=.06
362 T(6,2)=2.88
363 T(6,5)=4.00
364 B$(6)="P700"
365 O(6,1)=.00724
366 O(6,2)=.00789
367 Q(6,1)=146
368 Q(6,2)=132
369 Q(6,3)=276
370 Q(6,4)=245
371 V(6,1)=254
372 V(6,2)=206
373 IFP3=1THEN377
374 V(6,3)=149
375 V(6,4)=122
376 GOTO379
377 V(6,3)=134
378 V(6,4)=130
379 IFZ1=0THEN388
380 FORS=1TO6
381 Q(S,U)=Q(S,U+2)
382 T(S,2)=T(S,5)
383 NEXTS
388 FORT=1TO6
389 IFP2=2THEN403
390 ONA1GOTO391,394,397,400,391,397
391 L(T,2)=L(T,7)
392 U(T,2)=U(T,7)
393 GOTO415
394 L(T,2)=L(T,4)
395 U(T,2)=U(T,4)
396 GOTO415
397 L(T,1)=L(T,6)
398 U(T,1)=U(T,6)
399 GOTO415
400 L(T,1)=L(T,3)
401 U(T,1)=U(T,3)
402 GOTO415
403 ONA1GOTO404,407,410,413,404,410
404 L(T,2)=L(T,8)
405 U(T,2)=U(T,8)
406 GOTO415
407 L(T,2)=L(T,5)
408 U(T,2)=U(T,5)
409 GOTO415
410 L(T,1)=L(T,6)
411 U(T,1)=U(T,6)
412 GOTO415
413 L(T,1)=L(T,3)
414 U(T,1)=U(T,3)
415 NEXTT
416 ONA1GOTO423,423,423,423,417,419
417 A1=2
418 GOTO420
419 A1=4
420 FORT=1TO6
421 T(T,3)=T(T,4)
422 NEXTT
423 ONA1GOTO424,427,430,433
424 Q3=1
425 U=2
426 GOTO435
427 Q3=0
428 U=2
429 GOTO435
430 Q3=1
431 U=1
432 GOTO435
433 Q3=0
434 U=1
435 IFJ1<>50THEN438
436 IFH1<>.85THEN438
437 GOTO444
438 FORS=1TO6
439 P(S,1)=J1/50*(P(S,3)*H1+P(S,4)*(1-H1*H1)^.5)
440 NEXTS
441 FORT=1TO6
442 K(T,1)=J1/50*(K(T,3)*H1+K(T,4)*(1-H1*H1)^.5)
443 NEXTT
444 IFI1<>.85THEN446
445 GOTO452
446 FORS=1TO6
447 P(S,2)=P(S,5)*I1+P(S,6)*(1-I1*I1)^.5
448 NEXTS
449 FORT=1TO6
450  K(T,2)=       (K(T,5)*I1+K(T,6)*(1-I1*I1)^.5)
451 NEXTT
452 IFM9>0THEN454
453 M9=1
454 M8=ABS(M7/2)+M7/2
455 U=1
456 IFA1>2THEN458
457 U=2
458 A9=B1-C1
459 FORN=1TO100
460 IFF7<3THEN463
461 F(N)=G(N)=H(N)=0
462 GOTO480
463 IFU=1THEN465
464 GOTO472
465 A7=SIN((A9+225)*.008976)
466 A5=.645*A7+1.745
467 B5=.7*A7+1.05
468 C5=4.43-.0134*A9
469 A8=A5-B5*EXP(-N/C5)
470 F(N)=N/.95/A8*(.08568*A9+10.452*(1-EXP(-A9/40)))
471 GOTO477
472 A7=SIN((A9+25)*.0377)
473 A5=A7+2.31
474 B5=1.18*A7+1.53
475 A8=A5-B5*EXP(-N/6.5)
476 F(N)=N/.85/A8*(.05655*A9+11.588*(1-EXP(-A9/30)))
477 F(N)=F(N)*M9+D1*N
478 G(N)=B1*N
479 H(N)=F1*N
480 NEXTN
481 PRINTF$
482 READZ$
483 FORB=1TO60
484 READH
485 IFB>1THEN487
486 IFH<>1THEN867
487 IFB<>2THEN489
488 IFH<>102THEN867
489 IFH>9997THEN513
490 ONF7GOTO491,494,496
491 READW(B,12),D(B)
492 W(B,13)=0
493 GOTO498
494 READW(B,12),D(B),W(B,13)
495 GOTO498
496 READD(B),W(B,13)
497 W(B,12)=0
498 IFB>1THEN501
499 S8=D(1)
500 D(1)=1
501 IFF8=0THEN507
502 IFB>1THEN506
503 READT
504 T1=T
505 GOTO507
506 READS(B)
507 N(B)=W(B,7)=0
508 B2=B
509 IFB=60THEN875
510 A(B)=INT(H/100)
511 IFH-A(B)*100<>BTHEN877
512 NEXTB
513 FORB=B2TO1STEP-1
514 IFQ9=0THEN518
515 N(B)=W(B,12)
516 W(B,7)=W(B,13)
517 GOTO523
518 N(B)=W(B,12)+N(B)
519 W(B,7)=W(B,13)+W(B,7)
520 IFB=1THEN524
521 N(A(B))=N(B)+N(A(B))
522 W(A(B),7)=W(B,7)+W(A(B),7)
523 NEXTB
524 FORB=1TOB2
525 IFN(B)+D(B)+W(B,7)+S(B)+T>9997THEN867
526 IFN(1)>100THEN871
527 IFB>1THEN548
528 ONUGOTO529,531
529 Z9=W(B,7)/(.1467-7.109*F9/10000)
530 GOTO535
531 ONP2GOTO532,534
532 Z9=W(B,7)/(.15818-7.007*F9/10000)
533 GOTO535
534 Z9=W(B,7)/(.1577-6.838*F9/10000)
535 W(B,7)=W(B,7)+F(N(B))
536 IFF8=1THEN570
537 FORT=1+O4/2+O2/2+ABS(O4/2-O2/2)TO7
538 IFT=7THEN873
539 IFH(N(B))+Z9<=L(T-O4/2-O2/2-ABS(O4/2-O2/2),U)THEN541
540 NEXTT
541 T1=T
542 FORT=1+O2TO7
543 IFT=7THEN862
544 IFG(N(B))+Z9<=U(T-O2,U)THEN546
545 NEXTT
546 T2=T/2-T1/2+ABS(T/2-T1/2)
547 GOTO570
548 W(B,7)=W(B,7)+F(N(B))
549 IFB<2+Q3THEN554
550 D(B)=D(B)+P1
554 IFF8=1THEN570
555 FORS=1TO7
556 IFS=7THEN869
557 S(B)=S
558 IFB<>1+Q3THEN561
559 IFW(B,7)<Q(S,U)THEN570
560 GOTO569
561 IFS(B)>MTHEN864
562 ONM7+2GOTO563,565,563
563 IFW(B,7)>Q(S,U)THEN569
564 GOTO566
565 IFW(B,7)>V(S,U)THEN569
566 ONM7+2GOTO567,567,570
567 IFW(B,7)<V(S,U+2)*(1.1+.25*Z1)THEN570
568 IFS(B)=MTHEN570
569 NEXTS
570 IFF8=0THEN572
571 T2=0
572 NEXTB
573 R7=0
574 R8=1+Q3
575 IFF8=1THEN669
576 X7=0
577 FORD=B2TO2+Q3STEP-1
578 W(D,8)=0
579 IFX7=1THEN581
580 W(D,8)=1
581 X7=D-A(D)
582 NEXTD
583 D1=X8=0
584 FORD=2+Q3TOB2
585 IFD>2THEN589
586 IFW(2,7)<W(1,7)THEN589
587 IFD(2)>30THEN589
588 GOTO618
589 W(D,9)=W(D,10)=W(D,11)=0
590 X9=0
591 IFW(D,8)<>1THEN618
592 X8=X8+1
593 B3=D
594 FORB=B3TO1STEP-1
595 IFX9<>0THEN607
596 IFB=1THEN600
597 X4=0
598 X5=1
599 GOTO602
600 X4=1
601 X5=0
602 W(B3,9)=W(B3,9)+W(B,7)*D(B)*(X4*J(T,U)+X5*O(S(B),U))/100
603 W(B3,10)=W(B3,10)+D(B)*(X4*K(T-T2,1)+X5*P(S(B),1))/100
604 W(B3,11)=W(B3,11)+E1*D(B)*(X4*K(T-T2,2)+X5*P(S(B),2))/10000
605 IFA(B)=B-1THEN608
606 X9=B-A(B)
607 X9=X9-1
608 NEXTB
609 IFW(B3,9)+.5>W(B3,10)THEN613
610 IFW(B3,11)>W(B3,10)THEN614
611 W(B3,9)=W(B3,11)=0
612 GOTO617
613 IFW(B3,9)+.5>W(B3,11)THEN616
614 W(B3,9)=W(B3,10)=0
615 GOTO617
616 W(B3,10)=W(B3,11)=0
617 D1=1
618 NEXTD
619 IFD1=0THEN669
620 D2=D4=0
621 FORD=2+Q3TOB2
622 IFD>2THEN626
623 IFW(2,7)<W(1,7)THEN626
624 IFD(2)>30THEN626
625 GOTO632
626 IFW(D,8)<>1THEN632
627 D3=W(D,9)+SGN(W(D,9))*(8-Z5)+W(D,10)+SGN(W(D,10))*(8-Z6)
628 D3=D3+W(D,11)+SGN(W(D,11))*(8-Z6)
629 IFD2>D3THEN632
630 D2=D3
631 D4=D
632 NEXTD
633 D5=D6=D7=0
634 IFW(D4,9)<>0THEN640
635 IFW(D4,10)<>0THEN638
636 D7=1
637 GOTO641
638 D6=1
639 GOTO641
640 D5=1
641 D8=D9=X9=0
642 FORB=D4TO2+Q3STEP-1
643 IFB>2THEN647
644 IFW(2,7)<W(1,7)THEN647
645 IFD(2)>30THEN647
646 GOTO658
647 IFX9<>0THEN657
648 IFS(B)=MTHEN655
649 IFN(B)<>1THEN651
650 IFS(B)=Z8THEN655
651 D1=W(B,7)*O(S(B),U)/100*D5+P(S(B),1)/100*D6+P(S(B),2)/10000*D7*E1
652 IFD9>D1THEN655
653 D9=D1
654 D8=B
655 IFA(B)=B-1THEN658
656 X9=B-A(B)
657 X9=X9-1
658 NEXTB
659 IFD8=0THEN669
660 D5=D5*D(D8)*W(D8,7)*(O(S(D8),U)-O(S(D8)+1,U))/100
661 D6=D6*D(D8)*(P(S(D8),1)-P(S(D8)+1,1))/100
662 D7=D7*D(D8)*E1*(P(S(D8),2)-P(S(D8)+1,2))/10000
663 IFD2-D5-D6-D7<7.6+16/(B2+X8) THEN 667
664 S(D8)=S(D8)+1
665 PRINT"*";
666 GOTO583
667 W(D4,8)=2
668 GOTO583
669 FORB=1TOB2
670 I(B)=0
671 NEXTB
672 X7=O1=0
673 FORD=B2TO1STEP-1
674 IFX7=1 THEN747
675 B3=D
676 FORB=2TOB2
677 IFA(B)=B3THEN879
678 NEXTB
679 B(D)=C(D)=E(D)=X9=0
680 FORB=B3TO1STEP-1
681 IFX9<>0THEN694
682 IFB=1THEN686
683 X4=0
684 X5=1
685 GO TO 688
686 X4=1
687 X5=0
688 B(B3)=B(B3)+W(B,7)*D(B)*(X4*J(T,U)+X5*O(S(B),U))/100
689 C(B3)=C(B3)+D(B)*(X4*K(T-T2,1)+X5*P(S(B),1))/100
690 E(B3)=E(B3)+E1*D(B)*(X4*K(T-T2,2)+X5*P(S(B),2))/10000
691 B5=B6=0
692 IFA(B)=B-1THEN695
693 X9=B-A(B)
694 X9=X9-1
695 NEXTB
696 IFB3=1THEN704
697 B5=D(B3)*P(S(B3),1)/100
698 B6=D(B3)*P(S(B3),2)*E1/10000
699 K6=K7=0
700 IFN(B3)=1THEN703
701 K6=1
702 GOTO704
703 K7=1
704 IFN(B3)<>1THEN707
705 C(A(B3))=C(B3)-B5
706 E(A(B3))=E(B3)-B6
707 X8=0
708 D2=B(B3)*.5-Z5*.5+ABS(B(B3)*.5-Z5*.5)
709 D4=(C(B3)*.5-Z6*.5+ABS(C(B3)*.5-Z6*.5))*K7
710 D5=(C(B3)*.5-Z7*.5+ABS(C(B3)*.5-Z7*.5))*K6
711 D6=(E(B3)*.5-Z6*.5+ABS(E(B3)*.5-Z6*.5))*K7
712 D7=(E(B3)*.5-Z7*.5+ABS(E(B3)*.5-Z7*.5))*K6
713 D8=((C(B3)-B5)*.5-Z7*.5+ABS((C(B3)-B5)*.5-Z7*.5))*K7
714 D9=((E(B3)-B6)*.5-Z7*.5+ABS((E(B3)-B6)*.5-Z7*.5))*K7
715 T8=T9=1
716 IFD2<>0THEN718
717 T8=0
718 IFD4+D5+D6+D7+D8+D9<>0THEN720
719 T9=0
720 IFT8+T9=0THEN722
721 O1=1
722 FORB=B3TO1STEP-1
723 IFX8<>0THEN745
724 IFB=1THEN730
725 IFS(B)=6THEN746
726 I1=I2=(O(S(B),U)-O(S(B)+1,U))*W(B,7)*D(B)/100
727 I3=(P(S(B),1)-P(S(B)+1,1))*D(B)/100
728 I4=(P(S(B),2)-P(S(B)+1,2))*E1*D(B)/10000
729 GO TO 736
730 X6=0
731 IFT=6THEN743
732 I1=0
733 I2=(J(T,U)-J(T+1,U))*W(B,7)/100
734 I3=(K(T-T2,1)-K(T-T2+1,1))/100
735 I4=(K(T-T2,2)-K(T-T2+1,2))*E1/10000
736 I(B)=I(B)+I1*.5+D2*.5-ABS(I1*.5-D2*.5)
737 I(B)=I(B)+I3*.5+D4*.5-ABS(I3*.5-D4*.5)
738 I(B)=I(B)+I3*.5+D5*.5-ABS(I3*.5-D5*.5)
739 I(B)=I(B)+I4*.5+D6*.5-ABS(I4*.5-D6*.5)
740 I(B)=I(B)+I4*.5+D7*.5-ABS(I4*.5-D7*.5)
741 I(B)=I(B)+I3*.5+D8*.5-ABS(I3*.5-D8*.5)
742 I(B)=I(B)+I4*.5+D9*.5-ABS(I4*.5-D9*.5)
743 IFA(B)=B-1THEN746
744 X8=B-A(B)
745 X8=X8-1
746 NEXTB
747 X7=D-A(D)
748 NEXTD
749 IFF8=1THEN1114
750 GOSUB907
751 GOSUB884
752 C3=C2
753 C4=G6
754 FORC=2+Q3TOB2
755 IFS(C)<6THEN759
756 Z(C)=1000
757 I(C)=0
758 GOTO766
759 S(C)=S(C)+1
760 GOSUB907
761 GOSUB884
762 Z(C)=(R(S(C),2)-R(S(C)-1,2))*W(C,7)*W(C,7)*D(C)/1000
763 Z(C)=Z(C)+(T(S(C),2)-T(S(C)-1,2))*D(C)+C2+G6-C3-C4
764 Z(C)=Z(C)+1
765 S(C)=S(C)-1
766 NEXTC
767 J3=J4=U9=0
768 J6=1
769 FORB=2+Q3TOB2
770 IFB=B2THEN773
771 IFA(B+1)<>BTHEN773
772 GOTO775
773 IFN(B)<>1THEN775
774 IFS(B)=Z8THEN796
775 IFB>2THEN780
776 IFW(2,7)<W(1,7)THEN782
777 IFD(2)>30THEN782
778 U9=1
779 GO TO 796
780 IFA(B)=1+Q3+U9THEN782
781 IFS(B)=S(A(B))THEN796
782 IFS(B)>=MTHEN796
783 J2=(I(B)+.0001)/(Z(B)*.5+.5+ABS(Z(B)*.5-.5))
784 IFZ(B)<=1THEN786
785 IFI(B)=0THEN796
786 IFJ2<=J4THEN793
787 J3=B
788 J4=J2
789 J6=Z(B)
790 GOTO796
791 PRINT"END OF DATA."
792 GO TO 1399
793 IFZ(B)>=J6THEN796
794 J3=B
795 J6=Z(B)
796 NEXTB
797 Y$="  "
798 IFJ3<>0 THEN 859
799 IFO1=0THEN801
800 Y$="VOLTAGE LIMITS NOT MET DUE TO CONDUCTOR SIZE LIMITATIONS"
801 X9=Z8
802 FORB=2+Q3 TO B2
803 IFB=B2 THEN 805
804 IFA(B+1)=BTHEN822
805 IFS(B)=1THEN822
806 IFW(B,7)>V(S(B)-1,U+2)*(1+.23*Z1)THEN822
807 D7=(O(S(B)-1,U)-O(S(B),U))*W(B,7)*D(B)/100
808 IFB(B)+D7>Z5THEN822
809 D8=(P(S(B)-1,1)-P(S(B),1))*D(B)/100
810 IFN(B)=1 THEN 812
811 IFC(B)+D8>Z7THEN822
812 IFC(B)+D8>Z6THEN822
813 D9=(P(S(B)-1,2)-P(S(B),2))*D(B)*E1/10000
814 IFN(B)=1 THEN 816
815 IFE(B)+D9>Z7THEN822
816 IFE(B)+D9>Z6THEN822
817 S(B)=S(B)-1
818 PRINT"-";
819 C(B)=C(B)+D8
820 E(B)=E(B)+D9
821 B(B)=B(B)+D7
822 NEXTB
823 ONM7+2GOTO856,856,824
824 IFW(2,7)=W(1,7)THEN826
825 GOTO856
826 IFD(2)<=30THEN828
827 GOTO856
828 O3=S(2)
829 ONX(2)+1GOTO856,830,834,838,856,830,834,838,856
830 IFS(2)>=3THEN848
831 IFW(2,7)<V(S(2),U+2)THEN848
832 S(2)=S(2)+1
833 GOTO830
834 IFS(2)>=4THEN848
835 IFW(2,7)<V(S(2),U+2)THEN848
836 S(2)=S(2)+1
837 GOTO834
838 IFP4>0THEN841
839 IFP5+P6+P7>=6THEN841
840 GOTO842
841 IFP4+P5+P6+P7>=8THEN848
842 IFW(2,7)<V(S(2),U+2)THEN848
843 IFS(2)=6THEN848
844 S(2)=S(2)+1
845 IFS(2)<=4THEN838
846 P6=P6+1
847 GOTO838
848 FORB=1TOB2
849 IFB(B)=0THEN851
850 B(B)=B(B)-W(2,7)*D(2)*(O(O3,U)-O(S(2),U))/100
851 IFC(B)=0THEN853
852 C(B)=C(B)-D(2)*(P(O3,1)-P(S(2),1))/100
853 IFE(B)=0THEN855
854 E(B)=E(B)-D(2)*(P(O3,2)-P(S(2),2))/10000
855 NEXTB
856 IFX9<=2THEN1114
857 X9=X9-1
858 GOTO802
859 S(J3)=S(J3)+1
860 PRINT"+";
861 GO TO 669
862 PRINT"LOAD TOO MUCH FOR 167 KVA TRANSFORMER"
863 GOTO1391
864 PRINT"LOAD EXCEEDS THERMAL LIMIT OF MAXIMUM SECONDARY SIZE"
865 PRINT"ON SECTION ";A(B);" TO ";B
866 GO TO 1391
867 PRINT"INCORRECT , MISSING , OR EXTRA DATA"
868 GOTO1391
869 PRINT"LOAD TOO MUCH FOR TRIPLE 350 MCM ALUMINUM"
870 GOTO1391
871 PRINT"NUMBER OF CUSTOMERS EXCEEDS SPECIFIED MAXIMUM"
872 GOTO1391
873 PRINT "INITIAL LOAD EXCEEDS ECONOMIC LIMIT OF 167KVA TRANSFORMER"
874 GOTO541
875 PRINT"BUS NUMBER EXCEEDS SPECIFIED MAXIMUM"
876 GOTO1391
877 PRINT"BUSSES NOT NUMBERED SEQUENTIALLY"
878 GOTO1391
879 PRINT
880 PRINT"ILLEGAL EXTENSION FROM END POINT AT BUS "B3;" -  RENUMBER"
881 GOTO1391
882 PRINT"700AL OPTION (92 DATA) NOT VALID WITH CIC OPTION (98 DATA)"
883 GOTO1391
884 G1=G2=G3=G4=G5=G6=G8=G9=0
885 FORE=2+Q3TOB2
886 IFN(E)=1THEN899
887 ONS(E)GOTO888,890,892,894,896,898
888 G1=20
889 GOTO899
890 G2=20
891 GOTO899
892 G3=20
893 GOTO899
894 G4=20
895 GOTO899
896 G5=20
897 GOTO899
898 G8=20
899 IFE=B2THEN903
900 IFE<>A(E+1)THEN903
901 G9=G1+G2+G3+G4+G5+G8-20
902 GOTO905
903 G6=G6+G9
904 G1=G2=G3=G4=G5=G8=G9=0
905 NEXTE
906 RETURN
907 FORB=2TOB2
908 FORS=1TO6
909 W(B,S)=X(B)=Y(B)=C2=0
910 NEXTS
911 NEXTB
912 FORE=1TO10
913 L(7,E)=L(8,E)=L(10,E)=0
914 NEXTE
915 FORB=2TOB2
916 IFB=B2THEN921
917 IFB<>A(B+1)THEN920
918 W(B,S(B))=W(B,S(B))+1
919 Y(B)=Y(B)+N(B)
920 IFB=2THEN923
921 W(A(B),S(B))=W(A(B),S(B))+1
922 Y(A(B))=Y(A(B))-N(B)
923 NEXTB
924 IFQ3=0THEN926
925 W(2,S(2))=W(2,S(2))-1
926 FORB=2TOB2
927 P4=P5=P6=P7=P8=P9=E=0
928 ONTGOTO929,929,929,931,931,933
929 P5=Q3*(3-B+ABS(3-B))/2
930 GOTO934
931 P7=Q3*(3-B+ABS(3-B))/2
932 GOTO934
933 P7=Q3*(3-B+ABS(3-B))
934 P4=Y(B)+W(B,1)+W(B,2)+P4
935 P5=W(B,3)+P5
936 N8=P3/2-.5+ABS(P3/2-.5)
937 N9=P3/2+.5-ABS(P3/2-.5)
938 P6=W(B,4)+(1-N8)*2*W(B,5)+(1-N9)*3*W(B,6)
939 P8=N8*W(B,5)+2*N9*W(B,6)
940 P9=P4+P5+P6+P7+P8
941 IFP7+P8=0THEN966
942 IFP4=0THEN954
943 X(B)=3
944 IFP4>4THEN1006
945 IFP7+P8>4THEN1006
946 IFP9>8THEN1006
947 IFP9<4THEN950
948 E=10
949 GOTO951
950 E=1
951 IFP7<2THEN1009
952 X(B)=4
953 GOTO1009
954 IFP5+P6+P7+P8>6THEN961
955 X(B)=3
956 IFP9<4THEN959
957 E=9
958 GOTO960
959 E=1
960 GOTO1009
961 X(B)=3
962 IFP5+P6+P7+P8>8THEN1006
963 IFP7+P8>4THEN1006
964 E=10
965 GO TO 1009
966 IFP6=0THEN984
967 IFP4+P5+P6>6THEN980
968 X(B)=2
969 IFP9<4THEN978
970 IFP9<6THEN973
971 E=7
972 GOTO979
973 IFP9<5THEN976
974 E=6
975 GOTO979
976 E=5
977 GOTO979
978 E=1
979 GOTO1009
980 X(B)=3
981 IFP4+P5+P6>8THEN1004
982 E=8
983 GOTO1009
984 IFP4+P5=0THEN1009
985 IFP4+P5>6THEN998
986 X(B)=1
987 IFP9<4THEN996
988 IFP9<6THEN991
989 E=4
990 GOTO997
991 IFP9<5THEN994
992 E=3
993 GOTO997
994 E=2
995 GOTO997
996 E=1
997 GOTO1009
998 X(B)=3
999 IFP4+P5>8THEN1004
1000 IFP9<4THEN1003
1001 E=8
1002 GOTO1004
1003 E=1
1004 X(B)=7
1005 GOTO1009
1006 X(B)=7
1007 IFP7<2THEN1009
1008 X(B)=8
1009 IFE<8THEN1029
1010 ONE-7GOTO1011,1016,1021
1011 L(8,1)=2*P4+L(8,1)
1012 L(8,2)=2*P5+L(8,2)
1013 L(8,3)=2*P6+L(8,3)
1014 L(8,7)=16-2*P9
1015 GOTO1029
1016 L(8,4)=2*P5+L(8,4)
1017 L(8,5)=2*(P6+P7)+L(8,5)
1018 L(8,6)=2*P8+L(8,6)
1019 L(8,8)=12-2*P9
1020 GOTO1029
1021 L(8,6)=2*P8
1022 L(8,5)=2*(2-P8/2+P7/2+P6/2-ABS(P8/2+P7/2+P6/2-2))
1023 L(8,4)=2*(2-P8/2-L(8,5)/4+P5/2-ABS(P8/2+L(8,5)/4+P5/2-2))
1024 L(8-L(8,6)-L(8,5)-L(8,4)
1025 L(8,3)=2*(P6+P7)-L(8,5)
1026 L(8,2)=2*P5-L(8,4)
1027 L(8,1)=2*P4
1028 L(8,7)=8-L(8,3)-L(8,2)-L(8,1)
1029 IFT<6THEN1035
1030 IFB>2THEN1035
1031 IFX(B)<5THEN1034
1032 X(B)=8
1033 GOTO1035
1034 X(B)=4
1035 IFM8=0THEN1037
1036 IFW(B,8)<>2THEN1038
1037 X(B)=0
1038 IFM8=1THEN1043
1039 IFE>0THEN1043
1040 IFB=B2THEN1043
1041 IFA(B+1)<>BTHEN1043
1042 X(B)=9
1043 L(7,E)=L(7,E)+2
1044 ONE+1GOTO1081,1045,1047,1049,1051,1047,1049,1051,1053,1058,1066
1045 L(7,1)=L(7,1)+1
1046 GOTO1077
1047 L(7,2)=L(7,2)+1
1048 GOTO1077
1049 L(7,3)=L(7,3)+1
1050 GOTO1077
1051 L(7,4)=L(7,4)+1
1052 GOTO1077
1053 L(7,8)=L(7,8)+1
1054 L(8,1)=P4+P5+L(8,1)
1055 L(8,2)=P6+L(8,2)
1056 L(8,7)=8-P9+L(8,7)
1057 GOTO1077
1058 IFP9<6THEN1061
1059 L(7,7)=L(7,7)+1
1060 GOTO1077
1061 IFP9<5THEN1064
1062 L(7,6)=L(7,6)+1
1063 GOTO1077
1064 L(7,5)=L(7,5)+1
1065 GOTO1077
1066 IFP9<7THEN1058
1067 L(7,8)=L(7,8)+1
1068 L(8,1)=P4+P5+L(8,1)
1069 L(8,2)=P6+L(8,2)
1070 L(8,3)=P7+P8+L(8,3)
1071 IFB>2THEN1076
1072 IFQ3=0THEN1076
1073 IFT>3THEN1076
1074 L(8,1)=L(8,1)-1
1075 L(8,2)=L(8,2)+1
1076 L(8,7)=8-P9+L(8,7)
1077 GOTO1084
1081 IFB=B2THEN1084
1082 IFB<>A(B+1)THEN1084
1083 C2=C2+120
1084 FORF=1TO8
1085 L(10,F)=L(10,F)+L(8,F)
1086 L(8,F)=0
1087 NEXTF
1088 NEXTB
1089 IFM8=0THEN1113
1090 FORB=2TOB2
1091 IFX(B)=0THEN1108
1092 IFX(B)=1THEN1102
1093 IFX(B)=2THEN1104
1094 IFX(B)=3THEN1107
1095 IFX(B)=4THEN1100
1096 IFX(B)=5THEN1102
1097 IFX(B)=6THEN1104
1098 IFX(B)=7THEN1106
1099 C2=C2+50
1100 C2=C2+200
1101 GOTO1108
1102 C2=C2+69
1103 GOTO1108
1104 C2=C2+87
1105 GOTO1108
1106 C2=C2+30
1107 C2=C2+149
1108 NEXTB
1109 FORE=1TO10
1110 C2=C2+L(7,E)*L(9,E)
1111 NEXTE
1113 RETURN
1114 Q4=0
1115 IFO7=0THEN1126
1116 FORB=1TOB2
1117 IFB>1THEN1122
1118 B(B)=W(B,7)*J(T,U)/100
1119 C(B)=K(T-T2,1)/100
1120 E(B)=E1*K(T-T2,2)/10000
1121 GOTO1125
1122 B(B)=B(A(B))+W(B,7)*D(B)*O(S(B),U)/100
1123 C(B)=C(A(B))+D(B)*P(S(B),1)/100
1124 E(B)=E(A(B))+E1*D(B)*P(S(B),2)/10000
1125 NEXTB
1126 GOSUB907
1127 FORS=1TO6
1128 M(S,4)=M(S,5)=V5=0
1129 NEXTS
1130 FORS=1TOZ8
1131 V=S
1132 IFF(1)<=V(S,3)*(1+.23*Z1)THEN1134
1133 NEXTS
1134 V5=N(1)
1135 FORB=2+Q3TOB2
1136 IFB=B2THEN1138
1137 IFA(B+1)+1=B+1THEN1140
1138 V5=V5-N(B)
1139 GOTO1142
1140 M(S(B),4)=M(S(B),4)+D(B)
1141 GO TO 1143
1142 M(S(B),5)=M(S(B),5)+D(B)
1143 NEXTB
1144 M(V,5)=M(V,5)+V5*K1
1145 R=C2+V5*K1*(F(1)*F(1)*R(V,2)/1000+T(V,2))
1146 C4=0
1147 FORB=1TOB2
1148 IFX(B)<5THEN1150
1149 C4=1
1150 IFB>1THEN1156
1151 ONA1GOTO1154,1152,1154,1152
1152 R=R+T(T,3)+M(T,3)+R(T,3)*W(B,7)*W(B,7)
1153 GOTO1156
1154 R=R+T(T,1)+M(T,1)+R(T,1)*W(B,7)*W(B,7)
1155 GOTO1157
1156  R=R+T(S(B),2)*D(B)+R(S(B),2)*W(B,7)*W(B,7)*D(B)/1000
1157 NEXTB
1158 IFN(1)=0THEN1160
1159 Q4=INT(R/N(1)+.5)
1160 R=INT(R+.5)
1161 Q=T-T2
1162 Q1=INT((H(N(1))+Z9)*100/U(Q,U)+.5)
1163 Q2=INT((G(N(1))+Z9)*100/U(T,U)+.5)
1164 O5=INT(H(N(1))+Z9)
1165 O6=INT(G(N(1))+Z9)
1166 FORB=1TOB2
1167 IFB<>1THEN1173
1168 W(0,14)=S1*.0288/S3/S3
1169 W(0,15)=S2*.0288/S3/S3
1170 W(0,16)=4*W(0,14)
1171 W(0,17)=4*W(0,15)
1172 GOTO1183
1173 IFW(A(B),18)>=S4THEN1176
1174 IFW(A(B),19)>=S4THEN1176
1175 GOTO1208
1176 W(B,14)=W(A(B),14)+D(B)*P(S(B),3)/5000*.91048
1177 W(B,15)=W(A(B),15)+D(B)*P(S(B),4)/5000
1178 W(B,16)=W(A(B),16)+D(B)*P(S(B),5)/5000*.91048
1179 W(B,17)=W(A(B),17)+D(B)*P(S(B),6)/5000
1180 W(B,18)=.120/SQR(W(B,14)*W(B,14)+W(B,15)*W(B,15))
1181 W(B,19)=.240/SQR(W(B,16)*W(B,16)+W(B,17)*W(B,17))
1182 GOTO1206
1183 IFS8<>0THEN1188
1184 ONTGOTO1185,1185,1185,1185,1185,1187
1185 S8=1.5
1186 GOTO1188
1187 S8=3.0
1188 ONTGOTO1189,1191,1193,1195,1197,1199
1189 S7=.02304*S8
1190 GOTO1200
1191 S7=.01536*S8
1192 GOTO1200
1193 S7=.01152*S8
1194 GOTO1200
1195 S7=.00786*S8
1196 GOTO1200
1197 S7=.00576*S8
1198 GOTO1200
1199 S7=.003449*S8
1200 S8=1+.2*S8
1201 W(1,14)=W(0,14)+.375*S7/S8
1202 W(1,15)=W(0,15)+.3*S7*SQR(1-1/S8/S8)
1203 W(1,16)=W(0,16)+S7/S8
1204 W(1,17)=W(0,17)+S7*SQR(1-1/S8/S8)
1205 GOTO1180
1206 IFW(B,18)>=S4THEN1210
1207 IFW(B,19)>=S4THEN1210
1208 W(B,18)=0
1209 W(B,19)=0
1210 NEXTB
1211 PRINT
1212 PRINT
1213 PRINTZ$
1214 PRINTY$
1215 IFC4=0THEN1221
1216 PRINT"NUMBER OF CABLES AT BUSSES INDICATED BY A * EXCEED"
1217 PRINT "CAPACITY OF 8-WAY CONNECTOR. SELECT A LARGER BOX"
1218 PRINT "AND USE MULTIPLE CONNECTORS OR REARRANGE SECONDARY."
1219 PRINT"CONNECTORS NOT INCLUDED IN TOTALS BELOW."
1220 PRINT
1221 PRINT"SECONDARY SYSTEM COST: TOTAL= $"R;" , PER CUSTOMER = $"Q4
1222 PRINT"INITIAL TRANSFORMER = "A$(Q);"KWH = "O5;" ("Q1;"%)"
1223 PRINT"DESIGN  TRANSFORMER = "A$(T);"KWH = "O6;" ("Q2;"%)"
1224 PRINT"MINIMUM SERVICE SIZE= "B$(V);"   RES CUST =  "N(1)
1225 PRINT
1226 L=1
1227 IFB2<L+9THEN1230
1228 L2=L+9
1229 GOTO1231
1230 L2=B2
1231 PRINT"SECTION";
1232 FORB=LTOL2
1233 PRINTTAB(3+(B-INT((B-1)/10)*10)*6);B;
1234 NEXTB
1235 PRINT
1236 PRINT"SEC SIZE";
1237 FORB=LTOL2
1238 IFB=1THEN1244
1239 ONA1GOTO1240,1241,1240,1241
1240 IFB=1+Q3THEN1243
1241 PRINTTAB(3+(B-INT((B-1)/10)*10)*6);B$(S(B));
1242 GOTO1244
1243 D(B)=0
1244 NEXTB
1245 PRINT
1246 PRINT"BOX SIZE";
1247 FORB=LTOL2
1248 IFX(B)=0THEN1250
1249 PRINTTAB(3+(B-INT((B-1)/10)*10)*6);C$(X(B)+1);
1250 NEXTB
1251 PRINT
1252 PRINT"VOLT DRP";
1253 FORB=LTOL2
1254 IFB(B)=0THEN1256
1255 PRINTTAB(2+(B-INT((B-1)/10)*10)*6);INT(B(B)*10+.5)/10;
1256 NEXTB
1257 PRINT
1258 IFJ1=0THEN1265
1259 PRINT"120V  FD";
1260 FORB=LTOL2
1261 IFC(B)=0THEN1263
1262 PRINTTAB(2+(B-INT((B-1)/10)*10)*6);INT(C(B)*10+.5)/10;
1263 NEXTB
1264 PRINT
1265 IFE1=0THEN1272
1266 PRINT"240V  FD";
1267 FORB=LTOL2
1268 IFE(B)=0THEN1270
1269 PRINTTAB(2+(B-INT((B-1)/10)*10)*6);INT(E(B)*10+.5)/10;
1270 NEXTB
1271 PRINT
1272 PRINT"KVA     ";
1273 FORB=LTOL2
1274 IFW(B,7)>100THEN1277
1275 PRINTTAB(2+(B-INT((B-1)/10)*10)*6);INT(W(B,7)*10+.5)/10;
1276 GOTO1278
1277 PRINTTAB(2+(B-INT((B-1)/10)*10)*6);INT(W(B,7)+.5);
1278 NEXTB
1279 PRINT
1280 IFS4>=100THEN1299
1281 PRINT"120V KA ";
1282 FORB=LTOL2
1283 IFW(B,18)=0THEN1288
1284 IFW(B,18)>100THEN1287
1285 PRINTTAB(2+(B-INT((B-1)/10)*10)*6);INT(W(B,18)*10+.5)/10;
1286 GOTO1288
1287 PRINTTAB(2+(B-INT((B-1)/10)*10)*6);INT(W(B,18)+.5);
1288 NEXTB
1289 PRINT
1290 PRINT"240V KA ";
1291 FORB=LTOL2
1292 IFW(B,19)=0THEN1297
1293 IFW(B,19)>100THEN1296
1294 PRINTTAB(2+(B-INT((B-1)/10)*10)*6);INT(W(B,19)*10+.5)/10;
1295 GOTO1297
1296 PRINTTAB(2+(B-INT((B-1)/10)*10)*6);INT(W(B,19)+.5);
1297 NEXTB
1298 PRINT
1299 PRINT
1300 IFL2=B2THEN1303
1301 L=L+10
1302 GOTO1227
1303 PRINT"SECONDARY CABLE :      CONNECTORS :"
1304 PRINTTAB(24);"QTY.   TYPE      RANGE  TERMINALS  CODE"
1305 U1=0
1306 S=E=1
1307 IFS=7THEN1326
1308 IFM(S,4)=0THEN1328
1309 PRINTTAB(2);M(S,4);"FT -"B$(S);
1310 IFE=11THEN1324
1311 IFL(7,E)=0THEN1330
1312 PRINTTAB(25);L(7,E);
1313 PRINTTAB(31);G$(E)
1314 IFS=7THEN1316
1315 S=S+1
1316 IFE=11THEN1318
1317 E=E+1
1318 IFU1=1THEN1341
1319 IFU1=2THEN1332
1320 IFU1=3THEN1344
1321 IFS+E=18THEN1350
1322 IFU1=4THEN1310
1323 GOTO1307
1324 PRINT
1325 GOTO1314
1326 U1=1
1327 GOTO1310
1328 S=S+1
1329 GOTO1307
1330 E=E+1
1331 GOTO1310
1332 S=1
1333 U1=3
1334 GOTO1345
1335 S=S+1
1336 GOTO1344
1337 X=X+1
1338 GOTO1363
1339 F=F+1
1340 GOTO1366
1341 PRINT"SERVICE CABLE :";
1342 U1=2
1343 GOTO1310
1344 IFS=7THEN1348
1345 IFM(S,5)=0THEN1335
1346 PRINTTAB(2);M(S,5);"FT - "B$(S);
1347 GOTO1310
1348 U1=4
1349 GOTO1310
1350 FORX=1TO5
1351 M(X,6)=0
1352 NEXTX
1353 FORB=2TOB2
1354 IFX(B)=9THEN1358
1355 IFX(B)<5THEN1357
1356 X(B)=X(B)-4
1357 M(X(B),6)=M(X(B),6)+1
1358 NEXTB
1359 PRINT
1360 PRINT"SECONDARY BOXES :      BL BUS SLEEVES :"
1361 PRINTTAB(24);"QTY.    RANGE         CODE"
1362 X=F=1
1363 IFX=6THEN1366
1364 IFM(X,6)=0THEN1337
1365 PRINTTAB(2);M(X,6);" - "C$(X+1);
1366 IFF=9THEN1376
1367 IFL(10,F)=0THEN1339
1368 PRINTTAB(25);L(10,F);
1369 PRINTTAB(31);H$(F)
1370 IFX=6THEN1372
1371 X=X+1
1372 IFF=9THEN1374
1373 F=F+1
1374 IFX+F=15THEN1378
1375 GOTO1363
1376 PRINT
1377 GOTO1370
1378 FORB=1TOB2
1379 B(B)=C(B)=E(B)=0
1380 NEXTB
1381 PRINTF$
1382 PRINT
1383 IFH=9999THEN1389
1384 IFW5=0THEN1387
1385 READK1
1386 K1=K1+P1
1387 READZ$
1388 GOTO483
1389 PRINT"END OF DATA."
1390 GOTO1406
1391 PRINT Z$
1392 PRINT"CALCULATION CONTINUED ON NEXT TRANSFORMER"
1393 PRINTF$
1394 PRINT
1395 IFH=9999 THEN 1399
1396 IFH=9998 THEN 1384
1397 READH
1398 GO TO 1395
1399 READE$
1400 IFE$=D$THEN1406
1401 PRINTE$
1402 PRINT"THIS TRANSFORMER IDENTIFICATION NOT USED"
1403 PRINT"OTHERS MAY BE OUT OF SEQUENCE - CHECK DATA"
1404 PRINT
1405 GOTO1399
1406 END
 } ?