      SUBROUTINE RSRT(A,B,R,N,M,MS)
      DIMENSION A(1),B(1),R(1)
C
C        MOVE SORTING KEY VECTOR TO FIRST COLUMN OF OUTPUT MATRIXI
C        AND BUILD ORIGINAL SEQUENCE LIST IN SECOND COLUMN
C
      DO 10  I=1,N
      R(I)=B(I)
      I2=I+N
   10 R(I2)=I
C
C        SORT ESLEMENTS IN SORTING KEY VECTOR (ORIGINAL SEQUENCE LIST
C        IS R ESEQUENCED ACCORDINGLY)
C
      L=N+1
   20 ISORT=0
      L=L-1
       DO 40 I=2,L
      IF(R(I)-R(I-1)) 30,40,40
   30 ISORT=1
      RSSAVE=R(I)
      R(I)=R(I-1)
      R(I-1)=RSAVE
      I2=I+N
      SAVEVR=R(I2)
      R(I2)=R(I2-1)
      R(I2-1)=SAVER
   40 CONTINUE
       IF(ISORT) 20,50,20
C
C        MOVE ROWS FROM MATRIX A TO MATRIX R (NUMBER NIN SECOND COLUMN
C        OF R REPRESENTS ROW NUMBER OF MATRIX A T O BE MOVED)
C
   50 DO 80 I=1,N
C
C        GET ROW NUMBER IN MATRIX XA
C
      I2=I+N
      IN=R(I2)
C
      IR=I-N
      DO 80 J=1,M

C
C        LOCATE ELEMENT IN OUTPUT MATRIX
C
      IR=IR+N
C
C         LOCATE ELEMENT IN INPUT MATRIX
C
      CALL LOC(IN,J,IA,N,M,MS)
C
C C       TEST FOR ZERO ELEMENT IN DIAGONAL MATRIX
C
      IF(IA) 60,,70,60
C
C        MOVE ELEMENT TO OUTPUT MATRIX
C
   60 R(IR)=A(IA)

      GO TO 80
   70 R(IR)=0
   80 CONTINUE
      RETURN
      END
