500 PRINT "START"
1000 FILE #4,"XYZ.DAT"; #5,"LP.DAT"; #6,"EXP.DAT"
1010 REM THIS PROGRAM DETERMINES THE RATE OF RETURN ON LEASED
1020 REM EQUIPMENT. D.D.B. AND 1.5 D.B. WITH AUTOMATIC 
1030 REM SWITCHOVER TO STRAIGHT LINE, AND STRAIGHT LINE IS
1040 REM INCORPORATED. BORROWED MONEY IS HANDLED ON A MORTAGE
1050 REM PAYMENT ARRANGEMENT. FEDERAL TAXES ARE PAID ANNUALLY
1060 REM ANNUAL MISCELLANIOUS EXPENSES CAN BE INPUTED. EQUITY 
1070 REM P=PURCHASE VALUE
1080 REM O1= OPTIO^: 1= GIVEN I FIND L; 2= GIVEN L FIND I
1090 REM               3= GIVEN L(Y) FIND I
1100 REM 02= OPTION* 0= NO EXTENSION; 1= EXTENSION
1110 REM 03= OPTION: 1= PAYMENTS IN ADVANCE; 2= IN ARREARS
1120 REM I= PRETAX RATE
1130 REM F= NUMBER OF LEASE PAYMENT PER YEAR
1140 REM N= NUMBER OF LEASE YEARS
1150 REM N3= NUMBER OF EXTENSION YEARS
1160 REM L= LEASE PAYMENT PER YEAR
1170  REM M= DEPRECIATION METHOD: 1=SLD; 2=DDB; 1.5= 150%DB
1180 REM K= LIFE OF RQUIPMENT
1190 REM R= RESIDUAL VALUE AT END OF LEASE
1200 REM R3= RESIDUAL VALUE AT END OF EXTENSION
1210 REM D= DEBT INCURRED
1220 REM E= DEBT INTEREST
1230 REM F2= NUMBER OF DEBT PAYMENTS PER YEAR
1240 REM Q= NUMBER OF DEBT YEARS
1250 REM T= TAX RATE IN PERCENT
1260 REM C= ]ISC COST CODE:0=FILL ZEROES; 1=READ COSTS
1270 REM C(Y)= COSTS
1280 REM \8Y)- ANNUAL LEASE PAYMENTS
1290 DIM C(51),D(51),E(51),P(51),T(51),F(51),L(51)
1300 INPUT #4, P,O1,O2,O3,I,F,N,N3,L,M,K,R,R3,R4,D,E,F2,Q,T,A1,A2
1310 INPUT #4, I6,O5,X7,X8,C
1320 IF O2<>1 THEN 1330
1325 R=R3
1330 LET I=I/100
1340 E=E/100
1350 T=T/100
1360 IF A1<>1 THEN 1370
1365 M=1.5
1370 IF A1<>2 THEN 1380
1375 M=2
1380 IF A1<>3 THEN 1390
1385 M=1.5
1390 IF A1<>4 THEN 1400
1395 M=2
1400 IF A1=1 THEN 1460
1410 IF A1=2 THEN 1460
1420 IF A1=3 THEN 1460
1430 IF A1=4 THEN 1460
1440 A1=0
1450 GOTO 1480
1460 IF A2<=0 THEN 1470
1465 IF A2<13 THEN 1480
1470 A2=1
1480 GOTO 1490
1490 IF O2=0 THEN 1620
1500 IF O2=1 THEN 1630
1510 GOTO 9150
1520 REM COMPUTE LEASE PAYMENT(L) ASSUMING I=ANNUAL INTEREST
1530  REM RATE DESIRED, N YEARS LEASE, K YEARS EQUIP. LIFE
1540 REM  F PAYMENTS PER YEAR, P= PURCHASE VALUE
1550 LET W=(1+I/F)^(N*F)
1560 L=P*I/F*W/(W-1)
1570 IF O3=1 THEN 1600
1580 IF O3=2 THEN 1880
1590 GOTO 9170
1600 L=L/(1+I/F)
1610 GOTO 1880
1620 N3=0
1630 N5=INT(((N*12)+A2+11)/12)
1640 N1=INT(((N*12)+(N3*12)+A2+11)/12)
1650 N2=N1
1660 N4=N1
1670 IF N2>=Q THEN 1680
1675 N2=INT(((Q*12)+A2+11)/12)
1680 REM REPORT COVERS N2 YEARS
1690 REM MISC EXPENSES
1700 IF C=0 THEN 1780
1710 IF C=1 THEN 1730
1720 GOTO 9090
1730 FOR Y=1 TO N2
1740 INPUT #4, C(Y)
1750 NEXT Y
1760 GOTO 1810
1770 
1780 FOR Y= 1TO N2
1790 LET C(Y)=0
1800 NEXT Y
1810 IF O1=1 THEN 1520
1820 IF O1=2 THEN 1880
1830 IF O1=3 THEN 2050
1840  PRINT "LEASE CODE ERROR"
1850 GOTO 9180
1860 
1870  REM FORM L(Y)
1880 Y7=INT(N*F)
1890 IF O3=q THEN 1920
1900 Y9=INT (((12-A2+1)*F)/12)
1910 GOTO 1930
1920  Y9=INT(((12-A2+12/F)*F)/12)
1930 Y=1
1940 L(Y)=L*Y9
1950 Y8=Y9
1960 Y=Y+1
1970 IF (Y8+F)>Y7 THEN 2010
1980 Y8=Y8+F
1990 L(Y)=L*F
2000 GOTO 1960
2010 L(Y)=L*(Y7-Y8)
2020 A=N5+1
2030 IF O2= 0 THEN 2090
2040 GOTO 2060
2050 A=1
2060 FOR Y=A TO N4
2070 INPUT #5,L(Y)
2080 NEXT Y
2090 FOR Y=N4+1 TO N2+1
2100  LET L(Y)=0
2110 NEXT Y
2120  L(N2+2)=0
2130 FOR Y=1 TO N2+1
2140 L(N2+2)=L(N2+2)+L(Y)
2150 NEXT Y
2160 IF O1=1 THEN 2430
2170 I=12/100
2180 U=0
2190 U1=0
2200 W=1+I/F
2210 IF O1=3 THEN 2250
2220 Q2=L*F/I*(1-W^(-N*F))
2230  Q1=Q2*(-1/I-N/W+N/W/(1-W^(-N*F)))
2240 GOTO 2370
2250 FOR Y=1 TO N
2260 
2270 Q2=L(Y)/I*(W^F-1)/W^(Y*F)
2280 Q1=Q2*(-1/I-Y/W+W^(F-1)/(W^F-1))
2290  IF O3=1 THEN 2310
2295 Q1=Q2/F+Q1*W
2300 IF O3 <>1 THEN2310
2305 Q2=Q2*W
2310 U=U+Q2
2320 U1=U1+Q1
2330 NEXT Y
2340 IF N=INT(N) THEN 2410
2350 Q2=L(Y+1)/I/(N-INT(N))*(W^((N-Y)*F)-1)/W^(N*F)
2360 Q1=Q2*(-1/I-Y/W-(Y-N)*W^(F*(Y-N)-1)/(1-W^(F*(Y-N))))
2370 IF O3<>1 THEN 2390
2375 Q1=Q2/F+Q1*W
2380 Q2=Q2*W
2390 U=U+Q2
2400 U1=U1+Q1
2410 I=I-(U-P)/U1
2420 IF (U-P)/U1*SGN((U-P)/U1)>.0000001 THEN 2180
2430 LET W=0
2440 IF K>=N+N3 THEN 2460
2450 PRINT "LIFE OF EQUIPMENT LESS THAN LEASE LIFE"
2460 IF R4-P/10>0 THEN 2480
2470 GOTO 2490
2480 W=R4-P/10
2490 Z=(P-W)/K
2500 LET B=P
2510 IF A1<=0 THEN2520
2515 IF A1<5 THEN 3000
2520 IF M=1 THEN 2590
2530 IF K>=3 THEN 2550
2540 PRINT "1.5DB AND DDB NOT ALLOWED, EQUIP LIFE <3YR"
2545 GOTO 9180
2550 IF M=1.5 THEN 2720
2560 IF M=2 THEN 2720
2570 GOTO 9110
2580 REM START ST. LINE  DEPR. COMPUTATION
2590 FOR Y=1 TO N+N3
2600 D(Y)=Z
2610 IF Y=INT(K) THEN 2670
2620 NEXT Y
2630 IF Y=N+N3 THEN 3360
2640 Y=Y+1
2650 D(Y)=(N+N3+1-Y)*Z
2660 GO TO 3360
2670 IF N+N3<K THEN 2630
2680 IF K<=Y THEN 3360
2685 D(Y+1)=Z*(K-Y)
2690 Y=Y+1
2700 GOTO 3360
2710 REM START DDB OR 1.5 DB CALCULATION
2720 FOR Y=1 TO N+N3
2730 D(Y)=B*M/K
2740 Z=(B-W)/(K+1-Y)
2750 IF  D(Y)<Z THEN 2900
2760 IF Y<>K THEN 2770
2765 D(Y)=B-W
2770 LET B=B-D(Y)
2780 IF Y=INT(K) THEN 2880
2790 NEXT Y
2800 IF Y=N+N3 THEN 3360
2810 Y=1+Y
2820 D(Y)=B*M/K*(N+N3+1-Y)
2830 Z=(B-W)/(K+1-N-N3)*(N+N3+1-Y)
2840 IF D(Y)>=Z THEN 3360
2845 D(Y)=Z
2850 GO TO 3360
2860  IF N+N3<K THEN 2950
2870 GOTO 2680
2880 IF N+N3<K THEN 2800
2890 GOTO 2680
2900 FOR Y=Y TO N+N3
2910 D(Y)=Z
2920 IF Y=INT(K) THEN 2860
2930 NEXT Y
2940 
2950 IF Y=N+N3 THEN 3360
2960 Y=Y+1
2970 D(Y)=Z*(N+N3+1-Y)
2980 GOTO 3360
2990 REM ADR DEPRECIATION
3000 A5=((Y7/F)*4)+4
3010 A6=INT((15-A2)/3)
3020 REM ADR DIATION
3030 B1=P-W
3040 K1=INT(K)
3050 IF K=K1 THEN 3060
3055 K1=K1+1
3060 A3=0
3070 D5=0
3080 FOR Y=1 TO N1
3090 D4=0
3100 K2=K-Y+1
3110 K3=K2
3120 IF K2>=1 THEN 3130
3125 K3=1
3130 D1=B/K3
3140 IF K<3 THEN 3230
3150 IF A3=1 THEN 3230
3160 H=INT(K2)
3170 G=(H+2*(K2-H))*(H+1)/2
3180 D2=(B*K2)/G
3190 D3=(B*M)/K
3200 IF D3<=D2 THEN 3210
3205 D4=D3
3210 IF D3>D2 THEN3220
3215 D4=D2
3220 IF M=2 THEN 3230
3225 D4=D3
3230 IF D4>=D1 THEN 3240
3235 D4=D1
3240 IF B1-(D5+D4)>=0 THEN 3250
3245 A3=1
3250 IF A3<>1 THEN 3260
3255 D4=D1
3260 IF A1>=3 THEN 3270
3265 IF Y<>1 THEN 3270
3267 D4=D4/2
3270 IF A1<3 THEN 3280
3275 IF A2<=6 THEN 3280
3276 IF Y<>1 THEN 3280
3278 D4=0
3280 IF A1<3 THEN 3290
3285 IF A2>6 THEN 3290
3287 IF Y<>1 THEN 3290
3288 D4=D4
3290 IF D4<=B1-D5 THEN 3300
3295 D4=(B1-D5)/K3
3300 A7=A5-(((Y-1)*4)+A6)
3310 IF K<=(N+N3) THEN 3320
3315 IF A7/4>=1 THEN 3320
3320 D5=D5+D4
3330 D(Y)=D4
3340 B=B-D4
3350 NEXT Y
3360 FOR Y=Y+1 TO N2
3370 D(Y)=0
3380  NEXT Y
3390 LET D(N2+1)=0
3400  FOR Y=1 TO N2
3410  LET D (N2+1)=D(N2+1)+D(Y)
3420 NEXT Y
3430 P1=0
3440  REM COMPUTE DEBT REPAYMENT.  MONTHLY PAYMENT UNIFORM=X,
3450  REM YEARS INTEREST=E(I), YEARS PRINCIPAL P(I), LIFE DEBT Q
3460 IF D<>0 THEN 3520
3470  LET X=0
3480  FOR Y=1 TO N2
3490 LET P(Y)=0
3500 NEXT Y
3510 GOTO 3850
3520 LET W=(1+E/F2)^(Q*F2)
3530  LET X=D*E/F2*W/(W-1)
3540 Y=0
3550 D1=D
3560 F8=A2
3570 F9=12/F2
3580 F7=INT(12*Q)
3590 F6=0
3600  LET P(N2+1)=0
3610  LET E(N2+1)=0
3620 Y=Y+1
3630 IF F6>=F7 THEN 3780
3640 P(Y)=0
3650 E(Y)=0
3660 P1=X-(D1*E/F2)
3670 P(Y)=P(Y)+P1
3680 E(Y)=X-P1+E(Y)
3690 D1=D1-P1
3700 F8=F8+F9
3710 F6=F6+F9
3720 IF F6>=F7 THEN 3750
3730 IF F8<=12 THEN 3660
3740 F8=F8-12
3750 P(N2+1)=P(Y)+P(N2+1)
3760 E(N2+1)=E(Y)+E(N2+1)
3770 GOTO 3620
3780  LET Y=Y+1
3790 Z=Y
3800 FOR Y=Z TO N2
3810  LET P(Y)=0
3820  LET E(Y)=0
3830 
3840 NEXT Y
3850  REM COMPUTE FEDERAL TAX T(Y)
3860  LET T(N2+1)=0
3870 IF O5=0 THEN 3980
3880 DIM L8(51),L9(51),L7(51)
3890 FOR Y= 1 TO O5
3900 INPUT #6, L8,L9
3910 L8(Y)=L8
3920 L9(Y)=L9
3930 L5=INT((L9+F-1)/F)
3940 IF L5<>0 THEN 3950
3945 L5=1
3950 C1(L5)=C1(L5)+L8
3960 NEXT Y
3970 DIM C1(51)
3980 FOR Y=1 TO N5
3990 T(Y)=(L(Y)-D(Y)-E(Y)-C(Y)-C1(Y))*T
4000  LET T(N2+1)=T(Y)+T(N2+1)
4010  NEXT Y
4020 Z=0
4030 IF O2<>1 THEN4040
4034 IF N>=INT(N) THEN 4040
4037 Z=1
4040 IF Z<>1 THEN 4050
4045 T(Y)=T(Y)+T*L(Y+1)
4050 IF  Z<>1 THEN 4060
4055 T(N2+1)=T(N2+1)+T*L(Y+1)
4060 FOR Y=N5+1 TO N2
4070 T(Y)=T*(L(Y+Z)-D(Y)-E(Y)-C(Y)-C1(Y))
4080 T(N2+1)=T(Y)+T(N2+1)
4090 NEXT Y
4100  REM COMPUTE AFTER TAX CASH FLOW F(Y)
4110  LET F(N2+1)=0
4120 FOR Y=1 TO N5
4130 F(Y)=L(Y)-E(Y)-P(Y)-T(Y)-C(Y)-C1(Y)
4140  LET F(N2+1)=F(Y)+F(N2+1)
4150 NEXT Y
4160 IF Z<>1 THEN 4170
4165 F(Y)=F(Y)+L(Y+1)
4170 IF Z<>1 THEN 4180
4175 F(N2+1)=F(N2+1)+L(Y+1)
4180 FOR Y=N5+1 TO N2
4190 F(Y)=L(Y+Z)-E(Y)-P(Y)-T(Y)-C(Y)-C1(Y)
4200  F(N2+1)=F(N2+1)+F(Y)
4210  NEXT Y
4220 IF X7=0 THEN 4260
4230 X9=INT((X8+F-1)/F)
4240 F(X9)=F(X9)+X7
4250  T(X9)=T(X9)-X7
4260 U4=T*(R-P+D(N2+1))
4270 REM FIND AFTER TAX RATE OF RETURN, V, USING THE NEWTON-
4280 REM RAPHSON METHOD: V(M+1)=V(M)-F[V(M)]/F'[V(M)]
4290  REM ASSUME THAT EQUIPMENT IS SOLD AFTER N YEARS FOR R DOLLARS
4300 GOTO 4410
4310 G7=INT(12/F)
4320 IF O3=1 THEN 4350
4330 G6=INT(((13-A2)*F)/12)
4340 GOTO 4360
4350 G6=INT(((12-A2+G7)*F)/12)
4360 G8=INT((N+N3)*F)
4370 G9=F-G6
4380 G5=INT((G9+G8)/F)
4390 G5=(G9+G8)-(G5*F)
4400 GOTO 4570
4410 IF P-D<=0 THEN 9130
4420 DEF FNA(F,A)=X1/V*(A^(F-F*Y)-A^(-Y*F))
4430 DEF FNC(F,A,N)=X1/(N+1-Y)/V*(A^(F-F*Y)-A^(-N*F))
4440 DEF FND(X2,F,A,G9,Y2)=(X2/F)*A^-(G9+Y2)
4450 DEF FNE(A,A2,G7,Z)=Z*A^-((A2-(G7*INT((A2-1)/G7))-1)/G7)
4460 IF I6<>0 THEN 4470
4465 I6=I/2
4470 V=I6
4480 W=1
4490 X=0
4500 U=0
4510 Z=0
4520 J=0
4530 A=1+V/F
4540 B=1+V/F2
4550 C=1+V/4
4560 GOTO 4310
4570 P1=P*A^-G9
4580 Y2=1
4590 Y1=1
4600 M1=A2
4610 F9=G6
4630 P1=FNE(A,A2,G7,P1)
4650 IF F9=0 THEN 4680
4660 X2=L(Y1)-C(Y1)
4670 Z=Z+FND(X2,F9,A,G9,Y2)
4680 IF Y2>=G8 THEN 4790
4690 Y2=Y2+1
4700 M1=M1+G7
4710 IF M1<=12 THEN 4650
4720 M1=M1-12
4730 Y1=Y1+1
4740 F9=F
4750 IF INT((G8+G9)/F)>(Y1-1) THEN 4650
4760 F9=G5
4770 GOTO 4650
4780 
4790 IF O3<>1 THEN 4800
4795 Z=Z*A
4800 Z=FNE(A,A2,G7,Z)
4810 G6=INT((15-A2)/3)
4820 G7=3
4830 G8 =INT((((N+N3)*12)+2)/3)
4840 G9=4-G6
4850 G5=INT ((G9+G8)/4)
4860 G5=G9+G8-G5*4
4870 F9=G6
4880 Y2=1
4890 Y1=1
4900 M1=INT((G9+1)*G7)
4910 GO SUB 5040
4920  J=FND(X2,F9,C,G9,Y2)
4930 X=X+J
4940 IF Y2>=G8 THEN 5080
4950 M1=M1+G7
4960 Y2=Y2+1
4970 IF M1<=12 THEN 4910
4980 M1=M1-12
4990 Y1=Y1+1
5000 F9=4
5010 IF INT((G8+G9)/4)>(Y1-1) THEN 4910
5020 F9=G5
5030 GOTO 4910
5040 IF F9=0 THEN 5070
5050 X2=T*(L(Y1)-C(Y1)-C1(Y1)-D(Y1)-E(Y1))
5060 Z=Z-FND(X2,F9,C,G9,Y2)
5070 RETURN
5080 IF D=0 THEN 5350
5090 G6=INT(((13-A2)*F2)/12)
5100 G7=12/F2
5110 G8=INT((N+N3)*F2)
5120 G9=F2-G6
5130 G5=INT((G9+G8)/F2)
5140 G5=(G9+G8)-(G5*F2)
5150 Y2=1
5160 Y1=1
5170 M1=F2-G6+1
5180 F9=G6
5190 GO SUB 5300
5200 IF Y2>=G8 THEN 5340
5210 Y2=Y2+1
5220 M1=M1+G7
5230 IF M1<=12 THEN 5190
5240 M1=M1-12
5250 Y1=Y1+1
5260 F9=F2
5270 IF INT((G8+G9)/F2)>(Y1-1) THEN 5190
5280 F9=F5
5290 GOTO 5190
5300 X2=P(Y1)+E(Y1)
5310 IF F9=0 THEN 5330
5320 U=U-FND(X2,F9,B,G9,Y2)
5330 RETURN
5340 U=FNE(B,A2,G7,U)
5350 U=U+Z
5360 U=U+(R-U4)/A^((N+N3)*F)
5370 L6=0
5380 IF O5=0 THEN 5420
5390 FOR Y=1 TO O5
5400 L6=L6+L8(Y)*A^(-L9(Y))
5410 NEXT Y
5420 U=U+X7*A^(-X8)-L6
5430 REM PRINT W,V,U TO WATCH PROGRESS OF LOOP
5440 IF W=1 THEN 5460
5450 GOTO 5530
5460 LET U1=U
5470 LET U2=V
5480 LET V=1.001*V
5490 LET W=2
5500 GOTO 4490
5510 REM F'[V(M)]=U3=DERIVATIVE OF FUNCTION[DISCOUNTED CASH FLOW
5520 REM MINUS PURCHASE VALUE MINUS DEBT VALUE]
5530 LET U3=(U1-U)/(U2-V)
5540 V=U2-(U1-P1+D)/U3
5550 IF (U2-V)*SGN(U2-V)>.0000001 THEN 4480
5560 REM  ADD EFFECT OF SALE AT RESIDUAL VALUE, R
5570 T(N2+1)=T(N2+1)+U4
5580 F(N2+1)=F(N2+1)+R-U4
5585 GOTO6800
5590 PRINT,,"LEASE ANALYSIS"
5600 PRINT
5610 PRINT
5620 IF O3<>1 THEN 5630
5625 B$="PAYMENTS IN ADVANCE"
5630 IF O3<>2 THEN 5640
5635 B$="PAYMENTS IN ARREARS"
5640 :  PURCHASE VALUE OF EQUIPMENT $$$$,$$$,$$$
5650 PRINT USING 5640, P
5660  PRINT "PRETAX RATE:"I*100"%"B$
5670 PRINT USING 5740, V*100
5680 PRINT "ORIGINAL LEASE"F*N"PERIODS"
5690 IF O2<>1 THEN 5700
5695 PRINT "EXTENSIONS"F*N3"PERIODS"
5700 PRINT USING 5710, K,A2
5710 : EQUIPMENT LIFE ###.## YEARS  LEASE STARTS IN MONTH ###
5720 IF D=0 THEN 5740
5730 PRINT "DEBT LIFE"Q"YEARS"
5740 :  RATE OF RETURN: ###.####%
5750 IF D=0 THEN 5770
5760 PRINT "DEBT INTEREST"E*100"%"
5770 PRINT "TAX RATE" T*100"%"
5780 IF X7=0 THEN 5810
5790 PRINT USING 5800, X7,X8
5800:  ITC $$$$,$$$,$$$  IN PERIOD ###
5810 IF M<>1 THEN 5820
5815 A$="S.L.D."
5820 IF M<>1.5 THEN 5830
5825 A$="1.5 D.B."
5830 IF M<>2 THEN 5840
5835 A$="D.D.B."
5840 PRINT
5850 PRINT TAB(7)"LEASE";TAB(17)A$;TAB(28)"---DEBT REPAYMENT---";
5860 PRINTTAB(51)"FEDERAL";TAB(63)"AFTER TAX",
5870PRINT "YR";TAB(6)"PAYMENT";TAB(17)"DEPREC'N";TAB(28)"INTEREST";
5880 PRINT  "   PRINCIPAL";TAB(53)"TAX";TAB(63)"CASH FLOW"
5890 FOR Y=1 TO N5
5900 PRINT USING 5910,Y,L(Y),D(Y),E(Y),P(Y),T(Y),F(Y)
5910 :###  #########. #########. #########. #########. #########  #########.
5930 NEXT Y
5940 IF N<=INT(N) THEN5950
5945 X=1
5950 FOR Y=N5+1 TO N2
5960 PRINT USING 5910,Y,L(Y+X),D(Y),E(Y),P(Y),T(Y),F(Y)
5970 NEXT Y
5980 Y=0
5990 PRINT USING 5910,N1,Y,Y,Y,Y,U4,R-U4
6000 PRINT "     ---------- ---------- ----------";
6010 PRINT " ---------- ----------   ----------"
6020 LET Y= N2 +1
6030 PRINT USING 6040,L(Y+1),D(Y),E(Y),P(Y),T(Y)-X7,F(Y)+X7
6040 :     #########. #########. #########. #########. #########.   #########.
6050 :  ##########.
6060 PRINT
6070 PRINT
6080 PRINT USING 6090, R
6090 :   RESIDUAL VALUE OF EQUIPMENT = $$$$,$$$,$$$.
6100 PRINT
6110 PRINT USING 6120, P-D(N2+1)
6120 :   BOOK VALUE OF EQUIPMENT = $$$$,$$$,$$$.
6130 PRINT
6140 PRINT
6150 PRINT
6160 IF O3=1 THEN 6800
6170 PRINT "EQUITY ANALYSIS? 1=YES,2=NO";
6180 INPUT W
6190 IF W=2 THEN 6800
6200 IF W<>1 THEN 6170
6210 PRINT
6220 PRINT
6230 PRINT TAB(12)"------EQUITY ANALYSIS------";
6240 PRINT TAB(48)"TERMINATION";TAB(64)"MISC."
6250 PRINT "YEAR";TAB(x) "RETURN";TAB(21) "RECOVERY";TAB(35);
6255 PRINT "OUTSTD'G";TAB(51)"VALUE";TAB(63)"EXPENSE"
6270 PRINT
6280 LET S2=0
6290 C2=0
6300 Z=0
6310 B1=P-D
6320 V2 = 0
6330 P2=0
6340 FOR Y=1 TO N
6350 GO SUB 6380
6360 NEXT Y
6370 GO TO 6500
6380 S1=(F(Y)/V-B1)*((1+V/4)^4-1)
6390 B1=B1-S1
6400 S2=S2+S1
6410 R1 = F(Y)-S1
6420 V2 = D(Y) + V2
6430 P2=P(Y)+P2
6440 V1=1/(1-T)*(B1+D-P2-T*(P-V2))
6450 C2=C2+C(Y)
6460 PRINT USING 6480,Y,R1,S1,B1,V1,C(Y)
6470 RETURN
6480 :   ## ####,###,###. ####,###,###. ####,###,###.;
6490 :  ####,###,###. ###,###,###.
6500 IF O2<>1 THEN 6510
6505 IF N<=INT(N) THEN 6510
6507 Z=1
6510 IF Z=0 THEN 6620
6520 Y=Y+1
6530 S1=(L(Y)/(N-INT(N))-E(Y)-P(Y)-T(Y)-C(Y))/V-B1
6540 S1=S1*((1+V/4)^4*(N-INT(N))-1)
6550 B1=B1-S1
6560 IF Y<N+N3 THEN 6565
6561 X4=N+N3
6562 GOTO6570
6565 X4=Y
6570 S3=(L(Y+1)/(X4-N)-E(Y)-P(Y)-T(Y)-C(Y))/V-B1
6580 S3=S3*((1+V/4)^4*(X4-N)-1)
6590 B1=B1-S3
6600 S1=S1+S3
6610 GO SUB 6400
6620 GO TO 6700
6630 PRINT USING 6480,N1,0,S1,B1-S1
6635 PRINT USING 6490,0,0
6640 S2=S2+S1
6650 PRINT TAB(5)"------------  ------------  ------------";
6660 PRINT "  ------------  -----------"
6670 PRINT USING 6680, S2, C2
6680 :  ^17 ####,###,###.                             ###,###,###.
6690 GO TO 6800
6700 FOR Y=N5+1 TO N+N3
6710 GO SUB 6380
6720 NEXT Y
6730 IF N+N3=INT(N+N3) THEN 6780
6740 Y=Y+1
6750 X4=N+N3-INT(N+N3)
6760 S1=(F(Y)/X4/V-B1)*((1+V/4)^4*X4-1)
6770 GO SUB 6390
6780 S1=R-U4
6790 GO TO 6630
6800 F(N1)=F(N1)+R-U4
6810 PRINT "ACCOUNTING? 1=YES, 2=NO";
6820 T(N1)=T(N1)+U4
6830 INPUT W
6840 IF W=2 THEN 9180
6850 IFW<>1 THEN 6810
6860 DIM W(51),X(51),Z(51)
6870 IF X7=0 THEN 6930
6880 Z9=X7/(N+N3)
6890 FOR Y=1 TO N2
6900 Z(Y)=Z9
6910 NEXT Y
6920 Z(Y)=X7-Z9*(Z-1)
6930 IF O2=0 THEN 6990
6940 IF N=INT(N) THEN 6990
6950 L(N5)=L(N5)+L(N5+1)
6960 FOR Y=N5+1 TO N4
6970 L(Y)=L(Y+1)
6980 NEXT Y
6990 Y=C0=C1=C2=C3=C4=C5=C6=C7=C8=C9=0
7000 PRINT
7010 PRINT
7020 PRINT , "INCOME STATEMENT"
7030 GO TO 7050
7040 PRINT,"INCOME STATEMENT CONTINUED"
7050 PRINT
7060 IF N2-Y>4 THEN 7100
7070 Z=N2
7080 W=N2-Y-1
7090 GOTO 7140
7100 Z=Y+4
7110 W=3
7140 PRINT USING 7150,"YEAR           ",Y+1,Y+2,Y+3,Y+4
7150 :'LLLLLLLLLLLLLLL  ###,###,###.  ###,###,###.  ###,###,###.  ###,###,###.
7170 PRINT
7180 IF W>=3 THEN 7200
7185 PRINT
7200 X=(N+N3)*(1+(N+N3)*F)
7210 FOR Y=Z-W TO Z
7220 
7230 W(Y)=(F*(2*(N+N3-Y)+1)+1)/X
7240 IF Y<>INT(N+N3+1) THEN  7260
7245 IF N+N3<=Y-1 THEN 7260
7250  W(Y)=(N+N3-Y+1)*(F*(N+N3-Y+1)+1)/X
7260 W(Y)=W(Y)*(L(N2+2)+R-P)
7280 NEXT Y
7285 PRINT USING 7150,"  EARNED INCOME",W(Z-3),W(Z-2),W(Z-1),W(Z)
7290 IF W>=3 THEN 7310
7295 PRINT
7310 IF W<>3 THEN7330
7330 PRINT USING 7150,"  LESS INTEREST",E(Z-W),E(Z-W+1),E(Z-W+2),E(Z-W+3)
7350 IF W>=3 THEN 7370
7355 PRINT
7370 IF W<>3 THEN7390
7390 PRINT USING 7150,"  LESS MISC EXP",C(Z-W),C(Z-W+1),C(Z-W+2),C(Z-W+3)
7410 GOTO 7500
7420 IF W>=3 THEN 7440
7425 PRINT
7430  PRINT "               ";
7440 IF W<>3 THEN 7450
7445 PRINT "                ";
7450 FOR Y=Z-W TO Z
7460 PRINT "                 ------------  ------------  ------------  ------------"
7470 :  ###-----------"
7480 NEXT Y
7490 RETURN
7500 GO SUB 7420
7510 IF W>=3 THEN 7530
7515 PRINT
7520 PRINT "  NET BEFORE TX";
7530 IF W<>3 THEN 7540
7540 FOR Y=Z-W TO Z
7550 X(Y)=W(Y)-C(Y)-E(Y)
7570 NEXT Y
7575 PRINT USING 7150,"  NET BEFORE TX",X(Z-W),X(Z-W+1),X(Z-W+2),X(Z-W+3)
7580 PRINT
7590 IF W>=3 THEN 7600
7595 PRINT
7600 PRINT
7630 PRINT USING 7150,"  TAX:CURRENT",T(Z-W),T(Z-W+1),T(Z-W+2),T(Z-W+3)
7650 IF W>=3 THEN 7670
7655 PRINT
7660 PRINT "      DEFERRED";
7670 IF W<>3 THEN7690
7690 PRINT USING 7150,"      DEFERRED",T*X(Z-W)-T(Z-W)-Z(Z-W),T*X(Z-W+1)-T(Z-W+1)-Z(Z-W+1),T*X(Z-W+2)-T(Z-W+2)-Z(Z-W+2),T*X(Z-W+3)-T(Z-W+3)-Z(Z-W+3)
7710 GO SUB 7420
7720 IF W>=3 THEN 7740
7725 PRINT
7730 PRINT "      TOTAL";
7740 IF W<>3 THEN 7750
7745 PRINT "        TOTAL    ";
7750 FOR Y=Z-W TO Z
7760 PRINT USING 5910,15,T*X(Y)-Z(Y)
7770 NEXT Y
7780 PRINT
7790 IF W>=3 THEN 7800
7795 PRINT
7800 PRINT "  NET AFTER TAX";
7810 FOR Y=Z-W TO Z
7820 PRINT USING 5910, 15,(1-T)*X(Y)+Z(Y)
7830 NEXT Y
7840 GO TO 7930
7850 IF W>=3 THEN 7870
7855 PRINT
7860 PRINT "             ";
7870 IF W<>3 THEN 7880
7875 PRINT "             ";
7880 FOR Y=Z-W TO Z
7890 PRINT USING 7900, 15
7900 :  ^###============= ^*
7910 NEXT Y
7920 RETURN
7930UB 7850
7940 IF W>=3 THEN 7950
7945 PRINT
7950 PRINT
7960 PRINT
7970 IF Y>=5 THEN 7980
7975 PRINT, "BALANCE SHEET"
7980 IF Y<=4 THEN 7990
7985 PRINT, "BALANCE SHEET CONTINUED"
7990 PRINT
8000 PRINT "ASSETS"
8010 PRINT "  CASH";
8020 X4=C1
8030 FOR Y=Z-W TO Z
8040 X4=X4+F(Y)
8050 PRINT USING 5910, 15, X4
8060 NEXT Y
8070 C1=X4
8080 IF W>=3 THEN 8100
8085 PRINT
8090 PRINT "  LEASE RECV'BL";
8100 IF W<>3 THEN 8110
8105 PRINT "    LEASE RECV'BL";
8110 X4=C2
8120 FOR Y=Z-W TO Z
8130 X4=X4+L(Y)
8140 IF Y<>N1 THEN 8150
8145 X4=X4+R
8150 PRINT USING 5910, 15, L(N2+2)+R-X4
8160 NEXT Y
8170 C2=X4
8180 IF W>=3 THEN 8200
8185 PRINT
8190 PRINT "   LESS UNEARNED"
8200 IF W<>3 THEN8210
8205 PRINT "    LESS UNEARNED"
8210 PRINT "     INCOME";
8220 X4=C3
8230 FOR Y=Z-W TO Z
8240 X4 = X4+W(Y)
8250 PRINT USING 5910, 15, X4+P-L(N2+2)-R
8260 NEXT Y
8270 C3=X4
8280 GO SUB 7420
8290 IF W>=3 THEN 8310
8295 PRINT
8300 PRINT "  TOTAL ASSETS";
8310 IF W<>3 THEN 8320
8315 PRINT "    TOTAL ASSETS ";
8320 X4=C4
8330 FOR Y=Z-W TO Z
8340 X4=X4+F(Y)+W(Y)-L(Y)+Z(Y)
8350 IF Y<>N1 THEN8360
8355 X4=X4-R
8360 PRINT USING 5910, 15, X4+P
8370 NEXT Y
8380 C4=X4
8390 GO SUB 7850
8400 IF W>=3 THEN 8410
8405 PRINT
8410 PRINT
8420 PRINT
8430 PRINT "LIABILITIES"
8440 PRINT "  LONG TRM DEBT";
8450 X4=C5
8460 FOR Y=Z-W TO Z
8470 X4=X4+P(Y)
8480 PRINT USING 5910, 15, D-X4
8490 NEXT Y
8500 C5=X4
8510 IF W>=3 THEN 8530
8515 PRINT
8520 PRINT "  DEFERRED TAX";
8530 IF W<>3 THEN 8540
8535 PRINT "    DEFERRED TAX ";
8540 X4=C6
8550 FOR Y=Z-W TO Z
8560 X4=X4+T*X(Y)-T(Y)-Z(Y)
8570 PRINT USING 5910,15, X4
8580 NEXT Y
8590 C6=X4
8600 GO SUB 7420
8610 IF W>=3THEN 8630
8615 PRINT
8620 PRINT "  TOTAL LIABLE";
8630 IF W<>3 THEN 8640
8635 PRINT "    TOTAL LIABLE ";
8640 X4=C7
8650 FOR Y=Z-W TO Z
8660 X4=X4-P(Y)+T*X(Y)-T(Y)-Z(Y)
8670 PRINT USING 5910, 15,D+X4
8680 NEXT Y
8690 C7=X4
8700 GO SUB 7850
8710 IF W>=3 THEN8720
8715 PRINT
8720 PRINT
8730 PRINT
8740 PRINT "STOCKHOLDERS EQUITY"
8750 PRINT "  CAPITAL";
8760 FOR Y=Z-W TO Z
8770 PRINT USING 5910, 15, P-D
8780 NEXT Y
8790 IF W>=3THEN 8810
8795 PRINT
8800 PRINT "  RETAINED EARN";
8810 IF W<>3 THEN 8820
8815 PRINT "    RETAINED EARN";
8820 FOR Y=Z-W TO Z
8830 C8=C8+(1-T)*X(Y)+Z(Y)
8840 PRINT USING 5910, 15, C8
8850 NEXT Y
8860 GO SUB 7420
8870 IF W>=3THEN 8890
8875 PRINT
8880 PRINT "  TOTAL EQUITY";
8890 IF W<>3 THEN 8900
8895 PRINT "    TOTAL EQUITY";
8900 FOR Y=Z-W TO Z
8910 C9=C9+(1-T)*X(Y)+Z(Y)
8920 PRINT USING 5910, 15, C9+P-D
8930 NEXT Y
8940 IF W>=3 THEN 8950
8945 PRINT
8950 PRINT
8960 PRINT
8970 PRINT "TOTAL LIAB. &"
8980 PRINT "STKHLDRS EQUITY";
8990 FOR Y=Z-W TO Z
9000 C0=C0+X(Y)-P(Y)-T(Y)
9010 PRINT USING5910, 15, C0+P
9020 NEXT Y
9030 GO SUB 7850
9040 IF W>=3 THEN 9050
9045 PRINT
9050 PRINT
9060 PRINT
9070 IF Y<N2 THEN 7040
9080 GOTO  9180
9090 PRINT"ERROR IN MISC. EXPENSE CODE"
9100 GOTO 9180
9110 PRINT"DEPRECIATION CODE ERROR"
9120 GOTO 9180
9130 PRINT "ZERO OR NEGATIVE EQUITY NOT ALLOWED"
9140 GOTO 9180
9150 PRINT "EXTENTION CODE ERROR"
9160 GOTO 9180
9170 PRINT"ERROR IN ARREARS CODE"
9180 END
'w$t