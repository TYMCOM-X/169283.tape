10 REMARK "BLACKJACK": 
20 REM VER. 1.9 13/7/'71, CONVERTED FROM 940 TO SIGMA7 BASIC 18/7/'70  
30 B9=0
40 S$=""
50DIM K(72)
60PRINT 
70PRINT 
80PRINT 
90PRINT 
100PRINT 
110PRINT 
120PRINT 
130PRINT 
140PRINT 
150PRINT "**** **** **** **** ****  B L A C K J A C K  **** **** **** **** ****" 
160PRINT 
170PRINT 
180Z=RND(-4)
190FOR I=1 TO INT(590*Z)
200Z1 = RND(0) 
210NEXT I
220M5,C=0
230GOTO 2300
240REM SWITCH SW  
250IF S2=1 THEN 4820
260IF S2=2 THEN 2740
270IF S2=3 THEN 2590
280IF S2=4 THEN 2740
290IF S2=5 THEN 4230
300 GOTO 4760
310REM PROCEDURE SCORE(A)  
320IF A<=0 THEN 380
330PRINT 
340PRINT "I WIN!!  I WIN!!!"  
350PRINT "I WON $"A*B
360M4 = M4 + A*B  
370GOTO 460
380IF A = 0 THEN 440
390PRINT "YOU WIN $"-A*B
400PRINT 
410P4 = P4 - A*B  
420PRINT "FINK."  
430GOTO 460
440PRINT 
450PRINT "STAND-OFF."
460RETURN
470REM PROCEDURE SMART-ASS RETURN.  
480PRINT "AND"R" TO YOU TOO!" 
490PRINT "I SAID,";  
500RETURN
510REM REAL PROCEDURE VAL(X)  
520Y4 = X1 - INT(X1/100)*100  
530IF Y4>10 THEN 560
540V = Y4
550GOTO 570
560V = 10
570RETURN
580REM PROCEDURE CH  
590PRINT "YOU HAVE"C-2" CARD CHARLEY." 
600A = 12 - 2*C
610GOSUB 310
620GOTO 4230
630RETURN
640REM PROCEDURE SHUFFLE(N1)  
650 PRINT "THE CARDS ARE BEING "S$"SHUFFLED."
660 S$="RE" 
670FOR I1 = 0 TO B
680I3 = RND(0) 
690NEXT I1  
700FOR I1 = N1 TO 2 STEP -1
710I2 = INT(I1*RND(0)+1)
720I3 = K(20+I1)  
730K(20+I1) = K(20+I2)  
740K(20+I2) = I3  
750NEXT I1  
760C1 = 1
770 IF S8<>1 THEN 860
780 IF B8=1 THEN 860
790 PRINT
800 PRINT "DO YOU WISH TO PLACE A NEW BET";  
810 INPUT S7
820 IF S7=0 THEN 850
830 IF S7<>1 THEN 790
840 GOSUB 1790
850 S8=0 
860RETURN
870REM PROCEDURE SUIT(X2)  
880IF X2 >= 100 THEN 910
890PRINT "CLUB "; 
900GOTO 980
910IF X2 >= 200 THEN 940
920PRINT "SPADE ";
930GOTO 980
940IF X2 >= 300 THEN 970
950PRINT "DIAMOND";  
960GOTO 980
970PRINT "HEART ";
980RETURN
990REM PROCEDURE RESHUFFLE 
1000FOR I4 = 1 TO C
1010K(20+1-I4) = K(20+53-I4)
1020NEXT I4  
1030N1 = 52 - C 
1040GOSUB 640
1050FOR I4 = 52 TO 1 STEP -1  
1060K(20+I4) = K(20+I4-C)  
1070NEXT I4 
1080C1 = C+1
1090RETURN  
1100REM REAL PROCEDURE DRAW(A1)  
1110IF C1 <= 52 THEN 1130
1120GOSUB 990
1130X3 = K(20+C1) 
1140D1 = X3 
1150IF A1 = 1 THEN 1190
1160X1 = X3 
1170GOSUB 510
1180IF V<>1 THEN 1210
1190A1 = 1  
1200GOTO 1220
1210A1 = 0  
1220C1 = C1 + 1
1230C = C + 1  
1240RETURN  
1250REM PROCEDURE FACE(Y6) 
1260X4 = Y6 - INT(Y6/100)*100 
1270IF X4 <> 11 THEN 1300
1280PRINT "JACK"; 
1290GOTO 1400
1300IF X4 <> 12 THEN 1330
1310PRINT "QUEEN";
1320GOTO 1400
1330IF X4 <> 13 THEN 1360
1340PRINT "KING"; 
1350GOTO 1400
1360IF X4 <> 1 THEN 1390
1370PRINT "ACE";  
1380GOTO 1400
1390PRINT X4;  
1400X2 = Y6 
1410GOSUB 870
1420RETURN  
1430REM PROCEDURE HC 
1440PRINT
1450PRINT "MY HOLE CARD IS";  
1460Y6 = M2 
1470GOSUB 1250
1480PRINT
1490RETURN  
1500REM PROCEDURE TELL  
1510IF Y3 <= 21 THEN 1570
1520IF M3 <= 21 THEN 1570
1530PRINT "WE'RE BOTH OVER."  
1540A = 0
1550GOSUB 310
1560GOTO 1770
1570IF Y3 <= 21 THEN 1620
1580PRINT "YOU'RE OVER!"
1590A = 1
1600GOSUB 310
1610GOTO 1770
1620IF M3 <= 21 THEN 1670
1630PRINT "I'M OVER."
1640A = -1  
1650GOSUB 310
1660GOTO 1770
1670IF Y5 = 0 THEN 1700
1680IF Y3>11 THEN 1700
1690Y3 = Y3 + 10  
1700IF M5 = 0 THEN 1730
1710IF M3>11 THEN 1730
1720M3 = M3 + 10  
1730PRINT "YOU HAVE"Y3  
1740PRINT "I HAVE  "M3  
1750A = SGN(M3-Y3)
1760GOSUB 310
1770RETURN  
1780REM PROCEDURE BETS  
1790PRINT
1800PRINT "HOW MUCH WOULD YOU LIKE TO BET";  
1810INPUT R 
1820B=INT(R)
1830IF B=0 THEN 1790
1840IF B<0 THEN 1890
1850IF B<=25000 THEN 1910
1860 IF B>100000 THEN 1890
1870 PRINT "SORRY, HOUSE LIMIT ON ALL BETS IS $"25000 
1880GOTO 1790
1890PRINT "GET *L*O*S*T*"  
1900GOTO 1790
1910IF B<100 THEN 2040
1920PRINT "I CAN SEE THAT."
1930PRINT
1940 IF S8=1 THEN 2030
1950 IF B8<>1 THEN 2030
1960 PRINT "DO YOU WISH TO RESHUFFLE THE CARDS";
1970 INPUT B7  
1980 IF B7=0 THEN 2020
1990 IF B7<>1 THEN 1930
2000 PRINT "THE CARDS HAVE BEEN RESHUFFLED." 
2010 GOSUB 670
2020 B8=0
2030RETURN  
2040 PRINT"WHAT?? JUST A SMALL $"B"?  BE A BIG SPENDER AND TRY A LARGER BET...." 
2050GOTO 1790
2060REM PROCEDURE HITS  
2070A1 = Y5 
2080GOSUB 1100
2090Y5=A1
2100Y = D1  
2110PRINT
2120Y6=Y 
2130GOSUB 1250
2140PRINT "";  
2150X1 = Y  
2160GOSUB 510
2170Y3 = Y3 + V
2180RETURN  
2190REM PROCEDURE TAB
2200Y6=Y2
2210GOSUB 1250
2220PRINT TAB(19);"***" 
2230Y6 = Y1 
2240GOSUB 1250
2250PRINT "";  
2260Y6 = M1 
2270GOSUB 1250
2280PRINT
2290RETURN  
2300REM BEGINNING OF MAIN PROGRAM
2310PRINT
2320PRINT
2330PRINT"TYPE A '1' IF YOU WISH ASSISTANCE ON HOW TO PLAY, ELSE TYPE '0'."
2340PRINT"(REMEMBER TO DEPRESS THE ' RETURN ' KEY AFTER THIS " 
2350PRINT "AND ALL OTHER QUESTIONS YOU ARE ASKED.)  WHICH"; 
2360INPUT T1
2370IF T1=0 THEN 2530
2380IF T1=1 THEN 2420
2390PRINT
2400 PRINT "REPLY AS DESIGNATED ABOVE, PLEASE"; 
2410GO TO 2360
2420PRINT
2430PRINT "WE ARE GOING TO SIMULATE A GAME OF BLACKJACK 'ACCORDING TO HOYLE'."
2440PRINT"THE COMPUTER WILL BE THE DEALER IN THE GAME AND YOU, THE GAMBLER."  
2450PRINT"THE DEALER RECOGNIZES FIVE AND SIX CARD CHARLEY." 
2460PRINT "ALL QUESTIONS MAY BE ANSWERED '1' FOR YES, '0' FOR NO."
2470PRINT "IN ADDITION, 'ANOTHER GAME?' MAY BE ANSWERED" 
2480PRINT"     '2' = RESHUFFLE THE CARDS, '3' = TAKE A NEW BET,"  
2490PRINT"     '4' = TOTAL THE WINNINGS,  '5' = TYPE THE CURRENT BET."  
2500PRINT
2510PRINT "PLEASE NOTE:  THE HOUSE LIMIT ON ALL BETS IS $";25000  
2520PRINT
2530M4 = 0  
2540P4 = 0  
2550FOR N = 0 TO 51  
2560K(20+N+1) = INT(N/13)*87 + N + 1
2570NEXT N  
2580GOSUB 1780
2590REM  GAME; 
2600N1 = 52 
2610GOSUB 640
2620A1 = M5 
2630GOSUB 1100
2640M5=A1
2650X = D1  
2660PRINT "DEALER BURNS";  
2670Y6 = X  
2680GOSUB 1250
2690PRINT
2700PRINT
2710X1 = X  
2720GOSUB 510
2730IF V = 1 THEN 2590
2740REM  HAND; 
2750M5 = 0  
2760Y5 = 0  
2770S5 = 0  
2780D2 = 0  
2790S1 = 1  
2800M3 = 0  
2810Y3 = 0  
2820S = 0
2830PRINT "YOUR HAND", "  MY HAND"  
2840PRINT
2850A1 = Y5 
2860GOSUB 1100
2870Y5=A1
2880Y2 = D1 
2890A1 = M5 
2900GOSUB 1100
2910M5=A1
2920M2 = D1 
2930A1 = Y5 
2940GOSUB 1100
2950Y5=A1
2960Y1 = D1 
2970A1 = M5 
2980GOSUB 1100
2990M5=A1
3000M1 = D1 
3010GOSUB 2190
3020PRINT
3030X1 = M2 
3040GOSUB 510
3050M3 = V  
3060X1 = M1 
3070GOSUB 510
3080M3 = M3 + V
3090IF Y2 - Y1 <> INT((Y2-Y1)/100)*100 THEN 3370
3100IF M5 = 0 THEN 3130
3110IF M3 <> 11 THEN 3130
3120GOTO 3370
3130REM  S; 
3140PRINT "DO YOU WANT TO SPLIT YOUR OPENERS";  
3150INPUT R 
3160IF R = 1 THEN 3200
3170IF R = 0 THEN 3370
3180GOSUB 470
3190GOTO 3130
3200REM SPL;
3210S5 = 1  
3220S = Y2  
3230A1 = Y5 
3240GOSUB 1100
3250Y5=A1
3260Y2 = D1 
3270PRINT "  FIRST HAND"
3280PRINT
3290Y6 = Y2 
3300GOSUB 1250
3310PRINT
3320PRINT
3330Y6 = Y1 
3340GOSUB 1250
3350PRINT
3360PRINT
3370REM CK; 
3380X1=Y1
3390GOSUB 510
3400Y3=V 
3410X1=Y2
3420GOSUB 510
3430Y3=Y3+V 
3440X1=M1
3450GOSUB 510
3460M3=V 
3470X1=M2
3480GOSUB 510
3490M3=M3+V 
3500C=4  
3510IF M5=0 THEN 3600
3520IF M3<>11 THEN 3600
3530IF Y5=0 THEN 3600
3540IF Y3<>11 THEN 3600
3550GOSUB 1430
3560PRINT "ALTHO I CANT BELIEVE IT, WE BOTH HAVE BLACKJACK!"
3570A=0  
3580GOSUB 310
3590GOTO 4230
3600IF M5=0 THEN 3660
3610IF M3<>11 THEN 3660
3620PRINT "I HAVE BLACKJACK!" 
3630A=1  
3640GOSUB 310
3650GOTO 4230
3660IF Y5=0 THEN 3720
3670IF Y3<>11 THEN 3720
3680PRINT "YOU HAVE BLACKJACK."  
3690A=-1.5  
3700GOSUB 310
3710GOTO 4230
3720IF Y3<>11 THEN 3850
3730IF S<>0 THEN 3850
3740PRINT "DO YOU WANT TO DOUBLE THE BET, AND TAKE ONLY ONE CARD";
3750INPUT R 
3760IF R=0 THEN 3850
3770IF R=1 THEN 3800
3780GOSUB 470
3790GOTO 3740
3800GOSUB 2060
3810PRINT
3820B=B*2
3830D2=1 
3840GOTO 3990
3850FOR N=3 TO 6  
3860PRINT "  HIT";
3870INPUT R 
3880IF R=1 THEN 3920
3890IF R=0 THEN 3990
3900GOSUB 470
3910GOTO 3860
3920GOSUB 2060
3930IF Y3<=20 THEN 3960
3940PRINT
3950GOTO 3990
3960IF N<>5 THEN 3980
3970PRINT "YOU HAVE 5 CARDS,";
3980NEXT N  
3990IF C<>7 THEN 4020
4000IF Y3>=22 THEN 4020
4010GOSUB 580
4020IF S5=1 THEN 4260
4030GOSUB 1430
4040REM HIT ME;
4050IF M3>16 THEN 4210
4060IF M5=0 THEN 4090
4070IF M3<=6 THEN 4090
4080IF M3<11 THEN 4210
4090A1=M5
4100GOSUB 1100
4110M5=A1
4120M=D1 
4130PRINT "I DRAW          "; 
4140Y6=M 
4150GOSUB 1250
4160PRINT
4170X1=M 
4180GOSUB 510
4190M3=M3+V 
4200GOTO 4040
4210REM STOP;  
4220GOSUB 1500
4230REM OUT;
4240IF S5=0 THEN 4260
4250S1=0 
4260REM L;  
4270IF D2=0 THEN 4300
4280B=B/2
4290D2=0 
4300IF S5=0 THEN 4490
4310S5=0 
4320Y1=S 
4330S=Y3 
4340X1=Y1
4350GOSUB 510
4360Y5=0 
4370IF V=0 THEN 4390
4380Y5=1 
4390PRINT
4400A1=Y5
4410GOSUB 1100
4420Y5=A1
4430Y2=D1
4440PRINT "  SECOND HAND       MY HAND"
4450PRINT
4460GOSUB 2190
4470PRINT
4480GOTO 3370
4490IF S=0 THEN 4560
4500IF S1=0 THEN 4560
4510Y3=S 
4520PRINT
4530PRINT "  RESULT OF FIRST HAND"  
4540PRINT
4550GOSUB 1500
4560PRINT
4570PRINT "ANOTHER GAME";  
4580INPUT R 
4590PRINT
4600I=R  
4610IF I = 5 THEN 4780
4620 IF I <> 2 THEN 4640
4630 S8=1
4640 IF I<>3 THEN 4660
4650 B8=1
4660 REMARK 
4670IF I = 0 THEN 4690
4680IF I<>4 THEN 4720
4690REM PROCEDURE END OF GAME 
4700PRINT "YOU WON $"P4"   I WON $"M4  
4710IF I=4 THEN 4560
4720IF I<>3 THEN 4740
4730GOSUB 1780
4740S2=I+1  
4750 GOTO 240
4760GOSUB 470
4770GOTO 4570
4780REM PROCEDURE TBET(B)  
4790PRINT "THE CURRENT BET IS $"B
4800PRINT
4810GOTO 4570
4820D=M4-P4 
4830IF D<=0 THEN 4870
4840PRINT "YUK-YUK"  
4850PRINT "AND $"D" IS ADDED TO THE ACCOUNTING INFORMATION."
4860GOTO 4930
4870IF D>=0 THEN 4910
4880PRINT "CHEATER." 
4890PRINT "AND $"-D" IS REMOVED FROM THE SYSTEM ACCOUNTING."
4900GOTO 4930
4910PRINT "MY GAME WAS OFF."  
4920REM END BLACKJACK
4930END  
    