              BLISS  DEBUGGING  SUPPORT
                =========================

                                WM. A. WULF
                                APRIL 23, 1971


INTRODUCTION
------------

   DDT MAY BE USED TO DEBUG PROGRAMS WRITTEN IN BLISS. HOWEVER,
THE USE OF DDT ALONE REQUIRES A FAIRLY DETAILED KNOWLEDGE OF THE 
RUN-TIME REPRESENTATION OF BLISS PROGRAMS (STRUCTURE OF 
THE STACK, ETC.) AND IS NOT ESPECIALLY CONVENIENT. IN
PARTICULAR, DDT CANNOT EXPLOIT ANY SPECIAL INFORMATION ABOUT
THE STRUCTURE OF THE OBJECT PROGRAM. THE SERIOS BLISS PROGRAMMER
IS WELL ADVISED TO LEARN THE BLISS RUN-TIME STRUCTURE --
NEVERTHELESS, THERE ARE STILL A NUMBER OF DEBUGGING AIDS
WHICH DDT DOES NOT PROVIDE. IN ORDER TO IMPROVE THE SITUATION,
A MODULE CALLED "HELP" HAS BEEN WRITTEN TO AUGMENT THE FACILITIES
OF DDT. THIS MODULE MAY BE LOADED (ALONG WITH DDT) WITH ANY
BLISS PROGRAM -- ALTHOUGH RECOMPILATION OF HELP IS NECESSARY
IF THE USER IS NOT USING THE STANDARD BLISS SYSTEM REGISTERS.
"HELP" IS WRITTEN IN BLISS AND THEREFORE THE FACILITIES DESCRIBED BELO
BELOW MAY BE CALLED DIRECTLY FROM THE USERS SOURCE PROGRAM EVEN
THOUGH THEY ARE PRIMARILY INTENDED FOR USE FROM DDT.


FACILITIES
----------

   THE FEATURES CURRENTLY IMPLEMENTED ALLOW DISPLAY OF THE
USER'S STACK, TRACING OF CALLS ON SPECIFIC ROUTINES,
DISPLAY OF VARIABLES AND REGIONS, AND AN EXTENSION OF THE
ALT-MODE-X ($X) FEATURE OF DDT. THESE FEATURES ARE PROVIDED
BY A SET OF GLOBAL ROUTINES IN THE HELP MODULE; THESE ROUTINES
ARE DESCRIBED IN DETAIL BELOW.

   THERE ARE THREE WAYS IN WHICH ONE OF THE ROUTINES IN HELP MAY 
BE ENTERED: A DIRECT CALL FROM THE USERS PROGRAM, FROM A DDT
CONDITIONAL BREAK-POINT, OR BY EXECUTING A "PUSHJ" WITH THE
DDT ALT-MODE-X FEATURE. THE READER IS PRESUMED TO BE FAMILIAR
WITH THESE FEATURES OF DDT.

   CONSIDER AN EXAMPLE: "XSTAK" IS ONE OF THE ROUTINES
PROVIDED -- ITS EFFECT IS TO PRINT A DISPLAY OF THE
USERS STACK, SHOWING THE ROUTINES CALLED, WHERE THEY WERE 
CALLED FROM, THEIR ACTUAL PARAMETERS, AND THEIR LOCAL VARIABLES.
THE FORMAT OF THIS DISPLAY WILL BE DESCRIBED BELOW. NOW, 
SUPPOSE YOU HAVE A ROUTINE NAMED "THUD" AND YOU SET A DDT
BREAKPOINT BY TYPING:

                THUD+2$B

AT SOME LATER TIME, WHEN YOUR PROGRAM IS RUNNING A CALL WILL
BE MADE ON THUD, THE BREAKPOINT WILL OCCUR, AND DDT WILL
TYPE:

                $NB>>THUD+2

AT THIS POINT YOU MAY DISPLAY THE CURRENT STACK BY USING
"XSTAK" AND ENTERING IT VIA THE $X FEATURE -- IE. TYPE*

                PUSHJ SREG,XSTAK$X

(BE SURE TO USE THE PROPER VALUE FOR "SREG" -- NORMALLY
ITS 0.) AFTER THE DISPLAY IS FINISHED YOU'LL BE BACK
IN DDT AND MAY PROCEED VIA AN $P, OR DO WHATEVER ELSE
SUITS YOUR FANCY.

   AN ALTERNATIVE TO THE EXAMPLE ABOVE IS TO USE THE
CONDITIONAL BREAKPOINT FEATURE OF DDT. FOR EXAMPLE, SUPPOSE
YOU SET BREAKPOINT #1 AT THUD BY TYPING

                THUD+2$1B

AND SET THE CONDITIONAL BREAKPOINT INSTRUCTION AT $1B+1
TO THE SAME OLD PUSHJ:

                $1B+1/ XXXX  PUSHJ SREG,XSTAK

NOW, AS SOON AS THE CALL ON THUD IS MADE THE STACK WILL
AUTOMATICALLY GET THE STACK DISPLAY -- THEN THE BREAKPOINT WILL
OCCUR.  THIS MODE OF USING HELP IS MORE USEFUL WITH SOME
OF THE OTHER HELP ROUTINES TO BE DESCRIBED BELOW.

   ALL OF THE GLOBAL ROUTINES IN HELP HAVE NAMES OF THE
FORM:

                XZZZZ
        OR      XZZZZC
        OR      XZZZZB
        OR      XZZZZP

THAT IS, THEY ALL START WITH THE LETTER "X" FOLLOWED
BY A FOUR CHARACTER NEMONIC, FOLLOWED BY A BLANK, A "C",
A "B", OR A "P". ROUTINES WITH A COMMON
"ZZZZ" ALL PERFORM THE SAME FUNCTION; THE SUFFIX DETERMINES
WHAT HAPPENS AFTER THE FUNCTION IS COMPLETE. IN PARTICULAR
THE FOLLOWING TABLE SUMMERIZES THE MEANING OF THE VARIOUS
SUFFIX LETTERS:


        SUFFIX                  MEANING
        ------          -----------------------------------------
BLANK                   -IF CALLED FROM A USER PROGRAM, SIMPLY
                        RETURN AND PROCEED AS USUAL.
                        -IF CALLED BY $X, RETURN TO DDT
                        TO PERMIT USER TO DO HIS THING.
                        -IF CALLED FROM COND. BREAKPOINT, TREAT
                        AS A "B" SUFFIX (SEE BELOW).
                        
C                       -FOR CONDITIONAL BREAKPOINT ONLY,
                         AFTER COMPLETING FUNCTION CAUSE
                        DDT TO DECREASE ITS PROCEED
                        COUNT AND POSSIBLY BREAK.
                        
B                       FOR CONDITIONAL BREAKPOINT ONLY,
                        AFTER COMPLETING FUNCTION FORCE
                        A BREAK.

P                       FOR CONDITIONAL BREAKPOINT ONLY,
                        AFTER COMPLETINF FUNCTION FORBE
                        PROGRAM TO PROCEED (LIKE AN $P).



THE GLOBAL ROUTINES PROVIDED IN THIS RELEASE , AND THEIR
FUNCTIONS, ARE SUMMERIZED IN THE FOLLOWING TABLE:



ROUTINE                 FUNCTION
-------         ------------------------------------------------

XSTACK          DISPLAY THE USERS STACK IN THE FORM:
XSTACKC
XSTACKB                 A  (_ B+13)   1:0,,0    2:0,,1356
XSTACKP                    1:0,,13    2:1702,,X+1

                        B  (_ C+25)

                        C  (_ D+44)   1:1,,1

                                ETC.

                THE NAMES IN THE LEFT COLUMN ARE THOSE OF THE
                VARIOUS ROUTINES CALLED. ON THE SAME LINE IN THE
                LOCATION FROM WHICH THE ROUTINE WAS CALLED,
                EG. "(_ C+25)", AND THE ACTUAL PARAMETERS
                DISPLAYED IN HALF-WORD OCTAL FORMAT. ON THE
                LINES BELOW THE CALL ARE THE VALUES OF THE
                LOCAL VARIABLES OF THE ROUTINE. NOTE THAT
                THE ACTUALS AND LOCALS ARE INDICATED BY
                POSITION - NOT NAME. ALSO, BE CAREFUL - SOME
                COMPILER -- SO THE POSITION MAY NOT EXACTLY
                CORRESPOND WITH ITS DECLARATION POSITION.
                THE LOCAL POSITIONS DO CORRESPOND WITH
                THOSE SHOWN IN THE "/M" LISTING GENERATED
                BY THE COMPILER.

XCALL           THESE ROUTINES DISPLAY, IN A FORMAT LIKE THAT
XCALLC          ABOVE THE MOST RECENT ROUTINE CALL. ONE USEFUL
XCALLB          APPLICATION OF THESE ROUTINES IS THAT
XCALLP          OF TRACING THE EXECUTION OF ONE
                PARTICULAR ROUTINE. BY PLACING A CONDITIONAL
                BREAKPOINT AT THE HEAD OF THE ROUTINE TO BE
                TRACED AND A "PUSHJ SREG,XCALLP" IN THE
                APPROPRIATE COND-BP LOCATION A TRACE OF THE
                ROUTINE WITH ITS ACTUALS WILL BE OBTAINED.

XAREA           THESE ROUTINES DISPLAY A NUMBER (CURRENTLY 8)
XAREAC          OF CONTIGUOUS AREAS OF MEMORY IN HALF WORD
XAREAB          OCTAL FORMAT.
XAREAB          THE AREAS TO BE DISPLAYED ARE DEFINED
XAREAP          BY NINE TABLES CALLED XAREA0, XAREA1,...,
                XAREA8. EACH OF THESE TABLES IS EIGHT WORDS
                LONG -  THE FORMAT OF EACH WORD IN THESE 
                TABLES IS:

                   .-----------------+----------------.
                   !                 !                !
                   !    SIZE         !    BASE        !        
                   !                 !                !
                   .-----------------+----------------.


                IF ONE OF THESE ROUTINES IS ENTERED FROM
                CONDITIONAL BREAKPOINT #N, THEN THEY WILL
                PRINT THE REGIONS DESCRIBED BY THE TABLE
                "XAREAN".
                   IF, FOR EXAMPLE, YOU WANT TO DISPLAY
                A FIVE-WORD REGION WHOSE BASE ADDRESS IS
                "GLOP" EVERY TIME THE ROUTINE "THUD" IS
                CALLED YOU MIGHT TYPE:
                        
                        THUD+2$1B
                        $1B+1/  XXXX   PUSHJ SREG,XAREAP
                        XAREA1/ XXXX   5,,GLOP

                THEN SIT BACK AND WATCH.
XALTX           THIS ROUTINE IS A GENERALIZATION OF
                THE "$X" FEATURE OF DDT IN THE SENSE THAT 
                IT PROVIDES AN INTERFACE BETWEEN DDT AND ANY
                ROUTINE WRITTEN IN BLISS.  IT WORRIES ABOUT
                ALL THE MESSY DETAILS OF SAVING REGISTERS,
                ETC., NECESSARY TO GET FROM DDT INTO A
                BLISS ROUTINE AND BACK AGAIN WITHOUT DESTROYING
                THINGS ALONG THE WAY.  THE ADDRESS OF THE
                BLISS ROUTINE TO BE CALLED IS SPECIFIED BY 
                THE CONTENTS OF ONE OF THE WORDS: XALTX0,
                XALTX1,...,XALTX8. IF XALTX IS CALLED FROM
                CONDITIONAL BREAKPOINT #N (N=0 IF DIRECT
                OR EXPLICIT "$X" CALL) THEN THE
                CONTENTS OF XALTXN WILL BE USED TO SPECIFY
                THE ROUTINE TO BE CALLED.

                   THE ROUTINE CALLED INDIRECTLY THROUGH
                XALTX IS EXPECTED TO RETURN A VALUE OF 0,1, OR 2
                - THESE VALUES ARE INTERPRETED LIKE THE
                C,B,AND P SUFFIXS RESPECTIVELY.


CONCLUSION
----------

   THE FACILITIES DESCRIBED ABOVE ARE A PRELIMINARY SET
WHICH WILL BE EXPANDED IN THE FUTURE. I HOPE, NAY EXPECT,
USERS OF HELP TO SUGGEST ADDITIONAL AND/OR REVISED
FEATURES.
 