10 REM ** "BLACKJACK" ** - MODIFIED VERSION FOR "PDP10" BASIC
20 DIM K(72)
30 PRINT
40 PRINT
50 PRINT
60 PRINT
70 PRINT
80 PRINT "           * * * * * * B L A C K J A C K * * * * * *"
90 PRINT
100 PRINT
110 REM RANDOM NUMBER GENERATOR WARM UP;
120 RANDOMIZE
130 Z=RND(-4)
140 RANDOM
150 FOR I=1 TO INT(590*Z*5)
160 RANDOM
170 Z1=RND(0)
180 NEXT I
190 RANDOM
200 M5,C=0
210 GOTO 2050
220 REM SWITCH SW
230 IF S2=1 THEN 4490
240 IF S2=2 THEN 2470
250 IF S2=3 THEN 2320
260 IF S2=4 THEN 2470
270 IF S2=5 THEN 3990
280 RETURN
290 REM PROCEDURE SCORE(A)
300 IF A<=0 THEN 360
310 PRINT
320 PRINT "I WIN!!   I WIN !!!"
330 PRINT "I WON $";A*B
340 M4 = M4 + A*B
350 GOTO 440
360 IF A = 0 THEN 420
370 PRINT "YOU WIN $";-A*B
380 PRINT
390 P4 = P4 - A*B
400 PRINT "FINK."
410 GOTO 440
420 PRINT
430 PRINT "STAND-OFF."
440 RETURN
450 REM PROCEDURE W6
460 PRINT "AND";R;" TO YOU TOO."
470 PRINT "I SAID; ";
480 RETURN
490 REM  PROCEDURE BJ
500 PRINT "HAVE BLACKJACK."
510 RETURN
520 REM REAL PROCEDURE VAL(X)
530 Y4 = X1 - INT(X1/100)*100
540 IF Y4>10 THEN 570
550 V = Y4
560 GOTO 580
570 V = 10
580 RETURN
590 REM PROCEDURE CH
600 PRINT "YOU HAVE";C-2;" CARD CHARLEY."
610 A = 12 - 2*C
620 GOSUB 290
630 GOTO 3990
640 RETURN
650 REM PROCEDURE SHUFFLE(N1)
660 PRINT "THE CARDS ARE BEING SHUFFLED."
670 FOR I1 = 0 TO B
680 I3 = RND(0)
690 NEXT I1
700 FOR I1 = N1 TO 2 STEP -1
710 I2 = INT(I1*RND(0)+1)
720 I3 = K(20+I1)
730 K(20+I1) = K(20+I2)
740 K(20+I2) = I3
750 NEXT I1
760 C1 = 1
770 RETURN
780 REM PROCEDURE SUIT(X2)
790 IF X2 >= 100 THEN 820
800 PRINT "CLUB ";
810 GOTO 890
820 IF X2 >= 200 THEN 850
830 PRINT "SPADE ";
840 GOTO 890
850 IF X2 >= 300 THEN 880
860 PRINT "DIAMOND";
870 GOTO 890
880 PRINT "HEART ";
890 RETURN
900 REM PROCEDURE RESHUFFLE
910 FOR I4 = 1 TO C
920 K(20+1-I4) = K(20+53-I4)
930 NEXT I4
940 N1 = 52 - C
950 GOSUB 650
960 FOR I4 = 52 TO 1 STEP -1
970 K(20+I4) = K(20+I4-C)
980 NEXT I4
990 C1 = C+1
1000 RETURN
1010 REM REAL PROCEDURE DRAW(A1)
1020 IF C1 <= 52 THEN 1040
1030 GOSUB 900
1040 X3 = K(20+C1)
1050 D1 = X3
1060 IF A1 = 1 THEN 1100
1070 X1 = X3
1080 GOSUB 520
1090 IF V<>1 THEN 1120
1100 A1 = 1
1110 GOTO 1130
1120 A1 = 0
1130 C1 = C1 + 1
1140 C = C + 1
1150 RETURN
1160 REM PROCEDURE FACE(Y6)
1170 X4 = Y6 - INT(Y6/100)*100
1180 IF X4 <> 11 THEN 1210
1190 PRINT "JACK ";
1200 GOTO 1310
1210 IF X4 <> 12 THEN 1240
1220 PRINT "QUEEN ";
1230 GOTO 1310
1240 IF X4 <> 13 THEN 1270
1250 PRINT "KING ";
1260 GOTO 1310
1270 IF X4 <> 1 THEN 1300
1280 PRINT "ACE ";
1290 GOTO 1310
1300 PRINT X4;
1310 X2 = Y6
1320 GOSUB 780
1330 RETURN
1340 REM PROCEDURE HC
1350 PRINT
1360 PRINT "MY HOLE CARD IS ";
1370 Y6 = M2
1380 GOSUB 1160
1390 PRINT " "
1400 RETURN
1410 REM PROCEDURE TELL
1420 IF Y3 <= 21 THEN 1480
1430 IF M3 <= 21 THEN 1480
1440 PRINT "WE'RE BOTH OVER."
1450 A = 0
1460 GOSUB 290
1470 GOTO 1680
1480 IF Y3 <= 21 THEN 1530
1490 PRINT "YOU'RE OVER."
1500 A = 1
1510 GOSUB 290
1520 GOTO 1680
1530 IF M3 <= 21 THEN 1580
1540 PRINT "I'M OVER."
1550 A = -1
1560 GOSUB 290
1570 GOTO 1680
1580 IF Y5=0 THEN 1610
1590 IF Y3>11 THEN 1610
1600 Y3 = Y3 + 10
1610 IF M5 = 0 THEN 1640
1620 IF M3>11 THEN 1640
1630 M3 = M3 + 10
1640 PRINT "YOU HAVE";Y3
1650 PRINT "I HAVE";M3
1660 A = SGN(M3-Y3)
1670 GOSUB 290
1680 RETURN
1690 REM PROCEDURE BETS
1700 PRINT
1710 PRINT "HOW MUCH WOULD YOU LIKE TO BET";
1720 INPUT R
1730 B = R
1740 IF B <= 0 THEN 1760
1750 IF B < 15000 THEN 1780
1760 PRINT "GET LOST."
1770 GOTO 1700
1780 PRINT "I CAN SEE THAT."
1790 PRINT
1800 RETURN
1810 REM PROCEDURE HITS
1820 A1 = Y5
1830 GOSUB 1010
1840 Y5=A1
1850 Y = D1
1860 PRINT
1870 Y6=Y
1880 GOSUB 1160
1890 PRINT " ";
1900 X1 = Y
1910 GOSUB 520
1920 Y3=Y3+V
1930 RETURN
1940 REM PROCEDURE TAB
1950 Y6=Y2
1960 GOSUB 1160
1970 PRINT " "; " **********"
1980 Y6 = Y1
1990 GOSUB 1160
2000 PRINT " ";
2010 Y6 = M1
2020 GOSUB 1160
2030 PRINT
2040 RETURN
2050 REM BEGINNING OF MAIN PROGRAM
2060 PRINT
2070 PRINT
2080 PRINT "TYPE 'YES' IF YOU WISH INSTRUCTIONS; ELSE TYPE 'NO'."
2090 PRINT "(DO NOT FORGET TO PRESS THE 'RETURN' KEY AFTER THIS"
2100 PRINT "AND ALL OTHER QUESTIONS YOU ARE ASKED.)  WHICH";
2110 INPUT T$
2120 IF T$="NO" THEN 2260
2130 IF T$="YES" THEN 2170
2140 PRINT
2150 PRINT "TYPE 'YES' OR 'NO'; PLEASE";
2160 GO TO 2110
2170 PRINT
2180 PRINT "WE ARE GOING TO PLAY 'BLACKJACK ACCORDING TO HOYLE'."
2190 PRINT "DEALER RECOGNIZES 5 AND 6 CARD CHARLEY."
2200 PRINT "ALL QUESTIONS MAY BE ANSWERED '1' FOR YES; '0' FOR NO."
2210 PRINT "IN ADDITION; 'ANOTHER GAME?' MAY BE ANSWERED"
2220 PRINT "   '2' = RESHUFFLE CARDS; '3' = TAKE A NEW BET;"
2230 PRINT "OR '4' = TOTAL THE WINNINGS."
2240 PRINT
2250 PRINT
2260 M4 = 0
2270 P4 = 0
2280 FOR N = 0 TO 51
2290 K(20+N+1) = INT(N/13)*87 + N + 1
2300 NEXT N
2310 GOSUB 1690
2320 REM  GAME;
2330 N1 = 52
2340 GOSUB 650
2350 A1 = M5
2360 GOSUB 1010
2370 M5=A1
2380 X = D1
2390 PRINT "DEALER BURNS   ";
2400 Y6 = X
2410 GOSUB 1160! GOSUB
2420 PRINT 
2430 PRINT
2440 X1 = X
2450 GOSUB 520
2460 IF V = 1 THEN 2320
2470 REM  HAND;
2480 M5 = 0
2490 Y5 = 0
2500 S5 = 0
2510 D2 = 0
2520 S1 = 1
2530 M3 = 0
2540 Y3 = 0
2550 S = 0
2560 PRINT "YOUR HAND"; "  MY HAND"
2570 PRINT
2580 A1 = Y5
2590 GOSUB 1010
2600 Y5=A1
2610 Y2 = D1
2620 A1 = M5
2630 GOSUB 1010
2640 M5=A1
2650 M2 = D1
2660 A1 = Y5
2670 GOSUB 1010
2680 Y5=A1
2690 Y1 = D1
2700 A1 = M5
2710 GOSUB 1010
2720 M5=A1
2730 M1 = D1
2740 GOSUB 1940
2750 PRINT
2760 X1 = M2
2770 GOSUB 520
2780 M3 = V
2790 X1 = M1
2800 GOSUB 520
2810 M3 = M3 + V
2820 IF Y2 - Y1 <> INT((Y2-Y1)/100)*100 THEN 3100
2830 IF M5 = 0 THEN 2860
2840 IF M3 <> 11 THEN 2860
2850 GOTO 3100
2860 REM  S;
2870 PRINT "DO YOU WANT TO SPLIT YOUR OPENERS";
2880 INPUT R
2890 IF R = 1 THEN 2930
2900 IF R = 0 THEN 3100
2910 GOSUB 450
2920 GOTO 2860
2930 REM SPL;
2940 S5 = 1
2950 S = Y2
2960 A1 = Y5
2970 GOSUB 1010
2980 Y5=A1
2990 Y2 = D1
3000 PRINT "  FIRST HAND"
3010 PRINT
3020 Y6 = Y2
3030 GOSUB 1160
3040 PRINT " "
3050 PRINT
3060 Y6 = Y1
3070 GOSUB 1160
3080 PRINT " "
3090 PRINT
3100 REM CK;
3110 X1=Y1
3120 GOSUB 520
3130 Y3=V
3140 X1=Y2
3150 GOSUB 520
3160 Y3=Y3+V
3170 X1=M1
3180 GOSUB 520
3190 M3=V
3200 X1=M2
3210 GOSUB 520
3220 M3=M3+V
3230 C=4
3240 IF M5=0 THEN 3340
3250 IF M3<>11 THEN 3340
3260 IF Y5=0 THEN 3340
3270 IF Y3<>11 THEN 3340
3280 GOSUB 1340
3290 PRINT "WE BOTH ";
3300 GOSUB 490
3310 A=0
3320 GOSUB 290
3330 GOTO 3990
3340 IF M5=0 THEN 3410
3350 IF M3<>11 THEN 3410
3360 PRINT " I ";
3370 GOSUB 490
3380 A=1
3390 GOSUB 290
3400 GOTO 3990
3410 IF Y5=0 THEN 3480
3420 IF Y3<>11 THEN 3480
3430 PRINT "YOU ";
3440 GOSUB 490
3450 A=-1.5
3460 GOSUB 290
3470 GOTO 3990
3480 IF Y3<>11 THEN 3610
3490 IF S<>0 THEN 3610
3500 PRINT "DO YOU WANT TO DOUBLE THE BET; AND TAKE ONLY ONE CARD";
3510 INPUT R
3520 IF R=0 THEN 3610
3530 IF R=1 THEN 3560
3540 GOSUB 450
3550 GOTO 3500
3560 GOSUB 1810
3570 PRINT" "
3580 B=B*2
3590 D2=1
3600 GOTO 3750
3610 FOR N=3 TO 6
3620 PRINT "  HIT";
3630 INPUT R
3640 IF R=1 THEN 3680
3650 IF R=0 THEN 3750
3660 GOSUB 450
3670 GOTO 3620
3680 GOSUB 1810
3690 IF Y3<=20 THEN 3720
3700 PRINT " "
3710 GOTO 3750
3720 IF N<>5 THEN 3740
3730 PRINT "YOU HAVE 5 CARDS."
3740 NEXT N
3750 IF C<>7 THEN 3780
3760 IF Y3>=22 THEN 3780
3770 GOSUB 590
3780 IF S5=1 THEN 4020
3790 GOSUB 1340
3800 REM HIT ME;
3810 IF M3>16 THEN 3970
3820 IF M5=0 THEN 3850
3830 IF M3<=6 THEN 3850
3840 IF M3<11 THEN 3970
3850 A1=M5
3860 GOSUB 1010
3870 M5=A1
3880 M=D1
3890 PRINT "I DRAW     ";
3900 Y6=M
3910 GOSUB 1160
3920 PRINT " "
3930 X1=M
3940 GOSUB 520
3950 M3=M3+V
3960 GOTO 3800
3970 REM STOP;
3980 GOSUB 1410
3990 REM OUT;
4000 IF S5=0 THEN 4020
4010 S1=0
4020 REM L;
4030 IF D2=0 THEN 4060
4040 B=B/2
4050 D2=0
4060 IF S5=0 THEN 4250
4070 S5=0
4080 Y1=S
4090 S=Y3
4100 X1=Y1
4110 GOSUB 520
4120 Y5=0
4130 IF V=0 THEN 4150
4140 Y5=1
4150 PRINT
4160 A1=Y5
4170 GOSUB 1010
4180 Y5=A1
4190 Y2=D1
4200 PRINT "  SECOND HAND       MY HAND"
4210 PRINT
4220 GOSUB 1940
4230 PRINT
4240 GOTO 3100
4250 IF S=0 THEN 4320
4260 IF S1=0 THEN 4320
4270 Y3=S
4280 PRINT
4290 PRINT "  RESULT OF FIRST HAND"
4300 PRINT
4310 GOSUB 1410
4320 PRINT
4330 PRINT "ANOTHER GAME";
4340 INPUT R
4350 PRINT
4360 PRINT
4370 I=R
4380 IF I = 0 THEN 4400
4390 IF I<>4 THEN 4430
4400 PRINT
4410 PRINT "YOU WON $";P4;"   I WON $";M4
4420 IF I=4 THEN 4320
4430 IF I<>3 THEN 4450
4440 GOSUB 1690
4450 S2=I+1
4460 GOSUB 220
4470 GOSUB 450
4480 GOTO 3990
4490 D=M4-P4
4500 IF D<=0 THEN 4540
4510 PRINT "YUK-YUK"
4520 PRINT "AND $";D;" IS ADDED TO YOUR BILL."
4530 GOTO 4590
4540 IF D>=0 THEN 4580
4550 PRINT "CHEATER."
4560 PRINT "AND $";-D;" IS REMOVED FROM YOUR BILLING TAPE."
4570 GOTO 4590
4580 PRINT "MY GAME WAS OFF."
4590 PRINT
4600 PRINT "AND THANKS FOR PLAYING THE GAME."
4610 QUIT
  