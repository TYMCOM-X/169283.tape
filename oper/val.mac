        TITLE VAL   -F4 SUB STRING TO NUM CNVT
        ENTRY VAL

; F4 SUBROUTINE TO CONVERT A STRING TO
;  INTERNAL REAL VALUE. NUMERIC CONVERSION
; USAGE:
;   CALL VAL(IPTR,RVAL,IERR)  
;  WHERE IPTR IS STRING POINTER TO BEGINNING OF STRING (1ST CHAR)
;  RVAL WILL BE ARITHMETIC VALUE OF STRING ON RETURN
;  IERR WILL BE LABEL (ASSIGNED) TO TRANSFER TO ON SCAN ERROR

; ROUTINE USES  FORSE. ROUTINE FLIRT. TO DO THE CONVERSION.

P=17
M=7
R0=0

VAL: 0
        MOVE R0,@(16)     ;GET STRING POINTER
        MOVEM R0,HDR+1    ;SET UP SIMULATED HEADER FOR CHINN.
        MOVEI R0,7777777  ;LARGE # OF CHAR IN SIMULATED HEADER
        MOVEM RO,HDR+2

        MOVEI M,HDR       ;SET UP STACK FOR CALL TO FLIRT.
        MOVEI R0,FMTWD    ; AND REGISTERS
        PUSH P,R0
        PUSHJ P,FLIRT    ;CALL FLIRT. NOW.
        JRST @2(16)       ; ERROR RETURN
        MOVEM R0,@1(16)    ;RETURN RESULT
        JRA 16,3(16)    ;AND RETURN

;-----
FMTWD: 0
HDR: EXP 0,0,0

   END
