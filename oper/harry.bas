100 DIM Y(150),Z(150),O(25),B(25)
110 FILES TEMP
120 SCRATCH #1
125 QUOTE #1
130 Z$="HI"
140 PRINT"1ST FILE NAME";
150 GO TO 170
160 PRINT"NEXT FILE";
170 INPUT B$
180 IF B$="NONE" THEN 2140
190 F8=0
200 FILE#2,B$
210 READ#2,A$,H,L,N,A7,B5
220 F8=F8+1
230 IF F8>25 THEN 270
240 IF L<75 THEN 290
250 RESTORE#2
260 GO TO 210
270 PRINT" READING L AS:  ";L
280 GO TO 3970
290 F9=L
300 GO SUB 1470
310 GOSUB 1710
320 GOSUB 1780
330 T1=(H-M)/S
340 GOSUB 1920
350 D1=P*100
360 IF L=F9 THEN 380
370 L=F9
380 IF L<>0 THEN 440
390 IF D1<=99.9 THEN 410
400 D1 = 99.9
410 D3=D1
420 D4=-1
430 GO TO 560
440 T1=(M-L)/S
450 GOSUB 1920
460 D2=P*100
470 D3=D1+D2
480 IF D3<=99.9 THEN 500
490 D3=99.9
500 T1=((H-L)/2)/S
510 GOSUB 1920
520 D4=2*P*100
530 PRINT
540 IF Z$="NONE" THEN 1370
550 IF Z$="ALL" THEN 610
560 PRINT"DO YOU WANT DATA AND DISTRIBUTION LISTED";
570 INPUT Z$
580 PRINT
590 IF Z$="ALL" THEN 610
600 IF Z$="NO" THEN 1370
610 PRINT USING 620,R
620:THE RANGE IS ##.##### WHAT IS YOUR CELL INTERVAL
630 INPUT C9
640 PRINT
650 PRINT
660 PRINT A$
670 PRINT
680 PRINT"PC.#     VALUE"
690 FOR I=1 TO 25
700 J=I+25
710 K=I+50
720 L4=I+75
730 IF N<26 THEN 820
740 IF N>50 THEN 770
750 IF I+25<=N THEN850
760 GO TO 820
770 IF N>75 THEN 800
780 IF I+50<=N THEN 870
790 GO TO 850
800 IF I+75<=N THEN 890
810 GO TO 870
820 PRINT I;TAB(5);Z(I)
830 IF I=N THEN 910
840 GO TO 900
850 PRINT I;TAB(5);Z(I);TAB(15);J;TAB(20);Z(J)
860 GO TO 900
870 PRINT I;TAB(5);Z(I);TAB(15);J;TAB(20);Z(J);TAB(30);K;TAB(35);Z(K)
880 GO TO 900
890 PRINT I;TAB(5);Z(I);TAB(15);J;TAB(20);Z(J);TAB(30);K;TAB(35);Z(K);TAB(45);L4;TAB(50);Z(L4)
900 NEXT I
910 FOR I=1 TO 7
920 PRINT
930 NEXT I
940 PRINT USING 950,A$
950:                          'CCCCCCCCCCCCCCCCCC
960 PRINT TAB(24);"FREQUENCY DISTRIBUTION"
970 PRINT TAB(24);"--------- ------------"
980 PRINT
990 PRINT
1000 PRINT TAB(20);"CELLS";TAB(39);"FREQUENCY"
1010 IF R<1 THEN 1030
1020 Z3=1
1030 FOR I=1 TO N
1040 Y(I)=INT(10^Z3*Y(I)+.5)/10^Z3
1050 NEXT I
1060 O(1)=Y(1)
1070 FOR I=2 TO 15
1080 O(I)=O(I-1)+C9
1090 O(I)=INT(10^Z3*O(I)+.5)/10^Z3
1100 IF O(I)>Y(N) THEN 1150
1110 IF O(I)<Y(N) THEN 1140
1120 G9=I
1130 GO TO 1160
1140 NEXT I
1150 G9=I-1
1160 FOR J=1 TO G9
1170 H4=0
1180 FOR I =1 TO N
1190 O(J)=INT(10^Z3*O(J)+.5)/10^Z3
1200 IF Y(I)>=O(J) THEN 1220
1210 GO TO 1250
1220 IF Y(I)<(O(J)+C9) THEN 1240
1230 GO TO 1250
1240 H4=H4+1
1250 NEXT I
1260 B(J)=H4
1270 NEXT J
1280 FOR I=1 TO G9
1290 O9=O(I)+C9
1300 R6=B(I)
1310 PRINT TAB(15);O(I);TAB(24);"-";O9;TAB(40);
1320 GO SUB 3810
1330 NEXT I
1340 FOR I=1 TO 7
1350 PRINT
1360 NEXT I
1370 IF L=0 THEN 1400
1380 C=6*S
1390 GO TO 1430
1400 C=3*S+M
1410 IF L=F9 THEN 1430
1420 L=F9
1430 WRITE#1,A$;H;L;R;M;C;D3;D4
1440 GO TO 160
1450 STOP
1460 REM   THIS SUBROUTINE FINDS XBAR
1470 M=0
1480 FOR I=1 TO N
1490 READ#2,X
1500 IF A7=0 THEN 1630
1510 IF A7=3 THEN 1560
1520 IF A7=1 THEN 1590
1530 X=X*.0001
1540 Z3=5
1550 GO TO 1610
1560 X=X*.00001
1570 Z3=6
1580 GO TO 1610
1590 X=X*.001
1600 Z3=4
1610 X=X+B5
1620 GO TO 1650
1630 Z3=5
1640 X=X+B5
1650 Y(I)=X
1655 Z(I)=X
1660 M=M+X
1670 NEXT I
1680 M=M/N
1690 RETURN
1700 REM    THIS SUBROUTINE FINDS SIGMA
1710 S=0
1720 FOR I=1 TO N
1730 S=S+(Y(I)-M)^2
1740 NEXT I
1750 S=SQR(S/(N-1))
1760 RETURN
1770 REM   THIS SUBROUTINE FINDS THE RANGE
1780 FOR I=1 TO N-1
1790 Q=I+1
1800 FOR J=Q TO N
1810 IF Y(I)<=Y(J) THEN 1850
1820 T=Y(I)
1830 Y(I)=Y(J)
1840 Y(J)=T
1850 NEXT J
1860 NEXT I
1870 R=Y(N)-Y(1)
1880 RETURN
1890 REM    THIS SUBROUTINE FINDS EXPECTED PERCENT
1900 REM    DEFECTIVE BY INTEGRATING THE PROBABILITY
1910 REM    CURVE BY SIMPSONS RULE
1920 H1=(4.5-T1)/10
1930 S2=0
1940 S4=0
1950 K=1
1960 V=T1+H1
1970 S4=S4+EXP(-(V^2/2))
1980 S2=S2+EXP(-((V+H1)^2/2))
1990 IF K>=13 THEN2030
2000 K=K+2
2010 V=V+H1+H1
2020 GO TO 1970
2030 C1=H1/(3*SQR(6.28319))
2040 S4=4*S4
2050 S2=2*S2
2060 S5=EXP(-(T1^2/2))
2070 S6=EXP(-(4.5^2/2))
2080 S7=EXP(-((4.5-H1)^2/2))
2090 P=C1*(S4+S2+S5+S6+(4*S7))
2100 IF P>0 THEN 2120
2110 P=0
2120 RETURN
2140 PRINT
2150 PRINT"DO YOU WISH TO CALCULATE A CORRELATION COEFFICIENT"
2160 PRINT"FOR TWO VARIABLES";
2170 G3$="AXLE2"
2180 FILE #2,G3$
2190 INPUT G9$
2200 IF G9$="NO" THEN 2890
2210 PRINT"WHAT TWO FILES CONTAIN THE VARIABLES THAT YOU"
2220 PRINT"WISH TO FIND THE COEFFICIENT OF CORRELATION FOR"
2230 INPUT R5$,R6$
2240 FILE #3,R5$
2250 FILE #4,R6$
2260 READ #3,A3$,H,L,N,A7,B5
2270 READ #4,A2$,H,L,N1,A8,B6
2280 IF N<=N1 THEN 2310
2290 N3=N1
2300 GO TO 2320
2310 N3=N
2320 READ #1,A$,H,L,R,M,C,D3,D4
2330 IF A$=A3$ THEN 2370
2340 IF A$=A2$ THEN 2400
2350 IF END#1 THEN 2430
2355 GO TO 2320
2360 GO TO 2430
2370 M3=M
2380 C3=C
2390 GO TO 2350
2400 M2=M
2410 C2=C
2420 GO TO 2350
2430 C3=(C3-M3)/3.0
2440 C2=(C2-M2)/3.0
2450 P1=0
2460 X9=0
2470 Y9=0
2480 S1=0
2490 S2=0
2500 S3=0
2510 S4=0
2520 S5=0
2530 FOR I=1 TO N3
2540 READ#3,X9
2550 X9=X9*A7+B5
2560 READ #4,Y9
2570 Y9=Y9*A8+B6
2580 S1=S1+X9*Y9
2590 S2=S2+X9
2610 S4=S4+X9*X9
2620 S5=S5+Y9*Y9
2630 NEXT I
2640 S6=N3*S1-(S2*S3)
2650 S7=N3*S4-S2^2
2660 S8=N3*S5-S3^2
2670 S9=SQR(S7*S8)
2680 R2=S6/S9
2690 DEF FNH(V)=(EXP(V)-EXP(-V))/(EXP(V)+EXP(-V))
2700 V4=1.96*(1./SQR(N3-3))
2710 V5=.5*LOG((1.+R2)/(1.-R2))
2720 V6=V5-V4
2730 F7=FNH(V6)
2740 V7=V5+V4
2750 F9=FNH(V7)
2760 RESTORE #1
2770 PRINT
2780 PRINT"THE CORRELATION COEFFICIENT OF ";A2$
2790 PRINT USING 2800,A3$,R2
2800:AND OF  'LLLLLLLLLLLLLLLLLLLLLLLLLL=##.####
2810 PRINT
2820 PRINT USING 2830,F7,F9
2830:THE 95% CONFIDENCE LIMITS ARE: ##.####  AND  ##.####
2840 PRINT
2850 PRINT"DO YOU WISH TO CALCULATE MORE CORRELATION COEFFICIENTS";
2860 INPUT Z9$
2870 IF Z9$="YES" THEN 2170
2880 PRINT
2890 PRINT
2900 PRINT"ENTER PART NAME,NUMBER ,MODEL NO.,OPER. NO. AND NAME"
2910 PRINT"SEPERATED BY COMMAS:"
2920 INPUT P$,A9,Q$,C9,E$
2930 PRINT
2940 PRINT"ENTER MACHINE NO.,MACHINE NAME AND DEPT. NO."
2950 PRINT"SEPERATED BY COMMAS"
2960 INPUT F$,G$,D9
2970 PRINT
2980 PRINT"WHAT IS THE M.C.T.?(IF NONE: ENTER NONE)"
2990 INPUT H$
3000 PRINT
3010 PRINT"IS THIS AN OLD OR A NEW MACHINE";
3020 INPUT I$
3030 PRINT"ENTER YOUR NAME";
3040 INPUT V$
3050 FOR I=1 TO 10
3060 PRINT
3070 NEXT I
3080 PRINT"TO:R.C.MARZADRI--QUAL. ENG. SUPERVISOR";TAB(56);"DATE: TODAY"
3090 PRINT"FROM:";V$
3100 PRINT
3110 PRINT
3120 IF I$="OLD" THEN 3140
3130 PRINT TAB(34);"NEW"
3140 PRINT TAB(27);"MACHINE CAPABILITY"
3150 PRINT TAB(27);"------- ----------"
3160 PRINT
3170 PRINT TAB(10);"PART#&NAME:";TAB(26);A9;"  ";P$;TAB(54);"MOD.#:";Q$
3180 PRINT TAB(10);"----------"
3190 PRINT TAB(10);"OPER.#&NAME:";TAB(26);C9;"  ";E$
3200 PRINT TAB(10);"------------"
3210 PRINT TAB(10);"MACH.#&NAME:";TAB(27);F$;"  ";G$
3220 PRINT TAB(10);"-----------"
3230 PRINT TAB(10);"DEPARTMENT#:";TAB(26);D9
3240 PRINT TAB(10);"-----------"
3250 IF H$="NONE" THEN 3280
3260 PRINT TAB(10);"M.C.T.:";TAB(26);H$
3270 PRINT TAB(10);"------"
3280 PRINT
3290 PRINT"RESULTS:"
3300 PRINT"-------"
3310 PRINT TAB(54);"% DEF AS"
3320 PRINT"CHARACTERISTIC         SPEC  TOL   RNG    AVG   CAP   RUN  CEN  EVAL"
3330 PRINT"--------------         ----  ---   ---    ---   ---   ---  ---  ----"
3340 PRINT
3345 RESTORE #1
3350 READ#1,A$,H,L,R,M,C,D3,D4
3360 IF H=0 THEN 3940
3370 T9=H-L
3380 IF I$="NEW" THEN 3440
3390 IF C<=T9 THEN 3510
3400 IF D4<0 THEN 3470
3410 IF D4<1 THEN3490
3420 O$="NOT CAP"
3430 GO TO 3520
3440 IF C<(.8*T9) THEN 3510
3450 IF C<=T9 THEN 3490
3460 GO TO 3420
3470 IF D3<1 THEN 3490
3480 GO TO 3420
3490 O$="ACCEPT."
3500 GO TO 3520
3510 O$="CAPABLE"
3520 IF D4<0 THEN 3640
3530 F5=M+(C/2)
3540 F6=M-(C/2)
3550 IF R<1 THEN 3610
3560 PRINT USING 3720,A$,L,T9,R,M,F5,D3,D4,O$
3570 PRINT"                                               MAX.EXP."
3580 PRINT USING 3740,H,F6
3590 PRINT"                                               MIN.EXP."
3600 GO TO 3630
3610 PRINT USING 3710,A$,L,T9,R,M,C,D3,D4,O$
3620 PRINT USING 3730,H
3630 GO TO 3690
3640 IF R<1 THEN 3670
3650 PRINT USING 3790,A$,H,R,M,C,D3,O$
3660 GO TO 3680
3670 PRINT USING 3750,A$,H,R,M,C,D3,O$
3680 PRINT TAB(23);"MAX."
3690 PRINT
3700 IF END#1 THEN 3710
3705 GO TO 3350
3710:'LLLLLLLLLLLLLLLLLL ##.#### .#### .#### ##.#### .#### ##.# ##.# 'LLLLLLL
3720:'LLLLLLLLLLLLLLLLLL  ##.#    ##.#  ##.# ##.##   ##.## ##.# ##.# 'LLLLLLL
3730:                    ##.####
3740:                     ##.#                       ##.##
3750:'LLLLLLLLLLLLLLLLLL ##.####   -   .#### ##.#### .#### ##.#  -   'LLLLLLL
3760 FOR I=1 TO 35
3770 PRINT
3780 NEXT I
3790:'LLLLLLLLLLLLLLLLLL  ##.#     -    ##.#  ##.##  ##.## ##.#  -   'LLLLLLL
3800 STOP
3810 IF R6=0 THEN 3920
3815 P7=1
3820 FOR K=1 TO R6
3830 PRINT "*";
3840 P7=P7+1
3850 IF P7<67 THEN 3880
3860 PRINT" ";R6
3870 GO TO 3930
3880 NEXT K
3890 PRINT" ";R6;
3900 PRINT
3910 GO TO 3930
3920 PRINT
3930 RETURN
3940 FOR I=1 TO 25
3950 PRINT
3960 NEXT I
3970 END
  