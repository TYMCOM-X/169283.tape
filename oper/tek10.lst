TEK10.F4	F40	V26(10)	15-MAY-73	15:30	PAGE 1


  		      C* **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:30	PAGE 2


  		      C* *                                                        *
  		      C* *      PROCUCT 062-1464-02                               *
  		      C* *              TERMINAL CONTROL SYSTEM                   *
  		      C* *                                                        *
  		      C* *                                                        *
  		      C* *                                                        *
  		      C* *                                                        *
  		      C* *                SOFTWARE DEVELOPMENT                    *
  		      C* *            INFORMATION DISPLAY PRODUCTS                *
  		      C* *                  TEKTRONIX, INC.                       *
  		      C* *                                                        *
  		      C* *                                                        *
  		      C* *            COPYRIGHT 1971  TEKTRONIX, INC.             *
  		      C* *                 ALL RIGHTS RESERVED                    *
  		      C* *                                                        *
  		      C* *                                                        *
  		      C* **********************************************************
  		      C* *
  		      C* *
  		      C* *
  		      C* *
  		      C*      START OF TERMINAL CONTROL SYSTEM GENERAL MODULES
  		      C*
  		      C*
  		      C*      PLEASE NOTE!!!!!!
  		      C*      IN THE FOLLOWING LISTING COMMENTS FOLLOWED
  		      C*      BY AN  *  ARE INSTALLATION COMMENTS.
  		      C*      THEY INDICATE CONTROL CHARACTERS AND TERMINAL
  		      C*      DEPENDENT OPERATIONS OR VARIABLES,
  		      C*      FOR WHICH MODIFICATIONS MAY BE NEEDED ACCORDING TO
  		      C*      THE SYSTEM USED.
  		      C*
  		      C*
  		      C **********************************************************
  		      C *              BASIC ROUTINES
  		      C **********************************************************
  		      C **********************************************************
  		      C * NAME:     FINITT                                       *
  		      C * PURPOSE:  EXITS AND HALTS PROGRAM                      *
  		      C * USAGE:    CALL FINITT(IX,IY)                           *
  		      C *           IX  SCREEN X COORDINATE                      *
  		      C *           IY  SCREEN Y COORDINATE                      *
  		      C *           TEKTRONIX V1 4-7-71                          *
  		      C **********************************************************
  		      C ROUTINE---DA-0010.05-01   FINITT
  		            SUBROUTINE FINITT(IX,IY)
  		      C * MOVE TO GIVEN POINT
  		            CALL MOVABS(IX,IY)
  		            CALL ANMODE
  		            STOP
  		            END

GLOBAL DUMMIES
TEK10.F4	F40	V26(10)	15-MAY-73	15:30	PAGE 3



IX    	26		IY    	27		

SUBPROGRAMS

MOVABS	ANMODE	EXIT  	

SCALARS

FINITT	30		IX    	26		IY    	27		

 FINITT
TEK10.F4	F40	V26(10)	15-MAY-73	15:30	PAGE 4


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:30	PAGE 5


  		      C * NAME:     BELL                                         *
  		      C * PURPOSE:  OUPUT CONTROL (BEL) TO TERMINAL              *
  		      C * USAGE:    CALL BELL                                    *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---DA-0020.05-01   BELL
  		            SUBROUTINE BELL
  		      C*  OUTPUT (BEL)
  		            CALL TOUTPT(7)
  		            RETURN
  		            END

CONSTANTS

0	000000000007	

SUBPROGRAMS

TOUTPT	

SCALARS

BELL  	16		

 BELL
TEK10.F4	F40	V26(10)	15-MAY-73	15:30	PAGE 6


  		      C ROUTINE---BG-0460.05-01   SUBWIN
TEK10.F4	F40	V26(10)	15-MAY-73	15:30	PAGE 7


  		      C       ROUTINE TO ALTER WINDOW SIZE BUT RETAIN SCALE
  		      C
  		             SUBROUTINE SUBWIN(XV,XL,YV,YL)
  		            COMMON /TKTRNX/ KBAUDR,KERROR,KGRAFL,KHOMEY,KKMODE,
  		           1 KHORSZ,KVERSZ,KITALC,KSIZEF,KLMRGN,KRMRGN,
  		           2 KTBLSZ,KHORZT(10),KVERTT(10),
  		           3 KBEAMX,KBEAMY,KMOVEF,KPCHAR(4),KDASHT,
  		           4 KMINSX,KMINSY,KMAXSX,KMAXSY,TMINVX,TMINVY,TMAXVX,TMAXVY,
  		           5 TREALX,TREALY,TIMAGX,TIMAGY,TRCOSF,TRSINF,TRSCAL
  		      C
  		            SCALE=(KMAXSX-KMINSX)/(TMAXVX-TMINVX)
  		            OFF=XV-TMINVX
  		            IX=KMINSX+OFF*SCALE
  		            LX=XL*SCALE
  		            SCALE=(KMAXSY-KMINSY)/(TMAXVY-TMINVY)
  		            OFF=YV-TMINVY
  		            IY=KMINSY+OFF*SCALE
  		            LY=YL*SCALE
  		            CALL VWINDO(XV,XL,YV,YL)
  		            CALL SWINDO(IX,LX,IY,LY)
  		            RETURN
  		            END

GLOBAL DUMMIES

XV    	121		XL    	122		YV    	123		YL    	124		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

FLOAT 	INT   	VWINDO	SWINDO	

SCALARS

SUBWIN	126		SCALE 	127		KMAXSX	52		KMINSX	50		TMAXVX	56	
TMINVX	54		OFF   	130		XV    	121		IX    	131		LX    	132	
XL    	122		KMAXSY	53		KMINSY	51		TMAXVY	57		TMINVY	55	
YV    	123		IY    	133		LY    	134		YL    	124		KBAUDR	0	
KERROR	1		KGRAFL	2		KHOMEY	3		KKMODE	4		KHORSZ	5	
KVERSZ	6		KITALC	7		KSIZEF	10		KLMRGN	11		KRMRGN	12	
KTBLSZ	13		KBEAMX	40		KBEAMY	41		KMOVEF	42		KDASHT	47	
TREALX	60		TREALY	61		TIMAGX	62		TIMAGY	63		TRCOSF	64	
TRSINF	65		TRSCAL	66		

TEK10.F4	F40	V26(10)	15-MAY-73	15:30	PAGE 8


ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		

 SUBWIN
TEK10.F4	F40	V26(10)	15-MAY-73	15:30	PAGE 9


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:30	PAGE 10


  		      C *             HIGH LEVEL GRAPHIC ROUTINES
  		      C **********************************************************
  		      C **********************************************************
  		      C * NAME:     SWINDO                                       *
  		      C * PURPOSE:  SET SCREEN WINDOW                            *
  		      C * USAGE:    CALL SWINDO(IX,LX,IY,LY)                     *
  		      C *           IX  SCREEN WINDOW X MINIMUM                  *
  		      C *           LX  SCREEN WINDOW X LENGTH                   *
  		      C *           IY  SCREEN WINDOW Y MINIMUM                  *
  		      C *           LY  SCREEN WINDOW Y LENGTH                   *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---BG-0030.05-01   SWINDO
  		            SUBROUTINE SWINDO(IX,LX,IY,LY)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		      C *  SET WINDOW VARIABLES
  		            KMINSX=IX
  		            KMINSY=IY
  		            KMAXSX=IX+LX
  		            KMAXSY=IY+LY
  		      C * INDICATE DIRECT LEVEL
  		            KGRAFL=0
  		            RETURN
  		            END

GLOBAL DUMMIES

IX    	33		LX    	34		IY    	35		LY    	36		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SCALARS

SWINDO	37		KMINSX	50		IX    	33		KMINSY	51		IY    	35	
KMAXSX	52		LX    	34		KMAXSY	53		LY    	36		KGRAFL	2	
KBAUDR	0		KERROR	1		KHOMEY	3		KKMODE	4		KHORSZ	5	
KVERSZ	6		KITALC	7		KSIZEF	10		KLMRGN	11		KRMRGN	12	
KTBLSZ	13		KBEAMX	40		KBEAMY	41		KMOVEF	42		KDASHT	47	
TMINVX	54		TMINVY	55		TMAXVX	56		TMAXVY	57		TREALX	60	
TREALY	61		TIMAGX	62		TIMAGY	63		TRCOSF	64		TRSINF	65	
TEK10.F4	F40	V26(10)	15-MAY-73	15:30	PAGE 11


TRSCAL	66		

ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		

 SWINDO
TEK10.F4	F40	V26(10)	15-MAY-73	15:30	PAGE 12


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:30	PAGE 13


  		      C * NAME:     VWINDO                                       *
  		      C * PURPOSE:  SET VIRTUAL WINDOW                           *
  		      C * USAGE:    CALL VWINDO(X,XL,Y,YL)                       *
  		      C *           X   VIRTUAL WINDOW X MINIMUM                 *
  		      C *           XL  VIRTUAL WINDOW X LENGTH                  *
  		      C *           Y   VIRTUAL WINDOW Y MINIMUM                 *
  		      C *           YL  VIRTUAL WINDOW Y LENGTH                  *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---BG-0040.05-01   VWINDO
  		            SUBROUTINE VWINDO(X,XL,Y,YL)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREAXL, TREAYL, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		      C *  SET WINDOW VARIABLES
  		            TMINVX=X
  		            TMINVY=Y
  		            TMAXVX=X+XL
  		            TMAXVY=Y+YL
  		      C * INDICATE DIRECT LEVEL
  		            KGRAFL=0
  		            RETURN
  		            END

GLOBAL DUMMIES

X     	33		XL    	34		Y     	35		YL    	36		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREAXL	/TKTRNX/+60	TREAYL	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SCALARS

VWINDO	37		TMINVX	54		X     	33		TMINVY	55		Y     	35	
TMAXVX	56		XL    	34		TMAXVY	57		YL    	36		KGRAFL	2	
KBAUDR	0		KERROR	1		KHOMEY	3		KKMODE	4		KHORSZ	5	
KVERSZ	6		KITALC	7		KSIZEF	10		KLMRGN	11		KRMRGN	12	
KTBLSZ	13		KBEAMX	40		KBEAMY	41		KMOVEF	42		KDASHT	47	
KMINSX	50		KMINSY	51		KMAXSX	52		KMAXSY	53		TREAXL	60	
TREAYL	61		TIMAGX	62		TIMAGY	63		TRCOSF	64		TRSINF	65	
TRSCAL	66		

ARRAYS
TEK10.F4	F40	V26(10)	15-MAY-73	15:30	PAGE 14



KHORZT	14		KVERTT	26		KPCHAR	43		

 VWINDO
TEK10.F4	F40	V26(10)	15-MAY-73	15:30	PAGE 15


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:30	PAGE 16


  		      C * NAME:     POINTR                                       *
  		      C * PURPOSE:  OUTPUT RELATIVE POINT PLOT VECTOR            *
  		      C * USAGE:    CALL POINTR(X,Y)                             *
  		      C *           X  X RELATIVE DISPLACEMENT                   *
  		      C *           Y  Y RELATIVE DISPLACEMENT                   *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---BG-0050.05-01   POINTR
  		            SUBROUTINE POINTR(X,Y)
  		      C * CONSTRUCT ABS VECTOR
  		            CALL REL2AB(X,Y,RX,RY)
  		      C * OUTPUT
  		            CALL POINTA(RX,RY)
  		            RETURN
  		            END

GLOBAL DUMMIES

X     	31		Y     	32		

SUBPROGRAMS

REL2AB	POINTA	

SCALARS

POINTR	33		X     	31		Y     	32		RX    	34		RY    	35	

 POINTR
TEK10.F4	F40	V26(10)	15-MAY-73	15:30	PAGE 17


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:30	PAGE 18


  		      C * NAME:     DASHR                                        *
  		      C * PURPOSE:  OUTPUT DASHED RELATIVE VECTOR                *
  		      C * USAGE:    CALL DASHR(X,Y,L)                            *
  		      C *           X  X RELATIVE DISPLACEMENT                   *
  		      C *           Y  Y RELATIVE DISPLACEMENT                   *
  		      C *            L  DASHED LINE SPECIFICATION                *
  		      C *           TEKTRONIX V1 4-7-71                          *
  		      C **********************************************************
  		      C ROUTINE---BG-0060.05-01   DASHR
  		            SUBROUTINE DASHR(X,Y,L)
  		      C * CONSTRUCT ABS VECTOR
  		            CALL REL2AB(X,Y,XL,YL)
  		      C * DRAW THERE
  		            CALL DASHA(XL,YL,L)
  		            RETURN
  		            END

GLOBAL DUMMIES

X     	34		Y     	35		L     	36		

SUBPROGRAMS

REL2AB	DASHA 	

SCALARS

DASHR 	37		X     	34		Y     	35		XL    	40		YL    	41	
L     	36		

 DASHR
TEK10.F4	F40	V26(10)	15-MAY-73	15:30	PAGE 19


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:30	PAGE 20


  		      C * NAME:      DASHA                                       *
  		      C * PURPOSE:   DRAW ABSOLUTE DASHED VECTOR                 *
  		      C * USAGE:     CALL DASHA(X,Y,L)                           *
  		      C *            X ABSOLUTE X (VIRTUAL COORDINATE)           *
  		      C *            Y ABSOLUTE Y (VIRTUAL COORDINATE)           *
  		      C *            L DASHED LINE SPECIFICATION                 *
  		      C *            TEKTRONIX 2-2-72      RW                    *
  		      C **********************************************************
  		      C ROUTINE---BG-0070.05-01   DASHA
  		            SUBROUTINE DASHA(X,Y,L)
  		            CALL LVLCHT
  		            CALL DSHMOD(L)
  		            CALL V2ST(1,X,Y)
  		            RETURN
  		            END

CONSTANTS

0	000000000001	

GLOBAL DUMMIES

X     	33		Y     	34		L     	35		

SUBPROGRAMS

LVLCHT	DSHMOD	V2ST  	

SCALARS

DASHA 	36		L     	35		X     	33		Y     	34		

 DASHA
TEK10.F4	F40	V26(10)	15-MAY-73	15:30	PAGE 21


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:30	PAGE 22


  		      C * NAME:      DSHREL                                      *
  		      C * PURPOSE:   DRAW RELATIVE DASHED VECTOR                 *
  		      C * USAGE:     CALL DSHREL(IX,IY,L)                        *
  		      C *            IX  X RELATIVE DISPLACEMENT                 *
  		      C *            IY  Y RELATIVE DISPLACEMENT                 *
  		      C *            L   DASHED LINE SPECIFICATION               *
  		      C *             TEKTRONIX V1 2-2-72      RW                *
  		      C **********************************************************
  		      C ROUTINE---DA-0080.05-01   DSHREL
  		            SUBROUTINE DSHREL(IX,IY,L)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		      C * CALCULATE THE ABSOLUTE POINT
  		            JX=IX+KBEAMX
  		            JY=IY+KBEAMY
  		      C * DRAW TO IT
  		            CALL DSHABS(JX,JY,L)
  		            RETURN
  		            END

GLOBAL DUMMIES

IX    	33		IY    	34		L     	35		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

DSHABS	

SCALARS

DSHREL	36		JX    	37		IX    	33		KBEAMX	40		JY    	40	
IY    	34		KBEAMY	41		L     	35		KBAUDR	0		KERROR	1	
KGRAFL	2		KHOMEY	3		KKMODE	4		KHORSZ	5		KVERSZ	6	
KITALC	7		KSIZEF	10		KLMRGN	11		KRMRGN	12		KTBLSZ	13	
KMOVEF	42		KDASHT	47		KMINSX	50		KMINSY	51		KMAXSX	52	
KMAXSY	53		TMINVX	54		TMINVY	55		TMAXVX	56		TMAXVY	57	
TREALX	60		TREALY	61		TIMAGX	62		TIMAGY	63		TRCOSF	64	
TRSINF	65		TRSCAL	66		

0.F4	F40	V26(10)	15-MAY-73	15:30	PAGE 23


ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		

 DSHREL
TEK10.F4	F40	V26(10)	15-MAY-73	15:30	PAGE 24


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:30	PAGE 25


  		      C * NAME:      DSHABS                                      *
  		      C * PURPOSE:   DRAW ABSOLUTE DASHED VECTOR                 *
  		      C * USAGE:     CALL DSHABS(IX,IY,L)                        *
  		      C *            IX  ABSOLUTE X (SCREEN COORDINATE)          *
  		      C *            IY  ABSOLUTE Y (SCREEN COORDINATE)          *
  		      C *            L   DASHED LINE SPECIFICATION               *
  		      C *            TEKTRONIX V1 2-2-72  RW                     *
  		      C **********************************************************
  		      C ROUTINE---DA-0090.05-01   DSHABS
  		            SUBROUTINE DSHABS(IX,IY,L)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		      C * SET THE DASH TYPE
  		      1      CALL DSHMOD(L)
  		      C * DRAW THE DASHES
  		      2      CALL TKDASH(IX,IY)
  		            RETURN
  		            END

GLOBAL DUMMIES

IX    	30		IY    	31		L     	32		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

DSHMOD	TKDASH	

SCALARS

DSHABS	33		L     	32		IX    	30		IY    	31		KBAUDR	0	
KERROR	1		KGRAFL	2		KHOMEY	3		KKMODE	4		KHORSZ	5	
KVERSZ	6		KITALC	7		KSIZEF	10		KLMRGN	11		KRMRGN	12	
KTBLSZ	13		KBEAMX	40		KBEAMY	41		KMOVEF	42		KDASHT	47	
KMINSX	50		KMINSY	51		KMAXSX	52		KMAXSY	53		TMINVX	54	
TMINVY	55		TMAXVX	56		TMAXVY	57		TREALX	60		TREALY	61	
TIMAGX	62		TIMAGY	63		TRCOSF	64		TRSINF	65		TRSCAL	66	

ARRAYS

TEK10.F4	F40	V26(10)	15-MAY-73	15:30	PAGE 26


KHORZT	14		KVERTT	26		KPCHAR	43		

 DSHABS
TEK10.F4	F40	V26(10)	15-MAY-73	15:30	PAGE 27


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:30	PAGE 28


  		      C * NAME:     DRAWR                                        *
  		      C * PURPOSE:  DRAW RELATIVE VECTOR                         *
  		      C * USAGE:    CALL DRAWR(X,Y)                              *
  		      C *           X  X RELATIVE DISPLACEMENT                   *
  		      C *           Y  Y RELATIVE DISPLACEMENT                   *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---BG-0100.05-01   DRAWR
  		            SUBROUTINE DRAWR(X,Y)
  		      C * CONSTRUCT ABS VECTOR
  		            CALL REL2AB(X,Y,RX,RY)
  		      C * OUTPUT
  		            CALL DRAWA(RX,RY)
  		            RETURN
  		            END

GLOBAL DUMMIES

X     	31		Y     	32		

SUBPROGRAMS

REL2AB	DRAWA 	

SCALARS

DRAWR 	33		X     	31		Y     	32		RX    	34		RY    	35	

 DRAWR
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 29


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 30


  		      C * NAME:     POINTA                                       *
  		      C * PURPOSE:  OUTPUT ABSOLUTE POINT PLOT VECTOR            *
  		      C * USAGE:    CALL POINTA(X,Y)                             *
  		      C *           X  ABSOLUTE X (VIRTUAL COORDINATE)           *
  		      C *           Y  ABSOLUTE Y (VIRTUAL COORDINATE)           *
  		      C *           TEKTRONIX V1 4-7-71                          *
  		      C **********************************************************
  		      C ROUTINE---BG-0110.05-01   POINTA
  		            SUBROUTINE POINTA(X,Y)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		            CALL LVLCHT
  		      C * CHECK IF IN POINT PLOT MODE
  		            IF(KKMODE.EQ.2)GO TO 10
  		            CALL PNTMOD
  		      C * OUTPUT POINT
  		      10    CALL V2ST(0,X,Y)
  		            RETURN
  		            END

CONSTANTS

0	000000000000	

GLOBAL DUMMIES

X     	33		Y     	34		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

LVLCHT	PNTMOD	V2ST  	

SCALARS

POINTA	35		KKMODE	4		X     	33		Y     	34		KBAUDR	0	
KERROR	1		KGRAFL	2		KHOMEY	3		KHORSZ	5		KVERSZ	6	
KITALC	7		KSIZEF	10		KLMRGN	11		KRMRGN	12		KTBLSZ	13	
KBEAMX	40		KBEAMY	41		KMOVEF	42		KDASHT	47		KMINSX	50	
KMINSY	51		KMAXSX	52		KMAXSY	53		TMINVX	54		TMINVY	55	
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 31


TMAXVX	56		TMAXVY	57		TREALX	60		TREALY	61		TIMAGX	62	
TIMAGY	63		TRCOSF	64		TRSINF	65		TRSCAL	66		

ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		

 POINTA
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 32


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 33


  		      C * NAME:     DRAWA                                        *
  		      C * PURPOSE:  DRAW ABSOLUTE VECTOR                         *
  		      C * USAGE:    CALL DRAWA(X,Y)                              *
  		      C *           X  ABSOLUTE X (VIRTUAL COORDINATE)           *
  		      C *           Y  ABSOLUTE Y (VIRTUAL COORDINATE)           *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---BG-0120.05-01   DRAWA
  		            SUBROUTINE DRAWA(X,Y)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		            CALL LVLCHT
  		      C * CHECK IF IN VECTOR MODE
  		            IF(KKMODE.NE.1)GO TO 20
  		            IF(KMOVEF.EQ.1)GO TO 30
  		            GO TO 10
  		      C * DRAW DUMMY DARK VECTOR TO CURRENT POSITION
  		      20    CALL VECMOD
  		      30    CALL MODCHK(KBEAMX,KBEAMY)
  		      C * OUTPUT VECTOR
  		      10    CALL V2ST(1,X,Y)
  		            RETURN
  		            END

CONSTANTS

0	000000000001	

GLOBAL DUMMIES

X     	42		Y     	43		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

LVLCHT	VECMOD	MODCHK	V2ST  	

SCALARS

DRAWA 	44		KKMODE	4		KMOVEF	42		KBEAMX	40		KBEAMY	41	
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 34


X     	42		Y     	43		KBAUDR	0		KERROR	1		KGRAFL	2	
KHOMEY	3		KHORSZ	5		KVERSZ	6		KITALC	7		KSIZEF	10	
KLMRGN	11		KRMRGN	12		KTBLSZ	13		KDASHT	47		KMINSX	50	
KMINSY	51		KMAXSX	52		KMAXSY	53		TMINVX	54		TMINVY	55	
TMAXVX	56		TMAXVY	57		TREALX	60		TREALY	61		TIMAGX	62	
TIMAGY	63		TRCOSF	64		TRSINF	65		TRSCAL	66		

ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		

 DRAWA
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 35


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 36


  		      C * NAME:     MOVER                                        *
  		      C * PURPOSE:  OUTPUT BLANK RELATIVE VECTOR                 *
  		      C * USAGE:    CALL MOVER(X,Y)                              *
  		      C *           X  X RELATIVE DISPLACEMENT                   *
  		      C *           Y  Y RELATIVE DISPLACEMENT                   *
  		      C *           TEKTRONIX V1 4-7-71                          *
  		      C **********************************************************
  		      C ROUTINE---BG-0130.05-01   MOVER
  		            SUBROUTINE MOVER(X,Y)
  		      C * CONVERT TO ABS VECTOR
  		            CALL REL2AB(X,Y,RX,RY)
  		      C * OUTPUT
  		            CALL MOVEA(RX,RY)
  		            RETURN
  		            END

GLOBAL DUMMIES

X     	31		Y     	32		

SUBPROGRAMS

REL2AB	MOVEA 	

SCALARS

MOVER 	33		X     	31		Y     	32		RX    	34		RY    	35	

 MOVER
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 37


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 38


  		      C * NAME:     REL2AB                                       *
  		      C * PURPOSE:  SCALE AND ROTATE RELATIVE VECTORS AND        *
  		      C *           CONSTRUCT ABSOLUTE VECTORS                   *
  		      C * USAGE:    CALL REL2AB(XIN,YIN,XOUT,YOUT)               *
  		      C *           XIN   X RELATIVE END POINT                   *
  		      C *           YIN   Y RELATIVE END POINT                   *
  		      C *           XOUT  X ABSOLUTE END POINT                   *
  		      C *           YOUT  Y ABSOLUTE END POINT                   *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---BG-0140.05-01   REL2AB
  		            SUBROUTINE REL2AB(XIN,YIN,XOUT,YOUT)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		      C * CHECK GRAPHICS LEVEL
  		            CALL LVLCHT
  		      C * SCALE AND ROTATE X AND Y
  		            XOUT=(((XIN*TRCOSF)-(YIN*TRSINF))*TRSCAL)+TIMAGX
  		            YOUT=(((XIN*TRSINF)+(YIN*TRCOSF))*TRSCAL)+TIMAGY
  		            RETURN
  		            END

GLOBAL DUMMIES

XIN   	44		YIN   	45		XOUT  	46		YOUT  	47		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

LVLCHT	

SCALARS

REL2AB	50		XOUT  	46		XIN   	44		TRCOSF	64		YIN   	45	
TRSINF	65		TRSCAL	66		TIMAGX	62		YOUT  	47		TIMAGY	63	
KBAUDR	0		KERROR	1		KGRAFL	2		KHOMEY	3		KKMODE	4	
KHORSZ	5		KVERSZ	6		KITALC	7		KSIZEF	10		KLMRGN	11	
KRMRGN	12		KTBLSZ	13		KBEAMX	40		KBEAMY	41		KMOVEF	42	
KDASHT	47		KMINSX	50		KMINSY	51		KMAXSX	52		KMAXSY	53	
TMINVX	54		TMINVY	55		TMAXVX	56		TMAXVY	57		TREALX	60	
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 39


TREALY	61		

ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		

 REL2AB
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 40


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 41


  		      C * NAME:     MOVEA                                        *
  		      C * PURPOSE:  DRAW BLANK VECTOR                            *
  		      C * USAGE:    CALL MOVEA(X,Y)                              *
  		      C *           X  ABSOLUTE X (VIRTUAL COORDINATE)           *
  		      C *           Y  ABSOLUTE Y (VIRTUAL COORDINATE)           *
  		      C *           TEKTRONIX V1 4-7-71                          *
  		      C **********************************************************
  		      C ROUTINE---BG-0150.05-01   MOVEA
  		            SUBROUTINE MOVEA(X,Y)
  		            CALL LVLCHT
  		      C * ENTER VECTOR MODE
  		            CALL VECMOD
  		      C * OUTPUT BLANK VECTOR
  		            CALL V2ST(0,X,Y)
  		            RETURN
  		            END

CONSTANTS

0	000000000000	

GLOBAL DUMMIES

X     	30		Y     	31		

SUBPROGRAMS

LVLCHT	VECMOD	V2ST  	

SCALARS

MOVEA 	32		X     	30		Y     	31		

 MOVEA
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 42


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 43


  		      C * NAME:     VCURSR                                       *
  		      C * PURPOSE:  INPUTS CURSOR POSITION AND CONVERTS TO       *
  		      C *           VIRTUAL COORDINATES                          *
  		      C * USAGE:    CALL VCURSR(ICHAR,X,Y)                       *
  		      C *           ICHAR  HEADER CHARACTER                      *
  		      C *           X     CURSOR VIRTUAL X-COORDINATE            *
  		      C *           Y     CURSOR VIRTUAL Y-COORDINATE            *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---BG-0160.05-01   VCURSR
  		            SUBROUTINE VCURSR(ICHAR,X,Y)
  		      C * INPUT DISPLAY SPACE POSITION
  		            CALL DCURSR(ICHAR,IXA,IYA)
  		      C * CONVERT TO VIRTUAL SPACE
  		            CALL REVCOT(IXA,IYA,X,Y)
  		            RETURN
  		            END

GLOBAL DUMMIES

ICHAR 	34		X     	35		Y     	36		

SUBPROGRAMS

DCURSR	REVCOT	

SCALARS

VCURSR	37		ICHAR 	34		IXA   	40		IYA   	41		X     	35	
Y     	36		

 VCURSR
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 44


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 45


  		      C *            GRAPHIC TRANSFORM ROUTINES
  		      C **********************************************************
  		      C **********************************************************
  		      C * NAME:     V2ST                                         *
  		      C * PURPOSE:  TRANSFORMS VIRTUAL DISPLAY VECTORS FOR       *
  		      C *           OUTPUT TO THE SCREEN                         *
  		      C * USAGE:    CALL V2ST(I,X,Y)                             *
  		      C *           I =0  POINT OR MOVE                          *
  		      C *             =1  BRIGHT VECTOR                          *
  		      C *           X    VIRTUAL X-COORDINATE                    *
  		      C *           Y    VIRTUAL Y-COORDINATE                    *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---BG-0170.05-01   V2ST
  		            SUBROUTINE V2ST(I,X,Y)
  		            DIMENSION BUFIN(4),BFOUT(4)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		            EQUIVALENCE (BUFIN(1),XS),(BUFIN(2),YS),(BUFIN(3),XE),
  		           1(BUFIN(4),YE)
  		            EQUIVALENCE (BFOUT(1),CXS),(BFOUT(2),CYS),(BFOUT(3),CXE),
  		           1            (BFOUT(4),CYE)
  		            XE=X
  		            YE=Y
  		      C * POINT OR MOVE
  		            IF(I.EQ.0)GO TO 10
  		      C * BRIGHT VECTOR
  		            XS=TIMAGX
  		            YS=TIMAGY
  		      C * CLIP VECTOR
  		            CALL CLIPT(BUFIN,BFOUT)
  		      C * ON SCREEN?
  		            IF(KERROR.EQ.1)GO TO 110
  		      C * ARE WE AT START POINT?
  		            IF(CXS.EQ.TREALX.AND.CYS.EQ.TREALY)GO TO 120
  		      C * MOVE BEAM TO START POINT
  		            MODE=KKMODE
  		            CALL VECMOD
  		            CALL WINCOT(CXS,CYS)
  		            KKMODE=MODE
  		            GO TO 120
  		      C * POINT OR MOVE
  		      10    CALL PCLIPT(XE,YE)
  		      C * OFF SCREEN?
  		            IF(KERROR.EQ.1)GO TO 110
  		            CXE=XE
  		            CYE=YE
  		      C * CONVERT TO SCREEN COORDINATES AND PLOT
  		      120   CALL WINCOT(CXE,CYE)
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 46


  		      C * SAVE POSITION  ABS AND IMAGINARY
  		            TREALX=CXE
  		            TREALY=CYE
  		      110   TIMAGX=X
  		            TIMAGY=Y
  		            RETURN
  		            END

GLOBAL DUMMIES

I     	107		X     	110		Y     	111		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

EQUIVALENCE

YE    	115		XE    	114		YS    	113		XS    	112		BUFIN 	112	
CYE   	121		CXE   	120		CYS   	117		CXS   	116		BFOUT 	116	

SUBPROGRAMS

CLIPT 	VECMOD	WINCOT	PCLIPT	

SCALARS

V2ST  	122		XE    	114		X     	110		YE    	115		Y     	111	
I     	107		XS    	112		TIMAGX	62		YS    	113		TIMAGY	63	
KERROR	1		CXS   	116		TREALX	60		CYS   	117		TREALY	61	
MODE  	123		KKMODE	4		CXE   	120		CYE   	121		KBAUDR	0	
KGRAFL	2		KHOMEY	3		KHORSZ	5		KVERSZ	6		KITALC	7	
KSIZEF	10		KLMRGN	11		KRMRGN	12		KTBLSZ	13		KBEAMX	40	
KBEAMY	41		KMOVEF	42		KDASHT	47		KMINSX	50		KMINSY	51	
KMAXSX	52		KMAXSY	53		TMINVX	54		TMINVY	55		TMAXVX	56	
TMAXVY	57		TRCOSF	64		TRSINF	65		TRSCAL	66		

ARRAYS

BUFIN 	112		BFOUT 	116		KHORZT	14		KVERTT	26		KPCHAR	43	

 V2ST
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 47


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 48


  		      C * NAME:     CLIPT                                        *
  		      C * PURPOSE:  CLIP LINES FOR WINDOWING                     *
  		      C * USAGE:    CALL CLIPT(BUFIN,OUTBF)                      *
  		      C *           BUFIN(1)   START POINT X                     *
  		      C *                (2)   START POINT Y                     *
  		      C *                (3)   END POINT X                       *
  		      C *                (4)   END POINT Y                       *
  		      C *           OUTBF(1) DISPLAYABLE  START POINT X          *
  		      C *                (2) DISPLAYABLE  START POINT Y          *
  		      C *                (3) DISPLAYABLE  END POINT X            *
  		      C *                (4) DISPLAYABLE  END POINT Y            *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---BG-0180.05-01   CLIPT
  		            SUBROUTINE CLIPT(BUFIN,OUTBF)
  		            DIMENSION  BUFIN(1),OUTBF(1)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		            GSTAX=BUFIN(1)
  		            GSTAY=BUFIN(2)
  		            GENDX=BUFIN(3)
  		            GENDY=BUFIN(4)
  		      C *
  		      C * DETERMINE POSITION OF LINE
  		            IF(GSTAX.GE.TMINVX)GO TO 10
  		            IF(GENDX.GE.TMINVX)GO TO 20
  		      C * LINE LEFT OF WINDOW
  		            GO TO 110
  		      C *
  		      10    IF(GSTAX.LE.TMAXVX)GO TO 20
  		            IF(GENDX.LE.TMAXVX)GO TO 20
  		      C * LINE RIGHT OF WINDOW
  		            GO TO 110
  		      C *
  		      20    IF(GSTAY.GE.TMINVY)GO TO 21
  		            IF(GENDY.GE.TMINVY)GO TO 30
  		      C * LINE BELOW WINDOW
  		            GO TO 110
  		      C *
  		      21    IF(GSTAY.LE.TMAXVY)GO TO 30
  		            IF(GENDY.LE.TMAXVY)GO TO 30
  		      C * LINE ABOVE WINDOW
  		            GO TO 110
  		      C *
  		      30    IF(GSTAX.NE.GENDX)GO TO 31
  		      C * VERTICAL LINE
  		            DSTAX=GSTAX
  		            DENDX=GSTAX
  		            CALL PARCLT(GSTAY,GENDY,TMINVY,TMAXVY,DSTAY,DENDY)
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 49


  		            GO TO 120
  		      C *
  		      31    IF(GSTAY.NE.GENDY)GO TO 40
  		      C * HORIZONTAL LINE
  		            DSTAY=GSTAY
  		            DENDY=GSTAY
  		            CALL PARCLT(GSTAX,GENDX,TMINVX,TMAXVX,DSTAX,DENDX)
  		            GO TO 120
  		      C *
  		      C * CALCULATE START POINT
  		      40    A=GENDX-GSTAX
  		            B=GENDY-GSTAY
  		            IF(GSTAX.LT.TMINVX)GO TO 41
  		            IF(GSTAX.LE.TMAXVX)GO TO 43
  		      C * START X RIGHT OF WINDOW
  		            Q=TMAXVX
  		            GO TO 42
  		      C * START X IN WINDOW
  		      43    IF(GSTAY.GT.TMAXVY)GO TO 140
  		            IF(GSTAY.LT.TMINVY)GO TO 44
  		      C * START POINT IN WINDOW
  		            DSTAX=GSTAX
  		            DSTAY=GSTAY
  		            GO TO 150
  		      C * START X LEFT OF WINDOW
  		      41    Q=TMINVX
  		      42    DSTAY=GSTAY+((Q-GSTAX)*B/A)
  		            IF(DSTAY.GT.TMAXVY)GO TO 140
  		            IF(DSTAY.LT.TMINVY)GO TO 44
  		      C * INTERSECTION IN WINDOW
  		            DSTAX=Q
  		            GO TO 150
  		      C * START Y BELOW WINDOW
  		      44    R=TMINVY
  		            GO TO 45
  		      C * START Y ABOVE WINDOW
  		      140   R=TMAXVY
  		      C *
  		      C * CALCULATE X VALUE OF INTERSECTION
  		      45    DSTAX=GSTAX+((R-GSTAY)*A/B)
  		            IF(DSTAX.GT.TMAXVX)GO TO 110
  		            IF(DSTAX.LT.TMINVX)GO TO 110
  		      C * X INTERSECTION IN WINDOW
  		            DSTAY=R
  		      C *
  		      C * CALCULATE END POINT
  		      150   IF(GENDX.LT.TMINVX)GO TO 50
  		            IF(GENDX.GT.TMAXVX)GO TO 51
  		      C * END X IN WINDOW
  		            IF(GENDY.GT.TMAXVY)GO TO 160
  		            IF(GENDY.LT.TMINVY)GO TO 52
  		      C * END POINT IN WINDOW
  		            DENDX=GENDX
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 50


  		            DENDY=GENDY
  		            GO TO 120
  		      C * X END POINT RIGHT OF WINDOW
  		      51    Q=TMAXVX
  		            GO TO 53
  		      C * X END POINT LEFT OF WINDOW
  		      50    Q=TMINVX
  		      C *
  		      C * CALCULATE Y VALUE OF INTERSECTION
  		      53    DENDY=GSTAY+((Q-GSTAX)*B/A)
  		            IF(DENDY.GT.TMAXVY)GO TO 160
  		            IF(DENDY.LT.TMINVY)GO TO 52
  		      C * Y INTERSECTION IN WINDOW
  		            DENDX=Q
  		            GO TO 120
  		      C * END POINT Y BELOW WINDOW
  		      52    R=TMINVY
  		            GO TO 60
  		      C * END POINT Y ABOVE WINDOW
  		      160   R=TMAXVY
  		      C *
  		      C * CALCULATE X INTERSECTION
  		      60    DENDX=GSTAX+((R-GSTAY)*A/B)
  		      C * X INTERSECTION MUST BE IN WINDOW
  		            DENDY=R
  		      C *
  		      C * RETURN DISPLAYABLE VALUES
  		      120   OUTBF(1)=DSTAX
  		            OUTBF(2)=DSTAY
  		            OUTBF(3)=DENDX
  		            OUTBF(4)=DENDY
  		            KERROR=0
  		            GO TO 70
  		      C *
  		      C * LINE OUTSIDE WINDOW
  		      110   KERROR=1
  		      70    RETURN
  		            END

GLOBAL DUMMIES

BUFIN 	325		OUTBF 	326		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 51


SUBPROGRAMS

PARCLT	

SCALARS

CLIPT 	327		GSTAX 	330		GSTAY 	331		GENDX 	332		GENDY 	333	
TMINVX	54		TMAXVX	56		TMINVY	55		TMAXVY	57		DSTAX 	334	
DENDX 	335		DSTAY 	336		DENDY 	337		A     	340		B     	341	
Q     	342		R     	343		KERROR	1		KBAUDR	0		KGRAFL	2	
KHOMEY	3		KKMODE	4		KHORSZ	5		KVERSZ	6		KITALC	7	
KSIZEF	10		KLMRGN	11		KRMRGN	12		KTBLSZ	13		KBEAMX	40	
KBEAMY	41		KMOVEF	42		KDASHT	47		KMINSX	50		KMINSY	51	
KMAXSX	52		KMAXSY	53		TREALX	60		TREALY	61		TIMAGX	62	
TIMAGY	63		TRCOSF	64		TRSINF	65		TRSCAL	66		

ARRAYS

BUFIN 	325		OUTBF 	326		KHORZT	14		KVERTT	26		KPCHAR	43	

 CLIPT
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 52


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 53


  		      C * NAME:     PARCLT(RL1,RL2,RM1,RM2,RN1,RN2)              *
  		      C * PURPOSE:  CLIP PARALLEL LINE FOR WINDOWING             *
  		      C * USAGE:    CALL PARCLT(RL1,RL2,RM1,RM2,RN1,RN2)         *
  		      C *           RL1   COORDINATE OF START POINT              *
  		      C *           RL2   COORDINATE OF END POINT                *
  		      C *           RM1   MINIMUM WINDOW COORDINATE              *
  		      C *           RM2   MAXIMUM WINDOW COORDINATE              *
  		      C *           RN1   COORDINATE OF CLIPPED START POINT      *
  		      C *           RN2   COORDINATE OF CLIPPED END POINT        *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---BG-0190.05-01   PARCLT
  		            SUBROUTINE PARCLT(RL1,RL2,RM1,RM2,RN1,RN2)
  		            IF(RL1.LT.RM1)GO TO 10
  		            IF(RL1.GT.RM2)GO TO 20
  		            RN1=RL1
  		            IF(RL2-RM1)30,40,40
  		      10    RN1=RM1
  		      40    IF(RL2.LE.RM2)GO TO 50
  		            RN2=RM2
  		            GO TO 60
  		      50    RN2=RL2
  		            GO TO 60
  		      20    RN1=RM2
  		            IF(RL2.GE.RM1)GO TO 50
  		      30    RN2=RM1
  		      60    RETURN
  		            END

GLOBAL DUMMIES

RL1   	63		RL2   	64		RM1   	65		RM2   	66		RN1   	67	
RN2   	70		

SCALARS

PARCLT	71		RL1   	63		RM1   	65		RM2   	66		RN1   	67	
RL2   	64		RN2   	70		

 PARCLT
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 54


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 55


  		      C * NAME:     WINCOT                                       *
  		      C * PURPOSE:  CONVERT VIRTUAL COORDINATES TO SCREEN        *
  		      C *           COORDINATES AND PLOT                         *
  		      C * USAGE:    CALL WINCOT(X,Y)                             *
  		      C *           X  VIRTUAL X                                 *
  		      C *           Y  VIRTUAL Y                                 *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---BG-0200.05-01   WINCOT
  		            SUBROUTINE WINCOT(X,Y)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		      C * CALCULATE WINDOW SIZES
  		            WXD=TMAXVX-TMINVX
  		            WYD=TMAXVY-TMINVY
  		            DISX=KMAXSX-KMINSX
  		            DISY=KMAXSY-KMINSY
  		      C * CONVERT TO SCREEN COORDINATES
  		            KDISX=((X-TMINVX)*DISX/WXD)+FLOAT(KMINSX)
  		            KDISY=((Y-TMINVY)*DISY/WYD)+FLOAT(KMINSY)
  		      C * PLOT
  		            CALL MODCHK(KDISX,KDISY)
  		            RETURN
  		            END

GLOBAL DUMMIES

X     	67		Y     	70		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

FLOAT 	INT   	MODCHK	

SCALARS

WINCOT	72		WXD   	73		TMAXVX	56		TMINVX	54		WYD   	74	
TMAXVY	57		TMINVY	55		DISX  	75		KMAXSX	52		KMINSX	50	
DISY  	76		KMAXSY	53		KMINSY	51		KDISX 	77		X     	67	
KDISY 	100		Y     	70		KBAUDR	0		KERROR	1		KGRAFL	2	
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 56


KHOMEY	3		KKMODE	4		KHORSZ	5		KVERSZ	6		KITALC	7	
KSIZEF	10		KLMRGN	11		KRMRGN	12		KTBLSZ	13		KBEAMX	40	
KBEAMY	41		KMOVEF	42		KDASHT	47		TREALX	60		TREALY	61	
TIMAGX	62		TIMAGY	63		TRCOSF	64		TRSINF	65		TRSCAL	66	

ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		

 WINCOT
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 57


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 58


  		      C * NAME:     LVLCHT                                       *
  		      C * PURPOSE:  CHECK GRAPHIC LEVEL AND SET STATUS           *
  		      C * USAGE:    CALL LVLCHT                                  *
  		      C *           TEKTRONIX V1 4-7-71                          *
  		      C **********************************************************
  		      C ROUTINE---BG-0210.05-01   LVLCHT
  		            SUBROUTINE LVLCHT
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		      C * CHECK GRAPHIC FLAG
  		            IF(KGRAFL.NE.0)GO TO 10
  		      C * CONVERT CURRENT SCREEN POSITION TO VIRTUAL COORD
  		            CALL REVCOT(KBEAMX,KBEAMY,TREALX,TREALY)
  		      C *RESET HIGH LEVEL GRAPHICS
  		            TIMAGX=TREALX
  		            TIMAGY=TREALY
  		      C * SET HIGH LEVEL FLAG
  		            KGRAFL=1
  		      10    RETURN
  		            END

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

REVCOT	

SCALARS

LVLCHT	30		KGRAFL	2		KBEAMX	40		KBEAMY	41		TREALX	60	
TREALY	61		TIMAGX	62		TIMAGY	63		KBAUDR	0		KERROR	1	
KHOMEY	3		KKMODE	4		KHORSZ	5		KVERSZ	6		KITALC	7	
KSIZEF	10		KLMRGN	11		KRMRGN	12		KTBLSZ	13		KMOVEF	42	
KDASHT	47		KMINSX	50		KMINSY	51		KMAXSX	52		KMAXSY	53	
TMINVX	54		TMINVY	55		TMAXVX	56		TMAXVY	57		TRCOSF	64	
TRSINF	65		TRSCAL	66		

ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		

TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 59


 LVLCHT
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 60


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 61


  		      C * NAME:     REVCOT                                       *
  		      C * PURPOSE:  TRANSFORM SCREEN COORDINATES TO VIRTUAL      *
  		      C * USAGE:    CALL REVCOT(IX,IY,X,Y)                       *
  		      C *           IX  SCREEN X COORDINATE                      *
  		      C *           IY  SCREEN Y COORDINATE                      *
  		      C *           X   VIRTUAL X COORDINATE                     *
  		      C *           Y   VIRTUAL Y COORDINATE                     *
  		      C *           TEKTRONIX V1 4-7-71                          *
  		      C **********************************************************
  		      C ROUTINE---BG-0220.05-01   REVCOT
  		            SUBROUTINE REVCOT(IX,IY,X,Y)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		      C * CALCULATE VIRTUAL X-COORD
  		            SXL=KMAXSX-KMINSX
  		            VXL=TMAXVX-TMINVX
  		            X=(FLOAT(IX-KMINSX)*VXL/SXL)+TMINVX
  		      C * CALCULATE VIRTUAL Y COORD
  		            SYL=KMAXSY-KMINSY
  		            VYL=TMAXVY-TMINVY
  		            Y=(FLOAT(IY-KMINSY)*VYL/SYL)+TMINVY
  		      C * CHECK IF IN WINDOW
  		            CALL PCLIPT(X,Y)
  		            RETURN
  		            END

GLOBAL DUMMIES

IX    	70		IY    	71		X     	72		Y     	73		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

FLOAT 	PCLIPT	

SCALARS

REVCOT	75		SXL   	76		KMAXSX	52		KMINSX	50		VXL   	77	
TMAXVX	56		TMINVX	54		X     	72		IX    	70		SYL   	100	
KMAXSY	53		KMINSY	51		VYL   	101		TMAXVY	57		TMINVY	55	
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 62


Y     	73		IY    	71		KBAUDR	0		KERROR	1		KGRAFL	2	
KHOMEY	3		KKMODE	4		KHORSZ	5		KVERSZ	6		KITALC	7	
KSIZEF	10		KLMRGN	11		KRMRGN	12		KTBLSZ	13		KBEAMX	40	
KBEAMY	41		KMOVEF	42		KDASHT	47		TREALX	60		TREALY	61	
TIMAGX	62		TIMAGY	63		TRCOSF	64		TRSINF	65		TRSCAL	66	

ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		

 REVCOT
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 63


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 64


  		      C * NAME:     PCLIPT                                       *
  		      C * PURPOSE:  CLIP INDIVIDUAL POINT                        *
  		      C * USAGE:    CALL PCLIPT(X,Y)                             *
  		      C *           X  VIRTUAL X COORDINATE                      *
  		      C *           Y  VIRTUAL Y COORDINATE                      *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---BG-0230.05-01   PCLIPT
  		            SUBROUTINE PCLIPT(X,Y)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		            KERROR=0
  		      C * LEFT OF WINDOW?
  		            IF(X.LT.TMINVX)GO TO 10
  		      C * RIGHT OF WINDOW
  		            IF(X.GT.TMAXVX)GO TO 10
  		      C * BELOW WINDOW
  		            IF(Y.LT.TMINVY)GO TO 10
  		      C * ABOVE WINDOW
  		            IF(Y.LE.TMAXVY)GO TO 20
  		      10    KERROR=1
  		      20    RETURN
  		            END

GLOBAL DUMMIES

X     	35		Y     	36		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SCALARS

PCLIPT	37		KERROR	1		X     	35		TMINVX	54		TMAXVX	56	
Y     	36		TMINVY	55		TMAXVY	57		KBAUDR	0		KGRAFL	2	
KHOMEY	3		KKMODE	4		KHORSZ	5		KVERSZ	6		KITALC	7	
KSIZEF	10		KLMRGN	11		KRMRGN	12		KTBLSZ	13		KBEAMX	40	
KBEAMY	41		KMOVEF	42		KDASHT	47		KMINSX	50		KMINSY	51	
KMAXSX	52		KMAXSY	53		TREALX	60		TREALY	61		TIMAGX	62	
TIMAGY	63		TRCOSF	64		TRSINF	65		TRSCAL	66		

ARRAYS
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 65



KHORZT	14		KVERTT	26		KPCHAR	43		

 PCLIPT
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 66


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 67


  		      C *            DIRECT GRAPHIC ROUTINES
  		      C **********************************************************
  		      C **********************************************************
  		      C * NAME:     PNTREL                                       *
  		      C * PURPOSE:  OUTPUT RELATIVE POINT PLOT VECTOR            *
  		      C * USAGE:    CALL PNTREL(IX,IY)                           *
  		      C *           IX  X RELATIVE DISPLACEMENT                  *
  		      C *           IY  Y RELATIVE DISPLACEMENT                  *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---DA-0240.05-01   PNTREL
  		            SUBROUTINE PNTREL(IX,IY)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		      C * CONSTRUCT ABS VECTOR
  		            JX=KBEAMX+IX
  		            JY=KBEAMY+IY
  		      C * OUTPUT
  		            CALL PNTABS(JX,JY)
  		            RETURN
  		            END

GLOBAL DUMMIES

IX    	27		IY    	30		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

PNTABS	

SCALARS

PNTREL	31		JX    	32		KBEAMX	40		IX    	27		JY    	33	
KBEAMY	41		IY    	30		KBAUDR	0		KERROR	1		KGRAFL	2	
KHOMEY	3		KKMODE	4		KHORSZ	5		KVERSZ	6		KITALC	7	
KSIZEF	10		KLMRGN	11		KRMRGN	12		KTBLSZ	13		KMOVEF	42	
KDASHT	47		KMINSX	50		KMINSY	51		KMAXSX	52		KMAXSY	53	
TMINVX	54		TMINVY	55		TMAXVX	56		TMAXVY	57		TREALX	60	
TREALY	61		TIMAGX	62		TIMAGY	63		TRCOSF	64		TRSINF	65	
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 68


TRSCAL	66		

ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		

 PNTREL
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 69


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 70


  		      C * NAME:     PNTABS                                       *
  		      C * PURPOSE:  OUTPUT ABSOLUTE POINT PLOT VECTOR            *
  		      C * USAGE:    CALL PNTABS(IX,IY)                           *
  		      C *           IX  ABSOLUTE X (SCREEN COORDINATE)           *
  		      C *           IY  ABSOLUTE Y (SCREEN COORDINATE)           *
  		      C *           TEKTRONIX V1 4-7-71                          *
  		      C **********************************************************
  		      C ROUTINE---DA-0250.05-01   PNTABS
  		            SUBROUTINE PNTABS(IX,IY)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		      C * CHECK IF IN POINT PLOT MODE
  		            IF(KKMODE.EQ.2)GO TO 10
  		            CALL PNTMOD
  		      C * OUTPUT POINT
  		      10    CALL XYCNVT(IX,IY)
  		            KGRAFL=0
  		            RETURN
  		            END

GLOBAL DUMMIES

IX    	31		IY    	32		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

PNTMOD	XYCNVT	

SCALARS

PNTABS	33		KKMODE	4		IX    	31		IY    	32		KGRAFL	2	
KBAUDR	0		KERROR	1		KHOMEY	3		KHORSZ	5		KVERSZ	6	
KITALC	7		KSIZEF	10		KLMRGN	11		KRMRGN	12		KTBLSZ	13	
KBEAMX	40		KBEAMY	41		KMOVEF	42		KDASHT	47		KMINSX	50	
KMINSY	51		KMAXSX	52		KMAXSY	53		TMINVX	54		TMINVY	55	
TMAXVX	56		TMAXVY	57		TREALX	60		TREALY	61		TIMAGX	62	
TIMAGY	63		TRCOSF	64		TRSINF	65		TRSCAL	66		

ARRAYS
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 71



KHORZT	14		KVERTT	26		KPCHAR	43		

 PNTABS
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 72


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 73


  		      C * NAME:     DRWREL                                       *
  		      C * PURPOSE:  DRAW RELATIVE VECTOR                         *
  		      C * USAGE:    CALL DRWREL(IX,IY)                           *
  		      C *           IX  X RELATIVE DISPLACEMENT                  *
  		      C *           IY  Y RELATIVE DISPLACEMENT                  *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---DA-0260.05-01   DRWREL
  		            SUBROUTINE DRWREL(IX,IY)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		      C * CONSTRUCT ABS VECTOR
  		            JX=KBEAMX+IX
  		            JY=KBEAMY+IY
  		      C * OUTPUT
  		            CALL DRWABS(JX,JY)
  		            RETURN
  		            END

GLOBAL DUMMIES

IX    	27		IY    	30		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

DRWABS	

SCALARS

DRWREL	31		JX    	32		KBEAMX	40		IX    	27		JY    	33	
KBEAMY	41		IY    	30		KBAUDR	0		KERROR	1		KGRAFL	2	
KHOMEY	3		KKMODE	4		KHORSZ	5		KVERSZ	6		KITALC	7	
KSIZEF	10		KLMRGN	11		KRMRGN	12		KTBLSZ	13		KMOVEF	42	
KDASHT	47		KMINSX	50		KMINSY	51		KMAXSX	52		KMAXSY	53	
TMINVX	54		TMINVY	55		TMAXVX	56		TMAXVY	57		TREALX	60	
TREALY	61		TIMAGX	62		TIMAGY	63		TRCOSF	64		TRSINF	65	
TRSCAL	66		

ARRAYS
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 74



KHORZT	14		KVERTT	26		KPCHAR	43		

 DRWREL
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 75


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 76


  		      C * NAME:     DRWABS                                       *
  		      C * PURPOSE:  DRAW ABSOLUTE VECTOR                         *
  		      C * USAGE:    CALL DRWABS(IX,IY)                           *
  		      C *           IX  ABSOLUTE X (SCREEN COORDINATE)           *
  		      C *           IY  ABSOLUTE Y (SCREEN COORDINATE)           *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---DA-0270.05-01   DRWABS
  		            SUBROUTINE DRWABS(IX,IY)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		      C * CHECK IF IN VECTOR MODE
  		            IF(KKMODE.NE.1)GO TO 20
  		            IF(KMOVEF.EQ.1)GO TO 30
  		            GO TO 10
  		      C * DRAW DUMMY DARK VECTOR TO CURRENT POSITION
  		      20    CALL VECMOD
  		      30    CALL XYCNVT(KBEAMX,KBEAMY)
  		      C * OUTPUT VECTOR
  		      10    CALL XYCNVT(IX,IY)
  		            KGRAFL=0
  		            RETURN
  		            END

GLOBAL DUMMIES

IX    	40		IY    	41		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

VECMOD	XYCNVT	

SCALARS

DRWABS	42		KKMODE	4		KMOVEF	42		KBEAMX	40		KBEAMY	41	
IX    	40		IY    	41		KGRAFL	2		KBAUDR	0		KERROR	1	
KHOMEY	3		KHORSZ	5		KVERSZ	6		KITALC	7		KSIZEF	10	
KLMRGN	11		KRMRGN	12		KTBLSZ	13		KDASHT	47		KMINSX	50	
KMINSY	51		KMAXSX	52		KMAXSY	53		TMINVX	54		TMINVY	55	
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 77


TMAXVX	56		TMAXVY	57		TREALX	60		TREALY	61		TIMAGX	62	
TIMAGY	63		TRCOSF	64		TRSINF	65		TRSCAL	66		

ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		

 DRWABS
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 78


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 79


  		      C * NAME:     MOVREL                                       *
  		      C * PURPOSE:  OUTPUT BLANK RELATIVE VECTOR                 *
  		      C * USAGE:    CALL MOVREL(IX,IY)                           *
  		      C *           IX  X RELATIVE DISPLACEMENT                  *
  		      C *           IY  Y RELATIVE DISPLACEMENT                  *
  		      C *           TEKTRONIX V1 4-7-71                          *
  		      C **********************************************************
  		      C ROUTINE---DA-0280.05-01   MOVREL
  		            SUBROUTINE MOVREL(IX,IY)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		      C * CONVERT TO ABS VECTOR
  		            JX=KBEAMX+IX
  		            JY=KBEAMY+IY
  		      C * OUTPUT
  		            CALL MOVABS(JX,JY)
  		            RETURN
  		            END

GLOBAL DUMMIES

IX    	27		IY    	30		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

MOVABS	

SCALARS

MOVREL	31		JX    	32		KBEAMX	40		IX    	27		JY    	33	
KBEAMY	41		IY    	30		KBAUDR	0		KERROR	1		KGRAFL	2	
KHOMEY	3		KKMODE	4		KHORSZ	5		KVERSZ	6		KITALC	7	
KSIZEF	10		KLMRGN	11		KRMRGN	12		KTBLSZ	13		KMOVEF	42	
KDASHT	47		KMINSX	50		KMINSY	51		KMAXSX	52		KMAXSY	53	
TMINVX	54		TMINVY	55		TMAXVX	56		TMAXVY	57		TREALX	60	
TREALY	61		TIMAGX	62		TIMAGY	63		TRCOSF	64		TRSINF	65	
TRSCAL	66		

ARRAYS
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 80



KHORZT	14		KVERTT	26		KPCHAR	43		

 MOVREL
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 81


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 82


  		      C *            TAB AND MARGIN ROUTINES
  		      C **********************************************************
  		      C **********************************************************
  		      C * NAME:     SETTAB                                       *
  		      C * PURPOSE:  ENTERS TAB POSITION INTO TAB TABLE           *
  		      C * USAGE:    CALL SETTAB(ITAB,ITBTBL)                     *
  		      C *           ITAB   INPUT TAB POSITION                    *
  		      C *           ITBTBL NAME OF TAB TABLE                     *
  		      C *                  KHORZT   HORIZONTAL TAB TABLE         *
  		      C *                  KVERTT   VERTICAL TAB TABLE           *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---BG-0290.05-01   SETTAB
  		            SUBROUTINE SETTAB(ITAB,ITBTBL)
  		            DIMENSION ITBTBL(1)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		            KERROR=0
  		      C * CHECK TAB POSITION
  		            IF(ITAB.LE.0)GO TO 10
  		            I=1
  		      C * CHECK FOR DUPLICATE TAB POSITION
  		      20    IF(ITBTBL(I).EQ.ITAB)GO TO 10
  		            IF(ITAB.LT.ITBTBL(I))GO TO 60
  		      C * CHECK FOR EMPTY TABLE
  		            IF(ITBTBL(I).EQ.0)GO TO 60
  		      C * INCREMENT TABLE
  		            I=I+1
  		      C * TABLE EXCEEDED?
  		            IF(I.LE.KTBLSZ)GO TO 20
  		      30    KERROR=1
  		      10    RETURN
  		      60    ITEMP=ITBTBL(I)
  		      C * INSERT TAB INTO TABLE
  		            ITBTBL(I)=ITAB
  		      C * INSERTION COMPLETE?
  		      70    IF(ITEMP.EQ.0)GO TO 10
  		            I=I+1
  		      C * TABLE EXCEEDED?
  		            IF(I.GT.KTBLSZ)GO TO 30
  		      C * UPDATE TABLE
  		            ITEMPA=ITBTBL(I)
  		            ITBTBL(I)=ITEMP
  		            ITEMP=ITEMPA
  		            GO TO 70
  		            END

GLOBAL DUMMIES

TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 83


ITAB  	101		ITBTBL	102		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SCALARS

SETTAB	103		KERROR	1		ITAB  	101		I     	104		KTBLSZ	13	
ITEMP 	105		ITEMPA	106		KBAUDR	0		KGRAFL	2		KHOMEY	3	
KKMODE	4		KHORSZ	5		KVERSZ	6		KITALC	7		KSIZEF	10	
KLMRGN	11		KRMRGN	12		KBEAMX	40		KBEAMY	41		KMOVEF	42	
KDASHT	47		KMINSX	50		KMINSY	51		KMAXSX	52		KMAXSY	53	
TMINVX	54		TMINVY	55		TMAXVX	56		TMAXVY	57		TREALX	60	
TREALY	61		TIMAGX	62		TIMAGY	63		TRCOSF	64		TRSINF	65	
TRSCAL	66		

ARRAYS

ITBTBL	102		KHORZT	14		KVERTT	26		KPCHAR	43		

 SETTAB
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 84


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 85


  		      C * NAMES:    RSTTAB                                       *
  		      C * PURPOSE:  REMOVE TAB POSITION FROM TABLE OR RESET TABLE*
  		      C * USAGE:    CALL RSTTAB(ITAB,ITBTBL)                     *
  		      C *           ITAB   INPUT TAB POSITION IF .GT. 0          *
  		      C *                  IGNORED IF .LT. 0                     *
  		      C *                  CLEARS TABLE IF .EQ. 0                *
  		      C *           ITBTBL NAME OF TAB TABLE                     *
  		      C *                  KHORZT   HORIZONTAL TAB TABLE         *
  		      C *                  KVERTT   VERTICAL TAB TABLE           *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---BG-0300.05-01   RSTTAB
  		            SUBROUTINE RSTTAB(ITAB,ITBTBL)
  		            DIMENSION ITBTBL(1)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		      C * DETERMINE ACTION REQUIRED
  		            IF(ITAB)10,20,30
  		      C * REMOVE TAB
  		      30    DO 40 I=1,KTBLSZ
  		            IF(ITAB.EQ.ITBTBL(I))GO TO 50
  		      40    CONTINUE
  		            GO TO 10
  		      C * SETTING FOUND - REMOVE
  		      50    J=KTBLSZ-1
  		            DO 60 K=I,J
  		      60    ITBTBL(K)=ITBTBL(K+1)
  		            ITBTBL(KTBLSZ)=0
  		            GO TO 10
  		      C * CLEAR ALL TABS
  		      20    DO 21 II=1,KTBLSZ
  		      21    ITBTBL(II)=0
  		      10    RETURN
  		            END


GLOBAL DUMMIES

ITAB  	61		ITBTBL	62		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 86



SCALARS

RSTTAB	63		ITAB  	61		I     	64		KTBLSZ	13		J     	65	
K     	66		II    	67		KBAUDR	0		KERROR	1		KGRAFL	2	
KHOMEY	3		KKMODE	4		KHORSZ	5		KVERSZ	6		KITALC	7	
KSIZEF	10		KLMRGN	11		KRMRGN	12		KBEAMX	40		KBEAMY	41	
KMOVEF	42		KDASHT	47		KMINSX	50		KMINSY	51		KMAXSX	52	
KMAXSY	53		TMINVX	54		TMINVY	55		TMAXVX	56		TMAXVY	57	
TREALX	60		TREALY	61		TIMAGX	62		TIMAGY	63		TRCOSF	64	
TRSINF	65		TRSCAL	66		

ARRAYS

ITBTBL	62		KHORZT	14		KVERTT	26		KPCHAR	43		

 RSTTAB
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 87


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 88


  		      C * NAME:     TABHOR                                       *
  		      C * PURPOS:   SIMULATE HORIZONTAL TAB                      *
  		      C * USAGE:    CALL TABHOR                                  *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---BG-0310.05-01   TABHOR
  		            SUBROUTINE TABHOR
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		            KFLG=0
  		      C * FIND NEXT TAB POSITION
  		            DO 10 K=1,KTBLSZ
  		      C * IF TABLE NOT EMPTY SET FLAG
  		            IF(KHORZT(K).NE.0)KFLG=1
  		            IF(KHORZT(K).GT.KBEAMX)GO TO 20
  		      10    CONTINUE
  		      C * IF NO TABS EXIT
  		            IF(KFLG.EQ.0)GO TO 30
  		      15    CALL NEWLIN
  		            GO TO 30
  		      C * CHECK IF RIGHT MARGIN EXCEEDED BY TAB; IF SO, OUTPUT CR/LF
  		      20    IF (KHORZT(K).GE.KRMRGN) GO TO 15
  		      C * SIMULATE TAB
  		            CALL MOVABS(KHORZT(K),KBEAMY)
  		            CALL ANMODE
  		      30    RETURN
  		            END


COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

NEWLIN	MOVABS	ANMODE	

SCALARS

TABHOR	46		KFLG  	47		K     	50		KTBLSZ	13		KBEAMX	40	
KRMRGN	12		KBEAMY	41		KBAUDR	0		KERROR	1		KGRAFL	2	
KHOMEY	3		KKMODE	4		KHORSZ	5		KVERSZ	6		KITALC	7	
KSIZEF	10		KLMRGN	11		KMOVEF	42		KDASHT	47		KMINSX	50	
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 89


KMINSY	51		KMAXSX	52		KMAXSY	53		TMINVX	54		TMINVY	55	
TMAXVX	56		TMAXVY	57		TREALX	60		TREALY	61		TIMAGX	62	
TIMAGY	63		TRCOSF	64		TRSINF	65		TRSCAL	66		

ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		

 TABHOR
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 90


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 91


  		      C * NAME:     TABVER                                       *
  		      C * PURPOSE:  SIMULATES VERTICAL TAB                       *
  		      C * USAGE:    CALL TABVER                                  *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---BG-0320.05-01   TABVER
  		            SUBROUTINE TABVER
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		      C * SEARCH FOR NEXT TAB POSITION
  		            DO 10 K=1,KTBLSZ
  		            I=KTBLSZ-K+1
  		            IF(KVERTT(I)) 10,10,11
  		      11    IF(KVERTT(I).LT.KBEAMY)GO TO 30
  		      10    CONTINUE
  		            GO TO 20
  		      C * SIMULATE VERTICAL TAB
  		      30    CALL MOVABS(KBEAMX,KVERTT(I))
  		            CALL ANMODE
  		      20    RETURN
  		            END


COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

MOVABS	ANMODE	

SCALARS

TABVER	43		K     	44		KTBLSZ	13		I     	45		KBEAMY	41	
KBEAMX	40		KBAUDR	0		KERROR	1		KGRAFL	2		KHOMEY	3	
KKMODE	4		KHORSZ	5		KVERSZ	6		KITALC	7		KSIZEF	10	
KLMRGN	11		KRMRGN	12		KMOVEF	42		KDASHT	47		KMINSX	50	
KMINSY	51		KMAXSX	52		KMAXSY	53		TMINVX	54		TMINVY	55	
TMAXVX	56		TMAXVY	57		TREALX	60		TREALY	61		TIMAGX	62	
TIMAGY	63		TRCOSF	64		TRSINF	65		TRSCAL	66		

ARRAYS

TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 92


KHORZT	14		KVERTT	26		KPCHAR	43		

 TABVER
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 93


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 94


  		      C * NAME:      DSHMOD                                      *
  		      C * PURPOSE:   SET DASH MODE AND SAVE DASH TYPE            *
  		      C * USAGE:     CALL DSHMOD(L)                              *
  		      C *            L - DASH MODE SPEIFICATION                  *
  		      C *            L IS A CONCATINATION OF INTEGERS BETWEEN    *
  		      C *                  ONE AND EIGHT. A DASH SEGMENT         *
  		      C *                  IS DRAWN ACCORDING TO THE LENGTH      *
  		      C *                  INDICATED BY THE INTEGER    .         *
  		      C *            -1 =  INVISIBLE MOVE                        *
  		      C *            0  =  VISIBLE LINE                          *
  		      C *            1  =  5 RASTER UNITS, VISIBLE               *
  		      C *            2  =  5 RASTER UNITS, INVISIBLE             *
  		      C *            3  = 10 RASTER UNITS, VISIBLE               *
  		      C *            4  = 10 RASTER UNITS, INVISIBLE             *
  		      C *            5  = 25 RASTER UNITS, VISIBLE               *
  		      C *            6  = 25 RASTER UNITS, INVISIBLE             *
  		      C *            7  = 50 RASTER UNITS, VISIBLE               *
  		      C *            8  = 50 RASTER UNITS, INVISIBLE             *
  		      C *            9  = ALTERNATE VISIBLE AND INVISIBLE ON     *
  		      C *                 EACH POINT                             *
  		      C **********************************************************
  		      C ROUTINE---DA-0350.05-01   DSHMOD
  		            SUBROUTINE DSHMOD(L)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		            KKMODE=4
  		            KDASHT=L
  		            RETURN
  		            END

GLOBAL DUMMIES

L     	21		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SCALARS

DSHMOD	22		KKMODE	4		KDASHT	47		L     	21		KBAUDR	0	
KERROR	1		KGRAFL	2		KHOMEY	3		KHORSZ	5		KVERSZ	6	
KITALC	7		KSIZEF	10		KLMRGN	11		KRMRGN	12		KTBLSZ	13	
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 95


KBEAMX	40		KBEAMY	41		KMOVEF	42		KMINSX	50		KMINSY	51	
KMAXSX	52		KMAXSY	53		TMINVX	54		TMINVY	55		TMAXVX	56	
TMAXVY	57		TREALX	60		TREALY	61		TIMAGX	62		TIMAGY	63	
TRCOSF	64		TRSINF	65		TRSCAL	66		

ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		

 DSHMOD
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 96


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 97


  		      C *          MODE CONTROL ROUTINES
  		      C **********************************************************
  		      C **********************************************************
  		      C * NAME:      MODCHK                                     *
  		      C * PURPOSE:   SELECTS MODE SIMULATION ROUTINES            *
  		      C * USAGE:     CALL MODCHK(IX,IY)                          *
  		      C *            IX ABSOLUTE X  (SCREEN COORDINATE)          *
  		      C *            IY ABSOLUTE Y  (SCREEN COORDINATE)          *
  		      C *            TEKTRONIX V1 2-2-72 RW                      *
  		      C **********************************************************
  		      C ROUTINE---BG-0360.05-01   MODCHK
  		            SUBROUTINE MODCHK(IX,IY)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		      C * DO WE NEED TO SIMULATE A MODE?
  		            IF(KKMODE-4)1,2,1
  		      C * MAKE IT A DASHED LINE
  		      2      CALL TKDASH(IX,IY)
  		            GO TO 10
  		      C * NO MODE SIMULATION
  		      1      CALL XYCNVT(IX,IY)
  		      10      RETURN
  		            END

GLOBAL DUMMIES

IX    	33		IY    	34		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

TKDASH	XYCNVT	

SCALARS

MODCHK	35		KKMODE	4		IX    	33		IY    	34		KBAUDR	0	
KERROR	1		KGRAFL	2		KHOMEY	3		KHORSZ	5		KVERSZ	6	
KITALC	7		KSIZEF	10		KLMRGN	11		KRMRGN	12		KTBLSZ	13	
KBEAMX	40		KBEAMY	41		KMOVEF	42		KDASHT	47		KMINSX	50	
KMINSY	51		KMAXSX	52		KMAXSY	53		TMINVX	54		TMINVY	55	
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 98


TMAXVX	56		TMAXVY	57		TREALX	60		TREALY	61		TIMAGX	62	
TIMAGY	63		TRCOSF	64		TRSINF	65		TRSCAL	66		

ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		

 MODCHK
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 99


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 100


  		      C * NAME:      TKDASH                                      *
  		      C * PURPOSE:   CALCULATE DASHES AND DRAW DASHED LINE       *
  		      C * USAGE:     CALL TKDASH(IX,IY)                          *
  		      C *            IX  X ABSOLUTE SCREEN COORDINATE            *
  		      C *            IY  Y ABSOLUTE SCREEN COORDINATE            *
  		      C **********************************************************
  		      C ROUTINE---DA-0370.05-01   TKDASH
  		            SUBROUTINE TKDASH(IX,IY)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		            DIMENSION DTABL(10), U(9), WORK(10)
  		      C * SHORTEN THE BRIGHT ONES A BIT
  		            DATA IDTYPE, U/-1,3.,-5.,8.,-10.,23.,-25.,48.,-50.,0./
  		      C * REAL DASHES HAVE POSITIVE DASH TYPES
  		            IF(KDASHT)26,25,27
  		      C * HAS THE DASH TYPE CHANGED?
  		      27      IF (IDTYPE-KDASHT)1,2,1
  		      C * YES REFORM DASH TABLE
  		      1      ICHAR=KDASHT
  		      C * SEPARATE THE INTEGERS
  		            DO 3 NO=1,10
  		      6      IF(ICHAR)4,5,4
  		      4      I=ICHAR-((ICHAR/10)*10)
  		            ICHAR=ICHAR/10
  		            IF(I)3,6,3
  		      C * THE INTEGERS COME OUT IN REVERSE ORDER
  		      C * PUT THE CORESPONDING LENGTH IN WORK
  		      3      WORK(NO)=U(I)
  		            NO=11
  		      5      NO=NO-1
  		      C * INVERT WORK INTO DTABL
  		            DO 7 I=1,NO
  		      7      DTABL(I)=WORK(NO+1-I)
  		            IDTYPE=KDASHT
  		            I=0
  		            SEGLEN=0
  		      C * DRAW THE DASHED LINE
  		      C * IF ITS THE ALTERNATE TYPE SKIP ON!
  		      2     IF(NO-1)11,11,10
  		      C * IF IT HAS BEEN MOVED THEN RESTART THE PATTERN
  		      10    IF(LASTX-KBEAMX)14,13,14
  		      13    IF(LASTY-KBEAMY)14,12,14
  		      14    SEGLEN=0
  		            I=0
  		      C * USE FLOATING POINT FOR SMOOTH LINES
  		      12    X=FLOAT(KBEAMX)
  		            Y=FLOAT(KBEAMY)
  		      C * FIND HOW FAR WE GOT TO GO
  		            DX=FLOAT(IX-KBEAMX)
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 101


  		            DY=FLOAT(IY-KBEAMY)
  		      C * THE  TOTAL DISTANCE IS
  		            DIAG=SQRT(DX*DX+DY*DY)
  		      C * THE DISTANCE LEFT TO GO IS
  		            DIST=DIAG
  		      C * ANY THING LEFT OF THE LAST SEGMENT
  		            IF (SEGLEN-1.5)15,15,17
  		      C * NO. THEN GET A NEW ONE
  		      15      I=MOD(I,NO)+1
  		            SEGLEN=ABS(DTABL(I))
  		      C * IS THE SEGMENT SHORT ENOUGH TO FIT
  		      17      IF(SEGLEN-DIST)20,18,18
  		      C * YES  SO LAY IT ON THE DIAGONAL
  		      20      F=SEGLEN/DIAG
  		            X=X+DX*F
  		            Y=Y+DY*F
  		      C * BRIGHT OR DARK?
  		            IF (DTABL(I))21,21,22
  		      C*   OUTPUT A GS FOR A DARK VECTOR
  		      21      CALL TOUTPT(29)
  		      22      CALL XYCNVT(IFIX(X),IFIX(Y))
  		      C * UPDATE DIST LEFT TO GO
  		            DIST=DIST-SEGLEN
  		            SEGLEN=0
  		            GO TO 15
  		      C * THAT WAS QUITE LONG ENOUGH, STOP AT THE POINT
  		      C * BRIGHT OR DARK?
  		      18      IF(DTABL(I))29,29,24
  		      29      CALL TOUTPT(29)
  		      C*   THAT WAS A GS FOR AN INVISIBLE LINE
  		      24      CALL XYCNVT(IX,IY)
  		            LASTX=IX
  		            LASTY=IY
  		      C * NOTE THERES SOME LEFT
  		            SEGLEN=SEGLEN-DIST
  		      19      RETURN
  		      C * ALTERNATE MOVES & DRAWS
  		      11      IF(NO)26,26,25
  		      26      CALL TOUTPT(29)
  		      25      CALL XYCNVT(IX,IY)
  		             IF(KDASHT.LE.0)IDTYPE=-1
  		            NO=1-NO
  		            GO TO 19
  		            END

CONSTANTS

0	201600000000	1	000000000035	

GLOBAL DUMMIES

IX    	262		IY    	263		

TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 102


COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

FLOAT 	SQRT  	MOD   	ABS   	TOUTPT	XYCNVT	IFIX  	

SCALARS

TKDASH	266		IDTYPE	267		KDASHT	47		ICHAR 	270		NO    	271	
I     	272		SEGLEN	273		LASTX 	274		KBEAMX	40		LASTY 	275	
KBEAMY	41		X     	276		Y     	277		DX    	300		IX    	262	
DY    	301		IY    	263		DIAG  	302		DIST  	303		F     	304	
KBAUDR	0		KERROR	1		KGRAFL	2		KHOMEY	3		KKMODE	4	
KHORSZ	5		KVERSZ	6		KITALC	7		KSIZEF	10		KLMRGN	11	
KRMRGN	12		KTBLSZ	13		KMOVEF	42		KMINSX	50		KMINSY	51	
KMAXSX	52		KMAXSY	53		TMINVX	54		TMINVY	55		TMAXVX	56	
TMAXVY	57		TREALX	60		TREALY	61		TIMAGX	62		TIMAGY	63	
TRCOSF	64		TRSINF	65		TRSCAL	66		

ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		DTABL 	305		U     	317	
WORK  	330		

 TKDASH
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 103


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 104


  		      C * NAME:     INITT                                        *
  		      C * PURPOSE:  TO INITIALIZE TERMINAL AND SET COMMON        *
  		      C *           VARIABLES                                    *
  		      C * USAGE:    CALL INITT(IBAUD)                            *
  		      C *           IBAUD  BAUD RATE IN CHARACTERS/SEC.          *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---DA-1010.05-01 4010 INITT
  		            SUBROUTINE INITT(IBAUD)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		            KBAUDR=IBAUD
  		            KMINSX=0
  		            KMAXSX=1023
  		            KMINSY=0
  		            KMAXSY=780
  		      C * 4010 HOME POSITION
  		            KHOMEY=767
  		      C * CHARACTER HORIZONTAL SIZE
  		            KHORSZ=14
  		            DO 100 I=1,10
  		            KHORZT(I)=0
  		      100   KVERTT(I)=0
  		            KITALC=0
  		            KLMRGN=0
  		            KRMRGN=1010
  		            KSIZEF=0
  		            KTBLSZ=10
  		      C * CHARACTER VERTICAL SIZE
  		            KVERSZ=22
  		            TMINVX=0.
  		            TMAXVX=1023.
  		            TMINVY=0.
  		            TMAXVY=780.
  		            TRCOSF=1.
  		            TRSINF=0.
  		            TRSCAL=1.
  		            CALL ANMODE
  		            CALL NEWPAG
  		            RETURN
  		            END

CONSTANTS

0	212777400000	

GLOBAL DUMMIES

IBAUD 	66		
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 105



COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

ANMODE	NEWPAG	

SCALARS

INITT 	67		KBAUDR	0		IBAUD 	66		KMINSX	50		KMAXSX	52	
KMINSY	51		KMAXSY	53		KHOMEY	3		KHORSZ	5		I     	70	
KITALC	7		KLMRGN	11		KRMRGN	12		KSIZEF	10		KTBLSZ	13	
KVERSZ	6		TMINVX	54		TMAXVX	56		TMINVY	55		TMAXVY	57	
TRCOSF	64		TRSINF	65		TRSCAL	66		KERROR	1		KGRAFL	2	
KKMODE	4		KBEAMX	40		KBEAMY	41		KMOVEF	42		KDASHT	47	
TREALX	60		TREALY	61		TIMAGX	62		TIMAGY	63		

ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		

 INITT
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 106


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 107


  		      C * NAME:     ERASE                                        *
  		      C * PURPOSE:  TO ERASE SCREEN                              *
  		      C * USAGE:    CALL ERASE                                   *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---DA-1020.05-01 4010 ERASE
  		            SUBROUTINE ERASE
  		            DIMENSION SAVE(60)
  		            CALL SVSTAT(SAVE)
  		            CALL NEWPAG
  		            CALL RESTAT(SAVE)
  		            RETURN
  		            END

SUBPROGRAMS

SVSTAT	NEWPAG	RESTAT	

SCALARS

ERASE 	20		

ARRAYS

SAVE  	21		

 ERASE
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 108


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 109


  		      C * NAME:     HDCOPY                                       *
  		      C * PURPOSE:  OUTPUT CONTROL (ESC) (ETB) FOR HARD COPY     *
  		      C * USAGE:    CALL HDCOPY                                  *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---DA-1030.05-01 4010 HDCOPY
  		            SUBROUTINE HDCOPY
  		      C*  OUTPUT (ESC) (ETB) TO START HARD COPY
  		            CALL TOUTPT(27)
  		            CALL TOUTPT(23)
  		            CALL IOWAIT(180)
  		            RETURN
  		            END

CONSTANTS

0	000000000033	1	000000000027	2	000000000264	

SUBPROGRAMS

TOUTPT	IOWAIT	

SCALARS

HDCOPY	24		

 HDCOPY
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 110


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 111


  		      C *               DIRECT GRAPHIC ROUTINES
  		      C **********************************************************
  		      C **********************************************************
  		      C * NAME:     KIN                                          *
  		      C * PURPOSE:  CONVERT REAL INCHES TO RASTERS               *
  		      C * USAGE:    NRASTERS=KIN(RI)                             *
  		      C *           RI  REAL LENGTH IN INCHES                    *
  		      C *           TEKTRONIX V1 4-7-71                          *
  		      C **********************************************************
  		      C ROUTINE---DA-1040.05-01 4010 KIN
  		            FUNCTION KIN(RI)
  		      C * 4010 SCREEN TO INCH CONVERSION
  		            KIN=RI*136.5
  		            RETURN
  		            END

GLOBAL DUMMIES

RI    	26		

SUBPROGRAMS

INT   	

SCALARS

KIN   	27		RI    	26		

 KIN
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 112


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 113


  		      C * NAME:     KCM                                          *
  		      C * PURPOSE:  CONVERT REAL CENTIMITERS TO RASTERS          *
  		      C * USAGE:    NRASTERS=KCM(RC)                             *
  		      C *           RC  REAL LENGTH IN CENTIMETERS               *
  		      C *           TEKTRONIX V1 4-7-71                          *
  		      C **********************************************************
  		      C ROUTINE---DA-1050.05-01 4010 KCM
  		            FUNCTION KCM(RC)
  		      C * 4010 SCREEN TO CENTIMETER CONVERSION
  		            KCM=RC*53.8
  		            RETURN
  		            END

CONSTANTS

0	206656314631	

GLOBAL DUMMIES

RC    	27		

SUBPROGRAMS

INT   	

SCALARS

KCM   	30		RC    	27		

 KCM
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 114


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 115


  		      C * NAME:     DCURSR                                       *
  		      C * PURPOSE:  INPUT GRAPHIC DATA AND PACK INTO SCREEN      *
  		      C *           COORDINATES                                  *
  		      C * USAGE:    CALL DCURSR(ICHAR,IX,IY)                     *
  		      C *           ICHAR  HEADER CHARACTER                      *
  		      C *           IX     CURSOR SCREEN X-COORDINATE            *
  		      C *           IY     CURSOR SCREEN Y-COORDINATE            *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---DA-1060.05-01 4010 DCURSR
  		            SUBROUTINE DCURSR(ICHAR,IX,IY)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		            DIMENSION SAV(60)
  		      C * TURN ON CURSOR
  		      C * SAVE MODE
  		            CALL SVSTAT(SAV)
  		      C*  OUTPUT (ESC) (SUB) TO TURN ON CURSOR
  		            CALL TOUTPT(27)
  		            CALL TOUTPT(26)
  		      C * INPUT HEADER
  		            CALL TINPUT(ICHAR)
  		            K=0
  		      C*  ORDER OF CHARACTER INPUT MUST REFLECT HARDWARE STRAPPING
  		      C * INPUT HIGH ORDER
  		      10    CALL TINPUT(KOOR)
  		      C * SHIFT LEFT FIVE BITS
  		            KOOR=MOD(KOOR,32)*32
  		      C * INPUT LOW ORDER
  		            CALL TINPUT(KOOR2)
  		            KOOR=KOOR+MOD(KOOR2,32)
  		            K=K+1
  		            IF(K.EQ.2)GO TO 20
  		            IX=KOOR
  		            GO TO 10
  		      20    IY=KOOR
  		      C*  INPUT OF CR OR EOT SHOULD BE ACCEPTED AT THIS POINT
  		      C*  IF NEEDED
  		      C * RESTORE MODE
  		            CALL RESTAT(SAV)
  		            RETURN
  		            END

CONSTANTS

0	000000000033	1	000000000032	2	000000000040	

GLOBAL DUMMIES

TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 116


ICHAR 	67		IX    	70		IY    	71		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

SVSTAT	TOUTPT	TINPUT	MOD   	RESTAT	

SCALARS

DCURSR	72		ICHAR 	67		K     	73		KOOR  	74		KOOR2 	75	
IX    	70		IY    	71		KBAUDR	0		KERROR	1		KGRAFL	2	
KHOMEY	3		KKMODE	4		KHORSZ	5		KVERSZ	6		KITALC	7	
KSIZEF	10		KLMRGN	11		KRMRGN	12		KTBLSZ	13		KBEAMX	40	
KBEAMY	41		KMOVEF	42		KDASHT	47		KMINSX	50		KMINSY	51	
KMAXSX	52		KMAXSY	53		TMINVX	54		TMINVY	55		TMAXVX	56	
TMAXVY	57		TREALX	60		TREALY	61		TIMAGX	62		TIMAGY	63	
TRCOSF	64		TRSINF	65		TRSCAL	66		

ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		SAV   	76		

 DCURSR
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 117


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 118


  		      C *               A/N OUTPUT ROUTINES
  		      C **********************************************************
  		      C **********************************************************
  		      C * NAME:     ANCHO                                        *
  		      C * PURPOSE:  OUTPUT NON-CONTROL ALPHNUMERIC CHARACTERS    *
  		      C * USAGE:    CALL ANCHO(ICHAR)                            *
  		      C *           ICHAR   RIGHT ADJUSTED CHARACTER TO BE OUTPUT*
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---DA-1070.05-01 4010 ANCHO
  		            SUBROUTINE ANCHO(ICHAR)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		      C * CHECK MODE AND RESET IF NOT IN ALPHA
  		            IF(KKMODE.EQ.0)GO TO 10
  		            CALL ANMODE
  		      C * OUTPUT THE CHAR
  		      10    CALL TOUTPT(ICHAR)
  		      C * SET KBEAMX
  		            KBEAMX=KBEAMX+KHORSZ
  		      C * IF DISPLAY LIMITS REACHED DECREMENT KBEAMX
  		            IF(KBEAMX.LT.KRMRGN)GO TO 20
  		            CALL NEWLIN
  		      20    RETURN
  		            END

GLOBAL DUMMIES

ICHAR 	32		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

ANMODE	TOUTPT	NEWLIN	

SCALARS

ANCHO 	33		KKMODE	4		ICHAR 	32		KBEAMX	40		KHORSZ	5	
KRMRGN	12		KBAUDR	0		KERROR	1		KGRAFL	2		KHOMEY	3	
KVERSZ	6		KITALC	7		KSIZEF	10		KLMRGN	11		KTBLSZ	13	
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 119


KBEAMY	41		KMOVEF	42		KDASHT	47		KMINSX	50		KMINSY	51	
KMAXSX	52		KMAXSY	53		TMINVX	54		TMINVY	55		TMAXVX	56	
TMAXVY	57		TREALX	60		TREALY	61		TIMAGX	62		TIMAGY	63	
TRCOSF	64		TRSINF	65		TRSCAL	66		

ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		

 ANCHO
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 120


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 121


  		      C *            A/N OUTPUT ROUTINES
  		      C **********************************************************
  		      C **********************************************************
  		      C * NAME:     NEWLIN                                       *
  		      C * PURPOSE:  OUTPUT (CR) (LF)                             *
  		      C * USAGE:    CALL NEWLIN                                  *
  		      C *           TEKTRONIX V1 4-7-71                          *
  		      C **********************************************************
  		      C ROUTINE---DA-0330.05-01   NEWLIN
  		            SUBROUTINE NEWLIN
  		            CALL CARTN
  		            CALL LINEF
  		            RETURN
  		            END

SUBPROGRAMS

CARTN 	LINEF 	

SCALARS

NEWLIN	15		

 NEWLIN
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 122


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 123


  		      C * NAME:     CARTN                                        *
  		      C * PURPOSE   OUTPUT CARRIAGE RETURN                       *
  		      C * USAGE:    CALL CARTN                                   *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---DA-0340.05-01   CARTN
  		            SUBROUTINE CARTN
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		      C * IF NOT IN ALPHA MODE, ENTER
  		            IF(KKMODE.EQ.0)GO TO 20
  		            CALL ANMODE
  		      C * IF LEFT MARGIN SET  ADJUST TO LEFT MARGIN
  		      20    IF(KLMRGN.EQ.0)GO TO 10
  		      C * MOVE TO LEFT MARGIN   VECTOR MODE
  		            CALL MOVABS(KLMRGN,KBEAMY)
  		      C * RETURN TO ALPHA MODE
  		            CALL ANMODE
  		            GO TO 30
  		      10    KBEAMX=0
  		      C*  OUTPUT (CR)
  		            CALL TOUTPT(13)
  		      30    RETURN
  		            END

CONSTANTS

0	000000000015	

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

ANMODE	MOVABS	TOUTPT	

SCALARS

CARTN 	31		KKMODE	4		KLMRGN	11		KBEAMY	41		KBEAMX	40	
KBAUDR	0		KERROR	1		KGRAFL	2		KHOMEY	3		KHORSZ	5	
KVERSZ	6		KITALC	7		KSIZEF	10		KRMRGN	12		KTBLSZ	13	
KMOVEF	42		KDASHT	47		KMINSX	50		KMINSY	51		KMAXSX	52	
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 124


KMAXSY	53		TMINVX	54		TMINVY	55		TMAXVX	56		TMAXVY	57	
TREALX	60		TREALY	61		TIMAGX	62		TIMAGY	63		TRCOSF	64	
TRSINF	65		TRSCAL	66		

ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		

 CARTN
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 125


  		      C*
TEK10.F4	F40	V26(10)	15-MAY-73	15:31	PAGE 126


  		      C*
  		      C **********************************************************
  		      C **********************************************************
  		      C * NAME:     LINEF                                        *
  		      C * PURPOSE:  OUTPUT LINE FEED                             *
  		      C * USAGE:    CALL LINEF                                   *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---DA-1080.05-01 4010 LINEF
  		            SUBROUTINE LINEF
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		      C * IF NOT IN ALPHA MODE, ENTER
  		            IF(KKMODE.EQ.0)GO TO 10
  		            CALL ANMODE
  		      C*  OUTPUT (LF)
  		      10    CALL TOUTPT(10)
  		      C *   UPDATE KBEAMY
  		            KBEAMY=KBEAMY-KVERSZ
  		            RETURN
  		            END

CONSTANTS

0	000000000012	

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

ANMODE	TOUTPT	

SCALARS

LINEF 	23		KKMODE	4		KBEAMY	41		KVERSZ	6		KBAUDR	0	
KERROR	1		KGRAFL	2		KHOMEY	3		KHORSZ	5		KITALC	7	
KSIZEF	10		KLMRGN	11		KRMRGN	12		KTBLSZ	13		KBEAMX	40	
KMOVEF	42		KDASHT	47		KMINSX	50		KMINSY	51		KMAXSX	52	
KMAXSY	53		TMINVX	54		TMINVY	55		TMAXVX	56		TMAXVY	57	
TREALX	60		TREALY	61		TIMAGX	62		TIMAGY	63		TRCOSF	64	
TRSINF	65		TRSCAL	66		
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 127



ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		

 LINEF
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 128


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 129


  		      C * NAME:     BAKSP                                        *
  		      C * PURPOSE:  OUTPUT BACKSPACE CHARACTER                   *
  		      C * USAGE:    CALL BAKSP                                   *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---DA-1090.05-01 4010 BAKSP
  		            SUBROUTINE BAKSP
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		      C * IF NOT IN ALPHA MODE, ENTER
  		            IF(KKMODE.EQ.0)GO TO 10
  		            CALL ANMODE
  		      C* OUTPUT (BS)
  		      10    CALL TOUTPT(8)
  		      C * UPDATE BEAM X POSITION
  		            KBEAMX=KBEAMX-KHORSZ
  		      C * CHECK DISPLAY LIMIT
  		            IF(KBEAMX.GE.0)GO TO 20
  		            KBEAMX=KBEAMX+1023
  		      20    RETURN
  		            END

CONSTANTS

0	000000000010	

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

ANMODE	TOUTPT	

SCALARS

BAKSP 	27		KKMODE	4		KBEAMX	40		KHORSZ	5		KBAUDR	0	
KERROR	1		KGRAFL	2		KHOMEY	3		KVERSZ	6		KITALC	7	
KSIZEF	10		KLMRGN	11		KRMRGN	12		KTBLSZ	13		KBEAMY	41	
KMOVEF	42		KDASHT	47		KMINSX	50		KMINSY	51		KMAXSX	52	
KMAXSY	53		TMINVX	54		TMINVY	55		TMAXVX	56		TMAXVY	57	
TREALX	60		TREALY	61		TIMAGX	62		TIMAGY	63		TRCOSF	64	
TRSINF	65		TRSCAL	66		
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 130



ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		

 BAKSP
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 131


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 132


  		      C * NAME:     HOME                                         *
  		      C * PURPOSE:  POSITION BEAM TO HOME                        *
  		      C * USAGE:    CALL HOME                                    *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---DA-1100.05-01 4010 HOME
  		            SUBROUTINE HOME
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		      C * MOVE TO LEFT MARGIN  VECTOR MODE
  		            CALL MOVABS(KLMRGN,KHOMEY)
  		      C * RETURN TO ALPHA MODE
  		            CALL ANMODE
  		            RETURN
  		            END

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

MOVABS	ANMODE	

SCALARS

HOME  	17		KLMRGN	11		KHOMEY	3		KBAUDR	0		KERROR	1	
KGRAFL	2		KKMODE	4		KHORSZ	5		KVERSZ	6		KITALC	7	
KSIZEF	10		KRMRGN	12		KTBLSZ	13		KBEAMX	40		KBEAMY	41	
KMOVEF	42		KDASHT	47		KMINSX	50		KMINSY	51		KMAXSX	52	
KMAXSY	53		TMINVX	54		TMINVY	55		TMAXVX	56		TMAXVY	57	
TREALX	60		TREALY	61		TIMAGX	62		TIMAGY	63		TRCOSF	64	
TRSINF	65		TRSCAL	66		

ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		

 HOME
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 133


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 134


  		      C * NAME:     NEWPAG                                       *
  		      C * PURPOSE   OUTPUT (ESC) (FF)                            *
  		      C * USAGE:    CALL NEWPAG                                  *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---DA-1110.05-01 4010 NEWPAG
  		            SUBROUTINE NEWPAG
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		      C * ENTER A/N MODE IF NECESSARY
  		            IF(KKMODE) 5,6,5
  		      5     CALL ANMODE
  		      C*  OUTPUT (ESC) (FF) FOR NEW PAGE
  		      6     CALL TOUTPT(27)
  		            CALL TOUTPT(12)
  		            CALL IOWAIT(10)
  		      C * IF LEFT MARGIN IS SET ADJUST KBEAMX AND MOVE TO LEFT MARGIN
  		            IF(KLMRGN.EQ.0)GO TO 10
  		      C * MOVE TO LEFT MARGIN VECTOR MODE
  		            CALL MOVABS(KLMRGN,KHOMEY)
  		      C * RETURN TO ALPHA MODE
  		            CALL ANMODE
  		            GO TO 20
  		      C * NO MARGIN, SET BEAM LOCATION PARAMETERS
  		      10    KBEAMX=0
  		            KBEAMY=KHOMEY
  		      20    RETURN
  		            END

CONSTANTS

0	000000000033	1	000000000014	2	000000000012	

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

ANMODE	TOUTPT	IOWAIT	MOVABS	

SCALARS

TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 135


NEWPAG	41		KKMODE	4		KLMRGN	11		KHOMEY	3		KBEAMX	40	
KBEAMY	41		KBAUDR	0		KERROR	1		KGRAFL	2		KHORSZ	5	
KVERSZ	6		KITALC	7		KSIZEF	10		KRMRGN	12		KTBLSZ	13	
KMOVEF	42		KDASHT	47		KMINSX	50		KMINSY	51		KMAXSX	52	
KMAXSY	53		TMINVX	54		TMINVY	55		TMAXVX	56		TMAXVY	57	
TREALX	60		TREALY	61		TIMAGX	62		TIMAGY	63		TRCOSF	64	
TRSINF	65		TRSCAL	66		

ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		

 NEWPAG
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 136


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 137


  		      C *             GENERAL USE ROUTINES
  		      C **********************************************************
  		      C **********************************************************
  		      C * NAME:        RESTAT                                    *
  		      C * PURPOSE:     RESTORE STATUS                            *
  		      C * USAGE:       CALL RESTAT(ARRAY)                        *
  		      C *              ARRAY - 54 WORD REAL ARRAY                *
  		      C *                   IN WHICH PREVIOUS TERMINAL STATUS    *
  		      C *                   HAS BEEN STORED                      *
  		      C **********************************************************
  		      C *
  		      C *
  		      C ROUTINE---DA-1120.05-01 4010 RESTAT
  		            SUBROUTINE RESTAT(RARRAY)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		            DIMENSION RARRAY(55),IB(44),RB(11)
  		            EQUIVALENCE (IB(1),KBAUDR),(RB(1),TMINVX)
  		      C *
  		      C *  COPY GIVEN STATUS INTO TUS COMMON **
  		            DO 100 I=1,44
  		      100   IB(I)=RARRAY(I)
  		            DO 101 I=1,11
  		      101   RB(I)=RARRAY(I+44)
  		      C *  SAVE GIVEN MOVE FLAG & MODE **
  		            MOVE=KMOVEF
  		            MODE=KKMODE+1
  		            KGL=KGRAFL
  		      C *  MOVE TO GIVEN BEAM LOCATION; FORCE ENTRY TO A/N TO RESET FOR MOVE
  		            IY=KBEAMY
  		            CALL ANMODE
  		            KBEAMY=IY
  		            CALL MOVABS(KBEAMX,KBEAMY)
  		      C *  ENTER GIVEN MODE  **
  		            GO TO (200,300,400,500,300),MODE
  		      200   CALL ANMODE
  		            GO TO 600
  		      300   IF(MOVE) 350,600,350
  		      C *   PRIME FOR MOVE  **
  		      350   CALL VECMOD
  		            GO TO 600
  		      400   CALL PNTMOD
  		      600   KGRAFL=KGL
  		      500   RETURN
  		            END


GLOBAL DUMMIES

TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 138


RARRAY	100		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	IB    	/TKTRNX/+0
RB    	/TKTRNX/+54	

SUBPROGRAMS

INT   	ANMODE	MOVABS	VECMOD	PNTMOD	

SCALARS

RESTAT	101		I     	102		MOVE  	103		KMOVEF	42		MODE  	104	
KKMODE	4		KGL   	105		KGRAFL	2		IY    	106		KBEAMY	41	
KBEAMX	40		KBAUDR	0		KERROR	1		KHOMEY	3		KHORSZ	5	
KVERSZ	6		KITALC	7		KSIZEF	10		KLMRGN	11		KRMRGN	12	
KTBLSZ	13		KDASHT	47		KMINSX	50		KMINSY	51		KMAXSX	52	
KMAXSY	53		TMINVX	54		TMINVY	55		TMAXVX	56		TMAXVY	57	
TREALX	60		TREALY	61		TIMAGX	62		TIMAGY	63		TRCOSF	64	
TRSINF	65		TRSCAL	66		

ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		RARRAY	100		IB    	0	
RB    	54		

 RESTAT
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 139


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 140


  		      C *             MODE CONTROL ROUTINES
  		      C **********************************************************
  		      C **********************************************************
  		      C * NAME:     ANMODE                                       *
  		      C * PURPOSE:  ENTER AND SET ALPHANUMERIC MODE              *
  		      C * USAGE:    CALL ANMODE                                  *
  		      C *           TEKTRONIX V1 4-8-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---DA-1400.05-01 4010 ANMODE
  		            SUBROUTINE ANMODE
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		      C*  SET ALPHA MODE OUTPUT (US)
  		            CALL TOUTPT(31)
  		            KKMODE=0
  		            IF(KBEAMY.GT.KHOMEY) KBEAMY=KHOMEY
  		      10    RETURN
  		            END

CONSTANTS

0	000000000037	

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

TOUTPT	

SCALARS

ANMODE	24		KKMODE	4		KBEAMY	41		KHOMEY	3		KBAUDR	0	
KERROR	1		KGRAFL	2		KHORSZ	5		KVERSZ	6		KITALC	7	
KSIZEF	10		KLMRGN	11		KRMRGN	12		KTBLSZ	13		KBEAMX	40	
KMOVEF	42		KDASHT	47		KMINSX	50		KMINSY	51		KMAXSX	52	
KMAXSY	53		TMINVX	54		TMINVY	55		TMAXVX	56		TMAXVY	57	
TREALX	60		TREALY	61		TIMAGX	62		TIMAGY	63		TRCOSF	64	
TRSINF	65		TRSCAL	66		

ARRAYS

TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 141


KHORZT	14		KVERTT	26		KPCHAR	43		

 ANMODE
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 142


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 143


  		      C * NAME:     MOVABS                                       *
  		      C * PURPOSE:  DRAW BLANK VECTOR                            *
  		      C * USAGE:    CALL MOVABS(IX,IY)                           *
  		      C *           IX  ABSOLUTE X (SCREEN COORDINATE)           *
  		      C *           IY  ABSOLUTE Y (SCREEN COORDINATE)           *
  		      C *           TEKTRONIX V1 4-7-71                          *
  		      C **********************************************************
  		      C ROUTINE---DA-0380.05-01   MOVABS
  		            SUBROUTINE MOVABS(IX,IY)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		      C * ENTER VECTOR MODE
  		            CALL VECMOD
  		      C * OUTPUT BLANK VECTOR
  		            CALL XYCNVT(IX,IY)
  		            KGRAFL=0
  		            RETURN
  		            END

GLOBAL DUMMIES

IX    	26		IY    	27		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

VECMOD	XYCNVT	

SCALARS

MOVABS	30		IX    	26		IY    	27		KGRAFL	2		KBAUDR	0	
KERROR	1		KHOMEY	3		KKMODE	4		KHORSZ	5		KVERSZ	6	
KITALC	7		KSIZEF	10		KLMRGN	11		KRMRGN	12		KTBLSZ	13	
KBEAMX	40		KBEAMY	41		KMOVEF	42		KDASHT	47		KMINSX	50	
KMINSY	51		KMAXSX	52		KMAXSY	53		TMINVX	54		TMINVY	55	
TMAXVX	56		TMAXVY	57		TREALX	60		TREALY	61		TIMAGX	62	
TIMAGY	63		TRCOSF	64		TRSINF	65		TRSCAL	66		

ARRAYS

TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 144


KHORZT	14		KVERTT	26		KPCHAR	43		

 MOVABS
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 145


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 146


  		      C * NAME:     IOWAIT                                       *
  		      C * PURPOSE:  TO SEND (SYN) TO TERMINAL FOR REQUIRED TIME  *
  		      C * USAGE:    CALL IOWAIT(ITIME)                           *
  		      C *           ITIME  TIME IN TENTHS OF SECONDS             *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---DA-0390.05-01   IOWAIT
  		            SUBROUTINE IOWAIT(ITIME)
  		      C*  THIS ROUTINE IS USED TO GENERATE DELAYS FOR REMOTE TERMINALS
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		      C * IF KBAUD .LE. 0  NO WAIT
  		            IF(KBAUDR.LE.0)GO TO 20
  		            KOUNT=ITIME*KBAUDR/10
  		            DO 10 J=1,KOUNT
  		      C*  OUTPUT (SYN) TO INSURE AGAINST LOSS OF OUTPUT WHILE
  		      C*  TERMINAL IS BUSY. (SYN) DOES NOT AFFECT THE TERMINAL.
  		      10    CALL TOUTPT(22)
  		      20    RETURN
  		            END

CONSTANTS

0	000000000026	

GLOBAL DUMMIES

ITIME 	32		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

TOUTPT	

SCALARS

IOWAIT	33		KBAUDR	0		KOUNT 	34		ITIME 	32		J     	35	
KERROR	1		KGRAFL	2		KHOMEY	3		KKMODE	4		KHORSZ	5	
KVERSZ	6		KITALC	7		KSIZEF	10		KLMRGN	11		KRMRGN	12	
KTBLSZ	13		KBEAMX	40		KBEAMY	41		KMOVEF	42		KDASHT	47	
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 147


KMINSX	50		KMINSY	51		KMAXSX	52		KMAXSY	53		TMINVX	54	
TMINVY	55		TMAXVX	56		TMAXVY	57		TREALX	60		TREALY	61	
TIMAGX	62		TIMAGY	63		TRCOSF	64		TRSINF	65		TRSCAL	66	

ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		

 IOWAIT
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 148


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 149


  		      C * NAME:     VECMOD                                       *
  		      C * PURPOSE:  TO ENTER LINEAR INTERPOLATE MODE             *
  		      C * USAGE:    CALL VECMOD                                  *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---DA-0410.05-01   VECMOD
  		            SUBROUTINE VECMOD
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		      C * IF WE ARE IN VECTOR MODE DO NOT RESET PLOT CHARACTERS
  		            IF(KKMODE.EQ.1)GO TO 10
  		      C*  OUTPUT (US) TO ENTER A/N MODE AND RESET FOR VECTOR MODE
  		            CALL TOUTPT(31)
  		      C * RESET  PLOT CHARACTERS
  		            DO 112 II=1,4
  		      112   KPCHAR(II)=-1
  		            KKMODE=1
  		      C*  OUTPUT (GS) TO ENTER VECTOR MODE
  		      10    CALL TOUTPT(29)
  		            KMOVEF=1
  		            RETURN
  		            END

CONSTANTS

0	000000000037	1	000000000035	

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

TOUTPT	

SCALARS

VECMOD	35		KKMODE	4		II    	36		KMOVEF	42		KBAUDR	0	
KERROR	1		KGRAFL	2		KHOMEY	3		KHORSZ	5		KVERSZ	6	
KITALC	7		KSIZEF	10		KLMRGN	11		KRMRGN	12		KTBLSZ	13	
KBEAMX	40		KBEAMY	41		KDASHT	47		KMINSX	50		KMINSY	51	
KMAXSX	52		KMAXSY	53		TMINVX	54		TMINVY	55		TMAXVX	56	
TMAXVY	57		TREALX	60		TREALY	61		TIMAGX	62		TIMAGY	63	
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 150


TRCOSF	64		TRSINF	65		TRSCAL	66		

ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		

 VECMOD
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 151


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 152


  		      C *            GENERAL USE ROUTINES
  		      C **********************************************************
  		      C **********************************************************
  		      C * NAME:        SVSTAT                                    *
  		      C * PURPOSE:     SAVE STATUS                               *
  		      C * USAGE:       CALL SVSTAT(ARRAY)                        *
  		      C *              ARRAY - 60 WORD REAL ARRAY                *
  		      C *                IN WHICH TERMINAL STATUS IS STORED      *
  		      C **********************************************************
  		      C *
  		      C *
  		      C ROUTINE---DA-0420.05-01   SVSTAT
  		            SUBROUTINE SVSTAT(RARRAY)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		            DIMENSION RARRAY(55),IB(44),RB(11)
  		            EQUIVALENCE (IB(1),KBAUDR),(RB(1),TMINVX)
  		      C *
  		      C *   COPY TERMINAL STATUS AREA INTO GIVEN SAVE ARRAY    **
  		      C *
  		            DO 100 I=1,44
  		      100   RARRAY(I)=IB(I)
  		            DO 101 I=1,11
  		      101   RARRAY(I+44)=RB(I)
  		            RETURN
  		            END


GLOBAL DUMMIES

RARRAY	37		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	IB    	/TKTRNX/+0
RB    	/TKTRNX/+54	

SUBPROGRAMS

FLOAT 	

SCALARS

TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 153


SVSTAT	40		I     	41		KBAUDR	0		KERROR	1		KGRAFL	2	
KHOMEY	3		KKMODE	4		KHORSZ	5		KVERSZ	6		KITALC	7	
KSIZEF	10		KLMRGN	11		KRMRGN	12		KTBLSZ	13		KBEAMX	40	
KBEAMY	41		KMOVEF	42		KDASHT	47		KMINSX	50		KMINSY	51	
KMAXSX	52		KMAXSY	53		TMINVX	54		TMINVY	55		TMAXVX	56	
TMAXVY	57		TREALX	60		TREALY	61		TIMAGX	62		TIMAGY	63	
TRCOSF	64		TRSINF	65		TRSCAL	66		

ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		RARRAY	37		IB    	0	
RB    	54		

 SVSTAT
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 154


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 155


  		      C * NAME:      CSIZE                                 *
  		      C * PURPOSE:      RETURNS THE CHARACTER SIZE OF THE TERMINAL *
  		      C * USAGE:      CALL CSIZE(IHORZ,IVERT)                     *
  		      C *            IHORZ  WIDTH OF THE CHARACTERS               *
  		      C *            IVERT  HEIGHT OF THE CHARACTERS               *
  		      C **********************************************************
  		      C ROUTINE---DA-0430.05-01   CSIZE
  		            SUBROUTINE CSIZE(IHORZ,IVERT)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		            IHORZ=KHORSZ
  		            IVERT=KVERSZ
  		            RETURN
  		            END

GLOBAL DUMMIES

IHORZ 	25		IVERT 	26		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SCALARS

CSIZE 	27		IHORZ 	25		KHORSZ	5		IVERT 	26		KVERSZ	6	
KBAUDR	0		KERROR	1		KGRAFL	2		KHOMEY	3		KKMODE	4	
KITALC	7		KSIZEF	10		KLMRGN	11		KRMRGN	12		KTBLSZ	13	
KBEAMX	40		KBEAMY	41		KMOVEF	42		KDASHT	47		KMINSX	50	
KMINSY	51		KMAXSX	52		KMAXSY	53		TMINVX	54		TMINVY	55	
TMAXVX	56		TMAXVY	57		TREALX	60		TREALY	61		TIMAGX	62	
TIMAGY	63		TRCOSF	64		TRSINF	65		TRSCAL	66		

ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		

 CSIZE
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 156


  		      C ROUTINE---BG-0440.05-01   RSCALE
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 157


  		            SUBROUTINE RSCALE(SCALE)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		             TRSCAL=SCALE
  		             RETURN
  		             END

GLOBAL DUMMIES

SCALE 	17		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SCALARS

RSCALE	20		TRSCAL	66		SCALE 	17		KBAUDR	0		KERROR	1	
KGRAFL	2		KHOMEY	3		KKMODE	4		KHORSZ	5		KVERSZ	6	
KITALC	7		KSIZEF	10		KLMRGN	11		KRMRGN	12		KTBLSZ	13	
KBEAMX	40		KBEAMY	41		KMOVEF	42		KDASHT	47		KMINSX	50	
KMINSY	51		KMAXSX	52		KMAXSY	53		TMINVX	54		TMINVY	55	
TMAXVX	56		TMAXVY	57		TREALX	60		TREALY	61		TIMAGX	62	
TIMAGY	63		TRCOSF	64		TRSINF	65		

ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		

 RSCALE
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 158


  		      C ROUTINE---BG-0450.05-01   RROTAT
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 159


  		            SUBROUTINE RROTAT(ANGLE)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		             A=0.0174*ANGLE
  		             TRCOSF=COS(A)
  		             TRSINF=SIN(A)
  		             RETURN
  		             END

CONSTANTS

0	173435051616	

GLOBAL DUMMIES

ANGLE 	27		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

COS   	SIN   	

SCALARS

RROTAT	30		A     	31		ANGLE 	27		TRCOSF	64		TRSINF	65	
KBAUDR	0		KERROR	1		KGRAFL	2		KHOMEY	3		KKMODE	4	
KHORSZ	5		KVERSZ	6		KITALC	7		KSIZEF	10		KLMRGN	11	
KRMRGN	12		KTBLSZ	13		KBEAMX	40		KBEAMY	41		KMOVEF	42	
KDASHT	47		KMINSX	50		KMINSY	51		KMAXSX	52		KMAXSY	53	
TMINVX	54		TMINVY	55		TMAXVX	56		TMAXVY	57		TREALX	60	
TREALY	61		TIMAGX	62		TIMAGY	63		TRSCAL	66		

ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		

 RROTAT
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 160


  		      C*
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 161


  		      C **********************************************************
  		      C * NAME:     PNTMOD                                       *
  		      C * PURPOSE:  SET POINT PLOT MODE                          *
  		      C * USAGE:    CALL PNTMOD                                  *
  		      C *           TEKTRONIX VI 4-7-71                          *
  		      C **********************************************************
  		      C ROUTINE---DA-1130.05-01 4010 PNTMOD
  		            SUBROUTINE PNTMOD
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		      C*  CANCEL PREVIOUS MODES - OUTPUT (US)
  		            CALL TOUTPT(31)
  		      C * RESET PLOT CHARACTERS AND SET MODE
  		            DO 111 II=1,4
  		      111   KPCHAR(II)=-1
  		            KKMODE=2
  		            RETURN
  		            END

CONSTANTS

0	000000000037	

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

TOUTPT	

SCALARS

PNTMOD	25		II    	26		KKMODE	4		KBAUDR	0		KERROR	1	
KGRAFL	2		KHOMEY	3		KHORSZ	5		KVERSZ	6		KITALC	7	
KSIZEF	10		KLMRGN	11		KRMRGN	12		KTBLSZ	13		KBEAMX	40	
KBEAMY	41		KMOVEF	42		KDASHT	47		KMINSX	50		KMINSY	51	
KMAXSX	52		KMAXSY	53		TMINVX	54		TMINVY	55		TMAXVX	56	
TMAXVY	57		TREALX	60		TREALY	61		TIMAGX	62		TIMAGY	63	
TRCOSF	64		TRSINF	65		TRSCAL	66		

ARRAYS

TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 162


KHORZT	14		KVERTT	26		KPCHAR	43		

 PNTMOD
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 163


  		      C **********************************************************
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 164


  		      C *           BASIC I/O ROUTINES
  		      C **********************************************************
  		      C **********************************************************
  		      C * NAME:     XYCNVT                                       *
  		      C * PURPOSE:  CONVERT X, Y COORDINATES TO PLOT CHARACTERS  *
  		      C *           AND OUTPUT TO TERMINAL                       *
  		      C * USAGE:    CALL XYCNVT(IX,IY)                           *
  		      C *           IX  ABSOLUTE SCREEN X COORDINATE             *
  		      C *           IY  ABSOLUTE SCREEN Y COORDINATE             *
  		      C *           TEKTRONIX V1 4-7-71 DP                       *
  		      C **********************************************************
  		      C ROUTINE---DA-1140.05-01 4010 XYCNVT
  		            SUBROUTINE XYCNVT(IX,IY)
  		            COMMON /TKTRNX/ KBAUDR, KERROR, KGRAFL, KHOMEY, KKMODE,
  		           1 KHORSZ, KVERSZ, KITALC, KSIZEF, KLMRGN, KRMRGN,
  		           2 KTBLSZ, KHORZT(10), KVERTT(10),
  		           3 KBEAMX, KBEAMY, KMOVEF, KPCHAR(4),KDASHT,
  		           4 KMINSX, KMINSY, KMAXSX, KMAXSY, TMINVX, TMINVY, TMAXVX, TMAXVY,
  		           5 TREALX, TREALY, TIMAGX, TIMAGY, TRCOSF, TRSINF, TRSCAL
  		      C * SAVE NEW X,Y POSITION
  		            KBEAMY=IY
  		            KBEAMX=IX
  		      C * CALC. LOW ORDER X
  		            LOX=MOD(IX,32)+64
  		      C * CALC. HIGH ORDER X
  		            IHOX=MOD(IX/32,32)+32
  		      C * CALC. LOW ORDER Y
  		            LOY=MOD(IY,32)+96
  		      C * CALC. HIGH ORDER Y
  		            IHOY=MOD(IY/32,32)+32
  		            IF(KKMODE.NE.2)GO TO 5
  		      C*  OUTPUT (GS) TO ENTER VECTOR MODE
  		            CALL TOUTPT(29)
  		      C*  ORDER OF OUTPUT MUST REFLECT HARDWARE STRAPPING
  		      C * IF HIGH Y HAS CHANGED OUTPUT AND SAVE
  		      5     IF(IHOY.NE.KPCHAR(1))GO TO 10
  		      C * IF LOW Y HAS CHANGED OUTPUT AND SAVE
  		            IF(LOY.NE.KPCHAR(2))GO TO 20
  		      C * IF HIGH X CHANGED OUTPUT LOW Y
  		            IF(IHOX.EQ.KPCHAR(3))GO TO 41
  		            GO TO 30
  		      C * OUTPUT HIGH Y
  		      10    KPCHAR(1)=IHOY
  		            CALL TOUTPT(IHOY)
  		      C * OUTPUT LOW Y
  		      20    KPCHAR(2)=LOY
  		      30    CALL TOUTPT(LOY)
  		      C * IF HIGH X HAS CHANGED OUTPUT AND SAVE
  		            IF(IHOX.EQ.KPCHAR(3))GO TO 40
  		      C * OUTPUT HIGH X
  		            KPCHAR(3)=IHOX
  		            CALL TOUTPT(IHOX)
  		            GO TO 40
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 165


  		      41    IF(LOX.NE.KPCHAR(4))GO TO 40
  		            IF(KKMODE.EQ.2)GO TO 44
  		            IF(KMOVEF.EQ.1)GO TO 42
  		            IF(IFLAG.EQ.0)GO TO 42
  		            GO TO 100
  		      40    KPCHAR(4)=LOX
  		      C * OUPUT LOW X
  		      42    CALL TOUTPT(LOX)
  		            IF(KKMODE.NE.2)GO TO 43
  		      C * OUTPUT LOW ORDER X TWICE TO SIMULATE POINT PLOT
  		      44    CALL TOUTPT(LOX)
  		            GO TO 100
  		      43    IF(KMOVEF.EQ.1)GO TO 50
  		            IFLAG=1
  		            GO TO 100
  		      50    IFLAG=0
  		            KMOVEF=0
  		      100   RETURN
  		            END

CONSTANTS

0	000000000040	1	000000000035	

GLOBAL DUMMIES

IX    	166		IY    	167		

COMMON

KBAUDR	/TKTRNX/+0	KERROR	/TKTRNX/+1	KGRAFL	/TKTRNX/+2	KHOMEY	/TKTRNX/+3	KKMODE	/TKTRNX/+4
KHORSZ	/TKTRNX/+5	KVERSZ	/TKTRNX/+6	KITALC	/TKTRNX/+7	KSIZEF	/TKTRNX/+10	KLMRGN	/TKTRNX/+11
KRMRGN	/TKTRNX/+12	KTBLSZ	/TKTRNX/+13	KHORZT	/TKTRNX/+14	KVERTT	/TKTRNX/+26	KBEAMX	/TKTRNX/+40
KBEAMY	/TKTRNX/+41	KMOVEF	/TKTRNX/+42	KPCHAR	/TKTRNX/+43	KDASHT	/TKTRNX/+47	KMINSX	/TKTRNX/+50
KMINSY	/TKTRNX/+51	KMAXSX	/TKTRNX/+52	KMAXSY	/TKTRNX/+53	TMINVX	/TKTRNX/+54	TMINVY	/TKTRNX/+55
TMAXVX	/TKTRNX/+56	TMAXVY	/TKTRNX/+57	TREALX	/TKTRNX/+60	TREALY	/TKTRNX/+61	TIMAGX	/TKTRNX/+62
TIMAGY	/TKTRNX/+63	TRCOSF	/TKTRNX/+64	TRSINF	/TKTRNX/+65	TRSCAL	/TKTRNX/+66	

SUBPROGRAMS

MOD   	TOUTPT	

SCALARS

XYCNVT	171		KBEAMY	41		IY    	167		KBEAMX	40		IX    	166	
LOX   	172		IHOX  	173		LOY   	174		IHOY  	175		KKMODE	4	
KMOVEF	42		IFLAG 	176		KBAUDR	0		KERROR	1		KGRAFL	2	
KHOMEY	3		KHORSZ	5		KVERSZ	6		KITALC	7		KSIZEF	10	
KLMRGN	11		KRMRGN	12		KTBLSZ	13		KDASHT	47		KMINSX	50	
KMINSY	51		KMAXSX	52		KMAXSY	53		TMINVX	54		TMINVY	55	
TMAXVX	56		TMAXVY	57		TREALX	60		TREALY	61		TIMAGX	62	
TIMAGY	63		TRCOSF	64		TRSINF	65		TRSCAL	66		

TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 166


ARRAYS

KHORZT	14		KVERTT	26		KPCHAR	43		

 XYCNVT
TEK10.F4	F40	V26(10)	15-MAY-73	15:32	PAGE 167


  		      C*

ke6