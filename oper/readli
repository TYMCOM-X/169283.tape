      SUBROUTINE READLIST(IFILE,LIST,IKOM,IFORM,IER)
C
C    THIS ROUTINE IS USED TO LIST A COMMAND LIST IKOM ON IFILE
C    'IFILE'.  'LIST' IS THE NUMBER OF THE LIST IN WHICH IKOM NUMBER
C    'IKOM' IS TO BE RETRIEVED.  IF EITHER 'LIST' OR 'IKOM' IS
C    OUT OF BOUNDS, 'IER' IS SET TO 1 AND A RETURN IS MADE.
C    'IER' IS ZERO IF NO IER WAS ENCOUNTERED.
C
C    IFORM, AN INTEGER AS ARE ALL THE OTHER ARGUMENTS, DEFINES
C    THE IFORMAT OF THE PRINTOUT, AS FOLLOWS:
C
C     -K MEANS LIST IKOM, APPENDING SPACES TO MAKE TOTAL FIELD
C        WIDTH EQUAL TO K
C
C      0 MEANS LIST IKOM WITH NO TRAILING OR LEADING SPACES
C
C     +K MEANS LIST IKOM, INSERTING SPACES IN FRONT TO MAKE TOTAL
C        WIDTH EQUAL TO K
C
C
        COMMON /INPUT/INPUT(132),IPOINT,IFINAL,NUMCHR
        INTEGER LISPOINT(51),ENTPOINT(301),MINTYP(300),ALLCOM(450)
        COMMON /COMLIST/NUMLIST,LISPOINT,ENTPOINT,ALLCOM
C
      INTEGER IKOM,IFORM,IFILE,IER
      INTEGER SPACE
      DATA SPACE/' '/
C
      IER=0
C
C    CHECK FOR SPECIFICATION IERS
      IF(LIST.LE.0 .OR. LIST.GT.LISMAX) GO TO 100
      MX=LISPOINT(LIST+1)-LISPOINT(LIST)
      IF(IKOM.LE.0 .OR. IKOM.GT.MX) GO TO 100
C
C    COMPUTE LENGTH OF COMMAND IKOM
      LENG=ENTPOINT(LISPOINT(LIST)+IKOM)-ENTPOINT(LISPOINT(LIST)+IKOM
     1-1)
C
C    COMPUTE DIFFERENCE
      IDIFF=0
      IF(IFORM.NE.0) IDIFF=IABS(IFORM)-LENG
      IF(IDIFF.LT.0) GO TO 100
      IF(IFORM) 40,40,10
C
C    INSERT SPACES
10    IF(IDIFF.LT.1) GO TO 40
      DO 20 I=1,IDIFF
20    WRITE(IFILE,30)SPACE
30    FORMAT('+',A1,$)
C
C    NOW WRITE COMMAND
40    DO 50 I=1,LENG
      IC=LCH(LIST,IKOM,I)
C    SHIFT TO PRINT IN A1 IFORMAT
      JC=LSH(IC,29)
50    WRITE(IFILE,30) JC
      IF(IFORM.GE.0) RETURN
C
C    APPEND SPACES
60    IF(IDIFF.EQ.0) RETURN
      DO 70 I=1,IDIFF
70    WRITE(IFILE,30)SPACE
      RETURN
C
C    IER OF SOME KIND
100   IER=1
      RETURN
C
      END
