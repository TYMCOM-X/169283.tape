    P R O G R A M   R E C K P 3 		COBOL (005001,107001)	22-JUN-73  20:28		PAGE 1
    RECKP3.CBL    13-APR-73  14:59

    0001    ID DIVISION.
    0002    PROGRAM-ID. RECKP3.
    0003    DATE-COMPILED. 22-JUN-73. 
    0004    ENVIRONMENT DIVISION.
    0005    INPUT-OUTPUT SECTION.
    0006    FILE-CONTROL.
    0007        SELECT MASTER-FILE ASSIGN TO DSK;
    0008        ACCESS MODE IS INDEXED;
    0009        SYMBOLIC KEY IS ACCESS-KEY;
    0010        RECORD KEY IS ACCOUNT-NUMBER IN MASTER-FILE-RECORD;
    0011        RECORDING MODE IS ASCII.
    0012        SELECT TRANS-FILE ASSIGN TO DSK;
    0013        RECORDING MODE IS ASCII.
    0014    DATA DIVISION.
    0015    FILE SECTION.
    0016    FD MASTER-FILE
    0017        BLOCK CONTAINS 10 RECORDS
    0018        VALUE OF ID IS 'MASTERIDX'.
    0019    01 MASTER-FILE-RECORD USAGE IS DISPLAY-7.
    0020        02 ACCOUNT-NUMBER PIC X(8).
    0021        02 BALANCE-DUE PIC S9(4)V99.
    0022        02 LAST-PAYMENT PIC S9(4)V99.
    0023        02 LAST-PAYMENT-DATE PIC X(6).
    0024        02 CUM-MON-PAY PIC S9(4)V99.
    0025        02 CUM-MON-ADJ PIC S9(4)V99.
    0026        02 CUM-MON-SALES PIC S9(4)V99.
    0027        02 LAST-INVOICE-AMT PIC S9(4)V99.
    0028        02 LAST-INVOICE-DATE PIC X(6).
    0029    FD TRANS-FILE VALUE OF ID IS 'TRNFIL   '.
    0030    01 TRANS-REC USAGE IS DISPLAY-7.
    0031        02 ACCOUNT-NUMBER PIC X(8).
    0032        02 TRANS-CODE PIC X.
    0033        02 AMOUNT PIC S9(4)V99.
    0034        02 DATE PIC 9(6).
    0035    WORKING-STORAGE SECTION.
    0036    77 ACCESS-KEY PIC X(8) USAGE IS DISPLAY-7.
    0037    01 ANS PIC X USAGE IS DISPLAY-7.
    0038        88 Y-VALUE VALUE IS 'Y'.
    0039        88 N-VALUE VALUE IS 'N'.
    0040        88 GOOD VALUES ARE 'Y','N'.
    0041        88 GOOD-OPTION VALUES ARE '1','2','3','4','5','6'.
    0042    PROCEDURE DIVISION.
    0043    HOUSEKEEPING.
    0044        OPEN I-O MASTER-FILE.
    0045        DISPLAY ' '.
    0046        DISPLAY 'RECORD HANDLING OPTIONS ARE:'.
    0047        DISPLAY '   (1) DISPLAY RECORD'.
    0048        DISPLAY '   (2) CREATE RECORD'.
    0049        DISPLAY '   (3) DELETE RECORD'.
    0050        DISPLAY '   (4) EDIT RECORD'.
    0051        DISPLAY '   (5) UPDATE MASTER FILE WITH TRANSACTION FILE'.
    0052        DISPLAY '   (6) QUIT'.
    0053        DISPLAY ' '.
    0054    HOUSE-1.
    0055        DISPLAY 'INPUT OPTION: ' WITH NO ADVANCING.
    0056        ACCEPT ANS.    P R O G R A M   R E C K P 3 		COBOL (005001,107001)	22-JUN-73  20:28		PAGE 1-1
    RECKP3.CBL    13-APR-73  14:59

    0057        IF NOT GOOD-OPTION GO TO HOUSE-1.
    0058        IF ANS = '1' GO TO DISPLAY-1.
    0059        IF ANS = '2' GO TO CREATE-1.
    0060        IF ANS = '3' GO TO DELETE-1.
    0061        IF ANS = '4' GO TO EDIT-1.
    0062        IF ANS = '5' GO TO UPDATE-1.
    0063        CLOSE MASTER-FILE, STOP RUN.
    0064    DISPLAY-PAR.
    0065        DISPLAY ' '.
    0066        DISPLAY 'DISPLAY RECORD (Y,N)? ' WITH NO ADVANCING.
    0067        ACCEPT ANS.
    0068        IF NOT GOOD GO TO DISPLAY-PAR.
    0069    DISPLAY-1.
    0070        DISPLAY ' '.
    0071        IF N-VALUE GO TO HOUSE-1.
    0072        DISPLAY 'INPUT ACCOUNT NUMBER: ' WITH NO ADVANCING.
    0073        ACCEPT ACCESS-KEY.
    0074        DISPLAY ' '.
    0075        READ MASTER-FILE INVALID KEY DISPLAY ACCESS-KEY, 
    0076        ' IS NOT IN THE MASTER FILE.', GO TO DISPLAY-PAR.
    0077        DISPLAY ' '.
    0078        DISPLAY 'ACCOUNT NO. = ', ACCOUNT-NUMBER IN 
    0079        MASTER-FILE-RECORD.
    0080        DISPLAY 'BALANCE DUE = ', BALANCE-DUE.
    0081        DISPLAY 'LAST PAYMENT = ', LAST-PAYMENT.
    0082        DISPLAY 'LAST PAYMENT DATE = ', LAST-PAYMENT-DATE.
    0083        DISPLAY 'CUMULATIVE MONTHLY PAYMENTS = ', CUM-MON-PAY.
    0084        DISPLAY 'CUMULATIVE MONTHLY ADJUSTMENTS = ', CUM-MON-ADJ.
    0085        DISPLAY 'CUMULATIVE MONTHLY SALES = ', CUM-MON-SALES.
    0086        DISPLAY 'LAST INVOICE AMOUNT = ', LAST-INVOICE-AMT.
    0087        DISPLAY 'LAST INVOICE DATE = ', LAST-INVOICE-DATE.
    0088        GO TO DISPLAY-PAR.
    0089    CREATE-PAR.
    0090        DISPLAY 'CREATE RECORD (Y,N)? ' WITH NO ADVANCING.
    0091        ACCEPT ANS.
    0092        IF NOT GOOD GO TO CREATE-PAR.
    0093        IF N-VALUE DISPLAY ' ', GO TO HOUSE-1.
    0094    CREATE-1.
    0095        DISPLAY ' '.
    0096        DISPLAY 'INPUT ACCOUNT NUMBER: ' WITH NO ADVANCING.
    0097        ACCEPT ACCOUNT-NUMBER IN MASTER-FILE-RECORD.
    0098        DISPLAY '      BALANCE DUE: ' WITH NO ADVANCING.
    0099        ACCEPT BALANCE-DUE.
    0100        DISPLAY '      LAST PAYMENT AMOUNT: ' WITH NO ADVANCING.
    0101        ACCEPT LAST-PAYMENT.
    0102        DISPLAY '      LAST PAYMENT DATE: ' WITH NO ADVANCING.
    0103        ACCEPT LAST-PAYMENT-DATE.
    0104        DISPLAY '      CUMULATIVE MONTHLY PAYMENT: ' WITH NO ADVANCING.
    0105        ACCEPT CUM-MON-PAY.
    0106        DISPLAY '      CUMULATIVE MONTHLY ADJUSTMENT: ' WITH NO ADVANCING.
    0107        ACCEPT CUM-MON-ADJ.
    0108        DISPLAY '      CUMULATIVE MONTHLY SALES: ' WITH NO ADVANCING.
    0109        ACCEPT CUM-MON-SALES.
    0110        DISPLAY '      LAST INVOICE AMOUNT: ' WITH NO ADVANCING.
    0111        ACCEPT LAST-INVOICE-AMT.
    0112        DISPLAY '      LAST INVOICE DATE: ' WITH NO ADVANCING.    P R O G R A M   R E C K P 3 		COBOL (005001,107001)	22-JUN-73  20:28		PAGE 1-2
    RECKP3.CBL    13-APR-73  14:59

    0113        ACCEPT LAST-INVOICE-DATE.
    0114        DISPLAY ' '.
    0115        MOVE ACCOUNT-NUMBER IN MASTER-FILE-RECORD TO ACCESS-KEY.
    0116        WRITE MASTER-FILE-RECORD INVALID KEY DISPLAY ACCESS-KEY, 
    0117        ' IS AN EXISTING ACCOUNT, RENUMBER NEW ENTRY OR DELETE OLD ENTRY.', 
    0118        DISPLAY ' '.
    0119        GO TO CREATE-PAR.
    0120    DELETE-PAR.
    0121        DISPLAY 'DELETE RECORD (Y,N)? ' WITH NO ADVANCING.
    0122        ACCEPT ANS.
    0123        IF NOT GOOD GO TO DELETE-PAR.
    0124        IF N-VALUE DISPLAY ' ', GO TO HOUSE-1.
    0125    DELETE-1.
    0126        DISPLAY ' '.
    0127        DISPLAY 'INPUT ACCOUNT NUMBER: ' WITH NO ADVANCING.
    0128        ACCEPT ACCESS-KEY.
    0129        DISPLAY ' '.
    0130        DELETE MASTER-FILE-RECORD 
    0131        INVALID KEY DISPLAY ACCESS-KEY, 
    0132        ' IS NOT IN THE MASTER FILE.',
    0133        DISPLAY ' ',
    0134        GO TO DELETE-PAR.
    0135        DISPLAY ACCESS-KEY, ' DELETED.'
    0136        DISPLAY ' '.
    0137        GO TO DELETE-PAR.
    0138    EDIT-PAR.
    0139        DISPLAY ' '.
    0140        DISPLAY 'EDIT RECORD (Y,N)? ' WITH NO ADVANCING.
    0141        ACCEPT ANS.
    0142        IF NOT GOOD GO TO EDIT-PAR.
    0143        IF N-VALUE DISPLAY ' ', GO TO HOUSE-1.
    0144    EDIT-1.
    0145        DISPLAY ' '.
    0146        DISPLAY 'INPUT ACCOUNT NUMBER: ' WITH NO ADVANCING.
    0147        ACCEPT ACCESS-KEY.
    0148        DISPLAY ' '.
    0149        READ MASTER-FILE INVALID KEY DISPLAY ACCESS-KEY,
    0150        ' IS NOT IN THE MASTER FILE.', GO TO EDIT-PAR.
    0151    EDIT-3.
    0152        DISPLAY ' '.
    0153        DISPLAY 'BALANCE DUE = ',BALANCE-DUE,' CHANGE (Y,N)? '
    0154        WITH NO ADVANCING.
    0155        ACCEPT ANS.
    0156        IF NOT GOOD GO TO EDIT-3.
    0157        IF Y-VALUE DISPLAY 'INPUT NEW VALUE: ' WITH NO ADVANCING,
    0158        ACCEPT BALANCE-DUE.
    0159    EDIT-4.
    0160        DISPLAY ' '.
    0161        DISPLAY 'LAST PAYMENT AMOUNT = ',LAST-PAYMENT,
    0162        ' CHANGE (Y,N)? ' WITH NO ADVANCING.
    0163        ACCEPT ANS.
    0164        IF NOT GOOD GO TO EDIT-4.
    0165        IF Y-VALUE DISPLAY 'INPUT NEW VALUE: ' WITH NO
    0166        ADVANCING,ACCEPT LAST-PAYMENT.
    0167    EDIT-5.
    0168        DISPLAY ' '.    P R O G R A M   R E C K P 3 		COBOL (005001,107001)	22-JUN-73  20:28		PAGE 1-3
    RECKP3.CBL    13-APR-73  14:59

    0169        DISPLAY 'LAST PAYMENT DATE = ',LAST-PAYMENT-DATE,
    0170        ' CHANGE (Y,N)? ' WITH NO ADVANCING.
    0171        ACCEPT ANS.
    0172        IF NOT GOOD GO TO EDIT-5.
    0173        IF Y-VALUE DISPLAY 'INPUT NEW VALUE: 'WITH NO ADVANCING,
    0174        ACCEPT LAST-PAYMENT-DATE.
    0175    EDIT-6.
    0176        DISPLAY ' '.
    0177        DISPLAY 'CUMULATIVE MONTHLY PAYMENT = ',CUM-MON-PAY,
    0178        ' CHANGE (Y,N)? ' WITH NO ADVANCING.
    0179        ACCEPT ANS.
    0180        IF NOT GOOD GO TO EDIT-6.
    0181        IF Y-VALUE DISPLAY 'INPUT NEW VALUE: ' WITH NO ADVANCING,
    0182        ACCEPT CUM-MON-PAY.
    0183    EDIT-7.
    0184        DISPLAY ' '.
    0185        DISPLAY 'CUMULATIVE MONTHLY ADJUSTMENT = ',CUM-MON-ADJ,
    0186        ' CHANGE (Y,N)? ' WITH NO ADVANCING.
    0187        ACCEPT ANS.
    0188        IF NOT GOOD GO TO EDIT-7.
    0189        IF Y-VALUE DISPLAY 'INPUT NEW VALUE: ' WITH NO ADVANCING,
    0190        ACCEPT CUM-MON-ADJ.
    0191    EDIT-8.
    0192        DISPLAY ' '.
    0193        DISPLAY 'CUMULATIVE MONTHLY SALES = ',CUM-MON-SALES,
    0194        ' CHANGE (Y,N)? ' WITH NO ADVANCING.
    0195        ACCEPT ANS.
    0196        IF NOT GOOD GO TO EDIT-8.
    0197        IF Y-VALUE DISPLAY 'INPUT NEW VALUE: ' WITH NO ADVANCING,
    0198        ACCEPT CUM-MON-SALES.
    0199    EDIT-9.
    0200        DISPLAY ' '.
    0201        DISPLAY 'LAST INVOICE AMOUNT = ',LAST-INVOICE-AMT,
    0202        ' CHANGE (Y,N)? ' WITH NO ADVANCING.
    0203        ACCEPT ANS.
    0204        IF NOT GOOD GO TO EDIT-9.
    0205        IF Y-VALUE DISPLAY 'INPUT NEW VALUE: ' WITH NO ADVANCING,
    0206        ACCEPT LAST-INVOICE-AMT.
    0207    EDIT-10.
    0208        DISPLAY ' '.
    0209        DISPLAY 'LAST INVOICE DATE = ',LAST-INVOICE-DATE,
    0210        ' CHANGE (Y,N)? ' WITH NO ADVANCING.
    0211        ACCEPT ANS.
    0212        IF NOT GOOD GO TO EDIT-10.
    0213        IF Y-VALUE DISPLAY 'INPUT NEW VALUE: ' WITH NO ADVANCING,
    0214        ACCEPT LAST-INVOICE-DATE.
    0215    EDIT-11.
    0216        REWRITE MASTER-FILE-RECORD INVALID KEY DISPLAY 
    0217        ACCESS-KEY, ' IS NOT IN THE MASTER FILE.', GO TO EDIT-PAR.
    0218        DISPLAY ' '.
    0219        DISPLAY ACCESS-KEY, ' REWRITTEN.'.
    0220        GO TO EDIT-PAR.
    0221    UPDATE-PAR.
    0222        DISPLAY 'NOT YET.'.
    0223    UPDATE-1.
    0224        CLOSE MASTER-FILE, STOP RUN.

NO ERRORS DETECTED
