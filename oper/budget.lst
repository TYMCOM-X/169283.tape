    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE 1
    BUDGET.CBL    18-JUL-73  23:11

    0001    ID  DIVISION.
    0002    PROGRAM-ID.  P0316032.
    0003    AUTHOR.      B WING.
    0004    ENVIRONMENT  DIVISION.
    0005    CONFIGURATION  SECTION.
    0006    SOURCE-COMPUTER. DECsystem-10. 
    0007    OBJECT-COMPUTER. PDP-10.
    0008    INPUT-OUTPUT  SECTION.
    0009    FILE-CONTROL.
    0010        SELECT  PLAN-I-FILE     ASSIGN TO DSK
    0011         RECORDING MODE IS ASCII
    0012                                ACCESS MODE IS INDEXED
    0013                                SYMBOLIC KEY IS WH-KEY
    0014                                RECORD KEY FPI-KEY.
    0015        SELECT  TABLE-FILE      ASSIGN DSK,
    0016         RECORDING MODE IS ASCII.
    0017    I-O-CONTROL.
    0018    DATA  DIVISION.
    0019    FILE  SECTION.
    0020    FD   PLAN-I-FILE
    0021            VALUE OF IDENTIFICATION IS "PLANIIIDX"
    0022        BLOCK CONTAINS 14 RECORDS
    0023        DATA RECORDS ARE FPLANI-REC, FPLAN-REC.
    0024    01   FPLANI-REC.
    0025          03  FPI-DEL-IND        PIC X   .
    0026          03  FPI-KEY.
    0027            05  FPI-VP           PIC X .
    0028            05  FPI-MM    PIC X .
    0029            05  FPI-DIST  PIC XXX .
    0030            05 FPI-FUNC  PIC XX .
    0031            05 FPI-GRP   PIC X .
    0032            05  FPI-CT          PIC XX .
    0033            05 FPI-DETAIL  PIC XX .
    0034            05  FPI-SA          PIC XXXX .
    0035        03  FPI-LI              PIC XXXX .
    0036        03  FPI-TRANSP          PIC X .
    0037        03  FPI-DSC             PIC XXX .
    0038        03  FPI-AREA            PIC XX .
    0039        03  FPI-COMPLEX         PIC XXX .
    0040        03  FPI-AMTS.
    0041            05  FPI-JAN         PIC S9(8)  DISPLAY-6.
    0042            05  FPI-FEB         PIC S9(8)  DISPLAY-6.
    0043            05  FPI-MAR         PIC S9(8)  DISPLAY-6.
    0044            05  FPI-APR         PIC S9(8)  DISPLAY-6.
    0045            05  FPI-MAY         PIC S9(8)  DISPLAY-6.
    0046            05  FPI-JUN         PIC S9(8)  DISPLAY-6.
    0047            05  FPI-JUL         PIC S9(8)  DISPLAY-6.
    0048            05  FPI-AUG         PIC S9(8)  DISPLAY-6.
    0049            05  FPI-SEP         PIC S9(8)  DISPLAY-6.
    0050            05  FPI-OCT         PIC S9(8)  DISPLAY-6.
    0051            05  FPI-NOV         PIC S9(8)  DISPLAY-6.
    0052            05  FPI-DEC         PIC S9(8)  DISPLAY-6.
    0053    01 FPLAN-REC.
    0054      02 FP1 PIC X.
    0055      02 FP2.
    0056         03 FP-KEY.    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE 1-1
    BUDGET.CBL    18-JUL-73  23:11

    0057            05 FP-VP PIC X.
    0058            05 FP-MM PIC X.
    0059            05 FP-DIST PIC XXX.
    0060      02 FP3.
    0061         03 FP3-FU-GR-CT-DT.
    0062            04 FP3-FU-GR-CT.
    0063               05 FP3-FU-GR.
    0064                  07 FP-FUNC PIC XX.
    0065                  07 FP-GRP PIC X.
    0066               05 FP-CT     PIC XX.
    0067            04 FP-DTL       PIC XX.
    0068          03 FP-SA          PIC XXXX.
    0069      02 FILLER             PIC X(73).
    0070    FD   TABLE-FILE
    0071            VALUE OF IDENTIFICATION IS "TABLEXXXX"
    0072        BLOCK CONTAINS 0 RECORD.
    0073    01   FTBL-REC.
    0074        03  FTBL-ID             PIC X(8).
    0075        03  FTBL-CODE           PIC XX.
    0076        03  FILLER              PIC XX.
    0077        03  FTBL-ARGUMENT.
    0078          05  FTBL-ARG-5.
    0079            07  FTBL-ARG-4.
    0080              09  FTBL-ARG-3.
    0081                11  FTBL-ARG-2.
    0082                  13  FTBL-ARG-1 PIC X.
    0083                  13  FILLER     PIC X.
    0084                11  FILLER       PIC X.
    0085              09  FILLER         PIC X.
    0086            07  FILLER           PIC X.
    0087        03  FILLER              PIC X(25).
    0088        03  FTBL-RESULT.
    0089          05  FTBL-RESULT-1     PIC X.
    0090          05  FILLER            PIC X(19).
    0091        03  FILLER              PIC X(18).
    0092    WORKING-STORAGE  SECTION.
    0093    77   WH-RPT-DESC PIC X(20) VALUE SPACE.
    0094    77   WC-ZEROIT PIC X(6) VALUE 'ZEROIT'.
    0095    77   WA-TOTAL-YTD PIC S9(9) COMPUTATIONAL VALUE +0.
    0096    77   WH-KEY                  PIC X(16) VALUE SPACE.
    0097    77   WH-KEY-HOLD             PIC X(16)       VALUE SPACE.
    0098    77   WC-MINUS-1    PIC S9 COMPUTATIONAL VALUE -1.
    0099    01   W-TOTAL-LINE.
    0100        03  FILLER PIC X(6) VALUE 'TOTAL '.
    0101        03  WTOTAL-AMT PIC ZZZZZZZZ9- VALUE ZERO.
    0102    01   WAMT-DIGIT-CTR1 PIC S9 COMPUTATIONAL VALUE +0.
    0103    01   WAMT-DIGIT-CTR2 PIC S9 COMPUTATIONAL VALUE +8.
    0104    01   WAMT-NO-WORK1.
    0105        02  WAMT1A PIC X.
    0106        02  WAMT2A PIC X.
    0107        02  WAMT3A PIC X.
    0108        02  WAMT4A PIC X.
    0109        02  WAMT5A PIC X.
    0110        02  WAMT6A PIC X.
    0111        02  WAMT7A PIC X.
    0112        02  WAMT8A PIC X.    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE 1-2
    BUDGET.CBL    18-JUL-73  23:11

    0113    01   WAMT-NO-WORK2 REDEFINES WAMT-NO-WORK1.
    0114        02  WAMT-A OCCURS 8 TIMES PIC X.
    0115    01   WAMT-NO-WORK3 PIC S9(8).
    0116    01   WAMT-NO-WORK4 REDEFINES WAMT-NO-WORK3.
    0117        02  WAMT OCCURS 8 TIMES PIC X.
    0118    01   WH-FP-CNTL.
    0119        03  WHFP-FU-GR-CT-DTL.
    0120          04 WHFP-FU-GR-CT.
    0121            05  WHFP-FU-GR.
    0122              07  WHFP-FU       PIC XX      VALUE SPACE.
    0123              07  WHFP-GR       PIC X       VALUE SPACE.
    0124            05  WHFP-CT         PIC XX      VALUE SPACE.
    0125          04 WHFP-DTL PIC XX VALUE SPACE.
    0126        03  WHFP-SA             PIC XXXX    VALUE SPACE.
    0127    01   WH-SAVE-LOC PIC X(5) VALUE SPACE.
    0128    01   WH-LOC.
    0129        03  WH-LOC-VP      PIC X.
    0130        03  WH-LOC-MM      PIC X.
    0131        03  WH-LOC-DIST    PIC XXX.
    0132    01   W-PLAN.
    0133     02 W-DEL PIC X.
    0134     02 WPLAN-KEY.
    0135      03 WPLAN-VP PIC X.
    0136         88 VP-EAST VALUE '1'.
    0137         88 VP-WEST VALUE '2'.
    0138      03 WPLAN-MKT-MGR PIC X.
    0139         88 VP-EAST-MM VALUES '1' THRU '4'.
    0140         88 VP-WEST-MM VALUES '5' THRU '8'.
    0141      03 WPLAN-DIST PIC XXX.
    0142      03 WPLAN-FUNCTION PIC XX.
    0143          03  WPLAN-GROUP         PIC X.
    0144          03  WPLAN-CLASSTYP      PIC XX.
    0145          03  WPLAN-DETAIL PIC XX.
    0146          03  WPLAN-SUB-ACCT      PIC XXXX.
    0147        02  WPLAN-LINEITEM      PIC XXXX.
    0148        02  WPLAN-TRANSP        PIC X.
    0149        02  WPLAN-DSC           PIC XXX.
    0150        02  WPLAN-AREA          PIC XX.
    0151        02  WPLAN-COMPLEX       PIC XXX.
    0152        02  WPLAN-AMOUNTS.
    0153          05  WPLAN-JAN         PIC S9(8)  DISPLAY-6 VALUE +0.
    0154          05  WPLAN-FEB         PIC S9(8)  DISPLAY-6 VALUE +0.
    0155          05  WPLAN-MAR         PIC S9(8)  DISPLAY-6 VALUE +0.
    0156          05  WPLAN-APR         PIC S9(8)  DISPLAY-6 VALUE +0.
    0157          05  WPLAN-MAY         PIC S9(8)  DISPLAY-6 VALUE +0.
    0158          05  WPLAN-JUN         PIC S9(8)  DISPLAY-6 VALUE +0.
    0159          05  WPLAN-JUL         PIC S9(8)  DISPLAY-6 VALUE +0.
    0160          05  WPLAN-AUG         PIC S9(8)  DISPLAY-6 VALUE +0.
    0161          05  WPLAN-SEP         PIC S9(8)  DISPLAY-6 VALUE +0.
    0162          05  WPLAN-OCT         PIC S9(8)  DISPLAY-6 VALUE +0.
    0163          05  WPLAN-NOV         PIC S9(8)  DISPLAY-6 VALUE +0.
    0164          05  WPLAN-DEC         PIC S9(8)  DISPLAY-6 VALUE +0.
    0165    01   W-COMMAND.
    0166        03  W-CMND1-10.
    0167          05  W-CMND1-6         PIC X(6).
    0168          05  W-COMMAND-1 REDEFINES W-CMND1-6.    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE 1-3
    BUDGET.CBL    18-JUL-73  23:11

    0169            07  W-CMND1-5.
    0170              09  W-CMND1-4.
    0171                11  W-CMND1-3.
    0172                  13  W-CMND1-2.
    0173                    15  W-CMND1 PIC X.
    0174                        88  YES-COMMAND         VALUE 'Y'.
    0175                        88  NO-COMMAND          VALUE 'N'.
    0176                        88  MORE-INFO           VALUE '+'.
    0177                        88  MONTHLY-BUDGET      VALUE 'M'.
    0178                        88  QUARTERLY-BUDGET    VALUE 'Q'.
    0179                        88  EAST                VALUE 'E'.
    0180                        88  WEST                VALUE 'W'.
    0181                    15  FILLER  PIC X.
    0182                  13  FILLER    PIC X.
    0183                11  FILLER      PIC X.
    0184              09  FILLER        PIC X.
    0185            07  FILLER          PIC X.
    0186          05  W-COMMAND-2 REDEFINES W-COMMAND-1.
    0187            07  FILLER          PIC XXX.
    0188           88 ADD-COMMAND             VALUE 'ADD'.
    0189           88 REPORT-COMMAND            VALUE 'REP'.
    0190           88 CANCEL-COMMAND            VALUE 'CAN'.
    0191           88 END-COMMAND               VALUE 'END'.
    0192           88 STOP-COMMAND            VALUE 'STO'.
    0193           88 CHANGE-COMMAND            VALUE 'CHA'.
    0194           88  NEWLOC-COMMAND           VALUE 'NEW'.
    0195           88  DISPLAY-COMMAND          VALUE 'DIS'.
    0196           88  INIT-COMMAND VALUE 'INI'.
    0197           88  MKT-COMMAND  VALUE 'MKT'.
    0198           88  LOC-COMMAND  VALUE 'LOC'.
    0199           88  VP-COMMAND   VALUE 'VP '.
    0200           88  ALL-COMMAND  VALUE 'ALL'.
    0201            07  W-CMND4-6       PIC XXX.
    0202          05  W-CMND7-9         PIC XXX.
    0203          05  FILLER            PIC X.
    0204        03 W-COMMAND-3 REDEFINES W-CMND1-10.
    0205          05  W-CMND1-9         PIC X(9).
    0206          05  FILLER            PIC X.
    0207        03 W-COMMAND-4 REDEFINES W-COMMAND-3.
    0208          05  W-CLASSTYP        PIC XX.
    0209            88 DETAIL-CT VALUES '23','24','51','54','56','67','68'.
    0210          05 W-DETAIL REDEFINES W-CLASSTYP PIC XX.
    0211          05  FILLER            PIC X.
    0212          05  W-SUB-ACCT.
    0213            07  FILLER          PIC XXX.
    0214            07  W-SA-4          PIC X.
    0215          05  FILLER            PIC X.
    0216          05 W-DTL PIC XX.
    0217        03  W-CMND-AMT REDEFINES W-COMMAND-4.
    0218          05  W-AMT             PIC X(8) JUSTIFIED RIGHT.
    0219          05  W-AMOUNT REDEFINES W-AMT PIC S9(8).
    0220          05  FILLER            PIC XX.
    0221        03  W-NEG-AMOUNT REDEFINES W-CMND-AMT.
    0222            07  W-MINUS         PIC X.
    0223            07  W-NEG-AMT       PIC X(8) JUSTIFIED RIGHT.
    0224            07  W-NEGATIVE-AMT REDEFINES W-NEG-AMT PIC 9(8).    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE 1-4
    BUDGET.CBL    18-JUL-73  23:11

    0225            07  FILLER          PIC X.
    0226        03  FILLER              PIC X(70).
    0227    01   W-RESPONSE-1            PIC X(80).
    0228    01   W-RESP-2 REDEFINES W-RESPONSE-1.
    0229        03  FILLER          PIC X.
    0230        03  W-RESPONSE-2    PIC X(20).
    0231        03  FILLER          PIC X(59).
    0232    01   W-RESP-3 REDEFINES W-RESPONSE-1.
    0233        03  FILLER          PIC XX.
    0234        03  W-RESPONSE-3    PIC X(20).
    0235        03  FILLER          PIC X(58).
    0236    01   W-RESP-4 REDEFINES W-RESPONSE-1.
    0237        03  FILLER          PIC XXX.
    0238        03  W-RESPONSE-4    PIC X(20).
    0239        03  FILLER          PIC X(57).
    0240    01   W-RESP-5 REDEFINES W-RESPONSE-1.
    0241        03  W-RESP1-4          PIC XXXX.
    0242        03  W-RESPONSE-5    PIC X(20).
    0243        03  FILLER          PIC X(56).
    0244    01   W-RESP-6 REDEFINES W-RESPONSE-1.
    0245        03  FILLER              PIC X(25).
    0246        03  W-RESPONSE-6        PIC XXXX.
    0247        03  FILLER              PIC X(51).
    0248    01   WC-BLANK-LINE       PIC X(80) VALUE SPACE.
    0249    01   WH-HEADINGS.
    0250        03  WH1.
    0251          05  FILLER        PIC X(25)   VALUE SPACE.
    0252          05  FILLER        PIC X(29)   VALUE
    0253                'MARKETING EXPENSE PLAN REPORT'.
    0254          05  FILLER        PIC X(26)   VALUE SPACE.
    0255        03  WH2.
    0256          05  FILLER        PIC X(34)   VALUE SPACE.
    0257          05  FILLER        PIC X(13)   VALUE
    0258                'FOR YEAR 1973'.
    0259          05  FILLER        PIC X(33)   VALUE SPACE.
    0260        03  WH3.
    0261          05  FILLER        PIC X(7)   VALUE SPACE.
    0262          05  FILLER        PIC X(54)   VALUE
    0263            'JAN.      FEB.      MAR.      APR.      MAY       JUN.'.
    0264          05  FILLER        PIC X(19)    VALUE SPACE.
    0265        03  WH4.
    0266          05  FILLER        PIC X(7)   VALUE SPACE.
    0267          05  FILLER        PIC X(54)   VALUE
    0268            'JUL.      AUG.      SEP.      OCT.      NOV.      DEC.'.
    0269          05  FILLER PIC X(10) VALUE '     TOTAL'.
    0270           05  FILLER        PIC X(9)    VALUE SPACE.
    0271        03 WH5.
    0272          05 FILLER PIC X(72) VALUE "--------------------------------------
    0273  - "----------------------------------".
    0274    01   WA-TBL-ACCUMS.
    0275        03  WA-FUNC             PIC S99999 COMP VALUE +30.
    0276        03  WA-GRP              PIC S99999 COMP VALUE +12.
    0277        03  WA-DIST             PIC S99999 COMP VALUE +60.
    0278        03  WA-CT      PIC S99999 COMP VALUE +110.
    0279        03  WA-SA      PIC S99999 COMP VALUE +130.
    0280        03  WA-REG     PIC S99999 COMP VALUE +40.    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE 1-5
    BUDGET.CBL    18-JUL-73  23:11

    0281        03  WA-MM      PIC S99999 COMP VALUE +12.
    0282        03  WA-TMPMGR  PIC S99999 COMP VALUE +60.
    0283        03  WA-CTSA    PIC S99999 COMP VALUE +25.
    0284    01   WM-MESSAGES.
    0285        03  WM-1        PIC X(50) VALUE
    0286                ' *MARKETING PLAN SYSTEM BUDGET PROGRAM IS READY *'.
    0287        03  WM-2        PIC X(39) VALUE
    0288                '     NOTE - TO END SESSION ENTER STOP  '.
    0289        03  WM-3        PIC X(38) VALUE
    0290                '            TO END A COMMAND ENTER END'.
    0291        03  WM-4        PIC X(69) VALUE 'IF + APPEARS AFTER A MESSAGE, ENTE
    0292  - 'R + FOR ADDITIONAL INFO.'.
    0293        03  WM-5        PIC X(14) VALUE
    0294                'ENTER COMMAND+'.
    0295        03  WM-6        PIC X(19) VALUE
    0296                'ENTER LOCATION CODE'.
    0297        03  WM-7        PIC X(14) VALUE
    0298                'ENTER SUB-ACCT'.
    0299        03  WM-8        PIC X(16) VALUE
    0300                'ENTER CLASS-TYPE'.
    0301        03  WM-9        PIC X(17) VALUE
    0302                'ENTER DETAIL CODE'.
    0303        03  WM-10       PIC X(35)  VALUE
    0304                '**INVALID LOCATION CODE - TRY AGAIN'.
    0305        03  WM-11       PIC X(29)   VALUE
    0306                '**INVALID COMMAND - TRY AGAIN'.
    0307        03  WM-12       PIC X(12)   VALUE
    0308                'ENTER CT,SA+'.
    0309        03  WM-13A      PIC X(35)   VALUE
    0310                '  ENTER CLASS-TYPE, COMMA, SUB-ACCT'.
    0311        03  WM-13B      PIC X(15)   VALUE
    0312                '   I.E. XX,XXXX'.
    0313        03  WM-14       PIC X(43)   VALUE
    0314                'BUDGET MONTHLY OR QUARTERLY? ENTER M OR Q? '.
    0315        03  WM-15       PIC X(27)   VALUE
    0316                'BUDGET SAME FOR EACH MONTH?'.
    0317        03  WM-16       PIC X(60)   VALUE
    0318                'ENTER UP TO 8-DIGITS FOR BUDGET , PRECEED WITH - IF
    0319  -             'NEGATIVE'.
    0320        03  WM-17       PIC X(4)    VALUE 'JAN+'.
    0321        03  WM-18       PIC X(4)    VALUE 'FEB+'.
    0322        03  WM-19       PIC X(4)    VALUE 'MAR+'.
    0323        03  WM-20       PIC X(4)    VALUE 'APR+'.
    0324        03  WM-21       PIC X(4)    VALUE 'MAY+'.
    0325        03  WM-22       PIC X(4)    VALUE 'JUN+'.
    0326        03  WM-23       PIC X(4)    VALUE 'JUL+'.
    0327        03  WM-24       PIC X(4)    VALUE 'AUG+'.
    0328        03  WM-25       PIC X(4)    VALUE 'SEP+'.
    0329        03  WM-26       PIC X(4)    VALUE 'OCT+'.
    0330        03  WM-27       PIC X(4)    VALUE 'NOV+'.
    0331        03  WM-28       PIC X(4)    VALUE 'DEC+'.
    0332        03  WM-29       PIC X(3)    VALUE 'OK?'.
    0333        03  WM-30       PIC X(32)   VALUE
    0334                'WHAT IS WRONG? CODING OR AMOUNT?'.
    0335        03  WM-31       PIC X(18)   VALUE
    0336                'WHAT TYPE REPORT?+'.    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE 1-6
    BUDGET.CBL    18-JUL-73  23:11

    0337        03  WM-32       PIC X(13)   VALUE
    0338                'ENTER BUDGET+'.
    0339        03  WM-33       PIC X(15)   VALUE
    0340                '1ST QTR BUDGET?'.
    0341        03  WM-34       PIC X(15)   VALUE
    0342                '2ND QTR BUDGET?'.
    0343        03  WM-35       PIC X(15)   VALUE
    0344                '3RD QTR BUDGET?'.
    0345        03  WM-36       PIC X(15)   VALUE
    0346                '4TH QTR BUDGET?'.
    0347        03  WM-37      X(21)   VALUE
    0348                '    COMMAND   MEANING'.
    0349        03  WM-38       PIC X(29)   VALUE
    0350                '    1.LOC     LOCATION REPORT'.
    0351        03  WM-39       PIC X(40)   VALUE
    0352                '    2.MKT     MKTG. MNGR. SUMMARY REPORT'.
    0353        03  WM-40       PIC X(33)   VALUE
    0354                '    3.VP      V.P. SUMMARY REPORT'.
    0355        03  WM-41       PIC X(36)   VALUE
    0356                '    4.ALL     COMPANY SUMMARY REPORT'.
    0357        03  WM-42.
    0358          05  FILLER PIC X(20) VALUE 'ENTER ADJUSTMENT TO '.
    0359          05  WM-42-MO PIC XXX.
    0360          05  FILLER PIC X(6) VALUE ' AMT.+'.
    0361    01   WH-PLAN.
    0362     03 FILLER PIC X(30).
    0363     03 FILLER PIC S9(8) COMP.
    0364     03 FILLER PIC S9(8) COMP.
    0365     03 FILLER PIC S9(8) COMP.
    0366     03 FILLER PIC S9(8) COMP.
    0367     03 FILLER PIC S9(8) COMP.
    0368     03 FILLER PIC S9(8) COMP.
    0369     03 FILLER PIC S9(8) COMP.
    0370     03 FILLER PIC S9(8) COMP.
    0371     03 FILLER PIC S9(8) COMP.
    0372     03 FILLER PIC S9(8) COMP.
    0373     03 FILLER PIC S9(8) COMP.
    0374     03 FILLER PIC S9(8) COMP.
    0375    01   WD1.
    0376        03  WD1-LABEL        PIC X(2)   VALUE SPACE.
    0377        03  WD1-JAN             PIC ZZZZZZZ9-.
    0378        03  WD1-JUL REDEFINES WD1-JAN PIC ZZZZZZZ9-.
    0379        03  FILLER           PIC X       VALUE SPACE.
    0380        03  WD1-FEB             PIC ZZZZZZZ9-.
    0381        03  WD1-AUG REDEFINES WD1-FEB PIC ZZZZZZZ9-.
    0382        03  FILLER           PIC X       VALUE SPACE.
    0383        03  WD1-MAR             PIC ZZZZZZZ9-.
    0384        03  WD1-SEP REDEFINES WD1-MAR PIC ZZZZZZZ9-.
    0385        03  FILLER           PIC X       VALUE SPACE.
    0386        03  WD1-APR             PIC ZZZZZZZ9-.
    0387        03  WD1-OCT REDEFINES WD1-APR PIC ZZZZZZZ9-.
    0388        03  FILLER           PIC X       VALUE SPACE.
    0389        03  WD1-MAY             PIC ZZZZZZZ9-.
    0390        03  WD1-NOV REDEFINES WD1-MAY PIC ZZZZZZZ9-.
    0391        03  FILLER           PIC X       VALUE SPACE.
    0392        03  WD1-JUN             PIC ZZZZZZZ9-.    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE 1-7
    BUDGET.CBL    18-JUL-73  23:11

    0393        03  WD1-DEC REDEFINES WD1-JUN PIC ZZZZZZZ9-.
    0394        03  FILLER PIC X VALUE SPACE.
    0395        03  WD1-TOTAL PIC Z(8)9-.
    0396        03  FILLER              PIC X(8) VALUE SPACE.
    0397    01   WC-ZERO-AMTS.
    0398        03  WC-ZERO-PLAN-MONTHS.
    0399          05  WC-ZERO-MO      PIC S9(8) COMPUTATIONAL VALUE +0.
    0400          05  FILLER      PIC S9(8) COMPUTATIONAL VALUE +0.
    0401          05  FILLER      PIC S9(8) COMPUTATIONAL VALUE +0.
    0402          05  FILLER      PIC S9(8) COMPUTATIONAL VALUE +0.
    0403          05  FILLER      PIC S9(8) COMPUTATIONAL VALUE +0.
    0404          05  FILLER      PIC S9(8) COMPUTATIONAL VALUE +0.
    0405          05  FILLER      PIC S9(8) COMPUTATIONAL VALUE +0.
    0406          05  FILLER      PIC S9(8) COMPUTATIONAL VALUE +0.
    0407          05  FILLER      PIC S9(8) COMPUTATIONAL VALUE +0.
    0408          05  FILLER      PIC S9(8) COMPUTATIONAL VALUE +0.
    0409          05  FILLER      PIC S9(8) COMPUTATIONAL VALUE +0.
    0410          05  FILLER      PIC S9(8) COMPUTATIONAL VALUE +0.
    0411        03  WC-ZERO-YTD PIC S9(9) COMPUTATIONAL VALUE +0.
    0412    01   WA-ACCUMS.
    0413        03  WA-FUNC-JAN PIC S9(8) COMPUTATIONAL VALUE +0.
    0414        03  WA-FUNC-FEB PIC S9(8) COMPUTATIONAL VALUE +0.
    0415        03  WA-FUNC-MAR PIC S9(8) COMPUTATIONAL VALUE +0.
    0416        03  WA-FUNC-APR PIC S9(8) COMPUTATIONAL VALUE +0.
    0417        03  WA-FUNC-MAY PIC S9(8) COMPUTATIONAL VALUE +0.
    0418        03  WA-FUNC-JUN PIC S9(8) COMPUTATIONAL VALUE +0.
    0419        03  WA-FUNC-JUL PIC S9(8) COMPUTATIONAL VALUE +0.
    0420        03  WA-FUNC-AUG PIC S9(8) COMPUTATIONAL VALUE +0.
    0421        03  WA-FUNC-SEP PIC S9(8) COMPUTATIONAL VALUE +0.
    0422        03  WA-FUNC-OCT PIC S9(8) COMPUTATIONAL VALUE +0.
    0423        03  WA-FUNC-NOV PIC S9(8) COMPUTATIONAL VALUE +0.
    0424        03  WA-FUNC-DEC PIC S9(8) COMPUTATIONAL VALUE +0.
    0425        03  WA-FUNC-TOTL PIC S9(9) COMPUTATIONAL VALUE +0.
    0426    01   WA-TOTL-ACCUMS.
    0427        03  WA-TOTL-JAN         PIC S9(8) COMPUTATIONAL VALUE +0.
    0428        03  WA-TOTL-FEB         PIC S9(8) COMPUTATIONAL VALUE +0.
    0429        03  WA-TOTL-MAR         PIC S9(8) COMPUTATIONAL VALUE +0.
    0430        03  WA-TOTL-APR         PIC S9(8) COMPUTATIONAL VALUE +0.
    0431        03  WA-TOTL-MAY         PIC S9(8) COMPUTATIONAL VALUE +0.
    0432        03  WA-TOTL-JUN         PIC S9(8) COMPUTATIONAL VALUE +0.
    0433        03  WA-TOTL-JUL         PIC S9(8) COMPUTATIONAL VALUE +0.
    0434        03  WA-TOTL-AUG         PIC S9(8) COMPUTATIONAL VALUE +0.
    0435        03  WA-TOTL-SEP         PIC S9(8) COMPUTATIONAL VALUE +0.
    0436        03  WA-TOTL-OCT         PIC S9(8) COMPUTATIONAL VALUE +0.
    0437        03  WA-TOTL-NOV         PIC S9(8) COMPUTATIONAL VALUE +0.
    0438        03  WA-TOTL-DEC         PIC S9(8) COMPUTATIONAL VALUE +0.
    0439        03  WA-TOTL-YTD PIC S9(9) COMPUTATIONAL VALUE +0.
    0440    01   WA-CT-ACCUMS.
    0441        03  WA-CT-JAN PIC S9(8) COMPUTATIONAL VALUE +0.
    0442        03  WA-CT-FEB PIC S9(8) COMPUTATIONAL VALUE +0.
    0443        03  WA-CT-MAR PIC S9(8) COMPUTATIONAL VALUE +0.
    0444        03  WA-CT-APR PIC S9(8) COMPUTATIONAL VALUE +0.
    0445        03  WA-CT-MAY PIC S9(8) COMPUTATIONAL VALUE +0.
    0446        03  WA-CT-JUN PIC S9(8) COMPUTATIONAL VALUE +0.
    0447        03  WA-CT-JUL PIC S9(8) COMPUTATIONAL VALUE +0.
    0448        03  WA-CT-AUG PIC S9(8) COMPUTATIONAL VALUE +0.    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE 1-8
    BUDGET.CBL    18-JUL-73  23:11

    0449        03  WA-CT-SEP PIC S9(8) COMPUTATIONAL VALUE +0.
    0450        03  WA-CT-OCT PIC S9(8) COMPUTATIONAL VALUE +0.
    0451        03  WA-CT-NOV PIC S9(8) COMPUTATIONAL VALUE +0.
    0452        03  WA-CT-DEC PIC S9(8) COMPUTATIONAL VALUE +0.
    0453        03  WA-CT-TOTL PIC S9(9) COMPUTATIONAL VALUE +0.
    0454    01   WS-SWITCHES.
    0455        03  WS-SW-ON    PIC X       VALUE 'X'.
    0456        03  WS-LOC-ERR  PIC X       VALUE SPACE.
    0457            88  GOOD-LOC            VALUE SPACE.
    0458            88  BAD-LOC             VALUE 'X'.
    0459        03  WS-ISAM     PIC X       VALUE SPACE.
    0460            88  ISAM-RANDOM         VALUE 'R'.
    0461            88  ISAM-SEQ            VALUE 'S'.
    0462        03  WS-EOF-PLAN PIC X       VALUE SPACE.
    0463            88  EOF-PLAN            VALUE 'X'.
    0464        03  WS-CT-SA-ERR PIC X       VALUE SPACE.
    0465            88  CT-SA-ERR            VALUE 'X'.
    0466        03  WS-TOTAL-CORR PIC X      VALUE SPACE.
    0467            88  TOTAL-CORR           VALUE 'X'.
    0468    01   WH-TOTAL-LINE-1.
    0469        03  FILLER PIC X(7) VALUE '*TOTAL '.
    0470        03  WH-TOTL-1-DESC PIC X(20).
    0471    01   WH-TOTAL-LINE-2.
    0472        03  FILLER PIC X(8) VALUE '**TOTAL '.
    0473        03  WH-TOTL-2-DESC PIC X(20).
    0474    01   WH-TOTAL-LINE-3.
    0475        03  FILLER PIC X(9) VALUE '***TOTAL '.
    0476        03  WH-TOTL-3-DESC PIC X(20).
    0477    01   WT-TBL-CT.
    0478        03  WT-CLSTYP   OCCURS 1 TO 110 TIMES DEPENDING ON WA-CT
    0479                        ASCENDING KEY IS WT-CT
    0480                        INDEXED BY ICT.
    0481          05  WT-CT     PIC XX.
    0482          05  WT-CT-DES PIC X(20).
    0483    01   WT-TBL-SA.
    0484        03  WT-SUBACCT  OCCURS 1 TO 130 TIMES DEPENDING ON WA-SA
    0485                        ASCENDING KEY IS WT-SA
    0486                        INDEXED BY ISA.
    0487          05  WT-SA     PIC XXXX.
    0488          05  WT-SA-DES PIC X(20).
    0489    01   WT-TBL-REG.
    0490        03  WT-REGION   OCCURS 1 TO 40 TIMES
    0491                        DEPENDING ON WA-REG
    0492                        ASCENDING KEY IS WT-REG
    0493                        INDEXED BY IRG.
    0494          05  WT-REG     PIC XXX.
    0495          05  WT-REG-DES PIC X(20).
    0496    01   WT-TBL-MKTMGR.
    0497        03  WT-MKTMGR   OCCURS 1 TO 12 TIMES
    0498                        DEPENDING ON WA-MM
    0499                        ASCENDING KEY IS WT-MM
    0500                        INDEXED BY IMM.
    0501          05  WT-MM     PIC X.
    0502          05  WT-MM-DES PIC X(20).
    0503    01   WT-TBL-TEMPMGR.
    0504        03  WT-TMPMGR   OCCURS 1 TO 60 TIMES    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE 1-9
    BUDGET.CBL    18-JUL-73  23:11

    0505                        DEPENDING ON WA-TMPMGR
    0506                        ASCENDING KEY IS WT-TM
    0507                        INDEXED BY ITM.
    0508          05  WT-TM     PIC XXX.
    0509        03    WT-TM-MM OCCURS 60 TIMES INDEXED BY ITM.
    0510           05 FILLER PIC X.
    0511    01   WT-TBL-CTSA.
    0512        03  WT-CT-SA    OCCURS 1 TO 25 TIMES
    0513                        DEPENDING ON WA-CTSA
    0514                        ASCENDING KEY IS WT-CTSA
    0515                        INDEXED BY ICTSA.
    0516          05  WT-CTSA   PIC X(5).
    0517          05  WT-CTSA-DES PIC X(20).
    0518    01   WT-TBL-DIST.
    0519        03  WT-DISTRICT    OCCURS 1 TO 60 TIMES
    0520                           DEPENDING ON WA-DIST
    0521                           ASCENDING KEY IS WT-DIST
    0522                                INDEXED BY IDIST.
    0523            05  WT-DIST         PIC XXX.
    0524            05  WT-DIST-DES     PIC X(20).
    0525    01   WT-TBL-GRUP.
    0526        03  WT-GROUP            OCCURS 1 TO 12 TIMES
    0527                                DEPENDING ON WA-GRP
    0528                                ASCENDING KEY IS WT-GRP
    0529                                INDEXED BY IGRP.
    0530            05  WT-GRP          PIC X.
    0531            05  WT-GRP-DES      PIC X(20).
    0532    01   WT-TBL-FUNC.
    0533        03  WT-FUNCTION         OCCURS 1 TO 30 TIMES
    0534                                DEPENDING ON WA-FUNC
    0535                                ASCENDING KEY IS WT-FUNC
    0536                                INDEXED BY IFUNC.
    0537            05  WT-FUNC         PIC XX.
    0538            05  WT-FUNC-DES     PIC X(20).
    0539    PROCEDURE  DIVISION.
    0540    100-OPEN-FILES.
    0541        PERFORM 962-OPEN-PLANI-IO.
    0542        MOVE 'R' TO WS-ISAM.
    0543    105-INIT-PGM-MSGS.
    0544        MOVE WM-1 TO W-RESPONSE-1.
    0545        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    0546        MOVE WM-2 TO W-RESPONSE-1.
    0547        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    0548        MOVE WM-3 TO W-RESPONSE-1.
    0549        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    0550        MOVE WM-4 TO W-RESPONSE-1.
    0551        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    0552        MOVE ' ' TO W-RESPONSE-1.
    0553        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    0554        MOVE 'PROCESSING WILL BEGIN SOON' TO W-RESPONSE-1.
    0555        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    0556        PERFORM 500-LOAD-TBLS THRU 500-X.
    0557    110-ACCEPT-LOCATION.
    0558        MOVE WM-6 TO W-RESPONSE-1.
    0559        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    0560        PERFORM 810-READ-COMMAND THRU 810-X.    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE 1-10
    BUDGET.CBL    18-JUL-73  23:11

    0561        PERFORM 900-VALIDATE-LOC THRU 900-X.
    0562    112.
    0563        IF GOOD-LOC
    0564            MOVE WPLAN-VP TO WH-LOC-VP
    0565            MOVE WPLAN-MKT-MGR TO WH-LOC-MM
    0566            MOVE WPLAN-DIST TO WH-LOC-DIST
    0567            MOVE WH-LOC TO WH-SAVE-LOC
    0568            ELSE
    0569                MOVE WM-10 TO W-RESPONSE-1
    0570                PERFORM 800-WRITE-RESPONSE THRU 800-X
    0571                GO TO 110-ACCEPT-LOCATION.
    0572    115-ACCEPT-COMMAND.
    0573        MOVE WH-SAVE-LOC TO WH-LOC.
    0574        MOVE WH-LOC-VP TO WPLAN-VP.
    0575        MOVE WH-LOC-MM TO WPLAN-MKT-MGR.
    0576        MOVE WH-LOC-DIST TO WPLAN-DIST.
    0577        MOVE WM-5 TO W-RESPONSE-1.
    0578        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    0579        PERFORM 810-READ-COMMAND   THRU 810-X.
    0580        IF ADD-COMMAND GO TO 120-ADD-ROUTINE.
    0581        IF REPORT-COMMAND GO TO 130-REPORT-ROUTINE.
    0582        IF CANCEL-COMMAND GO TO 140-CANCEL-ROUTINE.
    0583        IF CHANGE-COMMAND GO TO 150-CHANGE-ROUTINE.
    0584        IF NEWLOC-COMMAND, GO TO 110-ACCEPT-LOCATION.
    0585        IF INIT-COMMAND GO TO 950-INIT.
    0586        IF DISPLAY-COMMAND GO TO 160-DISPLAY-ROUTINE.
    0587        IF MORE-INFO
    0588            MOVE '  ADD - FOR ENTRY OF DATA' TO W-RESPONSE-1
    0589            PERFORM 800-WRITE-RESPONSE THRU 800-X
    0590            MOVE '  CANCEL - FOR CANCELLING DATA' TO W-RESPONSE-1
    0591            PERFORM 800-WRITE-RESPONSE THRU 800-X
    0592            MOVE '  CHANGE - FOR CHANGING DATA' TO W-RESPONSE-1
    0593            PERFORM 800-WRITE-RESPONSE THRU 800-X
    0594            MOVE '  DISPLAY- FOR DISPLAYING A BUDGET' TO W-RESPONSE-1
    0595            PERFORM 800-WRITE-RESPONSE THRU 800-X
    0596            MOVE '  REPORT - FOR REPORTING DATA' TO W-RESPONSE-1
    0597            PERFORM 800-WRITE-RESPONSE THRU 800-X
    0598            MOVE '  END - FOR ENDING A COMMAND' TO W-RESPONSE-1
    0599            PERFORM 800-WRITE-RESPONSE THRU 800-X
    0600            MOVE '  STOP - TO END SESSION' TO W-RESPONSE-1
    0601            PERFORM 800-WRITE-RESPONSE THRU 800-X
    0602            GO TO 115-ACCEPT-COMMAND.
    0603    115-1.
    0604        IF END-COMMAND GO TO 115-ACCEPT-COMMAND.
    0605        IF STOP-COMMAND GO TO 999-END.
    0606        MOVE WM-11 TO W-RESPONSE-1.
    0607        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    0608        GO TO 115-ACCEPT-COMMAND.
    0609    120-ADD-ROUTINE.
    0610        MOVE WM-12 TO W-RESPONSE-1.
    0611        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    0612        PERFORM 810-READ-COMMAND   THRU 810-X.
    0613        IF MORE-INFO
    0614                MOVE WM-13A TO W-RESPONSE-1
    0615                PERFORM 800-WRITE-RESPONSE THRU 800-X
    0616                MOVE WM-13B TO W-RESPONSE-1    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE 1-11
    BUDGET.CBL    18-JUL-73  23:11

    0617                PERFORM 800-WRITE-RESPONSE THRU 800-X
    0618                GO TO 120-ADD-ROUTINE.
    0619    120-0.
    0620        IF END-COMMAND GO TO 115-ACCEPT-COMMAND.
    0621    120-1.
    0622        MOVE W-CLASSTYP TO WPLAN-CLASSTYP.
    0623        IF W-SA-4 = ' ' MOVE '0' TO W-SA-4.
    0624        MOVE W-SUB-ACCT TO WPLAN-SUB-ACCT.
    0625        IF DETAIL-CT PERFORM 120-4-GET-DETAIL THRU 120-4-X
    0626             ELSE MOVE '00' TO WPLAN-DETAIL.
    0627        PERFORM 905-VALIDATE-CT-SA THRU 905-X.
    0628        PERFORM 820-CALC-FUNC THRU 820-X.
    0629        PERFORM 825-CALC-GROUP THRU 825-X.
    0630        MOVE WPLAN-KEY TO WH-KEY.
    0631    120-1-2.
    0632  *     MOVE WM-14 TO W-RESPONSE-1.
    0633  *     PERFORM 801-WRITE-RESPONSE THRU 800-X.
    0634  *     PERFORM 810-READ-COMMAND THRU 810-X.
    0635  *     IF MONTHLY-BUDGET       GO TO 120-2.
    0636  *     IF QUARTERLY-BUDGET     GO TO 120-3.
    0637  *     IF END-COMMAND GO TO 115-ACCEPT-COMMAND.
    0638  *     GO TO 120-1-2.
    0639        IF CT-SA-ERR MOVE ' ' TO WS-CT-SA-ERR
    0640          GO TO 120-ADD-ROUTINE.
    0641    120-2.
    0642        MOVE WM-15 TO W-RESPONSE-1.
    0643        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    0644        PERFORM 810-READ-COMMAND   THRU 810-X.
    0645        IF END-COMMAND GO TO 115-ACCEPT-COMMAND.
    0646        IF YES-COMMAND          GO TO 120-2-1.
    0647        IF NO-COMMAND GO TO 120-2-2.
    0648        GO TO 120-2.
    0649    120-2-1.
    0650        MOVE WM-32 TO W-RESPONSE-1.
    0651        PERFORM 120-GET-AMT THRU 120-GET-AMT-X.
    0652        MOVE W-AMOUNT TO WPLAN-JAN WPLAN-FEB WPLAN-MAR WPLAN-APR
    0653                WPLAN-MAY WPLAN-JUN WPLAN-JUL WPLAN-AUG WPLAN-SEP
    0654                WPLAN-OCT WPLAN-NOV WPLAN-DEC.
    0655        PERFORM 120-2-4 THRU 120-2-4-X.
    0656        PERFORM 120-TOTAL THRU 120-TOTAL-X.
    0657        GO TO 120-ADD-ROUTINE.
    0658    120-2-2.
    0659        MOVE WM-17 TO W-RESPONSE-1.
    0660        PERFORM 120-GET-AMT THRU 120-GET-AMT-X.
    0661        MOVE W-AMOUNT TO WPLAN-JAN.
    0662        MOVE WM-18 TO W-RESPONSE-1.
    0663        PERFORM 120-GET-AMT THRU 120-GET-AMT-X.
    0664        MOVE W-AMOUNT TO WPLAN-FEB.
    0665        MOVE WM-19 TO W-RESPONSE-1.
    0666        PERFORM 120-GET-AMT THRU 120-GET-AMT-X.
    0667        MOVE W-AMOUNT TO WPLAN-MAR.
    0668        MOVE WM-20 TO W-RESPONSE-1.
    0669        PERFORM 120-GET-AMT THRU 120-GET-AMT-X.
    0670        MOVE W-AMOUNT TO WPLAN-APR.
    0671        MOVE WM-21 TO W-RESPONSE-1.
    0672        PERFORM 120-GET-AMT THRU 120-GET-AMT-X.    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE 1-12
    BUDGET.CBL    18-JUL-73  23:11

    0673        MOVE W-AMOUNT TO WPLAN-MAY.
    0674        MOVE WM-22 TO W-RESPONSE-1.
    0675        PERFORM 120-GET-AMT THRU 120-GET-AMT-X.
    0676        MOVE W-AMOUNT TO WPLAN-JUN.
    0677        MOVE WM-23 TO W-RESPONSE-1.
    0678        PERFORM 120-GET-AMT THRU 120-GET-AMT-X.
    0679        MOVE W-AMOUNT TO WPLAN-JUL.
    0680        MOVE WM-24 TO W-RESPONSE-1.
    0681        PERFORM 120-GET-AMT THRU 120-GET-AMT-X.
    0682        MOVE W-AMOUNT TO WPLAN-AUG.
    0683        MOVE WM-25 TO W-RESPONSE-1.
    0684        PERFORM 120-GET-AMT THRU 120-GET-AMT-X.
    0685        MOVE W-AMOUNT TO WPLAN-SEP.
    0686        MOVE WM-26 TO W-RESPONSE-1.
    0687        PERFORM 120-GET-AMT THRU 120-GET-AMT-X.
    0688        MOVE W-AMOUNT TO WPLAN-OCT.
    0689        MOVE WM-27 TO W-RESPONSE-1.
    0690        PERFORM 120-GET-AMT THRU 120-GET-AMT-X.
    0691        MOVE W-AMOUNT TO WPLAN-NOV.
    0692        MOVE WM-28 TO W-RESPONSE-1.
    0693        PERFORM 120-GET-AMT THRU 120-GET-AMT-X.
    0694        MOVE W-AMOUNT TO WPLAN-DEC.
    0695        PERFORM 120-2-4 THRU 120-2-4-X.
    0696    120-2-3.
    0697        PERFORM 120-TOTAL THRU 120-TOTAL-X.
    0698        GO TO 120-ADD-ROUTINE.
    0699    120-2-4.
    0700        PERFORM 815-WRITE-ISAM THRU 815-X.
    0701        PERFORM 140-4 THRU 140-4-X.
    0702    120-2-4-X.     EXIT.
    0703    120-3.
    0704        MOVE WM-33 TO W-RESPONSE-1.
    0705        PERFORM 120-GET-AMT THRU 120-QTRLY-AMT-X.
    0706        MOVE W-AMOUNT TO WPLAN-JAN  WPLAN-FEB  WPLAN-MAR.
    0707        MOVE WM-34 TO W-RESPONSE-1.
    0708        PERFORM 120-GET-AMT THRU 120-QTRLY-AMT-X.
    0709        MOVE W-AMOUNT TO WPLAN-APR  WPLAN-MAY  WPLAN-JUN.
    0710        MOVE WM-35 TO W-RESPONSE-1.
    0711        PERFORM 120-GET-AMT THRU 120-QTRLY-AMT-X.
    0712        MOVE W-AMOUNT TO WPLAN-JUL  WPLAN-AUG  WPLAN-SEP.
    0713        MOVE WM-36 TO W-RESPONSE-1.
    0714        PERFORM 120-GET-AMT THRU 120-QTRLY-AMT-X.
    0715        MOVE W-AMOUNT TO WPLAN-OCT  WPLAN-NOV  WPLAN-DEC.
    0716        PERFORM 120-2-4 THRU 120-2-4-X.
    0717        GO TO 120-ADD-ROUTINE.
    0718    120-4-GET-DETAIL.
    0719       IF W-DTL=SPACES NEXT SENTENCE ELSE MOVE W-DTL TO WPLAN-DETAIL
    0720         GO TO 120-4-X.
    0721    120-4-1.
    0722       MOVE WM-9 TO W-RESPONSE-1.
    0723       PERFORM 800-WRITE-RESPONSE THRU 800-X.
    0724       PERFORM 810-READ-COMMAND THRU 810-X.
    0725       IF W-DETAIL NOT NUMERIC GO TO 120-4-1.
    0726       MOVE W-DETAIL TO WPLAN-DETAIL.
    0727    120-4-X.
    0728       EXIT.    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE 1-13
    BUDGET.CBL    18-JUL-73  23:11

    0729    120-GET-AMT.
    0730        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    0731        PERFORM 810-READ-COMMAND THRU 810-X.
    0732        IF MORE-INFO MOVE WM-16 TO W-RESPONSE-1
    0733          GO TO 120-GET-AMT.
    0734        IF W-MINUS = '-' MOVE W-NEG-AMT TO WAMT-NO-WORK1
    0735          PERFORM 120-GET-1 THRU 120-GET-1-X ELSE
    0736          MOVE W-AMT TO WAMT-NO-WORK1
    0737          PERFORM 120-GET-1 THRU 120-GET-1-X.
    0738        GO TO 120-GET-AMT-X.
    0739    120-GET-1.
    0740        MOVE 0 TO WAMT-DIGIT-CTR1.  MOVE 8 TO WAMT-DIGIT-CTR2.
    0741        MOVE 00000000 TO WAMT-NO-WORK3.
    0742        IF WAMT1A NOT = ' ' ADD 1 TO WAMT-DIGIT-CTR1.
    0743        IF WAMT2A NOT = ' ' ADD 1 TO WAMT-DIGIT-CTR1.
    0744        IF WAMT3A NOT = ' ' ADD 1 TO WAMT-DIGIT-CTR1.
    0745        IF WAMT4A NOT = ' ' ADD 1 TO WAMT-DIGIT-CTR1.
    0746        IF WAMT5A NOT = ' ' ADD 1 TO WAMT-DIGIT-CTR1.
    0747        IF WAMT6A NOT = ' ' ADD 1 TO WAMT-DIGIT-CTR1.
    0748        IF WAMT7A NOT = ' ' ADD 1 TO WAMT-DIGIT-CTR1.
    0749        IF WAMT8A NOT = ' ' ADD 1 TO WAMT-DIGIT-CTR1.
    0750    120-GET-1-1.
    0751        IF WAMT-DIGIT-CTR1 = 0 GO TO 120-GET-1-2.
    0752        MOVE WAMT-A (WAMT-DIGIT-CTR1) TO WAMT (WAMT-DIGIT-CTR2).
    0753        SUBTRACT 1 FROM WAMT-DIGIT-CTR1 WAMT-DIGIT-CTR2.
    0754        GO TO 120-GET-1-1.
    0755    120-GET-1-2.
    0756        IF W-MINUS = '-'
    0757          COMPUTE W-AMOUNT = WAMT-NO-WORK3 * WC-MINUS-1 ELSE
    0758          MOVE WAMT-NO-WORK3 TO W-AMOUNT.
    0759    120-GET-1-X.     EXIT.
    0760    120-GET-AMT-X.       EXIT.
    0761    120-QTRLY-AMT.
    0762        COMPUTE  W-AMOUNT ROUNDED =  W-AMOUNT / 3.
    0763    120-QTRLY-AMT-X.     EXIT.
    0764    120-TOTAL.
    0765        PERFORM 130-75-1.
    0766        MOVE WA-TOTAL-YTD TO WTOTAL-AMT.
    0767        MOVE W-TOTAL-LINE TO W-RESPONSE-1.
    0768        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    0769    120-TOTAL-X.     EXIT.
    0770    130-REPORT-ROUTINE.
    0771        MOVE LOW-VALUES TO WH-KEY.
    0772        MOVE 'S' TO WS-ISAM.
    0773    130-1.
    0774        MOVE WH-SAVE-LOC TO WH-LOC.
    0775        MOVE WM-31 TO W-RESPONSE-1.
    0776        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    0777        PERFORM 810-READ-COMMAND   THRU 810-X.
    0778        IF MORE-INFO
    0779                MOVE WM-37 TO W-RESPONSE-1
    0780                PERFORM 800-WRITE-RESPONSE THRU 800-X
    0781                MOVE WM-38 TO W-RESPONSE-1
    0782                PERFORM 800-WRITE-RESPONSE THRU 800-X
    0783                MOVE WM-39 TO W-RESPONSE-1
    0784                PERFORM 800-WRITE-RESPONSE THRU 800-X    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE 1-14
    BUDGET.CBL    18-JUL-73  23:11

    0785                MOVE WM-40 TO W-RESPONSE-1
    0786                PERFORM 800-WRITE-RESPONSE THRU 800-X
    0787                MOVE WM-41 TO W-RESPONSE-1
    0788                PERFORM 800-WRITE-RESPONSE THRU 800-X
    0789                GO TO 130-1.
    0790        IF W-CMND1-3 = 'LOC' GO TO 130-2.
    0791        IF W-CMND1-3 = 'MKT' MOVE 000 TO WH-LOC-DIST GO TO 130-2.
    0792        IF W-CMND1-2 = 'VP' MOVE 000 TO WH-LOC-DIST
    0793            MOVE 0 TO WH-LOC-MM GO TO 130-2.
    0794        IF W-CMND1-3 = 'ALL' MOVE 000 TO WH-LOC-DIST
    0795            MOVE 0 TO WH-LOC-MM MOVE 0 TO WH-LOC-VP
    0796            GO TO 130-2.
    0797        IF END-COMMAND GO TO 130-99-END.
    0798        MOVE WM-11 TO W-RESPONSE-1.
    0799        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    0800        GO TO 130-1.
    0801    130-2.
    0802        MOVE SPACES TO WH-FP-CNTL,  W-PLAN.
    0803        DISPLAY WH-LOC.
    0804        GO TO 130-2-0.
    0805  *     START PLAN-FILE INVALID KEY
    0806  *         MOVE '*LOC NOT FOUND-TRY AGAIN' TO W-RESPONSE-1
    0807  *         PERFORM 800-WRITE-RESPONSE THRU 800-X
    0808  *         GO TO 130-2-1.
    0809    130-2-0.
    0810        PERFORM 130-80-RPT-HDG THRU 130-80-X.
    0811        PERFORM 130-55-ASTERIK THRU 130-55-X.
    0812        IF W-CMND1-3 = 'LOC' PERFORM 130-54-DIST THRU 130-54-X
    0813            PERFORM 130-55-ASTERIK THRU 130-55-X
    0814            PERFORM 130-60-MOHDG-1 THRU 130-60-X
    0815            PERFORM 130-60-MOHDG-2 THRU 130-60-X
    0816            GO TO 130-3.
    0817        IF W-CMND1-3 = 'MKT' PERFORM 130-61-5 THRU 130-61-X
    0818            PERFORM 130-55-ASTERIK THRU 130-55-X
    0819            PERFORM 130-60-MOHDG-1 THRU 130-60-X
    0820            PERFORM 130-60-MOHDG-2 THRU 130-60-X
    0821            GO TO 130-3.
    0822        IF W-CMND1-2 = 'VP' PERFORM 130-62-VP THRU 130-62-X
    0823            PERFORM 130-55-ASTERIK THRU 130-55-X
    0824            PERFORM 130-60-MOHDG-1 THRU 130-60-X
    0825            PERFORM 130-60-MOHDG-2 THRU 130-60-X
    0826            GO TO 130-3.
    0827        IF W-CMND1-3 = 'ALL' MOVE 'COMPANY REPORT' TO W-RESPONSE-1
    0828            WH-RPT-DESC
    0829            PERFORM 800-WRITE-RESPONSE THRU 800-X
    0830            PERFORM 130-55-ASTERIK THRU 130-55-X
    0831            PERFORM 130-60-MOHDG-1 THRU 130-60-X
    0832            PERFORM 130-60-MOHDG-2 THRU 130-60-X
    0833            GO TO 130-3.
    0834    130-2-1.
    0835        PERFORM 110-ACCEPT-LOCATION.
    0836        IF END-COMMAND GO TO 130-99-END.
    0837        IF NOT GOOD-LOC
    0838            MOVE WM-10 TO W-RESPONSE-1
    0839            PERFORM 800-WRITE-RESPONSE THRU 800-X
    0840            GO TO 130-2-1.    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE 1-15
    BUDGET.CBL    18-JUL-73  23:11

    0841    130-3.
    0842        READ PLAN-I-FILE INTO W-PLAN INVALID KEY GO TO 130-9-EOF.
    0843                IF FP-KEY > WH-LOC GO TO 130-9-EOF.
    0844                IF FP-KEY < WH-LOC GO TO 130-3.
    0845        IF WPLAN-AMOUNTS = WC-ZERO-PLAN-MONTHS GO TO 130-3.
    0846        IF WH-FP-CNTL = SPACES GO TO 130-3-FUNC-X.
    0847        IF FP-FUNC > WHFP-FU PERFORM 130-7-CT-TOTL THRU 130-7-X
    0848          GO TO 130-3-FUNC.
    0849        IF FP3-FU-GR > WHFP-FU-GR PERFORM 130-7-CT-TOTL THRU 130-7-X
    0850          GO TO 130-3-GRP.
    0851        IF FP3-FU-GR-CT > WHFP-FU-GR-CT
    0852          PERFORM 130-7-CT-TOTL THRU 130-7-X
    0853          GO TO 130-3-CT.
    0854        GO TO 130-3-SA.
    0855    130-3-FUNC.
    0856        MOVE WT-FUNC-DES (IFUNC) TO WH-TOTL-2-DESC.
    0857        MOVE WH-TOTAL-LINE-2 TO W-RESPONSE-1.
    0858        PERFORM 800-WRITE-RESPONSE.
    0859        ADD WA-FUNC-JAN TO WA-TOTL-JAN.
    0860        ADD WA-FUNC-FEB TO WA-TOTL-FEB.
    0861        ADD WA-FUNC-MAR TO WA-TOTL-MAR.
    0862        ADD WA-FUNC-APR TO WA-TOTL-APR.
    0863        ADD WA-FUNC-MAY TO WA-TOTL-MAY.
    0864        ADD WA-FUNC-JUN TO WA-TOTL-JUN.
    0865        ADD WA-FUNC-JUL TO WA-TOTL-JUL.
    0866        ADD WA-FUNC-AUG TO WA-TOTL-AUG.
    0867        ADD WA-FUNC-SEP TO WA-TOTL-SEP.
    0868        ADD WA-FUNC-OCT TO WA-TOTL-OCT.
    0869        ADD WA-FUNC-NOV TO WA-TOTL-NOV.
    0870        ADD WA-FUNC-DEC TO WA-TOTL-DEC.
    0871        ADD WA-FUNC-TOTL TO WA-TOTL-YTD.
    0872        MOVE WA-FUNC-JAN TO WD1-JAN.
    0873        MOVE WA-FUNC-FEB TO WD1-FEB.
    0874        MOVE WA-FUNC-MAR TO WD1-MAR.
    0875        MOVE WA-FUNC-APR TO WD1-APR.
    0876        MOVE WA-FUNC-MAY TO WD1-MAY.
    0877        MOVE WA-FUNC-JUN TO WD1-JUN.
    0878        MOVE WC-ZERO-YTD TO WD1-TOTAL.
    0879        MOVE WD1 TO W-RESPONSE-1.
    0880        PERFORM 800-WRITE-RESPONSE  THRU 800-X.
    0881        MOVE WA-FUNC-JUL TO WD1-JUL.
    0882        MOVE WA-FUNC-AUG TO WD1-AUG.
    0883        MOVE WA-FUNC-SEP TO WD1-SEP.
    0884        MOVE WA-FUNC-OCT TO WD1-OCT.
    0885        MOVE WA-FUNC-NOV TO WD1-NOV.
    0886        MOVE WA-FUNC-DEC TO WD1-DEC.
    0887        MOVE WA-FUNC-TOTL TO WD1-TOTAL.
    0888        MOVE SPACE TO WD1-LABEL.
    0889        MOVE WD1 TO W-RESPONSE-1.
    0890        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    0891        MOVE WC-ZERO-AMTS TO WA-ACCUMS.
    0892    130-3-FUNC-X.
    0893        PERFORM 130-56-FUNC THRU 130-56-X.
    0894    130-3-GRP.
    0895        PERFORM 130-57-GROUP THRU 130-57-X.
    0896    130-3-CT.    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE 1-16
    BUDGET.CBL    18-JUL-73  23:11

    0897        PERFORM 130-58-CT THRU 130-58-X.
    0898    130-3-SA.
    0899        PERFORM 130-59-SA THRU 130-59-X.
    0900    130-4.
    0901        PERFORM 130-75-TOTL THRU 130-75-X.
    0902        PERFORM 130-70-AMT1 THRU 130-70-X.
    0903        PERFORM 130-70-AMT2 THRU 130-70-X.
    0904    130-5.
    0905        MOVE FP3 TO WH-FP-CNTL.
    0906        GO TO 130-3.
    0907    130-6-TOTL.
    0908        MOVE WH-RPT-DESC TO WH-TOTL-3-DESC.
    0909        MOVE WH-TOTAL-LINE-3 TO W-RESPONSE-1.
    0910        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    0911        MOVE WA-TOTL-JAN TO WD1-JAN.
    0912        MOVE WA-TOTL-FEB TO WD1-FEB.
    0913        MOVE WA-TOTL-MAR TO WD1-MAR.
    0914        MOVE WA-TOTL-APR TO WD1-APR.
    0915        MOVE WA-TOTL-MAY TO WD1-MAY.
    0916        MOVE WA-TOTL-JUN TO WD1-JUN.
    0917        MOVE WC-ZERO-YTD TO WD1-TOTAL.
    0918        MOVE WD1 TO W-RESPONSE-1.
    0919        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    0920        MOVE WA-TOTL-JUL TO WD1-JUL.
    0921        MOVE WA-TOTL-AUG TO WD1-AUG.
    0922        MOVE WA-TOTL-SEP TO WD1-SEP.
    0923        MOVE WA-TOTL-OCT TO WD1-OCT.
    0924        MOVE WA-TOTL-NOV TO WD1-NOV.
    0925        MOVE WA-TOTL-DEC TO WD1-DEC.
    0926        MOVE WA-TOTL-YTD TO WD1-TOTAL.
    0927        MOVE SPACE TO WD1-LABEL.
    0928        MOVE WD1 TO W-RESPONSE-1.
    0929        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    0930    130-6-X.     EXIT.
    0931    130-7-CT-TOTL.
    0932        MOVE WT-CT-DES (ICT) TO WH-TOTL-1-DESC.
    0933        MOVE WH-TOTAL-LINE-1 TO W-RESPONSE-1.
    0934        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    0935        ADD WA-CT-JAN TO WA-FUNC-JAN.
    0936        ADD WA-CT-FEB TO WA-FUNC-FEB.
    0937        ADD WA-CT-MAR TO WA-FUNC-MAR.
    0938        ADD WA-CT-APR TO WA-FUNC-APR.
    0939        ADD WA-CT-MAY TO WA-FUNC-MAY.
    0940        ADD WA-CT-JUN TO WA-FUNC-JUN.
    0941        ADD WA-CT-JUL TO WA-FUNC-JUL.
    0942        ADD WA-CT-AUG TO WA-FUNC-AUG.
    0943        ADD WA-CT-SEP TO WA-FUNC-SEP.
    0944        ADD WA-CT-OCT TO WA-FUNC-OCT.
    0945        ADD WA-CT-NOV TO WA-FUNC-NOV.
    0946        ADD WA-CT-DEC TO WA-FUNC-DEC.
    0947        ADD WA-CT-TOTL TO WA-FUNC-TOTL.
    0948        MOVE WA-CT-JAN TO WD1-JAN.
    0949        MOVE WA-CT-FEB TO WD1-FEB.
    0950        MOVE WA-CT-MAR TO WD1-MAR.
    0951        MOVE WA-CT-APR TO WD1-APR.
    0952        MOVE WA-CT-MAY TO WD1-MAY.    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE 1-17
    BUDGET.CBL    18-JUL-73  23:11

    0953        MOVE WA-CT-JUN TO WD1-JUN.
    0954        MOVE WC-ZERO-YTD TO WD1-TOTAL.
    0955        MOVE WD1 TO W-RESPONSE-1.
    0956        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    0957        MOVE WA-CT-JUL TO WD1-JUL.
    0958        MOVE WA-CT-AUG TO WD1-AUG.
    0959        MOVE WA-CT-SEP TO WD1-SEP.
    0960        MOVE WA-CT-OCT TO WD1-OCT.
    0961        MOVE WA-CT-NOV TO WD1-NOV.
    0962        MOVE WA-CT-DEC TO WD1-DEC.
    0963        MOVE WA-CT-TOTL TO WD1-TOTAL.
    0964        MOVE WD1 TO W-RESPONSE-1.
    0965        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    0966        MOVE WC-ZERO-AMTS TO WA-CT-ACCUMS.
    0967    130-7-X.     EXIT.
    0968    130-9-EOF.
    0969        PERFORM 130-7-CT-TOTL THRU 130-7-X.
    0970        PERFORM 130-3-FUNC.
    0971        PERFORM 130-6-TOTL THRU 130-6-X.
    0972        MOVE SPACE TO WH-FP-CNTL.
    0973        DISPLAY ' '.  DISPLAY ' '.
    0974    130-9.
    0975        MOVE 'ANOTHER REPORT? Y OR N' TO W-RESPONSE-1.
    0976        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    0977        PERFORM 810-READ-COMMAND THRU 810-X.
    0978        IF END-COMMAND GO TO 130-99-END.
    0979        IF W-CMND1 = 'N' GO TO 130-99-END.
    0980        IF W-CMND1 = 'Y'
    0981            MOVE LOW-VALUES TO WH-KEY
    0982            MOVE WC-ZERO-AMTS TO WA-TOTL-ACCUMS
    0983            GO TO 130-1.
    0984        GO TO 130-9.
    0985    130-54-DIST.
    0986        SET IDIST TO 1.
    0987        SEARCH WT-DISTRICT AT END GO TO 130-54-ATEND
    0988            WHEN WH-LOC-DIST EQUAL WT-DIST (IDIST)
    0989            MOVE WT-DIST-DES (IDIST) TO W-RESPONSE-1 WH-RPT-DESC
    0990            PERFORM 800-WRITE-RESPONSE THRU 800-X
    0991            GO TO 130-54-X.
    0992    130-54-ATEND.     MOVE '*INVALID DIST' TO W-RESPONSE-1.
    0993        MOVE WPLAN-DIST TO W-RESPONSE-6.
    0994        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    0995    130-54-X.    EXIT.
    0996    130-55-ASTERIK.
    0997        MOVE '********************' TO W-RESPONSE-1.
    0998        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    0999    130-55-X.    EXIT.
    1000    130-56-FUNC.
    1001        SET IFUNC TO 1.
    1002        SEARCH WT-FUNCTION AT END GO TO 130-56-ATEND
    1003            WHEN WPLAN-FUNCTION EQUAL WT-FUNC (IFUNC)
    1004            MOVE WT-FUNC-DES (IFUNC) TO W-RESPONSE-1
    1005            PERFORM 800-WRITE-RESPONSE THRU 800-X
    1006            GO TO 130-56-X.
    1007    130-56-ATEND.     MOVE '*INVALID FUNC' TO W-RESPONSE-1.
    1008        MOVE WPLAN-FUNCTION TO W-RESPONSE-6.    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE 1-18
    BUDGET.CBL    18-JUL-73  23:11

    1009        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1010    130-56-X.    EXIT.
    1011    130-57-GROUP.
    1012        SET IGRP TO 1.
    1013        SEARCH WT-GROUP AT END GO TO 130-57-ATEND
    1014            WHEN WPLAN-GROUP EQUAL WT-GRP (IGRP),
    1015            MOVE WT-GRP-DES (IGRP) TO W-RESPONSE-2,
    1016            PERFORM 800-WRITE-RESPONSE THRU 800-X
    1017            GO TO 130-57-X.
    1018    130-57-ATEND.     MOVE '*INVALID GROUP' TO W-RESPONSE-2.
    1019        MOVE WPLAN-GROUP TO W-RESPONSE-6.
    1020        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1021    130-57-X.
    1022        EXIT.
    1023    130-58-CT.
    1024        SET ICT TO 1.
    1025        SEARCH WT-CLSTYP AT END GO TO 130-58-ATEND
    1026          WHEN WPLAN-CLASSTYP EQUAL WT-CT(ICT)
    1027          MOVE WT-CT-DES(ICT) TO W-RESPONSE-3
    1028          PERFORM 800-WRITE-RESPONSE THRU 800-X
    1029          GO TO 130-58-X.
    1030    130-58-ATEND.      MOVE '*INVALID CT' TO W-RESPONSE-3.
    1031         MOVE WPLAN-CLASSTYP TO W-RESPONSE-6.
    1032         PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1033    130-58-X.    EXIT.
    1034    130-59-SA.
    1035         SET ISA TO 1.
    1036        SEARCH WT-SUBACCT AT END GO TO 130-59-ATEND
    1037            WHEN WPLAN-SUB-ACCT EQUAL WT-SA (ISA)
    1038            MOVE WT-SA-DES (ISA) TO W-RESPONSE-4
    1039            PERFORM 800-WRITE-RESPONSE THRU 800-X
    1040            GO TO 130-59-X.
    1041    130-59-ATEND.     MOVE '*INVALID SA' TO W-RESPONSE-4.
    1042        MOVE WPLAN-SUB-ACCT TO W-RESPONSE-6.
    1043        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1044    130-59-X.    EXIT.
    1045    130-60-MOHDG-1.
    1046        MOVE WH5 TO W-RESPONSE-1.
    1047        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1048        MOVE WH3 TO W-RESPONSE-1.
    1049        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1050       MOVE WH5 TO W-RESPONSE-1.
    1051        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1052        GO TO 130-60-X.
    1053    130-60-MOHDG-2.
    1054        MOVE WH4 TO W-RESPONSE-1.
    1055        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1056       MOVE WH5 TO W-RESPONSE-1.
    1057       PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1058    130-60-X.    EXIT.
    1059    130-61-MKTMGR.
    1060        SET ITM TO 1.
    1061        SEARCH WT-TMPMGR AT END GO TO 130-61-6
    1062            WHEN WH-LOC-DIST EQUAL WT-TM (ITM)
    1063            GO TO 130-61-5.
    1064    130-61-5.    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE 1-19
    BUDGET.CBL    18-JUL-73  23:11

    1065        SET IMM TO 1.
    1066        SEARCH WT-MKTMGR AT END GO TO 130-61-6
    1067            WHEN WT-TM-MM (ITM) EQUAL WT-MM (IMM)
    1068            MOVE WT-MM-DES (IMM) TO W-RESPONSE-1 WH-RPT-DESC
    1069            PERFORM 800-WRITE-RESPONSE THRU 800-X
    1070            GO TO 130-61-X.
    1071    130-61-6.
    1072        MOVE '*INVALID MKTMGR' TO W-RESPONSE-1.
    1073        MOVE WT-TM-MM (ITM) TO W-RESPONSE-6.
    1074        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1075    130-61-X.    EXIT.
    1076    130-62-VP.
    1077        IF WT-TM-MM (ITM) = '1' OR '2' OR '3' OR '4'
    1078            MOVE 'RETAIL VP - EAST' TO W-RESPONSE-1 WH-RPT-DESC
    1079            PERFORM 800-WRITE-RESPONSE THRU 800-X
    1080            GO TO 130-62-X.
    1081        MOVE 'RETAIL VP - WEST' TO W-RESPONSE-1 WH-RPT-DESC.
    1082        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1083        GO TO 130-62-X.
    1084    130-62-X.     EXIT.
    1085    130-70-AMT1.
    1086        MOVE WPLAN-JAN TO WD1-JAN.
    1087        MOVE WPLAN-FEB TO WD1-FEB.
    1088        MOVE WPLAN-MAR TO WD1-MAR.
    1089        MOVE WPLAN-APR TO WD1-APR.
    1090        MOVE WPLAN-MAY TO WD1-MAY.
    1091        MOVE WPLAN-JUN TO WD1-JUN.
    1092        MOVE WC-ZERO-YTD TO WD1-TOTAL.
    1093        MOVE WD1 TO W-RESPONSE-1.
    1094        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1095        GO TO 130-70-X.
    1096    130-70-AMT2.
    1097        MOVE WPLAN-JUL TO WD1-JUL.
    1098        MOVE WPLAN-AUG TO WD1-AUG.
    1099        MOVE WPLAN-SEP TO WD1-SEP.
    1100        MOVE WPLAN-OCT TO WD1-OCT.
    1101        MOVE WPLAN-NOV TO WD1-NOV.
    1102        MOVE WPLAN-DEC TO WD1-DEC.
    1103        MOVE WA-TOTAL-YTD TO WD1-TOTAL.
    1104        MOVE WD1 TO W-RESPONSE-1.
    1105        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1106        GO TO 130-70-X.
    1107    130-70-X.     EXIT.
    1108    130-75-TOTL.
    1109        ADD WPLAN-JAN TO WA-CT-JAN.
    1110        ADD WPLAN-FEB TO WA-CT-FEB.
    1111        ADD WPLAN-MAR TO WA-CT-MAR.
    1112        ADD WPLAN-APR TO WA-CT-APR.
    1113        ADD WPLAN-MAY TO WA-CT-MAY.
    1114        ADD WPLAN-JUN TO WA-CT-JUN.
    1115        ADD WPLAN-JUL TO WA-CT-JUL.
    1116        ADD WPLAN-AUG TO WA-CT-AUG.
    1117        ADD WPLAN-SEP TO WA-CT-SEP.
    1118        ADD WPLAN-OCT TO WA-CT-OCT.
    1119        ADD WPLAN-NOV TO WA-CT-NOV.
    1120        ADD WPLAN-DEC TO WA-CT-DEC.    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE 1-20
    BUDGET.CBL    18-JUL-73  23:11

    1121    130-75-1.
    1122        ADD WPLAN-JAN WPLAN-FEB WPLAN-MAR WPLAN-APR WPLAN-MAY
    1123          WPLAN-JUN WPLAN-JUL WPLAN-AUG WPLAN-SEP WPLAN-OCT
    1124          WPLAN-NOV WPLAN-DEC GIVING WA-TOTAL-YTD.
    1125    130-75-2.
    1126        ADD WA-TOTAL-YTD TO WA-CT-TOTL.
    1127    130-75-X.     EXIT.
    1128    130-79-DUMMY.
    1129        DISPLAY WC-BLANK-LINE.
    1130    130-79-X.    EXIT.
    1131    130-80-RPT-HDG.
    1132        PERFORM 130-79-DUMMY THRU 130-79-X 3 TIMES.
    1133        MOVE WH1 TO W-RESPONSE-1.
    1134        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1135        MOVE WH2 TO W-RESPONSE-1.
    1136        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1137    130-80-X.    EXIT.
    1138    130-99-END.
    1139        DISPLAY ' '.
    1140        MOVE WC-ZERO-AMTS TO WA-TOTL-ACCUMS.
    1141        MOVE 'R' TO WS-ISAM.
    1142        GO TO 115-ACCEPT-COMMAND.
    1143    140-CANCEL-ROUTINE.
    1144        PERFORM 120-ADD-ROUTINE.
    1145        IF END-COMMAND GO TO 115-ACCEPT-COMMAND.
    1146        PERFORM 120-1.
    1147        IF CT-SA-ERR MOVE ' ' TO WS-CT-SA-ERR
    1148          GO TO 140-CANCEL-ROUTINE.
    1149        READ PLAN-I-FILE INVALID KEY GO TO 140-2.
    1150    140-1.
    1151        MOVE FPLANI-REC TO W-PLAN.
    1152        MOVE WC-ZERO-PLAN-MONTHS TO FPI-AMTS.
    1153        DELETE FPLANI-REC INVALID KEY GO TO 815-ERROR.
    1154        MOVE 'REC CANCELLED' TO W-RESPONSE-1.
    1155        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1156        PERFORM 140-5-NEG-AMT THRU 140-5-X.
    1157        PERFORM 140-4 THRU 140-4-X.
    1158        GO TO 140-6.
    1159    140-2.
    1160        MOVE 'ACCT NOT FOUND' TO W-RESPONSE-1.
    1161        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1162        GO TO 140-6.
    1163    140-4.
    1164        MOVE WPLAN-KEY TO WH-KEY-HOLD.
    1165        MOVE 000 TO WPLAN-DIST.
    1166        MOVE WPLAN-KEY TO WH-KEY.
    1167        PERFORM 815-WRITE-ISAM THRU 815-X.
    1168        MOVE 0 TO WPLAN-MKT-MGR.
    1169        MOVE WPLAN-KEY TO WH-KEY.
    1170        PERFORM 815-WRITE-ISAM THRU 815-X.
    1171        MOVE 0 TO WPLAN-VP.
    1172        MOVE WPLAN-KEY TO WH-KEY.
    1173        PERFORM 815-WRITE-ISAM THRU 815-X.
    1174        MOVE WH-KEY-HOLD TO WPLAN-KEY.
    1175    140-4-X.     EXIT.
    1176    140-5-NEG-AMT.    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE 1-21
    BUDGET.CBL    18-JUL-73  23:11

    1177        COMPUTE WPLAN-JAN = WPLAN-JAN * WC-MINUS-1.
    1178        COMPUTE WPLAN-FEB = WPLAN-FEB * WC-MINUS-1.
    1179        COMPUTE WPLAN-MAR = WPLAN-MAR * WC-MINUS-1.
    1180        COMPUTE WPLAN-APR = WPLAN-APR * WC-MINUS-1.
    1181        COMPUTE WPLAN-MAY = WPLAN-MAY * WC-MINUS-1.
    1182        COMPUTE WPLAN-JUN = WPLAN-JUN * WC-MINUS-1.
    1183        COMPUTE WPLAN-JUL = WPLAN-JUL * WC-MINUS-1.
    1184        COMPUTE WPLAN-AUG = WPLAN-AUG * WC-MINUS-1.
    1185        COMPUTE WPLAN-SEP = WPLAN-SEP * WC-MINUS-1.
    1186        COMPUTE WPLAN-OCT = WPLAN-OCT * WC-MINUS-1.
    1187        COMPUTE WPLAN-NOV = WPLAN-NOV * WC-MINUS-1.
    1188        COMPUTE WPLAN-DEC = WPLAN-DEC * WC-MINUS-1.
    1189    140-5-X.     EXIT.
    1190    140-6.
    1191        MOVE 'ANOTHER CANCEL? Y OR N' TO W-RESPONSE-1.
    1192        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1193        PERFORM 810-READ-COMMAND THRU 810-X.
    1194        IF YES-COMMAND GO TO 140-CANCEL-ROUTINE.
    1195        IF NO-COMMAND OR END-COMMAND GO TO 115-ACCEPT-COMMAND.
    1196        GO TO 140-6.
    1197    150-CHANGE-ROUTINE.
    1198        MOVE WM-30 TO W-RESPONSE-1.
    1199        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1200        PERFORM 810-READ-COMMAND THRU 810-X.
    1201        IF W-CMND1-6 = 'CODING' GO TO 150-2.
    1202        IF W-CMND1-6 = 'AMOUNT' GO TO 150-5-AMTS.
    1203        IF W-CMND1-6 = 'TOTREC'
    1204            MOVE WS-SW-ON TO WS-TOTAL-CORR
    1205            GO TO 150-5-AMTS.
    1206        IF END-COMMAND GO TO 115-ACCEPT-COMMAND.
    1207        GO TO 150-CHANGE-ROUTINE.
    1208    150-2.
    1209        MOVE 'OLD CODING?' TO W-RESPONSE-1.
    1210        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1211        PERFORM 120-ADD-ROUTINE.
    1212        IF END-COMMAND GO TO 115-ACCEPT-COMMAND.
    1213        PERFORM 120-1.
    1214        IF CT-SA-ERR MOVE ' ' TO WS-CT-SA-ERR
    1215          GO TO 150-2.
    1216        READ PLAN-I-FILE INVALID KEY
    1217            MOVE 'ACCT NOT FOUND' TO W-RESPONSE-1
    1218            PERFORM 800-WRITE-RESPONSE THRU 800-X
    1219            GO TO 150-2.
    1220        MOVE FPLANI-REC TO W-PLAN  WH-PLAN
    1221        PERFORM 140-5-NEG-AMT THRU 140-5-X.
    1222        PERFORM 815-WRITE-ISAM THRU 815-X.
    1223        PERFORM 140-4 THRU 140-4-X.
    1224        MOVE 'OLD CODING AMTS BACKED OUT' TO W-RESPONSE-1.
    1225        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1226    150-3.
    1227        MOVE 'NEW CODING?' TO W-RESPONSE-1.
    1228        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1229        PERFORM 120-ADD-ROUTINE.
    1230        IF END-COMMAND GO TO 115-ACCEPT-COMMAND.
    1231        PERFORM 120-1.
    1232        IF CT-SA-ERR MOVE ' ' TO WS-CT-SA-ERR    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE 1-22
    BUDGET.CBL    18-JUL-73  23:11

    1233          GO TO 150-3.
    1234        READ PLAN-I-FILE INVALID KEY GO TO 150-4.
    1235        MOVE WH-PLAN TO W-PLAN.
    1236        MOVE WH-KEY TO WPLAN-KEY.
    1237        MOVE SPACE TO W-DEL.
    1238        PERFORM 815-WRITE-ISAM THRU 815-X.
    1239        PERFORM 140-4 THRU 140-4-X.
    1240        GO TO 150-4-1.
    1241    150-4.
    1242        MOVE WPLAN-KEY TO WH-KEY.
    1243        MOVE WH-PLAN TO W-PLAN.
    1244        MOVE WH-KEY TO WPLAN-KEY.
    1245        MOVE SPACE TO W-DEL.
    1246        WRITE FPLANI-REC FROM W-PLAN INVALID KEY
    1247          MOVE '*DISK ERROR - MUST TRY AGAIN' TO W-RESPONSE-1
    1248          PERFORM 800-WRITE-RESPONSE THRU 800-X
    1249          GO TO 150-3.
    1250    150-4-1.
    1251        MOVE 'CHANGE HAS BEEN MADE' TO W-RESPONSE-1.
    1252        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1253        MOVE 'ANOTHER CHANGE?' TO W-RESPONSE-1.
    1254        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1255         PERFORM 810-READ-COMMAND THRU 810-X.
    1256        IF YES-COMMAND GO TO 150-CHANGE-ROUTINE.
    1257        IF NO-COMMAND OR END-COMMAND GO TO 115-ACCEPT-COMMAND.
    1258        GO TO 150-4-1.
    1259    150-5-AMTS.
    1260        PERFORM 120-ADD-ROUTINE.
    1261        IF END-COMMAND GO TO 115-ACCEPT-COMMAND.
    1262        PERFORM 120-1.
    1263        IF CT-SA-ERR MOVE ' ' TO WS-CT-SA-ERR
    1264          GO TO 150-5-AMTS.
    1265        READ PLAN-I-FILE INVALID KEY
    1266          MOVE 'ACCT NOT FOUND' TO W-RESPONSE-1
    1267          PERFORM 800-WRITE-RESPONSE THRU 800-X
    1268          GO TO 150-5-AMTS.
    1269        MOVE WC-ZERO-PLAN-MONTHS TO WPLAN-AMOUNTS.
    1270    150-5-AMT-MSG.
    1271        MOVE 'ENTER 1ST 3 POS OF MONTH TO BE CHANGED, ELSE ALL'
    1272          TO W-RESPONSE-1.
    1273        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1274    150-5.
    1275        PERFORM 810-READ-COMMAND THRU 810-X.
    1276        IF END-COMMAND GO TO 115-ACCEPT-COMMAND.
    1277        IF W-CMND1-3 = 'ALL' PERFORM 120-2-2 GO TO 150-4-1.
    1278        IF W-CMND1-3 = 'JAN' PERFORM 150-8 THRU 150-8-X
    1279          PERFORM 120-GET-AMT THRU 120-GET-AMT-X
    1280          MOVE W-AMOUNT TO WPLAN-JAN
    1281          GO TO 150-5-CK.
    1282        IF W-CMND1-3 = 'FEB' PERFORM 150-8 THRU 150-8-X
    1283          PERFORM 120-GET-AMT THRU 120-GET-AMT-X
    1284          MOVE W-AMOUNT TO WPLAN-FEB
    1285          GO TO 150-5-CK.
    1286        IF W-CMND1-3 = 'MAR' PERFORM 150-8 THRU 150-8-X
    1287          PERFORM 120-GET-AMT THRU 120-GET-AMT-X
    1288          MOVE W-AMOUNT TO WPLAN-MAR    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE 1-23
    BUDGET.CBL    18-JUL-73  23:11

    1289          GO TO 150-5-CK.
    1290        IF W-CMND1-3 = 'APR' PERFORM 150-8 THRU 150-8-X
    1291          PERFORM 120-GET-AMT THRU 120-GET-AMT-X
    1292          MOVE W-AMOUNT TO WPLAN-APR
    1293          GO TO 150-5-CK.
    1294        IF W-CMND1-3 = 'MAY' PERFORM 150-8 THRU 150-8-X
    1295          PERFORM 120-GET-AMT THRU 120-GET-AMT-X
    1296          MOVE W-AMOUNT TO WPLAN-MAY
    1297          GO TO 150-5-CK.
    1298        IF W-CMND1-3 = 'JUN' PERFORM 150-8 THRU 150-8-X
    1299          PERFORM 120-GET-AMT THRU 120-GET-AMT-X
    1300          MOVE W-AMOUNT TO WPLAN-JUN
    1301          GO TO 150-5-CK.
    1302        IF W-CMND1-3 = 'JUL' PERFORM 150-8 THRU 150-8-X
    1303          PERFORM 120-GET-AMT THRU 120-GET-AMT-X
    1304          MOVE W-AMOUNT TO WPLAN-JUL
    1305          GO TO 150-5-CK.
    1306        IF W-CMND1-3 = 'AUG' PERFORM 150-8 THRU 150-8-X
    1307          PERFORM 120-GET-AMT THRU 120-GET-AMT-X
    1308          MOVE W-AMOUNT TO WPLAN-AUG
    1309          GO TO 150-5-CK.
    1310        IF W-CMND1-3 = 'SEP' PERFORM 150-8 THRU 150-8-X
    1311          PERFORM 120-GET-AMT THRU 120-GET-AMT-X
    1312          MOVE W-AMOUNT TO WPLAN-SEP
    1313          GO TO 150-5-CK.
    1314        IF W-CMND1-3 = 'OCT' PERFORM 150-8 THRU 150-8-X
    1315          PERFORM 120-GET-AMT THRU 120-GET-AMT-X
    1316          MOVE W-AMOUNT TO WPLAN-OCT
    1317          GO TO 150-5-CK.
    1318        IF W-CMND1-3 = 'NOV' PERFORM 150-8 THRU 150-8-X
    1319          PERFORM 120-GET-AMT THRU 120-GET-AMT-X
    1320          MOVE W-AMOUNT TO WPLAN-NOV
    1321          GO TO 150-5-CK.
    1322        IF W-CMND1-3 = 'DEC' PERFORM 150-8 THRU 150-8-X
    1323          PERFORM 120-GET-AMT THRU 120-GET-AMT-X
    1324          MOVE W-AMOUNT TO WPLAN-DEC
    1325          GO TO 150-5-CK.
    1326        MOVE '*INVALID MONTH' TO W-RESPONSE-1.
    1327        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1328        GO TO 150-5-AMT-MSG.
    1329    150-5-CK.
    1330         MOVE 'ANOTHER MONTH TO CHANGE? Y OR N? ' TO W-RESPONSE-1.
    1331        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1332        PERFORM 810-READ-COMMAND THRU 810-X.
    1333        IF YES-COMMAND GO TO 150-5-AMT-MSG.
    1334        IF NO-COMMAND GO TO 150-6.
    1335        IF END-COMMAND GO TO 115-ACCEPT-COMMAND.
    1336        GO TO 150-5-CK.
    1337    150-6.
    1338        IF TOTAL-CORR MOVE SPACE TO WS-TOTAL-CORR
    1339        ELSE PERFORM 815-WRITE-ISAM THRU 815-X.
    1340        PERFORM 140-4 THRU 140-4-X.
    1341        GO TO 150-4-1.
    1342    150-8.
    1343        MOVE W-CMND1-3 TO WM-42-MO.
    1344        MOVE WM-42 TO W-RESPONSE-1.    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE 1-24
    BUDGET.CBL    18-JUL-73  23:11

    1345    150-8-X.     EXIT.
    1346    160-DISPLAY-ROUTINE.
    1347        PERFORM 120-ADD-ROUTINE.
    1348        IF END-COMMAND GO TO 115-ACCEPT-COMMAND.
    1349        PERFORM 120-1.
    1350        IF CT-SA-ERR MOVE ' ' TO WS-CT-SA-ERR
    1351          GO TO 160-DISPLAY-ROUTINE.
    1352    160-LEVEL-CK.
    1353        MOVE 'WHAT LEVEL?' TO W-RESPONSE-1.
    1354        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1355        PERFORM 810-READ-COMMAND THRU 810-X.
    1356        IF END-COMMAND GO TO 115-ACCEPT-COMMAND.
    1357        MOVE WPLAN-KEY TO WH-KEY-HOLD.
    1358        IF LOC-COMMAND GO TO 160-READ.
    1359        IF MKT-COMMAND MOVE 000 TO WPLAN-DIST
    1360          MOVE WPLAN-KEY TO WH-KEY GO TO 160-READ.
    1361        IF VP-COMMAND MOVE 000 TO WPLAN-DIST
    1362          MOVE 0 TO WPLAN-MKT-MGR
    1363          MOVE WPLAN-KEY TO WH-KEY GO TO 160-READ.
    1364        IF ALL-COMMAND MOVE 000 TO WPLAN-DIST
    1365          MOVE 0 TO WPLAN-MKT-MGR WPLAN-VP
    1366          MOVE WPLAN-KEY TO WH-KEY GO TO 160-READ.
    1367        GO TO 160-LEVEL-CK.
    1368    160-READ.
    1369        READ PLAN-I-FILE INTO W-PLAN INVALID KEY
    1370          MOVE 'ACCT NOT FOUND' TO W-RESPONSE-1
    1371          PERFORM 800-WRITE-RESPONSE THRU 800-X
    1372          GO TO 160-1.
    1373        IF WPLAN-AMOUNTS = WC-ZERO-PLAN-MONTHS
    1374            MOVE 'ACCT HAS NO BUDGET' TO W-RESPONSE-1
    1375            PERFORM 800-WRITE-RESPONSE THRU 800-X
    1376            GO TO 160-1.
    1377        PERFORM 130-3-FUNC-X THRU 130-4.
    1378        MOVE WC-ZERO-AMTS TO WA-CT-ACCUMS.
    1379    160-1.
    1380        MOVE WH-KEY-HOLD TO WPLAN-KEY.
    1381        MOVE 'ANOTHER DISPLAY? Y OR N? ' TO W-RESPONSE-1.
    1382        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1383        PERFORM 810-READ-COMMAND THRU 810-X.
    1384        IF YES-COMMAND GO TO 160-DISPLAY-ROUTINE.
    1385        IF NO-COMMAND OR END-COMMAND GO TO 115-ACCEPT-COMMAND.
    1386        GO TO 160-1.
    1387    160-X.     EXIT.
    1388    500-LOAD-TBLS.
    1389        OPEN INPUT TABLE-FILE.
    1390        MOVE HIGH-VALUES TO WT-TBL-CT, WT-TBL-CTSA, WT-TBL-TEMPMGR
    1391            WT-TBL-DIST, WT-TBL-GRUP, WT-TBL-FUNC,
    1392                       WT-TBL-SA, WT-TBL-REG, WT-TBL-MKTMGR.
    1393        SET ICT TO 1.   SET ISA TO 1.   SET IRG TO 1.   SET IMM TO 1.
    1394        SET ITM TO 1.   SET ICTSA TO 1.
    1395        SET IDIST TO 1.  SET IGRP TO 1.  SET IFUNC TO 1.
    1396    500-1-READ.
    1397        READ TABLE-FILE AT END CLOSE TABLE-FILE GO TO 500-OUT.
    1398        IF FTBL-ID = 'TJCLSTYP' AND FTBL-CODE = 'TE' GO TO 500-2.
    1399        IF FTBL-ID = 'TJSUBACT' AND FTBL-CODE = 'TE' GO TO 500-3.
    1400        IF FTBL-ID = 'TJREGION' AND FTBL-CODE = 'TE' GO TO 500-4.    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE 1-25
    BUDGET.CBL    18-JUL-73  23:11

    1401        IF FTBL-ID = 'TJMKTMGR' AND FTBL-CODE = 'TE' GO TO 500-5.
    1402        IF FTBL-ID = 'TJTMPMGR' AND FTBL-CODE = 'TE' GO TO 500-6.
    1403        IF FTBL-ID = 'TJCTSUBA' AND FTBL-CODE = 'TE' GO TO 500-7.
    1404        IF FTBL-ID = 'TJDIRICT' AND FTBL-CODE = 'TE' GO TO 500-8.
    1405        IF FTBL-ID = 'TJFUNCTN' AND FTBL-CODE = 'TE' GO TO 500-9.
    1406        IF FTBL-ID = 'TJCLTYGP' AND FTBL-CODE = 'TE' GO TO 500-10.
    1407        GO TO 500-1-READ.
    1408    500-2.  IF ICT > 110 DISPLAY '*CT TBL FULL*' GO TO 500-1-READ.
    1409        MOVE FTBL-ARG-2 TO WT-CT (ICT).
    1410        MOVE FTBL-RESULT TO WT-CT-DES (ICT).
    1411        SET ICT UP BY 1.
    1412        GO TO 500-1-READ.
    1413    500-3.  IF ISA > 130 DISPLAY '*SA TBL FULL*' GO TO 500-1-READ.
    1414        MOVE FTBL-ARG-4 TO WT-SA (ISA).
    1415        MOVE FTBL-RESULT TO WT-SA-DES (ISA).
    1416        SET ISA UP BY 1.
    1417        GO TO 500-1-READ.
    1418    500-4.
    1419        IF IRG > 40 DISPLAY '*RGN TBL FULL*' GO TO 500-1-READ.
    1420        MOVE FTBL-ARG-3 TO WT-REG (IRG).
    1421        MOVE FTBL-RESULT TO WT-REG-DES (IRG).
    1422        SET IRG UP BY 1.
    1423        GO TO 500-1-READ.
    1424    500-5.
    1425        IF IMM > 12 DISPLAY '*MKTMGR TBL FULL*' GO TO 500-1-READ.
    1426        MOVE FTBL-ARG-1 TO WT-MM (IMM).
    1427        MOVE FTBL-RESULT TO WT-MM-DES (IMM).
    1428        SET IMM UP BY 1.
    1429        GO TO 500-1-READ.
    1430    500-6.
    1431        IF ITM > 60 DISPLAY '*TEMPMGR TBL FULL*' GO TO 500-1-READ.
    1432        MOVE FTBL-ARG-3 TO WT-TM (ITM).
    1433        MOVE FTBL-RESULT-1 TO WT-TM-MM (ITM).
    1434        SET ITM UP BY 1.
    1435        GO TO 500-1-READ.
    1436    500-7.
    1437        IF ICTSA > 25 DISPLAY '*CT/SA TBL FULL*' GO TO 500-1-READ.
    1438        MOVE FTBL-ARG-5 TO WT-CTSA (ICTSA).
    1439        MOVE FTBL-RESULT TO WT-CTSA-DES (ICTSA).
    1440        SET ICTSA UP BY 1.
    1441        GO TO 500-1-READ.
    1442    500-8.
    1443        IF IDIST > 60 DISPLAY '*DISTRICT TBL FULL*'
    1444                GO TO 500-1-READ.
    1445        MOVE FTBL-ARG-3 TO WT-DIST (IDIST).
    1446        MOVE FTBL-RESULT TO WT-DIST-DES (IDIST).
    1447        SET IDIST UP BY 1.
    1448        GO TO 500-1-READ.
    1449    500-9.
    1450        IF IFUNC > 30 DISPLAY '*FUNC TBL FULL*'
    1451                GO TO 500-1-READ.
    1452        MOVE FTBL-ARG-2 TO WT-FUNC (IFUNC).
    1453        MOVE FTBL-RESULT TO WT-FUNC-DES (IFUNC).
    1454        SET IFUNC UP BY 1.
    1455        GO TO 500-1-READ.
    1456    500-10.    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE 1-26
    BUDGET.CBL    18-JUL-73  23:11

    1457        IF IGRP > 12 DISPLAY '*GRP TBL FULL*'
    1458                GO TO 500-1-READ.
    1459        MOVE FTBL-ARG-1 TO WT-GRP (IGRP).
    1460        MOVE FTBL-RESULT TO WT-GRP-DES (IGRP).
    1461        SET IGRP UP BY 1.
    1462        GO TO 500-1-READ.
    1463    500-OUT.
    1464        SET ICT DOWN BY 1. SET WA-CT TO ICT.
    1465        SET ISA DOWN BY 1. SET WA-SA TO ISA.
    1466        SET IRG DOWN BY 1. SET WA-REG TO IRG.
    1467        SET IMM DOWN BY 1. SET WA-MM TO IMM.
    1468        SET ITM DOWN BY 1. SET WA-TMPMGR TO ITM.
    1469        SET IDIST DOWN BY 1.  SET WA-DIST TO IDIST.
    1470        SET IGRP DOWN BY 1.  SET WA-GRP TO IGRP.
    1471        SET IFUNC DOWN BY 1.  SET WA-FUNC TO IFUNC.
    1472        SET ICTSA DOWN BY 1. SET WA-CTSA TO ICTSA.
    1473    500-X.       EXIT.
    1474    800-WRITE-RESPONSE.
    1475        DISPLAY W-RESPONSE-1.
    1476        MOVE WC-BLANK-LINE TO W-RESPONSE-1.
    1477    800-X.       EXIT.
    1478    801-WRITE-RESPONSE.
    1479        DISPLAY W-RESPONSE-1 WITH NO ADVANCING.
    1480        MOVE WC-BLANK-LINE TO W-RESPONSE-1.
    1481    801-X.     EXIT.
    1482    810-READ-COMMAND.
    1483        ACCEPT W-COMMAND
    1484        IF STOP-COMMAND GO TO 999-END.
    1485    810-X.       EXIT.
    1486    815-WRITE-ISAM.
    1487        READ PLAN-I-FILE INVALID KEY
    1488            GO TO 815-ADD.
    1489        IF FPI-DEL-IND = HIGH-VALUE
    1490            MOVE WC-ZERO-PLAN-MONTHS TO FPI-AMTS.
    1491        MOVE SPACE TO FPI-DEL-IND.
    1492        PERFORM 818-ADD-ACCUMS THRU 818-X.
    1493        REWRITE FPLANI-REC INVALID KEY GO TO 815-ERROR.
    1494        GO TO 815-X.
    1495    815-ADD.
    1496        MOVE WPLAN-KEY TO WH-KEY FPI-KEY.
    1497        MOVE SPACE TO FPI-DEL-IND.
    1498        MOVE '3001' TO FPI-LI.
    1499        MOVE SPACE TO FPI-TRANSP.
    1500        MOVE 030 TO FPI-DSC.
    1501        MOVE 99 TO FPI-AREA.
    1502        MOVE 999 TO FPI-COMPLEX.
    1503        MOVE WC-ZERO-PLAN-MONTHS TO FPI-AMTS.
    1504        PERFORM 818-ADD-ACCUMS THRU 818-X.
    1505        WRITE FPLANI-REC INVALID KEY GO TO 815-ERROR.
    1506        GO TO 815-X.
    1507    815-ERROR.  DISPLAY 'INVALID KEY --- RECORD NOT WRITTEN'.
    1508    815-X.     EXIT.
    1509    818-ADD-ACCUMS.
    1510        ADD WPLAN-JAN TO FPI-JAN.
    1511        ADD WPLAN-FEB TO FPI-FEB.
    1512        ADD WPLAN-MAR TO FPI-MAR.    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE 1-27
    BUDGET.CBL    18-JUL-73  23:11

    1513        ADD WPLAN-APR TO FPI-APR.
    1514        ADD WPLAN-MAY TO FPI-MAY.
    1515        ADD WPLAN-JUN TO FPI-JUN.
    1516        ADD WPLAN-JUL TO FPI-JUL.
    1517        ADD WPLAN-AUG TO FPI-AUG.
    1518        ADD WPLAN-SEP TO FPI-SEP.
    1519        ADD WPLAN-OCT TO FPI-OCT.
    1520        ADD WPLAN-NOV TO FPI-NOV.
    1521        ADD WPLAN-DEC TO FPI-DEC.
    1522    818-X.     EXIT.
    1523    820-CALC-FUNC.
    1524        IF W-CLASSTYP = '23' OR '24' MOVE '40' TO WPLAN-FUNCTION
    1525          GO TO 820-X.
    1526        IF W-SUB-ACCT < '7000'
    1527                MOVE '30' TO WPLAN-FUNCTION
    1528                GO TO 820-X.
    1529        IF W-SUB-ACCT < '8000'
    1530                MOVE '10' TO WPLAN-FUNCTION
    1531                GO TO 820-X.
    1532        IF W-SUB-ACCT < '9000'
    1533                MOVE '01' TO WPLAN-FUNCTION     ELSE
    1534                MOVE '02' TO WPLAN-FUNCTION.
    1535    820-X.       EXIT.
    1536    825-CALC-GROUP.
    1537        IF W-CLASSTYP = '01' OR '06' OR '07' OR '08' OR '09'
    1538                MOVE '1' TO WPLAN-GROUP ELSE MOVE '2' TO WPLAN-GROUP.
    1539    825-X.   EXIT.
    1540    900-VALIDATE-LOC.
    1541        MOVE W-CMND1-3 TO WPLAN-DIST.
    1542        MOVE SPACE TO WS-LOC-ERR.
    1543        SET ITM TO 1.
    1544        SEARCH WT-TMPMGR AT END GO TO 900-1-ATEND
    1545                WHEN W-CMND1-3 EQUAL WT-TM (ITM)
    1546            DISPLAY 'GOOD LOC CODE'
    1547                MOVE WT-TM-MM (ITM) TO WPLAN-MKT-MGR
    1548                GO TO 900-1.
    1549    900-1-ATEND.     MOVE WS-SW-ON TO WS-LOC-ERR.
    1550        GO TO 900-X.
    1551    900-1.
    1552        IF VP-EAST-MM MOVE 1 TO WPLAN-VP GO TO 900-X.
    1553        IF VP-WEST-MM MOVE 2 TO WPLAN-VP GO TO 900-X.
    1554        DISPLAY 'BAD MKT-MGR'.
    1555        MOVE WS-SW-ON TO WS-LOC-ERR.
    1556    900-X.     EXIT.
    1557    905-VALIDATE-CT-SA.
    1558        SET ICT TO 1.
    1559        SEARCH WT-CLSTYP AT END GO TO 905-1-ATEND
    1560          WHEN WPLAN-CLASSTYP EQUAL WT-CT (ICT)
    1561          GO TO 905-1.
    1562    905-1-ATEND.     MOVE WS-SW-ON TO WS-CT-SA-ERR.
    1563        MOVE '*INVALID CT' TO W-RESPONSE-1.
    1564        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1565    905-1.
    1566        SET ISA TO 1.
    1567        SEARCH WT-SUBACCT AT END GO TO 905-2-ATEND
    1568          WHEN WPLAN-SUB-ACCT EQUAL WT-SA (ISA)    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE 1-28
    BUDGET.CBL    18-JUL-73  23:11

    1569          GO TO 905-X.
    1570    905-2-ATEND.     MOVE WS-SW-ON TO WS-CT-SA-ERR.
    1571        MOVE '*INVALID SA' TO W-RESPONSE-1.
    1572        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1573    905-X.     EXIT.
    1574    950-INIT.
    1575        MOVE LOW-VALUES TO WH-KEY.
    1576        MOVE 'S' TO WS-ISAM.
    1577    950-1.
    1578        READ PLAN-I-FILE INTO W-PLAN INVALID KEY GO TO 950-END.
    1579        MOVE WC-ZERO-PLAN-MONTHS TO WPLAN-AMOUNTS.
    1580        REWRITE FPLANI-REC FROM W-PLAN INVALID KEY
    1581            DISPLAY '*INVALID KEY DURING INIT*'
    1582            GO TO 950-END.
    1583        GO TO 950-1.
    1584    950-END.
    1585        DISPLAY 'END OF INIT PHASE'.  GO TO 130-99-END.
    1586    962-OPEN-PLANI-IO.
    1587        OPEN I-O PLAN-I-FILE.
    1588    970-CLOSE-PLANI-FILE.
    1589        CLOSE PLAN-I-FILE.
    1590    999-END.
    1591        MOVE '**END OF BUDGET SESSION - GOODBYE FOR NOW**'
    1592            TO W-RESPONSE-1.
    1593        PERFORM 800-WRITE-RESPONSE THRU 800-X.
    1594        PERFORM 970-CLOSE-PLANI-FILE.
    1595        STOP RUN.    P R O G R A M   P 0 3 1 6 0 		COBOL (005002,112001)	18-JUL-73  23:11		PAGE W-1
    BUDGET.CBL    18-JUL-73  23:11

WARNINGS:

    0757  MOST SIGNIFICANT DIGITS TRUNCATED ON W-AMOUNT
    1177  MOST SIGNIFICANT DIGITS TRUNCATED ON WPLAN-JAN
    1178  MOST SIGNIFICANT DIGITS TRUNCATED ON WPLAN-FEB
    1179  MOST SIGNIFICANT DIGITS TRUNCATED ON WPLAN-MAR
    1180  MOST SIGNIFICANT DIGITS TRUNCATED ON WPLAN-APR
    1181  MOST SIGNIFICANT DIGITS TRUNCATED ON WPLAN-MAY
    1182  MOST SIGNIFICANT DIGITS TRUNCATED ON WPLAN-JUN
    1183  MOST SIGNIFICANT DIGITS TRUNCATED ON WPLAN-JUL
    1184  MOST SIGNIFICANT DIGITS TRUNCATED ON WPLAN-AUG
    1185  MOST SIGNIFICANT DIGITS TRUNCATED ON WPLAN-SEP
    1186  MOST SIGNIFICANT DIGITS TRUNCATED ON WPLAN-OCT
    1187  MOST SIGNIFICANT DIGITS TRUNCATED ON WPLAN-NOV
    1188  MOST SIGNIFICANT DIGITS TRUNCATED ON WPLAN-DEC
    1220  RIGHT-MOST TRUNCATION ON WH-PLAN


NO FATAL ERRORS, 14 WARNINGS
    $Hn