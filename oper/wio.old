MODULE WIO(DOLLAR,ENTRIES=($WSTART,$WSTOP,$WIN), FSAVE,TIMING,
                        TIMER=EXTERNAL(SIX12) )=
BEGIN

REQUIRE KDEFS.BLI[7,107355];
REQUIRE CDEFS.BLI[7,107355];
REQUIRE WDEFS.BLI[7,107355];

UNDECLARE $WSTART;
UNDECLARE $WSTOP;
UNDECLARE $WIN;

MAP
     KFCB$ WFILE$, %FILECB POINTER FOR CURRENT SOURCE FILE%
   CLINE$   WBUF$;  %POINTER TO CURRENT $WIN BUFFER%

GLOBAL ROUTINE $WIN=
BEGIN
  IF .WFILE$[K$EOFILE]
    THEN RETURN CV$EOF;
  $KREAD(WFILE$);
  WBUF$[C$TEXT]
END;


GLOBAL ROUTINE $WSTART(FID)=
BEGIN
MAP KFIDT$ FID;

WFILE$_$KCRFCB(.FID[K$NAME],.FID[K$FWEXT],.FID[K$USER],KV$INPUT,$KSQLN);
WFILE$[K$DADR]_WBUF$_$CGTZM(CV$DWILCB);
WBUF$[C$BPTR]_WBUF$[C$TEXT]<36,7>;
WBUF$[C$LCBSIZE]_CV$DCILCB
END;


GLOBAL ROUTINE $WSTOP=
BEGIN
$KFREEFCB(WFILE$);
$CFREEM(.WBUF$)
END;


END
ELUDOM
