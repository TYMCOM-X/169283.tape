! RPS ERROR PROCESSOR

FIND %OUTNUM, GTYPE, %STROUT
GLOBAL %TUFHUB

! TUFHUB [THE USER FIRKED HIMSELF UP BAD]
! ARG:1 RETURN VECTOR (CALLED AS LITERALLY:  TUFHUB(RETURN))
! CALL HERE WHEN GETOKEN WAS CALLED AND THE USER BLEW IT.
! ALSO, DOES A 'RETURN FALSE' AS A RETURN BRANCH.....
! BE SURE IT IS CALLED FROM A SUBROUTINE WHICH EXPECTS
! TO RETURN FALSE
%TUFHUB(ARG.1)

LOCAL TMP

        TERMCH _ CAR.RET ! TURN OFF COMPLAINER

        DO GTYPE OF MIN.EXP:MAX.EXP

-3:     ! QUESTION MARK COMMAND, THAT'S OKAY ! NULL
-2:     !FIRK! MSG('BAD EXPRESSION GIVEN$')
-1:     !TRUE, HARD TO BELIEVE! NULL
0:      !FALSE, ALSO BAD! NULL
3:      !RESWRD, BAD! MSG('COMMAND WORD NOT LEGAL HERE$')
4:      MSG('AMBIGUOUS COMMAND WORD: ')
        MSG(@TOKBUF(0)); MSG('$CHOICES ARE:')
        TMP _ 0; WHILE MTOKS(INC TMP)#-1 THEN DO
                STROUT(MTOKS(TMP))
                IF MTOKS(TMP+1) #-1 THEN PUT($,)
                END
        PUT(CAR.RET)
5:      MSG('COMMAND WORD NOT RECOGNIZED: ')
        MSG(@TOKBUF(0)); PUT(CAR.RET)
6:      MSG('NUMBER NOT LEGAL HERE$')
7:      MSG('STRING NOT LEGAL HERE$')
8:-4:-5:!DELIMT, FIGURE IT OUT ! NULL
        EIF $0<=TERMCH<=$9 THEN MSG('NUMERIC ITEM NOT LEGAL HERE$')
        ORIF $A<=TERMCH<=$Z OR $A+OCT 40<=TERMCH<=$Z+OCT 40 THEN&
        MSG('COMMAND WORD NOT LEGAL HERE$')
        ELSE DO
        MSG('CHARACTER OR DELIMETER NOT RECOGNIZED: "')
        PUT(TOKEN); MSG('" (')
        NUMOUT(TOKEN,10); MSG(')$')
        END

        END

        RETURN_ARG.1; RETURN FALSE
END TUFHUB
