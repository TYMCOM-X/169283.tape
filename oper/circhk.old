      SUBROUTINE CIRCHK
      COMMON/INDATA/NUMEL,NUNODS,NUMNOD,NOSTOP,JELCNT(20),LOCATE(21), 
     1   ICURNT(21),JUNODE(401),NAME(200),LOCAL(200),MNAME(200)
      COMMON/MISCEL/NOGO,IGOOF,NOPRNT,IACCT,JOBNAM(16),IDI,IDO
      COMMON/KNSTNT/TWOPI,XLOG2,XLOG10,RAD,BOLTZ,CHARGE,VT
      COMMON/OUTDAT/ROUT(101,10),FREQ(101),IONUM,IONAM(10),IOPND(10), 
     1   IONND(10),IOFLG(10),NUMOR(3),IOVAR(10,2),IACVAR(5)
      COMMON/OCNTRL/IPRCOM(10,2),IPLCOM(10,2),PLTLIM(10,2,2), 
     1   IACPRT(5,4),IACPLT(5,4),ACPLIM(5,4,2)
      COMMON/DC/ICVFLG,ITCELM,TCSTAR,TCSTOP,TCINCR,KSSOP,KINEL,KOVAR
      COMMON/TRAN/JTRFLG,TSTEP,TSTOP,TSTART,NOTINT,STEPS(5),ENDPTS(5),
     1   KFROUT,FORFRE,KFPTS
      COMMON/AC/JACFLG,FSTART,FSTOP,IDFREQ,FINCR,INOISE,NOSPRT,
     1   NOSOUT,NOSIN 
      COMMON/TEMPER/TEMPS(6),NUMTEM,ITEMNO
      COMMON/SENVAR/NSENS,KSNOUT(10)
      COMMON/DESIGN/JDSFLG,NSPEC,NDES,ERROR,NOELEM(30),NELTPE(30),
     1   NOUNUM(10),DESVAL(10),WEIGHT(10) 
C 
C 
      DATA IBLNK,ILLIN,ILDEC,ILOCT /' ','LINEA','DEC','OCT'/
C 
C  CHECK OUTPUT REQUESTS
C 
      IF (IONUM.EQ.0) GO TO 400
      IF (NOPRNT.GT.0) GO TO 25
      WRITE (IDO,21)
21      FORMAT(/1X,'*****OUTPUT REQUESTS'/)
        WRITE (IDO,22)
22      FORMAT(1X,'NAME  ELEMENT     +   -')
   25 IKNT=0
   30 IKNT=IKNT+1 
      IF (IKNT.GT.IONUM) GO TO 400
      IF (IOFLG(IKNT).EQ.0) GO TO 30
      IF (IOFLG(IKNT).EQ.3) GO TO 30
      IPNOD=IOPND(IKNT)
      IF (IOFLG(IKNT).EQ.2) GO TO 100 
C 
C  VOLTAGE OUTPUT 
C 
      INNOD=IONND(IKNT)
      IF (NOPRNT.GT.0) GO TO 55
      WRITE (IDO,51) IONAM(IKNT),IPNOD,INNOD
51      FORMAT(1X,A5,10X,2(1X,I3))
   55 IF (IPNOD.EQ.INNOD) GO TO 200
      JKNT=0
   60 JKNT=JKNT+1 
      IF (JKNT.GT.NUNODS) GO TO 200
      IF (IPNOD.NE.JUNODE(JKNT)) GO TO 60 
      IOPND(IKNT)=JKNT
      JKNT=0
   70 JKNT=JKNT+1 
      IF (JKNT.GT.NUNODS) GO TO 200
      IF (INNOD.NE.JUNODE(JKNT)) GO TO 70 
      IONND(IKNT)=JKNT
      GO TO 30
C 
C  CURRENT OUTPUT 
C 
  100 IF (NOPRNT.GT.0) GO TO 105
      WRITE (IDO,101) IONAM(IKNT),IPNOD 
101     FORMAT(1X,A5,2X,A5)
  105 CALL IDEN (IPNOD,ID,ITEMP)
      IF (ID.NE.6) GO TO 200
      IOPND(IKNT)=ITEMP
      IONND(IKNT)=1
      GO TO 30
C 
C  OUTPUT VARIABLE ERROR
C 
  200 IOFLG(IKNT)=0
      IOPND(IKNT)=1
      IONND(IKNT)=1
      WRITE (5,201) IONAM(IKNT)
  201 FORMAT (/1X,'  OUTPUT VARIABLE ',A5,' HAS NOT BEEN '
     1   'DEFINED CORRECTLY')
      GO TO 30
C 
C  CHECK DC ANALYSIS REQUESTS 
C 
  400 IF (ICVFLG.EQ.0) GO TO 500
      IF (NOPRNT.GT.0) GO TO 425
      WRITE (IDO,421)
421     FORMAT(/1X,'*****TRANSFER CURVES'/)
        WRITE (IDO,422)
422     FORMAT(1X'VARIABLE SOURCE  FIRST VALUE  LAST VALUE',
     1  '  INCREMENT'/)
        WRITE (IDO,423)ITCELM,TCSTAR,TCSTOP,TCINCR
423     FORMAT(6X,A5,7X,1PE9.2,4X,E9.2,3X,E9.2)
C 
C  TRANSFER CURVES
C 
  425 CALL IDEN (ITCELM,ID,ITEMP) 
      IF (ID.EQ.4) GO TO 430
      IF (ID.EQ.6) GO TO 430
      GO TO 480
  430 ITCELM=ITEMP
      IF (TCINCR.EQ.0.0) GO TO 445
      TEMP=(TCSTOP-TCSTAR)/TCINCR 
      IF (TEMP.GT.0.0) GO TO 440
      TCINCR=-TCINCR
      TEMP=-TEMP
  440 ICVFLG=IFIX(TEMP+0.5)+1 
      IF (ICVFLG.LT.2) ICVFLG=2
      IF (ICVFLG.LT.102) GO TO 450
  445 ICVFLG=101
      TCINCR=(TCSTOP-TCSTAR)/100.0
      WRITE (5,446) TCINCR
  446 FORMAT (/1X,'***  WARNING  ***  SOURCE INCREMENT INCREASED TO ',
     1   1PE8.2)
  450 IF (NUMOR(1).GT.0) GO TO 500
      IF (JDSFLG.GT.0) GO TO 500
      ICVFLG=0
      WRITE (5,471)
  471 FORMAT (/1X,'  TRANSFER CURVE REQUESTED BUT NO DC '
     1   'OUTPUTS HAVE BEEN DEFINED')
      GO TO 500
  480 ICVFLG=0
      WRITE (5,481)
  481 FORMAT (/1X,'  TRANSFER CURVE VARIABLE SOURCE HAS NOT '
     1   'BEEN DEFINED')
C 
C  SMALL SIGNAL TRANSFER FUNCTION 
C 
  500 IF (KINEL.EQ.0) GO TO 800
      IF (NOPRNT.GT.0) GO TO 505
      WRITE (IDO,501)
501     FORMAT(/1X,'*****TRANSFER FUNCTION'/)
        WRITE (IDO,502)KOVAR,KINEL
502     FORMAT(1X,'OUTPUT  INPUT'/1X,A5,4X,A5)
  505 CALL IDEN(KINEL,ID,ITEMP)
      IF (ID.EQ.4) GO TO 510
      IF (ID.EQ.6) GO TO 510
      GO TO 550
  510 KINEL=ITEMP 
      IKNT=0
  520 IKNT=IKNT+1 
      IF (IKNT.GT.IONUM) GO TO 550
      IF (KOVAR.NE.IONAM(IKNT)) GO TO 520 
      IF (IOFLG(IKNT).EQ.0) GO TO 550 
      KOVAR=IKNT
      GO TO 800
  550 KINEL=0 
      WRITE (5,551)
  551 FORMAT (/1X,'  TRANSFER FUNCTION INPUT SOURCE AND/OR '
     1   'OUTPUT VARIABLE HAVE NOT BEEN',/3X,
     2   'DEFINED CORRECTLY')
C  CHECK AC ANALYSIS REQUESTS 
C 
  800 IF (JACFLG.EQ.0) GO TO 1200 
      JACFLG=FINCR
      IF (NOPRNT.GT.0) GO TO 815
      NAM=IBLNK
      IF (IDFREQ.EQ.1) NAM=ILLIN
      IF (IDFREQ.EQ.2) NAM=ILDEC
      IF (IDFREQ.EQ.3) NAM=ILOCT
      WRITE (IDO,811) FSTART,FSTOP,NAM,JACFLG
  811 FORMAT (/1X,'*****FREQUENCY VARIATION'//1X,'FIRST FREQ',5X,
     1   'LAST FREQ',5X,'VARIATION',5X,'POINTS'/1X,1PE9.2,6X,E9.2,8X,
     2   A5,5X,I5)
  815 IF (IDFREQ.EQ.0) GO TO 860
      IF (FSTART.LE.0.0) GO TO 860
      IF (FSTOP.LE.0.0) GO TO 860 
      IF (FSTART.GT.FSTOP) GO TO 860
      IF (IDFREQ.GT.1) GO TO 840
      IF (JACFLG.LT.2) JACFLG=2
      IF (JACFLG.LT.102) GO TO 830
      JACFLG=101
      WRITE (5,821) JACFLG
  821 FORMAT (/1X,'***  WARNING  ***  NUMBER OF AC FREQUENCY POINTS '
     1   'REDUCED TO ',I5)
  830 FINCR=(FSTOP-FSTART)/FLOAT(JACFLG-1)
      GO TO 900
  840 FACTOR=XLOG10
      IF (IDFREQ.EQ.3) FACTOR=XLOG2
      TEMP=ALOG(FSTOP/FSTART)/FACTOR
      JACFLG=IFIX(TEMP*JACFLG+0.5)+1
      IF (JACFLG.LT.2) JACFLG=2
      IF (JACFLG.LT.102) GO TO 850
      JACFLG=101
      NUMPTS=101/IFIX(TEMP+0.5)
      WRITE (5,821) NUMPTS
  850 FINCR=EXP(FACTOR*TEMP/FLOAT(JACFLG-1))
      GO TO 900
  860 JACFLG=0
      WRITE (5,861)
  861 FORMAT (/1X,'  AC FREQUENCY VARIATION HAS NOT BEEN ' 
     1   'DEFINED CORRECTLY')
C 
C  NOISE ANALYSIS 
C 
  900 IF (NOSOUT.NE.0) GO TO 910
      INOISE=0
      GO TO 1000
  910 IF (NOPRNT.GT.0) GO TO 915
      WRITE (IDO,911) NOSOUT,NOSIN,NOSPRT
  911 FORMAT (/1X,'*****NOISE ANALYSIS'//1X,'OUTPUT',5X,'INPUT', 
     1   5X,'SUMMARY INTERVAL'/1X,A5,6X,A5,13X,I5)
  915 CALL IDEN (NOSIN,ID,ITEMP)
      IF (ID.EQ.4) GO TO 920
      IF (ID.EQ.6) GO TO 920
      GO TO 970
  920 NOSIN=ITEMP 
      IKNT=0
  930 IKNT=IKNT+1 
      IF (IKNT.GT.IONUM) GO TO 970
      IF (NOSOUT.NE.IONAM(IKNT)) GO TO 930
      IF (IOFLG(IKNT).NE.1) GO TO 970 
      NOSOUT=IKNT 
      IF (NOSPRT.GT.JACFLG) NOSPRT=JACFLG 
      IKNT=NOSPRT 
      IF (INOISE.EQ.0) GO TO 965
      IKNT=IKNT+IACPRT(INOISE,1)+IACPRT(INOISE,2)+IACPLT(INOISE,1)
     1   +IACPLT(INOISE,2)
  965 IF (IKNT.GT.0) GO TO 1000
  970 NOSOUT=0
      NOSPRT=0
      INOISE=0
      WRITE (5,971)
  971 FORMAT (/1X,'  NOISE ANALYSIS INPUT SOURCE AND/OR '
     1   'OUTPUT VARIABLE HAVE NOT BEEN',/3X,
     2   'DEFINED CORRECTLY')
 1000 IF ((NUMOR(3)+NOSPRT).GT.0) GO TO 1200
      JACFLG=0
      WRITE (5,1001)
 1001 FORMAT (/1X,'  SMALL SIGNAL ANALYSIS REQUESTED BUT NO '
     1   'AC OUTPUTS HAVE BEEN',/3X,
     2   'DEFINED')
C 
C  CHECK TRANSIENT ANALYSIS REQUESTS
C 
 1200 IF (JTRFLG.EQ.0) GO TO 1400 
      IF (NOPRNT.GT.0) GO TO 1240 
      WRITE (IDO,1211)
1211    FORMAT(/1X,'*****TRANSIENT TIME VARATION'/)
        WRITE (IDO,1212)
1212    FORMAT(1X,'INCREMENT  LAST TIME  START TIME')
        WRITE (IDO,1213)TSTEP,TSTOP,TSTART
1213    FORMAT(1X,3(1PE9.2,2X)/)
        IF(NOTINT.EQ.0)GO TO 1240
        WRITE (IDO,1214)
1214    FORMAT(1X,'INTERVALS  DELTA    END POINT')
        DO 1215 I=1,NOTINT
1215    WRITE(IDO,1216)I,STEPS(I),ENDPTS(I)
1216    FORMAT(1X,I5,4X,2(1PE9.2,1X))
C 
C  FOURIER ANALYSIS
C 
 1240 IF (KFROUT.EQ.0) GO TO 1350 
      IF (NOPRNT.GT.0) GO TO 1245 
      WRITE (IDO,1241)
1241    FORMAT(/1X,'*****FOURIER ANALYSIS'/)
        WRITE (IDO,1242)
1242    FORMAT(1X,'OUTPUT  FUNDAMENTAL')
        WRITE (IDO,1243)KFROUT,FORFRE
1243    FORMAT(1X,A5,5X,1PE9.2)
 1245 IKNT=0
 1250 IKNT=IKNT+1 
      IF (IKNT.GT.IONUM) GO TO 1310
      IF (KFROUT.NE.IONAM(IKNT)) GO TO 1250
      IF (IOFLG(IKNT).EQ.0) GO TO 1310
      JKNT=0
 1260 JKNT=JKNT+1 
      IF (JKNT.GT.NUMOR(2)) GO TO 1270
      IF (IOVAR(JKNT,2).NE.IKNT) GO TO 1260
      GO TO 1280
 1270 NUMOR(2)=JKNT
      IOVAR(JKNT,2)=IKNT
 1280 KFROUT=JKNT 
      IF (FORFRE.EQ.0.0) GO TO 1307
        IF(JTRFLG.LT.10)GO TO 1300
      KFPTS=IFIX(1.0/(FORFRE*TSTEP)+0.5)
      IF (KFPTS.LT.10) GO TO 1302
      IF (KFPTS.GE.JTRFLG) GO TO 1305
      GO TO 1350
 1300 KFROUT=0
      WRITE (5,1301)
1301    FORMAT(/3X,'FOURIER ANALYSIS IMPOSSIBLE FOR < 10 OUTPUT',
     +  ' INTERVALS')
        GO TO 1350
1302    KFROUT=0
        AOUT=.1/TSTEP
        WRITE (5,1303)
        WRITE (5,1304)AOUT
1303    FORMAT(/3X,'FOURIER FREQUENCY MUST BE',$)
1304    FORMAT(1H+,' <= ',1PE9.2,' HZ',/3X,'=  1/(10*OUTPUT INTERVAL)')
        GO TO 1350
1305    KFROUT=0
        AOUT=1/(TSTEP*JTRFLG)
        WRITE (5,1303)
        WRITE (5,1306)AOUT
1306    FORMAT(1H+,' > ',1PE9.2,' HZ',/3X,'= 1/(OUTPUT INTERVAL*',
     +   '(NUMBER OF OUTPUT INTERVALS))')
        GO TO 1350
1307    KFROUT=0
        WRITE (5,1308)
1308    FORMAT(/3X,'FOURIER FREQUENCY MUST BE > 0')
        GO TO 1350
 1310 KFROUT=0
      WRITE (5,1311)
 1311 FORMAT (/1X,'  FOURIER ANALYSIS OUTPUT HAS NOT BEEN '
     1   'DEFINED CORRECTLY')
 1350 IF (NUMOR(2).GT.0) GO TO 1400
      JTRFLG=0
      WRITE (5,1351)
 1351 FORMAT (/1X,'  TRANSIENT ANALYSIS REQUESTED BUT NO ' 
     1   'TRANSIENT OUTPUTS HAVE BEEN',/3X,
     2   'DEFINED')
C 
C  CHECK SENSITIVITY REQUESTS 
C 
 1400 IF (NSENS.EQ.0) GO TO 1600
      IF (NOPRNT.GT.0) GO TO 1405 
      WRITE (IDO,1401)
1401    FORMAT(/1X,'*****SENSITIVITY OUTPUTS'/)
        WRITE (IDO,1402)(KSNOUT(I),I=1,NSENS)
1402    FORMAT(1X,10(A5,2X))
      IFLAG=0 
 1405 IKNT=0
 1410 IKNT=IKNT+1 
      IF (IKNT.GT.NSENS) GO TO 1440
      JKNT=0
 1420 JKNT=JKNT+1 
      IF (JKNT.GT.IONUM) GO TO 1430
      IF (KSNOUT(IKNT).NE.IONAM(JKNT)) GO TO 1420 
      KSNOUT(IKNT)=JKNT
      GO TO 1410
 1430 IFLAG=1 
      WRITE (5,1431) KSNOUT(IKNT) 
 1431 FORMAT (/1X,'  SENSITIVITY OUTPUT ',A5,' HAS NOT '
     1   'BEEN CORRECTLY DEFINED')
      GO TO 1410
 1440 IF (IFLAG.EQ.0) GO TO 1600
      NSENS=0 
C 
C  CHECK DESIGN PARAMETER SPECIFICATIONS
C 
 1600 IF (JDSFLG.EQ.0) GO TO 3000 
      IF (NOPRNT.GT.0) GO TO 1620 
      WRITE (IDO,1611)
1611    FORMAT(/1X,'*****DC DESIGN PARAMETERS'/)
        WRITE (IDO,1402)(NOELEM(I),I=1,NDES)
 1620 IKNT=0
 1630 IKNT=IKNT+1 
      IF (IKNT.GT.NDES) GO TO 1800
      CALL IDEN(NOELEM(IKNT),ID,ITEMP)
      IF (ID.EQ.0) GO TO 1660 
      NOELEM(IKNT)=ITEMP
      NELTPE(IKNT)=ID 
      GO TO 1630
 1660 JDSFLG=0
      NOGO=1
      WRITE (5,1661) NOELEM(IKNT) 
 1661 FORMAT (/1X,'  DESIGN PARAMETER ',A5,' HAS NOT BEEN '
     1   'CORRECTLY DEFINED')
      GO TO 1630
C 
C  CHECK DESIGN OUTPUT SPECIFICATIONS 
C 
 1800 IF (NSPEC.EQ.0) GO TO 1870
      IF (NOPRNT.GT.0) GO TO 1810 
      WRITE (5,1801) (NOUNUM(I),DESVAL(I),WEIGHT(I),I=1,NSPEC)
 1801 FORMAT (///1X,5H'''' ,'DC DESIGN OUTPUT SPECIFICATIONS'//1X,
     1  'NAME',13X,'VALUE',10X,'WEIGHT'//10(1X,A5,6X,1PE10.3,6X,E10.3/))
 1810 IKNT=0
 1820 IKNT=IKNT+1 
      IF (IKNT.GT.NSPEC) GO TO 3000
      JKNT=0
 1830 JKNT=JKNT+1 
      IF (JKNT.GT.IONUM) GO TO 1860
      IF (NOUNUM(IKNT).NE.IONAM(JKNT)) GO TO 1830 
      NOUNUM(IKNT)=JKNT
      GO TO 1820
 1860 JDSFLG=0
      NOGO=1
      WRITE (5,1861) NOUNUM(IKNT) 
 1861 FORMAT (/1X,'  DESIGN OUTPUT VARIABLE ',A5,' HAS NOT '
     1   'BEEN DEFINED CORRECTLY')
      GO TO 1820
 1870 JDSFLG=0
      NOGO=1
      WRITE (5,1871)
 1871 FORMAT (/1X,'  NO DESIGN OUTPUTS SPECIFIED'/)
C 
C  CHECK TEMP COEFFICIENTS
C 
 3000 IF (NOPRNT.GT.0) RETURN 
      ISTART=1
      IF (NUMTEM.GT.1) ISTART=2
      WRITE (IDO,3001)
3001    FORMAT(/1X,'*****CIRCUIT TEMPERATURES (DEG C)',$)
        WRITE (IDO,3002)(TEMPS(I),I=ISTART,NUMTEM)
3002    FORMAT(1H+,5(F8.2))
      RETURN
      END 
    