BTYMSPCDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 1
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC			000111	00100	TYMSPC==111	;TYMSHARE SPECIFICATION NUMBER
BTYMRELC			000000	00200	TYMREL==0	;TYMSHARE RELEASE NUMBER
BC
BDEFINETITLC				00400	DEFINE TITL(TS,TR)<
BC				00500	TITLE RPG VERSION TS'.'TR
BC				00600	VCOMPIL=<TS,,TR>>
BC
BTITLTYMSPCTYMRELC				00800	TITL(\TYMSPC,\TYMREL)^
BTITLEVCOMPIC
BSUBTTLC				01000	SUBTTL WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS
BC
BINTERNVCOMPIC				01200	INTERNAL VCOMPILE       ;FOR LOADER MAP AND LIBRARY
BC
BLOCC	000137			01400	LOC 137
BEXPVCOMPIC	000137	000111	000000	01500	EXP VCOMPILE
BRELOCC	000000'			01600	RELOC
BIFNDEFTEMPC				01700	IFNDEF TEMP,<TEMP==1>   ;TEMP=1 ALLOWS THE TMPCOR UUO TO BE USED
BC
BIFNDEFRUNSWC				01900	IFNDEF RUNSW,<RUNSW==1>          ;NON-ZERO TO USE THE RUN UUO
BIFNDEFSYSSWC				02000	IFNDEF SYSSW,<SYSSW==0>          ;NON ZERO USES DSK [1,4] FOR RUNS
BC
BIFNDEFSTANSWC				02200	IFNDEF STANSW,<STANSW==0>        ;NON-ZERO TO INCLUDE STANFORD FEATURES
BLSTRSWC			000001	02300	LSTRSW==1
BIFNDEFLSTRSWC				02400	IFNDEF LSTRSW,<LSTRSW==0>        ;NON-ZERO TO USE "LISTER" INSTEAD OF PIP
BC				02500	                                ;FOR TYPE AND LIST COMMANDS
BIFNDEFSAVEXTC				02600	IFNDEF SAVEXT,<SAVEXT=<SIXBIT /   SAV/>>        ;USE DMP FOR PDP6'S
BIFESYSSWSIXBITSYSDEVC		637163	000000	02700	IFE SYSSW,<SYSDEV=<SIXBIT /SYS/>>
BIFNSYSSWC				02800	IFN SYSSW,<SYSDEV=<SIXBIT /DSK/>>       ;USE DSK [1,1]
BIFNDEFWRD4C				02900	IFNDEF WRD4,<WRD4=1>    ;MULTIPLE WORD UFDS
BTMSZC			000013	03000	TMSZ=^D11
BIFNWRD4TMSZC			000021	03100	IFN WRD4,<TMSZ=^D17
BHASHC			000045	03200	HASH=^D37>
BPOINTLDATLDAT.DC			011014'	03300	LDAT.DATE=[POINT 12,LDAT,35]
BPOINTTMSZLDATLDAT.TC			011015'	03400	LDAT.TIME=[POINT TMSZ,LDAT,23]
BC
BNMLSTLC			000010	03600	NMLSTL==10	;NUMBER OF USER NAMES TO SAVE AWAY FOR FAST REFERENCE
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;ACS
BPC			000017	00200	P=17            ;PUSHDOWN POINTER
BCC			000016	00300	C=16            ;CHARACTERS RETURNED HERE
BCSC			000015	00400	CS=15           ;CHARACTER STATUS BITS HERE
BSVPTC			000014	00500	SVPT=14         ;POINTER TO CURRENT FILE IN LIST OF FILES (AOBJN)
BSWPTC			000013	00600	SWPT=13         ;BYTE POINTER INTO SWITCH STORAGE AREA
BSWCNTC			000012	00700	SWCNT=12        ;NUMBER OF BYTES LEFT FOR SWITCH STORAGE
BFL3C			000011	00800	FL3=11          ;RH RANDOM FLAGS, LEFT HALF LOCAL FLAGS
BFL2C			000010	00900	FL2=10          ; RH ONE PIT PER PROCESSOR TO INDICATE
BC				01000	                ;CHANEL OPEN. LH PROCESSOR DECIDED UPON
BIOPC			000007	01100	IOP==7          ;PDL FOR INPUT NESTING
BIOPNTC			000006	01200	IOPNT==6        ;POINTER TO CURRENT INPUT FILE
BC
BSVPTT7C			000014	01400	T7=SVPT         ;TEMP USED BY "COUNT"
BSWPTT6C			000013	01500	T6=SWPT         ;TEMP USE BY "MAIL",ETC
BT5C			000005	01600	T5=5    ;ANOTHER TEMP
BT4C			000004	01700	T4=4            ;TEMPORARY ACCUMS
BT3C			000003	01800	T3=3
BT2C			000002	01900	T2=2
BT1C			000001	02000	T1=1
BFLC			000000	02100	FL=0            ;FLAG REGISTER (LEFT HALF PERM SWITCHES)
BC				02200	                ;(RIGHT HALF MISC BITS)
BC
BC				02400	;DEFINITIONS OF CALLI'S
BC
BC				02600		;BITS IN DEVCHR
BDSKBTC			200000	02700	        DSKBT==200000
BDTABTC			000004	02800	        DTABT==4
BPVTYMXC			000200	02900	PVTYMX==200     ;MONITOR TYMEX BIT
BPVGEXC			000400	03000	PVGEX==400	;MONITOR GE-EXEC BIT
BTSPROPC			040000	03100	TSPROP==40000  ;TYMSHARE PROPRIATORY ACCOUNT
BACCSUPC			020000	03200	ACCSUP==20000   ;ACCOUNT SUPEVISOR
BGETPRVC			000006	03300	GETPRV==6
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 3
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;FLAGS (RH OF FL)
BC
BPROCSC			000001	00300	PROCS==1        ;PROCESSOR SWITCHES SEEN
BDOLODC			000002	00400	DOLOD==2        ;WE WANT TO DO LOADING
BPCM1C			000004	00500	PCM1==4         ;LOCAL BIT AVAILABLE FOR ANYBODY
BPCM2C			000010	00600	PCM2==10        ;LIKE PCM1
BIDFC			000020	00700	IDF==20         ;SCAN SAW AN IDENTIFIER
BNUMFSC			000100	00800	NUMFS==100      ;SCAN SAW A NUMBER
BPRMPTFC			000100	00900	PRMPTF==100     ;PROMPTING MSG. TYPED
BPERFC			000200	01000	PERF==200       ;PERMANENT TYPE FLAGS
BMAPSTC			000400	01100	MAPST==400      ;A MAP DEVICE HAS BEN GENERATED FOR LOADER
BCMDSNC			001000	01200	CMDSN==1000     ;THE COMMAND SHOULD BE WRITTEN AS SVC OR EDS
BINCRFC			002000	01300	INCRF==2000     ;WE ARE FINISHING CREF OUTPUT
BINPRNTC			004000	01400	INPRNT==4000    ;WE ARE PRINTING A CHARACTER STRING IN ERROR MSG
BPIPFC			010000	01500	PIPF==10000     ;DOING SOMETHING FOR PIP
BEDITFC			020000	01600	EDITF==20000    ;IN EDIT OR CREATE
BCREATFC			040000	01700	CREATF==40000   ;CREATE
BPCM2LPTFGC			000010	01800	LPTFG==PCM2     ;/L FLAG IN DIRECTORY COMMAND
BPCM1NODATC			000004	01900	NODAT==PCM1     ;FILE FROM OTHER THAN DSK
BPCM2NOLOOKC			000010	02000	NOLOOK==PCM2    ;LOOKUP FAILED
BCCSRNFC			100000	02100	CCSRNF==100000	;HAVE LAST PROCESSOR RUN SYS:FORTRA INSTEAD OF SYS:LOADER
BRECALFC			200000	02200	RECALF==200000  ;WE ARE READING A COMMAND SAVE FILE
BPCM1RPGSRCC			000004	02300	RPGSRC==PCM1    ;DOING A COMPILE REQUEST FRO SVCM
BPCM2ALTSRCC			000010	02400	ALTSRC==PCM2    ;NO LOOKIN ON SVED FOR FILE NAME
BC
BC
BC				02700	;FLAGS (SWITCH TYPE)
BLISTSWC			000001	02800	LISTSW==1       ;DO LISTING
BCRSWC			000002	02900	CRSW==2         ;DO A CREF
BLIBSWC			000004	03000	LIBSW==4        ;DO A LIBRARY SEARCH OF THIS FILE
BRELSWC			000010	03100	RELSW==10       ;DO A LOAD ONLY ON THIS FILE
BCOMPLSC			000020	03200	COMPLS==20      ;COMPILE REGARDLESS OF DATES
BIMEDSWC			000040	03300	IMEDSW==40      ;DO THIS COMMAND INSTEAD OF JUST SETTING SWITCHES
BFORWDSC			000100	03400	FORWDS==100     ;THIS FILE MAY NOT EXIST YET, BUT IT WILL
BNOLODSC			000200	03500	NOLODS==200     ;DO NOT LOAD THIS FILE
BNOBINC			000400	03600	NOBIN==400	;DO NOT CREATE A .REL FILE FOR THIS FILE
BC
BPDLC			000100	03800	PDL==100        ;LENGTH OF PDL
BSWBKC			000005	03900	SWBK==5 ;NUMBER OF WORDS FOR SWITCHES TO PROCESSOR
BLODSCTC			000010	04000	LODSCT==10      ;NUMBER OF LOADER SWITCHES PER FILE ALLOWED
BRFLC			000005	04100	RFL==5          ;FILE NO. FOR RANDOM I/O
BIFLC			000006	04200	IFL==6          ;FILE NO. MAIL INPUT
BHASHSZC			000401	04300	HASHSZ==^D257   ;HASHING PARAMETER
BMBXHSHC			000177	04400	MBXHSH==177     ;HASHING PARAMETER FOR MAILBOX
BENTSIZC			000012	04500	ENTSIZ==12      ;USER DIR. ENTRY SIZE
BC
BC
BC				04800	;FLAGS IN RH OF FL3
BC
BINLIBC			000002	05000	INLIB==2        ;CURRENTLY IN /L MODE FOR LOADER
BPARFLGC			000004	05100	PARFLG==4       ;ARGUMENT TO A SWITCH SURROUNDED BY PARENS
BCNSBTC			000400	05200	CNSBT==400      ;NO SYMBOLS TO CREF
BCNMBTC			001000	05300	CNMBT==1000     ;NO MACROS TO CREF
BCOPBTDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 3-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC			002000	05400	COPBT==2000     ;OPCODES TO CREF
BCNLBTC			004000	05500	CNLBT==4000     ;NO LISTING TO CREF
BCCMBTC			010000	05600	CCMBT==10000    ;COMBINE CREFS
BCMONBTC			020000	05700	CMONBT==20000   ;CREF FOR MONITOR (USE /Q)
BTYMXC			040000	05800	TYMX==40000     ;TYMEX FLAG
BSPCOMC			100000	05900	SPCOM==100000   ;SPECIAL COMMANDS (ONLY BY CTEST)
BFDBGSWC			200000	06000	FDBGSW==200000  ;FDEBUG COMMAND IN PROGRESS
BCNSBTCNMBTCOPBTCNLBTCCMBTCMONBTALLCRFC			037400	06100	ALLCRF==CNSBT!CNMBT!COPBT!CNLBT!CCMBT!CMONBT
BC
BC				06300	;DEFINITIONS OF WORDS IN THE LUD
BC
BLDPPNC			000000	06500	LDPPN==0                ;PPN FOR USER
BLAUDC			000001	06600	LAUD==1         ;AUN FOR USER
BLBITSC			000002	06700	LBITS==2        ;BITS (RUN BIT, WATCH BITS, ETC)
BLLINKC			000002	06800	LLINK==2        ;HAS SIZE OF ENTRY IN RIGHT 7 BITS
BLPRVC			000003	06900	LPRV==3         ;PRV BITS
BLHUNC			000004	07000	LHUN==4         ;HASHED USER NAME
BREPEATDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 4
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	REPEAT 0,< THE MACRO PROCESS DEFINES DETAILS ABOUT THE VARIOUS
BC				00200	        PROCESSORS WHICH COMPILE IS EXPECTED TO HANDLE BY CALLING
BC				00300	        THE MACRO X WHICH IS REDEFINED TO PRODUCE THE INFORMATION REQUIRED.
BC				00400	        THE ARGUMENTS ARE SWITCH NAME,EXTENSION,PROCESSOR NAME
BC				00500	        <OPTIONAL>EXTENSION OF NEXT PROCESSOR IF MUST BE PROCESSED MORE
BC				00600	        THAN ONCE (AS COBOL),EXTENSION PRODUCED
BC				00700	
BC				00800	        USE F4 OR F40 AS APPROPRIATE FOR THE SYSTEM
BC				00900	>
BC
BDEFINEMESSC				01100	DEFINE  MESS(T),<JRST [OUTSTR [ASCIZ "T"]
BC				01200	                JRST    EX]>
BDEFINEERRC				01300	DEFINE  ERR(T),<JRST [OUTSTR [ASCIZ "T"]
BC				01400	                JRST    ERRCOM]>
BDEFINEPROCESC				01500	DEFINE PROCESS<
BC				01600	X FORTRAN,F4,F40
BC				01700	X MACRO,MAC,MACRO
BC				01800	X FTFORTRAN,FTF,FTF40
BC				01900	X SIMPL,SIM,SIMPL
BC				02000	X FAIL,FAL,FAIL
BC				02100	X COBOL,CBL,COBOL
BC				02200	X BLIMP,BLI,BLISS
BC				02300	X VAS,VAS,VAS
BC				02400	>
BC
BC				02600	;DEFINE VARIOUS BITS
BC
BRELSWALPROCC			000010	02800	ALPROC==RELSW   ;OR OF BITS FOR ALL THE PROCESSORS
BNPROCSC			000000	02900	NPROCS==0       ;NUMBER OF PROCESSORS
BFCHLODC			400000	03000	FCHLOD==400000  ;LOADER CHANNEL HAS BEEN INITED
BCHNC			000017	03100	CHN==17         ;USED TO DEFINE CHANNEL NUMBER
BSPRCC			000000	03200	SPRC==0         ;BITS FOR THOSE PROCESSORS WHICH OUTPUT TO ANOTHER
BC
BDEFINEXC				03400	DEFINE X (A,B,C,D,E)<
BC				03500	B'SW==FCHLOD    ;PROCESSOR BIT
BC				03600	IFDIF <D>,<>,<SPRC==SPRC!FCHLOD>
BC				03700	ALPROC==ALPROC!FCHLOD
BC				03800	NPROCS==NPROCS+1
BC				03900	CAT (B,NUM)==NPROCS     ;NUMBER OF PROCESS (FOR FAIL, PAL DECISION)
BC				04000	FCH'B==FCHLOD   ;ON INDICATES CHANEL OPEN
BC				04100	CHN'B==CHN      ;CHANNEL NUMBER
BC				04200	CHN==CHN-1
BC				04300	FCHLOD==FCHLOD_<-1>>
BDEFINEC				04400	DEFINE CAT(A,B)
BCATC				04500	<A'B>
BC
BLVARC				04700	LVAR
BARRAYLOWSTC				04800	ARRAY LOWST[0]  ;SET UP FOR THE ZEROING BLT
BLVARC				04900	LVAR
BC
BDEFINEC				05100	DEFINE SBTS(A,B)        ;THIS MACRO PRODUCES TABLES FOR OUTPUTTING SWITCHES
BSBTSC				05200	<<SIXBIT !/A!>+B>
BDEFINEC				05300	DEFINE TBGEN (A,B,C)    ;GENERATE /TYPE SWITCH TABLES
BTBGENDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 4-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				05400	<DEFINE SWITCH (P,Q)
BC				05500	<<SIXBIT /P/>>
BC				05600	A:      TABLE
BC				05700	B==.-A
BC				05800	DEFINE SWITCH (P,Q)
BC				05900	<Q>
BC				06000	C:      TABLE
BC				06100	>
BPROCESDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 5
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	PROCESS^
BXFCHLODF4SWIFDIFALPROCFCHLODALPROCNPROCSNPROCSCATNPROCSF4NUMFCHLODFCHF4CHNCHNF4CHNCHNFCHLODFCHLODXFCHLODMACSWIFDIFALPROCFCHLODALPROCNPROCSNPROCSCATNPROCSMACNUMFCHLODFCHMACCHNCHNMACCHNCHNFCHLODFCHLODXFCHLODFTFSWIFDIFALPROCFCHLODALPROCNPROCSNPROCSCATNPROCSFTFNUMFCHLODFCHFTFCHNCHNFTFCHNCHNFCHLODFCHLODXFCHLODSIMSWIFDIFALPROCFCHLODALPROCNPROCSNPROCSCATNPROCSSIMNUMFCHLODFCHSIMCHNCHNSIMCHNCHNFCHLODFCHLODXFCHLODFALSWIFDIFALPROCFCHLODALPROCNPROCSNPROCSCATNPROCSFALNUMFCHLODFCHFALCHNCHNFALCHNCHNFCHLODFCHLODXFCHLODCBLSWIFDIFALPROCFCHLODALPROCNPROCSNPROCSCATNPROCSCBLNUMFCHLODFCHCBLCHNCHNCBLCHNCHNFCHLODFCHLODXFCHLODBLISWIFDIFALPROCFCHLODALPROCNPROCSNPROCSCATNPROCSBLINUMFCHLODFCHBLICHNCHNBLICHNCHNFCHLODFCHLODXFCHLODVASSWIFDIFALPROCFCHLODALPROCNPROCSNPROCSCATNPROCSVASNUMFCHLODFCHVASCHNCHNVASCHNCHNFCHLODFCHLODCHNCHNLODC			000007	00200	CHNLOD==CHN
BCHNCHNLSTC			000007	00300	CHNLST==CHN
BFCHLODFCHLSTC			001000	00400	FCHLST==FCHLOD
BCHNCHNEDTC			000007	00500	CHNEDT==CHN
BFCHLODFCHEDTC			001000	00600	FCHEDT==FCHLOD
BCHNCHNPIPC			000007	00700	CHNPIP==CHN
BFCHLODFCHPIPC			001000	00800	FCHPIP==FCHLOD
BCHNCHNDIRC			000007	00900	CHNDIR==CHN
BFCHLODFCHDIRC			001000	01000	FCHDIR==FCHLOD
BCHNCHNFCMC			000007	01100	CHNFCM==CHN
BFCHLODFCHFCMC			001000	01200	FCHFCM==FCHLOD
BCHNCHNCRFC			000006	01300	CHNCRF==CHN-1           ;CREF OUTPUT CHANNEL
BNSDNMC			000003	01400	NSDNM==3        ;MAX NUMBER OF NON-STANDARD PROCESSORS
BCHNNSDCHNC			000005	01500	NSDCHN==CHN-2   ;HIGHEST CHANEL FOR NON-STANDARDS
BNSDCHNNSDNMNONSBSC			000003	01600	NONSBS==NSDCHN-NSDNM+1  ;LOWEST CHANEL
BC
BDEFINEC				01800	DEFINE FOR (START,END,TEXT,INC)
BFORC				01900	<XXX==START
BC				02000	REPEAT END,<TEXT
BC				02100	IFB <INC>,<XXX==XXX+1>
BC				02200	IFNB <INC>,<XXX==XXX+INC>>>
BFORXXXC			000001	02300	FOR (1,NSDNM,<CAT (NSDS,\XXX)==FCHLOD_<1-XXX>>)^XXX==1
BREPEATNSDNMCATXXXFCHLODXXXNSDS1IFBXXXXXXIFNBCATXXXFCHLODXXXNSDS2IFBXXXXXXIFNBCATXXXFCHLODXXXNSDS3IFBXXXXXXIFNBFCHLODFCHCRFC			000400	02400	FCHCRF==FCHLOD_<-1>
BLOOKC			000000	02500	LOOK==0         ;CHANNEL FOR DOING LOOKUPS FOR INFORMATION
BNFILEC			000101	02600	NFILE==^D65     ;NUMBER OF FILES PERMITTED IN A + CONSTRUCTION
BMAXNSTC			000017	02700	MAXNST==17      ;MAXIMUM NESTING DEPTH TO PERMIT
BCHNNESTDPC			000004	02800	NESTDP==CHN-3   ;MAXIMUM NESTING DEPTH POSSIBLE WITH THESE PROCESSORS
BIFGNESTDPMAXNSTC				02900	IFG NESTDP-MAXNST,<NESTDP==MAXNST>      ;PICK SMALLER
BC
BEXTERNJOBFFJOBRELJOBSAJOBSYMJOBERRJOBDDTC				03100	EXTERNAL JOBFF,JOBREL,JOBSA,JOBSYM,JOBERR,JOBDDT
BSEXTERRPGDBC				03200	SEXTERNAL RPGDB
BC
BHISEGC	000000'			03400	        HISEG           ;SIGNAL LOADER FOR HIGH SEGMENT
BC
BC
BIFNNSDNMIFERUNSWC				03700	IFN NSDNM,<IFE RUNSW,<PRINTX SWITCH CONFLICT>>
BC
BNUNPNTDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 6
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC			000006	00100	NUNPNT==6
BNUNTOPC			000007	00200	NUNTOP==7
BC
BIFERUNSWC				00400	IFE RUNSW,<
BC				00500	OFFSET==INHERE-74
BC				00600	
BC				00700	NUNCOM: IOWD 0,INHERE
BC				00800	        0
BC				00900	NUNGO2: CALLI 15,11     ;GET PROPER CORE SIZE
BC				01000	        JRST NOCOR      ;LOSE
BC				01100	        IN 1,NUNCOM     ;GET IT
BC				01200	        JRST NUNGO3     ;OK
BC				01300	        PUSH    P,T3            ;SAVE MAIL BLK CURSOR
BC				01400	NUNERR: CALLI NUNPNT,3  ;WE LOSE, PRINT ERROR
BC				01500	        JRST EX
BC				01600	NUNERM: ASCIZ #?LINKAGE ERROR - I/O#
BC				01700	NUNGO3: SKIPE 12,OFFSET+JOBCOR  ;GET JOBCOR
BC				01800	        CAMG 12,JOBREL  ;AND SEE IF WE SHOULD EXPAND
BC				01900	        JRST NUNGO4     ;NO, START THE BLT
BC				02000	        POP     P,T3            ;RESTORE MAIL BLK CURSOR
BC				02100	        MOVEI NUNPNT,NUNCER
BC				02200	        JRST EX,11      ;YES, DO IT
BC				02300	        JRST NUNERR     ;LOSE
BC				02400	        MOVE 12,OFFSET+JOBS41   ;RESET 41
BC				02500	        MOVEM 12,41
BC				02600	        JRST NUNGO4     ;WIN
BC				02700	NUNCER: ASCIZ /?CORE NEEDED/
BC				02800	INHERE:
BC				02900	
BC				03000	NUNAC:  PHASE 0 ;THE CODE TO GO IN THE ACS
BC				03100	NUNGO4: MOVE 12,OFFSET+JOBDDT   ;SET JOBDDT
BC				03200	        JRST EX,2
BC				03300	NUNBLT: BLT NUNTOP,0
BC				03400	        RESET   ;RESET THE WORLD
BC				03500	        AOS 1,JOBSA     ;GET STARTING ADDRESS
BC				03600	        JRST (1)
BC				03700	        NUNERM
BC				03800	        XWD INHERE+1,75 ;THE BLT WORD
BC				03900	DEPHASE
BC				04000	>
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 7
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;COME HERE WHEN FINALLY READY TO RUN A PROCESSOR
BC
BCREFITPUSHJPWRTPARC	000000'	260740	001771'	00300	CREFIT:	PUSHJ	P,WRTPAR	;MAKE SURE PARAMETER FILE IS WRITTEN
BMOVET1SIXBITC	000001'	200040	011016'	00400		MOVE	T1,[SIXBIT/CROSS/]
BNUNDOTRNEFLCCSRNFC	000002'	602000	100000	00500	NUNDO:	TRNE	FL,CCSRNF
BCAMET1SIXBITC	000003'	312040	011017'	00600		CAME	T1,[SIXBIT/LOADER/]
BJRSTC	000004'	254000	000006'	00700		JRST	.+2		;IF IN CCS COMPILE MODE, RUN
BGOCCSMOVET1SIXBITC	000005'	200040	011020'	00800	GOCCS:	MOVE	T1,[SIXBIT/CFORTR/]	;SYS:CFORTR INSTEAD OF SYS:LOADER
BMOVEMT1NAMEC	000006'	202040	000000*	00900		MOVEM	T1,NAME		;SET NAME
BIFESYSSWSETZMNAMEC	000007'	402000	000000*	01000	IFE SYSSW,<     SETZM   NAME+3>
BIFNSYSSWC				01100	IFN SYSSW,<     MOVE T1,[XWD 1,4]
BC				01200	        MOVEM   T1,NAME+3               ;CUSPS FROM DSK [1,1]
BC				01300	>
BIFNC				01400	IFN RUNSW,<
BSETZMNAMEC	000010'	402000	000000*	01500	        SETZM   NAME+1  ;LET MONITOR SUPPLY SAV OR SHR
BSKIPNT1PCDEVC	000011'	336040	000000*	01600	        SKIPN T1,PCDEV  ;SPECIAL DEVICE??
BJRSTNOPCDVC	000012'	254000	000015'	01700	        JRST NOPCDV
BMOVEMT1RUNBLKC	000013'	202040	000000*	01800	        MOVEM T1,RUNBLK
BSETZMNAMEC	000014'	402000	000007*	01900	        SETZM NAME+3    ;ZERO PPN
BNOPCDVSKIPET1PCEXTC	000015'	332040	000000*	02000	NOPCDV: SKIPE T1,PCEXT
BMOVEMT1NAMEC	000016'	202040	000010*	02100	        MOVEM T1,NAME+1
BSKIPET1PCPPNC	000017'	332040	000000*	02200	        SKIPE T1,PCPPN
BMOVEMT1NAMEC	000020'	202040	000014*	02300	        MOVEM T1,NAME+3 ;SETUP OTHER THINGS (FROM NON-STANDARD)
BMOVET1ALTRUNALTRUNRUNBLKC	000021'	200040	011021'	02400		MOVE T1,[ALTRUN,,RUNBLK]
BSKIPEALTRUNC	000022'	332000	000000*	02500		SKIPE ALTRUN
BBLTT1RUNBLKC	000023'	251040	000000*	02600		BLT T1,RUNBLK+5	;FUDGE UP RUNBLK IF ALTERNATE RUN GIVEN
BMOVEIT1P.SPROC	000024'	201040	000002	02700		MOVEI T1,P.SPROC
BSKIPNALTRUNC	000025'	336000	000022*	02800		SKIPN ALTRUN
BPUSHJPGETPARC	000026'	260740	001717'	02900		PUSHJ P,GETPAR	;CHECK FOR SPECIAL PROCESSORS
BJRSTGORUNC	000027'	254000	000043'	03000		JRST GORUN	;NONE (OR ALTRUN GIVEN), NO FUNNY STUFF
BHRRZT2T2C	000030'	550102	000000	03100		HRRZ T2,(T2)	;GET BLOCK LENGTH
BIDIVIT2C	000031'	231100	000007	03200		IDIVI T2,7	;NUMBER OF 7-WORD ENTRIES
BMOVET3NAMEC	000032'	200140	000006*	03300		MOVE T3,NAME	;NAME OF PROCESSOR TO BE RUN
BCAMNT3T1C	000033'	316141	000000	03400		CAMN T3,(T1)	;DOES IT MATCH THIS ENTRY?
BJRSTSPFNDC	000034'	254000	000040'	03500		JRST SPFND	;YUP, SWITCH IT
BADDIT1C	000035'	271040	000007	03600		ADDI T1,7	;NOPE, TRY NEXT ONE
BSOJGT2C	000036'	367100	000033'	03700		SOJG T2,.-3
BJRSTGORUNC	000037'	254000	000043'	03800		JRST GORUN	;RAN OUT, FORGET IT
BSPFNDMOVSIT1T1C	000040'	205041	000001	03900	SPFND:	MOVSI T1,1(T1)
BHRRIT1RUNBLKC	000041'	541040	000013*	04000		HRRI T1,RUNBLK	;FOUND SPECIAL, GET ITS RUN BLOCK
BBLTT1RUNBLKC	000042'	251040	000023*	04100		BLT T1,RUNBLK+5
BGORUNMOVEPDPC	000043'	200000	010735'	04200	GORUN:	MOVE PDP	;SET UP BLISS STACK
BPUSHRUNBLKRUNBLKC	000044'	261000	011022'	04300		PUSH [RUNBLK]
BSKIPERPGDBRPGDBC	000045'	332000	011023'	04400		SKIPE [RPGDB]
BPUSHJRPGDBC	000046'	260000	000000*	04500		PUSHJ RPGDB	;IN BLISS: RPGDB(RUNBLK);
BMOVEIT1RUNBLKC	000047'	201040	000041*	04600		MOVEI T1,RUNBLK
BSKIPNEDCMNDEDCMNDC	000050'	336000	000000*	04700		SKIPN EDCMND#
BHRLIT1C	000051'	505040	000001	04800		HRLI T1,1	;ALL COMMANDS EXCEPT EDITOR GET 1 OFFSET
BRUNT1C	000052'	047040	000035	04900		RUN	T1,
BHALTC	000053'	254200	000000	05000		HALT
BC				05100	>
BIFERUNSWC				05200	IFE RUNSW,<
BC				05300	NORUN:  INIT 1,16       ;GET A DSK IN DUMP MODE
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 7-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				05400	        EXP SYSDEV      ;SIXBIT SYS OR DSK
BC				05500	        0
BC				05600	        JRST DSKNA
BC				05700	        MOVSI T1,SAVEXT         ;SIXBIT FOR SAVE OR DMP.
BC				05800	        MOVEM T1,NAME+1
BC				05900	        LOOKUP 1,NAME
BC				06000	        JRST NOFIL
BC				06100	        MOVE T1,NAME    ;SET NAME OF NEW PROCESSOR
BC				06200	        CALL T1,[SIXBIT /SETNAM/]
BC				06300	        HLRO 15,NAME+3  ;GET COUNT
BC				06400	        HRLM 15,NUNCOM
BC				06500	        MOVNS 15        ;MAKE POSITIVE
BC				06600	        MOVEI 16,73(15) ;GET END
BC				06700	        ADDI 15,INHERE  ;CHECK CORE SIZE
BC				06800	        IORI 15,1777
BC				06900	        MOVSI NUNTOP,NUNAC
BC				07000	        BLT NUNTOP,NUNTOP       ;GET ACS LOADER
BC				07100	        HRR NUNBLT,16   ;AND SET END OF BLT
BC				07200	        JRST NUNGO2
BC				07300	>
BC
BC				07500	;/RUN <FILENAME> IS A VALID SWITCH IN ALMOST ALL COMMANDS.
BC				07600	;IT TELLS RPG TO RUN THE PROGRAM SPECIFIED BY <FILENAME>
BC				07700	;INSTEAD OF THE PROGRAM IT WOULD NORMALLY RUN.
BC
BPCM1NOSCANC			000004	07900	NOSCAN==PCM1	;SAYS TO NOT DO EXTRA SCAN WHEN DONE
BC
BSETRNNTROAFLNOSCANC	000054'	664000	000004	08100	SETRNN:	TROA FL,NOSCAN
BSETRUNTRZFLNOSCANC	000055'	620000	000004	08200	SETRUN:	TRZ FL,NOSCAN
BAOBJPSVPTTMNERC	000056'	252600	001051'	08300		AOBJP SVPT,TMNER	;AVOID CLOBBERING STUFF
BPUSHPSETRN2C	000057'	261740	000072'	08400		PUSH P,SETRN2
BSETRNFPUSHJPGETNMSC	000060'	260740	000115'	08500	SETRNF:	PUSHJ P,GETNMS	;GET FILE NAME TO RUN
BSKIPNT1SVDEVSVPTC	000061'	336054	000000*	08600		SKIPN T1,SVDEV(SVPT)
BMOVSIT1C	000062'	205040	446353	08700		MOVSI T1,'DSK'	;DEFAULT DEVICE IS DSK NOT SYS
BMOVEMT1ALTRUNC	000063'	202040	000025*	08800		MOVEM T1,ALTRUN
BMOVET1SVNAMSVPTC	000064'	200054	000000*	08900		MOVE T1,SVNAM(SVPT)
BMOVEMT1ALTRUNC	000065'	202040	000000*	09000		MOVEM T1,ALTRUN+1
BHLLZT1SVEXTSVPTC	000066'	510054	000000*	09100		HLLZ T1,SVEXT(SVPT)
BMOVEMT1ALTRUNC	000067'	202040	000000*	09200		MOVEM T1,ALTRUN+2
BMOVET1SVPPNSVPTC	000070'	200054	000000*	09300		MOVE T1,SVPPN(SVPT)
BMOVEMT1ALTRUNC	000071'	202040	000000*	09400		MOVEM T1,ALTRUN+4
BSETRN2POPJPC	000072'	263740	000073'	09500	SETRN2:	POPJ P,.+1
BSUBSVPTC	000073'	274600	011024'	09600		SUB SVPT,[1,,1]	;BACK UP POINTER
BSETZBT3T4C	000074'	403140	000004	09700		SETZB T3,T4	;FOR LISTER-TYPE COMMANDS
BTRNNFLNOSCANC	000075'	606000	000004	09800		TRNN FL,NOSCAN	;SHOULD WE SCAN?
BJRSTSCANC	000076'	254000	000276'	09900		JRST SCAN	;YUP
BPOPJPC	000077'	263740	000000	10000		POPJ P,		;NOPE
BC
BSETRPGPUSHJPSCANSC	000100'	260740	000256'	10200	SETRPG:	PUSHJ P,SCANS	;PEEK AHEAD TO CHECK FOR NAME
BTLNNCSTERMFC	000101'	607640	200000	10300		TLNN CS,TERMF
BPUSHJPSETRNFC	000102'	260740	000060'	10400		PUSHJ P,SETRNF	;SET UP FILE NAME IF GIVEN
BGETPPNT1C	000103'	047040	000024	10500		GETPPN T1,
BSKIPNALTRUNC	000104'	336000	000071*	10600		SKIPN ALTRUN+4
BMOVEMT1ALTRUNDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 7-3
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	000105'	202040	000104*	10700		MOVEM T1,ALTRUN+4
BMOVEIT1P.RPGRC	000106'	201040	000001	10800		MOVEI T1,P.RPGRN
BMOVEIT2C	000107'	201100	000006	10900		MOVEI T2,6
BMOVEIT3ALTRUNC	000110'	201140	000063*	11000		MOVEI T3,ALTRUN
BSKIPNALTRUNC	000111'	336000	000110*	11100		SKIPN ALTRUN
BMOVEIT2C	000112'	201100	000000	11200		MOVEI T2,0	;ZERO LENGTH (TO DELETE ENTRY) IF NO NAME
BPUSHJPSETPARC	000113'	260740	001732'	11300		PUSHJ P,SETPAR	;SET UP SPECIAL RPG TO RUN
BJRSTXITC	000114'	254000	001415'	11400		JRST XIT
BTERMFDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 8
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC			200000	00100	TERMF==200000
BNUMFC			100000	00200	NUMF==100000
BSPCFC			400000	00300	SPCF==400000
BSPACTC			040000	00400	SPACT==40000    ;SPECIAL ACTION TO BE TAKEN ON CHAR
BSPACT2C			020000	00500	SPACT2==20000   ;SPECIAL ACTION AT GETCH LEVEL (@ AND ;)
BC
BC				00700	;THESE ROUTINES SCAN A FILE NAME AND STUFF IT IN SVNAM AND
BC				00800	;FRIENDS INDEXED BY SVPT.
BC				00900	;GETNMS BEGINS A SCAN AND DOES THE STUFF.
BC				01000	;GETNAM SCANS A FILE NAME IN WHICH THE FIRST TOKEN HAS ALREADY
BC				01100	;BEEN SCANNED.
BC
BGETNMSPUSHJPSCANC	000115'	260740	000276'	01300	GETNMS:	PUSHJ P,SCAN
BGETNAMSETZMSVNAMSVPTC	000116'	402014	000064*	01400	GETNAM: SETZM SVNAM(SVPT)       ;ZERO OUT CELLS IN CASE NOTHING
BC
BSETZMSVEXTSVPTC	000117'	402014	000066*	01600	        SETZM SVEXT(SVPT)       ;GETS PUT THERE
BSETZMSVPPNSVPTC	000120'	402014	000070*	01700	        SETZM SVPPN(SVPT)
BSETZMSWBKSSVPTC	000121'	402014	000000*	01800	        SETZM SWBKS(SVPT)
BSETZMSVDEVSVPTC	000122'	402014	000061*	01900	        SETZM SVDEV(SVPT)
BGETN1TRNNFLIDFC	000123'	606000	000020	02000	GETN1:  TRNN FL,IDF             ;WAS THE THING SCANNED AN IDENT
BJRSTTRYPP1C	000124'	254000	000242'	02100	        JRST TRYPP1     ;TRY FOR PPN
BPUSHPACCUMC	000125'	261740	000000*	02200	        PUSH P,ACCUM
BPUSHJPSCANSC	000126'	260740	000256'	02300	        PUSHJ P,SCANS   ;CHECK FOR EXT OR PPN
BCAIECC	000127'	302700	000072	02400	        CAIE C,":"      ;IS IT A DEVICE NAME
BJRSTNODEVC	000130'	254000	000146'	02500	        JRST NODEV      ;NO
BPOPPSVDEVSVPTC	000131'	262754	000122*	02600	        POP P,SVDEV(SVPT)       ;WE WERE HIDING IT IN THE STACK
BMOVSIT1C	000132'	205040	637163	02700		MOVSI T1,'SYS'
BCAMET1SVDEVSVPTC	000133'	312054	000131*	02800		CAME T1,SVDEV(SVPT)
BJRSTGETN1AC	000134'	254000	000140'	02900		JRST GETN1A
BSETZMSVDEVSVPTC	000135'	402014	000133*	03000		SETZM SVDEV(SVPT)
BMOVET1C	000136'	200040	011025'	03100		MOVE T1,[1,,4]		;CHANGE SYS: TO (SYS) TO AVOID CONFUSION
BMOVEMT1SVPPNSVPTC	000137'	202054	000120*	03200		MOVEM T1,SVPPN(SVPT)	;ABOUT WHETHER TO COMPILE
BGETN1APUSHJPSCANC	000140'	260740	000276'	03300	GETN1A:	PUSHJ P,SCAN    ;BYPASS
BPUSHJPSCANSC	000141'	260740	000256'	03400		PUSHJ P,SCANS	;PEEK AHEAD
BJUMPNCSTRYPPNC	000142'	326640	000164'	03500		JUMPN CS,TRYPPN	;CHECK FOR DELIMITER AFTER :
BPUSHJPSCANC	000143'	260740	000276'	03600		PUSHJ P,SCAN	;NO, MUST HAVE AN IDENTIFIER
BPUSHPACCUMC	000144'	261740	000125*	03700	        PUSH P,ACCUM
BPUSHJPSCANSC	000145'	260740	000256'	03800	        PUSHJ P,SCANS
BNODEVPOPPSVNAMSVPTC	000146'	262754	000116*	03900	NODEV:  POP P,SVNAM(SVPT)
BCAINCC	000147'	306700	000133	04000	        CAIN C,"["      ;IS IT PPN
BJRSTGPPNC	000150'	254000	000166'	04100	        JRST GPPN
BCAIECC	000151'	302700	000056	04200	        CAIE C,"."      ;NO, EXT?
BJRSTGTNMXC	000152'	254000	000211'	04300		JRST GTNMX	;NEITHER, RETURN
BPUSHJPSCANC	000153'	260740	000276'	04400	        PUSHJ P,SCAN    ;NO. GO OVER DOT
BPUSHJPSCANSC	000154'	260740	000256'	04500	        PUSHJ P,SCANS   ;PEEK AT NEXT CHAR
BJUMPNCSHLLOSSVEXTSVPTC				04600	        JUMPN CS,[HLLOS SVEXT(SVPT)     ;BLANK EXTENSION
BJRSTTRYPPNC	000155'	326640	011026'	04700	                JRST TRYPPN]    ;LOOK FOR PPN NEXT
BGETN2PUSHJPSCANC	000156'	260740	000276'	04800	GETN2:  PUSHJ P,SCAN    ;GET EXT
BTRNNFLIDFC	000157'	606000	000020	04900	        TRNN FL,IDF
BJRSTOUTSTRASCIZC				05000	        JRST    [OUTSTR [ASCIZ "EXTENSION EXPECTED"]
BJRSTERRCOMC	000160'	254000	011034'	05100	                JRST    ERRCOM]
BMOVET1ACCUMC	000161'	200040	000144*	05200	        MOVE T1,ACCUM
BHLLZMT1SVEXTSVPTC	000162'	512054	000117*	05300	        HLLZM T1,SVEXT(SVPT)
BPUSHJPSCANSDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 8-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	000163'	260740	000256'	05400	        PUSHJ P,SCANS
BTRYPPNCAIECC	000164'	302700	000133	05500	TRYPPN: CAIE C,"["      ;CHECK FOR PPN AGAIN
BJRSTGTNMXC	000165'	254000	000211'	05600		JRST GTNMX
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 9
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;GPPN AND TRYPP1 HANDLE [N,N] AND USER NAMES
BGPPNPUSHJPSCANC	000166'	260740	000276'	00200	GPPN:        PUSHJ P,SCAN
BGETPP2PUSHJPSCANC	000167'	260740	000276'	00300	GETPP2: PUSHJ P,SCAN
BTRNNFLIDFC	000170'	606000	000020	00400	        TRNN FL,IDF
BJRSTSYNERRC	000171'	254000	001065'	00500	        JRST SYNERR
BMOVET1ACCUMC	000172'	200040	000161*	00600	        MOVE T1,ACCUM
BPUSHJPRJUSTC	000173'	260740	000225'	00700	        PUSHJ P,RJUST   ;THIS NEED TO BE RIGHT JUSTIFIED
BHRLMT1SVPPNSVPTC	000174'	506054	000137*	00800	        HRLM T1,SVPPN(SVPT)     ;STORE LEFT HALF
BPUSHJPSCANC	000175'	260740	000276'	00900	        PUSHJ P,SCAN
BCAIECC	000176'	302700	000054	01000	        CAIE C,","
BJRSTSYNERRC	000177'	254000	001065'	01100	        JRST SYNERR
BPUSHJPSCANC	000200'	260740	000276'	01200	        PUSHJ P,SCAN
BTRNNFLIDFC	000201'	606000	000020	01300	        TRNN FL,IDF
BJRSTSYNERRC	000202'	254000	001065'	01400	        JRST SYNERR
BMOVET1ACCUMC	000203'	200040	000172*	01500	        MOVE T1,ACCUM
BPUSHJPRJUSTC	000204'	260740	000225'	01600	        PUSHJ P,RJUST
BHRRMT1SVPPNSVPTC	000205'	542054	000174*	01700	        HRRM T1,SVPPN(SVPT)
BPUSHJPSCANC	000206'	260740	000276'	01800	        PUSHJ P,SCAN
BCAIECC	000207'	302700	000135	01900	        CAIE C,"]"
BJRSTSYNERRC	000210'	254000	001065'	02000	        JRST SYNERR
BGTNMXMOVET1DEFPPNC	000211'	200040	000000*	02100	GTNMX:	MOVE T1,DEFPPN
BSKIPNSVPPNSVPTC	000212'	336014	000205*	02200		SKIPN SVPPN(SVPT)
BMOVEMT1SVPPNSVPTC	000213'	202054	000212*	02300		MOVEM T1,SVPPN(SVPT)	;USE DEFAULT PPN IF NONE GIVEN HERE
BSKIPNSVDEVSVPTC	000214'	336014	000135*	02400		SKIPN SVDEV(SVPT)
BSKIPESVEXTSVPTC	000215'	332014	000162*	02500		SKIPE SVEXT(SVPT)
BPOPJPC	000216'	263740	000000	02600		POPJ P,		;NO FUNNY STUFF IF DEV OR EXT GIVEN
BMOVSIT1C	000217'	205040	121612	02700		MOVSI T1,'*.*'
BMOVET4SVNAMSVPTC	000220'	200214	000146*	02800		MOVE T4,SVNAM(SVPT)
BCAMET4SIXBITC	000221'	312200	011036'	02900		CAME T4,[SIXBIT/ALL/]
BCAMNT4SIXBITC	000222'	316200	011037'	03000		CAMN T4,[SIXBIT/SAME/]
BMOVEMT1SVNAMSVPTC	000223'	202054	000220*	03100		MOVEM T1,SVNAM(SVPT)	;CHANGE ALL OR SAME TO *.*
BPOPJPC	000224'	263740	000000	03200		POPJ P,
BC
BIFNSTANSWC				03400	        IFN STANSW,<
BC				03500	RJUST:  TRNE T1,77
BC				03600		JRST GTNMX	;GET IT OVER THERE
BC				03700	        LSH T1,-6
BC				03800	        JRST RJUST>
BC
BIFESTANSWC				04000	IFE STANSW,<
BRJUSTPUSHPT3C	000225'	261740	000003	04100	RJUST:  PUSH    P,T3
BMOVET3T1C	000226'	200140	000001	04200	        MOVE T3,T1      ;CONVERT SIXBIT TO OCTAL
BMOVEIT1C	000227'	201040	000000	04300	        MOVEI T1,0
BCONVOCMOVEIT2C	000230'	201100	000000	04400	CONVOC: MOVEI T2,0
BLSHCT2C	000231'	246100	000006	04500	        LSHC T2,6
BCAILT2C	000232'	301100	000020	04600	        CAIL T2,20
BCAILET2C	000233'	303100	000027	04700	        CAILE T2,27
BJRSTSYNERRC	000234'	254000	001065'	04800	        JRST SYNERR
BLSHT1C	000235'	242040	000003	04900	        LSH T1,3
BIORIT1T2C	000236'	435042	777760	05000	        IORI T1,-20(T2)
BJUMPNT3CONVOCC	000237'	326140	000230'	05100	        JUMPN T3,CONVOC
BPOPPT3C	000240'	262740	000003	05200	        POP     P,T3
BPOPJPC	000241'	263740	000000	05300		POPJ P,
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 9-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				05400	>
BC
BTRYPP1CAINCC	000242'	306700	000133	05600	TRYPP1: CAIN    C,"["
BJRSTGETPP2C	000243'	254000	000167'	05700	        JRST    GETPP2
BCAIECC	000244'	302700	000050	05800	        CAIE    C,"("
BJRSTGTNMXC	000245'	254000	000211'	05900		JRST	GTNMX
BPUSHJPGTUNOC	000246'	260740	006036'	06000	        PUSHJ   P,GTUNO
BMOVEMT3SVPPNSVPTC	000247'	202154	000213*	06100	        MOVEM   T3,SVPPN(SVPT)
BCAIECC	000250'	302700	000051	06200	        CAIE    C,")"
BJRSTSYNERRC	000251'	254000	001065'	06300	        JRST    SYNERR
BPUSHJPSCANSC	000252'	260740	000256'	06400	        PUSHJ   P,SCANS
BJUMPNCSGTNMXC	000253'	326640	000211'	06500		JUMPN	CS,GTNMX	;ALL DONE ON TERMINATOR
BPUSHJPSCANC	000254'	260740	000276'	06600	        PUSHJ   P,SCAN
BJRSTGETN1C	000255'	254000	000123'	06700	        JRST    GETN1   ;CONT. WITH FILE NAME
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 10
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;SCANS PEEKS AHEAD AT THE NEXT COMMAND CHARACTER, SKIPPING OVER
BC				00200	;MULTIPLE BLANKS. RETURNS C=CS=0 IF CHAR=LEGAL IN NAME,
BC				00300	;ELSE C=CHAR, CS=CHAR+FLAGS
BC
BSCANSMOVNIT1C	000256'	211040	000001	00500	SCANS: MOVNI T1,1      ;FLAG AS NOTHING SEEN YET
BSKIPNCSSAVCHRC	000257'	336640	000000*	00600	        SKIPN CS,SAVCHR ;CHARACTER WAITING?
BSCNS2PUSHJPGETCHC	000260'	260740	000342'	00700	SCNS2:  PUSHJ P,GETCH
BJUMPNCSSCNS1C	000261'	326640	000264'	00800	        JUMPN CS,SCNS1  ;FOUND SOMETHING
BMOVEIT1C	000262'	201040	000000	00900	        MOVEI T1,0
BJRSTSCNS2C	000263'	254000	000260'	01000	        JRST SCNS2
BSCNS1JUMPLCSSCNS4C	000264'	321640	000273'	01100	SCNS1:  JUMPL CS,SCNS4  ;SPECIAL CHARACTER
BMOVEMCSSAVCHRC	000265'	202640	000257*	01200	        MOVEM CS,SAVCHR ;SAVE THAT CHARACTER
BJUMPLT1SCNS3C	000266'	321040	000272'	01300	        JUMPL T1,SCNS3  ;DO NOTHING ELSE IF NO BLANKS SEEN
BMOVEMT1SAVCHRC	000267'	202040	000265*	01400	        MOVEM T1,SAVCHR ;IF BLANKS SEEN, SAVE ONE
BMOVSIT1C	000270'	205040	070000	01500	        MOVSI T1,70000
BADDMT1GETB3IOPNTC	000271'	272066	000634'	01600	        ADDM T1,@GETB3(IOPNT)   ;AND BACK UP POINTER
BSCNS3TDZACSCSC	000272'	634640	000015	01700	SCNS3:  TDZA CS,CS      ;IN EITHER CASE, RETURN 0
BSCNS4MOVEMCSSAVCHRC	000273'	202640	000267*	01800	SCNS4:  MOVEM CS,SAVCHR ;SAVE SPECIAL CHARACTER
BHRRZCCSC	000274'	550700	000015	01900	        HRRZ C,CS               ;GET A CHARACTER TO RETURN
BPOPJPC	000275'	263740	000000	02000	        POPJ P,
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 11
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;SCAN RETURNS THE NEXT TOKEN IN THE COMMAND STRING. IF TOKEN=
BC				00200	;NAME OR NUMBER, C=CS=0, ACCUM=SIXBIT NAME, NUMAC=DECIMAL VALUE
BC				00300	;IF NUMBER. IF TOKEN=SPECIAL CHARACTER, C=CHAR, CS=CHAR+FLAGS.
BC				00400	;LEADING BLANKS ARE IGNORED.
BC
BSCANTRZFLIDFNUMFSC	000276'	620000	000120	00600	SCAN:  TRZ FL,IDF!NUMFS        ;RESET IN CASE NOT
BSKIPNCSSAVCHRC	000277'	336640	000273*	00700	        SKIPN CS,SAVCHR ;WAS THERE SOMETHING LEFT OVER
BCONSNPUSHJPGETCHC	000300'	260740	000342'	00800	CONSN:  PUSHJ P,GETCH   ;NO, GET ANOTHER
BJUMPECSC	000301'	322640	000300'	00900	        JUMPE CS,.-1    ;IGNORE BLANKS
BJUMPLCSSPCHRC	000302'	321640	000321'	01000	        JUMPL CS,SPCHR  ;IS IT A SPECIAL CHARACTER
BSETZMACCUMC	000303'	402000	000203*	01100	        SETZM ACCUM     ;PREPARE TO STORE IT
BMOVET1POINTACCUMC	000304'	200040	011040'	01200	        MOVE T1,[POINT 6,ACCUM]
BTROFLIDFNUMFSC	000305'	660000	000120	01300	        TRO FL,IDF!NUMFS        ;SAY ID AND FOR NOW A NUMBER
BTLNECSNUMFC	000306'	603640	100000	01400	        TLNE CS,NUMF    ;IS IT A NUMBER??
BJRSTSCNUMC	000307'	254000	000326'	01500	        JRST SCNUM      ;YES, GO SCAN IT
BSCAN1TLNET1C	000310'	603040	770000	01600	SCAN1:  TLNE T1,770000  ;ALL SIX STORED?
BIDPBCST1C	000311'	136640	000001	01700	        IDPB CS,T1      ;NO, STORE ANOTHER
BPUSHJPGETCHC	000312'	260740	000342'	01800	        PUSHJ P,GETCH   ;GET NEXT
BJUMPGCSSCAN1C	000313'	327640	000310'	01900	        JUMPG CS,SCAN1  ;ANOTHER ALPHA
BTRZFLNUMFSC	000314'	620000	000100	02000	        TRZ FL,NUMFS    ;THIS WAS NOT A NUMBER
BSCAN2MOVEMCSSAVCHRC	000315'	202640	000277*	02100	SCAN2:  MOVEM CS,SAVCHR
BMOVEICC	000316'	201700	000000	02200	        MOVEI C,0       ;TO AVOID CONFUSION
BMOVEICSC	000317'	201640	000000	02300	        MOVEI CS,0
BPOPJPC	000320'	263740	000000	02400	        POPJ P,
BSPCHRHRRZCCSC	000321'	550700	000015	02500	SPCHR:  HRRZ C,CS       ;RETURN HIM THE HALF OF IT
BSETZMSAVCHRC	000322'	402000	000315*	02600	        SETZM SAVCHR    ;NOTHING SAVED BY NOW
BTLNNCSSPACTC	000323'	607640	040000	02700	        TLNN CS,SPACT   ;DO WE WANT SPECIAL ACTION?
BPOPJPC	000324'	263740	000000	02800	        POPJ P,         ;NO
BJRSTCSC	000325'	254015	000000	02900	        JRST (CS)       ;YES, RH IS DISPATCH
BSCNUMSETZMNUMACNUMACC	000326'	402000	000000*	03000	SCNUM:  SETZM NUMAC#    ;THE NUMBER ACCUMULATOR
BSCNUM1TLNET1C	000327'	603040	770000	03100	SCNUM1: TLNE T1,770000  ;SAVE DIGITS IN SIXBIT IN CASE FILE NAME
BIDPBCST1C	000330'	136640	000001	03200	        IDPB CS,T1
BMOVEICC	000331'	201700	000012	03300	        MOVEI C,^D10
BIMULCNUMACC	000332'	220700	000326*	03400	        IMUL C,NUMAC
BADDICCSC	000333'	271715	777760	03500	        ADDI C,-20(CS)  ;ADD IN THE NUMBER
BMOVEMCNUMACC	000334'	202700	000332*	03600	        MOVEM C,NUMAC
BPUSHJPGETCHC	000335'	260740	000342'	03700	        PUSHJ P,GETCH
BJUMPLECSSCAN2C	000336'	323640	000315'	03800	        JUMPLE CS,SCAN2 ;END OF NUMBER (SPECIAL CHR) GET OUT
BTLNECSNUMFC	000337'	603640	100000	03900	        TLNE CS,NUMF    ;IS IT PART OF A NUMBER?
BJRSTSCNUM1C	000340'	254000	000327'	04000	        JRST SCNUM1     ;YES, GO ON
BJRSTSCAN1C	000341'	254000	000310'	04100	        JRST SCAN1      ;SCAN REST OF IDENT (NUMFS TURNED OFF AT SCAN2-1)
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 12
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;GETCH RETURNS 7-BIT ASCII CHAR IN C, TABLE ENTRY IN CS
BC
BGETCHSOSLEGETB1IOPNTC	000342'	373026	000620'	00300	GETCH:  SOSLE @GETB1(IOPNT)     ;USE CORRECT BUFFER HEADER
BJRSTOKPICKC	000343'	254000	000352'	00400	        JRST OKPICK
BIFNTEMPMOVECTMPFLGIOPNTC	000344'	200706	000000*	00500	IFN TEMP,<      MOVE C,TMPFLG(IOPNT)    ;IS TMPCOR BEING USED
BCAMNCC	000345'	316700	011041'	00600	        CAMN C,[-1]             ;SET TO -1 IF YES
BJRSTSETZMTMPFLGIOPNTC				00700	        JRST [SETZM TMPFLG(IOPNT)       ;CLEAR TMPFLAG
BJRSTPOPFILC	000346'	254000	011042'	00800	                JRST POPFIL+1]          ;YES FINISHED WITH THIS READ>
BXCTGETB2IOPNTC	000347'	256006	000626'	00900	        XCT GETB2(IOPNT)        ;AN IN UUO
BSKIPAC	000350'	334000	000000	01000	        SKIPA
BJRSTERREOFC	000351'	254000	000374'	01100	        JRST ERREOF     ;WAS AN ERROR OR EOF, GO CHECK
BOKPICKIBPGETB3IOPNTC	000352'	133026	000634'	01200	OKPICK: IBP @GETB3(IOPNT)
BMOVECGETB3IOPNTC	000353'	200726	000634'	01300	        MOVE C,@GETB3(IOPNT)    ;PICK UP THE NEW BYTE POINTER
BMOVECSCC	000354'	200656	000000	01400	        MOVE CS,(C)     ;GET THE WORD IT CAME FROM
BTRNECSC	000355'	602640	000001	01500	        TRNE CS,1       ;AND CHECK FOR SEQ NUM
BJRSTAOSGETB3IOPNTC				01600	        JRST    [AOS @GETB3(IOPNT)      ;ADVANCE POINTER
BMOVNICSC				01700	                MOVNI CS,5      ;AND ADJUST COUNT
BADDBCSGETB1IOPNTC				01800	                ADDB CS,@GETB1(IOPNT)
BSKIPGCSC				01900	                SKIPG CS        ;CHECK FOR BUFFER OVERRUN
BPUSHJPGETCHC				02000	                PUSHJ P,GETCH   ;GET RID OF TAB
BJRSTGETCHC	000356'	254000	011044'	02100	                JRST GETCH]
BLDBCGETB3IOPNTC	000357'	135726	000634'	02200	        LDB C,@GETB3(IOPNT)
BJUMPECGETCHC	000360'	322700	000342'	02300	        JUMPE C,GETCH   ;IGNORE NULLS
BIDPBCERBFPTC	000361'	136700	000000*	02400		IDPB	C,ERBFPT	;SAVE CHAR FOR ERROR PRINTER
BMOVECSERBFPTC	000362'	200640	000361*	02500		MOVE	CS,ERBFPT
BCAMECSPOINTERRBUFC	000363'	312640	011052'	02600		CAME	CS,[POINT 7,ERRBUF+3,34]
BJRSTC	000364'	254000	000367'	02700		JRST	.+3
BMOVECSPOINTERRBUFC	000365'	200640	011053'	02800		MOVE	CS,[POINT 7,ERRBUF]
BMOVEMCSERBFPTC	000366'	202640	000362*	02900		MOVEM	CS,ERBFPT	;RESET IF AT END
BEOFRTMOVECSCTBLCC	000367'	200656	000405'	03000	EOFRT:  MOVE CS,CTBL(C) ;GET STATUS BITS
BEOFRT1TRNNFLINPRNTC	000370'	606000	004000	03100	EOFRT1: TRNN FL,INPRNT  ;IF PRINTING ERROR, DO NOT NEST
BTLNNCSSPACT2C	000371'	607640	020000	03200	        TLNN CS,SPACT2  ;SPECIAL?
BPOPJPC	000372'	263740	000000	03300	        POPJ P,
BJRSTCSC	000373'	254015	000000	03400	        JRST (CS)       ;DO IT
BC
BERREOFXCTGETB4IOPNTC	000374'	256006	000642'	03600	ERREOF: XCT GETB4(IOPNT)        ;TO A STATZ
BJRSTREADERC	000375'	254000	001063'	03700	        JRST READER     ;AN INPUT ERROR
BJRSTPOPFILC	000376'	254000	000752'	03800	        JRST POPFIL     ;GO GET PREVIOUS FILE
BSEMICTROFLINPRNTC	000377'	660000	004000	03900	SEMIC:  TRO FL,INPRNT   ;GO GET RID OF GETCH SPECIAL ACTION
BSEMIC1PUSHJPGETCHC	000400'	260740	000342'	04000	SEMIC1: PUSHJ P,GETCH   ;READ CHRS
BCAIECC	000401'	302700	000012	04100	        CAIE C,12       ;UNTIL A LINE FEED
BJRSTSEMIC1C	000402'	254000	000400'	04200	        JRST SEMIC1
BTRZFLINPRNTC	000403'	620000	004000	04300	        TRZ FL,INPRNT   ;GET RID OF FLAG
BJRSTGETCHC	000404'	254000	000342'	04400	        JRST GETCH      ;AND READ A CHR
BCTBLDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 13
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	000405'	000000	000000	00100	CTBL:  0
BREPEATC				00200	REPEAT 10,<XWD SPCF,.-CTBL>
BXWDSPCFCTBLC	000406'	400000	000001		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000407'	400000	000002		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000410'	400000	000003		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000411'	400000	000004		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000412'	400000	000005		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000413'	400000	000006		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000414'	400000	000007		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000415'	400000	000010		XWD SPCF,.-CTBL
BC	000416'	000000	000000	00300	        0               ;TAB
BXWDSPCFSPACTTERMFCHKTRMC	000417'	640012	000605'	00400	        XWD SPCF!SPACT!TERMF+12,CHKTRM
BXWDSPCFC	000420'	400000	000013	00500	        XWD SPCF,13
BC	000421'	000000	000000	00600	        0       ;IGNORE FORM FEEDS
BC	000422'	000000	000000	00700	        0               ;CARRET
BREPEATC				00800	REPEAT 15,<XWD SPCF,.-CTBL>
BXWDSPCFCTBLC	000423'	400000	000016		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000424'	400000	000017		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000425'	400000	000020		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000426'	400000	000021		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000427'	400000	000022		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000430'	400000	000023		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000431'	400000	000024		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000432'	400000	000025		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000433'	400000	000026		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000434'	400000	000027		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000435'	400000	000030		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000436'	400000	000031		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000437'	400000	000032		XWD SPCF,.-CTBL
BXWDSPCFTERMFSPACTCHKTRMC	000440'	640044	000605'	00900	        XWD SPCF!TERMF!SPACT+44,CHKTRM
BREPEATC				01000	REPEAT 4,<XWD SPCF,.-CTBL>
BXWDSPCFCTBLC	000441'	400000	000034		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000442'	400000	000035		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000443'	400000	000036		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000444'	400000	000037		XWD SPCF,.-CTBL
BC	000445'	000000	000000	01100	        0               ;SPACE
BREPEATC				01200	        REPEAT 2,<XWD SPCF,.-CTBL>
BXWDSPCFCTBLC	000446'	400000	000041		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000447'	400000	000042		XWD SPCF,.-CTBL
BC	000450'	000000	000003	01300	        3       ;# FOR SPECIAL IN DIR COMMAND
BREPEATC				01400	REPEAT 6,<XWD SPCF,.-CTBL>
BXWDSPCFCTBLC	000451'	400000	000044		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000452'	400000	000045		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000453'	400000	000046		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000454'	400000	000047		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000455'	400000	000050		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000456'	400000	000051		XWD SPCF,.-CTBL
BC	000457'	000000	000012	01500	12
BREPEATC				01600	REPEAT 2,<XWD SPCF,.-CTBL>
BXWDSPCFCTBLC	000460'	400000	000053		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000461'	400000	000054		XWD SPCF,.-CTBL
BXWDSPCFNUMFCTBLC	000462'	500000	000055	01700	XWD SPCF!NUMF,.-CTBL    ;ALLOW %-B IN LOADER SWITCHES
BREPEATC				01800	REPEAT 2,<XWD SPCF,.-CTBL>
BXWDSPCFCTBLDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 13-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	000463'	400000	000056		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000464'	400000	000057		XWD SPCF,.-CTBL
BREPEATC				01900	REPEAT 12,<XWD NUMF,.-CTBL-40           ;DIGIT>
BXWDNUMFCTBLC	000465'	100000	000020		XWD NUMF,.-CTBL-40           ;DIGIT
BXWDNUMFCTBLC	000466'	100000	000021		XWD NUMF,.-CTBL-40           ;DIGIT
BXWDNUMFCTBLC	000467'	100000	000022		XWD NUMF,.-CTBL-40           ;DIGIT
BXWDNUMFCTBLC	000470'	100000	000023		XWD NUMF,.-CTBL-40           ;DIGIT
BXWDNUMFCTBLC	000471'	100000	000024		XWD NUMF,.-CTBL-40           ;DIGIT
BXWDNUMFCTBLC	000472'	100000	000025		XWD NUMF,.-CTBL-40           ;DIGIT
BXWDNUMFCTBLC	000473'	100000	000026		XWD NUMF,.-CTBL-40           ;DIGIT
BXWDNUMFCTBLC	000474'	100000	000027		XWD NUMF,.-CTBL-40           ;DIGIT
BXWDNUMFCTBLC	000475'	100000	000030		XWD NUMF,.-CTBL-40           ;DIGIT
BXWDNUMFCTBLC	000476'	100000	000031		XWD NUMF,.-CTBL-40           ;DIGIT
BXWDSPCFCTBLC	000477'	400000	000072	02000	        XWD SPCF,.-CTBL ;:
BXWDSPCFSPACT2SEMICC	000500'	420073	000377'	02100	        XWD SPCF!SPACT2+";",SEMIC       ;;
BREPEATC				02200	REPEAT 3,<XWD SPCF,.-CTBL>
BXWDSPCFCTBLC	000501'	400000	000074		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000502'	400000	000075		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000503'	400000	000076		XWD SPCF,.-CTBL
BC	000504'	000000	000037	02300	37                      ;ALLOW QUESTION MARK AS WILD CHARACTER
BXWDSPCFSPACT2NESTC	000505'	420100	000650'	02400	        XWD SPCF!SPACT2+"@",NEST
BREPEATC				02500	REPEAT 32,<EXP .-CTBL-40                ;UPPER CASE LETTERS>
BEXPCTBLC	000506'	000000	000041		EXP .-CTBL-40                ;UPPER CASE LETTERS
BEXPCTBLC	000507'	000000	000042		EXP .-CTBL-40                ;UPPER CASE LETTERS
BEXPCTBLC	000510'	000000	000043		EXP .-CTBL-40                ;UPPER CASE LETTERS
BEXPCTBLC	000511'	000000	000044		EXP .-CTBL-40                ;UPPER CASE LETTERS
BEXPCTBLC	000512'	000000	000045		EXP .-CTBL-40                ;UPPER CASE LETTERS
BEXPCTBLC	000513'	000000	000046		EXP .-CTBL-40                ;UPPER CASE LETTERS
BEXPCTBLC	000514'	000000	000047		EXP .-CTBL-40                ;UPPER CASE LETTERS
BEXPCTBLC	000515'	000000	000050		EXP .-CTBL-40                ;UPPER CASE LETTERS
BEXPCTBLC	000516'	000000	000051		EXP .-CTBL-40                ;UPPER CASE LETTERS
BEXPCTBLC	000517'	000000	000052		EXP .-CTBL-40                ;UPPER CASE LETTERS
BEXPCTBLC	000520'	000000	000053		EXP .-CTBL-40                ;UPPER CASE LETTERS
BEXPCTBLC	000521'	000000	000054		EXP .-CTBL-40                ;UPPER CASE LETTERS
BEXPCTBLC	000522'	000000	000055		EXP .-CTBL-40                ;UPPER CASE LETTERS
BEXPCTBLC	000523'	000000	000056		EXP .-CTBL-40                ;UPPER CASE LETTERS
BEXPCTBLC	000524'	000000	000057		EXP .-CTBL-40                ;UPPER CASE LETTERS
BEXPCTBLC	000525'	000000	000060		EXP .-CTBL-40                ;UPPER CASE LETTERS
BEXPCTBLC	000526'	000000	000061		EXP .-CTBL-40                ;UPPER CASE LETTERS
BEXPCTBLC	000527'	000000	000062		EXP .-CTBL-40                ;UPPER CASE LETTERS
BEXPCTBLC	000530'	000000	000063		EXP .-CTBL-40                ;UPPER CASE LETTERS
BEXPCTBLC	000531'	000000	000064		EXP .-CTBL-40                ;UPPER CASE LETTERS
BEXPCTBLC	000532'	000000	000065		EXP .-CTBL-40                ;UPPER CASE LETTERS
BEXPCTBLC	000533'	000000	000066		EXP .-CTBL-40                ;UPPER CASE LETTERS
BEXPCTBLC	000534'	000000	000067		EXP .-CTBL-40                ;UPPER CASE LETTERS
BEXPCTBLC	000535'	000000	000070		EXP .-CTBL-40                ;UPPER CASE LETTERS
BEXPCTBLC	000536'	000000	000071		EXP .-CTBL-40                ;UPPER CASE LETTERS
BEXPCTBLC	000537'	000000	000072		EXP .-CTBL-40                ;UPPER CASE LETTERS
BREPEATC				02600	REPEAT 6,<XWD SPCF,.-CTBL>
BXWDSPCFCTBLC	000540'	400000	000133		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000541'	400000	000134		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000542'	400000	000135		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000543'	400000	000136		XWD SPCF,.-CTBL
BXWDSPCFCTBLDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 13-3
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	000544'	400000	000137		XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000545'	400000	000140		XWD SPCF,.-CTBL
BREPEATC				02700	REPEAT 32,<EXP .-CTBL-100               ;LOWER CASE LETTERS>
BEXPCTBLC	000546'	000000	000041		EXP .-CTBL-100               ;LOWER CASE LETTERS
BEXPCTBLC	000547'	000000	000042		EXP .-CTBL-100               ;LOWER CASE LETTERS
BEXPCTBLC	000550'	000000	000043		EXP .-CTBL-100               ;LOWER CASE LETTERS
BEXPCTBLC	000551'	000000	000044		EXP .-CTBL-100               ;LOWER CASE LETTERS
BEXPCTBLC	000552'	000000	000045		EXP .-CTBL-100               ;LOWER CASE LETTERS
BEXPCTBLC	000553'	000000	000046		EXP .-CTBL-100               ;LOWER CASE LETTERS
BEXPCTBLC	000554'	000000	000047		EXP .-CTBL-100               ;LOWER CASE LETTERS
BEXPCTBLC	000555'	000000	000050		EXP .-CTBL-100               ;LOWER CASE LETTERS
BEXPCTBLC	000556'	000000	000051		EXP .-CTBL-100               ;LOWER CASE LETTERS
BEXPCTBLC	000557'	000000	000052		EXP .-CTBL-100               ;LOWER CASE LETTERS
BEXPCTBLC	000560'	000000	000053		EXP .-CTBL-100               ;LOWER CASE LETTERS
BEXPCTBLC	000561'	000000	000054		EXP .-CTBL-100               ;LOWER CASE LETTERS
BEXPCTBLC	000562'	000000	000055		EXP .-CTBL-100               ;LOWER CASE LETTERS
BEXPCTBLC	000563'	000000	000056		EXP .-CTBL-100               ;LOWER CASE LETTERS
BEXPCTBLC	000564'	000000	000057		EXP .-CTBL-100               ;LOWER CASE LETTERS
BEXPCTBLC	000565'	000000	000060		EXP .-CTBL-100               ;LOWER CASE LETTERS
BEXPCTBLC	000566'	000000	000061		EXP .-CTBL-100               ;LOWER CASE LETTERS
BEXPCTBLC	000567'	000000	000062		EXP .-CTBL-100               ;LOWER CASE LETTERS
BEXPCTBLC	000570'	000000	000063		EXP .-CTBL-100               ;LOWER CASE LETTERS
BEXPCTBLC	000571'	000000	000064		EXP .-CTBL-100               ;LOWER CASE LETTERS
BEXPCTBLC	000572'	000000	000065		EXP .-CTBL-100               ;LOWER CASE LETTERS
BEXPCTBLC	000573'	000000	000066		EXP .-CTBL-100               ;LOWER CASE LETTERS
BEXPCTBLC	000574'	000000	000067		EXP .-CTBL-100               ;LOWER CASE LETTERS
BEXPCTBLC	000575'	000000	000070		EXP .-CTBL-100               ;LOWER CASE LETTERS
BEXPCTBLC	000576'	000000	000071		EXP .-CTBL-100               ;LOWER CASE LETTERS
BEXPCTBLC	000577'	000000	000072		EXP .-CTBL-100               ;LOWER CASE LETTERS
BXWDSPCFCTBLC	000600'	400000	000173	02800	        XWD SPCF,.-CTBL
BXWDSPCFCTBLC	000601'	400000	000174	02900	        XWD SPCF,.-CTBL
BXWDSPCFTERMFSPACTCHKTRMC	000602'	640044	000605'	03000	        XWD SPCF!TERMF!SPACT+44,CHKTRM
BXWDSPCFTERMFSPACTCHKTRMC	000603'	640044	000605'	03100	        XWD SPCF!TERMF!SPACT+44,CHKTRM
BXWDSPCFSPACTPOPFILC	000604'	440000	000752'	03200	        XWD SPCF!SPACT,POPFIL
BCTBLCOMMADRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 14
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC			000461'	00100	COMMA==CTBL+","
BC
BCHKTRMPUSHPCSC	000605'	261740	000015	00300	CHKTRM: PUSH P,CS       ;SAVE MAGIC BITS
BTERMC1PUSHJPGETCHC	000606'	260740	000342'	00400	TERMC1: PUSHJ P,GETCH
BJUMPECSTERMC1C	000607'	322640	000606'	00500	        JUMPE CS,TERMC1 ;ALSO IGNORE TABS AND SPACES
BTLNECSTERMFC	000610'	603640	200000	00600	        TLNE CS,TERMF
BJRSTTERMC1C	000611'	254000	000606'	00700	        JRST TERMC1     ;BYPASS TERMINATORS
BCAMNCSCOMMAC	000612'	316640	000461'	00800	        CAMN CS,COMMA   ;CHECK FOR , AFTER CRET
BJRSTPOPPPC				00900	        JRST    [POP P,(P)      ;GET STACK IN SYNC
BPOPJPC	000613'	254000	011054'	01000	                POPJ P,]        ;RETURN THE COMMA
BMOVEMCSSAVCHRC	000614'	202640	000322*	01100	        MOVEM CS,SAVCHR ;SAVE FOR LATER
BPOPPCSC	000615'	262740	000015	01200	        POP P,CS
BMOVEICC	000616'	201700	000000	01300	        MOVEI C,0       ;AS GOOD AS ANYTHING ELSE
BPOPJPC	000617'	263740	000000	01400	        POPJ P,
BC
BDEFINEQQC				01600	DEFINE QQ<
BC				01700	N=1
BC				01800	REPEAT NESTDP+1,<MAC(\N)
BC				01900	        N=N+1>>
BC
BGETB1DINCTDINCTC	000620'	000000	000000*	02100	GETB1:  DINCT
BDEFINEMACC				02200	DEFINE MAC(X)<IBUF'X+2>
BQQC				02300	QQ^
BNREPEATNESTDPMACNIBUF1IBUF1C	000621'	000000	000000*		MAC(\N)^IBUF1+2^
BNNMACNIBUF2IBUF2C	000622'	000000	000000*		MAC(\N)^IBUF2+2^
BNNMACNIBUF3IBUF3C	000623'	000000	000000*		MAC(\N)^IBUF3+2^
BNNMACNIBUF4IBUF4C	000624'	000000	000000*		MAC(\N)^IBUF4+2^
BNNMACNIBUF5IBUF5C	000625'	000000	000000*		MAC(\N)^IBUF5+2^
BNNGETB2HALTC	000626'	254200	000000	02400	GETB2:  HALT
BDEFINEMACC				02500	DEFINE MAC(X)<IN X,0>
BQQC				02600	QQ^
BNREPEATNESTDPMACNINC	000627'	056040	000000		MAC(\N)^IN 1,0^
BNNMACNINC	000630'	056100	000000		MAC(\N)^IN 2,0^
BNNMACNINC	000631'	056140	000000		MAC(\N)^IN 3,0^
BNNMACNINC	000632'	056200	000000		MAC(\N)^IN 4,0^
BNNMACNINC	000633'	056240	000000		MAC(\N)^IN 5,0^
BNNGETB3DINPTDINPTC	000634'	000000	000000*	02700	GETB3:  DINPT
BDEFINEMACC				02800	DEFINE MAC(X)<IBUF'X+1>
BQQC				02900	QQ^
BNREPEATNESTDPMACNIBUF1IBUF1C	000635'	000000	000000*		MAC(\N)^IBUF1+1^
BNNMACNIBUF2IBUF2C	000636'	000000	000000*		MAC(\N)^IBUF2+1^
BNNMACNIBUF3IBUF3C	000637'	000000	000000*		MAC(\N)^IBUF3+1^
BNNMACNIBUF4IBUF4C	000640'	000000	000000*		MAC(\N)^IBUF4+1^
BNNMACNIBUF5IBUF5C	000641'	000000	000000*		MAC(\N)^IBUF5+1^
BNNGETB4HALTC	000642'	254200	000000	03000	GETB4:  HALT
BDEFINEMACC				03100	DEFINE MAC(X)<STATZ X,740000>
BQQC				03200	QQ^
BNREPEATNESTDPMACNSTATZC	000643'	063040	740000		MAC(\N)^STATZ 1,740000^
BNNMACNSTATZC	000644'	063100	740000		MAC(\N)^STATZ 2,740000^
BNNMACNSTATZC	000645'	063140	740000		MAC(\N)^STATZ 3,740000^
BNNMACNSTATZC	000646'	063200	740000		MAC(\N)^STATZ 4,740000^
BNNMACNSTATZC	000647'	063240	740000		MAC(\N)^STATZ 5,740000^
BNNC
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 14-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				03400	;NEXT HANDLES THE @ CONSTRUCTION AND IMPLIED COMMANDS (-LOA<CR>).
BC				03500	;IT SAVES THE CURRENT SCANNER STATUS AND GOES TO THE COMMAND
BC				03600	;FILE SO THAT COMMAND FILES MAY BE NESTED
BC
BNESTPUSHPACCUMC	000650'	261740	000303*	03800	NEST:   PUSH P,ACCUM    ;SAVE STATE OF SCANNER
BPUSHPFLC	000651'	261740	000000	03900	        PUSH P,FL       ;SAVE THE FLAGS (AS IDF?)
BPUSHPT1C	000652'	261740	000001	04000	        PUSH P,T1
BSETZMSAVCHRC	000653'	402000	000614*	04100	        SETZM SAVCHR
BPUSHPNAMEC	000654'	261740	000032*	04200	        PUSH P,NAME     ;AND THIS OTHER STUFF
BPUSHPNAMEC	000655'	261740	000016*	04300	        PUSH P,NAME+1
BPUSHPNAMEC	000656'	261740	000000*	04400	        PUSH P,NAME+2
BPUSHPNAMEC	000657'	261740	000020*	04500	        PUSH P,NAME+3
BAOBJPSVPTTMNERC	000660'	252600	001051'	04600	        AOBJP SVPT,TMNER        ;GET A CLEAR SPACE FOR NAME
BPUSHJPGETNMSC	000661'	260740	000115'	04700		PUSHJ P,GETNMS
BAOBJPIOPNTNESTTDC	000662'	252300	001067'	04800	        AOBJP IOPNT,NESTTD      ;TOO DEEP?
BPUSHIOPSAVCHRC	000663'	261340	000653*	04900	        PUSH IOP,SAVCHR
BSETZMSAVCHRC	000664'	402000	000663*	05000	        SETZM   SAVCHR
BPUSHJPCHKRMC	000665'	260740	001450'	05100	        PUSHJ P,CHKRM           ;GET BUFFER SPACE
BRENESTC	000666'			05200	RENEST:
BIFNTEMPC				05300	IFN TEMP,<
BMOVSCSVEXTSVPTC	000666'	204714	000215*	05400		MOVS C,SVEXT(SVPT)
BCAIECC	000667'	302700	645560	05500		CAIE C,'TMP'
BJRSTNOTMPC	000670'	254000	000714'	05600		JRST NOTMP	;FORGET ABOUT TMPCOR IF NOT .TMP
BMOVECJOBFFC	000671'	200700	000000*	05700		MOVE C,JOBFF	;GET START OF BUFFER
BMOVEMCBUFTABIOPNTC	000672'	202706	000000*	05800	        MOVEM C,BUFTAB(IOPNT)   ;SAVE IT FOR RELEASING INFO
BMOVEMCTMPFILC	000673'	202700	000000*	05900	        MOVEM C,TMPFIL+1        ;SAVE IOWD FOR TMPCOR UUO
BMOVEMCGETB3IOPNTC	000674'	202726	000634'	06000	        MOVEM C,@GETB3(IOPNT)   ;DUMMY UP BYTE POINTER
BSOSTMPFILC	000675'	370000	000673*	06100	        SOS TMPFIL+1            ;MAKE TMPFIL INTO CORRECT IOWD FORMAT
BMOVNICC	000676'	211700	000200	06200	        MOVNI C,200             ;GET BUFFER LENGTH
BHRLMCTMPFILC	000677'	506700	000675*	06300	        HRLM C,TMPFIL+1         ;STORE NEGATIVE WORD COUNT
BMOVECSVNAMSVPTC	000700'	200714	000223*	06400	        MOVE C,SVNAM(SVPT)      ;PICK UP FILNAM
BHRLZMCTMPFILC	000701'	516700	000000*	06500	        HRLZM C,TMPFIL  ;STORE RIGHT THREE LETTERS
BMOVECXWDTMPFILC	000702'	200700	011056'	06600	        MOVE C,[XWD 1,TMPFIL]   ;SET UP FOR TMPCOR READ
BTMPCORCC	000703'	047700	000044	06700	        TMPCOR  C,              ;READ FILE AND DON'T DELETE
BJRSTNOTMPC	000704'	254000	000714'	06800	        JRST NOTMP              ;NO SUCH FILE, TRY THE DISK
BSETOMTMPFLGIOPNTC	000705'	476006	000344*	06900	        SETOM TMPFLG(IOPNT)     ;FLAG THAT TMPCOR READ WAS DONE
BIMULICC	000706'	221700	000005	07000	        IMULI C,5               ;CALCULATE CHARACTER COUNT
BADDICC	000707'	271700	000001	07100	        ADDI    C,1             ;ADJUST FOR BOUNDARY CONDITION
BMOVEMCGETB1IOPNTC	000710'	202726	000620'	07200	        MOVEM C,@GETB1(IOPNT)   ;STORE IN BUFFER HEADER
BMOVEICC	000711'	201700	440700	07300	        MOVEI C,440700          ;SET UP BYTE POINTER
BHRLMCGETB3IOPNTC	000712'	506726	000634'	07400	        HRLM C,@GETB3(IOPNT)    ;BUFFER HEADER FINALLY SET UP
BJRSTNEXT2C	000713'	254000	000740'	07500	        JRST NEXT2              ;CONTINUE INTO MAIN STREAM
BNOTMPC	000714'			07600	NOTMP:                  >
BSETZMOPENBC	000714'	402000	000000*	07700	        SETZM   OPENB
BMOVSICSIXBITC	000715'	205700	446353	07800	        MOVSI   C,(SIXBIT /DSK/)
BMOVEMCOPENBC	000716'	202700	000000*	07900	        MOVEM   C,OPENB+1
BMOVECNESTBIOPNTC	000717'	200706	000762'	08000	        MOVE C,NESTB(IOPNT)     ;GET BUFFER POINTER
BMOVEMCOPENBC	000720'	202700	000000*	08100	        MOVEM C,OPENB+2
BMOVECOPENOPENBC	000721'	200700	011057'	08200	        MOVE    C,[OPEN .-.,OPENB]
BDPBIOPNTPOINTCC	000722'	137300	011060'	08300	        DPB IOPNT,[POINT 4,C,12]
BXCTCC	000723'	256000	000016	08400	        XCT     C
BJRSTDSKNAC	000724'	254000	001053'	08500	        JRST DSKNA      ;LOSE BIG
BMOVECJOBFFDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 15
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	000725'	200700	000671*	00100	       MOVE C,JOBFF
BMOVEMCBUFTABIOPNTC	000726'	202706	000672*	00200	        MOVEM C,BUFTAB(IOPNT)   ;SAVE THE PLACE PUT
BXCTINTABIOPNTC	000727'	256006	000770'	00300	        XCT INTAB(IOPNT)        ;DO AN INBUFF
BMOVECSVNAMSVPTC	000730'	200714	000700*	00400	        MOVE C,SVNAM(SVPT)
BMOVEMCLNAMC	000731'	202700	000654*	00500	        MOVEM C,LNAM    ;SET UP FOR LOOKUP
BMOVECSVEXTSVPTC	000732'	200714	000666*	00600	        MOVE C,SVEXT(SVPT)
BNEST1HLLZMCLEXTC	000733'	512700	000655*	00700	NEST1:  HLLZM C,LEXT
BMOVECSVPPNSVPTC	000734'	200714	000247*	00800	        MOVE C,SVPPN(SVPT)
BMOVEMCLPPNC	000735'	202700	000657*	00900	        MOVEM C,LPPN
BXCTLKTABIOPNTC	000736'	256006	000776'	01000	        XCT LKTAB(IOPNT)
BJRSTTRNEFLINCRFC				01100	        JRST    [TRNE FL,INCRF  ;SPECIAL IF TRYING TO READ QQCREF
BJRSTDNCRFC				01200	                JRST DNCRF
BSKIPNCSVEXTSVPTC				01300	                SKIPN C,SVEXT(SVPT)     ;WAS EXTENSION SPECIFIED
BHLLZCLEXTC				01400	                HLLZ C,LEXT     ;SEE IF BLANK USED
BJUMPNCNOFILC				01500	                JUMPN C,NOFIL   ;NO, NOT THERE
BMOVSICSIXBITC				01600	                MOVSI C,SIXBIT '   CMD' ;TRY .CMD
BJRSTNEST1C	000737'	254000	011061'	01700	                JRST NEST1]
BNEXT2SUBSVPTXWDC	000740'	274600	011024'	01800	NEXT2:  SUB SVPT,[XWD 1,1]      ;GET HIM POINTED BACK RIGHT
BPOPPNAMEC	000741'	262740	000735*	01900	        POP P,NAME+3    ;RESTORE THINGS
BPOPPNAMEC	000742'	262740	000656*	02000	        POP P,NAME+2
BPOPPNAMEC	000743'	262740	000733*	02100	        POP P,NAME+1
BPOPPNAMEC	000744'	262740	000731*	02200	        POP P,NAME
BPOPPT1C	000745'	262740	000001	02300	        POP P,T1
BPOPPFLC	000746'	262740	000000	02400	        POP P,FL
BPOPPACCUMC	000747'	262740	000650*	02500	        POP P,ACCUM
BTRZFLRPGSRCRECALFC	000750'	620000	200004	02600	        TRZ FL,RPGSRC!RECALF    ;WE HAVE DONE THE FIND
BJRSTGETCHC	000751'	254000	000342'	02700	        JRST GETCH      ;AND CONTINUE TO GET THAT CHR
BC
BPOPFILC	000752'			02900	POPFIL:
BXCTRELTABIOPNTC	000752'	256006	001004'	03000	        XCT RELTAB(IOPNT)       ;RELEASE HIM
BIFNTEMPSETZMTMPFLGIOPNTC	000753'	402006	000705*	03100	IFN TEMP,<      SETZM TMPFLG(IOPNT)     ;CLEAR TMPCOR FLAG>
BMOVECBUFTABIOPNTC	000754'	200706	000726*	03200	        MOVE C,BUFTAB(IOPNT)
BMOVEMCFREBUFIOPNTC	000755'	202706	000000*	03300	        MOVEM C,FREBUF(IOPNT)   ;MARK BUFFER FREE
BPOPIOPCSC	000756'	262340	000015	03400	        POP IOP,CS
BHRRZCCSC	000757'	550700	000015	03500	        HRRZ C,CS
BSUBIOPNTXWDC	000760'	274300	011024'	03600	        SUB IOPNT,[XWD 1,1]     ;POINT IT BACK
BJRSTEOFRT1C	000761'	254000	000370'	03700	        JRST EOFRT1     ;AND GIVE BACK THE CHARACTER
BC
BNESTBC	000762'	000000	000000	03900	NESTB:  0
BDEFINEMACC				04000	DEFINE MAC(X)<IBUF'X>
BQQC				04100	QQ^
BNREPEATNESTDPMACNIBUF1IBUF1C	000763'	000000	000000*		MAC(\N)^IBUF1^
BNNMACNIBUF2IBUF2C	000764'	000000	000000*		MAC(\N)^IBUF2^
BNNMACNIBUF3IBUF3C	000765'	000000	000000*		MAC(\N)^IBUF3^
BNNMACNIBUF4IBUF4C	000766'	000000	000000*		MAC(\N)^IBUF4^
BNNMACNIBUF5IBUF5C	000767'	000000	000000*		MAC(\N)^IBUF5^
BNNDEFINEMACC				04200	DEFINE MAC(X)<ARRAY IBUF'X[3]>
BQQC				04300	QQ^
BNREPEATNESTDPMACNARRAYIBUF1NNMACNARRAYIBUF2NNMACNARRAYIBUF3NNMACNARRAYIBUF4NNMACNARRAYIBUF5NNIFNTEMPARRAYNESTDPTMPFLGC				04400	IFN TEMP,<ARRAY TMPFLG[NESTDP+2]
BLVARC				04500	LVAR
BDEFINEMACC				04600	DEFINE MAC(X)<TMPF'X==TMPFLG+X>
BQQC				04700	QQ>^
BNREPEATNESTDPMACNTMPFLGTMPF1NNMACNTMPFLGTMPF2NNMACNTMPFLGTMPF3NNMACNTMPFLGTMPF4NNMACNTMPFLGTMPF5NNINTABHALTC	000770'	254200	000000	04800	INTAB:  HALT    ;INBUFS
BDEFINEMACDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 15-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				04900	DEFINE MAC(X)<INBUF X,2>
BQQC				05000	QQ^
BNREPEATNESTDPMACNINBUFC	000771'	064040	000002		MAC(\N)^INBUF 1,2^
BNNMACNINBUFC	000772'	064100	000002		MAC(\N)^INBUF 2,2^
BNNMACNINBUFC	000773'	064140	000002		MAC(\N)^INBUF 3,2^
BNNMACNINBUFC	000774'	064200	000002		MAC(\N)^INBUF 4,2^
BNNMACNINBUFC	000775'	064240	000002		MAC(\N)^INBUF 5,2^
BNNC
BLKTABHALTC	000776'	254200	000000	05200	LKTAB:  HALT
BDEFINEMACC				05300	DEFINE MAC(X)<LOOKUP X,NAME>
BQQC				05400	QQ^
BNREPEATNESTDPMACNLOOKUPNAMEC	000777'	076040	000744*		MAC(\N)^LOOKUP 1,NAME^
BNNMACNLOOKUPNAMEC	001000'	076100	000777*		MAC(\N)^LOOKUP 2,NAME^
BNNMACNLOOKUPNAMEC	001001'	076140	001000*		MAC(\N)^LOOKUP 3,NAME^
BNNMACNLOOKUPNAMEC	001002'	076200	001001*		MAC(\N)^LOOKUP 4,NAME^
BNNMACNLOOKUPNAMEC	001003'	076240	001002*		MAC(\N)^LOOKUP 5,NAME^
BNNRELTABJRSTALLDONC	001004'	254000	001134'	05500	RELTAB: JRST ALLDON
BDEFINEMACC				05600	DEFINE MAC(X)<RELEAS X,0>
BQQC				05700	QQ^
BNREPEATNESTDPMACNRELEASC	001005'	071040	000000		MAC(\N)^RELEAS 1,0^
BNNMACNRELEASC	001006'	071100	000000		MAC(\N)^RELEAS 2,0^
BNNMACNRELEASC	001007'	071140	000000		MAC(\N)^RELEAS 3,0^
BNNMACNRELEASC	001010'	071200	000000		MAC(\N)^RELEAS 4,0^
BNNMACNRELEASC	001011'	071240	000000		MAC(\N)^RELEAS 5,0^
BNNC
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 16
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;ERROR ROUTINES
BC
BILLCHROUTSTRASCIZC	001012'	051140	011070'	00300	ILLCHR:	OUTSTR	[ASCIZ/ILLEGAL CHARACTER:/]
BJRSTERRCOMC	001013'	254000	001015'	00400	        JRST    ERRCOM
BETMSOUTSTRASCIZC	001014'	051140	011074'	00500	ETMS:   OUTSTR	[ASCIZ /TOO MANY SWITCHES: /]
BERRCOMOUTSTRBYTEC	001015'	051140	011100'	00600	ERRCOM:	OUTSTR	[BYTE(7)15,12]
BMOVET1ERBFPTC	001016'	200040	000366*	00700		MOVE	T1,ERBFPT
BERRCM1ILDBCT1C	001017'	134700	000001	00800	ERRCM1:	ILDB	C,T1		;GET CHARACTER FROM COMMAND
BCAMNT1POINTERRBUFC	001020'	316040	011052'	00900		CAMN	T1,[POINT 7,ERRBUF+3,34]
BMOVET1POINTERRBUFC	001021'	200040	011053'	01000		MOVE	T1,[POINT 7,ERRBUF]
BPUSHJPTYPERRC	001022'	260740	001045'	01100		PUSHJ	P,TYPERR	;TYPE ERROR CHARACTER
BAOSERRCNTC	001023'	350000	000000*	01200		AOS	ERRCNT		;REMEMBER THAT IT PRINTED
BCAMET1ERBFPTC	001024'	312040	001016*	01300		CAME	T1,ERBFPT
BJRSTERRCM1C	001025'	254000	001017'	01400		JRST	ERRCM1
BERRCM2TROFLINPRNTC	001026'	660000	004000	01500	ERRCM2:	TRO	FL,INPRNT
BMOVEIT1C	001027'	201040	000012	01600		MOVEI	T1,^D10
BERRCM3PUSHJPGETCHC	001030'	260740	000342'	01700	ERRCM3:	PUSHJ	P,GETCH
BCAINCC	001031'	306700	000177	01800		CAIN	C,177
BJRSTERRCM4C	001032'	254000	001036'	01900		JRST	ERRCM4
BPUSHJPTYPERRC	001033'	260740	001045'	02000		PUSHJ	P,TYPERR	;TYPE SOME MORE
BJFCLC	001034'	255000	000000	02100		JFCL			;DON'T CARE WHETHER IT PRINTED OR NOT
BSOJGT1ERRCM3C	001035'	367040	001030'	02200		SOJG	T1,ERRCM3
BERRCM4OUTSTRBYTEC	001036'	051140	011100'	02300	ERRCM4:	OUTSTR	[BYTE(7)15,12]
BERRCM5SOSGERRCNTC	001037'	377000	001023*	02400	ERRCM5:	SOSG	ERRCNT
BJRSTERRCM6C	001040'	254000	001043'	02500		JRST	ERRCM6
BOUTCHRC	001041'	051040	011101'	02600		OUTCHR	[" "]
BJRSTERRCM5C	001042'	254000	001037'	02700		JRST	ERRCM5
BERRCM6OUTCHRC	001043'	051040	011102'	02800	ERRCM6:	OUTCHR	["^"]
BJRSTBYENOWC	001044'	254000	001110'	02900		JRST	BYENOW
BTYPERRCAIGECC	001045'	305700	000040	03000	TYPERR:	CAIGE	C," "
BJRSTCPOPJ1C	001046'	254000	002747'	03100		JRST	CPOPJ1		;IGNORE NONPRINTING CHARS
BOUTCHRCC	001047'	051040	000016	03200		OUTCHR	C
BPOPJPC	001050'	263740	000000	03300		POPJ	P,
BTMNEROUTSTRASCIZC	001051'	051140	011103'	03400	TMNER:  OUTSTR	[ASCIZ /TOO MANY NAMES: /]
BJRSTERRCOMC	001052'	254000	001015'	03500	        JRST ERRCOM
BDSKNAOUTSTRASCIZC	001053'	051140	011107'	03600	DSKNA:  OUTSTR	[ASCIZ /DISK NOT AVAILABLE: /]
BJRSTERRCOMC	001054'	254000	001015'	03700	        JRST ERRCOM
BOUTEROUTSTRASCIZC	001055'	051140	011114'	03800	OUTER:  OUTSTR	[ASCIZ /OUTPUT ERROR: /]
BJRSTERRCOMC	001056'	254000	001015'	03900	        JRST ERRCOM
BPROCONOUTSTRASCIZC	001057'	051140	011117'	04000	PROCON: OUTSTR	[ASCIZ /PROCESSOR CONFLICT: /]
BJRSTERRCOMC	001060'	254000	001015'	04100	        JRST ERRCOM
BNOCOROUTSTRASCIZC	001061'	051140	011124'	04200	NOCOR:  OUTSTR	[ASCIZ /NOT ENOUGH CORE: /]
BJRSTERRCOMC	001062'	254000	001015'	04300	        JRST ERRCOM
BREADEROUTSTRASCIZC	001063'	051140	011130'	04400	READER: OUTSTR	[ASCIZ /INPUT ERROR: /]
BJRSTERRCOMC	001064'	254000	001015'	04500	        JRST ERRCOM
BSYNERROUTSTRASCIZC	001065'	051140	011133'	04600	SYNERR: OUTSTR	[ASCIZ /COMMAND ERROR: /]
BJRSTERRCOMC	001066'	254000	001015'	04700	        JRST ERRCOM
BNESTTDOUTSTRASCIZC	001067'	051140	011137'	04800	NESTTD: OUTSTR	[ASCIZ /NESTING TOO DEEP: /]
BJRSTERRCOMC	001070'	254000	001015'	04900	        JRST ERRCOM
BUNRECSOUTSTRASCIZC	001071'	051140	011143'	05000	UNRECS: OUTSTR	[ASCIZ /UNRECOGNIZABLE SWITCH: /]
BMOVET3ACCUMC	001072'	200140	000747*	05100		MOVE T3,ACCUM
BPUSHJPSIXOUTC	001073'	260740	001114'	05200		PUSHJ P,SIXOUT	;TYPE THE OFFENDING SWITCH
BJRSTBYENOWC	001074'	254000	001110'	05300		JRST BYENOW
BNOFILTRZEFLRPGSRCDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 16-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	001075'	622000	000004	05400	NOFIL:  TRZE FL,RPGSRC
BJRSTTRYSVDC	001076'	254000	001656'	05500	        JRST TRYSVD     ;TRY SVED
BTRNEFLRECALFC	001077'	602000	200000	05600	        TRNE FL,RECALF  ;WE WERE LOOKING UP A SVC FILE
BJRSTNOPREVC	001100'	254000	001127'	05700	        JRST NOPREV     ;SO GIVE SPECIAL MESSAGE
BOUTSTRASCIZC	001101'	051140	011150'	05800	        OUTSTR	[ASCIZ /NO SUCH FILE - /]
BNAMCOMMOVET3NAMEC	001102'	200140	001003*	05900	NAMCOM:	MOVE T3,NAME
BPUSHJPSIXOUTC	001103'	260740	001114'	06000	        PUSHJ P,SIXOUT
BHLLZT3NAMEC	001104'	510140	000743*	06100	        HLLZ T3,NAME+1
BJUMPET3BYENOWC	001105'	322140	001110'	06200	        JUMPE T3,BYENOW
BOUTCHRC	001106'	051040	011154'	06300		OUTCHR ["."]
BQOFIL2PUSHJPSIXOUTC	001107'	260740	001114'	06400	QOFIL2: PUSHJ P,SIXOUT
BBYENOWRESETC	001110'	047000	000000	06500	BYENOW:	RESET
BJRSTXITC	001111'	254000	001415'	06600		JRST XIT
BFIUOUTSTRASCIZC	001112'	051140	011155'	06700	FIU:    OUTSTR	[ASCIZ /FILE IN USE OR PROTECTED - /]
BJRSTNAMCOMC	001113'	254000	001102'	06800	        JRST NAMCOM
BC
BSIXOUTMOVEIT2C	001114'	201100	000000	07000	SIXOUT: MOVEI T2,0
BLSHCT2C	001115'	246100	000006	07100	        LSHC T2,6
BADDIT2C	001116'	271100	000040	07200	        ADDI T2,40
BOUTCHRT2C	001117'	051040	000002	07300		OUTCHR T2
BJUMPNT3SIXOUTC	001120'	326140	001114'	07400	        JUMPN T3,SIXOUT
BPOPJPC	001121'	263740	000000	07500	        POPJ P,
BDEVNAOUTSTRASCIZC	001122'	051140	011163'	07600	DEVNA:  OUTSTR	[ASCIZ /DEVICE NOT AVAILABLE - /]
BMOVET3LOKNAMC	001123'	200140	000000*	07700	        MOVE T3,LOKNAM
BJRSTQOFIL2C	001124'	254000	001107'	07800	        JRST QOFIL2
BTMSTDOUTSTRASCIZC	001125'	051140	011170'	07900	TMSTD:  OUTSTR	[ASCIZ /TOO MANY NON-STANDARD PROCESSORS: /]
BJRSTERRCOMC	001126'	254000	001015'	08000	        JRST ERRCOM
BC
BNOPREVMOVEIT1ASCIZC	001127'	201040	011177'	08200	NOPREV:	MOVEI	T1,[ASCIZ/NO PREVIOUS LOAD-TYPE COMMAND/]
BTRNEFLEDITFC	001130'	602000	020000	08300		TRNE	FL,EDITF	;PICK OUT APPROPRIATE MESSAGE
BMOVEIT1ASCIZC	001131'	201040	011205'	08400		MOVEI	T1,[ASCIZ/NO PREVIOUS EDIT-TYPE COMMAND/]
BOUTSTRT1C	001132'	051141	000000	08500		OUTSTR	(T1)
BJRSTBYENOWC	001133'	254000	001110'	08600		JRST	BYENOW
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 17
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;FINSIH UP COMMAND HANDLING - TELL LAST PROCESSOR TO RUN LOADER IF NECESSARY
BC				00200	;AND FINISH UP LOADER COMMAND FILE
BC
BALLDONTRNEFLINCRFC	001134'	602000	002000	00400	ALLDON:        TRNE FL,INCRF   ;JUST FOUND END OF QQCREF FILE
BJRSTDNCRFC	001135'	254000	004327'	00500	        JRST DNCRF
BTRNEFLINPRNTC	001136'	602000	004000	00600	        TRNE FL,INPRNT
BJRSTBYENOWC	001137'	254000	001110'	00700	        JRST BYENOW     ;IF PRINTENG AND EOF THEN FIINSH UP
BHRRZT1PC	001140'	550057	000000	00800	        HRRZ T1,(P)     ;GET THE ADDRESS WE WANT TO RETURN TO
BCAIET1NXFILC	001141'	302040	002377'	00900	        CAIE T1,NXFIL+1 ;THIS SHOULD BE HERE
BCAINT1ILP2AC	001142'	306040	002441'	01000		CAIN T1,ILP2A+1
BJRSTC	001143'	254000	001146'	01100		JRST .+3
BOUTSTRASCIZC	001144'	051140	011213'	01200		OUTSTR [ASCIZ/LINE TERMINATED IMPROPERLY/]
BJRSTBYENOWC	001145'	254000	001110'	01300		JRST BYENOW
BSETZMPCNAMC	001146'	402000	000000*	01400	        SETZM PCNAM     ;NO LINK NAME TO START WITH
BMOVEIT3OUTLODC	001147'	201140	010147'	01500	        MOVEI T3,OUTLOD
BTRNNFLDOLODC	001150'	606000	000002	01600	        TRNN FL,DOLOD           ;ARE WE LOADING?
BJRSTALDN1AC	001151'	254000	001166'	01700	        JRST    ALDN1A
BMOVSIT2C	001152'	205100	172271	01800		MOVSI  T2,'/2Y'		;YES, CHECK ANYTHING TO BE FINISHED
BSKIPEFTFFLGC	001153'	332000	000000*	01900	        SKIPE   FTFFLG
BPUSHJPOUTSIXC	001154'	260740	004206'	02000	        PUSHJ   P,OUTSIX
BC				02100	; ** CODE TO SEND COBDDT TO THE LOADER**
BSKIPNCDEBFLC	001155'	336000	000000*	02200		SKIPN	CDEBFL		;SKIP IF COBDDT WANTED
BJRSTNOCBDC	001156'	254000	001164'	02300		JRST	NOCBD		;NOPE.
BC				02400	; SEND THE LOADER:    ******COBDDT******
BMOVET2SIXBITC	001157'	200100	011221'	02500		MOVE	T2,[SIXBIT 'SYS:CO']	;FOIST 6BIT STRING
BPUSHJPOUTSIXC	001160'	260740	004206'	02600		PUSHJ	P,OUTSIX	;OUTPUT TO LOADER
BMOVET2SIXBITC	001161'	200100	011222'	02700		MOVE	T2,[SIXBIT 'BDDT,']	;THIS SHOULD BE ITS REAL NAME
BPUSHJPOUTSIXC	001162'	260740	004206'	02800		PUSHJ	P,OUTSIX		;OUTPUT TO GROANER
BSETZMCDEBFLC	001163'	402000	001155*	02900		SETZM	CDEBFL		;JUST INCASE WE MEET AGAIN.......
BC				03000	;COBDDT HAS BEEN PUT OUT (OF IT'S MISERY)
BNOCBDMOVSIT2C	001164'	205100	174700	03100	NOCBD:        MOVSI   T2,'/G '        ;SET UP FOR TERMINATE LOADING
BPUSHJPOUTSIXC	001165'	260740	004206'	03200	        PUSHJ P,OUTSIX          ;YES, PUT IT OUT
BALDN1ASETZMPCDEVPCDEVC	001166'	402000	000011*	03300	ALDN1A: SETZM PCDEV#    ;ON DEVICE
BSETZMPCPPNPCPPNC	001167'	402000	000017*	03400	        SETZM PCPPN#    ;NO PROGJ PROG
BSETZMPCEXTPCEXTC	001170'	402000	000015*	03500	        SETZM PCEXT#    ;NO EXTENSION
BMOVEIT4FCHLODC	001171'	201200	001000	03600	        MOVEI T4,FCHLOD ;START WITH LOADER
BMOVEIT3NPROCSC	001172'	201140	000010	03700	        MOVEI T3,NPROCS ;WHICH IS HERE
BSKIPAC	001173'	334000	000000	03800	        SKIPA
BALDN1LSHT4C	001174'	242200	000001	03900	ALDN1:  LSH T4,1        ;LOOK FOR NEXT PROCESSOR
BTRNNFL2T4C	001175'	606404	000000	04000	        TRNN FL2,(T4)   ;HAS THAT PROCESSOR BEEN SET UP FOR OUTPUT?
BSOJGET3ALDN1C	001176'	365140	001174'	04100	        SOJGE T3,ALDN1  ;NO, TRY NEXT (BUT NOT TOO MANY)
BJUMPLT3DONEPC	001177'	321140	001256'	04200	        JUMPL T3,DONEP  ;IF OUT OF PROCESSORS THEN DONE
BPUSHPT3C	001200'	261740	000003	04300	        PUSH P,T3       ;SAVE IT FOR LATER
BMOVET3PRCTABT3C	001201'	200143	004343'	04400	        MOVE T3,PRCTAB(T3)      ;GET PROCESSOR OUTPUT ROUTINE
BSKIPNT2PCNAMC	001202'	336100	001146*	04500	        SKIPN T2,PCNAM  ;IS THERE A PROCESSOR FOR IT TO CALL?
BJRSTNONAMC	001203'	254000	001251'	04600	        JRST NONAM      ;NO
BTRNEFLCCSRNFC	001204'	602000	100000	04700		TRNE FL,CCSRNF	;IN CCS-COMPILE MODE?
BCAMET2LODNAMC	001205'	312100	001447'	04800		CAME T2,LODNAM	;IF SO, RUNNING LOADER?
BJRSTC	001206'	254000	001210'	04900		JRST .+2
BMOVET2SIXBITC	001207'	200100	011020'	05000		MOVE T2,[SIXBIT/CFORTR/]	;YES TO BOTH, SUBSTITUTECFORTR
BPUSHPT4C	001210'	261740	000004	05100		PUSH P,T4
BPUSHPT3C	001211'	261740	000003	05200		PUSH P,T3
BPUSHPT2C	001212'	261740	000002	05300		PUSH P,T2
BMOVEIT1P.SPRODRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 17-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	001213'	201040	000002	05400		MOVEI T1,P.SPROC
BPUSHJPGETPARC	001214'	260740	001717'	05500		PUSHJ P,GETPAR	;CHECK FOR SPECIAL PROCESSORS
BJRSTNOSPC1C	001215'	254000	001242'	05600		JRST NOSPC1	;NOPE
BHRRZT3T2C	001216'	550142	000000	05700		HRRZ T3,(T2)	;THERE ARE SOME, GET BLOCK LENGTH
BIDIVIT3C	001217'	231140	000007	05800		IDIVI T3,7	;NUMBER OF ENTRIES
BPOPPT2C	001220'	262740	000002	05900		POP P,T2	;GET BACK PROGRAM NAME
BCAMNT2T1C	001221'	316101	000000	06000		CAMN T2,(T1)	;LOOK UP IN TABLE
BJRSTSPCFNDC	001222'	254000	001226'	06100		JRST SPCFND	;FOUND IT
BADDIT1C	001223'	271040	000007	06200		ADDI T1,7	;NO, TRY NEXT ENTRY
BSOJGT3C	001224'	367140	001221'	06300		SOJG T3,.-3
BJRSTNOSPC2C	001225'	254000	001243'	06400		JRST NOSPC2	;NOT THERE AT ALL
BSPCFNDPOPPT3C	001226'	262740	000003	06500	SPCFND:	POP P,T3	;GET BACK PROCESSOR NUMBER
BMOVEIT4SVPTC	001227'	201214	000001	06600		MOVEI T4,1(SVPT);A GOOD SCRATCH POINTER INTO SVSTUFF
BMOVET2T1C	001230'	200101	000001	06700		MOVE T2,1(T1)	;GET DEVICE
BMOVEMT2SVDEVT4C	001231'	202104	000214*	06800		MOVEM T2,SVDEV(T4)
BMOVET2T1C	001232'	200101	000002	06900		MOVE T2,2(T1)	;GET NAME
BMOVEMT2SVNAMT4C	001233'	202104	000730*	07000		MOVEM T2,SVNAM(T4)
BMOVET2T1C	001234'	200101	000003	07100		MOVE T2,3(T1)	;GET EXTENSION
BMOVEMT2SVEXTT4C	001235'	202104	000732*	07200		MOVEM T2,SVEXT(T4)
BMOVET2T1C	001236'	200101	000005	07300		MOVE T2,5(T1)	;GET PPN
BMOVEMT2SVPPNT4C	001237'	202104	000734*	07400		MOVEM T2,SVPPN(T4)
BPUSHJPCMNOC	001240'	260740	003472'	07500		PUSHJ P,CMNO	;OUTPUT THE SPECIAL PROCESSOR NAME
BJRSTSPCOKC	001241'	254000	001245'	07600		JRST SPCOK
BNOSPC1POPPT2C	001242'	262740	000002	07700	NOSPC1:	POP P,T2
BNOSPC2POPPT3C	001243'	262740	000003	07800	NOSPC2:	POP P,T3
BPUSHJPOUTSIXC	001244'	260740	004206'	07900		PUSHJ P,OUTSIX
BSPCOKPOPPT4C	001245'	262740	000004	08000	SPCOK:	POP P,T4
BMOVEIT1C	001246'	201040	000041	08100		MOVEI T1,"!"	;OUTPUT THE LOAD SYMBOL
BPUSHJPT3C	001247'	260743	000000	08200	        PUSHJ P,(T3)
BPUSHJPOUCRLFC	001250'	260740	010063'	08300	        PUSHJ   P,OUCRLF
BNONAMPOPPT3C	001251'	262740	000003	08400	NONAM:  POP P,T3        ;GET BACK PROCESSOR NUMBER
BXCTRLSTABT3C	001252'	256003	001426'	08500	        XCT RLSTAB(T3)  ;CLOSE UP ITS OUTPUT
BMOVET1PRCNAMT3C	001253'	200043	001437'	08600	        MOVE T1,PRCNAM(T3)      ;GET THE NAME OF THAT PROCESSOR
BMOVEMT1PCNAMC	001254'	202040	001202*	08700	        MOVEM T1,PCNAM  ;AND SET AS THE ONE TO LINK TO
BSOJGET3ALDN1C	001255'	365140	001174'	08800	        SOJGE T3,ALDN1  ;GO BACK IF MORE TO LOOK AT
BDONEPMOVEIT4C	001256'	201200	000000	08900	DONEP:  MOVEI T4,0      ;NON STANDARD PROCESSORS START WITH 0
BNSTOUTCAMLET4NOSTNMC	001257'	313200	000000*	09000	NSTOUT: CAMLE T4,NOSTNM ;DO WE HAVE THAT MANY?
BJRSTDONEC	001260'	254000	001324'	09100	        JRST DONE       ;NO
BSKIPNNONUSDT4C	001261'	336004	000000*	09200	        SKIPN NONUSD(T4)        ;HAS THAT FILE BEEN USED
BAOJAT4NSTOUTC	001262'	344200	001257'	09300	        AOJA T4,NSTOUT          ;NO
BMOVET3PRCTABNPROCST4C	001263'	200144	004354'	09400	        MOVE T3,PRCTAB+NPROCS+1(T4)     ;THE OUTPUT ROUTINE
BSKIPNPCNAMC	001264'	336000	001254*	09500	        SKIPN PCNAM     ;A NAME TO PUT OUT?
BJRSTNONAM1C	001265'	254000	001307'	09600	        JRST NONAM1
BSKIPNT2PCDEVC	001266'	336100	001166*	09700	        SKIPN T2,PCDEV  ;A DEVICE?
BJRSTNSTOU1C	001267'	254000	001273'	09800	        JRST NSTOU1
BPUSHJPOUTSIXC	001270'	260740	004206'	09900		PUSHJ P,OUTSIX
BMOVEIT1C	001271'	201040	000072	10000	        MOVEI T1,":"
BPUSHJPT3C	001272'	260743	000000	10100	        PUSHJ P,(T3)
BNSTOU1MOVET2PCNAMC	001273'	200100	001264*	10200	NSTOU1: MOVE T2,PCNAM
BPUSHJPOUTSIXC	001274'	260740	004206'	10300	        PUSHJ P,OUTSIX
BSKIPNT2PCEXTC	001275'	336100	001170*	10400	        SKIPN T2,PCEXT  ;CHECK FOR AN EXTENSION
BJRSTNSTOU2C	001276'	254000	001302'	10500	        JRST NSTOU2
BMOVEIT1C	001277'	201040	000056	10600		MOVEI T1,"."
BPUSHJPT3DRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 17-3
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	001300'	260743	000000	10700	        PUSHJ P,(T3)
BPUSHJPOUTSIXC	001301'	260740	004206'	10800	        PUSHJ P,OUTSIX
BNSTOU2SKIPET2PCPPNC	001302'	332100	001167*	10900	NSTOU2: SKIPE T2,PCPPN
BPUSHJPOUTPPNC	001303'	260740	003750'	11000	        PUSHJ P,OUTPPN
BMOVEIT1C	001304'	201040	000041	11100	        MOVEI T1,"!"
BPUSHJPT3C	001305'	260743	000000	11200	        PUSHJ P,(T3)
BPUSHJPOUCRLFC	001306'	260740	010063'	11300	        PUSHJ P,OUCRLF
BNONAM1XCTNSDRELT4C	001307'	256004	001321'	11400	NONAM1: XCT NSDREL(T4)
BMOVET1NONSNMT4C	001310'	200044	000000*	11500	        MOVE T1,NONSNM(T4)
BMOVEMT1PCNAMC	001311'	202040	001273*	11600	        MOVEM T1,PCNAM
BMOVET1NONSDVT4C	001312'	200044	000000*	11700	        MOVE T1,NONSDV(T4)
BMOVEMT1PCDEVC	001313'	202040	001266*	11800	        MOVEM T1,PCDEV
BMOVET1NONSXTT4C	001314'	200044	000000*	11900	        MOVE T1,NONSXT(T4)
BMOVEMT1PCEXTC	001315'	202040	001275*	12000	        MOVEM T1,PCEXT
BMOVET1NONSPNT4C	001316'	200044	000000*	12100	        MOVE T1,NONSPN(T4)
BMOVEMT1PCPPNC	001317'	202040	001302*	12200	        MOVEM T1,PCPPN
BAOJAT4NSTOUTC	001320'	344200	001257'	12300	        AOJA T4,NSTOUT
BNSDRELFORNSDCHNXXXC			000005	12400	NSDREL: FOR (NSDCHN,NSDNM,<RELEASE XXX,0>,-1)^XXX==NSDCHN
BREPEATNSDNMRELEASXXXC	001321'	071240	000000		RELEASE XXX,0
BIFBIFNBXXXXXXRELEASXXXC	001322'	071200	000000		RELEASE XXX,0
BIFBIFNBXXXXXXRELEASXXXC	001323'	071140	000000		RELEASE XXX,0
BIFBIFNBXXXXXXC
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 18
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;WRITE OUT COMMAND IN SVC FILE AND CLOSE ALL FILES, THEN RUN 
BC				00200	;PROCESSOR OR EXIT
BC
BDONETRNEFLCMDSNC	001324'	602000	001000	00400	DONE:  TRNE FL,CMDSN   ;DID WE SEE COMMAND FROM TTY?
BJDONE1JRSTDONE1C	001325'	254000	001401'	00500	JDONE1: JRST DONE1      ;NO, DO NOT WRITE FILE
BMOVET1JOBNAMC	001326'	200040	000000*	00600	        MOVE T1,JOBNAM
BHRRIT1SIXBITC	001327'	541040	636643	00700	        HRRI T1,(SIXBIT /SVC/)
BTRNEFLEDITFC	001330'	602000	020000	00800	        TRNE FL,EDITF
BHRRIT1SIXBITC	001331'	541040	454463	00900	        HRRI T1,(SIXBIT /EDS/)
BMOVEMT1LNAMC	001332'	202040	001102*	01000	        MOVEM T1,LNAM   ;SET UP OUTPUT FILE
BIFNTEMPHRLZMT1TMPFILC	001333'	516040	000701*	01100	IFN TEMP,<      HRLZM T1,TMPFIL         ;SAVE NAME IN TMPFIL
BMOVET1POINTDDTBUFC	001334'	200040	011223'	01200	        MOVE T1,[POINT 7,DDTBUF]        ;SET UP BYTE POINTER
BMOVNIT2C	001335'	211100	000004	01300	        MOVNI T2,4                      ;SET UP FOR CHARACTER COUNT
BILDBT3T1C	001336'	134140	000001	01400	        ILDB T3,T1                      ;GET NEXT CHARACTER
BCAIET3C	001337'	302140	000177	01500	        CAIE T3,177                     ;IS IT A EOF CHARACTER
BSOJAT2C	001340'	364100	001336'	01600	        SOJA T2,.-2                     ;NO, TRY AGAIN
BIDIVIT2C	001341'	231100	000005	01700	        IDIVI T2,5                      ;CALCULATE CHARACTER COUNT
BHRLMT2TMPFILC	001342'	506100	000677*	01800	        HRLM T2,TMPFIL+1                ;STORE IN TMPCOR OUTPUT BLOCK
BLDBT3POINTT1C	001343'	135140	011224'	01900	        LDB T3,[POINT 6,T1,5]           ;PICK UP BIT POS OF LAST CHAR
BSETOT2C	001344'	474100	000000	02000	        SETO T2,                        ;PREPARE TO BUILD MASK
BLSHT2T3C	001345'	242103	000007	02100	        LSH T2,7(T3)                    ;MASK OFF REST OF LAST WORD
BANDMT2T1C	001346'	406101	000000	02200	        ANDM T2,(T1)                    ;  IN DDT BUFFER
BMOVEIT2DDTBUFC	001347'	201100	000000*	02300	        MOVEI T2,DDTBUF-1               ;GET START OF BUFFER
BHRRMT2TMPFILC	001350'	542100	001342*	02400	        HRRM T2,TMPFIL+1                ;STORE IN WRITE BLOCK FOR TMPCOR UUO
BMOVET2XWDTMPFILC	001351'	200100	011225'	02500	        MOVE T2,[XWD 3,TMPFIL]          ;SET UP FOR WRITE
BTMPCORT2C	001352'	047100	000044	02600	        TMPCOR  T2,                     ;WRITE OUT FILE INTO CORE
BSKIPAC	001353'	334000	000000	02700	        SKIPA                           ;IT DID NOT FIT, TRY DISK
BJRSTDONE1C	001354'	254000	001401'	02800	        JRST DONE1                      ;GO CLEAN UP AND LEAVE
BMOVEIT2C	001355'	201100	000177	02900	        MOVEI T2,177                    ;RESTORE EOF CHARACTER IN DDTBUF
BIDPBT2T1C	001356'	136100	000001	03000	        IDPB T2,T1                      ;ALL BACK TO NORMAL
BNOFITC	001357'			03100	NOFIT:                  >
BMOVSIT1SIXBITC	001357'	205040	645560	03200	        MOVSI T1,SIXBIT '   TMP'
BMOVEMT1LEXTC	001360'	202040	001104*	03300	        MOVEM T1,LEXT
BSETZMLDATC	001361'	402000	000742*	03400	        SETZM LDAT
BSETZMLPPNC	001362'	402000	000741*	03500	        SETZM LPPN
BCLOSELOOKC	001363'	070000	000000	03600	        CLOSE LOOK,0    ;MAKE SURE NOTHING USING THIS CHANEL
BPUSHJPCHKRMC	001364'	260740	001450'	03700	        PUSHJ P,CHKRM   ;GET ROOM FOR BUFFERS
BENTERLOOKLNAMC	001365'	077000	001332*	03800	        ENTER LOOK,LNAM ;GET SET TO WRITE
BJRSTFIUC	001366'	254000	001112'	03900	        JRST FIU        ;TREAT THIS AS A FATAL ERROR
BOUTBUFLOOKC	001367'	065000	000002	04000	        OUTBUF LOOK,2
BMOVET1POINTDDTBUFC	001370'	200040	011223'	04100	        MOVE T1,[POINT 7,DDTBUF]        ;WRITE ALL OF COMMAND
BDONE3ILDBT2T1C	001371'	134100	000001	04200	DONE3:  ILDB T2,T1
BCAINT2C	001372'	306100	000177	04300	        CAIN T2,177     ;DONE?
BJRSTDONE2C	001373'	254000	001400'	04400	        JRST DONE2
BSOSGLOOKBFC	001374'	377000	000000*	04500	        SOSG LOOKBF+2
BOUTPUTLOOKC	001375'	067000	000000	04600	        OUTPUT LOOK,0
BIDPBT2LOOKBFC	001376'	136100	000000*	04700	        IDPB T2,LOOKBF+1
BJRSTDONE3C	001377'	254000	001371'	04800	        JRST DONE3
BDONE2RELEASLOOKC	001400'	071000	000000	04900	DONE2:  RELEASE LOOK,0  ;LET IT GO
BDONE1TRNEFL2FCHCRFC	001401'	602400	000400	05000	DONE1:  TRNE FL2,FCHCRF ;DID WE DO ANY CREF?
BPUSHJPFINCRFC	001402'	260740	004265'	05100	        PUSHJ P,FINCRF  ;YES, FINISH OFF CREF
BRESETC	001403'	047000	000000	05200	        RESET   ;RESET SO EXTRA FILES NOT PUT OUT
BPUSHJPWRTPARC	001404'	260740	001771'	05300		PUSHJ P,WRTPAR	;CLOSE UP PARAMETER FILE
BSKIPNALTRUNDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 18-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	001405'	336000	000111*	05400		SKIPN ALTRUN	;ALWAYS RUN IF ALTERNATE PROCESSOR
BSKIPET1PCNAMC	001406'	332040	001311*	05500	        SKIPE T1,PCNAM  ;IS THERE ONE TO LOAD?
BJRSTNUNDOC	001407'	254000	000002'	05600	        JRST NUNDO      ;GO LOAD IT
BEXMOVEIT1C	001410'	201040	000017	05700	EX:     MOVEI   T1,17           ;PREPARE TO RELEASE ALL FILES
BMOVET2RELEASC	001411'	200100	011226'	05800	        MOVE    T2,[RELEAS 0,0]
BDPBT1POINTT2C	001412'	137040	011227'	05900	        DPB     T1,[POINT 4,T2,12]
BXCTT2C	001413'	256000	000002	06000	        XCT     T2
BSOJGET1C	001414'	365040	001412'	06100	        SOJGE   T1,.-2
BXITPUSHJPWRTPARC	001415'	260740	001771'	06200	XIT:	PUSHJ	P,WRTPAR	;CLOSE PARAMETER FILE
BTRNEFLCCSRNFC	001416'	602000	100000	06300		TRNE	FL,CCSRNF
BJRSTGOCCSC	001417'	254000	000005'	06400		JRST	GOCCS		;CCS MODE DON'T EXIT
BMOVEPDPC	001420'	200000	010735'	06500		MOVE PDP
BPUSHEXPC	001421'	261000	011236'	06600		PUSH [[EXP 0,0,0,0,0,0]]
BSKIPERPGDBRPGDBC	001422'	332000	011023'	06700		SKIPE [RPGDB]
BPUSHJRPGDBC	001423'	260000	000046*	06800		PUSHJ RPGDB	;IN BLISS: RPGDB(0);
BEXITC	001424'	047040	000012	06900		EXIT	1,
BJRSTC	001425'	254000	001424'	07000	        JRST    .-1
BDEFINEC				07100	        DEFINE X (A,B,C,D,E)
BXC				07200	<RELEASE CHN'B,0>
BC
BIFNTEMPDEFINEC				07400	IFN TEMP,<DEFINE X (A,B,C,D,E)
BXC				07500	<PUSHJ P,CHK'B>>
BC
BRLSTABPROCESC	001426'			07700	RLSTAB: PROCESS^
BXPUSHJPCHKF4C	001426'	260740	010073'		X FORTRAN,F4,F40^PUSHJ P,CHKF4^
BXPUSHJPCHKMACC	001427'	260740	010101'		X MACRO,MAC,MACRO^PUSHJ P,CHKMAC^
BXPUSHJPCHKFTFC	001430'	260740	010107'		X FTFORTRAN,FTF,FTF40^PUSHJ P,CHKFTF^
BXPUSHJPCHKSIMC	001431'	260740	010115'		X SIMPL,SIM,SIMPL^PUSHJ P,CHKSIM^
BXPUSHJPCHKFALC	001432'	260740	010123'		X FAIL,FAL,FAIL^PUSHJ P,CHKFAL^
BXPUSHJPCHKCBLC	001433'	260740	010131'		X COBOL,CBL,COBOL^PUSHJ P,CHKCBL^
BXPUSHJPCHKBLIC	001434'	260740	010137'		X BLIMP,BLI,BLISS^PUSHJ P,CHKBLI^
BXPUSHJPCHKVASC	001435'	260740	010145'		X VAS,VAS,VAS^PUSHJ P,CHKVAS^
BIFETEMPC				07800	IFE TEMP,<      RELEASE CHNLOD,0        ;DON'T FORGET LOADER>
BIFNTEMPPUSHJPCHKLODC	001436'	260740	010153'	07900	IFN TEMP,<      PUSHJ P,CHKLOD>
BC
BDEFINEC				08100	        DEFINE X (A,B,C,D,E)
BXC				08200	<<SIXBIT /C/>>
BC
BPRCNAMPROCESC	001437'			08400	PRCNAM: PROCESS^
BXSIXBITC	001437'	462420	000000		X FORTRAN,F4,F40^<SIXBIT /F40/>^
BXSIXBITC	001440'	554143	625700		X MACRO,MAC,MACRO^<SIXBIT /MACRO/>^
BXSIXBITC	001441'	466446	242000		X FTFORTRAN,FTF,FTF40^<SIXBIT /FTF40/>^
BXSIXBITC	001442'	635155	605400		X SIMPL,SIM,SIMPL^<SIXBIT /SIMPL/>^
BXSIXBITC	001443'	464151	540000		X FAIL,FAL,FAIL^<SIXBIT /FAIL/>^
BXSIXBITC	001444'	435742	575400		X COBOL,CBL,COBOL^<SIXBIT /COBOL/>^
BXSIXBITC	001445'	425451	636300		X BLIMP,BLI,BLISS^<SIXBIT /BLISS/>^
BXSIXBITC	001446'	664163	000000		X VAS,VAS,VAS^<SIXBIT /VAS/>^
BLODNAMSIXBITC	001447'	545741	444562	08500	LODNAM: SIXBIT /LOADER/
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 19
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;BUFFER ALLOCATION STUFF - EXPAND CORE IF NECESSARY
BC
BCHKRMPUSHPT1C	001450'	261740	000001	00300	CHKRM: PUSH P,T1       ;SAVE THE REGISTERS WE ARE USING
BPUSHPT2C	001451'	261740	000002	00400	        PUSH P,T2
BMOVSIT1NESTDPC	001452'	205040	777772	00500	        MOVSI T1,-<NESTDP+2>    ;LOOK TO SEE IF ANY FREED BUFFERS
BSKIPNT2FREBUFT1C	001453'	336101	000755*	00600	        SKIPN T2,FREBUF(T1)
BAOBJNT1C	001454'	253040	001453'	00700	        AOBJN T1,.-1    ;TRY AGAIN
BJUMPGET1USTOPC	001455'	325040	001461'	00800	        JUMPGE T1,USTOP ;NO, GET IT FROMTOP OF STORAGE
BMOVEMT2JOBFFC	001456'	202100	000725*	00900	        MOVEM T2,JOBFF  ;YES, SET JOBFF THERE
BSETZMFREBUFT1C	001457'	402001	001453*	01000	        SETZM FREBUF(T1)        ;AND MARK IT USED
BJRSTTPOPJC	001460'	254000	001504'	01100	        JRST TPOPJ      ;THATS ALL FOR NOW
BUSTOPMOVET1SVJFFC	001461'	200040	000000*	01200	USTOP:  MOVE T1,SVJFF   ;GET THE CURRENT TOP OF BUFFER AREA
BMOVEMT1JOBFFC	001462'	202040	001456*	01300	        MOVEM T1,JOBFF
BADDIT1C	001463'	271040	000407	01400	        ADDI T1,<203*2>+1       ;LEAVE THIS MUCH ROOM
BMOVEMT1SVJFFC	001464'	202040	001461*	01500	        MOVEM T1,SVJFF  ;THATS THE NEW TOP
BCAMGET1CORTOPC	001465'	315040	000000*	01600	        CAMGE T1,CORTOP ;WILL THAT RUN US OUT OF CORE?
BJRSTTPOPJC	001466'	254000	001504'	01700	        JRST TPOPJ      ;NO, LEAVE
BPUSHPCTPOPJC	001467'	261740	001503'	01800	        PUSH P,CTPOPJ
BXPANDMOVEIT1C	001470'	201040	002000	01900	XPAND:  MOVEI T1,2000   ;GET SET TO EXPAND
BADDMT1CORTOPC	001471'	272040	001465*	02000	        ADDM T1,CORTOP
BADDMT1CORT1C	001472'	272040	000000*	02100	        ADDM T1,CORT1
BADDT1JOBRELC	001473'	270040	000000*	02200	        ADD T1,JOBREL   ;NEW TOP DESIRED
BCORET1C	001474'	047040	000011	02300		CORE T1,	;ASK FOR IT
BJRSTNOCORC	001475'	254000	001061'	02400	        JRST NOCOR      ;LOSE BIG
BMOVET1JOBRELC	001476'	200040	001473*	02500	        MOVE T1,JOBREL
BMVCRMOVET2T1C	001477'	200101	776000	02600	MVCR:   MOVE T2,-2000(T1)       ;MVOVE CORE UP
BMOVEMT2T1C	001500'	202101	000000	02700	        MOVEM T2,(T1)
BCAMLET1CORTOPC	001501'	313040	001471*	02800	        CAMLE T1,CORTOP ;ARE WE DONE?
BSOJAT1MVCRC	001502'	364040	001477'	02900	        SOJA T1,MVCR
BCTPOPJPOPJPTPOPJC	001503'	263740	001504'	03000	CTPOPJ: POPJ    P,TPOPJ
BTPOPJPOPPT2C	001504'	262740	000002	03100	TPOPJ:  POP P,T2        ;ALL FINISHED
BPOPPT1C	001505'	262740	000001	03200	        POP P,T1
BPOPJPC	001506'	263740	000000	03300	        POPJ P,
BDEFINEDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 20
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	DEFINE TABLE
BTABLEC				00200	<SWITCH COMPILE,<TRZ FL,DOLOD>
BC				00300	SWITCH COM,<TRZ FL,DOLOD>
BC				00400	SWITCH COMP,<TRZ FL,DOLOD>
BC				00500	SWITCH LOAD,<MOVE>
BC				00600	SWITCH CDEBUG,<PUSHJ P,CDEBUG>
BC				00700	SWITCH DEBUG,<PUSHJ P,DEBUG>
BC				00800	SWITCH EXECUTE,<PUSHJ P,XCTR>
BC				00900	SWITCH TRY,<PUSHJ P,TRYIT>
BC				01000	SWITCH FDEBUG,<PUSHJ P,FDEBUG>
BC				01100	SWITCH PRINT,<JRST PRINT>
BC				01200	SWITCH CRE,<PUSHJ P,CREATE>
BC				01300	SWITCH CREATE,<PUSHJ P,CREATE>
BC				01400	SWITCH MODIFY,<PUSHJ P,MODIFY>
BC				01500	SWITCH EDITOR,<PUSHJ P,EDITOR>
BC				01600	SWITCH LIST,<JRST LISTR>
BC				01700	SWITCH DIRECTORY,<JRST DODIR>
BC				01800	SWITCH DIFFERENCES,<JRST DIFFER>
BC				01900	SWITCH CREF,<JRST PLCROS>
BC				02000	SWITCH CROSS,<JRST CREFIT>
BC				02100	SWITCH DELETE,<JRST DODEL>
BC				02200	SWITCH TECO,<PUSHJ P,TECO>
BC				02300	SWITCH MAKE,<PUSHJ P,MAKE>
BC				02400	SWITCH RENAME,<JRST DOREN>
BC				02500	SWITCH TYPE,<JRST TYPR>
BC				02600	SWITCH COPY,<JRST COPY>
BC				02700	SWITCH DECLARE,<JRST DECLARE>
BC				02800	SWITCH PPN,<JRST PPN>
BC				02900	SWITCH FILES,<JRST DOFL>
BC				03000	SWITCH HELP,<JRST HELP>
BC				03100	SWITCH DATE,<JRST DODATE>
BC				03200	SWITCH TYMEX,<JRST TYMEX>
BC				03300	SWITCH PDP10,<JRST PDP10>
BC				03400	SWITCH 10EDIT,<PUSHJ P,EDIT10>
BC				03500	SWITCH FDC,<JRST FDC>
BC				03600	SWITCH PFDC,<JRST PFDC>
BC				03700	SWITCH SETRPG,<JRST SETRPG>
BC				03800	SWITCH SETPROC,<JRST SETPROC>
BC				03900	SWITCH RUN,<JRST RUNCMD>
BC				04000	SWITCH CTEST,<RPGRT>	;ZERO LEFT HALF MEANS LEAVE LICENSE ON
BC				04100	SWITCH MAIL,<MAIL>
BC				04200	SWITCH SEND,<SEND>
BC				04300	SWITCH POSTMAN,<POST>>
BC
BTBGENDEFINEC				04500	TBGEN (COMTAB,COMTLG,COMT2)^DEFINE SWITCH (P,Q)
BSWITCHC					<<SIXBIT /P/>>
BCOMTABTABLESWITCHSIXBITC	001507'	435755	605154		COMTAB:      TABLE^SWITCH COMPILE,<TRZ FL,DOLOD>^<SIXBIT /COMPILE/>^
BSWITCHSIXBITC	001510'	435755	000000		SWITCH COM,<TRZ FL,DOLOD>^<SIXBIT /COM/>^
BSWITCHSIXBITC	001511'	435755	600000		SWITCH COMP,<TRZ FL,DOLOD>^<SIXBIT /COMP/>^
BSWITCHSIXBITC	001512'	545741	440000		SWITCH LOAD,<MOVE>^<SIXBIT /LOAD/>^
BSWITCHSIXBITC	001513'	434445	426547		SWITCH CDEBUG,<PUSHJ P,CDEBUG>^<SIXBIT /CDEBUG/>^
BSWITCHSIXBITC	001514'	444542	654700		SWITCH DEBUG,<PUSHJ P,DEBUG>^<SIXBIT /DEBUG/>^
BSWITCHSIXBITC	001515'	457045	436564		SWITCH EXECUTE,<PUSHJ P,XCTR>^<SIXBIT /EXECUTE/>^
BSWITCHSIXBITDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 20-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	001516'	646271	000000		SWITCH TRY,<PUSHJ P,TRYIT>^<SIXBIT /TRY/>^
BSWITCHSIXBITC	001517'	464445	426547		SWITCH FDEBUG,<PUSHJ P,FDEBUG>^<SIXBIT /FDEBUG/>^
BSWITCHSIXBITC	001520'	606251	566400		SWITCH PRINT,<JRST PRINT>^<SIXBIT /PRINT/>^
BSWITCHSIXBITC	001521'	436245	000000		SWITCH CRE,<PUSHJ P,CREATE>^<SIXBIT /CRE/>^
BSWITCHSIXBITC	001522'	436245	416445		SWITCH CREATE,<PUSHJ P,CREATE>^<SIXBIT /CREATE/>^
BSWITCHSIXBITC	001523'	555744	514671		SWITCH MODIFY,<PUSHJ P,MODIFY>^<SIXBIT /MODIFY/>^
BSWITCHSIXBITC	001524'	454451	645762		SWITCH EDITOR,<PUSHJ P,EDITOR>^<SIXBIT /EDITOR/>^
BSWITCHSIXBITC	001525'	545163	640000		SWITCH LIST,<JRST LISTR>^<SIXBIT /LIST/>^
BSWITCHSIXBITC	001526'	445162	454364		SWITCH DIRECTORY,<JRST DODIR>^<SIXBIT /DIRECTORY/>^
BSWITCHSIXBITC	001527'	445146	464562		SWITCH DIFFERENCES,<JRST DIFFER>^<SIXBIT /DIFFERENCES/>^
BSWITCHSIXBITC	001530'	436245	460000		SWITCH CREF,<JRST PLCROS>^<SIXBIT /CREF/>^
BSWITCHSIXBITC	001531'	436257	636300		SWITCH CROSS,<JRST CREFIT>^<SIXBIT /CROSS/>^
BSWITCHSIXBITC	001532'	444554	456445		SWITCH DELETE,<JRST DODEL>^<SIXBIT /DELETE/>^
BSWITCHSIXBITC	001533'	644543	570000		SWITCH TECO,<PUSHJ P,TECO>^<SIXBIT /TECO/>^
BSWITCHSIXBITC	001534'	554153	450000		SWITCH MAKE,<PUSHJ P,MAKE>^<SIXBIT /MAKE/>^
BSWITCHSIXBITC	001535'	624556	415545		SWITCH RENAME,<JRST DOREN>^<SIXBIT /RENAME/>^
BSWITCHSIXBITC	001536'	647160	450000		SWITCH TYPE,<JRST TYPR>^<SIXBIT /TYPE/>^
BSWITCHSIXBITC	001537'	435760	710000		SWITCH COPY,<JRST COPY>^<SIXBIT /COPY/>^
BSWITCHSIXBITC	001540'	444543	544162		SWITCH DECLARE,<JRST DECLARE>^<SIXBIT /DECLARE/>^
BSWITCHSIXBITC	001541'	606056	000000		SWITCH PPN,<JRST PPN>^<SIXBIT /PPN/>^
BSWITCHSIXBITC	001542'	465154	456300		SWITCH FILES,<JRST DOFL>^<SIXBIT /FILES/>^
BSWITCHSIXBITC	001543'	504554	600000		SWITCH HELP,<JRST HELP>^<SIXBIT /HELP/>^
BSWITCHSIXBITC	001544'	444164	450000		SWITCH DATE,<JRST DODATE>^<SIXBIT /DATE/>^
BSWITCHSIXBITC	001545'	647155	457000		SWITCH TYMEX,<JRST TYMEX>^<SIXBIT /TYMEX/>^
BSWITCHSIXBITC	001546'	604460	212000		SWITCH PDP10,<JRST PDP10>^<SIXBIT /PDP10/>^
BSWITCHSIXBITC	001547'	212045	445164		SWITCH 10EDIT,<PUSHJ P,EDIT10>^<SIXBIT /10EDIT/>^
BSWITCHSIXBITC	001550'	464443	000000		SWITCH FDC,<JRST FDC>^<SIXBIT /FDC/>^
BSWITCHSIXBITC	001551'	604644	430000		SWITCH PFDC,<JRST PFDC>^<SIXBIT /PFDC/>^
BSWITCHSIXBITC	001552'	634564	626047		SWITCH SETRPG,<JRST SETRPG>^<SIXBIT /SETRPG/>^
BSWITCHSIXBITC	001553'	634564	606257		SWITCH SETPROC,<JRST SETPROC>^<SIXBIT /SETPROC/>^
BSWITCHSIXBITC	001554'	626556	000000		SWITCH RUN,<JRST RUNCMD>^<SIXBIT /RUN/>^
BSWITCHSIXBITC	001555'	436445	636400		SWITCH CTEST,<RPGRT>	^<SIXBIT /CTEST/>^;ZERO LEFT HALF MEANS LEAVE LICENSE ON
BSWITCHSIXBITC	001556'	554151	540000		SWITCH MAIL,<MAIL>^<SIXBIT /MAIL/>^
BSWITCHSIXBITC	001557'	634556	440000		SWITCH SEND,<SEND>^<SIXBIT /SEND/>^
BSWITCHSIXBITC	001560'	605763	645541		SWITCH POSTMAN,<POST>^<SIXBIT /POSTMAN/>^^
BCOMTABCOMTLGDEFINESWITCHCOMT2TABLESWITCHTRZFLDOLODC	001561'	620000	000002		COMT2:      TABLE^SWITCH COMPILE,<TRZ FL,DOLOD>^TRZ FL,DOLOD^
BSWITCHTRZFLDOLODC	001562'	620000	000002		SWITCH COM,<TRZ FL,DOLOD>^TRZ FL,DOLOD^
BSWITCHTRZFLDOLODC	001563'	620000	000002		SWITCH COMP,<TRZ FL,DOLOD>^TRZ FL,DOLOD^
BSWITCHMOVEC	001564'	200000	000000		SWITCH LOAD,<MOVE>^MOVE^
BSWITCHPUSHJPCDEBUGC	001565'	260740	001647'		SWITCH CDEBUG,<PUSHJ P,CDEBUG>^PUSHJ P,CDEBUG^
BSWITCHPUSHJPDEBUGC	001566'	260740	001643'		SWITCH DEBUG,<PUSHJ P,DEBUG>^PUSHJ P,DEBUG^
BSWITCHPUSHJPXCTRC	001567'	260740	001644'		SWITCH EXECUTE,<PUSHJ P,XCTR>^PUSHJ P,XCTR^
BSWITCHPUSHJPTRYITC	001570'	260740	001636'		SWITCH TRY,<PUSHJ P,TRYIT>^PUSHJ P,TRYIT^
BSWITCHPUSHJPFDEBUGC	001571'	260740	001640'		SWITCH FDEBUG,<PUSHJ P,FDEBUG>^PUSHJ P,FDEBUG^
BSWITCHJRSTPRINTC	001572'	254000	007550'		SWITCH PRINT,<JRST PRINT>^JRST PRINT^
BSWITCHPUSHJPCREATEC	001573'	260740	007460'		SWITCH CRE,<PUSHJ P,CREATE>^PUSHJ P,CREATE^
BSWITCHPUSHJPCREATEC	001574'	260740	007460'		SWITCH CREATE,<PUSHJ P,CREATE>^PUSHJ P,CREATE^
BSWITCHPUSHJPMODIFYC	001575'	260740	007463'		SWITCH MODIFY,<PUSHJ P,MODIFY>^PUSHJ P,MODIFY^
BSWITCHPUSHJPEDITORC	001576'	260740	007450'		SWITCH EDITOR,<PUSHJ P,EDITOR>^PUSHJ P,EDITOR^
BSWITCHJRSTLISTRC	001577'	254000	007553'		SWITCH LIST,<JRST LISTR>^JRST LISTR^
BSWITCHJRSTDODIRC	001600'	254000	004525'		SWITCH DIRECTORY,<JRST DODIR>^JRST DODIR^
BSWITCHJRSTDIFFERC	001601'	254000	004357'		SWITCH DIFFERENCES,<JRST DIFFER>^JRST DIFFER^
BSWITCHJRSTPLCROSC	001602'	254000	001633'		SWITCH CREF,<JRST PLCROS>^JRST PLCROS^
BSWITCHJRSTCREFITDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 20-3
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	001603'	254000	000000'		SWITCH CROSS,<JRST CREFIT>^JRST CREFIT^
BSWITCHJRSTDODELC	001604'	254000	004531'		SWITCH DELETE,<JRST DODEL>^JRST DODEL^
BSWITCHPUSHJPTECOC	001605'	260740	007456'		SWITCH TECO,<PUSHJ P,TECO>^PUSHJ P,TECO^
BSWITCHPUSHJPMAKEC	001606'	260740	007455'		SWITCH MAKE,<PUSHJ P,MAKE>^PUSHJ P,MAKE^
BSWITCHJRSTDORENC	001607'	254000	005231'		SWITCH RENAME,<JRST DOREN>^JRST DOREN^
BSWITCHJRSTTYPRC	001610'	254000	007551'		SWITCH TYPE,<JRST TYPR>^JRST TYPR^
BSWITCHJRSTCOPYC	001611'	254000	005350'		SWITCH COPY,<JRST COPY>^JRST COPY^
BSWITCHJRSTDECLARC	001612'	254000	005630'		SWITCH DECLARE,<JRST DECLARE>^JRST DECLARE^
BSWITCHJRSTPPNC	001613'	254000	006031'		SWITCH PPN,<JRST PPN>^JRST PPN^
BSWITCHJRSTDOFLC	001614'	254000	004532'		SWITCH FILES,<JRST DOFL>^JRST DOFL^
BSWITCHJRSTHELPC	001615'	254000	005446'		SWITCH HELP,<JRST HELP>^JRST HELP^
BSWITCHJRSTDODATEC	001616'	254000	006250'		SWITCH DATE,<JRST DODATE>^JRST DODATE^
BSWITCHJRSTTYMEXC	001617'	254000	005533'		SWITCH TYMEX,<JRST TYMEX>^JRST TYMEX^
BSWITCHJRSTPDP10C	001620'	254000	005534'		SWITCH PDP10,<JRST PDP10>^JRST PDP10^
BSWITCHPUSHJPEDIT10C	001621'	260740	007462'		SWITCH 10EDIT,<PUSHJ P,EDIT10>^PUSHJ P,EDIT10^
BSWITCHJRSTFDCC	001622'	254000	006317'		SWITCH FDC,<JRST FDC>^JRST FDC^
BSWITCHJRSTPFDCC	001623'	254000	006353'		SWITCH PFDC,<JRST PFDC>^JRST PFDC^
BSWITCHJRSTSETRPGC	001624'	254000	000100'		SWITCH SETRPG,<JRST SETRPG>^JRST SETRPG^
BSWITCHJRSTSETPROC	001625'	254000	002053'		SWITCH SETPROC,<JRST SETPROC>^JRST SETPROC^
BSWITCHJRSTRUNCMDC	001626'	254000	002111'		SWITCH RUN,<JRST RUNCMD>^JRST RUNCMD^
BSWITCHRPGRTC	001627'	000000	002251'		SWITCH CTEST,<RPGRT>	^RPGRT	^;ZERO LEFT HALF MEANS LEAVE LICENSE ON
BSWITCHMAILC	001630'	000000	007032'		SWITCH MAIL,<MAIL>^MAIL^
BSWITCHSENDC	001631'	000000	006410'		SWITCH SEND,<SEND>^SEND^
BSWITCHPOSTC	001632'	000000	007356'		SWITCH POSTMAN,<POST>^POST^^
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 21
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;ROUTINES TO INITIALIZE FOR VARIOUS LOAD-TYPE COMMANDS (AND SOME OTHERS)
BC
BPLCROSOUTSTRASCIZC	001633'	051140	011237'	00300	PLCROS: OUTSTR  [ASCIZ /PLEASE USE CROSS COMMAND/]
BRESETC	001634'	047000	000000	00400	        RESET           ;AND EXIT
BJRSTEXC	001635'	254000	001410'	00500	        JRST    EX      ;...
BC
BTRYITMOVET2SIXBITC	001636'	200100	011244'	00700	TRYIT:  MOVE    T2,[SIXBIT /(DE)/]
BJRSTLODSIXC	001637'	254000	001645'	00800	        JRST    LODSIX
BC
BFDEBUGMOVSIT2SIXBITC	001640'	205100	176300	01000	FDEBUG: MOVSI   T2,(SIXBIT '/S');GIVE LOAD WITH SYMBOLS SWITCH
BPUSHJPLODSIXC	001641'	260740	001645'	01100	        PUSHJ   P,LODSIX        ;TO THE LOADER
BTROAFL3FDBGSWC	001642'	664440	200000	01200	        TROA    FL3,FDBGSW      ;INDICATE FDEBUG IN PROGRESS
BDEBUGSKIPAT2SIXBITC	001643'	334100	011245'	01300	DEBUG:  SKIPA   T2,[SIXBIT '/T']
BXCTRMOVSIT2SIXBITC	001644'	205100	174500	01400	XCTR:   MOVSI T2,SIXBIT '   /E '
BLODSIXMOVEIT3OUTLODC	001645'	201140	010147'	01500	LODSIX: MOVEI   T3,OUTLOD
BJRSTOUTSIXC	001646'	254000	004206'	01600	        JRST    OUTSIX
BC
BCDEBUGSETOMCDEBFLCDEBFLC	001647'	476000	001163*	01800	CDEBUG:	SETOM	CDEBFL#
BMOVET2SIXBITC	001650'	200100	011246'	01900		MOVE	T2,[SIXBIT*/4Y/E*]
BJRSTLODSIXC	001651'	254000	001645'	02000		JRST	LODSIX
BC
BRPGSETMOVET1POINTFCOMDC	001652'	200040	011247'	02200	RPGSET: MOVE T1,[POINT 7,FCOMD]
BMOVEMT1DINPTC	001653'	202040	000634*	02300	        MOVEM T1,DINPT
BMOVEIFLRPGSRCRECALFCMDSNC	001654'	201000	201004	02400	        MOVEI FL,RPGSRC!RECALF!CMDSN
BJRSTRPGRETC	001655'	254000	002250'	02500	        JRST RPGRET
BC
BC				02700	;ROUTINE TO SET UP SVC FILE FOR -LOAD<CR> TYPE COMMAND
BTRYSVDTRZEFLALTSRCC	001656'	622000	000010	02800	TRYSVD: TRZE FL,ALTSRC  ;FROM COMMAND?
BJRSTTRYSV2C	001657'	254000	001664'	02900	        JRST TRYSV2
BMOVET1POINTFCOMD3C	001660'	200040	011250'	03000	        MOVE T1,[POINT 7,FCOMD3]
BMOVEMT1DINPTC	001661'	202040	001653*	03100	        MOVEM T1,DINPT
BMOVEIFLRECALFCMDSNALTSRCC	001662'	201000	201010	03200	        MOVEI FL,RECALF!CMDSN!ALTSRC
BJRSTRPGRETC	001663'	254000	002250'	03300	        JRST RPGRET     ;TRY AGAIN
BTRYSV2HLLZCJOBNAMC	001664'	510700	001326*	03400	TRYSV2: HLLZ C,JOBNAM
BHRRICSIXBITC	001665'	541700	454463	03500	        HRRI C,(SIXBIT /EDS/)
BMOVEMCSVNAMSVPTC	001666'	202714	001233*	03600	        MOVEM C,SVNAM(SVPT)
BMOVSICSIXBITC	001667'	205700	645560	03700	        MOVSI C,(SIXBIT /TMP/)
BMOVEMCSVEXTSVPTC	001670'	202714	001235*	03800	        MOVEM C,SVEXT(SVPT)
BHRRZCBUFTABIOPNTC	001671'	550706	000754*	03900	        HRRZ C,BUFTAB(IOPNT)
BMOVEMCJOBFFC	001672'	202700	001462*	04000	        MOVEM C,JOBFF   ;RESET SINCE ONE INBUF ALREADY DONE
BJRSTRENESTC	001673'	254000	000666'	04100	        JRST RENEST
BC
BC				04300	;ROUTINE TO GET A CHARACTER STRING FROM THE TTY AND STUFF IT IN
BC				04400	;DDTBUF. BUFFERED INPUT WOULD BE A NICER WAY TO DO THIS BUT WOULD
BC				04500	;REQUIRE AN EXTRA CHANNEL (CHANNELS ARE SCARCE IN THIS PROGRAM).
BGSTRNMOVET1POINTDDTBUFC	001674'	200040	011223'	04600	GSTRN:  MOVE    T1,[POINT 7,DDTBUF]     ;SET POINTER
BMOVEMT1DINPTC	001675'	202040	001661*	04700	        MOVEM   T1,DINPT
BGSTRN1INCHWLT2C	001676'	051200	000002	04800	GSTRN1:	INCHWL	T2
BCAMET1POINTDDTBUFC	001677'	312040	011251'	04900		CAME	T1,[POINT 7,DDTBUF+^D99,6]
BIDPBT2T1C	001700'	136100	000001	05000		IDPB	T2,T1	;PUT CHAR IN BUF IF NOT FULL
BMOVET3CTBLT2C	001701'	200142	000405'	05100	        MOVE    T3,CTBL(T2)     ;GET CHAR DESCRIPTOR
BTLNNT3TERMFC	001702'	607140	200000	05200	        TLNN    T3,TERMF        ;IS IT A BREAK CHAR?
BJRSTGSTRN1C	001703'	254000	001676'	05300	        JRST    GSTRN1  ;NO, GET MORE
BMOVEIT2DRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 21-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	001704'	201100	000177	05400	        MOVEI   T2,177  ;MARK EN WITH AN EOF FLAG
BIDPBT2T1C	001705'	136100	000001	05500	        IDPB    T2,T1
BIDPBT2T1C	001706'	136100	000001	05600	        IDPB    T2,T1
BSETZBCSSAVCHRC	001707'	403640	000664*	05700		SETZB	CS,SAVCHR
BPOPJPC	001710'	263740	000000	05800	        POPJ    P,
BC
BSTTYMXHRROIT1GETPRVC	001711'	561040	000006	06000	STTYMX: HRROI   T1,GETPRV       ;SET TYMEX FLAG IF REQ.
BGETTABT1C	001712'	047040	000041	06100	        GETTAB  T1,
BJRSTEXC	001713'	254000	001410'	06200	        JRST    EX
BTRNET1PVTYMXC	001714'	602040	000200	06300	        TRNE    T1,PVTYMX
BTROFL3TYMXC	001715'	660440	040000	06400	        TRO     FL3,TYMX        ;SET FLAG
BPOPJPC	001716'	263740	000000	06500	        POPJ    P,
BCOMMENDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 22
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	COMMENT %
BC				00200	ROUTINES TO HANDLE RPG PARAMETER FILE
BC
BC				00400	THE RPG PARAMETER FILE, TMPCOR:RPG OR DSK:###RPG.TMP,
BC				00500	CONSISTS OF A SERIES OF PARAMETER BLOCKS.  EACH BLOCK
BC				00600	BEGINS WITH A HEADER WORD WHICH HAS THE FORMAT
BC
BC				00800	<TYPE>,,<LENGTH>
BC
BC				01000	WHERE <TYPE> IS A POSITIVE INTEGER SPECIFYING WHICH PARAMETER
BC				01100	THE BLOCK IS FOR, AND <LENGTH> IS THE NUMBER OF DATA WORDS
BC				01200	WHICH FOLLOW THE HEADER WORD.  ONLY ONE BLOCK
BC				01300	OF EACH TYPE MAY APPEAR, AND THE LAST HEADER WORD IN THE FILE
BC				01400	IS ZERO, INDICATING END OF FILE.
BC
BC				01600	THE PARAMETER FILE IS READ INTO CORE AT INITIALIZATION TIME,
BC				01700	AND RPGPAR CONTAINS THE LOCATION OF THE FIRST WORD.  AS RPG
BC				01800	RUNS, THE COPY OF THE FILE IN CORE MAY BE MODIFIED.  THIS
BC				01900	IS DONE BY REPRESENTING THE FILE AS A LINKED LIST AS ENTRIES
BC				02000	ARE ADDED OR DELETED.  WHEN THE FILE IS IN CORE, AN ADDITIONAL
BC				02100	BLOCK TYPE -1 IS USED, WHICH INDICATES THAT THE <LENGTH>
BC				02200	FIELD OF THE WORD IS A POINTER TO THE NEXT PART OF THE FILE.
BC				02300	A LINK WILL ALWAYS CONTAIN AN ADDRESS GREATER THAN THE
BC				02400	LOCATION CONTAINING THE LINK, AND THE ROUTINE WHICH COLLAPSES
BC				02500	THE FILE INTO ITS DISK FORMAT DEPENDS ON THIS.
BC				02600	%
BC
BC				02800	;THE VALID BLOCK TYPES
BC				02900	;IF ANY OF THESE ARE CHANGED OR NEW ONES ADDED, BE SURE
BC				03000	;TO UPDATE THE 'TYPRPG' ROUTINE IN THE TC PROGRAM TO HANDLE
BC				03100	;THE CHANGES.
BC
BP.RPGRC			000001	03300	P.RPGRN==1	;LENGTH=6. DATA IS A RUN BLOCK FOR RUNNING
BC				03400			;AN ALTERNATE VERSION OF RPG
BP.SPROC			000002	03500	P.SPROC==2	;LENGTH=N*7 WHERE N IS THE NUMBER OF 7-WORD ENTRIES.
BC				03600			;ENTRY FORMAT: WORD 0 = PROCESSOR NAME, WORDS 1-6 =
BC				03700			;RUN BLOCK FOR PROCESSOR USED INSTEAD OF SYS:NAME.
BC
BC				03900	;ROUTINE TO LOOK UP A PARAMETER.  CALLED WITH T1=TYPE.
BC				04000	;RETURNS SKIPPING WITH T2->BLOCK HEADER, T1->DATA BLOCK (T2+1).
BC				04100	;NO SKIP IF NOT FOUND.
BC
BGETPARMOVET2RPGPARRPGPARC	001717'	200100	000000*	04300	GETPAR:	MOVE T2,RPGPAR#	;GET PARAMETER POINTER
BGETPRLHLRET3T2C	001720'	574142	000000	04400	GETPRL:	HLRE T3,(T2)	;GET BLOCK TYPE
BJUMPET3CPOPJC	001721'	322140	004213'	04500		JUMPE T3,CPOPJ	;RETURN IF NOT FOUND
BJUMPLT3HRRZT2T2C				04600		JUMPL T3,[HRRZ T2,(T2)	;LINK, GET NEXT
BJRSTGETPRLC	001722'	321140	011252'	04700			JRST GETPRL]
BCAMNT1T3C	001723'	316040	000003	04800		CAMN T1,T3	;DOES IT MATCH DESIRED TYPE?
BJRSTGETPRRC	001724'	254000	001730'	04900		JRST GETPRR
BADDT2T2C	001725'	270102	000000	05000		ADD T2,(T2)
BMOVEIT2T2C	001726'	201102	000001	05100		MOVEI T2,1(T2)	;NO, GO TO NEXT HEADER AND CONTINUE
BJRSTGETPRLC	001727'	254000	001720'	05200		JRST GETPRL
BGETPRRMOVEIT1T2C	001730'	201042	000001	05300	GETPRR:	MOVEI T1,1(T2)	;YES, SET DATA POINTER AND SKIP RETURN
BJRSTCPOPJ1DRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 22-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	001731'	254000	002747'	05400		JRST CPOPJ1
BC
BC				05600	;ROUTINE TO SET A PARAMETER.  CALLED WITH T1=TYPE, T2=LENGTH,
BC				05700	;AND T3=LOCATION OF DATA FOR PARAMETER.
BC
BSETPARPUSHPT1C	001732'	261740	000001	05900	SETPAR:	PUSH P,T1	;-2(P)=TYPE
BPUSHPT2C	001733'	261740	000002	06000		PUSH P,T2	;-1(P)=LENGTH
BPUSHPT3C	001734'	261740	000003	06100		PUSH P,T3	;(P)=LOC OF DATA
BSETPRFPUSHJPGETPARC	001735'	260740	001717'	06200	SETPRF:	PUSHJ P,GETPAR	;LOOK UP TYPE
BJRSTSETPREC	001736'	254000	001743'	06300		JRST SETPRE	;NOT FOUND, T2 POINTS TO END OF FILE
BADDT1T2C	001737'	270042	000000	06400		ADD T1,(T2)
BHRROMT1T2C	001740'	562042	000000	06500		HRROM T1,(T2)	;FOUND, DELETE OLD ENTRY
BMOVET1PC	001741'	200057	777776	06600		MOVE T1,-2(P)	;GET TYPE BACK
BJRSTSETPRFC	001742'	254000	001735'	06700		JRST SETPRF	;GO BACK TO SET UP T2
BSETPRESKIPNPC	001743'	336017	777777	06800	SETPRE:	SKIPN -1(P)
BJRSTSETPRXC	001744'	254000	001766'	06900		JRST SETPRX	;DONE IF LENGTH=0 (DELETED ENTRY)
BHRROT1SVJBFFC	001745'	560040	001464*	07000		HRRO T1,SVJBFF	;GET FIRST AVAILABLE WORD
BMOVEMT1T2C	001746'	202042	000000	07100		MOVEM T1,(T2)	;SET UP LINK TO NEW BLOCK
BADDT1PC	001747'	270057	777777	07200		ADD T1,-1(P)	;GET TOP OF NEW DATA BLOCK
BMOVEIT1T1C	001750'	201041	000002	07300		MOVEI T1,2(T1)	;NEW FREE CORE LOC
BPUSHPSVJBFFC	001751'	261740	001745*	07400		PUSH P,SVJBFF
BMOVEMT1SVJBFFC	001752'	202040	001751*	07500		MOVEM T1,SVJBFF	;ALLOCATE IT
BCAMLET1CORTOPC	001753'	313040	001501*	07600		CAMLE T1,CORTOP
BPUSHJPXPANDC	001754'	260740	001470'	07700		PUSHJ P,XPAND	;EXPAND CORE IF NECESSARY
BPOPPT1C	001755'	262740	000001	07800		POP P,T1	;GET BACK PTR TO OUR AREA
BHRLZT2PC	001756'	514117	777776	07900		HRLZ T2,-2(P)
BHRRT2PC	001757'	540117	777777	08000		HRR T2,-1(P)	;SET UP HEADER WORD: TYPE,,LENGTH
BMOVEMT2T1C	001760'	202101	000000	08100		MOVEM T2,(T1)	;PUT IN FILE
BADDIT1C	001761'	271040	000001	08200		ADDI T1,1	;POINT TO DATA AREA
BHRLT1PC	001762'	504057	000000	08300		HRL T1,(P)	;SET UP BLT WORD
BMOVET2SVJBFFC	001763'	200100	001752*	08400		MOVE T2,SVJBFF	;JUST ABOVE TOP OF OUR AREA
BBLTT1T2C	001764'	251042	777776	08500		BLT T1,-2(T2)	;MOVE DATA INTO FILE
BSETZMT2C	001765'	402002	777777	08600		SETZM -1(T2)	;ZERO TO TERMINATE
BSETPRXSUBPC	001766'	274740	011254'	08700	SETPRX:	SUB P,[3,,3]	;POP PARAMETERS OUT OF STACK
BSETOMMODPARMODPARC	001767'	476000	000000*	08800		SETOM MODPAR#	;SHOW FILE HAS BEEN MODIFIED
BPOPJPC	001770'	263740	000000	08900		POPJ P,
BC
BC				09100	;ROUTINE TO COLLAPSE AND WRITE OUT PARAMETER FILE.  CALLED
BC				09200	;BEFORE RPG EXITS OR RUNS ANOTHER PROGRAM.
BC
BWRTPARRESETC	001771'	047000	000000	09400	WRTPAR:	RESET		;CLOSE ALL I/O FIRST
BAOSEMODPARC	001772'	352000	001767*	09500		AOSE MODPAR	;CHECK WHETHER FILE HAS BEEN MODIFIED
BPOPJPC	001773'	263740	000000	09600		POPJ P,		;NO MODS OR ALREADY WRITTEN
BMOVET1RPGPARC	001774'	200040	001717*	09700		MOVE T1,RPGPAR
BMOVET2T1C	001775'	200100	000001	09800		MOVE T2,T1	;SET UP TO COLLAPSE LIST
BWRTPRLMOVET3T2C	001776'	200140	000002	09900	WRTPRL:	MOVE T3,T2	;TAKE MY WORD FOR IT THAT THIS ROUTINE
BWRTPRFHLRET4T3C	001777'	574203	000000	10000	WRTPRF:	HLRE T4,(T3)	;DOES INDEED COLLAPSE THE LIST.  IT IS
BJUMPLET4WRTPRBC	002000'	323200	002004'	10100		JUMPLE T4,WRTPRB;MUCH TOO OBSCURE TO COMMENT.
BADDT3T3C	002001'	270143	000000	10200		ADD T3,(T3)
BMOVEIT3T3C	002002'	201143	000001	10300		MOVEI T3,1(T3)
BJRSTWRTPRFC	002003'	254000	001777'	10400		JRST WRTPRF
BWRTPRBMOVET4T1C	002004'	200200	000001	10500	WRTPRB:	MOVE T4,T1
BHRLT4T2C	002005'	504200	000002	10600		HRL T4,T2
BMOVET5T3DRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 22-3
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	002006'	200240	000003	10700		MOVE T5,T3
BSUBT5T2C	002007'	274240	000002	10800		SUB T5,T2
BADDT5T1C	002010'	270240	000001	10900		ADD T5,T1
BBLTT4T5C	002011'	251205	000000	11000		BLT T4,(T5)
BMOVET1T5C	002012'	200040	000005	11100		MOVE T1,T5
BSKIPET2T5C	002013'	332105	000000	11200		SKIPE T2,(T5)
BJRSTWRTPRLC	002014'	254000	001776'	11300		JRST WRTPRL
BSUBT5RPGPARC	002015'	274240	001774*	11400		SUB T5,RPGPAR	;DONE COLLAPSING, GET LENGTH
BMOVNIT5T5C	002016'	211245	000001	11500		MOVNI T5,1(T5)
BHRLZT5T5C	002017'	514240	000005	11600		HRLZ T5,T5
BHRRT5RPGPARC	002020'	540240	002015*	11700		HRR T5,RPGPAR
BSUBIT5C	002021'	275240	000001	11800		SUBI T5,1	;SET UP IOWD FOR WRITING FILE
BMOVEMT5TMPFILC	002022'	202240	001350*	11900		MOVEM T5,TMPFIL+1
BMOVSIT4C	002023'	205200	626047	12000		MOVSI T4,'RPG'
BMOVEMT4TMPFILC	002024'	202200	001333*	12100		MOVEM T4,TMPFIL
BMOVET1TMPFILC	002025'	200040	011225'	12200		MOVE T1,[3,,TMPFIL]
BTMPCORT1C	002026'	047040	000044	12300		TMPCOR T1,	;TRY TMPCOR FIRST
BJRSTC	002027'	254000	002031'	12400		JRST .+2
BPOPJPC	002030'	263740	000000	12500		POPJ P,		;IT WORKED, WHEW!
BRELEASLOOKC	002031'	071000	000000	12600		RELEAS LOOK,
BINITLOOKC	002032'	041000	000017	12700		INIT LOOK,17	;OH WELL, TRY DISK
BSIXBITC	002033'	446353	000000	12800		SIXBIT/DSK/
BC	002034'	000000	000000	12900		0
BHALTC	002035'	254200	002035'	13000		HALT .
BMOVET1JOBNAMC	002036'	200040	001664*	13100		MOVE T1,JOBNAM
BHRRIT1C	002037'	541040	626047	13200		HRRI T1,'RPG'	;SET UP FILE NME
BMOVSIT2C	002040'	205100	645560	13300		MOVSI T2,'TMP'
BSETZBT3T4C	002041'	403140	000004	13400		SETZB T3,T4
BENTERLOOKT1C	002042'	077000	000001	13500		ENTER LOOK,T1
BHALTC	002043'	254200	002043'	13600		HALT .
BMOVET1T5C	002044'	200040	000005	13700		MOVE T1,T5	;SET UP OUTPUT LIST
BMOVEIT2C	002045'	201100	000000	13800		MOVEI T2,0
BOUTLOOKT1C	002046'	057000	000001	13900		OUT LOOK,T1	;WRITE THE FILE
BJRSTC	002047'	254000	002051'	14000		JRST .+2
BHALTC	002050'	254200	002050'	14100		HALT .
BRELEASLOOKC	002051'	071000	000000	14200		RELEAS LOOK,
BPOPJPC	002052'	263740	000000	14300		POPJ P,
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 23
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;ROUTINE TO HANDLE SETPROCS COMMAND
BC
BSETPROPUSHPSVJBFFC	002053'	261740	001763*	00300	SETPRO:	PUSH P,SVJBFF	;(P) BEGINNING OF OUR SCRATCH AREA
BSPRLPPUSHJPSCANC	002054'	260740	000276'	00400	SPRLP:	PUSHJ P,SCAN	;SCAN PROCESSOR NAME
BCAINCC	002055'	306700	000054	00500		CAIN C,","
BJRSTSPRLPC	002056'	254000	002054'	00600		JRST SPRLP
BTRNNFLIDFC	002057'	606000	000020	00700		TRNN FL,IDF
BJRSTSPRENDC	002060'	254000	002101'	00800		JRST SPREND
BMOVEIT1C	002061'	201040	000007	00900		MOVEI T1,7
BADDBT1SVJBFFC	002062'	273040	002053*	01000		ADDB T1,SVJBFF	;WAS A NAME THERE, RESERVE SPACE
BCAMLET1CORTOPC	002063'	313040	001753*	01100		CAMLE T1,CORTOP
BPUSHJPXPANDC	002064'	260740	001470'	01200		PUSHJ P,XPAND	;MAKE ROOM IF NECESSARY
BMOVET1SVJBFFC	002065'	200040	002062*	01300		MOVE T1,SVJBFF
BMOVET2ACCUMC	002066'	200100	001072*	01400		MOVE T2,ACCUM
BMOVEMT2T1C	002067'	202101	777771	01500		MOVEM T2,-7(T1)	;SAVE PROCESSOR NAME
BPUSHJPSCANC	002070'	260740	000276'	01600		PUSHJ P,SCAN
BCAIECC	002071'	302700	000075	01700		CAIE C,"="	;BETTER HAVE = AFTER NAME
BJRSTSYNERRC	002072'	254000	001065'	01800		JRST SYNERR
BPUSHJPSETRNFC	002073'	260740	000060'	01900		PUSHJ P,SETRNF	;CONVERT IT TO A RUN BLOCK
BMOVET1SVJBFFC	002074'	200040	002065*	02000		MOVE T1,SVJBFF
BMOVSIT2ALTRUNC	002075'	205100	001405*	02100		MOVSI T2,ALTRUN
BHRRIT2T1C	002076'	541101	777772	02200		HRRI T2,-6(T1)
BBLTT2T1C	002077'	251101	777777	02300		BLT T2,-1(T1)	;MOVE INTO TABLE
BJRSTSPRLPC	002100'	254000	002054'	02400		JRST SPRLP	;GO FOR ANOTHER
BSPRENDTLNNCSTERMFC	002101'	607640	200000	02500	SPREND:	TLNN CS,TERMF
BJRSTSYNERRC	002102'	254000	001065'	02600		JRST SYNERR	;BETTER HAVE ENDED RIGHT
BMOVEIT1P.SPROC	002103'	201040	000002	02700		MOVEI T1,P.SPROC
BPOPPT3C	002104'	262740	000003	02800		POP P,T3	;START OF BLOCK
BMOVET2SVJBFFC	002105'	200100	002074*	02900		MOVE T2,SVJBFF
BSUBT2T3C	002106'	274100	000003	03000		SUB T2,T3	;SIZE OF BLOCK
BPUSHJPSETPARC	002107'	260740	001732'	03100		PUSHJ P,SETPAR	;SET UP PARAMETER BLOCK
BJRSTXITC	002110'	254000	001415'	03200		JRST XIT	;ALL DONE
BC
BRUNCMDPUSHJPSETRNFC	002111'	260740	000060'	03400	RUNCMD:	PUSHJ P,SETRNF	;HANDLE RUN COMMAND - EASY AS PYE
BJRSTNUNDOC	002112'	254000	000002'	03500		JRST NUNDO
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 24
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;HERE WE GO TO START THE WORLD TURNING
BC
BHALTC	002113'	254200	002113'	00300		HALT	.	;THERE WAS SOME CODE HERE WHICH FAKED AN 'EDIT'
BC				00400				;COMMAND. SINCE A RUN UUO WITH AN INCREMENT OF -1
BC				00500				;IS ILLEGAL ON A RUN-ONLY PROGRAM, THIS CODE WAS
BC				00600				;WAS PROBABLY WRONG. THE HALT HERE MAY CATCH THE CULPRIT
BC				00700				;WITH SOME LUCK.
BC
BSTPTTDZAT4T4C	002114'	634200	000004	00900	STPT:   TDZA    T4,T4           ;NORMAL ENTRY
BMOVEIT4C	002115'	201200	000001	01000		MOVEI T4,1	;REENTRY FROM AN EDITOR
BSETZMLOWSTC	002116'	402000	000000*	01100	        SETZM   LOWST           ;MUST CLEAR LOW CORE
BMOVET1XWDLOWSTLOWSTC	002117'	200040	011255'	01200	        MOVE    T1,[XWD LOWST,LOWST+1]
BBLTT1LOWTOPC	002120'	251040	000000*	01300	        BLT     T1,LOWTOP
BMOVEMT4STRTFLSTRTFLC	002121'	202200	000000*	01400		MOVEM T4,STRTFL#	;SAVE START INCREMENT
BRESETC	002122'	047000	000000	01500	        RESET
BMOVEPPDPC	002123'	200740	010735'	01600		MOVE P,PDP
BGETPPNT1C	002124'	047040	000024	01700		GETPPN T1,	;GET USER'S PPN
BMOVEMT1USRPPNC	002125'	202040	000000*	01800		MOVEM T1,USRPPN
BMOVEIT1C	002126'	201040	000003	01900		MOVEI T1,3
BPJOBT2C	002127'	047100	000030	02000		PJOB T2,
BIDIVIT2C	002130'	231100	000012	02100		IDIVI T2,12
BADDIT3C	002131'	271140	000020	02200		ADDI T3,20	;MAKE SIXBIT JOB NUMBER FOR NAMES
BLSHCT3C	002132'	246140	777772	02300		LSHC T3,-6
BSOJGT1C	002133'	367040	002130'	02400		SOJG T1,.-3
BHLLZMT4JOBNAMC	002134'	512200	002036*	02500		HLLZM T4,JOBNAM
BMOVET1JOBFFC	002135'	200040	001672*	02600		MOVE T1,JOBFF
BMOVEMT1RPGPARC	002136'	202040	002020*	02700		MOVEM T1,RPGPAR
BCAMGT1JOBRELC	002137'	317040	001476*	02800		CAMG T1,JOBREL
BJRSTC	002140'	254000	002143'	02900		JRST .+3
BCORET3C	002141'	047140	000011	03000		CORE T3,	;TAKE CARE OF THE ONE-IN-A-K CASE WHERE
BHALTC	002142'	254200	002142'	03100		HALT .		;JOBFF>JOBREL
BSETZMJOBFFC	002143'	402020	002135*	03200		SETZM @JOBFF	;SET UP NULL FILE IN CASE NONE FOUND
BRPITMPMOVSIT1C	002144'	205040	626047	03300	RPITMP:	MOVSI T1,'RPG'
BMOVEMT1TMPFILC	002145'	202040	002024*	03400		MOVEM T1,TMPFIL
BMOVET3JOBFFC	002146'	200140	002143*	03500		MOVE T3,JOBFF
BSUBIT3C	002147'	275140	000001	03600		SUBI T3,1
BMOVET4JOBFFC	002150'	200200	002146*	03700		MOVE T4,JOBFF
BSUBT4JOBRELC	002151'	274200	002137*	03800		SUB T4,JOBREL
BHRLIT3T4C	002152'	505144	000000	03900		HRLI T3,(T4)	;SET UP TMPCOR IOWD
BMOVEMT3TMPFILC	002153'	202140	002022*	04000		MOVEM T3,TMPFIL+1
BMOVET1TMPFILC	002154'	200040	011056'	04100		MOVE T1,[1,,TMPFIL]
BTMPCORT1C	002155'	047040	000044	04200		TMPCOR T1,	;TRY READING IT
BJRSTRPIDSKC	002156'	254000	002170'	04300		JRST RPIDSK	;NO LUCK, TRY DISK
BMOVNT4T4C	002157'	210200	000004	04400		MOVN T4,T4
BCAIGT1T4C	002160'	307044	000000	04500		CAIG T1,(T4)	;WAS BUFFER LARGE ENOUGH?
BJRSTRPITOKC	002161'	254000	002166'	04600		JRST RPITOK	;YES
BADDT1JOBFFC	002162'	270040	002150*	04700		ADD T1,JOBFF
BCORET1C	002163'	047040	000011	04800		CORE T1,	;NO, EXPAND
BHALTC	002164'	254200	002164'	04900		HALT .
BJRSTRPITMPC	002165'	254000	002144'	05000		JRST RPITMP
BRPITOKADDMT1JOBFFC	002166'	272040	002162*	05100	RPITOK:	ADDM T1,JOBFF	;BUMP PAST FILE
BJRSTRPICKPC	002167'	254000	002222'	05200		JRST RPICKP
BRPIDSKINITLOOKC	002170'	041000	000017	05300	RPIDSK:	INIT LOOK,17
BSIXBITDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 24-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	002171'	446353	000000	05400		SIXBIT/DSK/
BC	002172'	000000	000000	05500		0
BHALTC	002173'	254200	002173'	05600		HALT .
BMOVET1JOBNAMC	002174'	200040	002134*	05700		MOVE T1,JOBNAM
BHRRIT1C	002175'	541040	626047	05800		HRRI T1,'RPG'
BMOVSIT2C	002176'	205100	645560	05900		MOVSI T2,'TMP'
BSETZBT3T4C	002177'	403140	000004	06000		SETZB T3,T4
BLOOKUPLOOKT1C	002200'	076000	000001	06100		LOOKUP LOOK,T1
BJRSTRPINOFC	002201'	254000	002217'	06200		JRST RPINOF
BHRRT4JOBFFC	002202'	540200	002166*	06300		HRR T4,JOBFF
BSUBIT4C	002203'	275200	000001	06400		SUBI T4,1
BHLRET1T4C	002204'	574040	000004	06500		HLRE T1,T4
BMOVNT1T1C	002205'	210040	000001	06600		MOVN T1,T1
BADDBT1JOBFFC	002206'	273040	002202*	06700		ADDB T1,JOBFF	;ALLOW FOR SIZE OF FILE
BCAMGT1JOBRELC	002207'	317040	002151*	06800		CAMG T1,JOBREL
BJRSTC	002210'	254000	002213'	06900		JRST .+3
BCORET1C	002211'	047040	000011	07000		CORE T1,	;EXPAND IF NECESSARY
BHALTC	002212'	254200	002212'	07100		HALT .
BMOVEIT5C	002213'	201240	000000	07200		MOVEI T5,0
BINLOOKT4C	002214'	056000	000004	07300		IN LOOK,T4	;INPUT PARAMETER FILE
BJRSTRPIDRLC	002215'	254000	002221'	07400		JRST RPIDRL
BHALTC	002216'	254200	002216'	07500		HALT .
BRPINOFAOSJOBFFC	002217'	350000	002206*	07600	RPINOF:	AOS JOBFF	;NO FILE, MARK THE ONE ZERO WORD IN USE
BSETOMMODPARC	002220'	476000	001772*	07700		SETOM MODPAR	;SET FLAG SO FILE GETS WRITTEN
BRPIDRLRELEASLOOKC	002221'	071000	000000	07800	RPIDRL:	RELEAS LOOK,
BRPICKPSKIPERPGDBRPGDBC	002222'	332000	011023'	07900	RPICKP:	SKIPE [RPGDB]
BJRSTRPST2C	002223'	254000	002240'	08000		JRST RPST2	;FORGET SPECIAL RPG IF IN DEBUG MODE
BMOVEIT1P.RPGRC	002224'	201040	000001	08100		MOVEI T1,P.RPGRN
BPUSHJPGETPARC	002225'	260740	001717'	08200		PUSHJ P,GETPAR	;CHECK FOR SPECIAL RPG TO RUN
BJRSTRPST2C	002226'	254000	002240'	08300		JRST RPST2	;NOPE
BHRROIT2C	002227'	561100	777753	08400		HRROI T2,-25	;YES, WHERE DID WE COME FROM?
BGETTABT2C	002230'	047100	000041	08500		GETTAB T2,
BHALTC	002231'	254200	002231'	08600		HALT .
BHRROIT3C	002232'	561140	000003	08700		HRROI T3,3	;AND GET OUR NAME
BGETTABT3C	002233'	047140	000041	08800		GETTAB T3,
BHALTC	002234'	254200	002234'	08900		HALT .
BCAMNT2T1C	002235'	316101	000004	09000		CAMN T2,4(T1)	;PPN MUST MATCH
BCAMET3T1C	002236'	312141	000001	09100		CAME T3,1(T1)	;AND NAME MUST MATCH
BJRSTHRLT1STRTFLC				09200		JRST [	HRL T1,STRTFL	;A MISMATCH, WE ARE THE WRONG RPG
BRUNT1C				09300			RUN T1,		;RUN THE RIGHT RPG WITH THE SAME INCREMENT
BHALTC	002237'	254000	011256'	09400			HALT .]
BRPST2SKIPESTRTFLC	002240'	332000	002121*	09500	RPST2:	SKIPE STRTFL
BJRSTRPGSETC	002241'	254000	001652'	09600		JRST RPGSET	;OK, DO FUNNY STUFF FOR EDITOR CALL
BSKIPERPGDBRPGDBDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 25
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	002242'	332000	011023'	00100		SKIPE	[RPGDB]
BOUTSTRASCIZC	002243'	051140	011261'	00200		OUTSTR	[ASCIZ/:-/]	;DEBUG MODE, GIVE A FUNNY GLITCH
BSKIPNRPGDBRPGDBC	002244'	336000	011023'	00300		SKIPN	[RPGDB]
BRESCANC	002245'	051400	000000	00400		RESCAN			;NORMAL MODE, RESCAN COMMAND LINE
BMOVEIFLC	002246'	201000	000000	00500		MOVEI FL,0
BPUSHJPGSTRNC	002247'	260740	001674'	00600		PUSHJ P,GSTRN	;GET THE COMMAND STRING
BRPGRETTDZAFL3FL3C	002250'	634440	000011	00700	RPGRET:	TDZA FL3,FL3
BRPGRTMOVEIFL3SPCOMC	002251'	201440	100000	00800	RPGRT:	MOVEI FL3,SPCOM
BMOVET1XWDINIDATINILOWC	002252'	200040	011262'	00900	        MOVE T1,[XWD INIDAT,INILOW]
BBLTT1INILOWINILENC	002253'	251040	000000*	01000	        BLT T1,INILOW+INILEN-1
BMOVET4JOBNAMC	002254'	200200	002174*	01100		MOVE T4,JOBNAM	;GET SIXBIT JOB NUMBER
BTLOT4C	002255'	661200	404040	01200	        TLO T4,404040   ;NOW TO ASCII FOR ASCIZ'S
BMOVEIT1C	002256'	201040	000003	01300	        MOVEI T1,3      ;THREE CHARS
BLSHT3C	002257'	242140	000001	01400	        LSH T3,1
BLSHCT3C	002260'	246140	000006	01500	        LSHC T3,6       ;BRING IN A CHAR
BSOJGT1C	002261'	367040	002257'	01600	        SOJG T1,.-2
BDPBT3POINTCRFRDRC	002262'	137140	011263'	01700	        DPB T3,[POINT 21,CRFRDR,27]     ;SAVE IN ASCIZ
BDPBT3POINTFCOMDC	002263'	137140	011264'	01800	        DPB T3,[POINT 21,FCOMD,27]
BDPBT3POINTFCOMD2C	002264'	137140	011265'	01900	        DPB T3,[POINT 21,FCOMD2,27]
BMOVSIT1C	002265'	205040	377777	02000	        MOVSI T1,377777 ;SET COUNT TO A LARGE NUMBER
BMOVEMT1DINCTC	002266'	202040	000620*	02100	        MOVEM T1,DINCT
BSETOMNOSTNMNOSTNMC	002267'	476000	001257*	02200	        SETOM NOSTNM#   ;NO NON-STARDARD PROCESSORS SEEN YET
BMOVEPPDPC	002270'	200740	010735'	02300	        MOVE P,PDP              ;SET UP PDL
BMOVEIOPIOWDNESTDPIOPDC	002271'	200340	011266'	02400	        MOVE IOP,[IOWD <NESTDP+2>*3,IOPD]       ;AND IO PDL
BMOVSIIOPNTNESTDPC	002272'	205300	777773	02500	        MOVSI IOPNT,-<NESTDP+1> ;SET NEXT LIMIT
BSETZFL2C	002273'	400400	000000	02600	        SETZ    FL2,
BPUSHJPSTTYMXC	002274'	260740	001711'	02700	        PUSHJ   P,STTYMX        ;SET TYMEX
BTROFLDOLODC	002275'	660000	000002	02800	        TRO FL,DOLOD            ;WE WANT TO LOAD
BHRLIFLF4SWC	002276'	505000	400000	02900	        HRLI FL,F4SW    ;ASSUME F4
BSETZMLOKNAMC	002277'	402000	001123*	03000	        SETZM LOKNAM    ;NO ALTERNATE DEVICE YET
BOPENLOOKDSKLKC	002300'	050000	000000*	03100	        OPEN LOOK,DSKLK ;GET THE DSK
BJRSTDSKNAC	002301'	254000	001053'	03200	        JRST DSKNA
BINBUFLOOKC	002302'	064000	000002	03300	        INBUF LOOK,2
BMOVET1JOBFFC	002303'	200040	002217*	03400	        MOVE T1,JOBFF
BMOVEMT1SVJFFC	002304'	202040	002105*	03500	        MOVEM T1,SVJFF
BSETZMBINDVBINDVC	002305'	402000	000000*	03600	        SETZM BINDV#
BSETZMLSTDVLSTDVC	002306'	402000	000000*	03700	        SETZM LSTDV#    ;NO AUX DEVICES TO START WITH
BMOVET1JOBRELC	002307'	200040	002207*	03800	        MOVE T1,JOBREL
BMOVEMT1CORTOPC	002310'	202040	002063*	03900	        MOVEM T1,CORTOP
BMOVEMT1CORT1C	002311'	202040	001472*	04000	        MOVEM T1,CORT1
BSETZMSAVCHRC	002312'	402000	001707*	04100	        SETZM SAVCHR    ;TO START THINGS
BHLLZSJOBERRC	002313'	513000	000000*	04200	        HLLZS JOBERR    ;RESET ERROR COUNT
BMOVSISVPTNFILEC	002314'	205600	777677	04300	        MOVSI SVPT,-NFILE
BMOVSIT1C	002315'	205040	637163	04400		MOVSI T1,'SYS'
BMOVEMT1NAMES1C	002316'	202040	000000*	04500		MOVEM T1,NAMES1	;INITIALIZE USERNAME TABLE
BMOVET1C	002317'	200040	011025'	04600		MOVE T1,[1,,4]
BMOVEMT1PPNSC	002320'	202040	000000*	04700		MOVEM T1,PPNS
BAOSNMLSTPC	002321'	350000	000000*	04800		AOS NMLSTP
BHRROIT1C	002322'	561040	777756	04900		HRROI T1,-22
BGETTABT1C	002323'	047040	000041	05000		GETTAB T1,	;FIRST HALF OF THIS USER'S NAME
BHALTC	002324'	254200	002324'	05100		HALT .
BMOVEMT1NAMES1C	002325'	202040	000000*	05200		MOVEM T1,NAMES1+1
BHRROIT1C	002326'	561040	777757	05300		HRROI T1,-21	;SECOND HALF
BGETTABT1DRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 25-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	002327'	047040	000041	05400		GETTAB T1,
BHALTC	002330'	254200	002330'	05500		HALT .
BMOVEMT1NAMES2C	002331'	202040	000000*	05600		MOVEM T1,NAMES2+1
BGETPPNT1C	002332'	047040	000024	05700		GETPPN T1,	;AND HIS PPN
BMOVEMT1PPNSC	002333'	202040	000000*	05800		MOVEM T1,PPNS+1
BPUSHJPSCANC	002334'	260740	000276'	05900	        PUSHJ P,SCAN
BC
BMOVET1XWDCOMTLGCOMTABC	002335'	200040	011267'	06100	        MOVE T1,[XWD -COMTLG,COMTAB]    ;CALL SCANNER FOR WORDS
BPUSHJPSWSCANC	002336'	260740	002722'	06200	        PUSHJ P,SWSCAN
BJRSTOUTSTRASCIZC				06300	        JRST    [OUTSTR [ASCIZ "ILLEGAL COMMAND NAME: "]
BJRSTERRCOMC	002337'	254000	011275'	06400	                JRST    ERRCOM]
BJFCLC	002340'	255000	000000	06500	        JFCL    ;EXACT MATCH RETURN. ANY MATCH WILL DO
BHLLZT2COMT2COMTABT1C	002341'	510101	000052	06600		HLLZ T2,COMT2-COMTAB(T1)
BJUMPET2COMT2COMTABT1C	002342'	322121	000052	06700		JUMPE T2,@COMT2-COMTAB(T1)	;ZERO LH MEANS DO MAILBOX THING
BHRROIT2C	002343'	561100	777760	06800		HRROI T2,-20
BGETTABT2C	002344'	047100	000041	06900		GETTAB T2,
BMOVEIT2C	002345'	201100	000000	07000		MOVEI T2,0
BHRLT2T2C	002346'	504100	000002	07100		HRL T2,T2	;TURN OFF LICENSE FOR OTHER COMMANDS
BSETLICT2C	002347'	047100	777770	07200		SETLIC T2,
BXCTCOMT2COMTABT1C	002350'	256001	000052	07300	        XCT COMT2-COMTAB(T1)    ;DO IT
BCOMATTRZEFLALTSRCC	002351'	622000	000010	07400	COMAT:	TRZE FL,ALTSRC
BPUSHJPSCANC	002352'	260740	000276'	07500	        PUSHJ P,SCAN    ;GET BY EDIT
BPUSHJPSCANC	002353'	260740	000276'	07600	        PUSHJ P,SCAN    ;GET NEXT THING
BTRNNIOPNTC	002354'	606300	777777	07700	        TRNN IOPNT,-1   ;IF DOWN A LEVEL ITS OK
BTLNNCSTERMFC	002355'	607640	200000	07800	        TLNN CS,TERMF   ;OR IF NOTHING SEEN
BSKIPAC	002356'	334000	000000	07900	        SKIPA
BJRSTCOMAT1C	002357'	254000	002363'	08000	        JRST COMAT1
BTRNEFLEDITFC	002360'	602000	020000	08100	        TRNE FL,EDITF
BJRSTDOEDT1C	002361'	254000	007470'	08200	        JRST DOEDT1
BJRSTNXFIL1C	002362'	254000	002377'	08300	        JRST NXFIL1
BCOMAT1MOVET1POINTFCOMDC	002363'	200040	011247'	08400	COMAT1: MOVE T1,[POINT 7,FCOMD] ;GENERATE FAKE COMMAND TO READ
BTRNNFLEDITFC	002364'	606000	020000	08500	        TRNN FL,EDITF
BTROAFLRPGSRCALTSRCC	002365'	664000	000014	08600	        TROA FL,RPGSRC!ALTSRC   ;TRY FOR SVCM FILE
BMOVET1POINTFCOMD2C	002366'	200040	011277'	08700	        MOVE T1,[POINT 7,FCOMD2]
BMOVEMT1DINPTC	002367'	202040	001675*	08800	        MOVEM T1,DINPT  ;SAVE FILE
BTROFLRECALFCMDSNC	002370'	660000	201000	08900	        TRO FL,RECALF+CMDSN     ;MARK RECALLING FILE, DONT WRITE
BSETZMSAVCHRC	002371'	402000	002312*	09000	        SETZM SAVCHR    ;CLEAR OUT SCANNER
BMOVSIIOPNTNESTDPC	002372'	205300	777772	09100	        MOVSI IOPNT,-<NESTDP+2> ;ALLOW EXTRA NESTING
BPUSHJPSCANC	002373'	260740	000276'	09200	        PUSHJ P,SCAN
BTRNEFLEDITFC	002374'	602000	020000	09300	        TRNE FL,EDITF
BJRSTDOEDITC	002375'	254000	007467'	09400	        JRST DOEDIT
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 26
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;INITIALIZE FOR A NEW FILE NAME IN THE COMMAND
BC
BNXFILPUSHJPSCANC	002376'	260740	000276'	00300	NXFIL: PUSHJ P,SCAN
BNXFIL1MOVSISVPTNFILEC	002377'	205600	777677	00400	NXFIL1: MOVSI SVPT,-NFILE       ;SET UP FOR NUMBER OF FILES
BMOVEISWCNTSWBKC	002400'	201500	000031	00500	        MOVEI SWCNT,SWBK*5      ;SET UP FOR SWITCHES
BMOVESWPTPOINTSWBLKC	002401'	200540	011300'	00600	        MOVE SWPT,[POINT 7,SWBLK]       ;AND POINTER
BSETZMSWBKLC	002402'	402000	000000*	00700	        SETZM SWBKL
BSETZMSWBKBC	002403'	402000	000000*	00800	        SETZM SWBKB
BSETZMONAMC	002404'	402000	000000*	00900	        SETZM ONAM
BSETZMOEXTC	002405'	402000	000000*	01000	        SETZM OEXT
BSETZMOPPNC	002406'	402000	000000*	01100	        SETZM OPPN      ;NO OUTPUT EXTENSION OR PPN
BHLLFL3FLC	002407'	500440	000000	01200	        HLL FL3,FL      ;SET TEMP FLAGS FROM PERM FLAGS
BMOVET1POINTLODSBKC	002410'	200040	011301'	01300	        MOVE T1,[POINT 7,LODSBK]        ;SET POINTER TO LOADER
BMOVEMT1LODSPC	002411'	202040	000000*	01400	        MOVEM T1,LODSP          ;SWITCH BLOCK
BMOVEIT1LODSCTC	002412'	201040	000010	01500	        MOVEI T1,LODSCT
BMOVEMT1LODCTRC	002413'	202040	000000*	01600	        MOVEM T1,LODCTR
BMOVEMT1LODCT2C	002414'	202040	000000*	01700	        MOVEM T1,LODCT2 ;AND SET COUNT FOR AFTER FILE NAME SWITCHES
BMOVET1POINTLODSB2C	002415'	200040	011302'	01800	        MOVE T1,[POINT 7,LODSB2]
BMOVEMT1LODSP2C	002416'	202040	000000*	01900	        MOVEM T1,LODSP2
BSETZMBROCNTC	002417'	402000	000000*	02000	        SETZM BROCNT    ;CLEAR OUT THE <> COUNT
BJRSTILP0AC	002420'	254000	002422'	02100	        JRST    ILP0A
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 27
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;MAIN LOOP FOR READING INPUT
BC				00200	;CHECK FOR PERMANENT SWITCHES, THEN FILE NAME, THEN TEMP SWITCHES
BC				00300	;(ALSO CHECK FOR OTHER SPECIAL THINGS)
BC
BILP0PUSHJPSCANC	002421'	260740	000276'	00500	ILP0:   PUSHJ P,SCAN    ;GET FIRST "THING"
BILP0ACAINCC	002422'	306700	000057	00600	ILP0A:  CAIN C,"/"      ;CHECK FOR PERM COMPILE SWITCHES
BJRSTCOMPS1C	002423'	254000	003047'	00700	        JRST COMPS1
BCAINCC	002424'	306700	000045	00800	        CAIN C,"%"      ;CHECK FOR PERM LOADER FLAGS
BJRSTLOADS1C	002425'	254000	003213'	00900	        JRST LOADS1
BCAINCC	002426'	306700	000054	01000	        CAIN    C,","           ;ALLOW SWITCHES W/O FILENAMES
BJRSTNXFILC	002427'	254000	002376'	01100	        JRST    NXFIL           ;BETWEEN COMMAS
BILP1ATRZFLPROCSC	002430'	620000	000001	01200	ILP1A:  TRZ FL,PROCS    ;NO PROCESSOR SWITCHES SEEN YET
BILP1CAINCC	002431'	306700	000135	01300	ILP1:	CAIN	C,"]"
BJRSTILP1BC	002432'	254000	002435'	01400		JRST	ILP1B
BCAIECC	002433'	302700	000041	01500		CAIE	C,"!"
BCAINCC	002434'	306700	000133	01600	        CAIN    C,"["
BILP1BJRSTMOVET1CC				01700	ILP1B:	JRST	[MOVE T1,C
BTRNEFLDOLODC				01800			TRNE FL,DOLOD
BPUSHJPOUTLODC				01900			PUSHJ P,OUTLOD
BJRSTILP0C	002435'	254000	011303'	02000			JRST ILP0]
BPUSHJPGETNAMC	002436'	260740	000116'	02100	        PUSHJ P,GETNAM  ;GO GET A FILE NAME
BPUSHJPXSWSC	002437'	260740	003001'	02200	        PUSHJ P,XSWS    ;EXCHANGE LOADER SWITCH LISTS
BILP2APUSHJPSCANC	002440'	260740	000276'	02300	ILP2A:  PUSHJ P,SCAN    ;GET THE SPECIAL CHR OR WHATEVER
BILP2CAIECC	002441'	302700	000054	02400	ILP2:   CAIE C,","      ;DONE WITH THIS SET OF NAMES?
BTLNECSTERMFC	002442'	603640	200000	02500	        TLNE CS,TERMF   ;WILL ACCEPT A TERMINATOR
BJRSTSETUPC	002443'	254000	003275'	02600	        JRST SETUP      ;GO SET UP THE FILES FOR PROCESSORS
BCAIECC	002444'	302700	000135	02700	        CAIE    C,"]"
BCAINCC	002445'	306700	000041	02800	        CAIN    C,"!"
BJRSTSETUPC	002446'	254000	003275'	02900		JRST	SETUP
BCAINCC	002447'	306700	000050	03000	        CAIN C,"("      ;MAYBE SWITCHES TO BE PASSED TO PROCESSORS
BJRSTPROCSWC	002450'	254000	003141'	03100	        JRST PROCSW
BCAINCC	002451'	306700	000057	03200	        CAIN C,"/"      ;OR FOR US
BJRSTCOMPSWC	002452'	254000	003044'	03300	        JRST COMPSW
BCAINCC	002453'	306700	000045	03400	        CAIN C,"%"
BJRSTLOADS2C	002454'	254000	003215'	03500	        JRST LOADS2
BCAINCC	002455'	306700	000076	03600	        CAIN C,">"
BJRSTENDBROC	002456'	254000	002506'	03700	        JRST ENDBRO     ;THIS IS THE END OF A BROKET STRING
BCAINCC	002457'	306700	000075	03800	        CAIN C,"="      ;MAYBE HE IS SETTING THE OUTPUT NAME
BJRSTSETONMC	002460'	254000	003201'	03900	        JRST SETONM
BJUMPECSYNERRC	002461'	322700	001065'	04000		JUMPE C,SYNERR	;NULL CHARACTER GETS NONCOMITTAL MESSAGE
BCAIECC	002462'	302700	000053	04100	        CAIE C,"+"      ;IS THIS A SECOND FILE
BJRSTILLCHRC	002463'	254000	001012'	04200		JRST ILLCHR	;IT SHOULD HAVE BEEN ONE OF THOSE
BAOBJPSVPTTMNERC	002464'	252600	001051'	04300	        AOBJP SVPT,TMNER        ;MAYBE TOO MANY FILES
BPUSHJPXSWSC	002465'	260740	003001'	04400	        PUSHJ P,XSWS
BPUSHJPSCANC	002466'	260740	000276'	04500	        PUSHJ P,SCAN    ;GET NEXT
BCAIECC	002467'	302700	000074	04600	        CAIE C,"<"      ;IS THIS THE <> CONSTRUCTION
BJRSTILP0AC	002470'	254000	002422'	04700	        JRST ILP0A      ;NO
BAOSBROCNTDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 28
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	002471'	350000	002417*	00100	       AOS BROCNT      ;WE ARE ONE DEEPER IN BROKETS
BPUSHPFL3C	002472'	261740	000011	00200		PUSH P,FL3
BPUSHPSVPTC	002473'	261740	000014	00300	        PUSH P,SVPT     ;SAVE AWAY ALL THE IMPORTANT INFORMATION
BPUSHPSWPTC	002474'	261740	000013	00400	        PUSH P,SWPT
BPUSHPSWCNTC	002475'	261740	000012	00500	        PUSH P,SWCNT
BPUSHPLODSPC	002476'	261740	002411*	00600	        PUSH P,LODSP
BPUSHPLODSP2C	002477'	261740	002416*	00700	        PUSH P,LODSP2
BPUSHPLODCTRC	002500'	261740	002413*	00800	        PUSH P,LODCTR
BPUSHPLODCT2C	002501'	261740	002414*	00900	        PUSH P,LODCT2
BPUSHPSWBKLC	002502'	261740	002402*	01000	        PUSH P,SWBKL
BPUSHPSWBKBC	002503'	261740	002403*	01100	        PUSH P,SWBKB
BPUSHPONAMC	002504'	261740	002404*	01200	        PUSH P,ONAM
BJRSTILP0C	002505'	254000	002421'	01300	        JRST ILP0       ;GO FINISH THINGS UP
BC
BENDBROC	002506'			01500	ENDBRO:
BSOSGEBROCNTC	002506'	375000	002471*	01600	        SOSGE BROCNT    ;ERROR IF NO < WAS SEEN
BJRSTSYNERRC	002507'	254000	001065'	01700	        JRST SYNERR
BSUBPC	002510'	274740	011307'	01800		SUB P,[13,,13]	;RESET PDL
BJRSTILP2AC	002511'	254000	002440'	01900	        JRST ILP2A      ;GO PRETEND > NOT SEEN (COMMA SHOULD BE NEXT)
BC
BNXFILPSKIPGBROCNTC	002512'	337000	002506*	02100	NXFILP: SKIPG BROCNT    ;ARE WE DONING BROKETS?
BJRSTNXFILC	002513'	254000	002376'	02200	        JRST NXFIL      ;NO, JUST CONTINUE
BMOVET1PC	002514'	200057	000000	02300	        MOVE T1,(P)
BMOVEMT1ONAMC	002515'	202040	002504*	02400	        MOVEM T1,ONAM
BMOVET1PC	002516'	200057	777777	02500	        MOVE T1,-1(P)
BMOVEMT1SWBKBC	002517'	202040	002503*	02600	        MOVEM T1,SWBKB
BMOVET1PC	002520'	200057	777776	02700	        MOVE T1,-2(P)
BMOVEMT1SWBKLC	002521'	202040	002502*	02800	        MOVEM T1,SWBKL
BMOVET1PC	002522'	200057	777775	02900	        MOVE T1,-3(P)
BMOVEMT1LODCT2C	002523'	202040	002501*	03000	        MOVEM T1,LODCT2
BMOVET1PC	002524'	200057	777774	03100	        MOVE T1,-4(P)
BMOVEMT1LODCTRC	002525'	202040	002500*	03200	        MOVEM T1,LODCTR
BMOVET1PC	002526'	200057	777773	03300	        MOVE T1,-5(P)
BMOVEMT1LODSP2C	002527'	202040	002477*	03400	        MOVEM T1,LODSP2
BMOVET1PC	002530'	200057	777772	03500	        MOVE T1,-6(P)
BMOVEMT1LODSPC	002531'	202040	002476*	03600	        MOVEM T1,LODSP
BMOVESWCNTPC	002532'	200517	777771	03700	        MOVE SWCNT,-7(P)
BMOVESWPTPC	002533'	200557	777770	03800	        MOVE SWPT,-10(P)
BMOVESVPTPC	002534'	200617	777767	03900	        MOVE SVPT,-11(P)
BHLLFL3PC	002535'	500457	777766	04000		HLL FL3,-12(P)
BJRSTILP0C	002536'	254000	002421'	04100	        JRST ILP0
BCOMPSPUSHJPSCANDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 29
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	002537'	260740	000276'	00100	COMPS: PUSHJ P,SCAN    ;GET THE NAME OF THE SWITCH
BC				00200	;HANDLE COMPILER SWITCH, EITHER TEMP OR PERM
BC
BTRNNFLIDFC	002540'	606000	000020	00400	        TRNN FL,IDF     ;WAS THERE REALLY AN IDENTIFIER THERE?
BJRSTSYNERRC	002541'	254000	001065'	00500	        JRST SYNERR     ;LOSE
BMOVET1XWDTBLGSWTABC	002542'	200040	011310'	00600	        MOVE T1,[XWD -TBLG,SWTAB]
BPUSHJPSWSCANC	002543'	260740	002722'	00700	        PUSHJ P,SWSCAN
BJRSTMOVET1XWDNSDNMNSDSWSC				00800	        JRST    [MOVE T1,[XWD -NSDNM,NSDSWS]    ;LOOK FOR NON-STANDARD PROCESSORS
BPUSHJPSWSCANC				00900	                PUSHJ P,SWSCAN  ;IS IT THERE??
BJRSTUNRECSC				01000	                JRST UNRECS     ;NO MATCH, LOSE
BJRSTGSW2C				01100	                JRST GSW2       ;EXACT MATCH OK
BJRSTGSW2C	002544'	254000	011312'	01200	                JRST GSW2]      ;SO IS PARTIAL MATCH
BJRSTGETSWC	002545'	254000	002553'	01300	        JRST GETSW      ;EXACT MATCH, GO
BJRSTMOVET1XWDNSDNMNSDSWSC				01400	        JRST    [MOVE T1,[XWD -NSDNM,NSDSWS]    ;PARTIAL MATCH
BPUSHJPSWSCANC				01500	                PUSHJ P,SWSCAN  ;CHECK FURTHER
BJRSTGSW1C				01600	                JRST GSW1       ;NONE THERE USE OLD MATCH
BJRSTGSW2C				01700	                JRST GSW2       ;THIS ONE EXACT, USE IT
BJRSTUNRECSC	002546'	254000	011317'	01800	                JRST UNRECS]    ;BOTH PARTIAL SO LOSE
BGSW2SUBIT1NSDSWSC	002547'	275040	000000*	01900	GSW2:   SUBI T1,NSDSWS
BMOVET1SWTAB3T1C	002550'	200041	002717'	02000	        MOVE T1,SWTAB3(T1)
BJRSTINTSWC	002551'	254000	002554'	02100	        JRST INTSW
BGSW1MOVET1SVINDC	002552'	200040	000000*	02200	GSW1:   MOVE T1,SVIND   ;GET BACK ONLY MATCH NUMBER
BGETSWMOVET1SWTAB2SWTABT1C	002553'	200041	000051	02300	GETSW:  MOVE T1,SWTAB2-SWTAB(T1)        ;GET ACTION
BINTSWTLNET1IMEDSWC	002554'	603040	000040	02400	INTSW:  TLNE T1,IMEDSW
BJRSTT1C	002555'	254001	000000	02500	        JRST (T1)       ;DO IT NOW
BTLNET1FTFSWC	002556'	603040	100000	02600		TLNE T1,FTFSW
BSETOMFTFFLGC	002557'	476000	001153*	02700		SETOM FTFFLG	;USE FTLIB40 IF /FTF
BTLNNT1CALPROC	002560'	607060	000000*	02800		TLNN T1,@CALPRO	;A PROCESSOR SW?
BJRSTINTSW1C	002561'	254000	002565'	02900		JRST INTSW1
BTLZFL3CALPROC	002562'	621460	002560*	03000		TLZ FL3,@CALPRO
BTRNEFLPERFC	002563'	602000	000200	03100		TRNE FL,PERF	;TURN OFF ALL OTHERS
BTLZFLCALPROC	002564'	621020	002562*	03200		TLZ FL,@CALPRO
BINTSW1TLZFL3T1C	002565'	621441	000000	03300	INTSW1:	TLZ FL3,(T1)	;TURN OFF SWITCHES AS NEEDED
BTRNEFLPERFC	002566'	602000	000200	03400	        TRNE FL,PERF    ;PERMANENT?
BTLZFLT1C	002567'	621001	000000	03500	        TLZ FL,(T1)     ;SET THAT TOO
BMOVSST1C	002570'	207000	000001	03600	        MOVSS T1
BTLOFL3T1C	002571'	661441	000000	03700	        TLO FL3,(T1)    ;AND TURN ON OTHERS
BTRNEFLPERFC	002572'	602000	000200	03800	        TRNE FL,PERF
BTLOFLT1C	002573'	661001	000000	03900	        TLO FL,(T1)
BJRSTSCANC	002574'	254000	000276'	04000	        JRST SCAN       ;GET SOMETHING ELSE
BC
BDEFINEC				04200	DEFINE X (A,B,C,D,E)
BXC				04300	<SWITCH A,<XWD B'SW,0>>
BDEFINEC				04400	        DEFINE TABLE
BTABLEC				04500	<SWITCH LIST,<XWD LISTSW,CRSW>
BC				04600	SWITCH CREF,<XWD IMEDSW,SETCRF>
BC				04700	SWITCH M,<XWD MACSW,0>
BC				04800	SWITCH C,<XWD IMEDSW,SETCRF>
BC				04900	SWITCH CROSS,<XWD IMEDSW,SETCRO>
BC				05000	SWITCH LIBRARY,<XWD LIBSW,0>
BC				05100	SWITCH REL,<XWD RELSW,0>
BC				05200	SWITCH NOLIST,LISTSW
BC				05300	SWITCH NOSEARCH,LIBSW
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 29-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				05400	SWITCH L,<XWD LISTSW,CRSW>
BC				05500	SWITCH F,<XWD F4SW,0>
BC				05600	SWITCH N,LISTSW
BC				05700	SWITCH COMPILE,<XWD COMPLS,0>
BC				05800	SWITCH NOCOMPILE,COMPLS
BC				05900	SWITCH NOLOAD,<XWD NOLODS,0>
BC				06000	SWITCH LOAD,NOLODS
BC				06100	SWITCH FORWARD,<XWD FORWDS>
BC				06200	SWITCH NOTFORWARD,FORWDS
BC				06300	SWITCH MAP,<XWD IMEDSW,SETMAP>
BC				06400	SWITCH NONSTANDARD,<XWD IMEDSW,NONSTD>
BC				06500	SWITCH BINDEV,<XWD IMEDSW,SETBDV>
BC				06600	SWITCH LISTDEV,<XWD IMEDSW,SETLDV>
BC				06700	SWITCH READ,0
BC				06800	SWITCH SEQUENCE,0
BC				06900	SWITCH NOBINARY,<XWD NOBIN,0>
BC				07000	SWITCH BINARY,NOBIN
BC				07100	SWITCH ZF,<XWD IMEDSW,SETCCS>
BC				07200	SWITCH NAME,<XWD IMEDSW,STNAM>
BC				07300	SWITCH SYMBOLS,<XWD IMEDSW,STSYM>
BC				07400	SWITCH INITIAL,<XWD IMEDSW,STINI>
BC				07500	SWITCH CLOSE,<XWD IMEDSW,STCLS>
BC				07600	SWITCH USER,<XWD IMEDSW,SETUSR>
BC				07700	SWITCH RUN,<XWD IMEDSW,SETRUN>
BC				07800	PROCESS
BC				07900	>
BC
BTBGENDEFINEC				08100	TBGEN (SWTAB,TBLG,SWTAB2)^DEFINE SWITCH (P,Q)
BSWITCHC					<<SIXBIT /P/>>
BSWTABTABLESWITCHSIXBITC	002575'	545163	640000		SWTAB:      TABLE^SWITCH LIST,<XWD LISTSW,CRSW>^<SIXBIT /LIST/>^
BSWITCHSIXBITC	002576'	436245	460000		SWITCH CREF,<XWD IMEDSW,SETCRF>^<SIXBIT /CREF/>^
BSWITCHSIXBITC	002577'	550000	000000		SWITCH M,<XWD MACSW,0>^<SIXBIT /M/>^
BSWITCHSIXBITC	002600'	430000	000000		SWITCH C,<XWD IMEDSW,SETCRF>^<SIXBIT /C/>^
BSWITCHSIXBITC	002601'	436257	636300		SWITCH CROSS,<XWD IMEDSW,SETCRO>^<SIXBIT /CROSS/>^
BSWITCHSIXBITC	002602'	545142	624162		SWITCH LIBRARY,<XWD LIBSW,0>^<SIXBIT /LIBRARY/>^
BSWITCHSIXBITC	002603'	624554	000000		SWITCH REL,<XWD RELSW,0>^<SIXBIT /REL/>^
BSWITCHSIXBITC	002604'	565754	516364		SWITCH NOLIST,LISTSW^<SIXBIT /NOLIST/>^
BSWITCHSIXBITC	002605'	565763	454162		SWITCH NOSEARCH,LIBSW^<SIXBIT /NOSEARCH/>^
BSWITCHSIXBITC	002606'	540000	000000		SWITCH L,<XWD LISTSW,CRSW>^<SIXBIT /L/>^
BSWITCHSIXBITC	002607'	460000	000000		SWITCH F,<XWD F4SW,0>^<SIXBIT /F/>^
BSWITCHSIXBITC	002610'	560000	000000		SWITCH N,LISTSW^<SIXBIT /N/>^
BSWITCHSIXBITC	002611'	435755	605154		SWITCH COMPILE,<XWD COMPLS,0>^<SIXBIT /COMPILE/>^
BSWITCHSIXBITC	002612'	565743	575560		SWITCH NOCOMPILE,COMPLS^<SIXBIT /NOCOMPILE/>^
BSWITCHSIXBITC	002613'	565754	574144		SWITCH NOLOAD,<XWD NOLODS,0>^<SIXBIT /NOLOAD/>^
BSWITCHSIXBITC	002614'	545741	440000		SWITCH LOAD,NOLODS^<SIXBIT /LOAD/>^
BSWITCHSIXBITC	002615'	465762	674162		SWITCH FORWARD,<XWD FORWDS>^<SIXBIT /FORWARD/>^
BSWITCHSIXBITC	002616'	565764	465762		SWITCH NOTFORWARD,FORWDS^<SIXBIT /NOTFORWARD/>^
BSWITCHSIXBITC	002617'	554160	000000		SWITCH MAP,<XWD IMEDSW,SETMAP>^<SIXBIT /MAP/>^
BSWITCHSIXBITC	002620'	565756	636441		SWITCH NONSTANDARD,<XWD IMEDSW,NONSTD>^<SIXBIT /NONSTANDARD/>^
BSWITCHSIXBITC	002621'	425156	444566		SWITCH BINDEV,<XWD IMEDSW,SETBDV>^<SIXBIT /BINDEV/>^
BSWITCHSIXBITC	002622'	545163	644445		SWITCH LISTDEV,<XWD IMEDSW,SETLDV>^<SIXBIT /LISTDEV/>^
BSWITCHSIXBITC	002623'	624541	440000		SWITCH READ,0^<SIXBIT /READ/>^
BSWITCHSIXBITC	002624'	634561	654556		SWITCH SEQUENCE,0^<SIXBIT /SEQUENCE/>^
BSWITCHSIXBITDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 29-3
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	002625'	565742	515641		SWITCH NOBINARY,<XWD NOBIN,0>^<SIXBIT /NOBINARY/>^
BSWITCHSIXBITC	002626'	425156	416271		SWITCH BINARY,NOBIN^<SIXBIT /BINARY/>^
BSWITCHSIXBITC	002627'	724600	000000		SWITCH ZF,<XWD IMEDSW,SETCCS>^<SIXBIT /ZF/>^
BSWITCHSIXBITC	002630'	564155	450000		SWITCH NAME,<XWD IMEDSW,STNAM>^<SIXBIT /NAME/>^
BSWITCHSIXBITC	002631'	637155	425754		SWITCH SYMBOLS,<XWD IMEDSW,STSYM>^<SIXBIT /SYMBOLS/>^
BSWITCHSIXBITC	002632'	515651	645141		SWITCH INITIAL,<XWD IMEDSW,STINI>^<SIXBIT /INITIAL/>^
BSWITCHSIXBITC	002633'	435457	634500		SWITCH CLOSE,<XWD IMEDSW,STCLS>^<SIXBIT /CLOSE/>^
BSWITCHSIXBITC	002634'	656345	620000		SWITCH USER,<XWD IMEDSW,SETUSR>^<SIXBIT /USER/>^
BSWITCHSIXBITC	002635'	626556	000000		SWITCH RUN,<XWD IMEDSW,SETRUN>^<SIXBIT /RUN/>^
BPROCESXSWITCHSIXBITC	002636'	465762	646241		X FORTRAN,F4,F40^SWITCH FORTRAN,<XWD F4SW,0>^<SIXBIT /FORTRAN/>^^
BXSWITCHSIXBITC	002637'	554143	625700		X MACRO,MAC,MACRO^SWITCH MACRO,<XWD MACSW,0>^<SIXBIT /MACRO/>^^
BXSWITCHSIXBITC	002640'	466446	576264		X FTFORTRAN,FTF,FTF40^SWITCH FTFORTRAN,<XWD FTFSW,0>^<SIXBIT /FTFORTRAN/>^^
BXSWITCHSIXBITC	002641'	635155	605400		X SIMPL,SIM,SIMPL^SWITCH SIMPL,<XWD SIMSW,0>^<SIXBIT /SIMPL/>^^
BXSWITCHSIXBITC	002642'	464151	540000		X FAIL,FAL,FAIL^SWITCH FAIL,<XWD FALSW,0>^<SIXBIT /FAIL/>^^
BXSWITCHSIXBITC	002643'	435742	575400		X COBOL,CBL,COBOL^SWITCH COBOL,<XWD CBLSW,0>^<SIXBIT /COBOL/>^^
BXSWITCHSIXBITC	002644'	425451	556000		X BLIMP,BLI,BLISS^SWITCH BLIMP,<XWD BLISW,0>^<SIXBIT /BLIMP/>^^
BXSWITCHSIXBITC	002645'	664163	000000		X VAS,VAS,VAS^SWITCH VAS,<XWD VASSW,0>^<SIXBIT /VAS/>^^
BSWTABTBLGDEFINESWITCHSWTAB2TABLESWITCHXWDLISTSWCRSWC	002646'	000001	000002		SWTAB2:      TABLE^SWITCH LIST,<XWD LISTSW,CRSW>^XWD LISTSW,CRSW^
BSWITCHXWDIMEDSWSETCRFC	002647'	000040	003237'		SWITCH CREF,<XWD IMEDSW,SETCRF>^XWD IMEDSW,SETCRF^
BSWITCHXWDMACSWC	002650'	200000	000000		SWITCH M,<XWD MACSW,0>^XWD MACSW,0^
BSWITCHXWDIMEDSWSETCRFC	002651'	000040	003237'		SWITCH C,<XWD IMEDSW,SETCRF>^XWD IMEDSW,SETCRF^
BSWITCHXWDIMEDSWSETCROC	002652'	000040	003242'		SWITCH CROSS,<XWD IMEDSW,SETCRO>^XWD IMEDSW,SETCRO^
BSWITCHXWDLIBSWC	002653'	000004	000000		SWITCH LIBRARY,<XWD LIBSW,0>^XWD LIBSW,0^
BSWITCHXWDRELSWC	002654'	000010	000000		SWITCH REL,<XWD RELSW,0>^XWD RELSW,0^
BSWITCHLISTSWC	002655'	000000	000001		SWITCH NOLIST,LISTSW^LISTSW^
BSWITCHLIBSWC	002656'	000000	000004		SWITCH NOSEARCH,LIBSW^LIBSW^
BSWITCHXWDLISTSWCRSWC	002657'	000001	000002		SWITCH L,<XWD LISTSW,CRSW>^XWD LISTSW,CRSW^
BSWITCHXWDF4SWC	002660'	400000	000000		SWITCH F,<XWD F4SW,0>^XWD F4SW,0^
BSWITCHLISTSWC	002661'	000000	000001		SWITCH N,LISTSW^LISTSW^
BSWITCHXWDCOMPLSC	002662'	000020	000000		SWITCH COMPILE,<XWD COMPLS,0>^XWD COMPLS,0^
BSWITCHCOMPLSC	002663'	000000	000020		SWITCH NOCOMPILE,COMPLS^COMPLS^
BSWITCHXWDNOLODSC	002664'	000200	000000		SWITCH NOLOAD,<XWD NOLODS,0>^XWD NOLODS,0^
BSWITCHNOLODSC	002665'	000000	000200		SWITCH LOAD,NOLODS^NOLODS^
BSWITCHXWDFORWDSC	002666'	000000	000100		SWITCH FORWARD,<XWD FORWDS>^XWD FORWDS^
BSWITCHFORWDSC	002667'	000000	000100		SWITCH NOTFORWARD,FORWDS^FORWDS^
BSWITCHXWDIMEDSWSETMAPC	002670'	000040	003052'		SWITCH MAP,<XWD IMEDSW,SETMAP>^XWD IMEDSW,SETMAP^
BSWITCHXWDIMEDSWNONSTDC	002671'	000040	010575'		SWITCH NONSTANDARD,<XWD IMEDSW,NONSTD>^XWD IMEDSW,NONSTD^
BSWITCHXWDIMEDSWSETBDVC	002672'	000040	003062'		SWITCH BINDEV,<XWD IMEDSW,SETBDV>^XWD IMEDSW,SETBDV^
BSWITCHXWDIMEDSWSETLDVC	002673'	000040	003063'		SWITCH LISTDEV,<XWD IMEDSW,SETLDV>^XWD IMEDSW,SETLDV^
BSWITCHC	002674'	000000	000000		SWITCH READ,0^0^
BSWITCHC	002675'	000000	000000		SWITCH SEQUENCE,0^0^
BSWITCHXWDNOBINC	002676'	000400	000000		SWITCH NOBINARY,<XWD NOBIN,0>^XWD NOBIN,0^
BSWITCHNOBINC	002677'	000000	000400		SWITCH BINARY,NOBIN^NOBIN^
BSWITCHXWDIMEDSWSETCCSC	002700'	000040	003010'		SWITCH ZF,<XWD IMEDSW,SETCCS>^XWD IMEDSW,SETCCS^
BSWITCHXWDIMEDSWSTNAMC	002701'	000040	003017'		SWITCH NAME,<XWD IMEDSW,STNAM>^XWD IMEDSW,STNAM^
BSWITCHXWDIMEDSWSTSYMC	002702'	000040	003020'		SWITCH SYMBOLS,<XWD IMEDSW,STSYM>^XWD IMEDSW,STSYM^
BSWITCHXWDIMEDSWSTINIC	002703'	000040	003012'		SWITCH INITIAL,<XWD IMEDSW,STINI>^XWD IMEDSW,STINI^
BSWITCHXWDIMEDSWSTCLSC	002704'	000040	003013'		SWITCH CLOSE,<XWD IMEDSW,STCLS>^XWD IMEDSW,STCLS^
BSWITCHXWDIMEDSWSETUSRC	002705'	000040	003034'		SWITCH USER,<XWD IMEDSW,SETUSR>^XWD IMEDSW,SETUSR^
BSWITCHXWDIMEDSWSETRUNC	002706'	000040	000055'		SWITCH RUN,<XWD IMEDSW,SETRUN>^XWD IMEDSW,SETRUN^
BPROCESXSWITCHXWDF4SWC	002707'	400000	000000		X FORTRAN,F4,F40^SWITCH FORTRAN,<XWD F4SW,0>^XWD F4SW,0^^
BXSWITCHXWDMACSWC	002710'	200000	000000		X MACRO,MAC,MACRO^SWITCH MACRO,<XWD MACSW,0>^XWD MACSW,0^^
BXSWITCHXWDFTFSWC	002711'	100000	000000		X FTFORTRAN,FTF,FTF40^SWITCH FTFORTRAN,<XWD FTFSW,0>^XWD FTFSW,0^^
BXSWITCHXWDSIMSWDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 29-4
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	002712'	040000	000000		X SIMPL,SIM,SIMPL^SWITCH SIMPL,<XWD SIMSW,0>^XWD SIMSW,0^^
BXSWITCHXWDFALSWC	002713'	020000	000000		X FAIL,FAL,FAIL^SWITCH FAIL,<XWD FALSW,0>^XWD FALSW,0^^
BXSWITCHXWDCBLSWC	002714'	010000	000000		X COBOL,CBL,COBOL^SWITCH COBOL,<XWD CBLSW,0>^XWD CBLSW,0^^
BXSWITCHXWDBLISWC	002715'	004000	000000		X BLIMP,BLI,BLISS^SWITCH BLIMP,<XWD BLISW,0>^XWD BLISW,0^^
BXSWITCHXWDVASSWC	002716'	002000	000000		X VAS,VAS,VAS^SWITCH VAS,<XWD VASSW,0>^XWD VASSW,0^^
BSWTAB3FORXXXC			000001	08200	SWTAB3: FOR (1,NSDNM,<XWD CAT(NSDS,\XXX),0>)^XXX==1
BREPEATNSDNMXWDCATXXXNSDS1C	002717'	001000	000000		XWD CAT(NSDS,\XXX)^NSDS1^,0
BIFBXXXXXXIFNBXWDCATXXXNSDS2C	002720'	000400	000000		XWD CAT(NSDS,\XXX)^NSDS2^,0
BIFBXXXXXXIFNBXWDCATXXXNSDS3C	002721'	000200	000000		XWD CAT(NSDS,\XXX)^NSDS3^,0
BIFBXXXXXXIFNBC
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 30
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;LOOK UP A SWITCH IN A GIVEN TABLE. NO SKIP IF NOT FOUND,
BC				00200	;SKIP IF EXACT MATCH, DOUBLE SKIP IF PARTIAL MATCH WITH NO AMBIGUITY
BC
BSWSCANMOVET3ACCUMC	002722'	200140	002066*	00400	SWSCAN: MOVE T3,ACCUM   ;FIND OUT HOW MANY LETTERS
BMOVNIT2C	002723'	211100	000001	00500	        MOVNI T2,1
BSWSC1CAMNT3SIXBITC	002724'	316140	011324'	00600	SWSC1:  CAMN    T3,[SIXBIT '?']
BJRSTSWSC0CC	002725'	254000	002751'	00700	        JRST    SWSC0C
BLSHT3C	002726'	242140	000006	00800	        LSH T3,6
BLSHT2C	002727'	242100	777772	00900	        LSH T2,-6       ;GET ZEROS IN T2 WHERE THERE ARE LETTERS
BJUMPNT3SWSC1C	002730'	326140	002724'	01000	        JUMPN T3,SWSC1
BSETOMNUMATC	002731'	476000	000000*	01100	        SETOM NUMAT     ;NONE FOUND YET
BSWSC3MOVET3T1C	002732'	200141	000000	01200	SWSC3:  MOVE T3,(T1)
BCAMNT3ACCUMC	002733'	316140	002722*	01300	        CAMN T3,ACCUM   ;EXACT MATCH?
BJRSTCPOPJ1C	002734'	254000	002747'	01400	        JRST CPOPJ1     ;YES, SKIP RETURN
BANDCMT3T2C	002735'	420140	000002	01500	        ANDCM T3,T2     ;LOOK AT ONLY THOSE LETTERS TYPED
BCAMET3ACCUMC	002736'	312140	002733*	01600	        CAME T3,ACCUM   ;MATCH NOW??
BJRSTSWSC2C	002737'	254000	002742'	01700	        JRST SWSC2      ;NO
BAOSNUMATC	002740'	350000	002731*	01800	        AOS NUMAT       ;RECORD ANOTHER PARTIAL MATCH
BMOVEMT1SVINDC	002741'	202040	002552*	01900	        MOVEM T1,SVIND  ;SAVE IT
BSWSC2AOBJNT1SWSC3C	002742'	253040	002732'	02000	SWSC2:  AOBJN T1,SWSC3  ;TRY FOR MORE
BSKIPENUMATC	002743'	332000	002740*	02100	        SKIPE NUMAT     ;MUST BE ONE AND ONLY 1 PARTIAL MATCH
BPOPJPC	002744'	263740	000000	02200	        POPJ P,         ;ELSE ERROR RETURN
BMOVET1SVINDC	002745'	200040	002741*	02300	        MOVE T1,SVIND   ;GET IT
BAOSPC	002746'	350017	000000	02400	        AOS(P)  ;PARTIAL IS DOUBLE SKIP RETURN
BCPOPJ1AOSPC	002747'	350017	000000	02500	CPOPJ1: AOS(P)
BPOPJPC	002750'	263740	000000	02600	        POPJ P,         ;SKIP RETURN
BSWSC0CMOVEMT1SVINDC	002751'	202040	002745*	02700	SWSC0C: MOVEM   T1,SVIND
BOUTSTRASCIZC	002752'	051140	011325'	02800	        OUTSTR  [ASCIZ "OPTIONS ARE"]
BMOVEIT2C	002753'	201100	000072	02900	        MOVEI   T2,":"
BSWSC0AHRRZT3SVINDC	002754'	550140	002751*	03000	SWSC0A: HRRZ    T3,SVIND
BCAIET3COMTABC	002755'	302140	001507'	03100	        CAIE    T3,COMTAB
BJRSTSWS0A1C	002756'	254000	002765'	03200	        JRST    SWS0A1
BMOVET3T1C	002757'	200141	000000	03300		MOVE    T3,(T1)
BCAMET3SIXBITC	002760'	312140	011330'	03400	        CAME    T3,[SIXBIT 'CTEST']
BCAMNT3SIXBITC	002761'	316140	011331'	03500	        CAMN    T3,[SIXBIT 'CRE']
BJRSTSWSC0DC	002762'	254000	002775'	03600	        JRST    SWSC0D
BCAMNT3SIXBITC	002763'	316140	011332'	03700	        CAMN    T3,[SIXBIT 'CREF']
BJRSTSWSC0DC	002764'	254000	002775'	03800	        JRST    SWSC0D
BSWS0A1MOVET3T1C	002765'	200141	000000	03900	SWS0A1:	MOVE    T3,(T1)
BOUTCHRT2C	002766'	051040	000002	04000	        OUTCHR  T2
BSWSC0BSETZT2C	002767'	400100	000000	04100	SWSC0B: SETZ    T2,
BLSHCT2C	002770'	246100	000006	04200	        LSHC    T2,6
BADDIT2C	002771'	271100	000040	04300	        ADDI    T2," "
BOUTCHRT2C	002772'	051040	000002	04400	        OUTCHR  T2
BJUMPNT3SWSC0BC	002773'	326140	002767'	04500	        JUMPN   T3,SWSC0B
BMOVEIT2C	002774'	201100	000054	04600	        MOVEI   T2,","
BSWSC0DAOBJNT1SWSC0AC	002775'	253040	002754'	04700	SWSC0D: AOBJN   T1,SWSC0A
BMOVET1SVINDC	002776'	200040	002754*	04800	        MOVE    T1,SVIND
BOUTSTRASCIZC				04900	        OUTSTR  [ASCIZ ".
BC	002777'	051140	011333'	05000	"]
BJRSTEXC	003000'	254000	001410'	05100	        JRST    EX
BC
BXSWSMOVECLODSPC	003001'	200700	002531*	05300	XSWS:   MOVE C,LODSP
BEXCHCLODSP2DRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 30-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	003002'	250700	002527*	05400	        EXCH C,LODSP2
BMOVEMCLODSPC	003003'	202700	003001*	05500	        MOVEM C,LODSP
BMOVECLODCTRC	003004'	200700	002525*	05600	        MOVE C,LODCTR
BEXCHCLODCT2C	003005'	250700	002523*	05700	        EXCH C,LODCT2
BMOVEMCLODCTRC	003006'	202700	003004*	05800	        MOVEM C,LODCTR
BPOPJPC	003007'	263740	000000	05900	        POPJ P,
BC
BSETCCSTROFLCCSRNFC	003010'	660000	100000	06100	SETCCS:	TRO	FL,CCSRNF	;SET TO MAKE PROCESSOR RUN CCS
BJRSTSCANC	003011'	254000	000276'	06200		JRST	SCAN
BC
BSTINISKIPAT2SIXBITC	003012'	334100	011334'	06400	STINI:	SKIPA	T2,[SIXBIT'/1Y']
BSTCLSMOVSIT2C	003013'	205100	171571	06500	STCLS:	MOVSI	T2,'/-Y'
BTRNEFLDOLODC	003014'	602000	000002	06600		TRNE	FL,DOLOD
BPUSHJPLODSIXC	003015'	260740	001645'	06700		PUSHJ	P,LODSIX	;SEND FLAG TO LOADER
BJRSTSCANC	003016'	254000	000276'	06800		JRST	SCAN
BC
BSTNAMSKIPAT2SIXBITC	003017'	334100	011335'	07000	STNAM:	SKIPA	T2,[SIXBIT'/Y']
BSTSYMMOVSIT2C	003020'	205100	172242	07100	STSYM:	MOVSI	T2,'/2B'
BPUSHJPSTARGSC	003021'	260740	010727'	07200		PUSHJ	P,STARGS
BTRNNFLDOLODC	003022'	606000	000002	07300		TRNN	FL,DOLOD
BJRSTFINPRSC	003023'	254000	010721'	07400		JRST	FINPRS		;FORGET IT IF NOT LOADING
BPUSHPT2C	003024'	261740	000002	07500		PUSH	P,T2
BTRNNFLIDFC	003025'	606000	000020	07600		TRNN	FL,IDF
BJRSTSYNERRC	003026'	254000	001065'	07700		JRST	SYNERR
BMOVET2ACCUMC	003027'	200100	002736*	07800		MOVE	T2,ACCUM
BPUSHJPLODSIXC	003030'	260740	001645'	07900		PUSHJ	P,LODSIX	;SEND FILE NAME TO LOADER
BPOPPT2C	003031'	262740	000002	08000		POP	P,T2
BPUSHJPLODSIXC	003032'	260740	001645'	08100		PUSHJ	P,LODSIX	;AND APPROPRIATE SWITCH
BJRSTFINPRSC	003033'	254000	010721'	08200		JRST	FINPRS
BC
BSETUSRPUSHJPSCANC	003034'	260740	000276'	08400	SETUSR:	PUSHJ	P,SCAN
BCAIECC	003035'	302700	000050	08500		CAIE	C,"("
BJRSTSYNERRC	003036'	254000	001065'	08600		JRST	SYNERR		;USER NAME MUST BEGIN WITH (
BPUSHJPGTUNOC	003037'	260740	006036'	08700		PUSHJ	P,GTUNO
BMOVEMT3DEFPPNC	003040'	202140	000211*	08800		MOVEM	T3,DEFPPN	;SAVE USER NAME (PPN) AS DEFAULT
BCAIECC	003041'	302700	000051	08900		CAIE	C,")"
BJRSTSYNERRC	003042'	254000	001065'	09000		JRST	SYNERR		;MUST END WITH )
BJRSTSCANC	003043'	254000	000276'	09100		JRST	SCAN
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 31
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;HERE ON "/" AFTER A FILE NAME
BC
BCOMPSWTRZFLPERFC	003044'	620000	000200	00300	COMPSW: TRZ FL,PERF     ;DOING TEMP
BPUSHJPCOMPSC	003045'	260740	002537'	00400	        PUSHJ P,COMPS
BJRSTILP2C	003046'	254000	002441'	00500	        JRST ILP2
BC
BC				00700	;HERE ON "/" AS FIRST CHAR OF IDENT, I.E. PERM SW
BC
BCOMPS1TROFLPERFC	003047'	660000	000200	00900	COMPS1: TRO FL,PERF
BPUSHJPCOMPSC	003050'	260740	002537'	01000	        PUSHJ P,COMPS
BJRSTILP0AC	003051'	254000	002422'	01100	        JRST ILP0A
BC
BSETMAPTRONFLMAPSTC	003052'	666000	000400	01300	SETMAP:	TRON FL,MAPST   ;IS IT SET?
BTRNNFLDOLODC	003053'	606000	000002	01400	        TRNN FL,DOLOD   ;OR NOT LOADING?
BJRSTSCANC	003054'	254000	000276'	01500	        JRST SCAN
BMOVEIT3OUTLODC	003055'	201140	010147'	01600	        MOVEI T3,OUTLOD
BPUSHJPOUCRLFC	003056'	260740	010063'	01700	        PUSHJ   P,OUCRLF
BMOVET2SIXBITC	003057'	200100	011336'	01800		MOVE T2,[SIXBIT'MAP_/M']
BPUSHJPOUTSIXC	003060'	260740	004206'	01900	        PUSHJ P,OUTSIX
BJRSTSCANC	003061'	254000	000276'	02000	        JRST SCAN
BC
BSETBDVSKIPAT4BINDVBINDVC	003062'	334200	011337'	02200	SETBDV:	SKIPA T4,[BINDV]
BSETLDVMOVEIT4LSTDVC	003063'	201200	002306*	02300	SETLDV: MOVEI T4,LSTDV
BPUSHJPSTARGSC	003064'	260740	010727'	02400	        PUSHJ P,STARGS
BTRNNFLIDFC	003065'	606000	000020	02500	        TRNN FL,IDF     ;DEVICE NAME MUST BE IDENT
BJRSTSYNERRC	003066'	254000	001065'	02600	        JRST SYNERR
BMOVET2ACCUMC	003067'	200100	003027*	02700	        MOVE T2,ACCUM
BCAMNT2SIXBITC	003070'	316100	011340'	02800	        CAMN T2,[SIXBIT /DSK/]  ;DSK IS A SPECIAL CASE
BMOVEIT2C	003071'	201100	000000	02900	        MOVEI T2,0      ;SAY NO SPECIAL DEVICE
BMOVEMT2T4C	003072'	202104	000000	03000	        MOVEM T2,(T4)
BPUSHJPSCANC	003073'	260740	000276'	03100	        PUSHJ P,SCAN    ;LOOK FOR :
BCAINCC	003074'	306700	000072	03200	        CAIN C,":"
BPUSHJPSCANC	003075'	260740	000276'	03300	        PUSHJ P,SCAN
BTRNNFL3PARFLGC	003076'	606440	000004	03400	        TRNN FL3,PARFLG ;IS IT IN ()
BPOPJPC	003077'	263740	000000	03500	        POPJ P,         ;NO, JUST EXIT
BEXCHT2LOKNAMC	003100'	250100	002277*	03600	        EXCH T2,LOKNAM
BOPENLOOKLOKINTC	003101'	050000	000000*	03700	        OPEN LOOK,LOKINT
BJRSTDEVNAC	003102'	254000	001122'	03800	        JRST DEVNA      ;NOT THERE
BMOVEMT2LOKNAMC	003103'	202100	003100*	03900	        MOVEM T2,LOKNAM ;RESTORE NAME
BNXACTCAINCC	003104'	306700	000051	04000	NXACT:  CAIN C,")"
BJRSTOLDVC	003105'	254000	003117'	04100	        JRST OLDV       ;GET OLD ONE BACK
BTRNNFLIDFC	003106'	606000	000020	04200	        TRNN FL,IDF     ;IF IDENT
BJRSTSYNERRC	003107'	254000	001065'	04300	        JRST SYNERR     ;OK, ELSE ERROR
BMOVET1XWDACTLGACTABC	003110'	200040	011341'	04400	        MOVE T1,[XWD -ACTLG,ACTAB]
BPUSHJPSWSCANC	003111'	260740	002722'	04500	        PUSHJ P,SWSCAN  ;LOOK IT UP
BJRSTUNRECSC	003112'	254000	001071'	04600	        JRST UNRECS
BJFCLC	003113'	255000	000000	04700	        JFCL
BXCTACTAB2ACTABT1C	003114'	256001	000006	04800	        XCT ACTAB2-ACTAB(T1)
BPUSHJPSCANC	003115'	260740	000276'	04900	        PUSHJ P,SCAN
BJRSTNXACTC	003116'	254000	003104'	05000	        JRST NXACT
BOLDVOPENLOOKDSKLKC	003117'	050000	002300*	05100	OLDV:   OPEN LOOK,DSKLK
BJRSTDSKNAC	003120'	254000	001053'	05200	        JRST DSKNA
BJRSTSCANC	003121'	254000	000276'	05300	        JRST SCAN
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 31-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC
BDEFINEC				05500	DEFINE TABLE
BTABLEC				05600	<SWITCH ZERO,<UTPCLR LOOK,>
BC				05700	SWITCH ZER%,<HALT>      ;SHOULD NEVER GET HERE
BC				05800	SWITCH REWIND,<PUSHJ P,DVREW>
BC				05900	SWITCH ADVANCE,<MTAPE LOOK,16>
BC				06000	SWITCH BACKSPACE,<MTAPE LOOK,17>
BC				06100	SWITCH EOT,<MTAPE LOOK,10>
BC				06200	>
BTBGENDEFINEC				06300	TBGEN (ACTAB,ACTLG,ACTAB2)^DEFINE SWITCH (P,Q)
BSWITCHC					<<SIXBIT /P/>>
BACTABTABLESWITCHSIXBITC	003122'	724562	570000		ACTAB:      TABLE^SWITCH ZERO,<UTPCLR LOOK,>^<SIXBIT /ZERO/>^
BSWITCHSIXBITC	003123'	724562	050000		SWITCH ZER%,<HALT>      ^<SIXBIT /ZER%/>^;SHOULD NEVER GET HERE
BSWITCHSIXBITC	003124'	624567	515644		SWITCH REWIND,<PUSHJ P,DVREW>^<SIXBIT /REWIND/>^
BSWITCHSIXBITC	003125'	414466	415643		SWITCH ADVANCE,<MTAPE LOOK,16>^<SIXBIT /ADVANCE/>^
BSWITCHSIXBITC	003126'	424143	536360		SWITCH BACKSPACE,<MTAPE LOOK,17>^<SIXBIT /BACKSPACE/>^
BSWITCHSIXBITC	003127'	455764	000000		SWITCH EOT,<MTAPE LOOK,10>^<SIXBIT /EOT/>^
BACTABACTLGDEFINESWITCHACTAB2TABLESWITCHUTPCLRLOOKC	003130'	047000	000013		ACTAB2:      TABLE^SWITCH ZERO,<UTPCLR LOOK,>^UTPCLR LOOK,^
BSWITCHHALTC	003131'	254200	000000		SWITCH ZER%,<HALT>      ^HALT      ^;SHOULD NEVER GET HERE
BSWITCHPUSHJPDVREWC	003132'	260740	003136'		SWITCH REWIND,<PUSHJ P,DVREW>^PUSHJ P,DVREW^
BSWITCHMTAPELOOKC	003133'	072000	000016		SWITCH ADVANCE,<MTAPE LOOK,16>^MTAPE LOOK,16^
BSWITCHMTAPELOOKC	003134'	072000	000017		SWITCH BACKSPACE,<MTAPE LOOK,17>^MTAPE LOOK,17^
BSWITCHMTAPELOOKC	003135'	072000	000010		SWITCH EOT,<MTAPE LOOK,10>^MTAPE LOOK,10^
BC
BDVREWMTAPELOOKC	003136'	072000	000001	06500	DVREW:  MTAPE LOOK,1    ;REWIND
BCAINT4BINDVC	003137'	306200	002305*	06600	        CAIN T4,BINDV   ;IF BINARY
BPOPJPC	003140'	263740	000000	06700	        POPJ P,         ;REWIND TO LOADER IF NEEDED
BPROCSWTROEFLPROCSDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 32
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	003141'	662000	000001	00100	PROCSW:        TROE FL,PROCS   ;HAVE WE ALREADY SEEN SOME?
BJRSTSYNERRC	003142'	254000	001065'	00200	        JRST SYNERR     ;YES, I DEFINE THIS AS ILLEGAL
BSETZBT3SWBKSSVPTC	003143'	403154	000121*	00300	        SETZB   T3,SWBKS(SVPT)
BMOVECPROCS0C	003144'	200700	011342'	00400	        MOVE    C,[0 @PROCS0]
BMOVEMCPCMPCMC	003145'	202700	000000*	00500	        MOVEM   C,PCM#
BMOVEMSWPTSWPT0SWPT0C	003146'	202540	000000*	00600	        MOVEM   SWPT,SWPT0#
BPROCS1PUSHJPGETCHC	003147'	260740	000342'	00700	PROCS1: PUSHJ   P,GETCH
BSOJLESWCNTETMSC	003150'	363500	001014'	00800	        SOJLE   SWCNT,ETMS
BCAIECC	003151'	302700	000051	00900	        CAIE    C,")"
BCAINCC	003152'	306700	000054	01000	        CAIN    C,","
BJRSTPROCS2C	003153'	254000	003164'	01100	        JRST    PROCS2
BJUMPLECSSYNERRC	003154'	323640	001065'	01200	        JUMPLE  CS,SYNERR
BIDPBCSWPT0C	003155'	136700	003146*	01300	        IDPB    C,SWPT0
BCAIECC	003156'	302700	000051	01400	        CAIE    C,")"
BJRSTPROCS1C	003157'	254000	003147'	01500	        JRST    PROCS1
BJRSTILP2AC	003160'	254000	002440'	01600	        JRST    ILP2A
BC
BPROCS0SWBKSSVPTC	003161'	000014	003143*	01800	PROCS0: 0       SWBKS(SVPT)
BEXPSWBKBSWBKLC	003162'	000000	002517*	01900	        EXP     SWBKB,SWBKL    ;DON'T YOU DARE TO MOVE IT
	003163'	000000	002521*
BPROCS2CAMNSWPTSWPT0C	003164'	316540	003155*	02000	PROCS2: CAMN    SWPT,SWPT0
BJRSTPROCS3C	003165'	254000	003173'	02100	        JRST    PROCS3
BSKIPEPCMC	003166'	332020	003145*	02200	        SKIPE   @PCM
BJRSTSYNERRC	003167'	254000	001065'	02300	        JRST    SYNERR
BMOVEMSWPTPCMC	003170'	202560	003166*	02400	        MOVEM   SWPT,@PCM
BIDPBT3SWPT0C	003171'	136140	003164*	02500	        IDPB    T3,SWPT0
BMOVESWPTSWPT0C	003172'	200540	003171*	02600	        MOVE    SWPT,SWPT0
BPROCS3CAINCC	003173'	306700	000051	02700	PROCS3: CAIN    C,")"
BJRSTILP2AC	003174'	254000	002440'	02800	        JRST    ILP2A
BAOSCPCMC	003175'	350700	003170*	02900	        AOS     C,PCM
BSKIPEPCMC	003176'	332020	003175*	03000	        SKIPE   @PCM
BJRSTSYNERRC	003177'	254000	001065'	03100	        JRST    SYNERR
BJRSTPROCS1C	003200'	254000	003147'	03200	        JRST    PROCS1
BC
BSETONMTRNEFLPROCSDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 33
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	003201'	602000	000001	00100	SETONM:        TRNE FL,PROCS   ;PROCESSOR SWITCHES NOT PERMITTED HERE
BJRSTSYNERRC	003202'	254000	001065'	00200	        JRST SYNERR
BMOVET1SVNAMSVPTC	003203'	200054	001666*	00300	        MOVE T1,SVNAM(SVPT)     ;GET THE NAME
BMOVEMT1ONAMC	003204'	202040	002515*	00400	        MOVEM T1,ONAM   ;AND SAVE IT AWAY
BMOVET1SVEXTSVPTC	003205'	200054	001670*	00500	        MOVE T1,SVEXT(SVPT)
BMOVEMT1OEXTC	003206'	202040	002405*	00600	        MOVEM T1,OEXT
BMOVET1SVPPNSVPTC	003207'	200054	001237*	00700	        MOVE T1,SVPPN(SVPT)
BMOVEMT1OPPNC	003210'	202040	002406*	00800	        MOVEM T1,OPPN   ;SET UP EXT AND PPN FOR OUTPUT NAME
BPUSHJPXSWSC	003211'	260740	003001'	00900	        PUSHJ P,XSWS
BJRSTILP0C	003212'	254000	002421'	01000	        JRST ILP0       ;AND GO
BC
BLOADS1PUSHJPLODS1C	003213'	260740	003216'	01200	LOADS1: PUSHJ P,LODS1
BJRSTILP0C	003214'	254000	002421'	01300	        JRST ILP0
BLOADS2PUSHPILP2AC	003215'	261740	011343'	01400	LOADS2: PUSH P,[ILP2A]  ;SET RETURN POINT
BLODS1PUSHJPGETCHC	003216'	260740	000342'	01500	LODS1:  PUSHJ P,GETCH   ;NEXT CHR
BCAIECC	003217'	302700	000055	01600	        CAIE    C,"-"           ;ALLOW MINUS IN LOADER SWITCHES
BJUMPLECSSYNERRC	003220'	323640	001065'	01700	        JUMPLE CS,SYNERR        ;SPECIAL CHARACTERS NOT PERMITTED
BIDPBCLODSPC	003221'	136700	003003*	01800	        IDPB C,LODSP    ;SAVE IT
BSOSGLODCTRC	003222'	377000	003006*	01900	        SOSG LODCTR     ;CHECK SIZE
BJRSTETMSC	003223'	254000	001014'	02000	        JRST ETMS
BTLNNCSNUMFC	003224'	607640	100000	02100	        TLNN CS,NUMF    ;A NUMBER
BPOPJPC	003225'	263740	000000	02200	        POPJ P,         ;NO, DONE
BJRSTLODS1C	003226'	254000	003216'	02300	        JRST LODS1      ;YES, THEY GET PASSED ON
BC
BSWBITSHRRZT2T4C	003227'	550104	000000	02500	SWBITS: HRRZ T2,(T4)    ;LIST POINTER IN T4 LIST GEN WITH SBTS
BXCTPC	003230'	256037	000000	02600	        XCT @(P)        ;THE MAJIC TEST INSTR
BJRSTNOSWC	003231'	254000	003234'	02700	        JRST NOSW       ;NOT THIS ONE
BHLLZT2T4C	003232'	510104	000000	02800	        HLLZ T2,(T4)    ;GET SIXBIT
BPUSHJPOUTSIXC	003233'	260740	004206'	02900	        PUSHJ P,OUTSIX
BNOSWAOBJNT4SWBITSC	003234'	253200	003227'	03000	NOSW:   AOBJN T4,SWBITS
BAOSPC	003235'	350017	000000	03100	        AOS (P)         ;SKIP THE INSTRUCTION WE WERE EXECUTING
BPOPJPC	003236'	263740	000000	03200	        POPJ P,
BC
BSETCRFTRZFL3ALLCRFC	003237'	620440	037400	03400	SETCRF: TRZ FL3,ALLCRF  ;GET RID OF FLAGS
BSETCRCMOVSIT1CRSWLISTSWC	003240'	205040	000003	03500	SETCRC: MOVSI T1,CRSW!LISTSW
BJRSTINTSWC	003241'	254000	002554'	03600	        JRST INTSW      ;FAKE A SWITCH AND RETURN
BC
BSETCROTRZFL3ALLCRFC	003242'	620440	037400	03800	SETCRO: TRZ FL3,ALLCRF
BPUSHJPSTARGSC	003243'	260740	010727'	03900	        PUSHJ P,STARGS
BSETCR1TRNNFLIDFC	003244'	606000	000020	04000	SETCR1: TRNN FL,IDF
BJRSTSYNERRC	003245'	254000	001065'	04100	        JRST SYNERR
BMOVET1XWDCLGCSWSC	003246'	200040	011344'	04200	        MOVE T1,[XWD -CLG,CSWS]
BPUSHJPSWSCANC	003247'	260740	002722'	04300	        PUSHJ P,SWSCAN
BJRSTUNRECSC	003250'	254000	001071'	04400	        JRST UNRECS
BJFCLC	003251'	255000	000000	04500	        JFCL
BTROFL3CSWS2CSWST1C	003252'	660461	000006	04600	        TRO FL3,@CSWS2-CSWS(T1) ;SET SWITCH
BTRNNFL3PARFLGC	003253'	606440	000004	04700	        TRNN FL3,PARFLG ;IN THE () MODE?
BJRSTSETCRCC	003254'	254000	003240'	04800	        JRST SETCRC     ;SCAN AND FAKE SWITCH
BPUSHJPSCANC	003255'	260740	000276'	04900	        PUSHJ P,SCAN
BCAIECC	003256'	302700	000051	05000	        CAIE C,")"
BJRSTSETCR1C	003257'	254000	003244'	05100	        JRST SETCR1
BJRSTSETCRCC	003260'	254000	003240'	05200	        JRST SETCRC
BC
BDEFINEDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 33-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				05400	DEFINE TABLE
BTABLEC				05500	<SWITCH NOSYMBOLS,CNSBT
BC				05600	SWITCH NOMACROS,CNMBT
BC				05700	SWITCH OPCODES,COPBT
BC				05800	SWITCH NOLISTING,CNLBT
BC				05900	SWITCH MONITOR,CMONBT
BC				06000	SWITCH COMBINE,CCMBT>
BTBGENDEFINEC				06100	TBGEN (CSWS,CLG,CSWS2)^DEFINE SWITCH (P,Q)
BSWITCHC					<<SIXBIT /P/>>
BCSWSTABLESWITCHSIXBITC	003261'	565763	715542		CSWS:      TABLE^SWITCH NOSYMBOLS,CNSBT^<SIXBIT /NOSYMBOLS/>^
BSWITCHSIXBITC	003262'	565755	414362		SWITCH NOMACROS,CNMBT^<SIXBIT /NOMACROS/>^
BSWITCHSIXBITC	003263'	576043	574445		SWITCH OPCODES,COPBT^<SIXBIT /OPCODES/>^
BSWITCHSIXBITC	003264'	565754	516364		SWITCH NOLISTING,CNLBT^<SIXBIT /NOLISTING/>^
BSWITCHSIXBITC	003265'	555756	516457		SWITCH MONITOR,CMONBT^<SIXBIT /MONITOR/>^
BSWITCHSIXBITC	003266'	435755	425156		SWITCH COMBINE,CCMBT^<SIXBIT /COMBINE/>^^
BCSWSCLGDEFINESWITCHCSWS2TABLESWITCHCNSBTC	003267'	000000	000400		CSWS2:      TABLE^SWITCH NOSYMBOLS,CNSBT^CNSBT^
BSWITCHCNMBTC	003270'	000000	001000		SWITCH NOMACROS,CNMBT^CNMBT^
BSWITCHCOPBTC	003271'	000000	002000		SWITCH OPCODES,COPBT^COPBT^
BSWITCHCNLBTC	003272'	000000	004000		SWITCH NOLISTING,CNLBT^CNLBT^
BSWITCHCMONBTC	003273'	000000	020000		SWITCH MONITOR,CMONBT^CMONBT^
BSWITCHCCMBTC	003274'	000000	010000		SWITCH COMBINE,CCMBT^CCMBT^^
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 34
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;FINISHED SCANNING A NAME, PICK OUT THE RIGHT FILE FOR IT 
BC				00200	;(CHECK STANDARD PROCESSORS, REL FILE, ETC)
BC
BSETUPMOVEMCSAVCSAVCC	003275'	202700	000000*	00400	SETUP:  MOVEM   C,SAVC#
BSKIPEONAMC	003276'	332000	003204*	00500	        SKIPE ONAM      ;SET ONAM IF NOT ALREADY
BJRSTONSETC	003277'	254000	003305'	00600	        JRST ONSET
BMOVET1SVNAMSVPTC	003300'	200054	003203*	00700	        MOVE T1,SVNAM(SVPT)     ;AS LAST FILE NAME
BMOVEMT1ONAMC	003301'	202040	003276*	00800	        MOVEM T1,ONAM
BMOVET1SVPPNSVPTC	003302'	200054	003207*	00900	        MOVE T1,SVPPN(SVPT)
BMOVEMT1OPPNC	003303'	202040	003210*	01000	        MOVEM T1,OPPN   ;SET UP PPN SAME AS INPUT
BSETZMOEXTC	003304'	402000	003206*	01100	        SETZM OEXT      ;AUTO REL EXT
BONSETMOVSIT1NFILEC	003305'	205040	777677	01200	ONSET:  MOVSI T1,-NFILE ;NUMBER OF FILES
BTRZFLNODATC	003306'	620000	000004	01300	        TRZ FL,NODAT    ;WE HAVE NOT SEEN A DIFFERENT DEVICE
BSETZMSDATC	003307'	402000	000000*	01400	        SETZM SDAT      ;LATEST DATE
BSETZMSTIMC	003310'	402000	000000*	01500	        SETZM STIM      ;AND LATEST TIME
BSKIPNT2SVDEVC	003311'	336100	001231*	01600	        SKIPN T2,SVDEV  ;IF A DEVICE FOR FIRST FILE, USE IT
BMOVET2LOKNAMC	003312'	200100	003103*	01700	        MOVE T2,LOKNAM  ;ELSE SAVED NAME (ALL MUST BE SAME
BMOVEMT2ODEVODEVC	003313'	202100	000000*	01800	        MOVEM T2,ODEV#  ;OR THIS WILL BE ZEROED LATER
BTLZFL2C	003314'	621400	777777	01900	        TLZ FL2,-1      ;NO PROCESSOR YET
BPUSHJPGETPROC	003315'	260740	003560'	02000	        PUSHJ P,GETPRO  ;GO FIND DATE AND PROCESSOR
BTLNEFL2RELSWC	003316'	603400	000010	02100	        TLNE FL2,RELSW  ;IF A REL FILE
BJRSTNOCOM1C	003317'	254000	003511'	02200	        JRST NOCOM1      ;GO LOAD IT NOW
BTRNNFLNODATC	003320'	606000	000004	02300	        TRNN FL,NODAT   ;NO DATES ON OTHER DEVICES
BTLNEFL3COMPLSC	003321'	603440	000020	02400	        TLNE FL3,COMPLS ;DO WE ALWAYS WANT TO COMPILE?
BJRSTDOCOMPC	003322'	254000	003377'	02500	        JRST DOCOMP     ;YES, IGNORE DATES
BSKIPAT1OPPNC	003323'	334040	003303*	02600		SKIPA T1,OPPN
BRERELSETZBT1OPPNC	003324'	403040	003323*	02700	REREL:	SETZB T1,OPPN
BMOVEMT1LPPNC	003325'	202040	001362*	02800	        MOVEM T1,LPPN   ;BUT ONLY FIRST TIME
BMOVET1ONAMC	003326'	200040	003301*	02900	        MOVE T1,ONAM    ;SEE IF REL IS THERE
BMOVEMT1LNAMC	003327'	202040	001365*	03000	        MOVEM T1,LNAM
BSKIPNT1OEXTC	003330'	336040	003304*	03100	        SKIPN T1,OEXT   ;CHECK FOR OUTPUT EXTENSION
BMOVSIT1SIXBITC	003331'	205040	624554	03200	        MOVSI T1,SIXBIT '   REL'
BMOVEMT1LEXTC	003332'	202040	001360*	03300	        MOVEM T1,LEXT
BSKIPNT2BINDVC	003333'	336100	003137*	03400	        SKIPN T2,BINDV
BJRSTNOBDVRC	003334'	254000	003357'	03500	        JRST NOBDVR
BDEVCHRT2C	003335'	047100	000004	03600		DEVCHR T2,
BTLNNT2DSKBTDTABTC	003336'	607100	200004	03700	        TLNN T2,DSKBT!DTABT
BJRSTDOCOMPC	003337'	254000	003377'	03800	        JRST DOCOMP     ;NOT A DIRECTORY DEVICE, RECOMPILE
BMOVET2BINDVC	003340'	200100	003333*	03900	        MOVE T2,BINDV
BEXCHT2LOKNAMC	003341'	250100	003312*	04000	        EXCH T2,LOKNAM
BOPENLOOKLOKINTC	003342'	050000	003101*	04100	        OPEN LOOK,LOKINT
BJRSTDEVNAC	003343'	254000	001122'	04200	        JRST DEVNA
BLOOKUPLOOKLNAMC	003344'	076000	003327*	04300	        LOOKUP LOOK,LNAM
BTRZAFL3PARFLGC	003345'	624440	000004	04400	        TRZA FL3,PARFLG ;A GOOD TEMP FLAG
BTROFL3PARFLGC	003346'	660440	000004	04500	        TRO FL3,PARFLG
BOPENLOOKDSKLKC	003347'	050000	003117*	04600	        OPEN LOOK,DSKLK
BJRSTDSKNAC	003350'	254000	001053'	04700	        JRST DSKNA
BTRZNFL3PARFLGC	003351'	626440	000004	04800	        TRZN FL3,PARFLG
BJRSTDOCOMPC	003352'	254000	003377'	04900	        JRST DOCOMP     ;COMPILE
BIFNWRD4LDBT2POINTLDATC	003353'	135100	011345'	05000	IFN WRD4,<LDB T2,[POINT 11,LDAT,23]
BIMULIT2C	003354'	221100	000074	05100	        IMULI T2,^D60   ;CONVERT TO 17 BIT TIME
BDPBT2LDAT.TC	003355'	137100	011015'	05200	        DPB T2,LDAT.TIME>
BJRSTRELDTC	003356'	254000	003361'	05300	        JRST RELDT
BNOBDVRIFEWRD4DRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 34-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	003357'			05400	NOBDVR: IFE WRD4,<LOOKUP LOOK,LNAM      ;IS IT THERE>
BIFNWRD4PUSHJPUFDLKC	003357'	260740	004137'	05500	IFN WRD4,<PUSHJ P,UFDLK         ;CHECK FOR IT IN UFD IN CORE>
BJRSTDOCOM1C	003360'	254000	003375'	05600	        JRST DOCOM1     ;NO, WE MUST RECOMPILE
BRELDTTLNNFLRELSWC	003361'	607000	000010	05700	RELDT:	TLNN FL,RELSW
BTLNEFL3RELSWC	003362'	603440	000010	05800		TLNE FL3,RELSW
BJRSTNOCOM1C	003363'	254000	003511'	05900		JRST NOCOM1	;IF /REL, DON'T COMPILE EVER
BLDBT2LDAT.DC	003364'	135100	011014'	06000		LDB T2,LDAT.DATE	;GET REL FILE DATE
BCAMGET2SDATC	003365'	315100	003307*	06100	        CAMGE T2,SDAT   ;EARLIER
BJRSTDOCOM1C	003366'	254000	003375'	06200	        JRST DOCOM1     ;YES, COMPILE
BCAMET2SDATC	003367'	312100	003365*	06300	        CAME T2,SDAT    ;SAME?
BJRSTNOCOM1C	003370'	254000	003511'	06400	        JRST NOCOM1     ;NO, ALL OK< UNLESS NEED LST FILE>
BLDBT2LDAT.TC	003371'	135100	011015'	06500	        LDB T2,LDAT.TIME     ;YES, GET TIME
BCAMGT2STIMC	003372'	317100	003310*	06600	        CAMG T2,STIM    ;LATER?
BJRSTDOCOM1C	003373'	254000	003375'	06700	        JRST DOCOM1     ;NO
BJRSTNOCOM1C	003374'	254000	003511'	06800	        JRST    NOCOM1          ;DON'T NEED TO RECOMPILE
BIFEC				06900	IFE 1,<
BC				07000	NOCOMW: TLNE FL3,LISTSW ;IF WANTS LISTING
BC				07100	        SKIPE LSTDV     ;AND NO LISTING DEVICE
BC				07200	        JRST NOCOM1
BC				07300	        SETZM LPPN      ;THEN LOOK TO SEE IF THERE
BC				07400	        MOVE T1,ONAM
BC				07500	        MOVEM T1,LNAM
BC				07600	        MOVSI T1,(SIXBIT /LST/)
BC				07700	        MOVEM T1,LEXT
BC				07800	IFE WRD4,<LOOKUP LOOK,LNAM>
BC				07900	IFN WRD4,<PUSHJ P,UFDLK>
BC				08000	        JRST DOCOML     ;NOT THERE, GENERATE LISTING
BC				08100	        LDB T2,LDAT.DATE       ;CHECK DATE
BC				08200	        CAMGE T2,SDAT
BC				08300	        JRST DOCOML     ;OLD ONE
BC				08400	        CAME T2,SDAT
BC				08500	        JRST NOCOM1     ;ALL OK
BC				08600	        LDB T2,LDAT.TIME
BC				08700	        CAMLE T2,STIM
BC				08800	        JRST NOCOM1     ;GOOD ONE
BC				08900	        JRST DOCOML     ;OLD ONE
BC				09000	>
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 35
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;SET UP APPROPRIATE COMMAND FOR THE PROCESSOR WHICH HAS BEEN ELECTED
BC				00200	;FOR THIS FILE
BC
BDOCOM1SKIPEOPPNC	003375'	332000	003324*	00400	DOCOM1:	SKIPE OPPN
BJRSTRERELC	003376'	254000	003324'	00500		JRST REREL	;IF TRIED ANOTHER, TRY SELF
BDOCOMPSETZMOPPNC	003377'	402000	003375*	00600	DOCOMP:	SETZM OPPN
BMOVEIT3C	003400'	201140	000000	00700	        MOVEI T3,0      ;GET THE PROCESSOR
BSKIPAT1FL2C	003401'	334040	000010	00800	        SKIPA T1,FL2
BDC1LSHT1C	003402'	242040	000001	00900	DC1:    LSH T1,1        ;TRY NEXT BIT
BTLNNT1C	003403'	607040	400000	01000	        TLNN T1,400000  ;IS HIGH BIT ON YET?
BAOJAT3DC1C	003404'	344140	003402'	01100	        AOJA T3,DC1     ;TURNS IT INTO A NUMBER
BDC2C	003405'			01200	DC2:
BMOVEMT3PCNUMC	003405'	202140	000000*	01300	        MOVEM T3,PCNUM  ;SAVE IT FOR LATER
BCAILT3NPROCSC	003406'	301140	000010	01400	        CAIL T3,NPROCS
BADDIT3C	003407'	271140	000001	01500	        ADDI T3,1       ;ONE MORE (BECAUSE OF REL-LOADER IN TABLE)
BMOVET3PRCTABT3C	003410'	200143	004343'	01600	        MOVE T3,PRCTAB(T3)      ;GET THE NAME OF THE OUTPUT ROUTINE
BTLNEFL3NOBINC	003411'	603440	000400	01700		TLNE FL3,NOBIN	;DOING ANY REL FILE?
BJRSTTRYLSTC	003412'	254000	003427'	01800	        JRST TRYLST     ;NO, LISTING
BSKIPET2BINDVC	003413'	332100	003340*	01900	        SKIPE T2,BINDV
BPUSHJPOUTDVC	003414'	260740	004225'	02000	        PUSHJ P,OUTDV
BMOVET2ONAMC	003415'	200100	003326*	02100	        MOVE T2,ONAM    ;START PUTTING OUT
BPUSHJPOUTSIXC	003416'	260740	004206'	02200	        PUSHJ P,OUTSIX
BSKIPNT2OEXTC	003417'	336100	003330*	02300	        SKIPN T2,OEXT
BJRSTNREXTC	003420'	254000	003425'	02400	        JRST NREXT
BHLLZST2C	003421'	513000	000002	02500	        HLLZS T2        ;PUT OUT EXTENSION
BMOVEIT1C	003422'	201040	000056	02600	        MOVEI T1,"."
BPUSHJPT3C	003423'	260743	000000	02700	        PUSHJ P,(T3)
BPUSHJPOUTSIXC	003424'	260740	004206'	02800	        PUSHJ P,OUTSIX
BNREXTSKIPET2SWBKBC	003425'	332100	003162*	02900	NREXT:  SKIPE T2,SWBKB  ;ARE THERE SWITCHES
BPUSHJPOUTSWC	003426'	260740	004214'	03000	        PUSHJ P,OUTSW   ;YES, OUTPUT THEM
BTRYLSTTLNNFL3LISTSWC	003427'	607440	000001	03100	TRYLST: TLNN FL3,LISTSW ;LISTING REQUESTED?
BJRSTNOLSTC	003430'	254000	003450'	03200	        JRST NOLST
BMOVEIT1C	003431'	201040	000054	03300	        MOVEI T1,","    ;YES, NEED A COMMA
BPUSHJPT3C	003432'	260743	000000	03400	        PUSHJ P,(T3)
BSKIPET2LSTDVC	003433'	332100	003063*	03500	        SKIPE T2,LSTDV
BPUSHJPOUTDVC	003434'	260740	004225'	03600	        PUSHJ P,OUTDV
BMOVET2ONAMC	003435'	200100	003415*	03700	        MOVE T2,ONAM    ;SET IT UP
BPUSHJPOUTSIXC	003436'	260740	004206'	03800	        PUSHJ P,OUTSIX
BTLNNFL3CRSWC	003437'	607440	000002	03900	        TLNN FL3,CRSW   ;CREF MAYBE
BJRSTNOLST1C	003440'	254000	003443'	04000	        JRST NOLST1
BMOVSIT2SIXBITDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 36
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	003441'	205100	174300	00100	       MOVSI T2,SIXBIT '   /C '
BPUSHJPOUTSIXC	003442'	260740	004206'	00200	        PUSHJ P,OUTSIX
BNOLST1PUSHPT3C	003443'	261740	000003	00300	NOLST1: PUSH P,T3       ;PUT OUT TO CREF FOR /L ALSO
BPUSHJPENTCRFC	003444'	260740	004244'	00400	        PUSHJ P,ENTCRF  ;PUT IT IN THE ###CREF FILE
BPOPPT3C	003445'	262740	000003	00500	        POP P,T3
BSKIPET2SWBKLC	003446'	332100	003163*	00600	        SKIPE T2,SWBKL  ;SWITCHES?
BPUSHJPOUTSWC	003447'	260740	004214'	00700	        PUSHJ P,OUTSW
BNOLSTMOVEIT1C	003450'	201040	000137	00800	NOLST:  MOVEI T1,"_"
BPUSHJPT3C	003451'	260743	000000	00900	        PUSHJ P,(T3)
BMOVSIT4NFILEC	003452'	205200	777677	01000	        MOVSI T4,-NFILE
BTRNEFL3FDBGSWC	003453'	602440	200000	01100	        TRNE    FL3,FDBGSW      ;IF THIS IS AN FDEBUG COMMAND
BTLNNFL2F4SWFTFSWC	003454'	607400	500000	01200	        TLNN    FL2,F4SW!FTFSW ;AND THIS IS A FOOTRAN COMPILATION
BJRSTPRCLPC	003455'	254000	003460'	01300	        JRST    PRCLP           ;THEN OUTPUT (X) TO COMPILER
BMOVSIT2SIXBITC	003456'	205100	107011	01400	        MOVSI   T2,(SIXBIT /(X)/) ;...
BPUSHJPOUTSIXC	003457'	260740	004206'	01500	        PUSHJ   P,OUTSIX        ;...
BPRCLPPUSHJPCMNOC	003460'	260740	003472'	01600	PRCLP:  PUSHJ P,CMNO
BSKIPET2SWBKST4C	003461'	332104	003161*	01700	        SKIPE T2,SWBKS(T4)      ;AND SWITCHES
BPUSHJPOUTSWC	003462'	260740	004214'	01800	        PUSHJ P,OUTSW
BCAMNT4SVPTC	003463'	316200	000014	01900	        CAMN T4,SVPT    ;ALL DONE?
BJRSTENDPRCC	003464'	254000	003470'	02000	        JRST ENDPRC     ;YES, GO FINISH UP AND CONSIDER LOADING
BMOVEIT1C	003465'	201040	000054	02100	        MOVEI T1,","
BPUSHJPT3C	003466'	260743	000000	02200	        PUSHJ P,(T3)    ;NEXT FILE
BAOBJNT4PRCLPC	003467'	253200	003460'	02300	        AOBJN T4,PRCLP
BENDPRCPUSHJPOUCRLFC	003470'	260740	010063'	02400	ENDPRC: PUSHJ   P,OUCRLF
BIFNSPRCC				02500	IFN SPRC,<
BC				02600	        TLNN FL2,SPRC>
BJRSTNOCOM1C	003471'	254000	003511'	02700	        JRST NOCOM1     ;GO LOAD
BIFNSPRCC				02800	IFN SPRC,<
BC				02900	        MOVSI SVPT,-NFILE       ;RESET POINTER
BC				03000	        MOVE T1,ONAM    ;AND FAKE WORLD
BC				03100	        MOVEM T1,SVNAM
BC				03200	        MOVE T3,PCNUM   ;GET BACK PROCESSOR NUMBER
BC				03300	        MOVE T1,INTEXT(T3)      ;GET EXTENSION
BC				03400	        MOVEM T1,SVEXT
BC				03500	        SETZM SVPPN
BC				03600	        SETZM SWBKS
BC				03700	        SETZM SWBKB
BC				03800	        SETZM SWBKL
BC				03900	        HRL FL2,NXPC(T3)        ;SET FOR NEXT PROCESSOR
BC				04000	        JRST DOCOMP     ;AND GO EMIT CALLS
BC				04100	>
BCMNOSKIPNT2SVDEVT4C	003472'	336104	003311*	04200	CMNO:   SKIPN T2,SVDEV(T4)      ;IS THERE A DEVICE THERE
BJRSTPRCLP2C	003473'	254000	003477'	04300	        JRST PRCLP2     ;NO
BPUSHJPOUTSIXC	003474'	260740	004206'	04400	        PUSHJ P,OUTSIX  ;YES, PRINT IT
BMOVEIT1C	003475'	201040	000072	04500	        MOVEI T1,":"
BPUSHJPT3C	003476'	260743	000000	04600	        PUSHJ P,(T3)
BPRCLP2SKIPET2SVNAMT4C	003477'	332104	003300*	04700	PRCLP2: SKIPE T2,SVNAM(T4)      ;PUT OUT NAME
BPUSHJPOUTSIXC	003500'	260740	004206'	04800	        PUSHJ P,OUTSIX
BHLLZT2SVEXTT4C	003501'	510104	003205*	04900	        HLLZ T2,SVEXT(T4)       ;GET EXTENSION
BJUMPET2NOEXTC	003502'	322100	003506'	05000	        JUMPE T2,NOEXT  ;NONE THERE
BMOVEIT1C	003503'	201040	000056	05100	        MOVEI T1,"."
BPUSHJPT3C	003504'	260743	000000	05200	        PUSHJ P,(T3)
BPUSHJPOUTSIXC	003505'	260740	004206'	05300	        PUSHJ P,OUTSIX
BNOEXTSKIPET2SVPPNT4DRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 36-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	003506'	332104	003302*	05400	NOEXT:  SKIPE T2,SVPPN(T4)      ;NEED PPN?
BPUSHJPOUTPPNC	003507'	260740	003750'	05500	        PUSHJ P,OUTPPN  ;PUT THEM OUT
BPOPJPC	003510'	263740	000000	05600	        POPJ P,
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 37
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;SET UP LOADER COMMAND FOR THIS FILE
BC
BNOCOM1TLNNFL3NOLODSC	003511'	607440	000200	00300	NOCOM1: TLNN FL3,NOLODS ;IF NOT TO LOAD THIS ONE
BTRNNFLDOLODC	003512'	606000	000002	00400	        TRNN FL,DOLOD   ;OR NOT LOADING
BJRSTNXFILPC	003513'	254000	002512'	00500	        JRST NXFILP     ;NO, GO TO NEXT
BMOVEICC	003514'	201700	000000	00600	        MOVEI C,0
BIDPBCLODSPC	003515'	136700	003221*	00700	        IDPB C,LODSP    ;END SECOND SET OF SWITCHES
BIDPBCLODSP2C	003516'	136700	003002*	00800	        IDPB C,LODSP2
BMOVEIT3OUTLODC	003517'	201140	010147'	00900		MOVEI T3,OUTLOD	;SET FOR LOADER
BMOVET2POINTLODSBKC	003520'	200100	011301'	01000	        MOVE T2,[POINT 7,LODSBK]        ;OUTPUT FIRST SWITCHES
BPUSHJPOUTSWC	003521'	260740	004214'	01100	        PUSHJ P,OUTSW
BTLNEFL2RELSWC	003522'	603400	000010	01200	        TLNE FL2,RELSW
BSKIPAT2ODEVC	003523'	334100	003313*	01300	        SKIPA T2,ODEV   ;IF REL SW, USE GIVEN DEVICE
BMOVET2BINDVC	003524'	200100	003413*	01400	        MOVE T2,BINDV
BJUMPNT2LODR0C	003525'	326100	003531'	01500	        JUMPN T2,LODR0  ;GO USE IT
BEXCHT2BINNAMC	003526'	250100	000000*	01600	        EXCH T2,BINNAM  ;SAVE IT, CHECK OLD ONE
BJUMPET2LODR1C	003527'	322100	003533'	01700	        JUMPE T2,LODR1  ;BOTH 0 NO NAME
BSKIPAT2SIXBITC	003530'	334100	011340'	01800	        SKIPA T2,[SIXBIT /DSK/] ;SET FOR DSK
BLODR0MOVEMT2BINNAMC	003531'	202100	003526*	01900	LODR0:  MOVEM T2,BINNAM ;SAVE NAME
BPUSHJPOUTDVC	003532'	260740	004225'	02000	        PUSHJ P,OUTDV
BLODR1MOVET2ONAMC	003533'	200100	003435*	02100	LODR1:  MOVE T2,ONAM    ;NOW FILE NAME
BPUSHJPOUTSIXC	003534'	260740	004206'	02200	        PUSHJ P,OUTSIX
BSKIPNT2OEXTC	003535'	336100	003417*	02300	        SKIPN T2,OEXT
BJRSTLODR2C	003536'	254000	003543'	02400	        JRST LODR2
BHLLZST2C	003537'	513000	000002	02500	        HLLZS T2
BMOVEIT1C	003540'	201040	000056	02600	        MOVEI T1,"."
BPUSHJPOUTLODC	003541'	260740	010147'	02700	        PUSHJ P,OUTLOD
BPUSHJPOUTSIXC	003542'	260740	004206'	02800	        PUSHJ P,OUTSIX
BLODR2SKIPET2OPPNC	003543'	332100	003377*	02900	LODR2:  SKIPE T2,OPPN   ;THEN THINK ABOUT PPN
BPUSHJPOUTPPNC	003544'	260740	003750'	03000	        PUSHJ P,OUTPPN
BTLNNFL3LIBSWC	003545'	607440	000004	03100	        TLNN FL3,LIBSW  ;LIBRARY?
BJRSTTRZNFL3INLIBC				03200	        JRST    [TRZN FL3,INLIB ;IN LIB MODE CURRENTLY?
BJRSTELODC				03300	                JRST ELOD       ;NO, IGNORE
BMOVSIT2SIXBITC				03400	                MOVSI T2,(SIXBIT :/N:)
BJRSTELODPC	003546'	254000	011346'	03500	                JRST ELODP]
BMOVSIT2SIXBITC	003547'	205100	175400	03600	        MOVSI T2,SIXBIT '   /L '        ;TELL LOADER
BTROFL3INLIBC	003550'	660440	000002	03700	        TRO FL3,INLIB
BELODPPUSHJPOUTSIXC	003551'	260740	004206'	03800	ELODP:  PUSHJ P,OUTSIX
BELODMOVET2POINTLODSB2C	003552'	200100	011302'	03900	ELOD:   MOVE T2,[POINT 7,LODSB2]        ;OUTPUT SECOND SET OF SWITCHES
BPUSHJPOUTSWC	003553'	260740	004214'	04000	        PUSHJ P,OUTSW
BC				04100	; THIS IS WHERE COBDDT USED TO LIVE
BC				04200	;IT WAS TRANSFERRED TO THE LOADER SECTION BY 'M'
BELOD2SKIPNT1SAVCC	003554'	336040	003275*	04300	ELOD2:	SKIPN	T1,SAVC
BMOVEIT1C	003555'	201040	000054	04400		MOVEI	T1,","		;USE LAST DELIMITER OR ,
BPUSHJPOUTLODC	003556'	260740	010147'	04500		PUSHJ	P,OUTLOD	;OUTPUT SOME DELIMITER
BJRSTNXFILPC	003557'	254000	002512'	04600		JRST	NXFILP
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 38
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;ROUTINE TO CHOOSE THE PROCESSOR FOR A FILE AND DECIDE WHETHER TO COMPILE AT ALL
BC
BGETPROMOVET3NPROC1C	003560'	200140	000000*	00300	GETPRO:        MOVE T3,NPROC1
BNFILMOVET2SVNAMT1C	003561'	200101	003477*	00400	NFIL:   MOVE T2,SVNAM(T1)       ;SET UP NAME AND PPN
BMOVEMT2LNAMC	003562'	202100	003344*	00500	        MOVEM T2,LNAM
BHLLZT2SVEXTT1C	003563'	510101	003501*	00600	        HLLZ T2,SVEXT(T1)
BNXEXTMOVEMT2LEXTC	003564'	202100	003332*	00700	NXEXT:  MOVEM T2,LEXT   ;START WITH ORIGINAL EXT
BMOVET2SVPPNT1C	003565'	200101	003506*	00800	        MOVE T2,SVPPN(T1)
BMOVEMT2LPPNC	003566'	202100	003325*	00900	        MOVEM T2,LPPN
BPUSHJPALTDEVC	003567'	260740	003714'	01000	        PUSHJ P,ALTDEV  ;WORRY ABOUT SOME OTHER DEVICE
BOKLOOKIFEWRD4C	003570'			01100	OKLOOK: IFE WRD4,<LOOKUP LOOK,LNAM>
BIFNWRD4PUSHJPUFDLKC	003570'	260740	004137'	01200	IFN WRD4,<PUSHJ P,UFDLK         ;CHECK IN CORE>
BJRSTNOTYETC	003571'	254000	003644'	01300	        JRST NOTYET     ;HAVE NOT FOUND IT YET
BDNLOKHLLZT2LEXTC	003572'	510100	003564*	01400	DNLOK:  HLLZ T2,LEXT    ;GET THE EXTENSION
BFNDATCAMNT2SIXBITC	003573'	316100	011352'	01500	FNDAT:  CAMN T2,[SIXBIT /REL/]
BJRSTISRELC	003574'	254000	003701'	01600	        JRST ISREL      ;SPECIAL FOR REL
BMOVEMT2SVEXTT1C	003575'	202101	003563*	01700	        MOVEM T2,SVEXT(T1)      ;SAVE EXTENSION
BLDBT2LDAT.DC	003576'	135100	011014'	01800	        LDB T2,LDAT.DATE       ;GET DATE
BCAMLET2SDATC	003577'	313100	003367*	01900	        CAMLE T2,SDAT   ;AND CHECK TO SEE IF LATEST
BJRSTSETDTC	003600'	254000	003634'	02000	        JRST SETDT
BCAMET2SDATC	003601'	312100	003577*	02100	        CAME T2,SDAT
BJRSTOLDATC	003602'	254000	003606'	02200	        JRST OLDAT
BLDBT2LDAT.TC	003603'	135100	011015'	02300	        LDB T2,LDAT.TIME
BCAMLET2STIMC	003604'	313100	003372*	02400	        CAMLE T2,STIM
BSETTMMOVEMT2STIMC	003605'	202100	003604*	02500	SETTM:  MOVEM T2,STIM   ;MARK WITH LATER ONE
BOLDATHLLZT2LEXTC	003606'	510100	003572*	02600	OLDAT:  HLLZ T2,LEXT    ;GET THE EXTENSION WE FOUND
BOLDAT1JUMPET2SETCPC	003607'	322100	003637'	02700	OLDAT1: JUMPE T2,SETCP  ;SET TO CURRENT PROCESSOR
BMOVNT3NPROC1C	003610'	210140	003560*	02800	        MOVN T3,NPROC1
BHRLZST3C	003611'	517000	000003	02900	        HRLZS T3        ;MINUS AND IN LEFT HALF
BCAMET2EXTABT3C	003612'	312103	000000*	03000	        CAME T2,EXTAB(T3)
BAOBJNT3C	003613'	253140	003612'	03100	        AOBJN T3,.-1
BJUMPGET3SETCPC	003614'	325140	003637'	03200	        JUMPGE T3,SETCP ;NOT THERE
BTLNEFL2ISPTABT3C	003615'	603423	004173'	03300	        TLNE FL2,@ISPTAB(T3)    ;IS THAT ONE ALREADY SET?
BJRSTNFIL2C	003616'	254000	003622'	03400	        JRST NFIL2
BTLNEFL2CALPROC	003617'	603420	002564*	03500	        TLNE FL2,@CALPRO        ;IS ANY SET?
BJRSTPROCONC	003620'	254000	001057'	03600	        JRST PROCON     ;YES, WE HAVE A CONFLICT
BTLOFL2ISPTABT3C	003621'	661423	004173'	03700	        TLO FL2,@ISPTAB(T3)     ;SET UP FOR THIS ONE
BNFIL2CAMET1SVPTC	003622'	312040	000014	03800	NFIL2:  CAME T1,SVPT    ;ARE WE DONE?
BNFIL1AOBJNT1GETPROC	003623'	253040	003560'	03900	NFIL1:  AOBJN T1,GETPRO ;NO, GO ON
BGTPRXTLNNFL2F4SWC	003624'	607400	400000	04000	GTPRX:	TLNN	FL2,F4SW	;NO FUNNY STUFF IF NOT F4 CHOSEN
BJRSTGTPRX1C	003625'	254000	003631'	04100		JRST	GTPRX1
BTLNNFLFTFSWC	003626'	607000	100000	04200		TLNN	FL,FTFSW	;CHOSE F4, NEED TO DIDDLE IT IF /FTF SEEN AS
BTLNEFL3FTFSWC	003627'	603440	100000	04300		TLNE	FL3,FTFSW	;EITHER PERMANENT OR TEMP SWITCH
BHRLIFL2FTFSWC	003630'	505400	100000	04400		HRLI	FL2,FTFSW	;/FTF OVERRIDES .F4 EXT, SO CHANGE PROCESSOR
BGTPRX1TLNEFL2FTFSWC	003631'	603400	100000	04500	GTPRX1:	TLNE	FL2,FTFSW
BSETOMFTFFLGFTFFLGC	003632'	476000	002557*	04600		SETOM	FTFFLG#		;IF FTF CHOSEN FOR ANY REASON, SET TO TELL LOADER
BPOPJPC	003633'	263740	000000	04700		POPJ	P,
BSETDTMOVEMT2SDATDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 39
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	003634'	202100	003601*	00100	SETDT: MOVEM T2,SDAT
BLDBT2LDAT.TC	003635'	135100	011015'	00200	        LDB T2,LDAT.TIME     ;AND TIME
BJRSTSETTMC	003636'	254000	003605'	00300	        JRST SETTM
BC
BSETCPCAMET1SVPTC	003637'	312040	000014	00500	SETCP:  CAME T1,SVPT    ;AT END?
BJRSTNFIL1C	003640'	254000	003623'	00600	        JRST NFIL1      ;NO, DO NOT SET
BTLNNFL2CALPROC	003641'	607420	003617*	00700	        TLNN FL2,@CALPRO        ;SOMETHING ALREDY SET?
BHLLFL2FL3C	003642'	500400	000011	00800	        HLL FL2,FL3     ;NO, SET TO CURRENT PROCESSOR
BJRSTGTPRXC	003643'	254000	003624'	00900		JRST	GTPRX
BC
BNOTYETSKIPET2SVEXTT1C	003644'	332101	003575*	01100	NOTYET: SKIPE T2,SVEXT(T1)      ;GET THE CURRENT EXT
BJRSTNOFIL1C	003645'	254000	003650'	01200	        JRST NOFIL1     ;IF HE SPECIFIED AN EXT WE LOSE
BPALFALMOVET2EXTABT3C	003646'	200103	000000*	01300	PALFAL: MOVE T2,EXTAB-1(T3)     ;ELSE PICK UP ONE
BSOJGET3NXEXTC	003647'	365140	003564'	01400	        SOJGE T3,NXEXT
BNOFIL1TLNNFL3FORWDSC	003650'	607440	000100	01500	NOFIL1: TLNN FL3,FORWDS ;IF NOT FORWARD
BJRSTTRYRELC	003651'	254000	003657'	01600	        JRST TRYREL     ;THEN NONE THERE
BFORFILDATET2C	003652'	047100	000014	01700	FORFIL: DATE    T2,     ;GET DATE
BADDIT2C	003653'	271100	000001	01800	        ADDI T2,1       ;SAY IT WAS TOMORROW
BMOVEMT2LDATC	003654'	202100	001361*	01900	        MOVEM T2,LDAT   ;TO FORCE COMPILATION
BHLLZT2SVEXTC	003655'	510100	003644*	02000	        HLLZ T2,SVEXT   ;GET EXTENSION
BJRSTFNDATC	003656'	254000	003573'	02100	        JRST FNDAT      ;AND GO
BC
BC
BTRYRELMOVET2ONAMC	003657'	200100	003533*	02400	TRYREL: MOVE T2,ONAM
BMOVEMT2LNAMC	003660'	202100	003562*	02500	        MOVEM T2,LNAM
BSKIPNT2OEXTC	003661'	336100	003535*	02600	        SKIPN T2,OEXT
BMOVSIT2SIXBITC	003662'	205100	624554	02700	        MOVSI T2,(SIXBIT /REL/)
BMOVEMT2LEXTC	003663'	202100	003606*	02800	        MOVEM T2,LEXT
BRELT2MOVET2OPPNC	003664'	200100	003543*	02900	RELT2:  MOVE T2,OPPN
BMOVEMT2LPPNC	003665'	202100	003566*	03000	        MOVEM T2,LPPN
BSKIPNT2ODEVC	003666'	336100	003523*	03100	        SKIPN T2,ODEV   ;CHECK FOR SAVED OUTPUT DEVICE
BMOVET2BINDVC	003667'	200100	003524*	03200	        MOVE T2,BINDV   ;ELSE USE BINARY DEV
BEXCHT2LOKNAMC	003670'	250100	003341*	03300	        EXCH T2,LOKNAM
BMOVEMT2SVLNMSVLNMC	003671'	202100	000000*	03400	        MOVEM T2,SVLNM# ;SAVE IT
BPUSHJPALTDVPC	003672'	260740	003715'	03500	        PUSHJ P,ALTDVP  ;DOO THE LOOKUP OR RETURN
BIFEWRD4C				03600	IFE WRD4,<LOOKUP LOOK,LNAM      ;FOR THIS ONE>
BIFNWRD4PUSHJPUFDLKC	003673'	260740	004137'	03700	IFN WRD4,<PUSHJ P,UFDLK>
BJRSTSKIPNODEVC				03800	        JRST    [SKIPN ODEV     ;WAS IT FROM HERE??
BJRSTNOFILPC				03900	                JRST NOFILP     ;NO, ALL OUT OF PLACES TO LOOK
BSETZMODEVC				04000	                SETZM ODEV      ;FORGET ABOUT IT
BMOVET2SVLNMC				04100	                MOVE T2,SVLNM
BMOVEMT2LOKNAMC				04200	                MOVEM T2,LOKNAM
BJRSTRELT2C	003674'	254000	011353'	04300	                JRST RELT2]     ;TRY AGAIN
BMOVET2SVLNMC	003675'	200100	003671*	04400	        MOVE T2,SVLNM
BEXCHT2LOKNAMC	003676'	250100	003670*	04500	        EXCH T2,LOKNAM
BMOVEMT2ODEVC	003677'	202100	003666*	04600	        MOVEM T2,ODEV   ;WHERE WE FOUND IT
BJRSTSETRELC	003700'	254000	003712'	04700	        JRST SETREL     ;AND AWAY WE GO
BISRELTRNESVPTC	003701'	602600	777777	04800	ISREL:  TRNE SVPT,-1    ;MORE THAN 1?
BJRSTSYNERRC	003702'	254000	001065'	04900	        JRST SYNERR     ;NOT PERMITTED
BMOVET2ONAMC	003703'	200100	003657*	05000	        MOVE T2,ONAM    ;CHECK FOR DIFFERENT NAMES
BCAMET2SVNAMC	003704'	312100	003561*	05100	        CAME T2,SVNAM
BJRSTSYNERRC	003705'	254000	001065'	05200	        JRST SYNERR     ;FLAG AS ERROR
BSKIPET2OEXTC	003706'	332100	003661*	05300	        SKIPE T2,OEXT   ;IF EXTENSION
BCAMNT2SVEXTDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 39-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	003707'	316100	003655*	05400	        CAMN T2,SVEXT   ;AND DIFFERENT
BSKIPAC	003710'	334000	000000	05500	        SKIPA
BJRSTSYNERRC	003711'	254000	001065'	05600	        JRST SYNERR     ;ALSO ERROR
BSETRELTLOFL2RELSWC	003712'	661400	000010	05700	SETREL: TLO FL2,RELSW   ;IT IS A REL FILE
BPOPJPC	003713'	263740	000000	05800	        POPJ P,
BALTDEVSKIPNT2SVDEVT1DRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 40
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	003714'	336101	003472*	00100	ALTDEV:        SKIPN T2,SVDEV(T1)      ;SPECIAL DEVICE
BALTDVPSKIPET2LOKNAMC	003715'	332100	003676*	00200	ALTDVP: SKIPE T2,LOKNAM         ;OR REMEMBERING??
BSKIPAC	003716'	334000	000000	00300	        SKIPA           ;YES
BPOPJPC	003717'	263740	000000	00400	        POPJ P,         ;NO, JUST DO LOOKUP
BCAMET2ODEVC	003720'	312100	003677*	00500	        CAME T2,ODEV
BSETZMODEVC	003721'	402000	003720*	00600	        SETZM ODEV      ;IF NOT THE SAME, GIVE UP
BMOVEMT2LOKNAMC	003722'	202100	003715*	00700	        MOVEM T2,LOKNAM ;SAVE FOR LATER
BMOVEMT2SVDEVT1C	003723'	202101	003714*	00800	        MOVEM T2,SVDEV(T1)      ;AND IN DEVICE FOR OUTPUT
BCAMNT2SIXBITC	003724'	316100	011361'	00900	        CAMN    T2,[SIXBIT /SYS/]
BJRSTDEVCHRT2C				01000	        JRST    [DEVCHR  T2,
BTLNET2DSKBTC				01100	                TLNE    T2,DSKBT        ;IS IT DSK:?
BJRSTALTDV1C				01200	                JRST    ALTDV1          ;YES
BJRSTALTDV2C	003725'	254000	011362'	01300	                JRST    ALTDV2]
BDEVCHRT2C	003726'	047100	000004	01400		DEVCHR T2,	;GET CHARACTERISTICS
BTLNET2DSKBTC	003727'	603100	200000	01500	        TLNE T2,DSKBT   ;A DSK?
BJRSTSETZMLOKNAMC				01600	        JRST    [SETZM LOKNAM   ;NO MORE NEED
BPOPJPC	003730'	254000	011366'	01700	                POPJ P,]        ;USE THIS DEVICE
BALTDV2TROFLNODATC	003731'	660000	000004	01800	ALTDV2: TRO FL,NODAT    ;NO DATES ON OTHER DEVICES
BTLNNT2DTABTC	003732'	607100	000004	01900	        TLNN T2,DTABT   ;A DECTAPE?
BJRSTCPOPJ2C	003733'	254000	003742'	02000	        JRST CPOPJ2     ;SAY WE FOUND IT
BALTDV1OPENLOOKLOKINTC	003734'	050000	003342*	02100	ALTDV1: OPEN LOOK,LOKINT        ;OPEN FOR INPUT
BJRSTDEVNAC	003735'	254000	001122'	02200	        JRST DEVNA      ;NOT THERE
BLOOKUPLOOKLNAMC	003736'	076000	003660*	02300	        LOOKUP LOOK,LNAM        ;SEE IF FILE IS
BSOSPC	003737'	370017	000000	02400	        SOS(P)          ;RETURN TO NOT FOUND
BOPENLOOKDSKLKC	003740'	050000	003347*	02500	        OPEN LOOK,DSKLK ;GET THE DSK BACK
BJRSTDSKNAC	003741'	254000	001053'	02600	        JRST DSKNA      ;I HOPE THIS NEVER HAPPENES
BCPOPJ2MOVEIT2C	003742'	201100	000002	02700	CPOPJ2: MOVEI T2,2      ;ADVANCE RETURN
BADDMT2PC	003743'	272117	000000	02800	        ADDM T2,(P)
BIFNWRD4DPOPJLDBT2POINTLDATC	003744'	135100	011345'	02900	IFN WRD4,<DPOPJ:LDB T2,[POINT 11,LDAT,23]
BIMULIT2C	003745'	221100	000074	03000	        IMULI T2,^D60   ;CONVERT TIME
BDPBT2LDAT.TC	003746'	137100	011015'	03100	        DPB T2,LDAT.TIME>
BPOPJPC	003747'	263740	000000	03200	        POPJ P, ;BACK WE GO
BC
BIFESTANSWC				03400	IFE STANSW,<
BOUTPPNHRRZMT2SAVPPNC	003750'	552100	000000*	03500	OUTPPN: HRRZM T2,SAVPPN ;CONVERT TO SIXBIT FOR OUTPUT
BMOVEIT1C	003751'	201040	000133	03600	        MOVEI T1,"["    ;START OUT
BPUSHJPT3C	003752'	260743	000000	03700	        PUSHJ P,(T3)
BHLRZT1T2C	003753'	554040	000002	03800	        HLRZ T1,T2      ;GET NUMBER
BPUSHJPOUTOCTC	003754'	260740	003763'	03900	        PUSHJ P,OUTOCT
BMOVEIT1C	003755'	201040	000054	04000	        MOVEI T1,","
BPUSHJPT3C	003756'	260743	000000	04100	        PUSHJ P,(T3)
BHRRZT1SAVPPNC	003757'	550040	003750*	04200	        HRRZ T1,SAVPPN
BPUSHJPOUTOCTC	003760'	260740	003763'	04300	        PUSHJ P,OUTOCT
BMOVEIT1C	003761'	201040	000135	04400	        MOVEI T1,"]"
BJRSTT3C	003762'	254003	000000	04500	        JRST (T3)
BC
BOUTOCTIDIVIT1C	003763'	231040	000010	04700	OUTOCT: IDIVI T1,10     ;OCTAL OUTPUT
BHRLMT2PC	003764'	506117	000000	04800	        HRLM T2,(P)
BSKIPET1C	003765'	332000	000001	04900	        SKIPE T1
BPUSHJPOUTOCTC	003766'	260740	003763'	05000	        PUSHJ P,OUTOCT
BHLRZT1PC	003767'	554057	000000	05100	        HLRZ T1,(P)
BADDIT1C	003770'	271040	000060	05200	        ADDI T1,"0"
BJRSTT3C	003771'	254003	000000	05300	        JRST (T3)
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 40-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				05400	>
BC
BNOFILPMOVET2SVNAMT1C	003772'	200101	003704*	05600	NOFILP: MOVE T2,SVNAM(T1)       ;RESET THINGS FOR ERROR MSG
BMOVEMT2NAMEC	003773'	202100	003736*	05700	        MOVEM T2,NAME
BMOVET2SVEXTT1C	003774'	200101	003707*	05800	        MOVE T2,SVEXT(T1)
BHLLZMT2NAMEC	003775'	512100	003663*	05900	        HLLZM T2,NAME+1
BJRSTNOFILC	003776'	254000	001075'	06000	        JRST NOFIL
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 41
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;MAKE LOOKUPS FAST BY FAKING THEM BY READING THE UFD
BC
BIFNWRD4C				00300	IFN WRD4,<
BRDIUFDPUSHPT1C	003777'	261740	000001	00400	RDIUFD:	PUSH P,T1
BPUSHPT3C	004000'	261740	000003	00500		PUSH P,T3
BPUSHPT4C	004001'	261740	000004	00600		PUSH P,T4
BPUSHPT5C	004002'	261740	000005	00700		PUSH P,T5
BSETZMCURUFDC	004003'	402000	000000*	00800		SETZM CURUFD	;SHOW NO CURRENT UFD
BMOVET1NMLSTPC	004004'	200040	002321*	00900		MOVE T1,NMLSTP
BCAMNT2PPNST1C	004005'	316101	002320*	01000		CAMN T2,PPNS(T1);LOOK FOR UFD ALREADY IN CORE
BJRSTRDUFD1C	004006'	254000	004020'	01100		JRST RDUFD1	;FOUND IT
BSOJGET1C	004007'	365040	004005'	01200		SOJGE T1,.-2
BMOVET1NMLSTPC	004010'	200040	004004*	01300		MOVE T1,NMLSTP
BCAILT1NMLSTLC	004011'	301040	000010	01400		CAIL T1,NMLSTL
BJRSTUFDRETC	004012'	254000	004107'	01500		JRST UFDRET
BADDIT1C	004013'	271040	000001	01600		ADDI T1,1
BSETZMNAMES1T1C	004014'	402001	002316*	01700		SETZM NAMES1(T1)
BSETZMNAMES2T1C	004015'	402001	000000*	01800		SETZM NAMES2(T1)
BSETZMUFDST1C	004016'	402001	000000*	01900		SETZM UFDS(T1)
BMOVEMT2PPNST1C	004017'	202101	004005*	02000		MOVEM T2,PPNS(T1)
BRDUFD1SKIPET3UFDST1C	004020'	332141	004016*	02100	RDUFD1:	SKIPE T3,UFDS(T1)	;ALREADY SET UP?
BJRSTMOVEMT3CURUFDC				02200		JRST [	MOVEM T3,CURUFD	;YES, ALL DONE
BJRSTUFDRETC	004021'	254000	011370'	02300			JRST UFDRET]
BMOVEMT1SVINDSVINDC	004022'	202040	002776*	02400		MOVEM T1,SVIND#	;REMEMBER WHICH NMLST ENTRY
BMOVEMT2LKUFDC	004023'	202100	000000*	02500		MOVEM T2,LKUFD	;SET UP FOR UFD LOOKUP
BMOVSIT1C	004024'	205040	654644	02600		MOVSI T1,'UFD'
BMOVEMT1LKUFDC	004025'	202040	000000*	02700	        MOVEM T1,LKUFD+1
BSETZMLKUFDC	004026'	402000	000000*	02800		SETZM LKUFD+2
BMOVET1XWDC	004027'	200040	011024'	02900	        MOVE T1,[XWD 1,1]
BMOVEMT1LKUFDC	004030'	202040	000000*	03000	        MOVEM T1,LKUFD+3
BMOVEIT1C	004031'	201040	000014	03100	        MOVEI T1,14     ;NEED DSK IN MODE 14
BEXCHT1DSKLKC	004032'	250040	003740*	03200	        EXCH T1,DSKLK
BOPENLOOKDSKLKC	004033'	050000	004032*	03300	        OPEN LOOK,DSKLK
BJRSTDSKNAC	004034'	254000	001053'	03400	        JRST DSKNA
BMOVEMT1DSKLKC	004035'	202040	004033*	03500	        MOVEM T1,DSKLK  ;KEEP OLD MODE FOR LATER
BLOOKUPLOOKLKUFDC	004036'	076000	004023*	03600	        LOOKUP LOOK,LKUFD
BJRSTENDUFDC	004037'	254000	004102'	03700	        JRST ENDUFD     ;RESET CKPPN AND GET OUT
BPUSHJPCHKRMC	004040'	260740	001450'	03800	        PUSHJ P,CHKRM
BMOVET1JOBFFC	004041'	200040	002303*	03900	        MOVE T1,JOBFF
BMOVEMT1SUJFFSUJFFC	004042'	202040	000000*	04000	        MOVEM T1,SUJFF# ;SAVE FOR LATER
BINBUFLOOKC	004043'	064000	000002	04100	        INBUF LOOK,2    ;GET BUFFERS
BPUSHJPCHKRMC	004044'	260740	001450'	04200		PUSHJ P,CHKRM
BMOVET1JOBFFC	004045'	200040	004041*	04300		MOVE T1,JOBFF
BMOVET2SVINDC	004046'	200100	004022*	04400		MOVE T2,SVIND
BCAMLET2NMLSTPC	004047'	313100	004010*	04500		CAMLE T2,NMLSTP
BAOSNMLSTPC	004050'	350000	004047*	04600		AOS NMLSTP
BMOVEMT1UFDST2C	004051'	202042	004020*	04700		MOVEM T1,UFDS(T2)
BMOVEMT1CURUFDC	004052'	202040	004003*	04800		MOVEM T1,CURUFD
BMOVEIT2T1C	004053'	201101	000001	04900		MOVEI T2,1(T1)
BHRLIT2T1C	004054'	505101	000000	05000		HRLI T2,(T1)
BSETZMT1C	004055'	402001	000000	05100		SETZM (T1)
BMOVEIT1HASHT1C	004056'	201041	000045	05200		MOVEI T1,HASH(T1)
BBLTT2T1C	004057'	251101	777777	05300		BLT T2,-1(T1)
BHRLIT1HASHDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 41-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	004060'	505040	777665	05400		HRLI T1,-<406-HASH>/3
BNXTUFDPUSHJPUFDENTC	004061'	260740	004114'	05500	NXTUFD: PUSHJ P,UFDENT  ;GET AN ENTRY T2=NAME,T3=DATE
BJRSTENDUFDC	004062'	254000	004102'	05600	        JRST ENDUFD     ;T4=EXT, SKIP RETURN IF NOT EOF
BJUMPET2NXTUFDC	004063'	322100	004061'	05700	        JUMPE T2,NXTUFD ;ZERO NAME IS NULL ENTRY
BMOVEMT2T1C	004064'	202101	000000	05800	        MOVEM T2,(T1)   ;SAVE NAME
BMOVEMT3T1C	004065'	202141	000002	05900	        MOVEM T3,2(T1)  ;AND DATE
BIDIVIT2HASHC	004066'	231100	000045	06000	        IDIVI T2,HASH   ;HASH IT
BMOVMT2T3C	004067'	214100	000003	06100	        MOVM T2,T3      ;(TO MAKE IT POSITIVE)
BADDT2CURUFDC	004070'	270100	004052*	06200		ADD T2,CURUFD
BHRRT4T2C	004071'	540202	000000	06300	        HRR T4,(T2)       ;LINK IT IN
BMOVEMT4T1C	004072'	202201	000001	06400	        MOVEM T4,1(T1)  ;AND SAVE EXT AND LINK
BHRRZMT1T2C	004073'	552042	000000	06500	        HRRZM T1,(T2)     ;SAVE NEW POINTER
BADDIT1C	004074'	271040	000002	06600	        ADDI T1,2       ;USED 3 WORDS
BAOBJNT1NXTUFDC	004075'	253040	004061'	06700	        AOBJN T1,NXTUFD ;AND ONE ENTRY, CHECK FOR OVERFLOW
BPUSHJPCHKRMC	004076'	260740	001450'	06800		PUSHJ P,CHKRM
BMOVET1JOBFFC	004077'	200040	004045*	06900		MOVE T1,JOBFF
BHRLIT1C	004100'	505040	777651	07000		HRLI T1,-127
BJRSTNXTUFDC	004101'	254000	004061'	07100		JRST NXTUFD
BENDUFDRELEASLOOKC	004102'	071000	000000	07200	ENDUFD: RELEASE LOOK,0
BOPENLOOKDSKLKC	004103'	050000	004035*	07300	        OPEN LOOK,DSKLK
BJRSTDSKNAC	004104'	254000	001053'	07400	        JRST DSKNA      ;I HOPE NOT
BMOVET1SUJFFC	004105'	200040	004042*	07500	        MOVE T1,SUJFF
BMOVEMT1FREBUFC	004106'	202040	001457*	07600	        MOVEM T1,FREBUF ;SET AS NO LONGER IN USE
BUFDRETPOPPT5C	004107'	262740	000005	07700	UFDRET:	POP P,T5
BPOPPT4C	004110'	262740	000004	07800		POP P,T4
BPOPPT3C	004111'	262740	000003	07900		POP P,T3
BPOPPT1C	004112'	262740	000001	08000		POP P,T1
BPOPJPC	004113'	263740	000000	08100	        POPJ P,
BC
BUFDENTJSPT5UFDWDC	004114'	265240	004131'	08300	UFDENT: JSP T5,UFDWD    ;SO IT CAN POPJ
BILDBT2LOOKBFC	004115'	134100	001376*	08400	        ILDB T2,LOOKBF+1        ;GET THE WORD
BJUMPET2UFDENTC	004116'	322100	004114'	08500	        JUMPE T2,UFDENT         ;IGNORE 0 WORDS
BJSPT5UFDWDC	004117'	265240	004131'	08600	        JSP T5,UFDWD
BILDBT4LOOKBFC	004120'	134200	004115*	08700	        ILDB T4,LOOKBF+1        ;EXT
BJSPT5UFDWDC	004121'	265240	004131'	08800	        JSP T5,UFDWD
BILDBT3LOOKBFC	004122'	134140	004120*	08900	        ILDB T3,LOOKBF+1        ;DATE
BJSPT5UFDWDC	004123'	265240	004131'	09000	        JSP T5,UFDWD    ;THIS IS SIZE WHICH WE DON'T WANT
BIBPLOOKBFC	004124'	133000	004122*	09100	        IBP LOOKBF+1    ;SO JUST SKIP IT
BJSPT5UFDWDC	004125'	265240	004131'	09200	        JSP T5,UFDWD    ;SKIP ANOTHER WORD
BIBPLOOKBFC	004126'	133000	004124*	09300	        IBP LOOKBF+1
BAOSPC	004127'	350017	000000	09400	        AOS (P)         ;SKIP RETURN IF ALL IS WELL
BPOPJPC	004130'	263740	000000	09500	        POPJ P,
BC
BUFDWDSOSGLOOKBFC	004131'	377000	001374*	09700	UFDWD:  SOSG LOOKBF+2
BINLOOKC	004132'	056000	000000	09800	        IN LOOK,0       ;SKIPS ON ERROR
BJRSTT5C	004133'	254005	000000	09900	        JRST (T5)       ;SO ALL OK
BSTATOLOOKC	004134'	061000	020000	10000	        STATO LOOK,20000        ;CHECK FOR EOF
BJRSTREADERC	004135'	254000	001063'	10100	        JRST READER     ;LOSE BIG
BPOPJPC	004136'	263740	000000	10200	        POPJ P,         ;REURN TO CALLER
BUFDLKSKIPNT2LPPNDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 42
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	004137'	336100	003665*	00100	UFDLK: SKIPN T2,LPPN   ;GET SPECIFIED PPN
BMOVET2USRPPNC	004140'	200100	002125*	00200	        MOVE T2,USRPPN  ;OR THIS USERS
BPUSHJPRDIUFDC	004141'	260740	003777'	00300		PUSHJ P,RDIUFD
BSKIPNCURUFDC	004142'	336000	004070*	00400		SKIPN CURUFD
BJRSTLOOKUPLOOKLNAMC				00500	        JRST    [LOOKUP LOOK,LNAM
BPOPJPC				00600	                POPJ P, ;LOSE
BAOSPC				00700	                AOS (P) ;SKIP RETURN
BJRSTDPOPJC	004143'	254000	011372'	00800	                JRST DPOPJ]     ;AND SET DATE
BPUSHPT3C	004144'	261740	000003	00900	        PUSH P,T3       ;NEED EXTRA AC
BHLLZSLEXTC	004145'	513000	003775*	01000	        HLLZS LEXT      ;JUST IN CASE IT NEEDS IT
BMOVET2LNAMC	004146'	200100	003773*	01100	        MOVE T2,LNAM    ;GET NAME
BIDIVIT2HASHC	004147'	231100	000045	01200	        IDIVI T2,HASH   ;AND HASH
BMOVMT2T3C	004150'	214100	000003	01300	        MOVM T2,T3
BADDT2CURUFDC	004151'	270100	004142*	01400		ADD T2,CURUFD
BHRRZT2T2C	004152'	550102	000000	01500	        HRRZ T2,(T2)
BJUMPET2T3POPJC	004153'	322100	004165'	01600	        JUMPE T2,T3POPJ ;NOT IN DIRECTORY
BMOVET3LNAMC	004154'	200140	004146*	01700	        MOVE T3,LNAM
BNMCMCAMET3T2C	004155'	312142	000000	01800	NMCM:   CAME T3,(T2)    ;THIS ONE?
BJRSTNXTNMC	004156'	254000	004170'	01900	        JRST NXTNM
BHLLZT3T2C	004157'	510142	000001	02000	        HLLZ T3,1(T2)   ;GET EXT
BCAMET3LEXTC	004160'	312140	004145*	02100	        CAME T3,LEXT    ;AND CHECK
BJRSTNXTRNMC	004161'	254000	004167'	02200	        JRST NXTRNM     ;GET NEXT AND RESTORE NAME
BMOVET3T2C	004162'	200142	000002	02300	        MOVE T3,2(T2)   ;NOW THE DATE AND TIME
BMOVEMT3LDATC	004163'	202140	003654*	02400	        MOVEM T3,LDAT
BAOSPC	004164'	350017	777777	02500	        AOS -1(P)       ;SKIP RETURN
BT3POPJPOPPT3C	004165'	262740	000003	02600	T3POPJ: POP P,T3
BPOPJPC	004166'	263740	000000	02700	        POPJ P,
BC
BNXTRNMMOVET3LNAMC	004167'	200140	004154*	02900	NXTRNM: MOVE T3,LNAM    ;THIS GOT WIPED OUT
BNXTNMHRRZT2T2C	004170'	550102	000001	03000	NXTNM:  HRRZ T2,1(T2)   ;LINK
BJUMPET2T3POPJC	004171'	322100	004165'	03100	        JUMPE T2,T3POPJ ;GIVE UP AND GO HOME
BJRSTNMCMC	004172'	254000	004155'	03200	        JRST NMCM       ;GO LOOK SOME MORE
BC
BARRAYLKUFDC				03400	ARRAY LKUFD[4]
BINTEGECURUFDC				03500	INTEGER CURUFD
BC				03600	>
BDEFINEDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 43
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	DEFINE X (A,B,C,D,E)
BXC				00200	<B'SW>
BC
BISPTABPROCESC	004173'			00400	ISPTAB: PROCESS^
BXF4SWC	004173'	000000	400000		X FORTRAN,F4,F40^F4SW^
BXMACSWC	004174'	000000	200000		X MACRO,MAC,MACRO^MACSW^
BXFTFSWC	004175'	000000	100000		X FTFORTRAN,FTF,FTF40^FTFSW^
BXSIMSWC	004176'	000000	040000		X SIMPL,SIM,SIMPL^SIMSW^
BXFALSWC	004177'	000000	020000		X FAIL,FAL,FAIL^FALSW^
BXCBLSWC	004200'	000000	010000		X COBOL,CBL,COBOL^CBLSW^
BXBLISWC	004201'	000000	004000		X BLIMP,BLI,BLISS^BLISW^
BXVASSWC	004202'	000000	002000		X VAS,VAS,VAS^VASSW^
BFORXXXC			000001	00500	        FOR (1,NSDNM,<CAT(NSDS,\XXX)>)^XXX==1
BREPEATNSDNMCATXXXNSDS1C	004203'	000000	001000		CAT(NSDS,\XXX)^NSDS1^
BIFBXXXXXXIFNBCATXXXNSDS2C	004204'	000000	000400		CAT(NSDS,\XXX)^NSDS2^
BIFBXXXXXXIFNBCATXXXNSDS3C	004205'	000000	000200		CAT(NSDS,\XXX)^NSDS3^
BIFBXXXXXXIFNBC
BOUTSIXMOVEIT1C	004206'	201040	000000	00700	OUTSIX: MOVEI T1,0
BLSHCT1C	004207'	246040	000006	00800	        LSHC T1,6
BADDIT1C	004210'	271040	000040	00900	        ADDI T1,40
BPUSHJPT3C	004211'	260743	000000	01000	        PUSHJ P,(T3)
BJUMPNT2OUTSIXC	004212'	326100	004206'	01100	        JUMPN T2,OUTSIX
BCPOPJPOPJPC	004213'	263740	000000	01200	CPOPJ:  POPJ P,
BC
BIFNSTANSWC				01400	IFN STANSW,<
BC				01500	OUTPPN: MOVEM T1,SAVPPN ;SAVE IT AWAY
BC				01600	        ANDCMI T2,-1
BC				01700	        MOVEI T1,"["
BC				01800	        PUSHJ P,(T3)
BC				01900	        PUSHJ P,OUTSIX  ;PRINT IT
BC				02000	        MOVEI T1,","    ;AND A COMMA
BC				02100	        PUSHJ P,(T3)
BC				02200	        HRLZ T2,SAVPPN
BC				02300	        PUSHJ P,OUTSIX
BC				02400	        MOVEI T1,"]"
BC				02500	        JRST (T3)
BC				02600	>
BC
BOUTSWMOVEMT2SVSWPC	004214'	202100	000000*	02800	OUTSW:  MOVEM T2,SVSWP  ;SAVE THE POINTER
BILDBT1T2C	004215'	134040	000002	02900	        ILDB T1,T2      ;PICK UP THE FIRST CHR
BJUMPET1CPOPJC	004216'	322040	004213'	03000	        JUMPE T1,CPOPJ  ;AND CHECK FOR NULL AS A PRECAUTION
BMOVEIT1C	004217'	201040	000050	03100	        MOVEI T1,"("
BPUSHJPT3C	004220'	260743	000000	03200	        PUSHJ P,(T3)    ;SWITCHES ARE IN () TO PROCESSOR
BOUTSW1ILDBT1SVSWPC	004221'	134040	004214*	03300	OUTSW1: ILDB T1,SVSWP
BJUMPET1MOVEIT1C				03400	        JUMPE T1,[MOVEI T1,")"
BJRSTT3C	004222'	322040	011376'	03500	                JRST    (T3)]
BPUSHJPT3C	004223'	260743	000000	03600	        PUSHJ P,(T3)
BJRSTOUTSW1C	004224'	254000	004221'	03700	        JRST OUTSW1     ;A NULL WILL MARK THE END
BC
BOUTDVPUSHJPOUTSIXC	004225'	260740	004206'	03900	OUTDV:  PUSHJ P,OUTSIX  ;DEVICE IS IN T2
BMOVEIT1C	004226'	201040	000072	04000	        MOVEI T1,":"
BJRSTT3C	004227'	254003	000000	04100	        JRST (T3)
BENTCNMMOVET1CORTOPDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 44
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	004230'	200040	002310*	00100	ENTCNM:        MOVE T1,CORTOP  ;CHECK TO SEE IF NAME ALREADY THERE
BENTC1CAMNT1CORT1C	004231'	316040	002311*	00200	ENTC1:  CAMN T1,CORT1
BJRSTENTC2C	004232'	254000	004236'	00300	        JRST ENTC2
BCAMNT2T1C	004233'	316101	000001	00400	        CAMN T2,1(T1)
BPOPJPC	004234'	263740	000000	00500	        POPJ P, ;NAME THERE, EXIT
BAOJAT1ENTC1C	004235'	344040	004231'	00600	        AOJA T1,ENTC1   ;CHECK ANOTHERE
BENTC2MOVEMT2CORTOPC	004236'	202120	004230*	00700	ENTC2:  MOVEM T2,@CORTOP        ;SAVE IT
BAOSPC	004237'	350017	000000	00800	        AOS (P)         ;SKIP RETURN IF ENTERED
BSOST1CORTOPC	004240'	370040	004236*	00900	        SOS T1,CORTOP
BCAMGT1SVJFFC	004241'	317040	002304*	01000	        CAMG T1,SVJFF   ;CHECK TO SEE IF CORE EXCEEDED
BJRSTXPANDC	004242'	254000	001470'	01100	        JRST XPAND
BPOPJPC	004243'	263740	000000	01200	        POPJ P,
BC
BENTCRFMOVET2ONAMC	004244'	200100	003703*	01400	ENTCRF: MOVE T2,ONAM
BPUSHJPENTCNMC	004245'	260740	004230'	01500	        PUSHJ P,ENTCNM  ;SEE IF NAME ALREADY THERE
BPOPJPC	004246'	263740	000000	01600	        POPJ P, ;YES, DONE
BMOVEIT1C	004247'	201040	000137	01700	        MOVEI T1,"_"
BPUSHJPOUTCRFC	004250'	260740	010177'	01800	        PUSHJ P,OUTCRF
BMOVEIT3OUTCRFC	004251'	201140	010177'	01900	        MOVEI T3,OUTCRF
BSKIPET2LSTDVC	004252'	332100	003433*	02000	        SKIPE T2,LSTDV
BPUSHJPOUTDVC	004253'	260740	004225'	02100	        PUSHJ P,OUTDV   ;PUT OUT DEVICE NAME
BMOVET2ONAMC	004254'	200100	004244*	02200	        MOVE T2,ONAM
BPUSHJPOUTSIXC	004255'	260740	004206'	02300	        PUSHJ P,OUTSIX
BMOVSIT2SIXBITC	004256'	205100	175400	02400	        MOVSI T2,(SIXBIT !/L!)  ;NO PUT OUT /L FOR A LIST FILE
BTLNNFL3CRSWC	004257'	607440	000002	02500	        TLNN FL3,CRSW   ;IS THIS REALLY CREF??
BPUSHJPOUTSIXC	004260'	260740	004206'	02600	        PUSHJ P,OUTSIX
BMOVET4XWDCSBLCSBTC	004261'	200200	011400'	02700	        MOVE T4,[XWD -CSBL,CSBT]        ;PUT OUT EXTRA SWS
BPUSHJPSWBITSC	004262'	260740	003227'	02800	        PUSHJ P,SWBITS
BTRNNFL3T2C	004263'	606442	000000	02900	        TRNN FL3,(T2)
BJRSTOUCRLFC	004264'	254000	010063'	03000	        JRST OUCRLF
BC
BFINCRFMOVSIIOPNTC	004265'	205300	777776	03200	FINCRF: MOVSI IOPNT,-2  ;PERMIT ONLY THIS ONE LEVEL
BTROFLINCRFC	004266'	660000	002000	03300	        TRO FL,INCRF    ;SAY WE ARE FINISHING
BMOVEMPSVPDLC	004267'	202740	000000*	03400	        MOVEM P,SVPDL   ;SAVE THE PDL FOR LATER
BMOVET1POINTCRFRDRC	004270'	200040	011401'	03500	        MOVE T1,[POINT 7,CRFRDR]
BMOVEMT1DINPTC	004271'	202040	002367*	03600	        MOVEM T1,DINPT
BMOVEIT3OUTCRFC	004272'	201140	010177'	03700	        MOVEI T3,OUTCRF
BFINC1PUSHJPSCANC	004273'	260740	000276'	03800	FINC1:  PUSHJ P,SCAN    ;GET SOMETHING
BTRNNFLIDFC	004274'	606000	000020	03900	        TRNN FL,IDF     ;IGNORE ALL BUT IDENTIFIERS
BJRSTFINC1C	004275'	254000	004273'	04000	        JRST FINC1
BMOVEISVPTC	004276'	201600	000000	04100	        MOVEI SVPT,0    ;SET UP IN CASE IT IS SOMETHING ELSE
BPUSHJPGETNAMC	004277'	260740	000116'	04200	        PUSHJ P,GETNAM  ;GET A NAME
BMOVET2SVNAMC	004300'	200100	003772*	04300	        MOVE T2,SVNAM   ;GET IT
BPUSHJPENTCNMC	004301'	260740	004230'	04400	        PUSHJ P,ENTCNM  ;AND SEE IF IT DUPLICATES
BJRSTFINC2AC	004302'	254000	004324'	04500	        JRST FINC2A     ;WAIT FOR TERM
BMOVEIT1C	004303'	201040	000137	04600	        MOVEI T1,"_"
BPUSHJPOUTCRFC	004304'	260740	010177'	04700	        PUSHJ P,OUTCRF
BSKIPNT2SVDEVC	004305'	336100	003723*	04800	        SKIPN T2,SVDEV  ;IF A DEVICE IS THERE (WHEN LSTDEV IS IN)
BJRSTNOCRDVC	004306'	254000	004312'	04900	        JRST NOCRDV
BPUSHJPOUTSIXC	004307'	260740	004206'	05000	        PUSHJ P,OUTSIX
BMOVEIT1C	004310'	201040	000072	05100	        MOVEI T1,":"
BPUSHJPOUTCRFC	004311'	260740	010177'	05200	        PUSHJ P,OUTCRF
BNOCRDVMOVET2SVNAMC	004312'	200100	004300*	05300	NOCRDV: MOVE T2,SVNAM
BPUSHJPOUTSIXDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 44-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	004313'	260740	004206'	05400	        PUSHJ P,OUTSIX
BSKIPAC	004314'	334000	000000	05500	        SKIPA   ;C IS ALREADY LOADED FROM SCAN
BFINC4PUSHJPGETCHC	004315'	260740	000342'	05600	FINC4:  PUSHJ P,GETCH
BTLNECSTERMFC	004316'	603640	200000	05700	        TLNE CS,TERMF   ;IS IT ERMINATORE?
BJRSTFINC5C	004317'	254000	004333'	05800	        JRST FINC5      ;TRY NEXT
BMOVET1CC	004320'	200040	000016	05900	        MOVE T1,C
BPUSHJPOUTCRFC	004321'	260740	010177'	06000	        PUSHJ P,OUTCRF
BJRSTFINC4C	004322'	254000	004315'	06100	        JRST FINC4
BC
BFINC2PUSHJPSCANC	004323'	260740	000276'	06300	FINC2:  PUSHJ P,SCAN
BFINC2ATLNNCSTERMFC	004324'	607640	200000	06400	FINC2A: TLNN CS,TERMF
BJRSTFINC2C	004325'	254000	004323'	06500	        JRST FINC2
BJRSTFINC1C	004326'	254000	004273'	06600	        JRST FINC1
BDNCRFC	004327'			06700	DNCRF:
BIFETEMPC				06800	IFE TEMP,<      RELEASE CHNCRF,0        ;LET GO OF THE CHANNEL>
BIFNTEMPPUSHJPCHKCRFC	004327'	260740	010203'	06900	IFN TEMP,<      PUSHJ P,CHKCRF  ;CHECK FOR TMPCOR UUO BEING DONE>
BMOVEPSVPDLC	004330'	200740	004267*	07000	        MOVE P,SVPDL    ;GET THE ENTERING PDL BACK
BTRZFLINCRFC	004331'	620000	002000	07100	        TRZ FL,INCRF    ;NO LONGER THERE
BPOPJPC	004332'	263740	000000	07200	        POPJ P,
BC
BFINC5PUSHJPOUCRLFC	004333'	260740	010063'	07400	FINC5:  PUSHJ P,OUCRLF
BJRSTFINC1C	004334'	254000	004273'	07500	        JRST FINC1      ;FINISH UP LINE
BC
BCSBTSBTSSIXBITCNSBTC	004335'	175300	000400	07700	CSBT:   SBTS K,CNSBT^<SIXBIT !/K!>+CNSBT^
BSBTSSIXBITCNMBTC	004336'	175500	001000	07800	        SBTS M,CNMBT^<SIXBIT !/M!>+CNMBT^
BSBTSSIXBITCOPBTC	004337'	175700	002000	07900	        SBTS O,COPBT^<SIXBIT !/O!>+COPBT^
BSBTSSIXBITCNLBTC	004340'	176300	004000	08000	        SBTS S,CNLBT^<SIXBIT !/S!>+CNLBT^
BSBTSSIXBITCCMBTC	004341'	174300	010000	08100	        SBTS C,CCMBT^<SIXBIT !/C!>+CCMBT^
BSBTSSIXBITCMONBTC	004342'	176100	020000	08200	        SBTS Q,CMONBT^<SIXBIT !/Q!>+CMONBT^
BCSBTCSBLC			000006	08300	CSBL==.-CSBT
BDEFINEDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 45
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	       DEFINE X (A,B,C,D,E)
BXC				00200	<OUT'B>
BPRCTABPROCESC	004343'			00300	PRCTAB: PROCESS^
BXOUTF4C	004343'	000000	010067'		X FORTRAN,F4,F40^OUTF4^
BXOUTMACC	004344'	000000	010075'		X MACRO,MAC,MACRO^OUTMAC^
BXOUTFTFC	004345'	000000	010103'		X FTFORTRAN,FTF,FTF40^OUTFTF^
BXOUTSIMC	004346'	000000	010111'		X SIMPL,SIM,SIMPL^OUTSIM^
BXOUTFALC	004347'	000000	010117'		X FAIL,FAL,FAIL^OUTFAL^
BXOUTCBLC	004350'	000000	010125'		X COBOL,CBL,COBOL^OUTCBL^
BXOUTBLIC	004351'	000000	010133'		X BLIMP,BLI,BLISS^OUTBLI^
BXOUTVASC	004352'	000000	010141'		X VAS,VAS,VAS^OUTVAS^
BOUTLODC	004353'	000000	010147'	00400	        OUTLOD
BFORXXXC			000001	00500	        FOR (1,NSDNM,<CAT (NSDO,\XXX)>)^XXX==1
BREPEATNSDNMCATXXXNSDO1C	004354'	000000	010670'		CAT (NSDO,\XXX)^NSDO1^
BIFBXXXXXXIFNBCATXXXNSDO2C	004355'	000000	010673'		CAT (NSDO,\XXX)^NSDO2^
BIFBXXXXXXIFNBCATXXXNSDO3C	004356'	000000	010676'		CAT (NSDO,\XXX)^NSDO3^
BIFBXXXXXXIFNBC
BIFNSPRCC				00700	IFN SPRC,<
BC				00800	        DEFINE X (A,B,C,D,E)<
BC				00900	IFNB <E>,<SIXBIT /E/>>
BC				01000	INTEXT: PROCESS
BC				01100	
BC				01200	        DEFINE X (A,B,C,D,E)
BC				01300	        <D'SW>
BC				01400	NXPC:   PROCESS>
BC
BSWC			000000	01600	SW==0
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 46
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;HANDLE THE DIFFERENCES COMMAND - DO GOOD STUFF AND CALL FILCOM
BC
BDIFFERMOVEIT4ASCIZC	004357'	201200	011402'	00300	DIFFER:	MOVEI T4,[ASCIZ/OUTPUT TO: /]
BPUSHJPPROMPTC	004360'	260740	005544'	00400		PUSHJ P,PROMPT
BPUSHJPDIFINMC	004361'	260740	004427'	00500		PUSHJ P,DIFINM	;GET FIRST NAME - MIGHT BE INPUT OR OUTPUT
BCAINCC	004362'	306700	000054	00600		CAIN C,","
BJRSTDIFOKAC	004363'	254000	004400'	00700		JRST DIFOKA	;COMMA SAYS IT WAS INPUT NAME
BCAIECC	004364'	302700	000137	00800		CAIE C,"_"
BCAINCC	004365'	306700	000075	00900		CAIN C,"="
BJRSTDIFOKOC	004366'	254000	004371'	01000		JRST DIFOKO	;CHECK FOR VALID OUTPUT NAME TERMINATORS
BTLNNCSTERMFC	004367'	607640	200000	01100		TLNN CS,TERMF
BJRSTSYNERRC	004370'	254000	001065'	01200		JRST SYNERR
BDIFOKOPUSHJPCKTTYC	004371'	260740	005417'	01300	DIFOKO:	PUSHJ P,CKTTY	;ALLOW TEL FOR TTY: IN OUTPUT NAME
BPUSHJPDIFONMC	004372'	260740	004460'	01400		PUSHJ P,DIFONM	;SEND OUTPUT NAME TO FILCOM
BMOVEIT4ASCIZC	004373'	201200	011405'	01500		MOVEI T4,[ASCIZ/INPUT FILE 1: /]
BPUSHJPPROMPTC	004374'	260740	005544'	01600		PUSHJ P,PROMPT
BTRZNFLPRMPTFC	004375'	626000	000100	01700		TRZN FL,PRMPTF
BPUSHJPSCANC	004376'	260740	000276'	01800		PUSHJ P,SCAN
BPUSHJPDIFINMC	004377'	260740	004427'	01900		PUSHJ P,DIFINM	;GET INPUT FILE 1
BDIFOKAMOVEIT1C	004400'	201040	000137	02000	DIFOKA:	MOVEI T1,"_"
BPUSHJPOUTFCMC	004401'	260740	010213'	02100		PUSHJ P,OUTFCM	;DELIMIT OUTPUT NAME
BPUSHJPDIFONMC	004402'	260740	004460'	02200		PUSHJ P,DIFONM	;SEND FILE NAME TO FILCOM
BMOVEIT1C	004403'	201040	000054	02300		MOVEI T1,","
BPUSHJPOUTFCMC	004404'	260740	010213'	02400		PUSHJ P,OUTFCM
BCAIECC	004405'	302700	000054	02500		CAIE C,","
BTLNECSTERMFC	004406'	603640	200000	02600		TLNE CS,TERMF	;CHECK FOR VALID DELIMITERS
BSKIPAT4ASCIZC	004407'	334200	011413'	02700		SKIPA T4,[[ASCIZ/INPUT FILE 2: /]]
BJRSTSYNERRC	004410'	254000	001065'	02800		JRST SYNERR
BPUSHJPPROMPTC	004411'	260740	005544'	02900		PUSHJ P,PROMPT
BTRZNFLPRMPTFC	004412'	626000	000100	03000		TRZN FL,PRMPTF
BPUSHJPSCANC	004413'	260740	000276'	03100		PUSHJ P,SCAN
BPUSHJPDIFINMC	004414'	260740	004427'	03200		PUSHJ P,DIFINM	;GET SECOND INPUT NAME
BPUSHJPDIFONMC	004415'	260740	004460'	03300		PUSHJ P,DIFONM
BPUSHJPSCANC	004416'	260740	000276'	03400		PUSHJ P,SCAN
BTLNNCSTERMFC	004417'	607640	200000	03500		TLNN CS,TERMF
BJRSTSYNERRC	004420'	254000	001065'	03600		JRST SYNERR
BMOVEIT3OUTFCMC	004421'	201140	010213'	03700		MOVEI T3,OUTFCM
BPUSHJPOUCRLFC	004422'	260740	010063'	03800		PUSHJ P,OUCRLF
BPUSHJPCHKFCMC	004423'	260740	010217'	03900		PUSHJ P,CHKFCM
BMOVET1SIXBITC	004424'	200040	011414'	04000		MOVE T1,[SIXBIT/FILCOM/]
BMOVEMT1PCNAMC	004425'	202040	001406*	04100		MOVEM T1,PCNAM
BJRSTDONE1C	004426'	254000	001401'	04200		JRST DONE1
BC
BDIFINMPUSHJPSCANC	004427'	260740	000276'	04400	DIFINM:	PUSHJ P,SCAN
BCAINCC	004430'	306700	000057	04500		CAIN C,"/"	;CHECK FOR SWITCH BEFORE NAME
BPUSHJPDIFSW1C	004431'	260740	004440'	04600		PUSHJ P,DIFSW1	;YES, PROCESS IT
BPUSHJPGETNAMC	004432'	260740	000116'	04700		PUSHJ P,GETNAM	;GET FILE NAME
BPUSHJPSCANSC	004433'	260740	000256'	04800		PUSHJ P,SCANS	;PEEK AT NEXT CHARACTER
BCAINCC	004434'	306700	000057	04900		CAIN C,"/"	;CHECK FOR SWITCH AFTER NAME
BPUSHJPDIFSWC	004435'	260740	004437'	05000		PUSHJ P,DIFSW	;YES, PROCESS IT
BPOPJPC	004436'	263740	000000	05100		POPJ P,
BC
BDIFSWPUSHJPSCANC	004437'	260740	000276'	05300	DIFSW:	PUSHJ P,SCAN	;THIS ENTRY SKIPS OVER THE /
BDIFSW1HRREIT1DRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 46-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	004440'	571040	777775	05400	DIFSW1:	HRREI T1,-3	;THIS ENTRY ASSUMES / HAS BEEN SCANNED
BADDMT1PC	004441'	272057	000000	05500		ADDM T1,(P)	;RETURN TO CALLING LOC-2
BPUSHJPSCANC	004442'	260740	000276'	05600		PUSHJ P,SCAN	;SCAN SWITCH NAME
BTRNNFLIDFC	004443'	606000	000020	05700		TRNN FL,IDF
BJRSTSYNERRC	004444'	254000	001065'	05800		JRST SYNERR
BMOVSIT1C	004445'	205040	626556	05900		MOVSI T1,'RUN'
BCAMNT1ACCUMC	004446'	316040	003067*	06000		CAMN T1,ACCUM
BJRSTSETRNNC	004447'	254000	000054'	06100		JRST SETRNN	;HANDLE RUN SWITCH SPECIALLY TO AVOID GARBAGE
BMOVEIT1C	004450'	201040	000057	06200		MOVEI T1,"/"
BPUSHJPOUTFCMC	004451'	260740	010213'	06300		PUSHJ P,OUTFCM	;BEGINNING OF SWITCH FOR FILCOM
BMOVET1DIFLENDIFTABC	004452'	200040	011415'	06400		MOVE T1,[-DIFLEN,,DIFTAB]
BPUSHJPSWSCANC	004453'	260740	002722'	06500		PUSHJ P,SWSCAN
BJRSTUNRECSC	004454'	254000	001071'	06600		JRST UNRECS
BJFCLC	004455'	255000	000000	06700		JFCL
BXCTDIFT2DIFTABT1C	004456'	256001	000011	06800		XCT DIFT2-DIFTAB(T1)	;DO THE SWITCH
BJRSTOUTFCMC	004457'	254000	010213'	06900		JRST OUTFCM	;SEND SWITCH CHARACTER AND RETURN
BC
BDIFONMMOVEIT3OUTFCMC	004460'	201140	010213'	07100	DIFONM:	MOVEI T3,OUTFCM
BMOVET4SVPTC	004461'	200200	000014	07200		MOVE T4,SVPT
BJRSTCMNOC	004462'	254000	003472'	07300		JRST CMNO
BC
BDIFLOWSKIPAT1C	004463'	334040	011416'	07500	DIFLOW:	SKIPA T1,["L"]
BDIFUPMOVEIT1C	004464'	201040	000125	07600	DIFUP:	MOVEI T1,"U"
BPUSHPT1C	004465'	261740	000001	07700		PUSH P,T1
BPUSHJPSTARGSC	004466'	260740	010727'	07800		PUSHJ P,STARGS
BTRNNFLNUMFSC	004467'	606000	000100	07900		TRNN FL,NUMFS	;ARGUMENT MUST BE NUMERIC
BJRSTSYNERRC	004470'	254000	001065'	08000		JRST SYNERR
BMOVET1NUMACC	004471'	200040	000334*	08100		MOVE T1,NUMAC
BMOVEIT3OUTFCMC	004472'	201140	010213'	08200		MOVEI T3,OUTFCM
BPUSHJPOUTNUMC	004473'	260740	007657'	08300		PUSHJ P,OUTNUM	;SEND NUMBER TO FILCOM
BTRNNFL3PARFLGC	004474'	606440	000004	08400		TRNN FL3,PARFLG
BJRSTDIFLU1C	004475'	254000	004501'	08500		JRST DIFLU1	;IF NOT (ARG) THEN ALMOST DONE
BPUSHJPSCANC	004476'	260740	000276'	08600		PUSHJ P,SCAN	;IF (ARG) THEN SCAN )
BCAIECC	004477'	302700	000051	08700		CAIE C,")"
BJRSTSYNERRC	004500'	254000	001065'	08800		JRST SYNERR	;MUST BE )
BDIFLU1POPPT1C	004501'	262740	000001	08900	DIFLU1:	POP P,T1	;GET BACK SWITCH CHARACTER
BPOPJPC	004502'	263740	000000	09000		POPJ P,	;RETURN
BC
BDEFINETABLEC				09200	DEFINE TABLE<
BC				09300	SWITCH ASCII,<MOVEI T1,"A">
BC				09400	SWITCH BLANK,<MOVEI T1,"B">
BC				09500	SWITCH COMMENT,<MOVEI T1,"C">
BC				09600	SWITCH SPACING,<MOVEI T1,"S">
BC				09700	SWITCH WORD,<MOVEI T1,"W">
BC				09800	SWITCH EXPAND,<MOVEI T1,"X">
BC				09900	SWITCH SMALL,<MOVEI T1,"N">
BC				10000	SWITCH LOWER,<PUSHJ P,DIFLOW>
BC				10100	SWITCH UPPER,<PUSHJ P,DIFUP>
BC				10200	>
BC
BTBGENDEFINEC				10400	TBGEN(DIFTAB,DIFLEN,DIFT2)^DEFINE SWITCH (P,Q)
BSWITCHC					<<SIXBIT /P/>>
BDIFTABTABLESWITCHSIXBITC	004503'	416343	515100		SWITCH ASCII,<MOVEI T1,"A">^<SIXBIT /ASCII/>^
BSWITCHSIXBITDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 46-3
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	004504'	425441	565300		SWITCH BLANK,<MOVEI T1,"B">^<SIXBIT /BLANK/>^
BSWITCHSIXBITC	004505'	435755	554556		SWITCH COMMENT,<MOVEI T1,"C">^<SIXBIT /COMMENT/>^
BSWITCHSIXBITC	004506'	636041	435156		SWITCH SPACING,<MOVEI T1,"S">^<SIXBIT /SPACING/>^
BSWITCHSIXBITC	004507'	675762	440000		SWITCH WORD,<MOVEI T1,"W">^<SIXBIT /WORD/>^
BSWITCHSIXBITC	004510'	457060	415644		SWITCH EXPAND,<MOVEI T1,"X">^<SIXBIT /EXPAND/>^
BSWITCHSIXBITC	004511'	635541	545400		SWITCH SMALL,<MOVEI T1,"N">^<SIXBIT /SMALL/>^
BSWITCHSIXBITC	004512'	545767	456200		SWITCH LOWER,<PUSHJ P,DIFLOW>^<SIXBIT /LOWER/>^
BSWITCHSIXBITC	004513'	656060	456200		SWITCH UPPER,<PUSHJ P,DIFUP>^<SIXBIT /UPPER/>^
BDIFTABDIFLENDEFINESWITCHDIFT2TABLESWITCHMOVEIT1C	004514'	201040	000101		SWITCH ASCII,<MOVEI T1,"A">^MOVEI T1,"A"^
BSWITCHMOVEIT1C	004515'	201040	000102		SWITCH BLANK,<MOVEI T1,"B">^MOVEI T1,"B"^
BSWITCHMOVEIT1C	004516'	201040	000103		SWITCH COMMENT,<MOVEI T1,"C">^MOVEI T1,"C"^
BSWITCHMOVEIT1C	004517'	201040	000123		SWITCH SPACING,<MOVEI T1,"S">^MOVEI T1,"S"^
BSWITCHMOVEIT1C	004520'	201040	000127		SWITCH WORD,<MOVEI T1,"W">^MOVEI T1,"W"^
BSWITCHMOVEIT1C	004521'	201040	000130		SWITCH EXPAND,<MOVEI T1,"X">^MOVEI T1,"X"^
BSWITCHMOVEIT1C	004522'	201040	000116		SWITCH SMALL,<MOVEI T1,"N">^MOVEI T1,"N"^
BSWITCHPUSHJPDIFLOWC	004523'	260740	004463'		SWITCH LOWER,<PUSHJ P,DIFLOW>^PUSHJ P,DIFLOW^
BSWITCHPUSHJPDIFUPC	004524'	260740	004464'		SWITCH UPPER,<PUSHJ P,DIFUP>^PUSHJ P,DIFUP^
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 47
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;HANDLE DIRECTORY-TYPE COMMANDS. ALL ARE ABOUT THE SAME EXCEPT FOR FLAGS
BC
BDODIRTLOFL2SFLGDCFLGDC	004525'	661400	000030	00300	DODIR: TLO     FL2,SFLGD!CFLGD ;SET NORMAL DIR. BITS
BC
BTRNEFL3TYMXC	004526'	602440	040000	00500	        TRNE    FL3,TYMX
BTLOFL2DFLGDPFLGDAFLGDC	004527'	661400	003040	00600	        TLO     FL2,DFLGD!PFLGD!AFLGD
BJRSTDOFLC	004530'	254000	004533'	00700	        JRST    DOFL+1
BDODELTROFL3DELTSWC	004531'	660440	000002	00800	DODEL:  TRO FL3,DELTSW  ;JUST SET DELETE SWITCH
BDOFLTLZFL2C	004532'	621400	777777	00900	DOFL:   TLZ FL2,-1      ;NO FLAGS
BTROFLPIPFC	004533'	660000	010000	01000	        TRO FL,PIPF
BDODIR1PUSHJPSCANC	004534'	260740	000276'	01100	DODIR1: PUSHJ P,SCAN    ;FIND OUT IF HE WANTS /L OR /F SWITCH
BDODIR2TRNNFLIDFC	004535'	606000	000020	01200	DODIR2: TRNN FL,IDF     ;WAS IT AN IDENT?
BCAINCC	004536'	306700	000133	01300	        CAIN C,"["
BJRSTDIRNAMC	004537'	254000	004567'	01400	        JRST DIRNAM
BCAINCC	004540'	306700	000050	01500	        CAIN    C,"("
BJRSTDIRNAMC	004541'	254000	004567'	01600	        JRST    DIRNAM
BCAINCC	004542'	306700	000055	01700	        CAIN C,"-"
BJRSTMINAMC	004543'	254000	004611'	01800	        JRST MINAM
BCAIECC	004544'	302700	000137	01900		CAIE C,"_"
BCAINCC	004545'	306700	000075	02000		CAIN C,"="
BJRSTDODIR1C	004546'	254000	004534'	02100		JRST DODIR1
BCAINCC	004547'	306700	000054	02200	        CAIN C,","
BJRSTDODIR1C	004550'	254000	004534'	02300	        JRST DODIR1
BDIRSLSCAIECC	004551'	302700	000057	02400	DIRSLS: CAIE C,"/"
BJRSTNOSLSHC	004552'	254000	004620'	02500	        JRST NOSLSH
BPUSHJPSCANC	004553'	260740	000276'	02600	        PUSHJ P,SCAN    ;WHICH ONE
BTRNNFLIDFC	004554'	606000	000020	02700	        TRNN FL,IDF     ;MUST SEEN AN IDENTIFIER
BJRSTSYNERRC	004555'	254000	001065'	02800	        JRST SYNERR
BMOVEIT1C	004556'	201040	000137	02900		MOVEI T1,"_"
BTRONFL3NEDCMAC	004557'	666440	000010	03000		TRON FL3,NEDCMA
BPUSHJPOUTDIRC	004560'	260740	010155'	03100		PUSHJ P,OUTDIR
BMOVET1XWDDIRLGDIRTABC	004561'	200040	011417'	03200	        MOVE T1,[XWD -DIRLG,DIRTAB]
BPUSHJPSWSCANC	004562'	260740	002722'	03300	        PUSHJ P,SWSCAN
BJRSTSWHELPC	004563'	254000	004646'	03400	        JRST    SWHELP
BJFCLC	004564'	255000	000000	03500	        JFCL
BXCTDIRT2DIRTABT1C	004565'	256001	000034	03600	        XCT DIRT2-DIRTAB(T1)
BJRSTDODIR1C	004566'	254000	004534'	03700	        JRST DODIR1
BDIRNAMPUSHJPGETNAMC	004567'	260740	000116'	03800	DIRNAM: PUSHJ P,GETNAM
BSKIPNSVDEVSVPTC	004570'	336014	004305*	03900		SKIPN SVDEV(SVPT)
BSKIPESVEXTSVPTC	004571'	332014	003774*	04000		SKIPE SVEXT(SVPT)
BJRSTCMNMC	004572'	254000	004576'	04100		JRST CMNM	;NO FUNNY STUFF IF DEV OR EXT GIVEN
BMOVSIT1C	004573'	205040	565764	04200		MOVSI T1,'NOT'
BCAMNT1SVNAMSVPTC	004574'	316054	004312*	04300		CAMN T1,SVNAM(SVPT)
BJRSTMINAMC	004575'	254000	004611'	04400		JRST MINAM	;NOT IS THE SAME AS -
BCMNMCAIECC	004576'	302700	000075	04500	CMNM:	CAIE C,"="
BCAINCC	004577'	306700	000137	04600		CAIN C,"_"	;NAME= OR NAME_ IS OUTPUT SPEC
BJRSTTRNEFL3NEDCMAC				04700		JRST [	TRNE FL3,NEDCMA
BJRSTSYNERRC				04800			JRST SYNERR	;MUST NOT HAVE HAD ANY PREVIOUS NAMES
BMOVSIT1C				04900			MOVSI T1,'DSK'
BSKIPNSVDEVSVPTC				05000			SKIPN SVDEV(SVPT)	;DIRIT DOESN'T HAVE DSK DEFAULT
BMOVEMT1SVDEVSVPTC				05100			MOVEM T1,SVDEV(SVPT)
BJRSTCMNM1C	004600'	254000	011420'	05200			JRST CMNM1]
BMOVEIT1C	004601'	201040	000137	05300		MOVEI T1,"_"	;JUST A REGULAR NAME, PRECEDE IT WITH
BTROEFL3NEDCMADRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 47-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	004602'	662440	000010	05400		TROE FL3,NEDCMA	;THE PROPER DELIMITER (_ IF FIRST,
BMOVEIT1C	004603'	201040	000054	05500		MOVEI T1,","	;ELSE COMMA)
BPUSHJPOUTDIRC	004604'	260740	010155'	05600		PUSHJ P,OUTDIR	;COMMA IF NOT FIRST
BCMNM1MOVET4SVPTC	004605'	200200	000014	05700	CMNM1:	MOVE T4,SVPT
BMOVEIT3OUTDIRC	004606'	201140	010155'	05800		MOVEI T3,OUTDIR
BPUSHJPCMNOC	004607'	260740	003472'	05900		PUSHJ P,CMNO	;OUTPUT NAME TO DIRIT
BJRSTDODIR1C	004610'	254000	004534'	06000		JRST DODIR1
BMINAMPUSHJPGETNMSC	004611'	260740	000115'	06100	MINAM:	PUSHJ P,GETNMS	;SKIP - AND SCAN NAME
BMOVSIT2C	004612'	205100	771500	06200		MOVSI T2,'_- '	;ARROW IF FIRST
BTROEFL3NEDCMAC	004613'	662440	000010	06300		TROE FL3,NEDCMA
BMOVSIT2C	004614'	205100	141500	06400		MOVSI T2,',- '	;COMMA IF NOT FIRST
BMOVEIT3OUTDIRC	004615'	201140	010155'	06500		MOVEI T3,OUTDIR
BPUSHJPOUTSIXC	004616'	260740	004206'	06600		PUSHJ P,OUTSIX	;OUTPUT COMMA (OR ARROW) AND -
BJRSTCMNM1C	004617'	254000	004605'	06700		JRST CMNM1
BNOSLSHTLNNCSTERMFC	004620'	607640	200000	06800	NOSLSH: TLNN CS,TERMF   ;THIS MUST BE A TERMINATOR
BJRSTSYNERRC	004621'	254000	001065'	06900	        JRST SYNERR     ;NOPE, HE LOSES
BMOVEIT1C	004622'	201040	000137	07000		MOVEI T1,"_"
BTRNNFL3NEDCMAC	004623'	606440	000010	07100		TRNN FL3,NEDCMA
BPUSHJPOUTDIRC	004624'	260740	010155'	07200		PUSHJ P,OUTDIR	;_ IF NO FILE SPECIFICATIONS YET
BOSWDMOVEIT3OUTDIRC	004625'	201140	010155'	07300	OSWD:	MOVEI T3,OUTDIR
BMOVET4XWDDSBTLDSBTC	004626'	200200	011426'	07400		MOVE T4,[XWD -DSBTL,DSBT]
BPUSHJPSWBITSC	004627'	260740	003227'	07500	        PUSHJ P,SWBITS
BTLNNFL2T2C	004630'	607402	000000	07600	        TLNN FL2,(T2)
BMOVET4XWDD2SBTLD2SBTC	004631'	200200	011427'	07700	        MOVE T4,[XWD -D2SBTL,D2SBT]     ;RAN OUT OF BITS IN 1 WORD
BPUSHJPSWBITSC	004632'	260740	003227'	07800	        PUSHJ P,SWBITS
BTRNNFL3T2C	004633'	606442	000000	07900	        TRNN FL3,(T2)   ;SO USE ANOTHER
BOPIPWPUSHJPOUCRLFC	004634'	260740	010063'	08000	OPIPW:  PUSHJ P,OUCRLF
BIFETEMPC				08100	IFE TEMP,<RELEASE CHNDIR,0>
BIFNTEMPPUSHJPCHKDIRC	004635'	260740	010161'	08200	IFN TEMP,<PUSHJ P,CHKDIR>
BMOVET1SIXBITC	004636'	200040	011430'	08300	        MOVE T1,[SIXBIT /DIRIT/]
BMOVEMT1PCNAMC	004637'	202040	004425*	08400	        MOVEM T1,PCNAM
BJRSTDONE1C	004640'	254000	001401'	08500	        JRST DONE1
BOPIP1PUSHJPOUCRLFC	004641'	260740	010063'	08600	OPIP1:  PUSHJ   P,OUCRLF
BOPIP2C	004642'			08700	OPIP2:
BIFETEMPC				08800	IFE TEMP,<      RELEASE CHNPIP,0>
BIFNTEMPPUSHJPCHKPIPC	004642'	260740	010175'	08900	IFN TEMP,<      PUSHJ P,CHKPIP  ;CHECK FOR TMPCOR UUO>
BMOVSIT1SIXBITC	004643'	205040	605160	09000	        MOVSI T1,(SIXBIT /PIP/)
BMOVEMT1PCNAMC	004644'	202040	004637*	09100	        MOVEM T1,PCNAM  ;LOAD THIS ONE
BJRSTDONE1C	004645'	254000	001401'	09200	        JRST DONE1
BC
BSWHELPOUTSTRSWHLPMC	004646'	051140	004650'	09400	SWHELP:	OUTSTR	SWHLPM
BJRSTEXC	004647'	254000	001410'	09500	        JRST    EX
BSWHLPMASCIZC	004650'			09600	SWHLPM: ASCIZ $
BC	004650'	064252	347644	09700	SORT SWITCHES ARE:
	004651'	521012	353622
	004652'	522071	042646
	004653'	202032	242564
BC	004654'	064244	027612	09800	 /EXTENSION
	004655'	542510	547246
BC	004656'	446371	606424	09900	 /ALPHABETICAL
	004657'	201370	146240
	004660'	442030	242650
	004661'	446070	146032
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 47-3
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	004662'	051005	751650	10000	 /STORAGE
	004663'	476450	143612
BC	004664'	064244	027644	10100	 /REVERSE
	004665'	426550	551246
BC	004666'	424321	244650	10200	ITEM SWITCHES ARE:
	004667'	426324	051656
	004670'	446510	344212
	004671'	515010	151212
BC	004672'	350321	220136	10300	 /SIZE
	004673'	516233	242432
BC	004674'	051005	741644	10400	 /CREATION
	004675'	426032	444636
BC	004676'	470321	220136	10500	 /TIME (OF CREATION)
	004677'	522231	542500
	004700'	242370	620206
	004701'	512130	152222
BC	004702'	476345	106424	10600	 /SECONDS (OF CREATION)
	004703'	201372	342606
	004704'	476350	451500
	004705'	242370	620206
	004706'	512130	152222
BC	004707'	476345	106424	10700	 /PROTECTION
	004710'	201372	051236
	004711'	522130	352222
BC	004712'	476341	505100	10800	 /ACCESS
	004713'	276030	341612
BC	004714'	516461	505100	10900	 /LICENSE
	004715'	276311	141612
BC	004716'	472470	506424	11000	 /UFDBITS
	004717'	201372	543210
	004720'	412232	451432
BC	004721'	051005	753636	11100	 /WORDS
BC	004722'	512112	306424	11200	 /STATUS
	004723'	201372	352202
BC	004724'	522532	306424	11300	OTHER SWITCHES:
	004725'	476511	042644
	004726'	202472	744650
	004727'	416210	551564
BC	004730'	064244	027650	11400	 /TODAY
	004731'	476110	154432
BC	004732'	051005	740614	11500	 /AFTER
BC	004733'	522132	206424	11600	 /BEFORE
	004734'	201370	242614
BC	004735'	476450	506424	11700	 /TOTAL
	004736'	201372	447650
BC	004737'	406301	505100	11800	 /TEMPS (OR /K)
	004740'	276510	546640
	004741'	515005	047644
	004742'	201371	324432
BC	004743'	051005	743202	11900	 /FAST
BC	004744'	516501	505100	12000	 /EVERYTHING
	004745'	276132	642644
	004746'	546511	044634
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 47-4
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	004747'	434321	220136	12100	 /UNSORTED
	004750'	526352	347644
BC	004751'	522130	406424	12200	 /NOPRINT
	004752'	201371	647640
	004753'	512231	652032
BC	004754'	050000	000000	12300	$
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 48
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;SWITCH VALUES
BC
BEFLGDC			000001	00300	EFLGD==1
BRFLGDC			000002	00400	RFLGD==2
BTFLGDC			000004	00500	TFLGD==4
BSFLGDC			000010	00600	SFLGD==10
BCFLGDC			000020	00700	CFLGD==20
BDFLGDC			000040	00800	DFLGD==40
BJFLGDC			000100	00900	JFLGD==100
BNFLGDC			000200	01000	NFLGD==200
BBFLGDC			000400	01100	BFLGD==400
BPFLGDC			001000	01200	PFLGD==1000
BAFLGDC			002000	01300	AFLGD==2000
BMFLGDC			004000	01400	MFLGD==4000
BKFLGDC			010000	01500	KFLGD==10000
BVFLGDC			020000	01600	VFLGD==20000
BUFLGDC			040000	01700	UFLGD==40000
BHFLGDC			100000	01800	HFLGD==100000
BGFLGDC			200000	01900	GFLGD==200000
BC
BC				02100	;NOW BITS IN RH OF FL3
BC
BC
BPRMSWC			000001	02400	PRMSW==1        ;WANTS PROMPT ON DELETE
BDELTSWC			000002	02500	DELTSW==2       ;THIS IS A DELETE
BRENTSWC			000004	02600	RENTSW==4       ;THIS IS A RENAME
BNEDCMAC			000010	02700	NEDCMA==10	;NEED TO OUTPUT COMMA BEFORE NAME
BYFLGDC			000020	02800	YFLGD==20
BZFLGDC			000040	02900	ZFLGD==40
BSOONRC			000100	03000	SOONR==100	;1=/BEFORE  0=/AFTER
BIFLGDC			000200	03100	IFLGD==200
BC
BDEFINEC				03300	DEFINE TABLE
BTABLEC				03400	<SWITCH LPT,<TRO FL3,IFLGD>
BC				03500	SWITCH EXTENSION,<TLO FL2,EFLGD>
BC				03600	SWITCH REVERSE,<TLO FL2,RFLGD>
BC				03700	SWITCH ALPHABETIC,<TLO FL2,TFLGD>
BC				03800	SWITCH SIZE,<TLO FL2,SFLGD>
BC				03900	SWITCH CREATION,<TLO FL2,CFLGD>
BC				04000	SWITCH TIME,<TLO FL2,DFLGD>
BC				04100	SWITCH SECONDS,<TLO FL2,JFLGD>
BC				04200	SWITCH TOTAL,<TLO FL2,NFLGD>
BC				04300	SWITCH LICENSE,<TLO FL2,BFLGD>
BC				04400	SWITCH PROTECTION,<TLO FL2,PFLGD>
BC				04500	SWITCH ACCESS,<TLO FL2,AFLGD>
BC				04600	SWITCH MODE,<TLO FL2,MFLGD>
BC				04700	SWITCH TEMPS,<TLO FL2,KFLGD>
BC				04800	SWITCH K,<TLO FL2,KFLGD>
BC				04900	SWITCH FAST,<TLZ FL2,SFLGD!CFLGD!PFLGD!AFLGD>
BC				05000	SWITCH EVERYTHING,<PUSHJ P,EVRYTH>
BC				05100	SWITCH UNSORTED,<TLO FL2,UFLGD>
BC				05200	SWITCH STORAGE,<TLO FL2,HFLGD>
BC				05300	SWITCH UFDBITS,<TLO FL2,GFLGD>
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 48-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				05400	SWITCH NOPRINT,<TLO FL2,VFLGD>
BC				05500	SWITCH WORDS,<TRO FL3,YFLGD>
BC				05600	SWITCH STATUS,<TRO FL3,ZFLGD>
BC				05700	SWITCH BEFORE,<JRST SOONER>
BC				05800	SWITCH AFTER,<JRST LATER>
BC				05900	SWITCH TODAY,<JRST TODAY>
BC				06000	SWITCH WAIT,<TRO FL3,PRMSW>
BC				06100	SWITCH RUN,<PUSHJ P,SETRNN>
BC				06200	>
BTBGENDEFINEC				06300	TBGEN (DIRTAB,DIRLG,DIRT2)^DEFINE SWITCH (P,Q)
BSWITCHC					<<SIXBIT /P/>>
BDIRTABTABLESWITCHSIXBITC	004755'	546064	000000		DIRTAB:      TABLE^SWITCH LPT,<TRO FL3,IFLGD>^<SIXBIT /LPT/>^
BSWITCHSIXBITC	004756'	457064	455663		SWITCH EXTENSION,<TLO FL2,EFLGD>^<SIXBIT /EXTENSION/>^
BSWITCHSIXBITC	004757'	624566	456263		SWITCH REVERSE,<TLO FL2,RFLGD>^<SIXBIT /REVERSE/>^
BSWITCHSIXBITC	004760'	415460	504142		SWITCH ALPHABETIC,<TLO FL2,TFLGD>^<SIXBIT /ALPHABETIC/>^
BSWITCHSIXBITC	004761'	635172	450000		SWITCH SIZE,<TLO FL2,SFLGD>^<SIXBIT /SIZE/>^
BSWITCHSIXBITC	004762'	436245	416451		SWITCH CREATION,<TLO FL2,CFLGD>^<SIXBIT /CREATION/>^
BSWITCHSIXBITC	004763'	645155	450000		SWITCH TIME,<TLO FL2,DFLGD>^<SIXBIT /TIME/>^
BSWITCHSIXBITC	004764'	634543	575644		SWITCH SECONDS,<TLO FL2,JFLGD>^<SIXBIT /SECONDS/>^
BSWITCHSIXBITC	004765'	645764	415400		SWITCH TOTAL,<TLO FL2,NFLGD>^<SIXBIT /TOTAL/>^
BSWITCHSIXBITC	004766'	545143	455663		SWITCH LICENSE,<TLO FL2,BFLGD>^<SIXBIT /LICENSE/>^
BSWITCHSIXBITC	004767'	606257	644543		SWITCH PROTECTION,<TLO FL2,PFLGD>^<SIXBIT /PROTECTION/>^
BSWITCHSIXBITC	004770'	414343	456363		SWITCH ACCESS,<TLO FL2,AFLGD>^<SIXBIT /ACCESS/>^
BSWITCHSIXBITC	004771'	555744	450000		SWITCH MODE,<TLO FL2,MFLGD>^<SIXBIT /MODE/>^
BSWITCHSIXBITC	004772'	644555	606300		SWITCH TEMPS,<TLO FL2,KFLGD>^<SIXBIT /TEMPS/>^
BSWITCHSIXBITC	004773'	530000	000000		SWITCH K,<TLO FL2,KFLGD>^<SIXBIT /K/>^
BSWITCHSIXBITC	004774'	464163	640000		SWITCH FAST,<TLZ FL2,SFLGD!CFLGD!PFLGD!AFLGD>^<SIXBIT /FAST/>^
BSWITCHSIXBITC	004775'	456645	627164		SWITCH EVERYTHING,<PUSHJ P,EVRYTH>^<SIXBIT /EVERYTHING/>^
BSWITCHSIXBITC	004776'	655663	576264		SWITCH UNSORTED,<TLO FL2,UFLGD>^<SIXBIT /UNSORTED/>^
BSWITCHSIXBITC	004777'	636457	624147		SWITCH STORAGE,<TLO FL2,HFLGD>^<SIXBIT /STORAGE/>^
BSWITCHSIXBITC	005000'	654644	425164		SWITCH UFDBITS,<TLO FL2,GFLGD>^<SIXBIT /UFDBITS/>^
BSWITCHSIXBITC	005001'	565760	625156		SWITCH NOPRINT,<TLO FL2,VFLGD>^<SIXBIT /NOPRINT/>^
BSWITCHSIXBITC	005002'	675762	446300		SWITCH WORDS,<TRO FL3,YFLGD>^<SIXBIT /WORDS/>^
BSWITCHSIXBITC	005003'	636441	646563		SWITCH STATUS,<TRO FL3,ZFLGD>^<SIXBIT /STATUS/>^
BSWITCHSIXBITC	005004'	424546	576245		SWITCH BEFORE,<JRST SOONER>^<SIXBIT /BEFORE/>^
BSWITCHSIXBITC	005005'	414664	456200		SWITCH AFTER,<JRST LATER>^<SIXBIT /AFTER/>^
BSWITCHSIXBITC	005006'	645744	417100		SWITCH TODAY,<JRST TODAY>^<SIXBIT /TODAY/>^
BSWITCHSIXBITC	005007'	674151	640000		SWITCH WAIT,<TRO FL3,PRMSW>^<SIXBIT /WAIT/>^
BSWITCHSIXBITC	005010'	626556	000000		SWITCH RUN,<PUSHJ P,SETRNN>^<SIXBIT /RUN/>^
BDIRTABDIRLGDEFINESWITCHDIRT2TABLESWITCHTROFL3IFLGDC	005011'	660440	000200		DIRT2:      TABLE^SWITCH LPT,<TRO FL3,IFLGD>^TRO FL3,IFLGD^
BSWITCHTLOFL2EFLGDC	005012'	661400	000001		SWITCH EXTENSION,<TLO FL2,EFLGD>^TLO FL2,EFLGD^
BSWITCHTLOFL2RFLGDC	005013'	661400	000002		SWITCH REVERSE,<TLO FL2,RFLGD>^TLO FL2,RFLGD^
BSWITCHTLOFL2TFLGDC	005014'	661400	000004		SWITCH ALPHABETIC,<TLO FL2,TFLGD>^TLO FL2,TFLGD^
BSWITCHTLOFL2SFLGDC	005015'	661400	000010		SWITCH SIZE,<TLO FL2,SFLGD>^TLO FL2,SFLGD^
BSWITCHTLOFL2CFLGDC	005016'	661400	000020		SWITCH CREATION,<TLO FL2,CFLGD>^TLO FL2,CFLGD^
BSWITCHTLOFL2DFLGDC	005017'	661400	000040		SWITCH TIME,<TLO FL2,DFLGD>^TLO FL2,DFLGD^
BSWITCHTLOFL2JFLGDC	005020'	661400	000100		SWITCH SECONDS,<TLO FL2,JFLGD>^TLO FL2,JFLGD^
BSWITCHTLOFL2NFLGDC	005021'	661400	000200		SWITCH TOTAL,<TLO FL2,NFLGD>^TLO FL2,NFLGD^
BSWITCHTLOFL2BFLGDC	005022'	661400	000400		SWITCH LICENSE,<TLO FL2,BFLGD>^TLO FL2,BFLGD^
BSWITCHTLOFL2PFLGDC	005023'	661400	001000		SWITCH PROTECTION,<TLO FL2,PFLGD>^TLO FL2,PFLGD^
BSWITCHTLOFL2AFLGDC	005024'	661400	002000		SWITCH ACCESS,<TLO FL2,AFLGD>^TLO FL2,AFLGD^
BSWITCHTLOFL2MFLGDC	005025'	661400	004000		SWITCH MODE,<TLO FL2,MFLGD>^TLO FL2,MFLGD^
BSWITCHTLOFL2KFLGDC	005026'	661400	010000		SWITCH TEMPS,<TLO FL2,KFLGD>^TLO FL2,KFLGD^
BSWITCHTLOFL2KFLGDDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 48-3
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	005027'	661400	010000		SWITCH K,<TLO FL2,KFLGD>^TLO FL2,KFLGD^
BSWITCHTLZFL2SFLGDCFLGDPFLGDAFLGDC	005030'	621400	003030		SWITCH FAST,<TLZ FL2,SFLGD!CFLGD!PFLGD!AFLGD>^TLZ FL2,SFLGD!CFLGD!PFLGD!AFLGD^
BSWITCHPUSHJPEVRYTHC	005031'	260740	005074'		SWITCH EVERYTHING,<PUSHJ P,EVRYTH>^PUSHJ P,EVRYTH^
BSWITCHTLOFL2UFLGDC	005032'	661400	040000		SWITCH UNSORTED,<TLO FL2,UFLGD>^TLO FL2,UFLGD^
BSWITCHTLOFL2HFLGDC	005033'	661400	100000		SWITCH STORAGE,<TLO FL2,HFLGD>^TLO FL2,HFLGD^
BSWITCHTLOFL2GFLGDC	005034'	661400	200000		SWITCH UFDBITS,<TLO FL2,GFLGD>^TLO FL2,GFLGD^
BSWITCHTLOFL2VFLGDC	005035'	661400	020000		SWITCH NOPRINT,<TLO FL2,VFLGD>^TLO FL2,VFLGD^
BSWITCHTROFL3YFLGDC	005036'	660440	000020		SWITCH WORDS,<TRO FL3,YFLGD>^TRO FL3,YFLGD^
BSWITCHTROFL3ZFLGDC	005037'	660440	000040		SWITCH STATUS,<TRO FL3,ZFLGD>^TRO FL3,ZFLGD^
BSWITCHJRSTSOONERC	005040'	254000	005077'		SWITCH BEFORE,<JRST SOONER>^JRST SOONER^
BSWITCHJRSTLATERC	005041'	254000	005100'		SWITCH AFTER,<JRST LATER>^JRST LATER^
BSWITCHJRSTTODAYC	005042'	254000	005200'		SWITCH TODAY,<JRST TODAY>^JRST TODAY^
BSWITCHTROFL3PRMSWC	005043'	660440	000001		SWITCH WAIT,<TRO FL3,PRMSW>^TRO FL3,PRMSW^
BSWITCHPUSHJPSETRNNC	005044'	260740	000054'		SWITCH RUN,<PUSHJ P,SETRNN>^PUSHJ P,SETRNN^
BDSBTSBTSSIXBITEFLGDDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 49
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	005045'	174500	000001	00100	DSBT:  SBTS E,EFLGD^<SIXBIT !/E!>+EFLGD^
BSBTSSIXBITRFLGDC	005046'	176200	000002	00200	        SBTS R,RFLGD^<SIXBIT !/R!>+RFLGD^
BSBTSSIXBITTFLGDC	005047'	176400	000004	00300	        SBTS T,TFLGD^<SIXBIT !/T!>+TFLGD^
BSBTSSIXBITSFLGDC	005050'	176300	000010	00400	        SBTS S,SFLGD^<SIXBIT !/S!>+SFLGD^
BSBTSSIXBITCFLGDC	005051'	174300	000020	00500	        SBTS C,CFLGD^<SIXBIT !/C!>+CFLGD^
BSBTSSIXBITDFLGDC	005052'	174400	000040	00600	        SBTS D,DFLGD^<SIXBIT !/D!>+DFLGD^
BSBTSSIXBITJFLGDC	005053'	175200	000100	00700	        SBTS J,JFLGD^<SIXBIT !/J!>+JFLGD^
BSBTSSIXBITNFLGDC	005054'	175600	000200	00800	        SBTS N,NFLGD^<SIXBIT !/N!>+NFLGD^
BSBTSSIXBITBFLGDC	005055'	174200	000400	00900	        SBTS B,BFLGD^<SIXBIT !/B!>+BFLGD^
BSBTSSIXBITPFLGDC	005056'	176000	001000	01000	        SBTS P,PFLGD^<SIXBIT !/P!>+PFLGD^
BSBTSSIXBITAFLGDC	005057'	174100	002000	01100	        SBTS A,AFLGD^<SIXBIT !/A!>+AFLGD^
BSBTSSIXBITMFLGDC	005060'	175500	004000	01200	        SBTS M,MFLGD^<SIXBIT !/M!>+MFLGD^
BSBTSSIXBITKFLGDC	005061'	175300	010000	01300	        SBTS K,KFLGD^<SIXBIT !/K!>+KFLGD^
BSBTSSIXBITVFLGDC	005062'	176600	020000	01400	        SBTS V,VFLGD^<SIXBIT !/V!>+VFLGD^
BSBTSSIXBITUFLGDC	005063'	176500	040000	01500	        SBTS U,UFLGD^<SIXBIT !/U!>+UFLGD^
BSBTSSIXBITHFLGDC	005064'	175000	100000	01600	        SBTS H,HFLGD^<SIXBIT !/H!>+HFLGD^
BSBTSSIXBITGFLGDC	005065'	174700	200000	01700		SBTS G,GFLGD^<SIXBIT !/G!>+GFLGD^
BDSBTDSBTLC			000021	01800	DSBTL==.-DSBT
BC
BD2SBTSBTSSIXBITDELTSWC	005066'	177000	000002	02000	D2SBT:  SBTS X,DELTSW^<SIXBIT !/X!>+DELTSW^
BSBTSSIXBITPRMSWC	005067'	176100	000001	02100	        SBTS Q,PRMSW^<SIXBIT !/Q!>+PRMSW^
BSBTSSIXBITRENTSWC	005070'	175400	000004	02200	        SBTS L,RENTSW^<SIXBIT !/L!>+RENTSW^
BSBTSSIXBITYFLGDC	005071'	177100	000020	02300		SBTS Y,YFLGD^<SIXBIT !/Y!>+YFLGD^
BSBTSSIXBITZFLGDC	005072'	177200	000040	02400		SBTS Z,ZFLGD^<SIXBIT !/Z!>+ZFLGD^
BSBTSSIXBITIFLGDC	005073'	175100	000200	02500		SBTS I,IFLGD^<SIXBIT !/I!>+IFLGD^
BD2SBTD2SBTLC			000006	02600	D2SBTL==.-D2SBT
BC
BEVRYTHTLOFL2SFLGDJFLGDPFLGDAFLGDMFLGDBFLGDGFLGDC	005074'	661400	207510	02800	EVRYTH:	TLO FL2,SFLGD!JFLGD!PFLGD!AFLGD!MFLGD!BFLGD!GFLGD
BTROFL3YFLGDZFLGDC	005075'	660440	000060	02900		TRO FL3,YFLGD!ZFLGD
BPOPJPC	005076'	263740	000000	03000		POPJ P,
BC
BSOONERTROAFL3SOONRC	005077'	664440	000100	03200	SOONER:	TROA FL3,SOONR
BLATERTRZFL3SOONRC	005100'	620440	000100	03300	LATER:	TRZ FL3,SOONR
BMOVEIT1C	005101'	201040	000057	03400		MOVEI T1,"/"
BPUSHJPOUTDIRC	005102'	260740	010155'	03500		PUSHJ P,OUTDIR
BSETZMDIRDATDIRDATC	005103'	402000	000000*	03600	        SETZM DIRDAT#
BDATET1C	005104'	047040	000014	03700	        DATE    T1,
BIDIVIT1C	005105'	231040	000037	03800	        IDIVI T1,^D31
BMOVEMT2DRDAYDRDAYC	005106'	202100	000000*	03900	        MOVEM T2,DRDAY#
BIDIVIT1C	005107'	231040	000014	04000	        IDIVI T1,^D12
BMOVEMT2DRMONDRMONC	005110'	202100	000000*	04100	        MOVEM T2,DRMON#
BMOVEMT1DRYRDRYRC	005111'	202040	000000*	04200	        MOVEM T1,DRYR#
BPUSHJPSCANC	005112'	260740	000276'	04300	        PUSHJ P,SCAN
BCAINCC	005113'	306700	000056	04400	        CAIN C,"."
BJRSTCRDAGTC	005114'	254000	005145'	04500	        JRST CRDAGT
BTRNNFLNUMFSC	005115'	606000	000100	04600	        TRNN FL,NUMFS
BJRSTSYNERRC	005116'	254000	001065'	04700	        JRST SYNERR
BSOST1NUMACC	005117'	370040	004471*	04800	        SOS T1,NUMAC
BMOVEMT1DRDAYC	005120'	202040	005106*	04900	        MOVEM T1,DRDAY
BPUSHJPSCANC	005121'	260740	000276'	05000	        PUSHJ P,SCAN
BCAIECC	005122'	302700	000055	05100	        CAIE C,"-"
BJRSTCRDAGTC	005123'	254000	005145'	05200	        JRST CRDAGT
BPUSHJPSCANC	005124'	260740	000276'	05300	        PUSHJ P,SCAN
BTRNNFLIDFDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 49-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	005125'	606000	000020	05400	        TRNN FL,IDF     ;MUST BE IDENT OR NUMBER
BJRSTSYNERRC	005126'	254000	001065'	05500	        JRST SYNERR
BTRNNFLNUMFSC	005127'	606000	000100	05600	        TRNN FL,NUMFS
BJRSTRMONC	005130'	254000	005206'	05700	        JRST RMON       ;FIND OUT WHICH MONTH (TYPE IN NAME)
BSOST1NUMACC	005131'	370040	005117*	05800	        SOS T1,NUMAC
BMOVEMT1DRMONC	005132'	202040	005110*	05900	        MOVEM T1,DRMON
BRDYRDPUSHJPSCANC	005133'	260740	000276'	06000	RDYRD:  PUSHJ P,SCAN
BCAIECC	005134'	302700	000055	06100	        CAIE C,"-"
BJRSTCRDAGTC	005135'	254000	005145'	06200	        JRST CRDAGT
BPUSHJPSCANC	005136'	260740	000276'	06300	        PUSHJ P,SCAN
BTRNNFLNUMFSC	005137'	606000	000100	06400	        TRNN FL,NUMFS
BJRSTSYNERRC	005140'	254000	001065'	06500	        JRST SYNERR
BMOVET1NUMACC	005141'	200040	005131*	06600	        MOVE T1,NUMAC
BSUBIT1C	005142'	275040	000100	06700	        SUBI T1,^D64
BMOVEMT1DRYRC	005143'	202040	005111*	06800	        MOVEM T1,DRYR
BPUSHJPSCANC	005144'	260740	000276'	06900	        PUSHJ P,SCAN
BCRDAGTMOVET1DRYRC	005145'	200040	005143*	07000	CRDAGT: MOVE T1,DRYR
BIMULIT1C	005146'	221040	000014	07100	        IMULI T1,^D12
BADDT1DRMONC	005147'	270040	005132*	07200	        ADD T1,DRMON
BIMULIT1C	005150'	221040	000037	07300	        IMULI T1,^D31
BADDT1DRDAYC	005151'	270040	005120*	07400	        ADD T1,DRDAY
BMOVEMT1DIRDATC	005152'	202040	005103*	07500	        MOVEM T1,DIRDAT
BMOVEIT4DODIR2DRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 50
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	005153'	201200	004535'	00100		MOVEI T4,DODIR2
BCAIECC	005154'	302700	000056	00200	       CAIE C,"."
BJRSTDODT2C	005155'	254000	005170'	00300		JRST DODT2
BPUSHJPSCANC	005156'	260740	000276'	00400	        PUSHJ P,SCAN
BTRNNFLNUMFSC	005157'	606000	000100	00500	        TRNN FL,NUMFS
BJRSTSYNERRC	005160'	254000	001065'	00600	        JRST SYNERR
BMOVET1NUMACC	005161'	200040	005141*	00700	        MOVE T1,NUMAC
BIDIVIT1C	005162'	231040	000144	00800	        IDIVI T1,^D100
BIMULIT1C	005163'	221040	000074	00900	        IMULI T1,^D60
BADDT1T2C	005164'	270040	000002	01000	        ADD T1,T2
BIMULIT1C	005165'	221040	000074	01100	        IMULI T1,^D60
BDPBT1POINTDIRDATC	005166'	137040	011431'	01200	        DPB T1,[POINT 17,DIRDAT,23]
BDODT1MOVEIT4DODIR1C	005167'	201200	004534'	01300	DODT1:	MOVEI T4,DODIR1
BDODT2MOVET1DIRDATC	005170'	200040	005152*	01400	DODT2:	MOVE T1,DIRDAT
BMOVEIT3OUTDIRC	005171'	201140	010155'	01500		MOVEI T3,OUTDIR
BPUSHJPOUTNUMC	005172'	260740	007657'	01600		PUSHJ P,OUTNUM	;OUTPUT DATE
BMOVEIT1C	005173'	201040	000074	01700		MOVEI T1,"<"
BTRNNFL3SOONRC	005174'	606440	000100	01800		TRNN FL3,SOONR
BMOVEIT1C	005175'	201040	000076	01900		MOVEI T1,">"
BPUSHJPOUTDIRC	005176'	260740	010155'	02000		PUSHJ P,OUTDIR	;OUTPUT APPROPRIATE SWITCH
BJRSTT4C	005177'	254004	000000	02100		JRST (T4)
BC
BTODAYTRZFL3SOONRC	005200'	620440	000100	02300	TODAY:	TRZ FL3,SOONR
BMOVEIT1C	005201'	201040	000057	02400		MOVEI T1,"/"
BPUSHJPOUTDIRC	005202'	260740	010155'	02500		PUSHJ P,OUTDIR
BDATET1C	005203'	047040	000014	02600	        DATE    T1,
BMOVEMT1DIRDATC	005204'	202040	005170*	02700	        MOVEM T1,DIRDAT
BJRSTDODT1C	005205'	254000	005167'	02800		JRST DODT1
BC
BC
BRMONMOVET1XWDMONLGMONTABC	005206'	200040	011432'	03100	RMON:   MOVE T1,[XWD -MONLG,MONTAB]
BPUSHJPSWSCANC	005207'	260740	002722'	03200	        PUSHJ P,SWSCAN
BJRSTSYNERRC	005210'	254000	001065'	03300	        JRST SYNERR
BJFCLC	005211'	255000	000000	03400	        JFCL
BSUBIT1MONTABC	005212'	275040	005215'	03500	        SUBI T1,MONTAB  ;CONVERT TO NUMBER
BHRRZMT1DRMONC	005213'	552040	005147*	03600	        HRRZM T1,DRMON  ;PUT IT IN
BJRSTRDYRDC	005214'	254000	005133'	03700	        JRST RDYRD      ;DONE
BC
BDEFINEC				03900	DEFINE IR (A)
BIRC				04000	<IRP A <<SIXBIT /A/>>>
BMONTABIRIRPC	005215'			04100	MONTAB: IR <JANUARY,FEBRUARY,MARCH,APRIL,MAY,JUNE,JULY,AUGUST>^IRP 
BSIXBITC	005215'	524156	654162		<SIXBIT /JANUARY/>
BSIXBITC	005216'	464542	626541		<SIXBIT /FEBRUARY/>
BSIXBITC	005217'	554162	435000		<SIXBIT /MARCH/>
BSIXBITC	005220'	416062	515400		<SIXBIT /APRIL/>
BSIXBITC	005221'	554171	000000		<SIXBIT /MAY/>
BSIXBITC	005222'	526556	450000		<SIXBIT /JUNE/>
BSIXBITC	005223'	526554	710000		<SIXBIT /JULY/>
BSIXBITC	005224'	416547	656364		<SIXBIT /AUGUST/>
BIRIRPC				04200	        IR <SEPTEMBER,OCTOBER,NOVEMBER,DECEMBER>^IRP 
BSIXBITC	005225'	634560	644555		<SIXBIT /SEPTEMBER/>
BSIXBITC	005226'	574364	574245		<SIXBIT /OCTOBER/>
BSIXBITC	005227'	565766	455542		<SIXBIT /NOVEMBER/>
BSIXBITDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 50-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	005230'	444543	455542		<SIXBIT /DECEMBER/>
BMONTABMONLGC			000014	04300	MONLG==.-MONTAB
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 51
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;PDP10-STYLE RENAME
BC
BDORENTROFLPIPFC	005231'	660000	010000	00300	DOREN: TRO FL,PIPF     ;PERMIT * IN FILES
BMOVEIT4ASCIZC	005232'	201200	011433'	00400		MOVEI T4,[ASCIZ/OLD NAME: /]
BPUSHJPPROMPTC	005233'	260740	005544'	00500		PUSHJ P,PROMPT	;PROMPT USER (MAYBE)
BPUSHPFLC	005234'	261740	000000	00600		PUSH P,FL	;SAVE FL BECAUSE GETNAM ZAPS NEEDED FLAG
BPUSHJPGETNMSC	005235'	260740	000115'	00700		PUSHJ P,GETNMS	;SCAN FIRST FILE NAME
BCAIECC	005236'	302700	000075	00800		CAIE C,"="	;HOW DID IT TERMINATE?
BCAINCC	005237'	306700	000137	00900		CAIN C,"_"
BJRSTPDPRENC	005240'	254000	005243'	01000		JRST PDPREN	; = OR _ MEANS PDP10-STYLE
BCAIECC	005241'	302700	000074	01100		CAIE C,"<"	;AS DOES <
BJRSTTYMRENC	005242'	254000	005700'	01200		JRST TYMREN	;ANYTHING ELSE IS TYMEX-STYLE
BPDPRENPOPPT1C	005243'	262740	000001	01300	PDPREN:	POP P,T1	;GET BACK FLAG
BTRNET1PRMPTFC	005244'	602040	000100	01400		TRNE T1,PRMPTF
BJRSTSYNERRC	005245'	254000	001065'	01500		JRST SYNERR	;BUT PDP10-STYLE CAN'T BE PROMPTED
BGETPPNT1C	005246'	047040	000024	01600		GETPPN T1,
BSKIPNSVPPNC	005247'	336000	003565*	01700		SKIPN SVPPN
BMOVEMT1SVPPNC	005250'	202040	005247*	01800		MOVEM T1,SVPPN	;USER'S PPN IF NONE GIVEN (BECAUSE OF DIRIT BUG)
BSKIPESVNAMC	005251'	332000	004574*	01900	        SKIPE SVNAM     ;NO NAME, NO SCAN
BPUSHJPSCANC	005252'	260740	000276'	02000	        PUSHJ P,SCAN
BMOVEIT3OUTDIRC	005253'	201140	010155'	02100	        MOVEI T3,OUTDIR
BMOVET4SVPTC	005254'	200200	000014	02200		MOVE T4,SVPT
BPUSHJPCMNOC	005255'	260740	003472'	02300		PUSHJ P,CMNO	;OUTPUT NAME
BCAIECC	005256'	302700	000074	02400	        CAIE C,"<"      ;IS THERE PROTECTION?
BJRSTNORPRTC	005257'	254000	005277'	02500	        JRST NORPRT
BPUSHJPSCANC	005260'	260740	000276'	02600	        PUSHJ P,SCAN
BTRNNFLNUMFSC	005261'	606000	000100	02700	        TRNN FL,NUMFS
BPUSHJPTRYIDPC	005262'	260740	005320'	02800		PUSHJ P,TRYIDP	;TRY FOR NAMES ON PROTECTION
BCOMPRTMOVEIT1C	005263'	201040	000074	02900	COMPRT: MOVEI T1,"<"
BPUSHJPOUTDIRC	005264'	260740	010155'	03000	        PUSHJ P,OUTDIR
BMOVET2NUMACC	005265'	200100	005161*	03100	        MOVE T2,NUMAC   ;GET NUMBER
BPUSHJPDECOCTC	005266'	260740	005304'	03200	        PUSHJ P,DECOCT  ;CONVET IT
BMOVEIT3OUTDIRC	005267'	201140	010155'	03300	        MOVEI T3,OUTDIR ;DESTROYED BY DECOCT
BPUSHJPOUTNUMC	005270'	260740	007657'	03400	        PUSHJ P,OUTNUM
BMOVEIT1C	005271'	201040	000076	03500	        MOVEI T1,">"
BPUSHJPOUTDIRC	005272'	260740	010155'	03600	        PUSHJ P,OUTDIR
BPUSHJPSCANC	005273'	260740	000276'	03700	        PUSHJ P,SCAN
BCAIECC	005274'	302700	000076	03800	        CAIE C,">"
BJRSTSYNERRC	005275'	254000	001065'	03900	        JRST SYNERR
BPUSHJPSCANC	005276'	260740	000276'	04000	        PUSHJ P,SCAN
BNORPRTTROFL3RENTSWC	005277'	660440	000004	04100	NORPRT: TRO FL3,RENTSW  ;SET THE BIT
BCAIECC	005300'	302700	000075	04200	        CAIE C,"="
BCAINCC	005301'	306700	000137	04300		CAIN C,"_"
BJRSTDOFLC	005302'	254000	004532'	04400		JRST DOFL
BJRSTSYNERRC	005303'	254000	001065'	04500	        JRST SYNERR
BC
BDECOCTMOVEIT1C	005304'	201040	000000	04700	DECOCT: MOVEI T1,0
BJUMPGET2DECO1C	005305'	325100	005310'	04800	        JUMPGE T2,DECO1
BHRRZT1T2C	005306'	550040	000002	04900	        HRRZ T1,T2
BPOPJPC	005307'	263740	000000	05000	        POPJ P,         ;NEG FLAG IS SET BY TRYIDP
BDECO1IDIVIT2C	005310'	231100	000012	05100	DECO1:  IDIVI T2,^D10
BHRLMT3PC	005311'	506157	000000	05200	        HRLM T3,(P)
BSKIPET2C	005312'	332000	000002	05300	        SKIPE T2
BPUSHJPDECO1DRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 51-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	005313'	260740	005310'	05400	        PUSHJ P,DECO1
BHLRZT3PC	005314'	554157	000000	05500	        HLRZ T3,(P)
BLSHT1C	005315'	242040	000003	05600	        LSH T1,3
BADDIT1T3C	005316'	271043	000000	05700	        ADDI T1,(T3)
BPOPJPC	005317'	263740	000000	05800	        POPJ P,
BC
BTRYIDPMOVEIT5C	005320'	201240	000003	06000	TRYIDP: MOVEI T5,3      ;NUMBER OF PROTECTION FIELDS
BTDZAT4T4C	005321'	634200	000004	06100	        TDZA T4,T4      ;ACCUMULATE PROTECTION
BIDP1PUSHJPSCANC	005322'	260740	000276'	06200	IDP1:   PUSHJ P,SCAN
BTRNNFLIDFC	005323'	606000	000020	06300	        TRNN FL,IDF
BJRSTSYNERRC	005324'	254000	001065'	06400	        JRST SYNERR     ;MUST BE A NAME
BMOVET1XWDPROTABC	005325'	200040	011436'	06500	        MOVE T1,[XWD -10,PROTAB]        ;ONLY A FEW POSSIBLE
BPUSHJPSWSCANC	005326'	260740	002722'	06600	        PUSHJ P,SWSCAN
BJRSTSYNERRC	005327'	254000	001065'	06700	        JRST SYNERR     ;NOT A GOOD ONE
BJFCLC	005330'	255000	000000	06800	        JFCL
BSUBIT1PROTABC	005331'	275040	005340'	06900	        SUBI T1,PROTAB  ;CONVER TO  PROTECTION
BLSHT4C	005332'	242200	000003	07000	        LSH T4,3
BIORIT4T1C	005333'	435201	000000	07100	        IORI T4,(T1)    ;PUT IT IN
BSOJGT5IDP1C	005334'	367240	005322'	07200	        SOJG T5,IDP1    ;IF MORE, TRY AGAIN
BHRROMT4NUMACC	005335'	562200	005265*	07300	        HRROM T4,NUMAC  ;SAVE FOR COMPRT
BMOVEIT3OUTDIRC	005336'	201140	010155'	07400	        MOVEI T3,OUTDIR ;THIS GOT LOST
BPOPJPC	005337'	263740	000000	07500		POPJ P,
BC
BPROTABSIXBITC	005340'	415454	000000	07700	PROTAB: SIXBIT /ALL/
BSIXBITC	005341'	436000	000000	07800	        SIXBIT /CP/
BSIXBITC	005342'	656044	000000	07900	        SIXBIT /UPD/
BSIXBITC	005343'	416000	000000	08000	        SIXBIT /AP/
BSIXBITC	005344'	624400	000000	08100	        SIXBIT /RD/
BSIXBITC	005345'	626556	000000	08200	        SIXBIT /RUN/
BSIXBITC	005346'	545300	000000	08300	        SIXBIT /LK/
BSIXBITC	005347'	565700	000000	08400	        SIXBIT /NO/
BCOPYTROFLPIPFDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 52
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	005350'	660000	010000	00100	COPY:  TRO     FL,PIPF         ;SET PIP FLAG
BMOVEIT4ASCIZC	005351'	201200	011437'	00200	        MOVEI   T4,[ASCIZ /FROM FILE: /]
BPUSHJPPROMPTC	005352'	260740	005544'	00300	        PUSHJ   P,PROMPT        ;TYPE PROMPTING MSG IF REQ.
BPUSHJPGNMC	005353'	260740	005416'	00400	        PUSHJ   P,GNM   ;GET OLD FILE NAME
BAOBJPSVPTTMNERC	005354'	252600	001051'	00500		AOBJP	SVPT,TMNER
BDOC2MOVEIT4ASCIZC	005355'	201200	011442'	00600	DOC2:   MOVEI   T4,[ASCIZ /TO: /]
BPUSHJPPROMPTC	005356'	260740	005544'	00700	        PUSHJ   P,PROMPT        ;TYPE PROMPTING MSG IF REQ.
BTRZNFLPRMPTFC	005357'	626000	000100	00800	        TRZN    FL,PRMPTF       ;AVOID SSCAN IF MSG. TYPED
BPUSHJPSCANC	005360'	260740	000276'	00900	        PUSHJ   P,SCAN  ;IGNORE SEPARATOR
BCAINCC	005361'	306700	000053	01000	        CAIN    C,"+"
BJRSTPUSHJPGNMC				01100	        JRST    [PUSHJ  P,GNM
BMOVET1SVPPNSVPTC				01200			MOVE	T1,SVPPN-1(SVPT)
BSKIPNSVPPNSVPTC				01300			SKIPN	SVPPN(SVPT)	;DEFAULT PPN FOR + IS
BMOVEMT1SVPPNSVPTC				01400			MOVEM	T1,SVPPN(SVPT)	;WHATEVER PREVIOUS FILE HAD
BAOBJPSVPTTMNERC				01500			AOBJP	SVPT,TMNER
BJRSTDOC2C	005362'	254000	011443'	01600	                JRST    DOC2]
BPUSHJPGNMC	005363'	260740	005416'	01700	        PUSHJ   P,GNM   ;GET NEW NAME
BTLNNCSTERMFC	005364'	607640	200000	01800		TLNN CS,TERMF
BJRSTSYNERRC	005365'	254000	001065'	01900		JRST SYNERR	;MUST HAVE TERMINATOR HERE
BMOVEIT3OUTPIPC	005366'	201140	010171'	02000		MOVEI T3,OUTPIP
BMOVET4SVPTC	005367'	200200	000014	02100		MOVE T4,SVPT
BPUSHJPCMNOC	005370'	260740	003472'	02200		PUSHJ P,CMNO	;OUTPUT NAME OF OUTPUT FILE
BMOVSIT1C	005371'	205040	121612	02300		MOVSI T1,'*.*
BMOVSIT2C	005372'	205100	770000	02400		MOVSI T2,'_  '
BCAMNT1SVNAMSVPTC	005373'	316054	005251*	02500		CAMN T1,SVNAM(SVPT)
BMOVSIT2C	005374'	205100	177077	02600		MOVSI T2,'/X_'	;/X IF COPYING TO *.*
BPUSHJPOUTSIXC	005375'	260740	004206'	02700		PUSHJ P,OUTSIX	;OUTPUT _ OR /X_
BMOVEIT4C	005376'	201200	000000	02800		MOVEI T4,0
BDOC3PUSHJPCMNOC	005377'	260740	003472'	02900	DOC3:	PUSHJ P,CMNO	;OUTPUT AN INPUT FILE NAME
BCAILT4SVPTC	005400'	301214	777777	03000		CAIL T4,-1(SVPT)
BJRSTCPYDONC	005401'	254000	005405'	03100		JRST CPYDON	;DONE, CHECK FOR ANOTHER (IN COMMAND FILE)
BMOVEIT1C	005402'	201040	000054	03200		MOVEI T1,","
BPUSHJPOUTPIPC	005403'	260740	010171'	03300		PUSHJ P,OUTPIP	;ELSE A COMMA BETWEEN THEM
BAOJAT4DOC3C	005404'	344200	005377'	03400		AOJA T4,DOC3
BC
BCPYDONPUSHJPOUCRLFC	005405'	260740	010063'	03600	CPYDON:	PUSHJ P,OUCRLF	;TERMINATE THIS PIP COMMAND
BCPYDN1PUSHJPGETCHC	005406'	260740	000342'	03700	CPYDN1:	PUSHJ P,GETCH	;PEEK AHEAD AT NEXT CHARACTER
BTLNECSTERMFC	005407'	603640	200000	03800		TLNE CS,TERMF
BJRSTCPYDN1C	005410'	254000	005406'	03900		JRST CPYDN1	;IGNORE TERMINATOR (PROBABLY LINE FEED)
BCAINCC	005411'	306700	000177	04000		CAIN C,177
BJRSTOPIP2C	005412'	254000	004642'	04100		JRST OPIP2	;177 IS EOF, GO CLEAN UP
BMOVEMCSSAVCHRC	005413'	202640	002371*	04200		MOVEM CS,SAVCHR	;SOMETHING ELSE, GOT ANOTHER LINE TO DO
BMOVSISVPTNFILEC	005414'	205600	777677	04300		MOVSI SVPT,-NFILE	;RESET SVPT
BJRSTCOPYC	005415'	254000	005350'	04400		JRST COPY	;KEEP ON TRUCKIN'
BC
BC				04600	;THIS ROUTINE SCANS A FILE NAME AND CHECKS FOR THE RESERVED
BC				04700	;WORDS TELETYPE AND TERMINAL AND THEIR SUBSTRINGS.
BC
BGNMPUSHJPGETNMSC	005416'	260740	000115'	04900	GNM:	PUSHJ P,GETNMS
BCKTTYSKIPNSVEXTSVPTC	005417'	336014	004571*	05000	CKTTY:	SKIPN SVEXT(SVPT)
BSKIPESVDEVSVPTC	005420'	332014	004570*	05100		SKIPE SVDEV(SVPT)
BPOPJPC	005421'	263740	000000	05200		POPJ P,		;NO FUNNY STUFF IF DEV OR EXT GIVEN
BMOVET1C	005422'	200040	011451'	05300	        MOVE    T1,['TELETY']
BMOVET2DRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 52-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	005423'	200100	011452'	05400	        MOVE    T2,['TERMIN']
BMOVET4SVNAMSVPTC	005424'	200214	005373*	05500	        MOVE    T4,SVNAM(SVPT)
BSETZT5C	005425'	400240	000000	05600	        SETZ    T5,
BCKT1ADDIT5C	005426'	271240	000006	05700	CKT1:   ADDI    T5,6
BLSHT4C	005427'	242200	000006	05800	        LSH     T4,6
BJUMPNT4CKT1C	005430'	326200	005426'	05900	        JUMPN   T4,CKT1
BSUBIT5C	005431'	275240	000044	06000	        SUBI    T5,6*6
BMOVET4SVNAMSVPTC	005432'	200214	005424*	06100	        MOVE    T4,SVNAM(SVPT)
BLSHT1T5C	005433'	242045	000000	06200	        LSH     T1,(T5)
BLSHT2T5C	005434'	242105	000000	06300	        LSH     T2,(T5)
BLSHT4T5C	005435'	242205	000000	06400	        LSH     T4,(T5)
BCAMET2T4C	005436'	312100	000004	06500	        CAME    T2,T4
BCAMNT1T4C	005437'	316040	000004	06600	        CAMN    T1,T4           ;LOOK FOR TELETYPE OR ANY PART
BJRSTC	005440'	254000	005442'	06700		JRST .+2
BPOPJPC	005441'	263740	000000	06800		POPJ P,
BMOVSIT2C	005442'	205100	646471	06900		MOVSI T2,'TTY'	;TELETYPE, CHANGE DEVICE TO TTY:
BMOVEMT2SVDEVSVPTC	005443'	202114	005420*	07000		MOVEM T2,SVDEV(SVPT)
BSETZMSVNAMSVPTC	005444'	402014	005432*	07100		SETZM SVNAM(SVPT)
BPOPJPC	005445'	263740	000000	07200		POPJ P,
BHELPOUTSTRHELPMDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 53
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	005446'	051140	005450'	00100	HELP:	OUTSTR	HELPM
BJRSTEXC	005447'	254000	001410'	00200	        JRST    EX
BC
BHELPMASCIZC	005450'			00400	HELPM:  ASCIZ $
BC	005450'	064251	444646	00500	LIST OF VALID COMMANDS:
	005451'	521011	743100
	005452'	532031	444610
	005453'	202071	746632
	005454'	406350	451564
BC	005455'	064244	041636	00600	 COMPILE
	005456'	466411	146212
BC	005457'	064244	041644	00700	 CREATE
	005460'	426032	442432
BC	005461'	051010	442604	00800	 DEBUG
BC	005462'	526161	505100	00900	 COPY
	005463'	416372	054432
BC	005464'	051012	451262	01000	 TRY
BC	005465'	064244	041644	01100	 CROSS
BC	005466'	476472	306424	01200	 DELETE
	005467'	202110	546212
BC	005470'	522121	505100	01300	 DIRECTORY
	005471'	422232	242606
	005472'	522372	254432
BC	005473'	051010	542222	01400	 EDITOR
BC	005474'	522372	206424	01500	 EXECUTE
	005475'	202133	042606
BC	005476'	526510	506424	01600	 LOAD
	005477'	202311	740610
BC	005500'	064244	046602	01700	 MAKE
BC	005501'	456121	505100	01800	 RENAME
	005502'	512131	640632
BC	005503'	424321	220250	01900	 TECO
BC	005504'	426071	706424	02000	 TYPE
	005505'	202513	150212
BC	005506'	064244	050244	02100	 PRINT
BC	005507'	446352	406424	02200	 FILES
	005510'	202151	146212
BC	005511'	514321	220210	02300	 DECLARE
	005512'	426071	440644
BC	005513'	424321	220220	02400	 HELP
BC	005514'	426312	006424	02500	 SYSNO
	005515'	202473	151634
BC	005516'	474321	220210	02600	 DATE
BC	005517'	406510	506424	02700	 TIME
	005520'	202511	146612
BC	005521'	064244	050210	02800	 PDP10
BC	005522'	501426	006424	02900	 TYMEX
	005523'	202513	146612
BC	005524'	540321	220256	03000	 WHO
BC	005525'	442361	505246	03100	SEND
BC	005526'	426350	406424	03200	MAIL
	005527'	466031	146032
BC	005530'	052411	751650	03300	POSTMAN
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 53-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	005531'	466031	606424
BC	005532'	064240	000000	03500	$
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 54
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC
BTYMEXSKIPAT2TROT1PVTYMXC	005533'	334100	011453'	00200	TYMEX:	SKIPA	T2,[TRO T1,PVTYMX]
BPDP10MOVET2TRZT1PVTYMXC	005534'	200100	011454'	00300	PDP10:	MOVE	T2,[TRZ T1,PVTYMX]
BHRROIT1GETPRVC	005535'	561040	000006	00400		HRROI	T1,GETPRV
BGETTABT1C	005536'	047040	000041	00500		GETTAB	T1,		;GET CURRENT PRIVILEGE
BJRSTEXC	005537'	254000	001410'	00600		JRST	EX
BXCTT2C	005540'	256000	000002	00700		XCT	T2		;TURN TYMEX BIT ON OR OFF
BTRZT1PVGEXC	005541'	620040	000400	00800		TRZ	T1,PVGEX	;MAKE SURE GE BIT IS OFF
BSETPRVT1C	005542'	047040	777767	00900		SETPRV	T1,		;SET NEW PRIVILEGE
BJRSTEXC	005543'	254000	001410'	01000		JRST	EX
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 55
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;CHECKS IF END OF STORED STRING - IF SO TYPES STRING POINTED TO IN T4
BC				00200	;AND SETS PROMPT FLAG
BPROMPTPUSHJPSCANSC	005544'	260740	000256'	00300	PROMPT: PUSHJ   P,SCANS         ;GET TERM. CHAR.
BTRZFLPRMPTFC	005545'	620000	000100	00400	        TRZ     FL,PRMPTF       ;CLEAR FOR POS. PROMPT
BMOVET2SAVCHRC	005546'	200100	005413*	00500	        MOVE    T2,SAVCHR       ;GET SAVED CHAR. TO CHECK FLAGS
BTLNNT2TERMFC	005547'	607100	200000	00600	        TLNN    T2,TERMF        ;TERMINATION FLAG
BPOPJPC	005550'	263740	000000	00700	        POPJ    P,              ;NOT SET
BTRNEIOPNTC	005551'	602300	777777	00800		TRNE	IOPNT,-1
BJRSTSYNERRC	005552'	254000	001065'	00900		JRST	SYNERR		;CAN'T PROMPT WITHIN COMMAND FILE
BOUTSTRT4C	005553'	051144	000000	01000		OUTSTR	(T4)		;TYPE PROMPT MESSAGE
BPUSHJPGSTRNC	005554'	260740	001674'	01100	        PUSHJ   P,GSTRN         ;GET NEW STRING
BTROFLPRMPTFC	005555'	660000	000100	01200	        TRO     FL,PRMPTF       ;SET FLAG
BPOPJPC	005556'	263740	000000	01300	        POPJ    P,
BOCTTYPMOVEIT3C	005557'	201140	000010	01400	OCTTYP: MOVEI   T3,10   ;SET BASE TO EIGHT
BJRSTRDXTYPC	005560'	254000	005562'	01500	        JRST    RDXTYP
BRADX10MOVEIT3C	005561'	201140	000012	01600	RADX10: MOVEI   T3,12   ;BASE 10
BRDXTYPPUSHPT2C	005562'	261740	000002	01700	RDXTYP: PUSH    P,T2    ;SAVE FOR TIME
BPUSHJPPRTDIGC	005563'	260740	005566'	01800	        PUSHJ   P,PRTDIG
BPOPPT2C	005564'	262740	000002	01900	        POP     P,T2
BPOPJPC	005565'	263740	000000	02000	        POPJ    P,0
BPRTDIGIDIVT1T3C	005566'	230040	000003	02100	PRTDIG: IDIV    T1,T3
BHRLMT2PC	005567'	506117	000000	02200	        HRLM    T2,0(P)         ;SAVE DIGIT IN STACK
BSKIPET1C	005570'	332000	000001	02300	        SKIPE   T1              ;CK IF DONE
BPUSHJPPRTDIGC	005571'	260740	005566'	02400	        PUSHJ   P,PRTDIG        ;NO, GET NEXT DIGIT
BHLRZT1PC	005572'	554057	000000	02500	        HLRZ    T1,0(P)         ;TAKE DIGITS OFF STACK
BADDIT1C	005573'	271040	000060	02600	        ADDI    T1,"0"          ;CHANGE TO ASCCI
BOUTCHRT1C	005574'	051040	000001	02700	        OUTCHR  T1
BPOPJPC	005575'	263740	000000	02800	        POPJ    P,0
BTPSIXPUSHPT3C	005576'	261740	000003	02900	TPSIX:  PUSH    P,T3            ;SAVE A COUPLE REG.
BPUSHPT2C	005577'	261740	000002	03000	        PUSH    P,T2
BSKIPET3T1C	005600'	332141	000001	03100	        SKIPE   T3,1(T1)        ;IF 0,TREAT 1ST AS LAST
BJRSTTPS1C	005601'	254000	005614'	03200	        JRST    TPS1
BMOVET3T1C	005602'	200141	000000	03300	        MOVE    T3,(T1)
BTPSJUMPNT3TPS2C	005603'	326140	005607'	03400	TPS:    JUMPN   T3,TPS2
BPOPPT2C	005604'	262740	000002	03500	        POP     P,T2
BPOPPT3C	005605'	262740	000003	03600	        POP     P,T3
BPOPJPC	005606'	263740	000000	03700	        POPJ    P,
BTPS2MOVEIT2C	005607'	201100	000000	03800	TPS2:   MOVEI   T2,0
BLSHCT2C	005610'	246100	000006	03900	        LSHC    T2,6
BADDIT2C	005611'	271100	000040	04000	        ADDI    T2,40
BOUTCHRT2C	005612'	051040	000002	04100	        OUTCHR  T2
BJRSTTPSC	005613'	254000	005603'	04200	        JRST    TPS
BTPS1MOVEICSC	005614'	201640	000006	04300	TPS1:   MOVEI   CS,6
BMOVET2T1C	005615'	200101	000000	04400	        MOVE    T2,(T1)
BTPS3MOVEIT1C	005616'	201040	000000	04500	TPS3:   MOVEI   T1,0
BLSHCT1C	005617'	246040	000006	04600	        LSHC    T1,6
BADDIT1C	005620'	271040	000040	04700	        ADDI    T1,40
BOUTCHRT1C	005621'	051040	000001	04800	        OUTCHR  T1
BSOJGCSTPS3C	005622'	367640	005616'	04900	        SOJG    CS,TPS3
BJRSTTPS2C	005623'	254000	005607'	05000	        JRST    TPS2
BC
BCLUDCLOSERFLC	005624'	070240	000000	05200	CLUD:   CLOSE   RFL,            ;CLOSE USER DIR. FILE
BSTATZRFLC	005625'	063240	740000	05300	        STATZ   RFL,740000
BJRSTREADERDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 55-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	005626'	254000	001063'	05400	        JRST    READER
BPOPJPC	005627'	263740	000000	05500	        POPJ    P,0
BDECLARTROFLPIPFDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 56
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	005630'	660000	010000	00100	DECLARE: TRO   FL,PIPF         ;SET PIP OUTPUT FLAG
BMOVEIFL3C	005631'	201440	000000	00200	        MOVEI   FL3,0           ;USED FOR PROTECT BITS
BPUSHJPSCANSC	005632'	260740	000256'	00300	        PUSHJ   P,SCANS         ;CK IF PROMPTING DESIRED
BMOVECSSAVCHRC	005633'	200640	005546*	00400	        MOVE    CS,SAVCHR
BTLNNCSTERMFC	005634'	607640	200000	00500	        TLNN    CS,TERMF        ;IF TERMF, THEN END AND NEED PROMPT
BJRSTDECL2C	005635'	254000	005673'	00600	        JRST    DECL2           ;NO PROMPT
BMOVEIT1ASCIZC				00700	        MOVEI   T1,[ASCIZ /ALLOW PRIVATE:
BC	005636'	201040	011455'	00800	/]
BPUSHJPSDECLC	005637'	260740	005742'	00900	        PUSHJ   P,SDECL         ;GET PRIVATE PROTECT BITS
BMOVEIT6C	005640'	201540	000000	01000	        MOVEI   T6,0            ;STND. BITS FOR PRIVATE
BLSHT6C	005641'	242540	000006	01100	        LSH     T6,6            ;POS. FOR MERGE
BIORFL3T6C	005642'	434440	000013	01200	        IOR     FL3,T6
BMOVEIT1ASCIZC				01300	        MOVEI   T1,[ASCIZ /ACCOUNT:
BC	005643'	201040	011461'	01400	/]
BPUSHJPSDECLC	005644'	260740	005742'	01500	        PUSHJ   P,SDECL
BMOVEIT6C	005645'	201540	000004	01600	        MOVEI   T6,4            ;STND BITS FOR ACCOUNT
BLSHT6C	005646'	242540	000003	01700	        LSH     T6,3
BIORFL3T6C	005647'	434440	000013	01800	        IOR     FL3,T6
BMOVEIT1ASCIZC				01900	        MOVEI   T1,[ASCIZ /PUBLIC:
BC	005650'	201040	011464'	02000	/]
BPUSHJPSDECLC	005651'	260740	005742'	02100	        PUSHJ   P,SDECL
BMOVEIT6C	005652'	201540	000007	02200	        MOVEI   T6,7            ;STND BITS FOR PUBLIC
BIORFL3T6C	005653'	434440	000013	02300	        IOR     FL3,T6
BMOVSIT1TERMFC	005654'	205040	200000	02400		MOVSI	T1,TERMF
BMOVEMT1SAVCHRC	005655'	202040	005633*	02500		MOVEM	T1,SAVCHR	;FAKE OUT PROMPT
BDECL1MOVEIT4ASCIZC	005656'	201200	011466'	02600	DECL1:  MOVEI   T4,[ASCIZ /FILE(S): /]
BPUSHJPPROMPTC	005657'	260740	005544'	02700	        PUSHJ   P,PROMPT
BPUSHJPSPRENC	005660'	260740	005664'	02800	        PUSHJ   P,SPREN
BMOVEIFL3RENTSWC	005661'	201440	000004	02900	        MOVEI   FL3,RENTSW      ;SET RENAME SW
BPUSHJPSTTYMXC	005662'	260740	001711'	03000	        PUSHJ   P,STTYMX        ;SET TYMEX
BJRSTDOFLC	005663'	254000	004532'	03100	        JRST    DOFL
BC
BSPRENMOVEIT3OUTDIRC	005664'	201140	010155'	03300	SPREN:  MOVEI   T3,OUTDIR       ;PREPARE TO OUTPUT IN RENAME FORMAT
BMOVEIT1C	005665'	201040	000074	03400	        MOVEI   T1,"<"
BPUSHJPOUTDIRC	005666'	260740	010155'	03500	        PUSHJ   P,OUTDIR
BMOVET1FL3C	005667'	200040	000011	03600	        MOVE    T1,FL3          ;ACCUMULATED PROTECT BITS
BPUSHJPOUTNUMC	005670'	260740	007657'	03700	        PUSHJ   P,OUTNUM        ;OUTPUT IN DECIMAL FOR DIRIT
BMOVEIT1C	005671'	201040	000076	03800	        MOVEI   T1,">"
BJRSTOUTDIRC	005672'	254000	010155'	03900	        JRST	OUTDIR
BDECL2MOVEIT4C	005673'	201200	000000	04000	DECL2:  MOVEI   T4,0            ;ACCUM. BITS HERE
BMOVEIT5C	005674'	201240	000003	04100	        MOVEI   T5,3            ;3 FIELDS
BPUSHJPIDP1C	005675'	260740	005322'	04200	        PUSHJ   P,IDP1          ;GET PROT. BITS
BMOVEFL3T4C	005676'	200440	000004	04300	        MOVE    FL3,T4
BJRSTDECL1C	005677'	254000	005656'	04400	        JRST    DECL1
BC
BTYMRENAOBJPSVPTTMNERC	005700'	252600	001051'	04600	TYMREN:	AOBJP	SVPT,TMNER	;SAVE OLD NAME
BMOVEIT4ASCIZC	005701'	201200	011470'	04700	        MOVEI   T4,[ASCIZ /NEW NAME: /]
BPUSHJPPROMPTC	005702'	260740	005544'	04800	        PUSHJ   P,PROMPT        ;CK IF END OF STRING AND PROMPT REQ.
BTRZNFLPRMPTFC	005703'	626000	000100	04900	        TRZN    FL,PRMPTF       ;TEST FLAG AND SKIP OVER SEP. IF SET
BPUSHJPSCANC	005704'	260740	000276'	05000	        PUSHJ   P,SCAN          ;SKIP OVER SEPARATOR
BPUSHJPGETNMSC	005705'	260740	000115'	05100	        PUSHJ   P,GETNMS        ;GET NEW NAME
BGETPPNT1C	005706'	047040	000024	05200		GETPPN	T1,
BSKIPNSVPPNSVPTC	005707'	336014	005250*	05300		SKIPN	SVPPN(SVPT)	;USE USER'S PPN IF NONE GIVEN
BMOVEMT1SVPPNSVPTDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 56-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	005710'	202054	005707*	05400		MOVEM	T1,SVPPN(SVPT)	;TO GET AROUND DIRIT PROBLEM
BMOVEIT3OUTDIRC	005711'	201140	010155'	05500		MOVEI	T3,OUTDIR
BMOVET4SVPTC	005712'	200200	000014	05600		MOVE	T4,SVPT
BPUSHJPCMNOC	005713'	260740	003472'	05700		PUSHJ	P,CMNO		;OUTPUT NEW NAME
BMOVEIT1C	005714'	201040	000137	05800	        MOVEI   T1,"_"
BPUSHJPOUTDIRC	005715'	260740	010155'	05900	        PUSHJ   P,OUTDIR
BMOVEIT4C	005716'	201200	000000	06000		MOVEI	T4,0
BPUSHJPCMNOC	005717'	260740	003472'	06100		PUSHJ	P,CMNO		;OUTPUT OLD NAME
BTROFL3RENTSWC	005720'	660440	000004	06200	        TRO     FL3,RENTSW      ;SET RENAME SW
BRENMPUSHJPSCANC	005721'	260740	000276'	06300	RENM:   PUSHJ   P,SCAN          ;LOOK FOR POSSIBLE SWITCHES
BTRNNFLIDFC	005722'	606000	000020	06400	        TRNN    FL,IDF
BCAIECC	005723'	302700	000057	06500	        CAIE    C,"/"
BJRSTRENM1C	005724'	254000	005736'	06600	        JRST    RENM1
BPUSHJPSCANC	005725'	260740	000276'	06700	        PUSHJ   P,SCAN
BTRNNFLIDFC	005726'	606000	000020	06800	        TRNN    FL,IDF
BJRSTSYNERRC	005727'	254000	001065'	06900	        JRST    SYNERR
BMOVET1XWDDIRLGDIRTABC	005730'	200040	011417'	07000	        MOVE    T1,[XWD -DIRLG,DIRTAB]
BPUSHJPSWSCANC	005731'	260740	002722'	07100	        PUSHJ   P,SWSCAN
BJRSTSWHELPC	005732'	254000	004646'	07200	        JRST    SWHELP
BJFCLC	005733'	255000	000000	07300	        JFCL
BXCTDIRT2DIRTABT1C	005734'	256001	000034	07400	        XCT     DIRT2-DIRTAB(T1)
BJRSTRENMC	005735'	254000	005721'	07500	        JRST    RENM
BRENM1MOVEIT3OUTDIRC	005736'	201140	010155'	07600	RENM1:  MOVEI   T3,OUTDIR
BTLNNCSTERMFC	005737'	607640	200000	07700	        TLNN    CS,TERMF
BJRSTSYNERRC	005740'	254000	001065'	07800	        JRST    SYNERR
BJRSTOSWDC	005741'	254000	004625'	07900	        JRST    OSWD
BSDECLMOVEIT6DRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 57
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	005742'	201540	000007	00100	SDECL: MOVEI   T6,7            ;START WITH NOTHING
BOUTSTRT1C	005743'	051141	000000	00200		OUTSTR	(T1)
BMOVEIT1ASCIZC	005744'	201040	011473'	00300	        MOVEI   T1,[ASCIZ /  MODIFY? /]
BPUSHJPYNC	005745'	260740	006005'	00400	        PUSHJ   P,YN
BJRSTSDMC	005746'	254000	005762'	00500	        JRST    SDM
BMOVEIT1ASCIZC	005747'	201040	011476'	00600	        MOVEI   T1,[ASCIZ /  READ(RD)? /]
BPUSHJPYNC	005750'	260740	006005'	00700	        PUSHJ   P,YN
BJRSTSD4C	005751'	254000	006001'	00800	        JRST    SD4
BMOVEIT1ASCIZC	005752'	201040	011501'	00900	        MOVEI   T1,[ASCIZ /  RUN(RUN)? /]
BPUSHJPYNC	005753'	260740	006005'	01000	        PUSHJ   P,YN
BJRSTSD5C	005754'	254000	006002'	01100	        JRST    SD5
BMOVEIT1ASCIZC	005755'	201040	011504'	01200	        MOVEI   T1,[ASCIZ /  LOOKUP(LK)? /]
BPUSHJPYNC	005756'	260740	006005'	01300	        PUSHJ   P,YN
BJRSTSD6C	005757'	254000	006003'	01400	        JRST    SD6
BOUTSTRASCIZC				01500	        OUTSTR	[ASCIZ /  NOTHING(NO)
BC	005760'	051140	011507'	01600	/]
BJRSTCPOPJ1C	005761'	254000	002747'	01700	        JRST    CPOPJ1
BSDMMOVEIT1ASCIZC	005762'	201040	011513'	01800	SDM:    MOVEI   T1,[ASCIZ /  RENAME & DELETE(ALL)? /]
BPUSHJPYNC	005763'	260740	006005'	01900	        PUSHJ   P,YN
BJRSTSD0C	005764'	254000	005775'	02000	        JRST    SD0
BMOVEIT1ASCIZC	005765'	201040	011520'	02100	        MOVEI   T1,[ASCIZ /  CHANGE PROT.(CP)? /]
BPUSHJPYNC	005766'	260740	006005'	02200	        PUSHJ   P,YN
BJRSTSD1C	005767'	254000	005776'	02300	        JRST    SD1
BMOVEIT1ASCIZC	005770'	201040	011525'	02400	        MOVEI   T1,[ASCIZ /  UPDATE(UPD)? /]
BPUSHJPYNC	005771'	260740	006005'	02500	        PUSHJ   P,YN
BJRSTSD2C	005772'	254000	005777'	02600	        JRST    SD2
BOUTSTRASCIZC				02700	        OUTSTR	[ASCIZ /  APPEND(AP)
BC	005773'	051140	011531'	02800	/]
BJRSTSD3C	005774'	254000	006000'	02900	        JRST    SD3
BSD0SUBIT6C	005775'	275540	000001	03000	SD0:    SUBI    T6,1
BSD1SUBIT6C	005776'	275540	000001	03100	SD1:    SUBI    T6,1
BSD2SUBIT6C	005777'	275540	000001	03200	SD2:    SUBI    T6,1
BSD3SUBIT6C	006000'	275540	000001	03300	SD3:    SUBI    T6,1
BSD4SUBIT6C	006001'	275540	000001	03400	SD4:    SUBI    T6,1
BSD5SUBIT6C	006002'	275540	000001	03500	SD5:    SUBI    T6,1
BSD6SUBIT6C	006003'	275540	000001	03600	SD6:    SUBI    T6,1
BJRSTCPOPJ1C	006004'	254000	002747'	03700	        JRST    CPOPJ1
BC
BYNOUTSTRT1C	006005'	051141	000000	03900	YN:	OUTSTR	(T1)
BYN4PUSHJPGSTRNC	006006'	260740	001674'	04000	YN4:	PUSHJ	P,GSTRN
BYN1PUSHJPGETCHC	006007'	260740	000342'	04100	YN1:    PUSHJ   P,GETCH
BJUMPECSYN1C	006010'	322640	006007'	04200	        JUMPE   CS,YN1
BCAINCC	006011'	306700	000015	04300	        CAIN    C,15
BJRSTYN1C	006012'	254000	006007'	04400	        JRST    YN1
BYN2TLNECSTERMFC	006013'	603640	200000	04500	YN2:    TLNE    CS,TERMF
BJRSTYN4C	006014'	254000	006006'	04600	        JRST    YN4             ;END OF LINE, GET ANOTHER
BHRRZCCSC	006015'	550700	000015	04700		HRRZ	C,CS
BSETZBCSSAVCHRC	006016'	403640	005655*	04800		SETZB	CS,SAVCHR
BCAINCC	006017'	306700	000056	04900	        CAIN    C,56            ;TEST FOR N
BJRSTCPOPJ1C	006020'	254000	002747'	05000	        JRST    CPOPJ1
BCAINCC	006021'	306700	000071	05100	        CAIN    C,71            ;TEST FOR Y
BPOPJPC	006022'	263740	000000	05200	        POPJ    P,0
BCAIECC	006023'	302700	000055	05300	        CAIE    C,"-"
BJRSTYN5DRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 57-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	006024'	254000	006027'	05400	        JRST    YN5
BPOPPPC	006025'	262757	000000	05500		POP	P,(P)		;MAKE RETURN GO ONE LOWER
BPOPJPC	006026'	263740	000000	05600	        POPJ    P,0
BYN5OUTSTRASCIZC	006027'	051140	011534'	05700	YN5:	OUTSTR	[ASCIZ/WHAT? /]
BJRSTYN4C	006030'	254000	006006'	05800	        JRST    YN4
BC
BC
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 58
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;PRINTS PROJECT-PROGRAMMER (ACCOUNT-PROG.) NO
BPPNMOVEIT4ASCIZC	006031'	201200	011536'	00200	PPN:    MOVEI   T4,[ASCIZ /USER NAME: /]
BPUSHJPPROMPTC	006032'	260740	005544'	00300	        PUSHJ   P,PROMPT        ;CK IF PROMPT, THEN TYPE
BPUSHJPGTUNOC	006033'	260740	006036'	00400	        PUSHJ   P,GTUNO         ;GET USER NO.
BPUSHJPTPPPNC	006034'	260740	006156'	00500	        PUSHJ   P,TPPPN         ;GO TYPE
BJRSTEXC	006035'	254000	001410'	00600	        JRST    EX
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 59
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;TAKES NAME AND VERIFIES IF VALID
BC				00200	;RETURNS USER NO. IN T3
BGTUNOMOVEIT5C	006036'	201240	000000	00300	GTUNO:  MOVEI   T5,0            ;IN CASE 6 OR LESS CHARS.
BPUSHJPSCANWC	006037'	260740	006200'	00400	        PUSHJ   P,SCANW         ;GET FIRST 6
BJRSTGTU1C	006040'	254000	006047'	00500	        JRST    GTU1            ;FOUND A TERMINATOR
BMOVET4ACCUMC	006041'	200200	004446*	00600	        MOVE    T4,ACCUM        ;SAVE FIRST WORD OF NAME
BPUSHJPSCANWC	006042'	260740	006200'	00700	        PUSHJ   P,SCANW
BJRSTGTU2C	006043'	254000	006046'	00800	        JRST    GTU2            ;A TERM.CHAR.
BPUSHJPGETCHC	006044'	260740	000342'	00900	        PUSHJ   P,GETCH         ;CK. NEXT CHAR
BJUMPGCSSYNERRC	006045'	327640	001065'	01000	        JUMPG   CS,SYNERR       ;ERROR, MUST BE TERM.
BGTU2SKIPAT5ACCUMC	006046'	334240	006041*	01100	GTU2:	SKIPA	T5,ACCUM	;2ND WORD OF NAME
BGTU1MOVET4ACCUMC	006047'	200200	006046*	01200	GTU1:   MOVE    T4,ACCUM
BMOVET1NMLSTPC	006050'	200040	004050*	01300		MOVE	T1,NMLSTP	;TOP OF NAMELIST
BMOVEMT4NAMES1T1C	006051'	202201	002325*	01400		MOVEM	T4,NAMES1+1(T1)	;SAVE NAME ABOVE TOP IN CASE WE
BMOVEMT5NAMES2T1C	006052'	202241	002331*	01500		MOVEM	T5,NAMES2+1(T1)	;WANT TO ADD THIS NAME TO LOST
BGTU3CAMNT4NAMES1T1C	006053'	316201	004014*	01600	GTU3:	CAMN	T4,NAMES1(T1)
BCAMET5NAMES2T1C	006054'	312241	004015*	01700		CAME	T5,NAMES2(T1)	;CHECK FOR PRESENCE OF NAME IN LIST
BJRSTGTU4C	006055'	254000	006060'	01800		JRST	GTU4
BMOVET3PPNST1C	006056'	200141	004017*	01900		MOVE	T3,PPNS(T1)	;FOUND IT, WE SAVED A LOT OF DISK I/O
BPOPJPC	006057'	263740	000000	02000		POPJ	P,
BGTU4SOJGET1GTU3C	006060'	365040	006053'	02100	GTU4:	SOJGE	T1,GTU3		;NO MATCH, TRY SOME MORE
BPUSHJPOPUDC	006061'	260740	006164'	02200		PUSHJ	P,OPUD		;NO MATCH ANYWHERE, HAVE TO TRY THE LUD
BPUSHJPLKLUDC	006062'	260740	006077'	02300	        PUSHJ   P,LKLUD
BJRSTBADNAMC	006063'	254000	006073'	02400	        JRST    BADNAM
BMOVET3BUFLDPPNT1C	006064'	200141	000000*	02500	        MOVE    T3,BUF+LDPPN(T1)
BMOVET1NMLSTPC	006065'	200040	006050*	02600		MOVE	T1,NMLSTP
BMOVEMT3PPNST1C	006066'	202141	002333*	02700		MOVEM	T3,PPNS+1(T1)	;SAVE THIS PPN IN NAMELIST
BSETZMUFDST1C	006067'	402001	000000*	02800		SETZM	UFDS+1(T1)
BCAIGET1NMLSTLC	006070'	305040	000007	02900		CAIGE	T1,NMLSTL-1
BAOSNMLSTPC	006071'	350000	006065*	03000		AOS	NMLSTP		;SHOW NEW ENTRY UNLESS TABLE FULL
BPOPJPC	006072'	263740	000000	03100	        POPJ    P,0
BC
BBADNAMOUTSTRASCIZC	006073'	051140	011541'	03300	BADNAM: OUTSTR	[ASCIZ /NO USER NAMED: /]
BMOVEIT1T4C	006074'	201040	000004	03400	        MOVEI   T1,T4
BPUSHJPTPSIXC	006075'	260740	005576'	03500	        PUSHJ   P,TPSIX
BJRSTEXC	006076'	254000	001410'	03600	        JRST    EX
BC
BC				03800	;LOOK UP NAME IN LUD
BC				03900	;EXPECTS NAME IN T4,T5
BC				04000	;FILE MUST BE OPEN
BC				04100	;NO SKIP RETURN IF NOT IN LUD
BC				04200	;T1 RETURNS WITH INDEX INTO BUF
BLKLUDMOVEMFL2SVACC	006077'	202400	000000*	04300	LKLUD:  MOVEM   FL2,SVAC        ;SAVE SOME ACCUM.
BMOVEFL2XWDFL3SVACC	006100'	200400	011545'	04400	        MOVE    FL2,[XWD FL3,SVAC+1]
BBLTFL2SVACC	006101'	251400	000000*	04500	        BLT     FL2,SVAC+6
BMOVEICC	006102'	201700	000000	04600	        MOVEI   C,0
BMOVET1C	006103'	200040	011546'	04700	        MOVE    T1,[555555555555]
BMOVET2C	006104'	200100	011547'	04800	        MOVE    T2,[361275431652]
BMOVET3C	006105'	200140	011550'	04900	        MOVE    T3,[612754316523]
BPUSHJPRNDC	006106'	260740	006140'	05000	        PUSHJ   P,RND
BPUSHJPRNDC	006107'	260740	006140'	05100	        PUSHJ   P,RND
BPUSHJPRNDC	006110'	260740	006140'	05200	        PUSHJ   P,RND
BPUSHJPRNDC	006111'	260740	006140'	05300	        PUSHJ   P,RND
BXORT2T3DRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 59-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	006112'	430100	000003	05400	        XOR     T2,T3
BXORT1T2C	006113'	430040	000002	05500	        XOR     T1,T2
BTLZT2C	006114'	621100	400000	05600	        TLZ     T2,400000
BIDIVIT2C	006115'	231100	001567	05700	        IDIVI   T2,^D887
BMOVET2T1C	006116'	200100	000001	05800	        MOVE    T2,T1
BSRUSPUSHJPRDBLKC	006117'	260740	006237'	05900	SRUS:   PUSHJ   P,RDBLK
BMOVEIT1C	006120'	201040	000000	06000	        MOVEI   T1,0
BSRUSRCAMET2BUFLHUNT1C	006121'	312101	000000*	06100	SRUSR:  CAME    T2,BUF+LHUN(T1)
BJRSTNUSERC	006122'	254000	006127'	06200	        JRST    NUSER
BAOSPC	006123'	350017	000000	06300	        AOS     0(P)
BLKLUDEMOVECXWDSVACFL2C	006124'	200700	011551'	06400	LKLUDE: MOVE    C,[XWD SVAC,FL2]        ;RESTORE ACCUM.
BBLTCCC	006125'	251700	000016	06500	        BLT     C,C
BPOPJPC	006126'	263740	000000	06600	        POPJ    P,0
BNUSERSKIPGT6BUFLDPPNT1C	006127'	337541	006064*	06700	NUSER:  SKIPG   T6,BUF+LDPPN(T1)
BJRSTBLKLNKC	006130'	254000	006135'	06800	        JRST    BLKLNK
BMOVET6BUFLLINKT1C	006131'	200541	000000*	06900	        MOVE    T6,BUF+LLINK(T1)
BANDIT6C	006132'	405540	000177	07000	        ANDI    T6,177
BADDT1T6C	006133'	270040	000013	07100	        ADD     T1,T6
BJRSTSRUSRC	006134'	254000	006121'	07200	        JRST    SRUSR
BBLKLNKJUMPET6LKLUDEC	006135'	322540	006124'	07300	BLKLNK: JUMPE   T6,LKLUDE       
BMOVET3T6C	006136'	200140	000013	07400	        MOVE    T3,T6
BJRSTSRUSC	006137'	254000	006117'	07500	        JRST    SRUS
BC
BRNDADDT2T4C	006140'	270100	000004	07700	RND:    ADD     T2,T4
BROTCT4C	006141'	245200	777756	07800	        ROTC    T4,-22
BMOVEICSC	006142'	201640	000005	07900	        MOVEI   CS,5
BRND1MOVET6T2CC	006143'	200556	000002	08000	RND1:   MOVE    T6,T2(C)
BMULT6C	006144'	224540	011552'	08100	        MUL     T6,[5*5*5*5*5*5*5*5*5*5*5*5*5*5*5]
BADDMT7T3CC	006145'	272616	000003	08200	        ADDM    T7,T3(C)
BAOJECRND2C	006146'	342700	006154'	08300	        AOJE    C,RND2
BMOVNICC	006147'	211700	000001	08400	        MOVNI   C,1
BTRNET2C	006150'	602100	000001	08500	        TRNE    T2,1
BSKIPLT3C	006151'	331000	000003	08600	        SKIPL   T3
BMOVEICC	006152'	201700	000000	08700	        MOVEI   C,0
BEXCHT1T3C	006153'	250040	000003	08800	        EXCH    T1,T3
BRND2SOJGCSRND1C	006154'	367640	006143'	08900	RND2:   SOJG    CS,RND1
BPOPJPC	006155'	263740	000000	09000	        POPJ    P,0
BTPPPNHLRZT1T3DRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 60
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	006156'	554040	000003	00100	TPPPN: HLRZ    T1,T3           ;TYPE NO. IN T3
BMOVET4T3C	006157'	200200	000003	00200	        MOVE    T4,T3
BPUSHJPOCTTYPC	006160'	260740	005557'	00300	        PUSHJ   P,OCTTYP
BOUTCHRC	006161'	051040	011553'	00400		OUTCHR	[","]
BHRRZT1T4C	006162'	550040	000004	00500	        HRRZ    T1,T4
BJRSTOCTTYPC	006163'	254000	005557'	00600		JRST	OCTTYP
BC
BOPUDPUSHPT4C	006164'	261740	000004	00800	OPUD:	PUSH	P,T4
BINITRFLC	006165'	041240	000017	00900		INIT	RFL,17
BSIXBITC	006166'	637163	000000	01000	        SIXBIT  /SYS/
BXWDC	006167'	000000	000000	01100	        XWD     0,0
BEXITC	006170'	047000	000012	01200		EXIT
BMOVET1SIXBITC	006171'	200040	011554'	01300	        MOVE    T1,[SIXBIT /LUD/]
BMOVSIT2SIXBITC	006172'	205100	637163	01400	        MOVSI   T2,(SIXBIT /SYS/)
BSETZBT3T4C	006173'	403140	000004	01500	        SETZB   T3,T4
BLOOKUPRFLT1C	006174'	076240	000001	01600	        LOOKUP  RFL,T1
BMESSJRSTOUTSTRASCIZC				01700		MESS	<CAN'T OPEN LUD>^JRST [OUTSTR [ASCIZ "CAN'T OPEN LUD"]
BJRSTEXC	006175'	254000	011560'		                JRST    EX]^
BPOPPT4C	006176'	262740	000004	01800		POP	P,T4
BPOPJPC	006177'	263740	000000	01900	        POPJ    P,0
BC
BSCANWSETZMACCUMC	006200'	402000	006047*	02100	SCANW:  SETZM   ACCUM   ;GATHERS 6 CHARS.
BMOVET1POINTACCUMC	006201'	200040	011040'	02200	        MOVE    T1,[POINT 6,ACCUM]
BSKIPNCSSAVCHRC	006202'	336640	006016*	02300	        SKIPN   CS,SAVCHR       ;USE SAVED CHAR IF ONE
BJRSTSCW1C	006203'	254000	006206'	02400	        JRST    SCW1    ;NO SAVED, GO GET ONE
BSETZMSAVCHRC	006204'	402000	006202*	02500	        SETZM   SAVCHR  ;DONT USE AGAIN
BJRSTC	006205'	254000	006207'	02600	        JRST    .+2     ;DONT GET ANOTHER
BSCW1PUSHJPGETCHC	006206'	260740	000342'	02700	SCW1:   PUSHJ   P,GETCH
BJUMPLECSSCW3C	006207'	323640	006214'	02800	        JUMPLE  CS,SCW3         ;TERM CHAR
BSCW2IDPBCST1C	006210'	136640	000001	02900	SCW2:   IDPB    CS,T1
BTLNET1C	006211'	603040	770000	03000	        TLNE    T1,770000       ;CK IF 6 CHARS. STORED
BJRSTSCW1C	006212'	254000	006206'	03100	        JRST    SCW1            ;NOT YET
BJRSTCPOPJ1C	006213'	254000	002747'	03200		JRST	CPOPJ1		;SKIP RETURN FOR NO TERM CHAR
BSCW3CAIECC	006214'	302700	000015	03300	SCW3:   CAIE    C,15            ;CAR. RET. FOR TERM.
BCAMNCSCTBLC	006215'	316640	000417'	03400	        CAMN    CS,CTBL+12              ;DAS IST SEHR SCHMART, JA!
BPOPJPC	006216'	263740	000000	03500	        POPJ    P,0
BCAIECC	006217'	302700	000072	03600		CAIE	C,":"
BCAINCC	006220'	306700	000073	03700	        CAIN    C,";"           ;VALID TERMINATOR
BPOPJPC	006221'	263740	000000	03800	        POPJ    P,0
BCAINCC	006222'	306700	000051	03900	        CAIN    C,")"
BPOPJPC	006223'	263740	000000	04000	        POPJ    P,0
BSUBICC	006224'	275700	000040	04100	        SUBI    C,40            ;CHANGE TO 6 BIT
BTRNECC	006225'	602700	000100	04200	        TRNE    C,100           ;CK NO. OF BITS
BPOPJPC	006226'	263740	000000	04300	        POPJ    P,0             ;MUST BE FUNNY TERM.
BMOVECSCC	006227'	200640	000016	04400	        MOVE    CS,C
BJRSTSCW2C	006230'	254000	006210'	04500	        JRST    SCW2
BC
BWTBLKUSETORFLT3C	006231'	075243	000001	04700	WTBLK:  USETO   RFL,1(T3)
BOUTPUTRFLHEDC	006232'	067240	000000*	04800	        OUTPUT  RFL,HED
BSTATORFLC	006233'	061240	740000	04900	        STATO   RFL,740000
BPOPJPC	006234'	263740	000000	05000	        POPJ    P,0
BOUTSTRASCIZC	006235'	051140	011562'	05100		OUTSTR	[ASCIZ/OUTPUT ERROR/]
BJRSTBYENOWC	006236'	254000	001110'	05200		JRST	BYENOW
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 60-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC
BRDBLKUSETIRFLT3C	006237'	074243	000001	05400	RDBLK:  USETI   RFL,1(T3)
BINPUTRFLHEDC	006240'	066240	006232*	05500	        INPUT   RFL,HED
BSTATORFLC	006241'	061240	760000	05600	        STATO   RFL,760000
BPOPJPC	006242'	263740	000000	05700	        POPJ    P,0
BMOVSIT1C	006243'	205040	777600	05800	        MOVSI   T1,-200
BSETZMBUFT1C	006244'	402001	006127*	05900	        SETZM   BUF(T1)
BAOBJNT1C	006245'	253040	006244'	06000	        AOBJN   T1,.-1
BMOVEIT1C	006246'	201040	000000	06100	        MOVEI   T1,0            ;SW
BPOPJPC	006247'	263740	000000	06200	        POPJ    P,0
BDODATEDATET1DRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 61
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	006250'	047040	000014	00100	DODATE:        DATE    T1,             ;GET DATE FROM MONITOR
BPUSHJPTDATEC	006251'	260740	006255'	00200	        PUSHJ   P,TDATE
BTIMERT1C	006252'	047040	000022	00300	        TIMER   T1,             ;RECOVER TIME IN MILLISEC
BPUSHJPPRTIM1C	006253'	260740	006307'	00400	        PUSHJ   P,PRTIM1
BJRSTEXC	006254'	254000	001410'	00500	        JRST    EX
BC
BTDATEIDIVIT1C	006255'	231040	000037	00700	TDATE:  IDIVI   T1,^D31         ;GET MONTH
BMOVEIT3T2C	006256'	201142	000001	00800		MOVEI	T3,1(T2)
BMOVET2T1C	006257'	200100	000001	00900		MOVE	T2,T1
BMOVEIT1C	006260'	201040	000000	01000	        MOVEI   T1,0
BDIVIT1C	006261'	235040	000014	01100	        DIVI    T1,^D12         ;SEPARATE MONTH FROM YEAR
BOUTSTRMONTHT2C	006262'	051142	006273'	01200		OUTSTR	MONTH(T2)
BMOVET2T1C	006263'	200100	000001	01300		MOVE	T2,T1
BMOVET1T3C	006264'	200040	000003	01400		MOVE	T1,T3
BPUSHJPRADX10C	006265'	260740	005561'	01500	        PUSHJ   P,RADX10        ;TYPE DAY
BOUTSTRASCIZC	006266'	051140	011565'	01600	        OUTSTR	[ASCIZ /, 19/]
BMOVEIT1T2C	006267'	201042	000100	01700	        MOVEI   T1,^D64(T2)     ;YEAR 64 IS 0
BPUSHJPRADX10C	006270'	260740	005561'	01800	        PUSHJ   P,RADX10        ;TYPE YEAR
BOUTSTRASCIZC	006271'	051140	011566'	01900		OUTSTR	[ASCIZ/  /]
BPOPJPC	006272'	263740	000000	02000	        POPJ    P,
BMONTHASCIZC	006273'	452031	620000	02100	MONTH:  ASCIZ "JAN "
BASCIZC	006274'	432130	220000	02200	        ASCIZ "FEB "
BASCIZC	006275'	466032	220000	02300	        ASCIZ "MAR "
BASCIZC	006276'	406412	220000	02400	        ASCIZ "APR "
BASCIZC	006277'	466033	120000	02500	        ASCIZ "MAY "
BASCIZC	006300'	452531	620000	02600	        ASCIZ "JUN "
BASCIZC	006301'	452531	420000	02700	        ASCIZ "JUL "
BASCIZC	006302'	406530	720000	02800	        ASCIZ "AUG "
BASCIZC	006303'	516132	020000	02900	        ASCIZ "SEP "
BASCIZC	006304'	476072	420000	03000	        ASCIZ "OCT "
BASCIZC	006305'	472372	620000	03100	        ASCIZ "NOV "
BASCIZC	006306'	422130	320000	03200	        ASCIZ "DEC "
BC
BPRTIM1IDIVIT1C	006307'	231040	007020	03400	PRTIM1: IDIVI   T1,^D3600               ;CHANGE JIFFIES TO MINS.
BIDIVIT1C	006310'	231040	000074	03500	        IDIVI   T1,^D60         ;HRS IN T1, MIN IN T2
BPUSHJPRADX10C	006311'	260740	005561'	03600	        PUSHJ   P,RADX10        ;TYPE HOURS
BOUTCHRC	006312'	051040	011567'	03700	        OUTCHR  [":"]
BCAIGT2C	006313'	307100	000011	03800	        CAIG    T2,11
BOUTCHRC	006314'	051040	011570'	03900	        OUTCHR  ["0"]
BMOVET1T2C	006315'	200040	000002	04000	        MOVE    T1,T2
BJRSTRADX10C	006316'	254000	005561'	04100	        JRST    RADX10          ;TYPE MINUTES AND RETURN
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 62
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;SET FILE DIRECTORY CONTROLS
BFDCMOVEIT6C	006317'	201540	000070	00200	FDC:    MOVEI   T6,70           ;STANDARD OPTIONS, PRIVATE
BMOVEIT1ASCIZC				00300	        MOVEI   T1,[ASCIZ /ALLOW ACCOUNT:
BC	006320'	201040	011571'	00400	/]
BPUSHJPSFDCC	006321'	260740	006337'	00500	        PUSHJ   P,SFDC
BMOVEIT7C	006322'	201600	000005	00600	        MOVEI   T7,5            ;STANDARD OPTIONS
BORT6T7C	006323'	434540	000014	00700	        OR      T6,T7
BLSHT6C	006324'	242540	000003	00800	        LSH     T6,3
BMOVEIT1ASCIZC				00900	        MOVEI   T1,[ASCIZ /PUBLIC:
BC	006325'	201040	011464'	01000	/]
BPUSHJPSFDCC	006326'	260740	006337'	01100	        PUSHJ   P,SFDC
BMOVEIT7C	006327'	201600	000000	01200	        MOVEI   T7,0            ;STANDARD OPTIONS
BORT6T7C	006330'	434540	000014	01300	        OR      T6,T7
BPUSHJPOPMFDC	006331'	260740	006375'	01400	        PUSHJ   P,OPMFD
BDPBT6POINTT3C	006332'	137540	011575'	01500	        DPB     T6,[POINT 9,T3,8]
BMOVET4XWDC	006333'	200200	011024'	01600	        MOVE    T4,[XWD 1,1]
BRENAMERFLT1C	006334'	055240	000001	01700	        RENAME  RFL,T1
BFDERROUTSTRASCIZC	006335'	051140	011576'	01800	FDERR:	OUTSTR	[ASCIZ/FD ERROR/]
BJRSTEXC	006336'	254000	001410'	01900	        JRST    EX
BC
BSFDCOUTSTRT1C	006337'	051141	000000	02100	SFDC:	OUTSTR	(T1)
BMOVEIT7C	006340'	201600	000000	02200	        MOVEI   T7,0
BMOVEIT1ASCIZC	006341'	201040	011600'	02300	        MOVEI   T1,[ASCIZ /  SHARABLE? /]
BPUSHJPYNC	006342'	260740	006005'	02400	        PUSHJ   P,YN
BTROT7C	006343'	660600	000004	02500	        TRO     T7,4
BMOVEIT1ASCIZC	006344'	201040	011603'	02600	        MOVEI   T1,[ASCIZ /  NEW FILES? /]
BPUSHJPYNC	006345'	260740	006005'	02700	        PUSHJ   P,YN
BTROT7C	006346'	660600	000002	02800	        TRO     T7,2
BMOVEIT1ASCIZC	006347'	201040	011606'	02900	        MOVEI   T1,[ASCIZ /  LISTABLE? /]
BPUSHJPYNC	006350'	260740	006005'	03000	        PUSHJ   P,YN
BTROT7C	006351'	660600	000001	03100	        TRO     T7,1
BJRSTCPOPJ1C	006352'	254000	002747'	03200	        JRST    CPOPJ1
BC
BC				03400	;PRINT FILE DIRECTORY CONTROLS
BPFDCPUSHJPOPMFDC	006353'	260740	006375'	03500	PFDC:   PUSHJ   P,OPMFD
BMOVEIT1ASCIZC				03600	        MOVEI   T1,[ASCIZ /
BC	006354'	201040	011611'	03700	ACCOUNT: /]
BLSHCT2C	006355'	246100	000006	03800	        LSHC    T2,6
BPUSHJPTFDCC	006356'	260740	006363'	03900	        PUSHJ   P,TFDC
BMOVEIT1ASCIZC				04000	        MOVEI   T1,[ASCIZ /
BC	006357'	201040	011614'	04100	PUBLIC: /]
BLSHCT2C	006360'	246100	000003	04200	        LSHC    T2,3
BPUSHJPTFDCC	006361'	260740	006363'	04300	        PUSHJ   P,TFDC
BJRSTEXC	006362'	254000	001410'	04400	        JRST    EX
BC
BTFDCTRNNT2C	006363'	606100	000007	04600	TFDC:   TRNN    T2,7
BPOPJPC	006364'	263740	000000	04700	        POPJ    P,
BOUTSTRT1C	006365'	051141	000000	04800		OUTSTR	(T1)
BTRNET2C	006366'	602100	000004	04900	        TRNE    T2,4
BOUTSTRASCIZC	006367'	051140	011617'	05000		OUTSTR	[ASCIZ/SHARABLE /]
BTRNET2C	006370'	602100	000002	05100	        TRNE    T2,2
BOUTSTRASCIZC	006371'	051140	011621'	05200		OUTSTR	[ASCIZ/NEW FILES /]
BTRNET2C	006372'	602100	000001	05300	        TRNE    T2,1
BOUTSTRASCIZDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 62-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	006373'	051140	011624'	05400		OUTSTR	[ASCIZ/LISTABLE/]
BPOPJPC	006374'	263740	000000	05500	        POPJ    P,0
BC
BOPMFDINITRFLC	006375'	041240	000017	05700	OPMFD:  INIT    RFL,17
BSIXBITC	006376'	446353	000000	05800	        SIXBIT  /DSK/
BC	006377'	000000	000000	05900	        0
BHALTC	006400'	254200	000000	06000	        HALT
BGETPPNT1C	006401'	047040	000024	06100	        GETPPN  T1,
BMOVSIT2SIXBITC	006402'	205100	654644	06200	        MOVSI   T2,(SIXBIT /UFD/)
BMOVEIT3C	006403'	201140	000000	06300	        MOVEI   T3,0
BMOVET4XWDC	006404'	200200	011024'	06400	        MOVE    T4,[XWD 1,1]
BLOOKUPRFLT1C	006405'	076240	000001	06500	        LOOKUP  RFL,T1
BJRSTFDERRC	006406'	254000	006335'	06600		JRST	FDERR
BPOPJPC	006407'	263740	000000	06700	        POPJ    P,
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 63
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;SEND MAIL - PUTS MAIL IN FILE "MBX"
BSENDSETZMSVJBFFC	006410'	402000	004241*	00200	SEND:   SETZM   SVJBFF
BSETZMNAMCTC	006411'	402000	000000*	00300	        SETZM   NAMCT   ;NAME COUNT
BMOVEIT4ASCIZC	006412'	201200	011442'	00400	        MOVEI   T4,[ASCIZ /TO: /]
BPUSHJPPROMPTC	006413'	260740	005544'	00500	        PUSHJ   P,PROMPT
BSN1PUSHJPGTUNOC	006414'	260740	006036'	00600	SN1:    PUSHJ   P,GTUNO         ;CKS NAME IN LUD,SYNERR IF BAD
BCLOSERFLC	006415'	070240	000000	00700		CLOSE	RFL,		;GET RID OF LUD
BSKIPNT3SVJBFFC	006416'	336140	006410*	00800	        SKIPN   T3,SVJBFF       ;CK FOR SPACE
BHRRZT3JOBFFC	006417'	550140	004077*	00900	        HRRZ    T3,JOBFF
BHRRZT1JOBRELC	006420'	550040	002307*	01000	        HRRZ    T1,JOBREL
BCAILT1T3C	006421'	301043	000105	01100	        CAIL    T1,105(T3)
BJRSTC	006422'	254000	006426'	01200	        JRST    .+4             ;STILL ROOM
BMOVEIT2T1C	006423'	201101	002000	01300	        MOVEI   T2,2000(T1)     ;GET MORE CORE
BCORET2C	006424'	047100	000011	01400	        CORE    T2,
BHALTC	006425'	254200	006425'	01500	        HALT    .               ;SHOULDN'T FAIL TO GET SPACE
BMOVEMT4T3C	006426'	202203	000000	01600	        MOVEM   T4,(T3)         ;NAME FROM GTUNO
BMOVEMT5T3C	006427'	202243	000001	01700	        MOVEM   T5,1(T3)
BAOSNAMCTC	006430'	350000	006411*	01800	        AOS     NAMCT           ;COUNT NAMES
BADDIT3C	006431'	271140	000002	01900	        ADDI    T3,2            ;NEXT LOCATION
BMOVEMT3SVJBFFC	006432'	202140	006416*	02000	        MOVEM   T3,SVJBFF
BCAIECC	006433'	302700	000015	02100	        CAIE    C,15
BJRSTSN1C	006434'	254000	006414'	02200	        JRST    SN1             ;NOT LAST, GET NEXT NAME
BSETOMT3C	006435'	476003	000000	02300	        SETOM   (T3)            ;END OF NAME LIST FLAG
BAOSSVJBFFC	006436'	350000	006432*	02400	        AOS     SVJBFF
BHRROIT1C	006437'	561040	777756	02500	        HRROI   T1,-22          ;GET THIS USERS NAME
BGETTABT1C	006440'	047040	000041	02600	        GETTAB  T1,
BHALTC	006441'	254200	006441'	02700	        HALT    .
BMOVEMT1T3C	006442'	202043	000001	02800	        MOVEM   T1,1(T3)
BHRROIT1C	006443'	561040	777757	02900	        HRROI   T1,-21          ;LAST 6 CHARS OF NAME
BGETTABT1C	006444'	047040	000041	03000	        GETTAB  T1,
BHALTC	006445'	254200	006445'	03100	        HALT    .
BMOVEMT1T3C	006446'	202043	000002	03200	        MOVEM   T1,2(T3)
BGETPPNT1C	006447'	047040	000024	03300	        GETPPN  T1,             ;GET THIS USERS NO.
BMOVEMT1T3C	006450'	202043	000003	03400	        MOVEM   T1,3(T3)
BDATET1C	006451'	047040	000014	03500	        DATE    T1,
BMOVEMT1T3C	006452'	202043	000004	03600	        MOVEM   T1,4(T3)
BTIMERT1C	006453'	047040	000022	03700	        TIMER   T1,             ;TIME
BMOVEMT1T3C	006454'	202043	000005	03800	        MOVEM   T1,5(T3)
BSETOMT3C	006455'	476003	000101	03900	        SETOM   101(T3)         ;SET POSSIBLE OVERFLOW FLAG
BMOVEIT1T3C	006456'	201043	000006	04000	        MOVEI   T1,6(T3)        ;LOC. FOR NAME POINTERS
BMOVEMT1NAMPTC	006457'	202040	000000*	04100	        MOVEM   T1,NAMPT
BMOVET1NAMCTC	006460'	200040	006430*	04200	        MOVE    T1,NAMCT
BADDIT3T1C	006461'	271141	000007	04300	        ADDI    T3,7(T1)        ;FIND SPACE FOR MAIL AFTER NAME PTRS
BMOVET4T3C	006462'	200200	000003	04400	        MOVE    T4,T3
BHRLIT4POINTC	006463'	505200	440700	04500	        HRLI    T4,(POINT 7,0)  ;BYTE PTR FOR MAIL
BOUTSTRASCIZC				04600	        OUTSTR  [ASCIZ /TYPE LETTER:
BC	006464'	051140	011626'	04700	/]
BINCHWLT2C	006465'	051200	000002	04800	        INCHWL  T2              ;GET CHAR
BCAINT2C	006466'	306100	000100	04900	        CAIN    T2,"@"          ;CK FOR AT-SIGN
BJRSTSN3C	006467'	254000	006507'	05000	        JRST    SN3             ;NO TEXT
BSN1BIDPBT2T4C	006470'	136100	000004	05100	SN1B:   IDPB    T2,T4   
BMOVET2SVJBFFC	006471'	200100	006436*	05200	        MOVE    T2,SVJBFF
BMOVET2T2C	006472'	200102	000100	05300	        MOVE    T2,100(T2)
BCAMNT2DRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 63-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	006473'	316100	011041'	05400	        CAMN    T2,[-1]
BJRSTSN1AC	006474'	254000	006477'	05500	        JRST    SN1A
BOUTSTRASCIZC				05600	        OUTSTR  [ASCIZ /
BC				05700	---LETTER TERMINATED HERE---
BC	006475'	051140	011631'	05800	(TYPE ANOTHER ONE IF YOU WANT TO GO ON)/]
BJRSTSN1CC	006476'	254000	006504'	05900	        JRST    SN1C
BSN1AINCHWLT2C	006477'	051200	000002	06000	SN1A:   INCHWL  T2
BCAINT2C	006500'	306100	000004	06100	        CAIN    T2,"D"-100      ;CONTROL D
BJRSTSN1CC	006501'	254000	006504'	06200	        JRST    SN1C
BCAIET2C	006502'	302100	000032	06300	        CAIE    T2,"Z"-100
BJRSTSN1BC	006503'	254000	006470'	06400	        JRST    SN1B            ;NOT CONTROL Z
BSN1CMOVEIT2C	006504'	201100	000000	06500	SN1C:   MOVEI   T2,0
BIDPBT2T4C	006505'	136100	000004	06600	        IDPB    T2,T4
BJRSTSN2C	006506'	254000	006543'	06700	        JRST    SN2
BC				06800	;GET MAIL FROM FILE FOR MAILBOX
BSN3PUSHJPGSTRNC	006507'	260740	001674'	06900	SN3:    PUSHJ   P,GSTRN         ;GET FILE NAME STRING
BPUSHJPGETNMSC	006510'	260740	000115'	07000		PUSHJ	P,GETNMS	;SCAN FILE NAME
BMOVET1JOBFFC	006511'	200040	006417*	07100	        MOVE    T1,JOBFF        ;SAVE JOBFF
BPUSHPT1C	006512'	261740	000001	07200	        PUSH    P,T1
BMOVET1SVJBFFC	006513'	200040	006471*	07300	        MOVE    T1,SVJBFF       ;TO FORCE BUFFERS PAST MAIL STORAGE
BADDIT1C	006514'	271040	000110	07400	        ADDI    T1,110
BMOVEMT1JOBFFC	006515'	202040	006511*	07500	        MOVEM   T1,JOBFF
BINITIFLC	006516'	041300	000001	07600	        INIT    IFL,1
BSIXBITC	006517'	446353	000000	07700	        SIXBIT  /DSK/
BXWDSBUFC	006520'	000000	000000*	07800	        XWD     0,SBUF
BLOGOUTC	006521'	047000	000017	07900	        LOGOUT
BSETZMSVPPNC	006522'	402000	000000*	08000	        SETZM   SVPPN+1
BLOOKUPIFLSVNAMC	006523'	076300	005444*	08100	        LOOKUP  IFL,SVNAM
BJRSTBADFLC	006524'	254000	006541'	08200	        JRST    BADFL
BSN3ASOSGSBUFC	006525'	377000	000000*	08300	SN3A:   SOSG    SBUF+2
BINIFLC	006526'	056300	000000	08400	        IN      IFL,
BJRSTSN3BC	006527'	254000	006535'	08500	        JRST    SN3B
BSTATZIFLC	006530'	063300	740000	08600	        STATZ   IFL,740000
BJRSTBADFLC	006531'	254000	006541'	08700	        JRST    BADFL
BPOPPT1C	006532'	262740	000001	08800	        POP     P,T1    ;RESTORE JOBFF
BMOVEMT1JOBFFC	006533'	202040	006515*	08900	        MOVEM   T1,JOBFF
BJRSTSN2C	006534'	254000	006543'	09000	        JRST    SN2
BSN3BILDBT2SBUFC	006535'	134100	000000*	09100	SN3B:   ILDB    T2,SBUF+1
BSKIPET2C	006536'	332000	000002	09200	        SKIPE   T2
BIDPBT2T4C	006537'	136100	000004	09300	        IDPB    T2,T4
BJRSTSN3AC	006540'	254000	006525'	09400	        JRST    SN3A
BBADFLOUTSTRASCIZC	006541'	051140	011650'	09500	BADFL:  OUTSTR	[ASCIZ /BAD FILE/]
BJRSTEXC	006542'	254000	001410'	09600	        JRST    EX
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 64
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;T7 USED FOR MAIL #, T6 PTR TO NEXT NAME
BSN2SETZT2C	006543'	400100	000000	00200	SN2:    SETZ    T2,             ;FOR END MAIL STRING FLAG
BIDPBT2T4C	006544'	136100	000004	00300	        IDPB    T2,T4
BMOVET1SVJBFFC	006545'	200040	006513*	00400	        MOVE    T1,SVJBFF       ;CK IF MAIL TOO LONG
BSETOT2C	006546'	474100	000000	00500	        SETO    T2,
BPUSHJPOPMBXC	006547'	260740	006672'	00600	        PUSHJ   P,OPMBX
BPUSHJPFNXMLC	006550'	260740	006774'	00700	        PUSHJ   P,FNXML         ;FIND NEXT MAIL NO. (PUTS IN T7)
BMOVET6JOBFFC	006551'	200540	006533*	00800	        MOVE    T6,JOBFF        ;SET LOC. FOR NEXT NAME
BSN4MOVET4T6C	006552'	200213	000000	00900	SN4:    MOVE    T4,(T6)
BCAMNT4C	006553'	316200	011041'	01000	        CAMN    T4,[-1]         ;CK FOR END FLAG
BJRSTSN5C	006554'	254000	006573'	01100	        JRST    SN5             ;END OF NAME LIST
BMOVET5T6C	006555'	200253	000001	01200	        MOVE    T5,1(T6)
BMOVEIT1T4C	006556'	201040	000004	01300		MOVEI	T1,T4
BSETMALT1C	006557'	047040	777761	01400		SETMAL	T1,		;SET MONITOR'S MAIL WAITING BIT
BPUSHJPLKUPC	006560'	260740	006642'	01500	        PUSHJ   P,LKUP          ;LOOK FOR NAME ALREADY IN MBX
BJRSTSN6C	006561'	254000	006602'	01600	        JRST    SN6             ;FOUND NAME
BC				01700	;NAME NOT THERE, RETURNS WITH T2 POINTING TO PKT
BMOVEMT4BUFT2C	006562'	202202	006244*	01800	        MOVEM   T4,BUF(T2)
BMOVEMT5BUFT2C	006563'	202242	000000*	01900	        MOVEM   T5,BUF+1(T2)
BHRLZMT7BUFT2C	006564'	516602	006131*	02000	        HRLZM   T7,BUF+2(T2)
BSETZMBUFT2C	006565'	402002	000000*	02100	        SETZM   BUF+3(T2)
BSN4APUSHJPWTBLKC	006566'	260740	006231'	02200	SN4A:   PUSHJ   P,WTBLK         ;WRITE MAIL BLK
BMOVEMCSNAMPTC	006567'	202660	006457*	02300	        MOVEM   CS,@NAMPT       ;CS SET BY LKUP WITH MAIL INDEX
BAOSNAMPTC	006570'	350000	006567*	02400	        AOS     NAMPT           ;FOR NEXT INDEX
BADDIT6C	006571'	271540	000002	02500	        ADDI    T6,2            ;NEXT NAME
BJRSTSN4C	006572'	254000	006552'	02600	        JRST    SN4
BSN5SETOMNAMPTC	006573'	476020	006570*	02700	SN5:    SETOM   @NAMPT          ;SET END FLAG FOR SURE
BPUSHJPGMBLKC	006574'	260740	007005'	02800	        PUSHJ   P,GMBLK         ;USES MAIL NO. IN T7
BC				02900	;SETS T6 TO CORE LOC AND C TO CURSOR POS
BHRLZT1SVJBFFC	006575'	514040	006545*	03000	        HRLZ    T1,SVJBFF
BHRRT1T6C	006576'	540040	000013	03100	        HRR     T1,T6
BBLTT1T6C	006577'	251053	000077	03200	        BLT     T1,77(T6)       ;MOVE MAIL INTO BUFFER
BPUSHJPWTBLKC	006600'	260740	006231'	03300	        PUSHJ   P,WTBLK
BJRSTEXC	006601'	254000	001410'	03400	        JRST    EX
BC				03500	;FOUND NAME, ADD NEW MAIL NO.,T2 PTS TO PKT & NAME
BC				03600	;C HAS CURSOR POS, CS HAS INDEX WORD THIS NAME
BSN6PUSHJPIMNC	006602'	260740	006604'	03700	SN6:    PUSHJ   P,IMN           ;INSERT MAIL NO.
BJRSTSN4AC	006603'	254000	006566'	03800	        JRST    SN4A
BC
BC				04000	;INSERTS MAIL NO., EXPECTS NO. IN T7,MAIL INDEX IN CS
BC				04100	;LOC. INDEX IN T2
BIMNADDIT2C	006604'	271100	000002	04200	IMN:    ADDI    T2,2
BMOVEIT4C	006605'	201200	000004	04300	        MOVEI   T4,4
BSN9PUSHJPFHOLEC	006606'	260740	006634'	04400	SN9:    PUSHJ   P,FHOLE         ;FIND HOLE FOR ENTRY
BJRSTSN7C	006607'	254000	006632'	04500	        JRST    SN7             ;FOUND HOLE THIS PKT
BTRZNT1C	006610'	626040	400000	04600	        TRZN    T1,400000       ;IS THERE A CHAIN PTR
BJRSTSN8C	006611'	254000	006615'	04700	        JRST    SN8             ;NO, GO SET NEW PTR
BPUSHJPGPKTC	006612'	260740	007016'	04800	        PUSHJ   P,GPKT          ;GET PKT AND SETS T3
BMOVEIT4C	006613'	201200	000010	04900	        MOVEI   T4,10
BJRSTSN9C	006614'	254000	006606'	05000	        JRST    SN9             ;TO NXT PKT
BSN8PUSHPT1C	006615'	261740	000001	05100	SN8:    PUSH    P,T1            ;SAVE OLD MAIL NO.
BPUSHJPFEMTC	006616'	260740	006740'	05200	        PUSHJ   P,FEMT          ;FINDS EMPTY PKT
BC				05300	;RETURNS INDEX IN T4
BTROT4DRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 64-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	006617'	660200	400000	05400	        TRO     T4,400000
BDPBT4T5C	006620'	137200	000005	05500	        DPB     T4,T5
BPUSHJPWTBLKC	006621'	260740	006231'	05600	        PUSHJ   P,WTBLK
BPUSHJPGPKTC	006622'	260740	007016'	05700	        PUSHJ   P,GPKT
BPOPPT1C	006623'	262740	000001	05800	        POP     P,T1            ;RECOVER OLD MAIL NO.
BMOVEMT7BUFT2C	006624'	202602	006562*	05900	        MOVEM   T7,BUF(T2)
BHRLMT1BUFT2C	006625'	506042	006624*	06000	        HRLM    T1,BUF(T2)      ;OLD NO.
BSETZMBUFT2C	006626'	402002	006563*	06100	        SETZM   BUF+1(T2)
BSETZMBUFT2C	006627'	402002	006564*	06200	        SETZM   BUF+2(T2)
BSETZMBUFT2C	006630'	402002	006565*	06300	        SETZM   BUF+3(T2)
BJRSTWTBLKC	006631'	254000	006231'	06400	        JRST    WTBLK
BC
BSN7DPBT7T5C	006632'	137600	000005	06600	SN7:    DPB     T7,T5
BJRSTWTBLKC	006633'	254000	006231'	06700		JRST	WTBLK
BFHOLEMOVEIT5BUFT2DRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 65
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	006634'	201242	006625*	00100	FHOLE: MOVEI   T5,BUF(T2)
BHRLIT5POINTC	006635'	505240	442200	00200	        HRLI    T5,(POINT 18,0)
BFHOLE1ILDBT1T5C	006636'	134040	000005	00300	FHOLE1: ILDB    T1,T5
BJUMPET1CPOPJC	006637'	322040	004213'	00400		JUMPE	T1,CPOPJ
BSOJGT4FHOLE1C	006640'	367200	006636'	00500	        SOJG    T4,FHOLE1
BJRSTCPOPJ1C	006641'	254000	002747'	00600	        JRST    CPOPJ1
BC
BLKUPMOVET2T4C	006642'	200100	000004	00800	LKUP:   MOVE    T2,T4
BADDT2T5C	006643'	270100	000005	00900	        ADD     T2,T5
BTLZT2C	006644'	621100	400000	01000	        TLZ     T2,400000
BIDIVIT2MBXHSHC	006645'	231100	000177	01100	        IDIVI   T2,MBXHSH
BLKUP4AOST3C	006646'	350000	000003	01200	LKUP4:  AOS     T3              ;SKIPS OVER FIRST BLK
BPUSHJPRDBLKC	006647'	260740	006237'	01300	        PUSHJ   P,RDBLK
BMOVEIT2C	006650'	201100	000000	01400	        MOVEI   T2,0
BLKUP3SKIPNBUFT2C	006651'	336002	006634*	01500	LKUP3:  SKIPN   BUF(T2)
BJRSTLKUP1C	006652'	254000	006661'	01600	        JRST    LKUP1
BCAMNT4BUFT2C	006653'	316202	006651*	01700	        CAMN    T4,BUF(T2)
BJRSTLKUP2C	006654'	254000	006667'	01800	        JRST    LKUP2
BLKUP5ADDIT2C	006655'	271100	000004	01900	LKUP5:  ADDI    T2,4
BCAIGET2C	006656'	305100	000200	02000	        CAIGE   T2,200
BJRSTLKUP3C	006657'	254000	006651'	02100	        JRST    LKUP3
BJRSTLKUP4C	006660'	254000	006646'	02200	        JRST    LKUP4
BLKUP1AOSPC	006661'	350017	000000	02300	LKUP1:  AOS     (P)             ;SET SKIP RETURN IF NAME NOT FND
BMOVECST2C	006662'	200640	000002	02400	        MOVE    CS,T2
BLSHCSC	006663'	242640	000011	02500	        LSH     CS,11           ;INDEX GOES IN LEFT HALF
BORCST3C	006664'	434640	000003	02600	        OR      CS,T3           ;CUSOR IN RT HALF
BMOVECCSC	006665'	200700	000015	02700	        MOVE    C,CS            ;CURRENT INDEX IN C
BPOPJPC	006666'	263740	000000	02800	        POPJ    P,
BLKUP2CAMET5BUFT2C	006667'	312242	006626*	02900	LKUP2:  CAME    T5,BUF+1(T2)
BJRSTLKUP5C	006670'	254000	006655'	03000	        JRST    LKUP5
BJRSTLKUP1C	006671'	254000	006662'	03100	        JRST    LKUP1+1
BC
BOPMBXMOVEIT5C	006672'	201240	000000	03300	OPMBX:  MOVEI   T5,0            ;USED FOR BUSY SW.
BINITRFLC	006673'	041240	000017	03400	        INIT    RFL,17
BSIXBITC	006674'	446353	000000	03500		SIXBIT	/DSK/
BXWDC	006675'	000000	000000	03600	        XWD     0,0
BLOGOUTC	006676'	047000	000017	03700	        LOGOUT
BMOVET1C	006677'	200040	011652'	03800	        MOVE    T1,['XOBLAM']
BSETZBT2T3C	006700'	403100	000003	03900		SETZB	T2,T3
BHRROIT4C	006701'	561200	777753	04000		HRROI	T4,-25
BGETTABT4C	006702'	047200	000041	04100		GETTAB	T4,		;GET PPN PROGRAM WAS RUN FROM
BHALTC	006703'	254200	006703'	04200		HALT	.
BLOOKUPRFLT1C	006704'	076240	000001	04300	        LOOKUP  RFL,T1
BJRSTNOMBXC	006705'	254000	006731'	04400	        JRST    NOMBX
BMOVEIT3C	006706'	201140	000000	04500		MOVEI	T3,0
BHRROIT4C	006707'	561200	777753	04600		HRROI	T4,-25
BGETTABT4C	006710'	047200	000041	04700		GETTAB	T4,		;DO IT AGAIN
BHALTC	006711'	254200	006711'	04800		HALT	.
BENTERRFLT1C	006712'	077240	000001	04900	        ENTER   RFL,T1
BJRSTC	006713'	254000	006715'	05000	        JRST    .+2
BPOPJPC	006714'	263740	000000	05100	        POPJ    P,0
BJUMPET5OPMBX1C	006715'	322240	006723'	05200	        JUMPE   T5,OPMBX1       ;FIRST BUSY
BJUMPGT5OPMBX2C	006716'	327240	006721'	05300	        JUMPG   T5,OPMBX2       ;LAST BUSY
BMOVEIT5DRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 65-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	006717'	201240	000005	05400	        MOVEI   T5,5            ;FOR 5 SEC SLEEP
BOUTSTRASCIZC				05500	        OUTSTR	[ASCIZ /STAND BY, MAIL BOX BUSY
BC	006720'	051140	011653'	05600	/]
BOPMBX2SLEEPT5C	006721'	047240	000031	05700	OPMBX2: SLEEP   T5,     ;SLEEP
BJRSTOPMBXC	006722'	254000	006673'	05800	        JRST    OPMBX+1
BOPMBX1SETOT5C	006723'	474240	000000	05900	OPMBX1: SETO    T5,
BMOVEIT1C	006724'	201040	000003	06000	        MOVEI   T1,3            ;3 SEC SLEEP ON FIRST TRY
BSLEEPT1C	006725'	047040	000031	06100		SLEEP	T1,
BJRSTOPMBXC	006726'	254000	006673'	06200	        JRST    OPMBX+1
BFLMBXOUTSTRASCIZC	006727'	051140	011661'	06300	FLMBX:  OUTSTR	[ASCIZ /MAIL BOX FULL/]
BJRSTEXC	006730'	254000	001410'	06400	        JRST    EX
BNOMBXMOVEIT4C	006731'	201200	000000	06500	NOMBX:  MOVEI   T4,0
BENTERRFLT1C	006732'	077240	000001	06600	        ENTER   RFL,T1
BHALTC	006733'	254200	000000	06700	        HALT
BCLOSERFLC	006734'	070240	000000	06800	        CLOSE   RFL,0
BJRSTOPMBXC	006735'	254000	006672'	06900	        JRST    OPMBX
BC
BCLMBXRELEASRFLC	006736'	071240	000000	07100	CLMBX:  RELEAS  RFL,
BPOPJPC	006737'	263740	000000	07200	        POPJ    P,
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 66
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;FINDS EMPTY PKT
BC				00200	;USES DIFFERENT BUFFER IF NEC.
BC				00300	;PUTS NEW INDEX IN T1
BFEMTMOVET2T3C	006740'	200100	000003	00400	FEMT:   MOVE    T2,T3           ;FOR POSS. NEW BUF
BMOVEIT1C	006741'	201040	000000	00500	        MOVEI   T1,0
BFEMT2SKIPNT4BUFT1C	006742'	336201	006653*	00600	FEMT2:  SKIPN   T4,BUF(T1)
BJRSTFEMT5C	006743'	254000	006746'	00700	        JRST    FEMT5
BCAMET4C	006744'	312200	011041'	00800	        CAME    T4,[-1]
BJRSTFEMT1C	006745'	254000	006752'	00900	        JRST    FEMT1
BFEMT5LSHT1C	006746'	242040	000011	01000	FEMT5:  LSH     T1,11
BORT1T2C	006747'	434040	000002	01100	        OR      T1,T2   ;MERGE CURSOR
BMOVET4T1C	006750'	200200	000001	01200	        MOVE    T4,T1
BPOPJPC	006751'	263740	000000	01300	        POPJ    P,
BFEMT1ADDIT1C	006752'	271040	000004	01400	FEMT1:  ADDI    T1,4
BCAIGET1C	006753'	305040	000200	01500	        CAIGE   T1,200
BJRSTFEMT2C	006754'	254000	006742'	01600	        JRST    FEMT2
BFEMT3AOST2C	006755'	350000	000002	01700	FEMT3:  AOS     T2
BPUSHJPRDSBLKC	006756'	260740	006766'	01800	        PUSHJ   P,RDSBLK
BMOVEIT1C	006757'	201040	000000	01900	        MOVEI   T1,0            ;START LOOKING SPEC. BUF
BFEMT4SKIPNSBUFT1C	006760'	336001	006520*	02000	FEMT4:  SKIPN   SBUF(T1)
BJRSTFEMT5C	006761'	254000	006746'	02100	        JRST    FEMT5
BADDIT1C	006762'	271040	000004	02200	        ADDI    T1,4
BCAIGET1C	006763'	305040	000200	02300	        CAIGE   T1,200
BJRSTFEMT4C	006764'	254000	006760'	02400	        JRST    FEMT4
BJRSTFEMT3C	006765'	254000	006755'	02500	        JRST    FEMT3
BC
BRDSBLKUSETIRFLT2C	006766'	074242	000001	02700	RDSBLK: USETI   RFL,1(T2)
BINPUTRFLSHEDC	006767'	066240	000000*	02800	        INPUT   RFL,SHED
BSTATORFLC	006770'	061240	760000	02900	        STATO   RFL,760000
BPOPJPC	006771'	263740	000000	03000	        POPJ    P,
BOUTSTRASCIZC	006772'	051140	011664'	03100		OUTSTR	[ASCIZ/INPUT ERROR/]
BJRSTBYENOWC	006773'	254000	001110'	03200		JRST	BYENOW
BC
BC				03400	;FIND NEXT MAIL NO.
BFNXMLMOVEIT7C	006774'	201600	000001	03500	FNXML:  MOVEI   T7,1
BPUSHJPGMBLKC	006775'	260740	007005'	03600	        PUSHJ   P,GMBLK
BSKIPNT6C	006776'	336013	000000	03700	        SKIPN   (T6)
BPOPJPC	006777'	263740	000000	03800	        POPJ    P,
BDATET1C	007000'	047040	000014	03900	        DATE    T1,             ;GET DATE
BSUBIT1C	007001'	275040	000075	04000	        SUBI    T1,75           ;OVER 60 DAYS, DELETE
BCAMGT1T6C	007002'	317053	000003	04100	        CAMG    T1,3(T6)
BAOJAT7FNXMLC	007003'	344600	006775'	04200	        AOJA    T7,FNXML+1
BJRSTCMAIL1C	007004'	254000	007302'	04300		JRST	CMAIL1
BC
BC				04500	;GET MAIL BLK BY MAIL NO (IN T7)
BGMBLKMOVET3T7C	007005'	200140	000014	04600	GMBLK:  MOVE    T3,T7
BLSHT3C	007006'	242140	777777	04700	        LSH     T3,-1
BADDIT3C	007007'	271140	000210	04800	        ADDI    T3,210
BPUSHJPRDBLKC	007010'	260740	006237'	04900	        PUSHJ   P,RDBLK
BMOVECT3C	007011'	200700	000003	05000	        MOVE    C,T3
BMOVEIT6BUFC	007012'	201540	006742*	05100	        MOVEI   T6,BUF
BTRNET7C	007013'	602600	000001	05200	        TRNE    T7,1
BADDIT6C	007014'	271540	000100	05300	        ADDI    T6,100          ;HI ADR. IF ODD MAIL NO.
BPOPJPDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 66-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	007015'	263740	000000	05400	        POPJ    P,
BC
BC				05600	;GETS PKT FROM INDEX IN T1, ASSUMES OLD IN C
BC				05700	;RESETS C, RETURNS PTR IN T2
BGPKTMOVET2T1C	007016'	200100	000001	05800	GPKT:   MOVE    T2,T1
BXORT2CC	007017'	430100	000016	05900	        XOR     T2,C
BTRNET2C	007020'	602100	000777	06000	        TRNE    T2,777          ;CK IF NEW IN SAME BLK
BJRSTGPKT1C	007021'	254000	007026'	06100	        JRST    GPKT1           ;NO, GET NEW BLK
BGPKT2MOVET2T1C	007022'	200100	000001	06200	GPKT2:  MOVE    T2,T1
BLSHT2C	007023'	242100	777767	06300	        LSH     T2,-11          ;MAKE PTR
BMOVECT1C	007024'	200700	000001	06400	        MOVE    C,T1
BPOPJPC	007025'	263740	000000	06500	        POPJ    P,
BGPKT1MOVET3T1C	007026'	200140	000001	06600	GPKT1:  MOVE    T3,T1
BANDIT3C	007027'	405140	000777	06700	        ANDI    T3,777
BPUSHJPRDBLKC	007030'	260740	006237'	06800	        PUSHJ   P,RDBLK
BJRSTGPKT2C	007031'	254000	007022'	06900	        JRST    GPKT2
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 67
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;GETS ALL OF A USERS MAIL
BMAILSETOMNMLSWNMLSWC	007032'	476000	000000*	00200	MAIL:   SETOM   NMLSW#          ;DONT TYPE "NO MAIL" IF LETTER
BMAIL1PUSHJPOPUDC	007033'	260740	006164'	00300	MAIL1:  PUSHJ   P,OPUD          ;CK FOR BROADCAST LTR
BSETZBT3T4C	007034'	403140	000004	00400	        SETZB   T3,T4
BENTERRFLT1C	007035'	077240	000001	00500	        ENTER   RFL,T1
BMESSJRSTOUTSTRASCIZC				00600	        MESS    <MAILBOX BUSY, PLEASE TRY LATER>^JRST [OUTSTR [ASCIZ "MAILBOX BUSY, PLEASE TRY 
BC					LATER"]
BJRSTEXC	007036'	254000	011676'		                JRST    EX]^
BPUSHJPGNAMC	007037'	260740	007076'	00700	        PUSHJ   P,GNAM
BPUSHJPLKLUDC	007040'	260740	006077'	00800	        PUSHJ   P,LKLUD
BHALTC	007041'	254200	007041'	00900	        HALT    .
BMOVET2BUFLBITST1C	007042'	200101	006627*	01000	        MOVE    T2,BUF+LBITS(T1)
BTRNET2C	007043'	602100	077000	01100	        TRNE    T2,77000
BJRSTTBLC	007044'	254000	007105'	01200	        JRST    TBL             ;FOUND 1 OR MORE LETTER BITS
BRELEASRFLC	007045'	071240	000000	01300	        RELEASE RFL,0
BPUSHJPOPMBXC	007046'	260740	006672'	01400	        PUSHJ   P,OPMBX
BPUSHJPGNAMC	007047'	260740	007076'	01500	        PUSHJ   P,GNAM          ;GET THIS USERS NAME
BPUSHJPLKUPC	007050'	260740	006642'	01600	        PUSHJ   P,LKUP
BJRSTMLC	007051'	254000	007055'	01700	        JRST    ML
BSKIPENMLSWC	007052'	332000	007032*	01800		SKIPE	NMLSW
BOUTSTRASCIZC	007053'	051140	011700'	01900		OUTSTR	[ASCIZ/NO MAIL/]	;TYPE IF NOTHING
BJRSTEXC	007054'	254000	001410'	02000		JRST	EX		;QUIT IN ANY CASE
BMLSETZMBUFT2C	007055'	402002	007012*	02100	ML:     SETZM   BUF(T2)
BSETZMBUFT2C	007056'	402002	006667*	02200	        SETZM   BUF+1(T2)
BPUSHJPGMLNC	007057'	260740	007210'	02300	        PUSHJ   P,GMLN          ;STACKS ALL MAIL NO'S AND CLEANS
BC				02400	;REMOVE MAIL FROM STACK AND TYPE
BML2MOVET2SBUFC	007060'	200120	006760*	02500	ML2:    MOVE    T2,@SBUF
BAOSSBUFC	007061'	350000	007060*	02600	        AOS     SBUF
BJUMPLET2EXC	007062'	323100	001410'	02700	        JUMPLE  T2,EX           ;DONE IF NEG
BPUSHJPTPMLC	007063'	260740	007147'	02800	        PUSHJ   P,TPML          ;TYPES MAIL IN T2
BSETZMNAMPTC	007064'	402020	006573*	02900	        SETZM   @NAMPT          ;ZERO THIS INDEX
BMOVET6SVJBFFC	007065'	200540	006575*	03000	        MOVE    T6,SVJBFF       ;RECOVER INDEX TO START OF BLK
BADDIT6C	007066'	271540	000005	03100	        ADDI    T6,5            ;ADJ. TO NAME INDEX LIST
BSKIPLET6C	007067'	333013	000000	03200	        SKIPLE  (T6)
BJRSTML2AC	007070'	254000	007074'	03300	        JRST    ML2A            ;ANOTHER ADDRESSEE,DONT DELETE
BSKIPLT6C	007071'	331013	000000	03400	        SKIPL   (T6)
BAOJAT6C	007072'	344540	007067'	03500	        AOJA    T6,.-3          ;BLANK SPOT
BSETZMSVJBFFC	007073'	402020	007065*	03600	        SETZM   @SVJBFF         ;NO ADDRESSEES, DELETE MAIL
BML2APUSHJPWTBLKC	007074'	260740	006231'	03700	ML2A:   PUSHJ   P,WTBLK         ;WRITE MAIL BLOCK
BJRSTML2C	007075'	254000	007060'	03800	        JRST    ML2
BC
BC				04000	;GET THIS USERS NAME
BGNAMHRROIT4C	007076'	561200	777756	04100	GNAM:   HRROI   T4,-22
BGETTABT4C	007077'	047200	000041	04200	        GETTAB  T4,
BHALTC	007100'	254200	007100'	04300	        HALT    .
BHRROIT5C	007101'	561240	777757	04400	        HRROI   T5,-21
BGETTABT5C	007102'	047240	000041	04500	        GETTAB  T5,
BHALTC	007103'	254200	007103'	04600	        HALT    .
BPOPJPC	007104'	263740	000000	04700	        POPJ    P,
BC				04800	;TYPES A BROADCAST LETTER, REMOVES 1 BIT
BTBLMOVEICC	007105'	201700	000001	04900	TBL:    MOVEI   C,1             ;THE LETTER NO.
BMOVEIT5C	007106'	201240	001000	05000	        MOVEI   T5,1000         ;BIT FOR LETTER 1
BTBL1TDZET2T5C	007107'	632100	000005	05100	TBL1:   TDZE    T2,T5
BJRSTTBL2DRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 67-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	007110'	254000	007113'	05200	        JRST    TBL2            ;FOUND A BIT
BLSHT5C	007111'	242240	000001	05300	        LSH     T5,1            ;TO NEXT LETTER
BAOJACTBL1C	007112'	344700	007107'	05400	        AOJA    C,TBL1
BTBL2MOVEMT2BUFLBITST1C	007113'	202101	007042*	05500	TBL2:   MOVEM   T2,BUF+LBITS(T1)
BPUSHJPWTBLKC	007114'	260740	006231'	05600	        PUSHJ   P,WTBLK
BRELEASRFLC	007115'	071240	000000	05700	        RELEASE RFL,0
BPUSHJPOPMBXC	007116'	260740	006672'	05800	        PUSHJ   P,OPMBX
BMOVEIT3CC	007117'	201156	000402	05900		MOVEI	T3,402(C)
BLSHT3C	007120'	242140	777777	06000		LSH	T3,-1
BPUSHJPRDBLKC	007121'	260740	006237'	06100	        PUSHJ   P,RDBLK
BMOVEIT5BUFC	007122'	201240	007055*	06200	        MOVEI   T5,BUF
BTRNECC	007123'	602700	000001	06300	        TRNE    C,1
BADDIT5C	007124'	271240	000100	06400	        ADDI    T5,100
BSKIPNT5C	007125'	336005	000000	06500	        SKIPN   (T5)
BJRSTTBLEC	007126'	254000	007132'	06600	        JRST    TBLE            ;EMPTY LETTER SLOT
BDATET1C	007127'	047040	000014	06700	        DATE    T1,
BCAMGET1T5C	007130'	315045	000004	06800	        CAMGE   T1,4(T5)        ;DONT TYPE EXPIRED LETTER
BJRSTTBL3C	007131'	254000	007134'	06900	        JRST    TBL3
BTBLERELEASRFLC	007132'	071240	000000	07000	TBLE:   RELEASE RFL,0
BJRSTMAIL1C	007133'	254000	007033'	07100	        JRST    MAIL1
BTBL3SOSGET5C	007134'	375005	000005	07200	TBL3:	SOSGE	5(T5)		;DECREMENT COUNT, DONE IF ZERO
BJRSTTBLEC	007135'	254000	007132'	07300		JRST	TBLE
BPUSHJPWTBLKC	007136'	260740	006231'	07400	        PUSHJ   P,WTBLK
BRELEASRFLC	007137'	071240	000000	07500	        RELEAS  RFL,0
BMOVET1T5C	007140'	200045	000002	07600	        MOVE    T1,2(T5)
BPUSHJPTDATEC	007141'	260740	006255'	07700	        PUSHJ   P,TDATE
BOUTSTRBYTEC	007142'	051140	011100'	07800		OUTSTR	[BYTE(7)15,12]
BOUTSTRT5C	007143'	051145	000012	07900		OUTSTR	12(T5)		;TYPE LETTER
BOUTSTRBYTEC	007144'	051140	011100'	08000		OUTSTR	[BYTE(7)15,12]
BSETZMNMLSWC	007145'	402000	007052*	08100	        SETZM   NMLSW
BJRSTMAIL1C	007146'	254000	007033'	08200	        JRST    MAIL1
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 68
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;TYPES MAIL, EXPECTS MAIL NO. IN T2 AND INDEX IN CS
BTPMLMOVET7T2C	007147'	200600	000002	00200	TPML:   MOVE    T7,T2
BSETOMTPMLHDTPMLHDC	007150'	476000	000000*	00300		SETOM	TPMLHD#
BTPML1PUSHJPGMBLKC	007151'	260740	007005'	00400	TPML1:  PUSHJ   P,GMBLK
BMOVEMT6SVJBFFC	007152'	202540	007073*	00500	        MOVEM   T6,SVJBFF       ;SAVE ADR OF MAIL FOR POS. DELETE
BSKIPNT6C	007153'	336013	000000	00600	        SKIPN   (T6)
BPOPJPC	007154'	263740	000000	00700	        POPJ    P,0             ;EMPTY
BADDIT6C	007155'	271540	000005	00800	        ADDI    T6,5
BSKIPGET6C	007156'	335013	000000	00900	        SKIPGE  (T6)
BPOPJPC	007157'	263740	000000	01000	        POPJ    P,0             ;NO MATCH ON INDEX
BCAMECST6C	007160'	312653	000000	01100	        CAME    CS,(T6)
BAOJAT6C	007161'	344540	007156'	01200	        AOJA    T6,.-3
BC				01300	;FOUND MATCH
BPUSHPT3C	007162'	261740	000003	01400	        PUSH    P,T3
BPUSHPCSC	007163'	261740	000015	01500	        PUSH    P,CS
BSKIPNTPMLHDC	007164'	336000	007150*	01600		SKIPN	TPMLHD
BJRSTTPML2C	007165'	254000	007201'	01700		JRST	TPML2
BOUTSTRASCIZC				01800	        OUTSTR	[ASCIZ /
BC	007166'	051140	011702'	01900	        FROM /]
BMOVET1SVJBFFC	007167'	200040	007152*	02000	        MOVE    T1,SVJBFF       ;ADR. OF NAME
BPUSHJPTPSIXC	007170'	260740	005576'	02100	        PUSHJ   P,TPSIX
BOUTSTRASCIZC	007171'	051140	011706'	02200		OUTSTR	[ASCIZ/, /]
BMOVET2SVJBFFC	007172'	200100	007167*	02300	        MOVE    T2,SVJBFF
BMOVET1T2C	007173'	200042	000003	02400	        MOVE    T1,3(T2)        ;ADR. OF DATE
BPUSHJPTDATEC	007174'	260740	006255'	02500	        PUSHJ   P,TDATE
BMOVET2SVJBFFC	007175'	200100	007172*	02600	        MOVE    T2,SVJBFF
BMOVET1T2C	007176'	200042	000004	02700	        MOVE    T1,4(T2)
BPUSHJPPRTIM1C	007177'	260740	006307'	02800	        PUSHJ   P,PRTIM1        ;TYPE TIME
BOUTSTRBYTEC	007200'	051140	011100'	02900		OUTSTR	[BYTE(7)15,12]
BTPML2MOVEMT6NAMPTC	007201'	202540	007064*	03000	TPML2:  MOVEM   T6,NAMPT        ;SAVE LOC. OF MATCH
BSKIPLT6C	007202'	331013	000001	03100	        SKIPL   1(T6)           ;SEARCH FOR END FLAG
BAOJAT6C	007203'	344540	007202'	03200	        AOJA    T6,.-1
BOUTSTRT6C	007204'	051153	000002	03300		OUTSTR	2(T6)		;TYPE LETTER
BPOPPCSC	007205'	262740	000015	03400	        POP     P,CS
BPOPPT3C	007206'	262740	000003	03500	        POP     P,T3
BPOPJPC	007207'	263740	000000	03600	        POPJ    P,0
BC
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 69
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;STACKS ALL MAIL NOS. AND CLEARS LIST
BC				00200	;EXPECTS LOC. INDEX IN T2, MAIL INDEX IN CS
BC				00300	;IGNORES MAIL NOS. GRTR THAN 777
BGMLNHRLIT2C	007210'	505100	777776	00400	GMLN:   HRLI    T2,-2           ;SET CTR
BADDIT2C	007211'	271100	000002	00500	        ADDI    T2,2            ;ADJ ADR TO SKIP OVER NAME
BMOVEIT1SBUFC	007212'	201040	006535*	00600	        MOVEI   T1,SBUF+1
BMOVEMT1SBUFC	007213'	202040	007061*	00700	        MOVEM   T1,SBUF         ;PTR FOR MAIL NO. STACK
BSETZMSBUFC	007214'	402000	007212*	00800	        SETZM   SBUF+1          ;END FLAG
BGMHLRZT1BUFT2C	007215'	554042	007122*	00900	GM:     HLRZ    T1,BUF(T2)      ;GET MAIL NO.
BJUMPET1GM1C	007216'	322040	007222'	01000	        JUMPE   T1,GM1          ;IGNORE BLANKS
BHLLMT1BUFT2C	007217'	502042	007215*	01100	        HLLM    T1,BUF(T2)      ;CLEAR FROM BUFFER
BCAIGT1C	007220'	307040	000777	01200	        CAIG    T1,777          ;IGNORE LARGE NUMBERS
BPUSHJPGMSTKC	007221'	260740	007276'	01300	        PUSHJ   P,GMSTK         ;STACK MAIL NOS.
BGM1HRRZT1BUFT2C	007222'	550042	007217*	01400	GM1:    HRRZ    T1,BUF(T2)      ;TRY RIGHT HALF
BJUMPET1GM2C	007223'	322040	007231'	01500	        JUMPE   T1,GM2
BSETZMBUFT2C	007224'	402002	007222*	01600	        SETZM   BUF(T2)
BTRZET1C	007225'	622040	400000	01700	        TRZE    T1,400000       ;CK FOR INDEX LINK OR NULL
BJRSTGM3C	007226'	254000	007240'	01800	        JRST    GM3             ;FOUND LINK OR NULL
BCAIGT1C	007227'	307040	000777	01900	        CAIG    T1,777
BPUSHJPGMSTKC	007230'	260740	007276'	02000	        PUSHJ   P,GMSTK
BGM2AOBJNT2GMC	007231'	253100	007215'	02100	GM2:    AOBJN   T2,GM   ;TO NEXT WORD
BPUSHJPGBGC	007232'	260740	007257'	02200	        PUSHJ   P,GBG           ;CLEAR GARBAGE
BPUSHJPWTBLKC	007233'	260740	006231'	02300	        PUSHJ   P,WTBLK         ;NO MORE, WRITE OUT BLK
BSETZMSBUFC	007234'	402020	007213*	02400	        SETZM   @SBUF           ;END FLAG
BMOVEIT1SBUFC	007235'	201040	007214*	02500	        MOVEI   T1,SBUF+1
BMOVEMT1SBUFC	007236'	202040	007234*	02600	        MOVEM   T1,SBUF
BPOPJPC	007237'	263740	000000	02700	        POPJ    P,
BGM3TRNET1C	007240'	602040	200000	02800	GM3:    TRNE    T1,200000       ;NULL FLAG
BJRSTGM2C	007241'	254000	007231'	02900	        JRST    GM2             ;IGNORE NULL
BMOVET4T1C	007242'	200200	000001	03000	        MOVE    T4,T1           ;PREPARE TO TEST OF PKT IN CORE
BXORT4CC	007243'	430200	000016	03100	        XOR     T4,C
BTRNET4C	007244'	602200	000777	03200	        TRNE    T4,777
BJRSTGM4C	007245'	254000	007252'	03300	        JRST    GM4             ;NOT IN CORE,CLEANUP BEFORE WRITE
BGM5MOVET2T1C	007246'	200100	000001	03400	GM5:    MOVE    T2,T1           ;MAKE ADR. OF NEW PKT
BLSHT2C	007247'	242100	777767	03500	        LSH     T2,-11
BHRLIT2C	007250'	505100	777774	03600	        HRLI    T2,-4           ;SET WORD COUNT
BJRSTGMC	007251'	254000	007215'	03700	        JRST    GM
BGM4PUSHJPGBGC	007252'	260740	007257'	03800	GM4:    PUSHJ   P,GBG
BPUSHJPWTBLKC	007253'	260740	006231'	03900	        PUSHJ   P,WTBLK
BPUSHJPGPKTC	007254'	260740	007016'	04000	        PUSHJ   P,GPKT
BHRLIT2C	007255'	505100	777774	04100	        HRLI    T2,-4
BJRSTGMC	007256'	254000	007215'	04200	        JRST    GM
BC
BC				04400	;PREPARES FOR GARBARGE COLLECTION BY FLAGGING EMPTY CELLS
BGBGMOVEIT2C	007257'	201100	000174	04500	GBG:    MOVEI   T2,174
BSKIPET4BUFT2C	007260'	332202	007224*	04600	        SKIPE   T4,BUF(T2)      ;BACKUP TO FIRST NONZERO
BJRSTGBG1C	007261'	254000	007265'	04700	        JRST    GBG1
BGBG2SUBIT2C	007262'	275100	000004	04800	GBG2:   SUBI    T2,4
BJUMPGT2GBGC	007263'	327100	007260'	04900	        JUMPG   T2,GBG+1
BPOPJPC	007264'	263740	000000	05000	        POPJ    P,0
BGBG1CAMET4C	007265'	312200	011041'	05100	GBG1:   CAME    T4,[-1]
BJRSTGBG3C	007266'	254000	007271'	05200	        JRST    GBG3
BSETZMBUFT2C	007267'	402002	007260*	05300	        SETZM   BUF(T2)
BJRSTGBG2DRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 69-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	007270'	254000	007262'	05400	        JRST    GBG2
BGBG3SUBIT2C	007271'	275100	000004	05500	GBG3:   SUBI    T2,4
BJUMPLT2CPOPJC	007272'	321100	004213'	05600		JUMPL	T2,CPOPJ
BSKIPNBUFT2C	007273'	336002	007267*	05700	        SKIPN   BUF(T2)
BSETOMBUFT2C	007274'	476002	007273*	05800	        SETOM   BUF(T2)
BJRSTGBG3C	007275'	254000	007271'	05900	        JRST    GBG3
BGMSTKMOVEMT1SBUFC	007276'	202060	007236*	06000	GMSTK:  MOVEM   T1,@SBUF        ;STACK MAIL NOS.
BAOSSBUFC	007277'	350000	007276*	06100	        AOS     SBUF
BPOPJPC	007300'	263740	000000	06200	        POPJ    P,0
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 70
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;CANCELS MAIL, GIVEN MAIL NO. IN T7
BC				00200	;ALSO REMOVES GARBAGE ON LIST
BCMAILPUSHJPGMBLKC	007301'	260740	007005'	00300	CMAIL:  PUSHJ   P,GMBLK
BCMAIL1SETZMT6C	007302'	402013	000000	00400	CMAIL1: SETZM   (T6)
BJSPT2GIXNC	007303'	265100	007346'	00500	        JSP     T2,GIXN ;GET INDEX NUMBERS
BPUSHJPWTBLKC	007304'	260740	006231'	00600	        PUSHJ   P,WTBLK
BMOVEMT7NAMCTC	007305'	202600	006460*	00700	        MOVEM   T7,NAMCT        ;SAVE FOR RETURN
BCMPOPPT1C	007306'	262740	000001	00800	CM:     POP     P,T1            ;RECOVER MAIL INDICES
BJUMPET1CM6C	007307'	322040	007344'	00900	        JUMPE   T1,CM6
BMOVECST1C	007310'	200640	000001	01000	        MOVE    CS,T1
BPUSHJPGPKTC	007311'	260740	007016'	01100	        PUSHJ   P,GPKT
BSKIPNT1BUFT2C	007312'	336042	007274*	01200	        SKIPN   T1,BUF(T2)
BJRSTCMC	007313'	254000	007306'	01300	        JRST    CM              ;PKT ALREADY EMPTY
BCAMNT1C	007314'	316040	011041'	01400	        CAMN    T1,[-1]
BJRSTCMC	007315'	254000	007306'	01500	        JRST    CM
BPUSHJPGMLNC	007316'	260740	007210'	01600	        PUSHJ   P,GMLN          ;GET ALL MAIL NO'S
BCM1MOVET7SBUFC	007317'	200620	007277*	01700	CM1:    MOVE    T7,@SBUF        ;RECOVER STACKED MAIL NO'S
BAOSSBUFC	007320'	350000	007317*	01800	        AOS     SBUF
BJUMPET7CM3C	007321'	322600	007335'	01900	        JUMPE   T7,CM3          ;NO MORE, CLEAR MAIL LIST
BCAMNT7NAMCTC	007322'	316600	007305*	02000	        CAMN    T7,NAMCT        ;IS THIS THE ONE TO CANCEL?
BJRSTCM1C	007323'	254000	007317'	02100	        JRST    CM1             ;YES, IGNORE
BCM2MOVET1CSC	007324'	200040	000015	02200	CM2:    MOVE    T1,CS           ;GO BACK TO START
BPUSHJPGPKTC	007325'	260740	007016'	02300	        PUSHJ   P,GPKT
BPUSHJPIMNC	007326'	260740	006604'	02400	        PUSHJ   P,IMN           ;INSERT MAIL BACK INTO LIST
BMOVET7SBUFC	007327'	200620	007320*	02500	        MOVE    T7,@SBUF        ;RECOVER ANOTHER MAIL NO.
BAOSSBUFC	007330'	350000	007327*	02600	        AOS     SBUF
BJUMPET7CMC	007331'	322600	007306'	02700	        JUMPE   T7,CM   ;DONE INSERTING ON ZERO
BCAMNT7NAMCTC	007332'	316600	007322*	02800	        CAMN    T7,NAMCT        ;COULD BE THE ONE BEING CANCELLED
BJRSTC	007333'	254000	007327'	02900	        JRST    .-4
BJRSTCM2C	007334'	254000	007324'	03000	        JRST    CM2             ;GO INSERT
BCM3MOVET1CSC	007335'	200040	000015	03100	CM3:    MOVE    T1,CS
BPUSHJPGPKTC	007336'	260740	007016'	03200	        PUSHJ   P,GPKT
BSKIPET1BUFT2C	007337'	332042	006121*	03300	        SKIPE   T1,BUF+4(T2)    ;IF NEXT ZERO,THAEN ZERO THIS ONE
BSETOT1C	007340'	474040	000000	03400	        SETO    T1,
BCM5MOVEMT1BUFT2C	007341'	202042	007312*	03500	CM5:    MOVEM   T1,BUF(T2)
BPUSHJPWTBLKC	007342'	260740	006231'	03600	        PUSHJ   P,WTBLK
BJRSTCMC	007343'	254000	007306'	03700	        JRST    CM
BCM6MOVET7NAMCTC	007344'	200600	007332*	03800	CM6:    MOVE    T7,NAMCT        ;RECOVER SAVED MAIL NO.
BPOPJPC	007345'	263740	000000	03900	        POPJ    P,0
BC
BGIXNADDIT6C	007346'	271540	000005	04100	GIXN:   ADDI    T6,5            ;GET INDEX NUMBERS
BMOVEIT1C	007347'	201040	000000	04200	        MOVEI   T1,0
BPUSHPT1C	007350'	261740	000001	04300	        PUSH    P,T1            ;ZERO END FLAG
BSKIPGET1T6C	007351'	335053	000000	04400	        SKIPGE  T1,(T6)
BJRSTT2C	007352'	254002	000000	04500	        JRST    (T2)            ;REQUIRES RET. ADR. IN T2
BSKIPET1C	007353'	332000	000001	04600	        SKIPE   T1
BAOJAT6C	007354'	344540	007350'	04700	        AOJA    T6,.-4
BAOJAT6C	007355'	344540	007351'	04800	        AOJA    T6,.-4          ;SKIP OVER ZERO, DONT PUSH
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 71
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;POSTMAN, TYPES MAIL NOT REMOVED FROM BOX, ETC.
BPOSTMOVEIT7C	007356'	201600	000001	00200	POST:   MOVEI   T7,1            ;TRIAL MAIL NO.
BSETZMTPMLHDC	007357'	402000	007164*	00300		SETZM	TPMLHD
BPOST1PUSHJPOPMBXC	007360'	260740	006672'	00400	POST1:  PUSHJ   P,OPMBX
BSETOT1C	007361'	474040	000000	00500	        SETO    T1,
BPUSHJPGMBLKC	007362'	260740	007005'	00600	        PUSHJ   P,GMBLK
BJUMPET1EXC	007363'	322040	001410'	00700	        JUMPE   T1,EX           ;FLAG SET BY RDBLK ON END
BMOVET1T6C	007364'	200053	000000	00800	        MOVE    T1,(T6)
BJUMPET1POST1BC	007365'	322040	007372'	00900	        JUMPE   T1,POST1B+1     ;EMPTY MAIL SLOT
BPUSHJPGNAMC	007366'	260740	007076'	01000	        PUSHJ   P,GNAM          ;GET THIS USERS NAME
BTRNEFL3SPCOMC	007367'	602440	100000	01100	        TRNE    FL3,SPCOM       ;CK IF SPEC. COMMAND
BJRSTPOST5C	007370'	254000	007422'	01200	        JRST    POST5
BPOST1BCAMET4T6C	007371'	312213	000000	01300	POST1B: CAME    T4,(T6)         ;CK IF THIS USER
BAOJAT7POST1C	007372'	344600	007360'	01400	        AOJA    T7,POST1        ;TO NEXT
BCAMET5T6C	007373'	312253	000001	01500	        CAME    T5,1(T6)
BAOJAT7POST1C	007374'	344600	007360'	01600	        AOJA    T7,POST1
BPOST1COUTSTRASCIZC				01700	POST1C: OUTSTR	[ASCIZ /
BC	007375'	051140	011707'	01800	MAIL SENT ON: /]
BMOVET1T6C	007376'	200053	000003	01900	        MOVE    T1,3(T6)
BPUSHJPTDATEC	007377'	260740	006255'	02000	        PUSHJ   P,TDATE
BMOVET1T6C	007400'	200053	000004	02100	        MOVE    T1,4(T6)
BPUSHJPPRTIM1C	007401'	260740	006307'	02200	        PUSHJ   P,PRTIM1
BOUTSTRASCIZC				02300	        OUTSTR	[ASCIZ /
BC	007402'	051140	011713'	02400	TO: /]
BJSPT2GIXNC	007403'	265100	007346'	02500	        JSP     T2,GIXN         ;GET INDEX NUMBERS
BPOST3POPPT1C	007404'	262740	000001	02600	POST3:  POP     P,T1            ;RECOVER MAIL INDEX
BJUMPET1POST4C	007405'	322040	007416'	02700	        JUMPE   T1,POST4        ;ZERO FOR END OF LIST
BMOVEMT1NAMPTC	007406'	202040	007201*	02800	        MOVEM   T1,NAMPT        ;SAVE FOR TPMLX
BPOST3APUSHJPGPKTC	007407'	260740	007016'	02900	POST3A: PUSHJ   P,GPKT
BMOVEIT1BUFT2C	007410'	201042	007341*	03000	        MOVEI   T1,BUF(T2)
BPUSHJPTPSIXC	007411'	260740	005576'	03100	        PUSHJ   P,TPSIX
BPOPPT1C	007412'	262740	000001	03200	        POP     P,T1
BJUMPET1POST4C	007413'	322040	007416'	03300	        JUMPE   T1,POST4
BOUTCHRC	007414'	051040	011567'	03400	        OUTCHR  [":"]
BJRSTPOST3AC	007415'	254000	007407'	03500	        JRST    POST3A
BPOST4PUSHJPCLMBXC	007416'	260740	006736'	03600	POST4:  PUSHJ   P,CLMBX
BPUSHJPTPOSTC	007417'	260740	007431'	03700	        PUSHJ   P,TPOST
BJRSTC	007420'	254000	007417'	03800		JRST	.-1		;MUST HAVE TYPED -
BAOJAT7POST1C	007421'	344600	007360'	03900	        AOJA    T7,POST1
BC
BPOST5HRROIT1C	007422'	561040	777760	04100	POST5:  HRROI   T1,-20
BGETTABT1C	007423'	047040	000041	04200	        GETTAB  T1,
BHALTC	007424'	254200	007424'	04300	        HALT    .
BTRNNT1C	007425'	606040	100000	04400		TRNN	T1,100000
BJRSTPOST1BC	007426'	254000	007371'	04500		JRST	POST1B		;NO OPERATOR LICENSE, NOTHING SPECIAL
BSETOMTPMLHDC	007427'	476000	007357*	04600		SETOM	TPMLHD
BJRSTPOST1CC	007430'	254000	007375'	04700		JRST	POST1C		;OPERATOR LICENSE, LOOK AT ALL MAIL
BC
BTPOSTMOVEIT1ASCIZC				04900	TPOST:  MOVEI   T1,[ASCIZ /
BC	007431'	201040	011715'	05000	TYPE MAIL? /]
BPUSHJPYNC	007432'	260740	006005'	05100	        PUSHJ   P,YN
BPUSHJPTPMLXC	007433'	260740	007444'	05200	        PUSHJ   P,TPMLX
BMOVEIT1ASCIZC	007434'	201040	011720'	05300	        MOVEI   T1,[ASCIZ /CANCEL MAIL? /]
BPUSHJPYNDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 71-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	007435'	260740	006005'	05400	        PUSHJ   P,YN
BJRSTC	007436'	254000	007440'	05500	        JRST    .+2
BJRSTCPOPJ1C	007437'	254000	002747'	05600	        JRST    CPOPJ1
BPUSHJPOPMBXC	007440'	260740	006672'	05700	        PUSHJ   P,OPMBX
BPUSHJPCMAILC	007441'	260740	007301'	05800	        PUSHJ   P,CMAIL
BPUSHJPCLMBXC	007442'	260740	006736'	05900	        PUSHJ   P,CLMBX
BJRSTCPOPJ1C	007443'	254000	002747'	06000	        JRST    CPOPJ1
BTPMLXPUSHJPOPMBXC	007444'	260740	006672'	06100	TPMLX:  PUSHJ   P,OPMBX
BMOVECSNAMPTC	007445'	200640	007406*	06200	        MOVE    CS,NAMPT        ;RECOVER SAVED INDEX
BPUSHJPTPML1C	007446'	260740	007151'	06300	        PUSHJ   P,TPML1
BJRSTCLMBXC	007447'	254000	006736'	06400		JRST	CLMBX
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 72
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;HANDLE VARIOUS EDITOR-TYPE COMMANDS
BC
BEDITORTRNNFL3TYMXC	007450'	606440	040000	00300	EDITOR:	TRNN	FL3,TYMX
BJRSTEDIT10C	007451'	254000	007462'	00400		JRST	EDIT10		;IN PDP MODE, THIS CALLS EDIT10
BSETOMEDCMNDC	007452'	476000	000050*	00500		SETOM	EDCMND		;TYMEX MODE, START EDITOR AT NORMAL START ADDRESS
BPUSHPJDONE1C	007453'	261740	001325'	00600		PUSH	P,JDONE1	;DIDDLE RETURN ADDRESS TO AVOID PLAYING WITH ARGUMENTS
BJRSTMODIFYC	007454'	254000	007463'	00700		JRST	MODIFY
BC
BMAKETROFLCREATFC	007455'	660000	040000	00900	MAKE:	TRO	FL,CREATF	;A CREATE-STYLE COMMAND
BTECOMOVET1SIXBITC	007456'	200040	011723'	01000	TECO:	MOVE	T1,[SIXBIT/TECO/] ;YES, SOME PEOPLE USE THIS EDITOR
BJRSTEDFINC	007457'	254000	007464'	01100		JRST	EDFIN
BC
BCREATETROFLCREATFC	007460'	660000	040000	01300	CREATE:	TRO	FL,CREATF
BTRNNFL3TYMXC	007461'	606440	040000	01400		TRNN	FL3,TYMX	;CHOOSE APPROPRIATE EDITOR FOR MODE
BEDIT10SKIPAT1SIXBITC	007462'	334040	011724'	01500	EDIT10:	SKIPA	T1,[SIXBIT/EDIT10/] ;A PDP HACK OR 10EDIT COMMAND
BMODIFYMOVET1SIXBITC	007463'	200040	011725'	01600	MODIFY:	MOVE	T1,[SIXBIT/EDITOR/] ;A TYMHACK
BEDFINMOVEMT1PCNAMC	007464'	202040	004644*	01700	EDFIN:	MOVEM	T1,PCNAM	;SAVE HIS EDITOR
BTROFLEDITFC	007465'	660000	020000	01800		TRO	FL,EDITF
BPOPJPC	007466'	263740	000000	01900		POPJ	P,
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 73
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;FLAGS IN RH OF FL3 FOR EDITING
BSQFLGC			000001	00200	SQFLG==1        ;/S FOR EDIT10
BRFLGC			000002	00300	RFLG==2         ;READ ONLY (/R)
BC
BDOEDITPUSHJPSCANC	007467'	260740	000276'	00500	DOEDIT: PUSHJ P,SCAN    ;START ON THE FILE NAME
BDOEDT1PUSHJPGETNAMC	007470'	260740	000116'	00600	DOEDT1: PUSHJ P,GETNAM
BEDRSPUSHJPSCANC	007471'	260740	000276'	00700	EDRS:   PUSHJ   P,SCAN
BCAIECC	007472'	302700	000057	00800	        CAIE    C,"/"
BJRSTNOEDSWC	007473'	254000	007505'	00900	        JRST NOEDSW
BPUSHJPSCANC	007474'	260740	000276'	01000	        PUSHJ P,SCAN
BTRNNFLIDFC	007475'	606000	000020	01100	        TRNN FL,IDF
BJRSTSYNERRC	007476'	254000	001065'	01200	        JRST SYNERR
BMOVET1XWDEDSWLEDSWTC	007477'	200040	011726'	01300	        MOVE T1,[XWD -EDSWL,EDSWT]
BPUSHJPSWSCANC	007500'	260740	002722'	01400	        PUSHJ P,SWSCAN
BJRSTUNRECSC	007501'	254000	001071'	01500	        JRST UNRECS
BJFCLC	007502'	255000	000000	01600	        JFCL
BTROFL3EDSWT2EDSWTT1C	007503'	660461	000002	01700	        TRO FL3,@EDSWT2-EDSWT(T1)
BJRSTEDRSC	007504'	254000	007471'	01800	        JRST EDRS
BNOEDSWSKIPESVDEVC	007505'	332000	005443*	01900	NOEDSW: SKIPE SVDEV     ;DEVICE IS ILLEGAL
BJRSTSYNERRC	007506'	254000	001065'	02000	        JRST    SYNERR
BMOVEIT3OUTEDTC	007507'	201140	010205'	02100	        MOVEI   T3,OUTEDT
BMOVEIT1C	007510'	201040	000040	02200	        MOVEI   T1," "          ;COMMAND FOR DREDIT
BPUSHJPOUTEDTC	007511'	260740	010205'	02300	        PUSHJ   P,OUTEDT        ;OUTPUT THE S
BMOVEIT4C	007512'	201200	000000	02400		MOVEI T4,0
BPUSHJPCMNOC	007513'	260740	003472'	02500		PUSHJ P,CMNO	;OUTPUT THE NAME
BMOVET4XWDEDSBLEDSBTC	007514'	200200	011727'	02600	        MOVE T4,[XWD -EDSBL,EDSBT]
BPUSHJPSWBITSC	007515'	260740	003227'	02700	        PUSHJ P,SWBITS
BTRNNFL3T2C	007516'	606442	000000	02800	        TRNN FL3,(T2)
BTRNEFLCREATFC	007517'	602000	040000	02900	        TRNE    FL,CREATF       ;EDIT OR CREATE?
BJRSTDOEDT3C	007520'	254000	007537'	03000	        JRST    DOEDT3          ;CREATE (OR MAKE)
BDOEDPPUSHJPOUCRLFC	007521'	260740	010063'	03100	DOEDP:  PUSHJ   P,OUCRLF        ;EDIT (OR TECO) - OUTPUT CRLF
BDOEDT2C	007522'			03200	DOEDT2:
BCAIECC	007522'	302700	000045	03300	        CAIE C,"%"
BJRSTNOCOMSC	007523'	254000	007533'	03400	        JRST NOCOMS
BRCOMPUSHJPGETCHC	007524'	260740	000342'	03500	RCOM:   PUSHJ P,GETCH
BTLNNCSTERMFC	007525'	607640	200000	03600	        TLNN CS,TERMF   ;THE END, GET CRLF AND GO
BCAINCC	007526'	306700	000045	03700	        CAIN C,"%"      ;START OF ANOTHER COMMAND
BJRSTDOEDPC	007527'	254000	007521'	03800	        JRST DOEDP      ;THIS WILL PUT OUT CRLF AND READ MORE
BMOVET1CC	007530'	200040	000016	03900	        MOVE T1,C       ;PUT IT OUT
BPUSHJPOUTEDTC	007531'	260740	010205'	04000	        PUSHJ P,OUTEDT
BJRSTRCOMC	007532'	254000	007524'	04100	        JRST RCOM
BNOCOMSTLNNCSTERMFC	007533'	607640	200000	04200	NOCOMS: TLNN CS,TERMF
BJRSTSYNERRC	007534'	254000	001065'	04300	        JRST SYNERR
BIFETEMPC				04400	IFE TEMP,<      RELEAS  CHNEDT,0        ;END OF COMMAND>
BIFNTEMPPUSHJPCHKEDTC	007535'	260740	010211'	04500	IFN TEMP,<      PUSHJ P,CHKEDT          ;CHECK FOR TMPCOR UUO>
BJRSTDONEC	007536'	254000	001324'	04600	      	JRST DONE	;GO GET IT LOADED
BC
BDOEDT3MOVEIT1C	007537'	201040	000175	04800	DOEDT3: MOVEI   T1,175          ;OLD ALTMODE
BPUSHJPOUTEDTC	007540'	260740	010205'	04900	        PUSHJ   P,OUTEDT        ;ENDS CREATE OR MAKE COMMAND
BJRSTDOEDT2C	007541'	254000	007522'	05000	        JRST    DOEDT2
BC
BDEFINEC				05200	DEFINE TABLE
BTABLEC				05300	<SWITCH SEQUENCE,SQFLG
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 73-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				05400	SWITCH READ,RFLG>
BTBGENDEFINEC				05500	TBGEN (EDSWT,EDSWL,EDSWT2)^DEFINE SWITCH (P,Q)
BSWITCHC					<<SIXBIT /P/>>
BEDSWTTABLESWITCHSIXBITC	007542'	634561	654556		EDSWT:      TABLE^SWITCH SEQUENCE,SQFLG^<SIXBIT /SEQUENCE/>^
BSWITCHSIXBITC	007543'	624541	440000		SWITCH READ,RFLG^<SIXBIT /READ/>^^
BEDSWTEDSWLDEFINESWITCHEDSWT2TABLESWITCHSQFLGC	007544'	000000	000001		EDSWT2:      TABLE^SWITCH SEQUENCE,SQFLG^SQFLG^
BSWITCHRFLGC	007545'	000000	000002		SWITCH READ,RFLG^RFLG^^
BEDSBTSBTSSIXBITRFLGC	007546'	176200	000002	05600	EDSBT:  SBTS R,RFLG^<SIXBIT !/R!>+RFLG^
BSBTSSIXBITSQFLGC	007547'	176300	000001	05700	        SBTS S,SQFLG^<SIXBIT !/S!>+SQFLG^
BEDSBTEDSBLC			000002	05800	EDSBL==.-EDSBT
BIFELSTRSWDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 74
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	IFE LSTRSW,<
BC				00200	OUTLST=OUTPIP           ;USE PIP FOR A LISTER
BC				00300	CHNLST=CHNPIP
BC				00400	IFN TEMP,<CHKLST=CHKPIP>>
BC
BIFNLSTRSWC				00600	IFN LSTRSW,<;FLAGS IN LH OF FL3(PERM) AND LH OF FL2(TEMP)
BC				00700	;FOR SPECIAL LISTER SWITCHES
BPFLGC			000001	00800	PFLG==1         ;FOOTRAN TYPE OUTPUT /FOOTRAN
BLFLGC			000002	00900	LFLG==2         ;CASE CONTROL /CASE
BQFLGC			000004	01000	QFLG==4         ;QUESTION MARK CONTROL /QUESTION
BHFLGC			000010	01100	HFLG==10        ;HEADER CONTROL /HEADER
BNFLGC			000020	01200	NFLG==20        ;SEQUENCE NUMBER PRINTING /NOSEQUENCE
BSFLGC			000040	01300	SFLG==40        ;SKIP CONTROL CHRS. /NOSKIPCONTROL
BDFLGC			000100	01400	DFLG==100       ;MULTI LINE /DOUBLE /MULTILINE
BMFLGC			000200	01500	MFLG==200	;SET M SWITCH(/LOL) 
BJFLGC			000400	01600	JFLG==400	;SET J SWITCH(/NOFULL)
BLIMSWC			001000	01700	LIMSW==1000     ;IMEDIATE MODE SWITCH
BOFLGC			002000	01800	OFLG==2000	;SMALL PRINTER PAPER /SMALL
BGFLGC			004000	01900	GFLG==4000	;PAGED TTY OUTPUT /PAGED
BIFLGC			010000	02000	IFLG==10000	;CHEAP HEADING /CHEAD
BEFLGC			020000	02100	EFLG==20000	;COUNT PAGES /COUNT
BAFLGC			040000	02200	AFLG==40000	;ONE NUMBER PAGE SCHEME /ONENUM
B%BFLGC			100000	02300	%BFLG==100000	;SET PAGE SIZE /SIZE NN
BKFLGC			200000	02400	KFLG==200000	;SET K SWITCH(/NOFULL)
BC
BC				02600	;ENTRIES IN NUMBER TABLE
BSIZEPC			000001	02700	SIZEP==1
BLOLSC			000002	02800	LOLS==2		;/LOL SWITCH
BLINESC			000003	02900	LINES==3	;MUST BE LAST ENTRY
BC				03000	;NOTE THAT LINES MUST BE THE LAST ENTRY IN THE TABLE BECAUSE
BC				03100	;THE IDIOT WHO CODED THIS SECTION OF RPG USES LINES AS A 
BC				03200	;CONSTANT FOR A SCAN LOOP.....
BC				03300	;ALSO KEEP IN ORDER TABLE AT LOCATION    SPSTB
BC
BARRAYLINESTTABPTABC				03500	ARRAY PTAB,TTAB[LINES+1]
BC				03600	>
BPRINTSKIPAT2SIXBITC	007550'	334100	011730'	03700	PRINT:	SKIPA T2,[SIXBIT /LPT/]
BTYPRMOVSIT2C	007551'	205100	646471	03800	TYPR:	MOVSI T2,'TTY'
BTLOAFL3HFLGC	007552'	665440	000010	03900	        TLOA FL3,HFLG
BLISTRMOVSIT2C	007553'	205100	546064	04000	LISTR:	MOVSI T2,'LPT'
BMOVEMT2LISDEVLISDEVC	007554'	202100	000000*	04100		MOVEM T2,LISDEV#	;SAVE DEFAULT DEVICE
BTLOFL3QFLGC	007555'	661440	000004	04200	        TLO     FL3,QFLG
BMOVET3LSTCSPC	007556'	200140	007652'	04300	        MOVE    T3,LSTCSP       ;USE LISTER
BMOVEMT3PCNAMC	007557'	202140	007464*	04400	        MOVEM   T3,PCNAM        ;...
BLSTLP1MOVSIT2C	007560'	205100	446353	04500	LSTLP1:	MOVSI T2,'DSK'
BMOVEMT2LOKNAMC	007561'	202100	003722*	04600	        MOVEM T2,LOKNAM
BTROFLPIPFC	007562'	660000	010000	04700	        TRO     FL,PIPF ;IF IT'S PIP, ALLOW *.MAC, ETC.
BLSTLPPUSHJPSCANC	007563'	260740	000276'	04800	LSTLP:  PUSHJ P,SCAN    ;GET NAME
BIFNLSTRSWLSTLPPCAINCC	007564'	306700	000057	04900	IFN LSTRSW,<LSTLPP:     CAIN C,"/"
BJRSTPLSTSWC	007565'	254000	007666'	05000	        JRST PLSTSW>
BPUSHJPGETNAMC	007566'	260740	000116'	05100	        PUSHJ P,GETNAM
BMOVEIT3OUTLSTC	007567'	201140	010163'	05200	        MOVEI T3,OUTLST
BSKIPNT2SVDEVC	007570'	336100	007505*	05300	        SKIPN T2,SVDEV
BMOVET2LOKNAMDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 74-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	007571'	200100	007561*	05400	        MOVE T2,LOKNAM  ;USE PREV NAME IF NO NEW NAME
BMOVEMT2LOKNAMC	007572'	202100	007571*	05500	        MOVEM   T2,LOKNAM       ;KEEP DTA NAME AROUND FOR MORE FILES
BMOVEMT2SVDEVC	007573'	202100	007570*	05600		MOVEM T2,SVDEV
BMOVEIT4C	007574'	201200	000000	05700		MOVEI T4,0
BTROEFL3NEDCMAC	007575'	662440	000010	05800		TROE FL3,NEDCMA	;FIRST NAME?
BJRSTLSTNFC	007576'	254000	007605'	05900		JRST LSTNF	;NOPE
BCAIECC	007577'	302700	000137	06000		CAIE C,"_"	;YUP, CHECK FOR _ OR =
BCAINCC	007600'	306700	000075	06100		CAIN C,"="
BJRSTPUSHJPCMNOC				06200		JRST [	PUSHJ P,CMNO	;NAME FOLLOWED BY _ OR =, OUTPUT THE NAME
BMOVEIT1C				06300			MOVEI T1,"_"
BPUSHJPOUTLSTC				06400			PUSHJ P,OUTLST	;AND A _
BPUSHJPSCANC				06500			PUSHJ P,SCAN	;SCAN PAST _ OR =
BJRSTLSTLP1C	007601'	254000	011731'	06600			JRST LSTLP1]	;AND GO FOR NEXT NAME
BMOVET2LISDEVC	007602'	200100	007554*	06700		MOVE T2,LISDEV
BHRRIT2C	007603'	541100	327700	06800		HRRI T2,':_ '	;FIRST NAME NOT FOLLOWED BY _ OR = SO MUST
BPUSHJPOUTSIXC	007604'	260740	004206'	06900		PUSHJ P,OUTSIX	;BE USING DEFAULT DEVICE - GIVE IT TO LISTER
BLSTNFPUSHJPCMNOC	007605'	260740	003472'	07000	LSTNF:	PUSHJ P,CMNO	;OUTPUT NAME
BIFNLSTRSWHLLFL2FL3C	007606'	500400	000011	07100	IFN LSTRSW,<HLL FL2,FL3 ;SET TEMPS FROM PERMS
BMOVET1XWDPTABTTABC	007607'	200040	011736'	07200	        MOVE T1,[XWD PTAB,TTAB]
BBLTT1TTABLINESC	007610'	251040	000000*	07300	        BLT T1,TTAB+LINES>
BPUSHJPSCANC	007611'	260740	000276'	07400	        PUSHJ P,SCAN
BIFNLSTRSWTSWRTC	007612'			07500	IFN LSTRSW,<TSWRT:
BCAINCC	007612'	306700	000057	07600	        CAIN C,"/"
BJRSTTLSTSWC	007613'	254000	007674'	07700	        JRST TLSTSW
BMOVEIT3OUTLSTC	007614'	201140	010163'	07800	        MOVEI T3,OUTLST
BMOVET4XWDLSWBTLLSWBTBC	007615'	200200	011737'	07900	        MOVE T4,[XWD -LSWBTL,LSWBTB]
BPUSHJPSWBITSC	007616'	260740	003227'	08000	        PUSHJ P,SWBITS
BTLNNFL2T2C	007617'	607402	000000	08100	        TLNN FL2,(T2)
BMOVEIT4LINESC	007620'	201200	000003	08200	        MOVEI T4,LINES
BNXSLCTLNNFL2SPSTBT4C	007621'	607424	007652'	08300	NXSLC:  TLNN FL2,@SPSTB-1(T4)   ;IS BIT ON
BJRSTNOSPCC	007622'	254000	007631'	08400	        JRST NOSPC      ;NO
BMOVEIT1C	007623'	201040	000057	08500	        MOVEI T1,"/"
BPUSHJPOUTLSTC	007624'	260740	010163'	08600	        PUSHJ P,OUTLST
BMOVET1TTABT4C	007625'	200044	000000*	08700	        MOVE T1,TTAB(T4)
BPUSHJPOUTNUMC	007626'	260740	007657'	08800	        PUSHJ P,OUTNUM
BHLLZT2SPSTBT4C	007627'	510104	007652'	08900	        HLLZ T2,SPSTB-1(T4)
BPUSHJPOUTSIXC	007630'	260740	004206'	09000	        PUSHJ P,OUTSIX  ;THE SWITCH
BNOSPCSOJGT4NXSLCC	007631'	367200	007621'	09100	NOSPC:  SOJG T4,NXSLC
BCAIECC	007632'	302700	000050	09200	        CAIE C,"("
BJRSTENDLSTC	007633'	254000	007643'	09300	        JRST ENDLST
BSKIPAC	007634'	334000	000000	09400	        SKIPA   ;PASS PAGE INFO
BLST1PUSHJPGETCHC	007635'	260740	000342'	09500	LST1:   PUSHJ P,GETCH
BMOVET1CC	007636'	200040	000016	09600	        MOVE T1,C
BPUSHJPOUTLSTC	007637'	260740	010163'	09700	        PUSHJ P,OUTLST
BCAIECC	007640'	302700	000051	09800	        CAIE C,")"
BJRSTLST1C	007641'	254000	007635'	09900	        JRST LST1
BPUSHJPSCANC	007642'	260740	000276'	10000	        PUSHJ P,SCAN
BC				10100	>
BENDLSTCAINCC	007643'	306700	000054	10200	ENDLST: CAIN C,","      ;SHOULD BE COMMA OR CR
BJRSTMOVEIT1C				10300	        JRST [MOVEI T1,","
BPUSHJPT3C				10400	                PUSHJ P,0(T3)
BJRSTLSTLPC	007644'	254000	011740'	10500	                JRST LSTLP]
BTLNNCSTERMFC	007645'	607640	200000	10600	        TLNN CS,TERMF   ;SHOULD BE TERMINATOR
BJRSTSYNERRDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 74-3
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	007646'	254000	001065'	10700	        JRST SYNERR     ;WASNT
BENDLS1PUSHJPOUCRLFC	007647'	260740	010063'	10800	ENDLS1: PUSHJ   P,OUCRLF        ;ADD CRLF TO COMMAND
BIFETEMPC				10900	IFE TEMP,<      RELEASE CHNLST,0>
BIFNTEMPC				11000	IFN TEMP,<
BPUSHJPCHKLSTC	007650'	260740	010167'	11100	        PUSHJ   P,CHKLST        ;...>
BJRSTDONE1C	007651'	254000	001401'	11200	        JRST DONE1
BC
BLSTCSPIFELSTRSWC	007652'			11400	LSTCSP: IFE LSTRSW,<SIXBIT /PIP/>
BIFNLSTRSWSIXBITC	007652'	545163	644562	11500	        IFN LSTRSW,<SIXBIT /LISTER/>
BC
BDEFINEC				11700	DEFINE SPMK (A,B)
BSPMKC				11800	<<SIXBIT !A!>+B>
BC				11900	;THIS TABLE MUST BE IN THE SAME ORDER AS THE NUMBER TABLE
BSPSTBSPMKSIXBIT%BFLGC	007653'	420000	100000	12000	SPSTB:	SPMK B,%BFLG^<SIXBIT !B!>+%BFLG^
BSPMKC				12100		SPMK M,MFLG	;/LOL SWITCH(/M)
BSIXBITMFLGC	007654'	550000	000200		<SIXBIT !M!>+MFLG	
BSPMKC				12200		SPMK D,DFLG	;MUST BE LAST
BSIXBITDFLGC	007655'	440000	000100		<SIXBIT !D!>+DFLG	
BSPMKC				12300		SPMK B,%BFLG	;/SIZE SWITCH
BSIXBIT%BFLGC	007656'	420000	100000		<SIXBIT !B!>+%BFLG	
BC
BOUTNUMIDIVIT1C	007657'	231040	000012	12500	OUTNUM: IDIVI T1,^D10   ;RECOGNIZE THIS??
BHRLMT2PC	007660'	506117	000000	12600	        HRLM T2,(P)
BSKIPET1C	007661'	332000	000001	12700	        SKIPE T1
BPUSHJPOUTNUMC	007662'	260740	007657'	12800	        PUSHJ P,OUTNUM
BHLRZT1PC	007663'	554057	000000	12900	        HLRZ T1,(P)
BADDIT1C	007664'	271040	000060	13000	        ADDI T1,"0"
BJRSTT3C	007665'	254003	000000	13100	        JRST (T3)
BPLSTSWPUSHJPLSTSWDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 75
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	007666'	260740	007702'	00100	PLSTSW:        PUSHJ P,LSTSW
BTLZFL3T4C	007667'	621444	000000	00200	        TLZ FL3,(T4)
BMOVSST4C	007670'	207000	000004	00300	        MOVSS T4
BTLOFL3T4C	007671'	661444	000000	00400	        TLO FL3,(T4)
BMOVEMT2PTABT3C	007672'	202103	000000*	00500	        MOVEM T2,PTAB(T3)
BJRSTLSTLPPC	007673'	254000	007564'	00600	        JRST LSTLPP
BC
BTLSTSWPUSHJPLSTSWC	007674'	260740	007702'	00800	TLSTSW: PUSHJ P,LSTSW
BTLZFL2T4C	007675'	621404	000000	00900	        TLZ FL2,(T4)
BMOVSST4C	007676'	207000	000004	01000	        MOVSS T4
BTLOFL2T4C	007677'	661404	000000	01100	        TLO FL2,(T4)
BMOVEMT2TTABT3C	007700'	202103	007625*	01200	        MOVEM T2,TTAB(T3)
BJRSTTSWRTC	007701'	254000	007612'	01300	        JRST TSWRT
BC
BLSTSWPUSHJPSCANC	007702'	260740	000276'	01500	LSTSW:  PUSHJ P,SCAN
BTRNNFLIDFC	007703'	606000	000020	01600	        TRNN FL,IDF
BJRSTSYNERRC	007704'	254000	001065'	01700	        JRST SYNERR
BMOVET1XWDLLGLSTBLC	007705'	200040	011743'	01800	        MOVE T1,[XWD -LLG,LSTBL]
BPUSHJPSWSCANC	007706'	260740	002722'	01900	        PUSHJ P,SWSCAN
BJRSTUNRECSC	007707'	254000	001071'	02000	        JRST UNRECS
BJFCLC	007710'	255000	000000	02100	        JFCL
BSETZBT2T3C	007711'	403100	000003	02200	        SETZB T2,T3
BMOVET4LSTB2LSTBLT1C	007712'	200201	000040	02300	        MOVE T4,LSTB2-LSTBL(T1)
BTLNET4LIMSWC	007713'	603200	001000	02400	        TLNE T4,LIMSW
BJRSTT4C	007714'	254004	000000	02500	        JRST (T4)
BJRSTSCANC	007715'	254000	000276'	02600	        JRST SCAN
BC
BDEFINEC				02800	DEFINE TABLE
BTABLEC				02900	<SWITCH FORTRAN,<XWD PFLG,0>
BC				03000	SWITCH NOFORTRAN,PFLG
BC				03100	SWITCH NOCASE,<XWD LFLG,0>
BC				03200	SWITCH FULLCHARACTERSET,<XWD JFLG,KFLG>
BC				03300	SWITCH NOFULLCHARACTERSET,<XWD KFLG,JFLG>
BC				03400	SWITCH NORMALCHARACTERSET,<XWD 0,JFLG+KFLG>
BC				03500	SWITCH CASE,LFLG
BC				03600	SWITCH NOQUESTION,<XWD QFLG,0>
BC				03700	SWITCH QUESTION,QFLG
BC				03800	SWITCH SINGLE,DFLG
BC				03900	SWITCH DOUBLE,<XWD LIMSW,DOUBLE>
BC				04000	SWITCH MULTISPACE,<XWD LIMSW,MULTI>
BC				04100	SWITCH HEADING,HFLG
BC				04200	SWITCH NOHEADING,<XWD HFLG,0>
BC				04300	SWITCH SEQUENCE,NFLG
BC				04400	SWITCH NOSEQUENCE,<XWD NFLG,0>
BC				04500	SWITCH SKIPCONTROL,<XWD SFLG,0>
BC				04600	SWITCH NOSKIPCONTROL,SFLG
BC				04700	SWITCH SMALL,<XWD OFLG,0>
BC				04800	SWITCH LARGE,OFLG
BC				04900	SWITCH PAGED,<XWD GFLG,0>
BC				05000	SWITCH NOPAGE,GFLG
BC				05100	SWITCH CHEAD,<XWD IFLG,0>
BC				05200	SWITCH NOCHEAD,IFLG
BC				05300	SWITCH COUNT,<XWD EFLG,0>
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 75-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				05400	SWITCH NOCOUNT,EFLG
BC				05500	SWITCH ONENUM,<XWD AFLG,0>
BC				05600	SWITCH TWONUM,AFLG
BC				05700	SWITCH NOONENUM,AFLG
BC				05800	SWITCH SIZE,<XWD LIMSW,DSIZ>
BC				05900	SWITCH LOL,<XWD LIMSW,LOLER>
BC				06000	SWITCH RUN,<XWD LIMSW,SETRUN>
BC				06100	>
BTBGENDEFINEC				06200	TBGEN (LSTBL,LLG,LSTB2)^DEFINE SWITCH (P,Q)
BSWITCHC					<<SIXBIT /P/>>
BLSTBLTABLESWITCHSIXBITC	007716'	465762	646241		LSTBL:      TABLE^SWITCH FORTRAN,<XWD PFLG,0>^<SIXBIT /FORTRAN/>^
BSWITCHSIXBITC	007717'	565746	576264		SWITCH NOFORTRAN,PFLG^<SIXBIT /NOFORTRAN/>^
BSWITCHSIXBITC	007720'	565743	416345		SWITCH NOCASE,<XWD LFLG,0>^<SIXBIT /NOCASE/>^
BSWITCHSIXBITC	007721'	466554	544350		SWITCH FULLCHARACTERSET,<XWD JFLG,KFLG>^<SIXBIT /FULLCHARACTERSET/>^
BSWITCHSIXBITC	007722'	565746	655454		SWITCH NOFULLCHARACTERSET,<XWD KFLG,JFLG>^<SIXBIT /NOFULLCHARACTERSET/>^
BSWITCHSIXBITC	007723'	565762	554154		SWITCH NORMALCHARACTERSET,<XWD 0,JFLG+KFLG>^<SIXBIT /NORMALCHARACTERSET/>^
BSWITCHSIXBITC	007724'	434163	450000		SWITCH CASE,LFLG^<SIXBIT /CASE/>^
BSWITCHSIXBITC	007725'	565761	654563		SWITCH NOQUESTION,<XWD QFLG,0>^<SIXBIT /NOQUESTION/>^
BSWITCHSIXBITC	007726'	616545	636451		SWITCH QUESTION,QFLG^<SIXBIT /QUESTION/>^
BSWITCHSIXBITC	007727'	635156	475445		SWITCH SINGLE,DFLG^<SIXBIT /SINGLE/>^
BSWITCHSIXBITC	007730'	445765	425445		SWITCH DOUBLE,<XWD LIMSW,DOUBLE>^<SIXBIT /DOUBLE/>^
BSWITCHSIXBITC	007731'	556554	645163		SWITCH MULTISPACE,<XWD LIMSW,MULTI>^<SIXBIT /MULTISPACE/>^
BSWITCHSIXBITC	007732'	504541	445156		SWITCH HEADING,HFLG^<SIXBIT /HEADING/>^
BSWITCHSIXBITC	007733'	565750	454144		SWITCH NOHEADING,<XWD HFLG,0>^<SIXBIT /NOHEADING/>^
BSWITCHSIXBITC	007734'	634561	654556		SWITCH SEQUENCE,NFLG^<SIXBIT /SEQUENCE/>^
BSWITCHSIXBITC	007735'	565763	456165		SWITCH NOSEQUENCE,<XWD NFLG,0>^<SIXBIT /NOSEQUENCE/>^
BSWITCHSIXBITC	007736'	635351	604357		SWITCH SKIPCONTROL,<XWD SFLG,0>^<SIXBIT /SKIPCONTROL/>^
BSWITCHSIXBITC	007737'	565763	535160		SWITCH NOSKIPCONTROL,SFLG^<SIXBIT /NOSKIPCONTROL/>^
BSWITCHSIXBITC	007740'	635541	545400		SWITCH SMALL,<XWD OFLG,0>^<SIXBIT /SMALL/>^
BSWITCHSIXBITC	007741'	544162	474500		SWITCH LARGE,OFLG^<SIXBIT /LARGE/>^
BSWITCHSIXBITC	007742'	604147	454400		SWITCH PAGED,<XWD GFLG,0>^<SIXBIT /PAGED/>^
BSWITCHSIXBITC	007743'	565760	414745		SWITCH NOPAGE,GFLG^<SIXBIT /NOPAGE/>^
BSWITCHSIXBITC	007744'	435045	414400		SWITCH CHEAD,<XWD IFLG,0>^<SIXBIT /CHEAD/>^
BSWITCHSIXBITC	007745'	565743	504541		SWITCH NOCHEAD,IFLG^<SIXBIT /NOCHEAD/>^
BSWITCHSIXBITC	007746'	435765	566400		SWITCH COUNT,<XWD EFLG,0>^<SIXBIT /COUNT/>^
BSWITCHSIXBITC	007747'	565743	576556		SWITCH NOCOUNT,EFLG^<SIXBIT /NOCOUNT/>^
BSWITCHSIXBITC	007750'	575645	566555		SWITCH ONENUM,<XWD AFLG,0>^<SIXBIT /ONENUM/>^
BSWITCHSIXBITC	007751'	646757	566555		SWITCH TWONUM,AFLG^<SIXBIT /TWONUM/>^
BSWITCHSIXBITC	007752'	565757	564556		SWITCH NOONENUM,AFLG^<SIXBIT /NOONENUM/>^
BSWITCHSIXBITC	007753'	635172	450000		SWITCH SIZE,<XWD LIMSW,DSIZ>^<SIXBIT /SIZE/>^
BSWITCHSIXBITC	007754'	545754	000000		SWITCH LOL,<XWD LIMSW,LOLER>^<SIXBIT /LOL/>^
BSWITCHSIXBITC	007755'	626556	000000		SWITCH RUN,<XWD LIMSW,SETRUN>^<SIXBIT /RUN/>^
BLSTBLLLGDEFINESWITCHLSTB2TABLESWITCHXWDPFLGC	007756'	000001	000000		LSTB2:      TABLE^SWITCH FORTRAN,<XWD PFLG,0>^XWD PFLG,0^
BSWITCHPFLGC	007757'	000000	000001		SWITCH NOFORTRAN,PFLG^PFLG^
BSWITCHXWDLFLGC	007760'	000002	000000		SWITCH NOCASE,<XWD LFLG,0>^XWD LFLG,0^
BSWITCHXWDJFLGKFLGC	007761'	000400	200000		SWITCH FULLCHARACTERSET,<XWD JFLG,KFLG>^XWD JFLG,KFLG^
BSWITCHXWDKFLGJFLGC	007762'	200000	000400		SWITCH NOFULLCHARACTERSET,<XWD KFLG,JFLG>^XWD KFLG,JFLG^
BSWITCHXWDJFLGKFLGC	007763'	000000	200400		SWITCH NORMALCHARACTERSET,<XWD 0,JFLG+KFLG>^XWD 0,JFLG+KFLG^
BSWITCHLFLGC	007764'	000000	000002		SWITCH CASE,LFLG^LFLG^
BSWITCHXWDQFLGC	007765'	000004	000000		SWITCH NOQUESTION,<XWD QFLG,0>^XWD QFLG,0^
BSWITCHQFLGC	007766'	000000	000004		SWITCH QUESTION,QFLG^QFLG^
BSWITCHDFLGC	007767'	000000	000100		SWITCH SINGLE,DFLG^DFLG^
BSWITCHXWDLIMSWDOUBLEC	007770'	001000	010051'		SWITCH DOUBLE,<XWD LIMSW,DOUBLE>^XWD LIMSW,DOUBLE^
BSWITCHXWDLIMSWMULTIDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 75-3
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	007771'	001000	010042'		SWITCH MULTISPACE,<XWD LIMSW,MULTI>^XWD LIMSW,MULTI^
BSWITCHHFLGC	007772'	000000	000010		SWITCH HEADING,HFLG^HFLG^
BSWITCHXWDHFLGC	007773'	000010	000000		SWITCH NOHEADING,<XWD HFLG,0>^XWD HFLG,0^
BSWITCHNFLGC	007774'	000000	000020		SWITCH SEQUENCE,NFLG^NFLG^
BSWITCHXWDNFLGC	007775'	000020	000000		SWITCH NOSEQUENCE,<XWD NFLG,0>^XWD NFLG,0^
BSWITCHXWDSFLGC	007776'	000040	000000		SWITCH SKIPCONTROL,<XWD SFLG,0>^XWD SFLG,0^
BSWITCHSFLGC	007777'	000000	000040		SWITCH NOSKIPCONTROL,SFLG^SFLG^
BSWITCHXWDOFLGC	010000'	002000	000000		SWITCH SMALL,<XWD OFLG,0>^XWD OFLG,0^
BSWITCHOFLGC	010001'	000000	002000		SWITCH LARGE,OFLG^OFLG^
BSWITCHXWDGFLGC	010002'	004000	000000		SWITCH PAGED,<XWD GFLG,0>^XWD GFLG,0^
BSWITCHGFLGC	010003'	000000	004000		SWITCH NOPAGE,GFLG^GFLG^
BSWITCHXWDIFLGC	010004'	010000	000000		SWITCH CHEAD,<XWD IFLG,0>^XWD IFLG,0^
BSWITCHIFLGC	010005'	000000	010000		SWITCH NOCHEAD,IFLG^IFLG^
BSWITCHXWDEFLGC	010006'	020000	000000		SWITCH COUNT,<XWD EFLG,0>^XWD EFLG,0^
BSWITCHEFLGC	010007'	000000	020000		SWITCH NOCOUNT,EFLG^EFLG^
BSWITCHXWDAFLGC	010010'	040000	000000		SWITCH ONENUM,<XWD AFLG,0>^XWD AFLG,0^
BSWITCHAFLGC	010011'	000000	040000		SWITCH TWONUM,AFLG^AFLG^
BSWITCHAFLGC	010012'	000000	040000		SWITCH NOONENUM,AFLG^AFLG^
BSWITCHXWDLIMSWDSIZC	010013'	001000	010033'		SWITCH SIZE,<XWD LIMSW,DSIZ>^XWD LIMSW,DSIZ^
BSWITCHXWDLIMSWLOLERC	010014'	001000	010054'		SWITCH LOL,<XWD LIMSW,LOLER>^XWD LIMSW,LOLER^
BSWITCHXWDLIMSWSETRUNC	010015'	001000	000055'		SWITCH RUN,<XWD LIMSW,SETRUN>^XWD LIMSW,SETRUN^
BLSWBTBSBTSSIXBITPFLGC	010016'	176000	000001	06300	LSWBTB: SBTS P,PFLG^<SIXBIT !/P!>+PFLG^
BSBTSSIXBITLFLGC	010017'	175400	000002	06400	        SBTS L,LFLG^<SIXBIT !/L!>+LFLG^
BSBTSSIXBITQFLGC	010020'	176100	000004	06500	        SBTS Q,QFLG^<SIXBIT !/Q!>+QFLG^
BSBTSSIXBITHFLGC	010021'	175000	000010	06600	        SBTS H,HFLG^<SIXBIT !/H!>+HFLG^
BSBTSSIXBITNFLGC	010022'	175600	000020	06700	        SBTS N,NFLG^<SIXBIT !/N!>+NFLG^
BSBTSSIXBITSFLGC	010023'	176300	000040	06800	        SBTS S,SFLG^<SIXBIT !/S!>+SFLG^
BSBTSSIXBITOFLGC	010024'	175700	002000	06900		SBTS O,OFLG^<SIXBIT !/O!>+OFLG^
BSBTSSIXBITGFLGC	010025'	174700	004000	07000		SBTS G,GFLG^<SIXBIT !/G!>+GFLG^
BSBTSSIXBITAFLGC	010026'	174100	040000	07100		SBTS A,AFLG^<SIXBIT !/A!>+AFLG^
BSBTSSIXBITEFLGC	010027'	174500	020000	07200		SBTS E,EFLG^<SIXBIT !/E!>+EFLG^
BSBTSSIXBITIFLGC	010030'	175100	010000	07300		SBTS I,IFLG^<SIXBIT !/I!>+IFLG^
BSBTSC				07400		SBTS J,JFLG	;/J(FULLCH)
BSIXBITJFLGC	010031'	175200	000400		<SIXBIT !/J!>+JFLG	
BSBTSC				07500		SBTS K,KFLG	;/K(/NOFULLCH)
BSIXBITKFLGC	010032'	175300	200000		<SIXBIT !/K!>+KFLG	
BLSWBTBLSWBTLC			000015	07600	LSWBTL==.-LSWBTB
BDSIZPUSHJPSTARGSDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 76
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	010033'	260740	010727'	00100	DSIZ:	PUSHJ	P,STARGS
BC				00200	;ROUTINE FOR /SIZE SWITCH
BTRNNFLNUMFSC	010034'	606000	000100	00300		TRNN	FL,NUMFS
BJRSTSYNERRC	010035'	254000	001065'	00400		JRST	SYNERR
BMOVET2NUMACC	010036'	200100	005335*	00500		MOVE	T2,NUMAC
BMOVSIT4%BFLGC	010037'	205200	100000	00600		MOVSI	T4,%BFLG
BMOVEIT3SIZEPC	010040'	201140	000001	00700		MOVEI	T3,SIZEP
BJRSTFINPRSC	010041'	254000	010721'	00800		JRST	FINPRS
BC
BMULTIPUSHJPSTARGSC	010042'	260740	010727'	01000	MULTI:  PUSHJ P,STARGS
BTRNNFLNUMFSC	010043'	606000	000100	01100	        TRNN FL,NUMFS
BJRSTSYNERRC	010044'	254000	001065'	01200	        JRST SYNERR
BMOVET2NUMACC	010045'	200100	010036*	01300	        MOVE T2,NUMAC
BMULTICMOVSIT4DFLGC	010046'	205200	000100	01400	MULTIC: MOVSI T4,DFLG
BMOVEIT3LINESC	010047'	201140	000003	01500	        MOVEI T3,LINES
BJRSTFINPRSC	010050'	254000	010721'	01600	        JRST FINPRS
BC
BDOUBLEMOVEIT2C	010051'	201100	000001	01800	DOUBLE: MOVEI T2,1
BTRZFL3PARFLGC	010052'	620440	000004	01900	        TRZ FL3,PARFLG
BJRSTMULTICC	010053'	254000	010046'	02000	        JRST MULTIC
BC
BC				02200	;CODE TO HANDLE THE /LOL SWITCH
BLOLERPUSHJPSTARGSC	010054'	260740	010727'	02300	LOLER:	PUSHJ	P,STARGS	;SET UP ARGUMENTS
BTRNNFLNUMFSC	010055'	606000	000100	02400		TRNN	FL,NUMFS	;SAY WE ARE SCANNING FOR A NUMBER
BJRSTSYNERRC	010056'	254000	001065'	02500		JRST	SYNERR		;NO -- BAD
BMOVET2NUMACC	010057'	200100	010045*	02600		MOVE	T2,NUMAC
BMOVSIT4MFLGC	010060'	205200	000200	02700		MOVSI	T4,MFLG		;SAY WHICH FLAG TO SCAN FOR IN TBL
BMOVEIT3LOLSC	010061'	201140	000002	02800		MOVEI	T3,LOLS		;TABLE ENTRY #
BJRSTFINPRSC	010062'	254000	010721'	02900		JRST	FINPRS		;FINISH NUMBER SCAN
BOUCRLFMOVEIT1DRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 77
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	010063'	201040	000015	00100	OUCRLF: MOVEI   T1,15   ;CARRIAGE RETURN
BPUSHJPT3C	010064'	260743	000000	00200	        PUSHJ   P,0(T3)         ;TO CURRENT OUTPUT FILE
BMOVEIT1C	010065'	201040	000012	00300	        MOVEI   T1,12           ;LINE FEED
BJRSTT3C	010066'	254003	000000	00400	        JRST    0(T3)           ;TO OUTPUT FILE
BDEFINEDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 78
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	DEFINE ORTNS
BORTNSC				00200	<
BC				00300	PROCESS
BC				00400	;ALSO THESE
BC				00500	X LOADER,LOD
BC				00600	X DIRIT,DIR
BC				00700	IFN LSTRSW,<X LIST,LST>
BC				00800	X PIP,PIP
BC				00900	X CREF,CRF
BC				01000	X EDT,EDT
BC				01100	X FCM,FCM
BC				01200	>
BC
BDEFINEC				01400	DEFINE X (A,B,C,D,E)
BXC				01500	<OUT'B: MOVEI T5,NORT   ;SET UP INDEX NUMBER
BC				01600	        TRON FL2,FCH'B  ;CHACK FOR INITED
BC				01700	        PUSHJ P,INITCH  ;AND INIT IF NEEDED
BC				01800	        JRST COMNIT     ;COMMON ROUTINE
BC				01900	IFN TEMP,<
BC				02000	CHK'B:  MOVEI T5,NORT
BC				02100	        JRST COMCHK>
BC				02200	NORT==NORT+1>
BC
BNORTC			000000	02400	NORT==0
BORTNSC				02500	        ORTNS^
BPROCESXOUTF4MOVEIT5NORTC	010067'	201240	000000		X FORTRAN,F4,F40^OUTF4: MOVEI T5,NORT   ;SET UP INDEX NUMBER
BTRONFL2FCHF4C	010070'	666400	400000		        TRON FL2,FCHF4  ;CHACK FOR INITED
BPUSHJPINITCHC	010071'	260740	010525'		        PUSHJ P,INITCH  ;AND INIT IF NEEDED
BJRSTCOMNITC	010072'	254000	010466'		        JRST COMNIT     ;COMMON ROUTINE
BIFNTEMPCHKF4MOVEIT5NORTC	010073'	201240	000000		CHKF4:  MOVEI T5,NORT
BJRSTCOMCHKC	010074'	254000	010500'		        JRST COMCHK>
BNORTNORTXOUTMACMOVEIT5NORTC	010075'	201240	000001		X MACRO,MAC,MACRO^OUTMAC: MOVEI T5,NORT   ;SET UP INDEX NUMBER
BTRONFL2FCHMACC	010076'	666400	200000		        TRON FL2,FCHMAC  ;CHACK FOR INITED
BPUSHJPINITCHC	010077'	260740	010525'		        PUSHJ P,INITCH  ;AND INIT IF NEEDED
BJRSTCOMNITC	010100'	254000	010466'		        JRST COMNIT     ;COMMON ROUTINE
BIFNTEMPCHKMACMOVEIT5NORTC	010101'	201240	000001		CHKMAC:  MOVEI T5,NORT
BJRSTCOMCHKC	010102'	254000	010500'		        JRST COMCHK>
BNORTNORTXOUTFTFMOVEIT5NORTC	010103'	201240	000002		X FTFORTRAN,FTF,FTF40^OUTFTF: MOVEI T5,NORT   ;SET UP INDEX NUMBER
BTRONFL2FCHFTFC	010104'	666400	100000		        TRON FL2,FCHFTF  ;CHACK FOR INITED
BPUSHJPINITCHC	010105'	260740	010525'		        PUSHJ P,INITCH  ;AND INIT IF NEEDED
BJRSTCOMNITC	010106'	254000	010466'		        JRST COMNIT     ;COMMON ROUTINE
BIFNTEMPCHKFTFMOVEIT5NORTC	010107'	201240	000002		CHKFTF:  MOVEI T5,NORT
BJRSTCOMCHKC	010110'	254000	010500'		        JRST COMCHK>
BNORTNORTXOUTSIMMOVEIT5NORTC	010111'	201240	000003		X SIMPL,SIM,SIMPL^OUTSIM: MOVEI T5,NORT   ;SET UP INDEX NUMBER
BTRONFL2FCHSIMC	010112'	666400	040000		        TRON FL2,FCHSIM  ;CHACK FOR INITED
BPUSHJPINITCHC	010113'	260740	010525'		        PUSHJ P,INITCH  ;AND INIT IF NEEDED
BJRSTCOMNITC	010114'	254000	010466'		        JRST COMNIT     ;COMMON ROUTINE
BIFNTEMPCHKSIMMOVEIT5NORTC	010115'	201240	000003		CHKSIM:  MOVEI T5,NORT
BJRSTCOMCHKC	010116'	254000	010500'		        JRST COMCHK>
BNORTNORTXOUTFALMOVEIT5NORTC	010117'	201240	000004		X FAIL,FAL,FAIL^OUTFAL: MOVEI T5,NORT   ;SET UP INDEX NUMBER
BTRONFL2FCHFALC	010120'	666400	020000		        TRON FL2,FCHFAL  ;CHACK FOR INITED
BPUSHJPINITCHC	010121'	260740	010525'		        PUSHJ P,INITCH  ;AND INIT IF NEEDED
BJRSTCOMNITC	010122'	254000	010466'		        JRST COMNIT     ;COMMON ROUTINE
BIFNTEMPDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 78-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BCHKFALMOVEIT5NORTC	010123'	201240	000004		CHKFAL:  MOVEI T5,NORT
BJRSTCOMCHKC	010124'	254000	010500'		        JRST COMCHK>
BNORTNORTXOUTCBLMOVEIT5NORTC	010125'	201240	000005		X COBOL,CBL,COBOL^OUTCBL: MOVEI T5,NORT   ;SET UP INDEX NUMBER
BTRONFL2FCHCBLC	010126'	666400	010000		        TRON FL2,FCHCBL  ;CHACK FOR INITED
BPUSHJPINITCHC	010127'	260740	010525'		        PUSHJ P,INITCH  ;AND INIT IF NEEDED
BJRSTCOMNITC	010130'	254000	010466'		        JRST COMNIT     ;COMMON ROUTINE
BIFNTEMPCHKCBLMOVEIT5NORTC	010131'	201240	000005		CHKCBL:  MOVEI T5,NORT
BJRSTCOMCHKC	010132'	254000	010500'		        JRST COMCHK>
BNORTNORTXOUTBLIMOVEIT5NORTC	010133'	201240	000006		X BLIMP,BLI,BLISS^OUTBLI: MOVEI T5,NORT   ;SET UP INDEX NUMBER
BTRONFL2FCHBLIC	010134'	666400	004000		        TRON FL2,FCHBLI  ;CHACK FOR INITED
BPUSHJPINITCHC	010135'	260740	010525'		        PUSHJ P,INITCH  ;AND INIT IF NEEDED
BJRSTCOMNITC	010136'	254000	010466'		        JRST COMNIT     ;COMMON ROUTINE
BIFNTEMPCHKBLIMOVEIT5NORTC	010137'	201240	000006		CHKBLI:  MOVEI T5,NORT
BJRSTCOMCHKC	010140'	254000	010500'		        JRST COMCHK>
BNORTNORTXOUTVASMOVEIT5NORTC	010141'	201240	000007		X VAS,VAS,VAS^OUTVAS: MOVEI T5,NORT   ;SET UP INDEX NUMBER
BTRONFL2FCHVASC	010142'	666400	002000		        TRON FL2,FCHVAS  ;CHACK FOR INITED
BPUSHJPINITCHC	010143'	260740	010525'		        PUSHJ P,INITCH  ;AND INIT IF NEEDED
BJRSTCOMNITC	010144'	254000	010466'		        JRST COMNIT     ;COMMON ROUTINE
BIFNTEMPCHKVASMOVEIT5NORTC	010145'	201240	000007		CHKVAS:  MOVEI T5,NORT
BJRSTCOMCHKC	010146'	254000	010500'		        JRST COMCHK>
BNORTNORTXOUTLODMOVEIT5NORTC	010147'	201240	000010		X LOADER,LOD^OUTLOD: MOVEI T5,NORT   ;SET UP INDEX NUMBER
BTRONFL2FCHLODC	010150'	666400	001000		        TRON FL2,FCHLOD  ;CHACK FOR INITED
BPUSHJPINITCHC	010151'	260740	010525'		        PUSHJ P,INITCH  ;AND INIT IF NEEDED
BJRSTCOMNITC	010152'	254000	010466'		        JRST COMNIT     ;COMMON ROUTINE
BIFNTEMPCHKLODMOVEIT5NORTC	010153'	201240	000010		CHKLOD:  MOVEI T5,NORT
BJRSTCOMCHKC	010154'	254000	010500'		        JRST COMCHK>
BNORTNORTXOUTDIRMOVEIT5NORTC	010155'	201240	000011		X DIRIT,DIR^OUTDIR: MOVEI T5,NORT   ;SET UP INDEX NUMBER
BTRONFL2FCHDIRC	010156'	666400	001000		        TRON FL2,FCHDIR  ;CHACK FOR INITED
BPUSHJPINITCHC	010157'	260740	010525'		        PUSHJ P,INITCH  ;AND INIT IF NEEDED
BJRSTCOMNITC	010160'	254000	010466'		        JRST COMNIT     ;COMMON ROUTINE
BIFNTEMPCHKDIRMOVEIT5NORTC	010161'	201240	000011		CHKDIR:  MOVEI T5,NORT
BJRSTCOMCHKC	010162'	254000	010500'		        JRST COMCHK>
BNORTNORTIFNLSTRSWXOUTLSTMOVEIT5NORTC	010163'	201240	000012		IFN LSTRSW,<X LIST,LST>^OUTLST: MOVEI T5,NORT   ;SET UP INDEX NUMBER
BTRONFL2FCHLSTC	010164'	666400	001000		        TRON FL2,FCHLST  ;CHACK FOR INITED
BPUSHJPINITCHC	010165'	260740	010525'		        PUSHJ P,INITCH  ;AND INIT IF NEEDED
BJRSTCOMNITC	010166'	254000	010466'		        JRST COMNIT     ;COMMON ROUTINE
BIFNTEMPCHKLSTMOVEIT5NORTC	010167'	201240	000012		CHKLST:  MOVEI T5,NORT
BJRSTCOMCHKC	010170'	254000	010500'		        JRST COMCHK>
BNORTNORTXOUTPIPMOVEIT5NORTC	010171'	201240	000013		X PIP,PIP^OUTPIP: MOVEI T5,NORT   ;SET UP INDEX NUMBER
BTRONFL2FCHPIPC	010172'	666400	001000		        TRON FL2,FCHPIP  ;CHACK FOR INITED
BPUSHJPINITCHC	010173'	260740	010525'		        PUSHJ P,INITCH  ;AND INIT IF NEEDED
BJRSTCOMNITC	010174'	254000	010466'		        JRST COMNIT     ;COMMON ROUTINE
BIFNTEMPCHKPIPMOVEIT5NORTC	010175'	201240	000013		CHKPIP:  MOVEI T5,NORT
BJRSTCOMCHKC	010176'	254000	010500'		        JRST COMCHK>
BNORTNORTXOUTCRFMOVEIT5NORTC	010177'	201240	000014		X CREF,CRF^OUTCRF: MOVEI T5,NORT   ;SET UP INDEX NUMBER
BTRONFL2FCHCRFC	010200'	666400	000400		        TRON FL2,FCHCRF  ;CHACK FOR INITED
BPUSHJPINITCHC	010201'	260740	010525'		        PUSHJ P,INITCH  ;AND INIT IF NEEDED
BJRSTCOMNITC	010202'	254000	010466'		        JRST COMNIT     ;COMMON ROUTINE
BIFNTEMPCHKCRFMOVEIT5NORTC	010203'	201240	000014		CHKCRF:  MOVEI T5,NORT
BJRSTCOMCHKC	010204'	254000	010500'		        JRST COMCHK>
BNORTNORTXOUTEDTMOVEIT5NORTC	010205'	201240	000015		X EDT,EDT^OUTEDT: MOVEI T5,NORT   ;SET UP INDEX NUMBER
BTRONFL2FCHEDTC	010206'	666400	001000		        TRON FL2,FCHEDT  ;CHACK FOR INITED
BPUSHJPINITCHC	010207'	260740	010525'		        PUSHJ P,INITCH  ;AND INIT IF NEEDED
BJRSTCOMNITDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 78-3
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	010210'	254000	010466'		        JRST COMNIT     ;COMMON ROUTINE
BIFNTEMPCHKEDTMOVEIT5NORTC	010211'	201240	000015		CHKEDT:  MOVEI T5,NORT
BJRSTCOMCHKC	010212'	254000	010500'		        JRST COMCHK>
BNORTNORTXOUTFCMMOVEIT5NORTC	010213'	201240	000016		X FCM,FCM^OUTFCM: MOVEI T5,NORT   ;SET UP INDEX NUMBER
BTRONFL2FCHFCMC	010214'	666400	001000		        TRON FL2,FCHFCM  ;CHACK FOR INITED
BPUSHJPINITCHC	010215'	260740	010525'		        PUSHJ P,INITCH  ;AND INIT IF NEEDED
BJRSTCOMNITC	010216'	254000	010466'		        JRST COMNIT     ;COMMON ROUTINE
BIFNTEMPCHKFCMMOVEIT5NORTC	010217'	201240	000016		CHKFCM:  MOVEI T5,NORT
BJRSTCOMCHKC	010220'	254000	010500'		        JRST COMCHK>
BNORTNORTC
BARRAYNORTBFLGBJFFNORTBOBC				02700	ARRAY BJFF,BFLG[NORT],BOB[NORT*3]
BC
BBOB0FORXXXC			000000	02900	BOB0:   FOR (0,NORT,BOB+XXX*3)^XXX==0
BREPEATNORTBOBBOBXXXC	010221'	000000	000000*		BOB+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010222'	000000	000000*		BOB+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010223'	000000	000000*		BOB+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010224'	000000	000000*		BOB+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010225'	000000	000000*		BOB+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010226'	000000	000000*		BOB+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010227'	000000	000000*		BOB+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010230'	000000	000000*		BOB+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010231'	000000	000000*		BOB+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010232'	000000	000000*		BOB+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010233'	000000	000000*		BOB+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010234'	000000	000000*		BOB+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010235'	000000	000000*		BOB+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010236'	000000	000000*		BOB+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010237'	000000	000000*		BOB+XXX*3
BIFBXXXXXXIFNBBOB1FORXXXC			000000	03000	BOB1:   FOR (0,NORT,BOB+1+XXX*3)^XXX==0
BREPEATNORTBOBBOBXXXC	010240'	000000	000000*		BOB+1+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010241'	000000	000000*		BOB+1+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010242'	000000	000000*		BOB+1+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010243'	000000	000000*		BOB+1+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010244'	000000	000000*		BOB+1+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010245'	000000	000000*		BOB+1+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010246'	000000	000000*		BOB+1+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010247'	000000	000000*		BOB+1+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010250'	000000	000000*		BOB+1+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010251'	000000	000000*		BOB+1+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010252'	000000	000000*		BOB+1+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010253'	000000	000000*		BOB+1+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010254'	000000	000000*		BOB+1+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010255'	000000	000000*		BOB+1+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010256'	000000	000000*		BOB+1+XXX*3
BIFBXXXXXXIFNBBOB2FORXXXC			000000	03100	BOB2:   FOR (0,NORT,BOB+2+XXX*3)^XXX==0
BREPEATNORTBOBBOBXXXC	010257'	000000	000000*		BOB+2+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010260'	000000	000000*		BOB+2+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010261'	000000	000000*		BOB+2+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010262'	000000	000000*		BOB+2+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010263'	000000	000000*		BOB+2+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010264'	000000	000000*		BOB+2+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010265'	000000	000000*		BOB+2+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010266'	000000	000000*		BOB+2+XXX*3
BIFBXXXXXXDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 78-4
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BIFNBBOBBOBXXXC	010267'	000000	000000*		BOB+2+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010270'	000000	000000*		BOB+2+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010271'	000000	000000*		BOB+2+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010272'	000000	000000*		BOB+2+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010273'	000000	000000*		BOB+2+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010274'	000000	000000*		BOB+2+XXX*3
BIFBXXXXXXIFNBBOBBOBXXXC	010275'	000000	000000*		BOB+2+XXX*3
BIFBXXXXXXIFNBC
BIFNTEMPC				03300	IFN TEMP,<
BDEFINEC				03400	DEFINE X(A,B,C,D,E)
BXC				03500	<       RELEASE CHN'B,0>
BRLTBORTNSC	010276'			03600	RLTB:   ORTNS>^
BPROCESXRELEASCHNF4C	010276'	071740	000000		X FORTRAN,F4,F40^       RELEASE CHNF4,0^
BXRELEASCHNMACC	010277'	071700	000000		X MACRO,MAC,MACRO^       RELEASE CHNMAC,0^
BXRELEASCHNFTFC	010300'	071640	000000		X FTFORTRAN,FTF,FTF40^       RELEASE CHNFTF,0^
BXRELEASCHNSIMC	010301'	071600	000000		X SIMPL,SIM,SIMPL^       RELEASE CHNSIM,0^
BXRELEASCHNFALC	010302'	071540	000000		X FAIL,FAL,FAIL^       RELEASE CHNFAL,0^
BXRELEASCHNCBLC	010303'	071500	000000		X COBOL,CBL,COBOL^       RELEASE CHNCBL,0^
BXRELEASCHNBLIC	010304'	071440	000000		X BLIMP,BLI,BLISS^       RELEASE CHNBLI,0^
BXRELEASCHNVASC	010305'	071400	000000		X VAS,VAS,VAS^       RELEASE CHNVAS,0^
BXRELEASCHNLODC	010306'	071340	000000		X LOADER,LOD^       RELEASE CHNLOD,0^
BXRELEASCHNDIRC	010307'	071340	000000		X DIRIT,DIR^       RELEASE CHNDIR,0^
BIFNLSTRSWXRELEASCHNLSTC	010310'	071340	000000		IFN LSTRSW,<X LIST,LST>^       RELEASE CHNLST,0^
BXRELEASCHNPIPC	010311'	071340	000000		X PIP,PIP^       RELEASE CHNPIP,0^
BXRELEASCHNCRFC	010312'	071300	000000		X CREF,CRF^       RELEASE CHNCRF,0^
BXRELEASCHNEDTC	010313'	071340	000000		X EDT,EDT^       RELEASE CHNEDT,0^
BXRELEASCHNFCMC	010314'	071340	000000		X FCM,FCM^       RELEASE CHNFCM,0^
BC
BDEFINEC				03800	DEFINE X(A,B,C,D,E)
BXC				03900	<       OUT CHN'B,0>
BOTABORTNSC	010315'			04000	OTAB:   ORTNS^
BPROCESXOUTCHNF4C	010315'	057740	000000		X FORTRAN,F4,F40^       OUT CHNF4,0^
BXOUTCHNMACC	010316'	057700	000000		X MACRO,MAC,MACRO^       OUT CHNMAC,0^
BXOUTCHNFTFC	010317'	057640	000000		X FTFORTRAN,FTF,FTF40^       OUT CHNFTF,0^
BXOUTCHNSIMC	010320'	057600	000000		X SIMPL,SIM,SIMPL^       OUT CHNSIM,0^
BXOUTCHNFALC	010321'	057540	000000		X FAIL,FAL,FAIL^       OUT CHNFAL,0^
BXOUTCHNCBLC	010322'	057500	000000		X COBOL,CBL,COBOL^       OUT CHNCBL,0^
BXOUTCHNBLIC	010323'	057440	000000		X BLIMP,BLI,BLISS^       OUT CHNBLI,0^
BXOUTCHNVASC	010324'	057400	000000		X VAS,VAS,VAS^       OUT CHNVAS,0^
BXOUTCHNLODC	010325'	057340	000000		X LOADER,LOD^       OUT CHNLOD,0^
BXOUTCHNDIRC	010326'	057340	000000		X DIRIT,DIR^       OUT CHNDIR,0^
BIFNLSTRSWXOUTCHNLSTC	010327'	057340	000000		IFN LSTRSW,<X LIST,LST>^       OUT CHNLST,0^
BXOUTCHNPIPC	010330'	057340	000000		X PIP,PIP^       OUT CHNPIP,0^
BXOUTCHNCRFC	010331'	057300	000000		X CREF,CRF^       OUT CHNCRF,0^
BXOUTCHNEDTC	010332'	057340	000000		X EDT,EDT^       OUT CHNEDT,0^
BXOUTCHNFCMC	010333'	057340	000000		X FCM,FCM^       OUT CHNFCM,0^
BC
BDEFINEC				04200	DEFINE X(A,B,C,D,E)
BXC				04300	<       ENTER CHN'B,NAME>
BENTBORTNSC	010334'			04400	ENTB:   ORTNS^
BPROCESXENTERCHNF4NAMEC	010334'	077740	004167*		X FORTRAN,F4,F40^       ENTER CHNF4,NAME^
BXENTERCHNMACNAMEC	010335'	077700	010334*		X MACRO,MAC,MACRO^       ENTER CHNMAC,NAME^
BXENTERCHNFTFNAMEC	010336'	077640	010335*		X FTFORTRAN,FTF,FTF40^       ENTER CHNFTF,NAME^
BXENTERCHNSIMNAMEDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 78-5
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	010337'	077600	010336*		X SIMPL,SIM,SIMPL^       ENTER CHNSIM,NAME^
BXENTERCHNFALNAMEC	010340'	077540	010337*		X FAIL,FAL,FAIL^       ENTER CHNFAL,NAME^
BXENTERCHNCBLNAMEC	010341'	077500	010340*		X COBOL,CBL,COBOL^       ENTER CHNCBL,NAME^
BXENTERCHNBLINAMEC	010342'	077440	010341*		X BLIMP,BLI,BLISS^       ENTER CHNBLI,NAME^
BXENTERCHNVASNAMEC	010343'	077400	010342*		X VAS,VAS,VAS^       ENTER CHNVAS,NAME^
BXENTERCHNLODNAMEC	010344'	077340	010343*		X LOADER,LOD^       ENTER CHNLOD,NAME^
BXENTERCHNDIRNAMEC	010345'	077340	010344*		X DIRIT,DIR^       ENTER CHNDIR,NAME^
BIFNLSTRSWXENTERCHNLSTNAMEC	010346'	077340	010345*		IFN LSTRSW,<X LIST,LST>^       ENTER CHNLST,NAME^
BXENTERCHNPIPNAMEC	010347'	077340	010346*		X PIP,PIP^       ENTER CHNPIP,NAME^
BXENTERCHNCRFNAMEC	010350'	077300	010347*		X CREF,CRF^       ENTER CHNCRF,NAME^
BXENTERCHNEDTNAMEC	010351'	077340	010350*		X EDT,EDT^       ENTER CHNEDT,NAME^
BXENTERCHNFCMNAMEC	010352'	077340	010351*		X FCM,FCM^       ENTER CHNFCM,NAME^
BC
BDEFINEC				04600	DEFINE X(A,B,C,D,E)
BXC				04700	<       OPEN CHN'B,NSDOPN>
BOPNTBORTNSC	010353'			04800	OPNTB:  ORTNS^
BPROCESXOPENCHNF4NSDOPNC	010353'	050740	000000*		X FORTRAN,F4,F40^       OPEN CHNF4,NSDOPN^
BXOPENCHNMACNSDOPNC	010354'	050700	010353*		X MACRO,MAC,MACRO^       OPEN CHNMAC,NSDOPN^
BXOPENCHNFTFNSDOPNC	010355'	050640	010354*		X FTFORTRAN,FTF,FTF40^       OPEN CHNFTF,NSDOPN^
BXOPENCHNSIMNSDOPNC	010356'	050600	010355*		X SIMPL,SIM,SIMPL^       OPEN CHNSIM,NSDOPN^
BXOPENCHNFALNSDOPNC	010357'	050540	010356*		X FAIL,FAL,FAIL^       OPEN CHNFAL,NSDOPN^
BXOPENCHNCBLNSDOPNC	010360'	050500	010357*		X COBOL,CBL,COBOL^       OPEN CHNCBL,NSDOPN^
BXOPENCHNBLINSDOPNC	010361'	050440	010360*		X BLIMP,BLI,BLISS^       OPEN CHNBLI,NSDOPN^
BXOPENCHNVASNSDOPNC	010362'	050400	010361*		X VAS,VAS,VAS^       OPEN CHNVAS,NSDOPN^
BXOPENCHNLODNSDOPNC	010363'	050340	010362*		X LOADER,LOD^       OPEN CHNLOD,NSDOPN^
BXOPENCHNDIRNSDOPNC	010364'	050340	010363*		X DIRIT,DIR^       OPEN CHNDIR,NSDOPN^
BIFNLSTRSWXOPENCHNLSTNSDOPNC	010365'	050340	010364*		IFN LSTRSW,<X LIST,LST>^       OPEN CHNLST,NSDOPN^
BXOPENCHNPIPNSDOPNC	010366'	050340	010365*		X PIP,PIP^       OPEN CHNPIP,NSDOPN^
BXOPENCHNCRFNSDOPNC	010367'	050300	010366*		X CREF,CRF^       OPEN CHNCRF,NSDOPN^
BXOPENCHNEDTNSDOPNC	010370'	050340	010367*		X EDT,EDT^       OPEN CHNEDT,NSDOPN^
BXOPENCHNFCMNSDOPNC	010371'	050340	010370*		X FCM,FCM^       OPEN CHNFCM,NSDOPN^
BC
BDEFINEC				05000	DEFINE X(A,B,C,D,E)
BXC				05100	<       OUTBUF CHN'B,2>
BOBTBORTNSC	010372'			05200	OBTB:   ORTNS^
BPROCESXOUTBUFCHNF4C	010372'	065740	000002		X FORTRAN,F4,F40^       OUTBUF CHNF4,2^
BXOUTBUFCHNMACC	010373'	065700	000002		X MACRO,MAC,MACRO^       OUTBUF CHNMAC,2^
BXOUTBUFCHNFTFC	010374'	065640	000002		X FTFORTRAN,FTF,FTF40^       OUTBUF CHNFTF,2^
BXOUTBUFCHNSIMC	010375'	065600	000002		X SIMPL,SIM,SIMPL^       OUTBUF CHNSIM,2^
BXOUTBUFCHNFALC	010376'	065540	000002		X FAIL,FAL,FAIL^       OUTBUF CHNFAL,2^
BXOUTBUFCHNCBLC	010377'	065500	000002		X COBOL,CBL,COBOL^       OUTBUF CHNCBL,2^
BXOUTBUFCHNBLIC	010400'	065440	000002		X BLIMP,BLI,BLISS^       OUTBUF CHNBLI,2^
BXOUTBUFCHNVASC	010401'	065400	000002		X VAS,VAS,VAS^       OUTBUF CHNVAS,2^
BXOUTBUFCHNLODC	010402'	065340	000002		X LOADER,LOD^       OUTBUF CHNLOD,2^
BXOUTBUFCHNDIRC	010403'	065340	000002		X DIRIT,DIR^       OUTBUF CHNDIR,2^
BIFNLSTRSWXOUTBUFCHNLSTC	010404'	065340	000002		IFN LSTRSW,<X LIST,LST>^       OUTBUF CHNLST,2^
BXOUTBUFCHNPIPC	010405'	065340	000002		X PIP,PIP^       OUTBUF CHNPIP,2^
BXOUTBUFCHNCRFC	010406'	065300	000002		X CREF,CRF^       OUTBUF CHNCRF,2^
BXOUTBUFCHNEDTC	010407'	065340	000002		X EDT,EDT^       OUTBUF CHNEDT,2^
BXOUTBUFCHNFCMC	010410'	065340	000002		X FCM,FCM^       OUTBUF CHNFCM,2^
BC
BIFNTEMPC				05400	IFN TEMP,<
BDEFINEC				05500	DEFINE X(A,B,C,D,E)
BXDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 78-6
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				05600	<       SETSTS CHN'B,1>
BSETS1ORTNSC	010411'			05700	SETS1:  ORTNS^
BPROCESXSETSTSCHNF4C	010411'	060740	000001		X FORTRAN,F4,F40^       SETSTS CHNF4,1^
BXSETSTSCHNMACC	010412'	060700	000001		X MACRO,MAC,MACRO^       SETSTS CHNMAC,1^
BXSETSTSCHNFTFC	010413'	060640	000001		X FTFORTRAN,FTF,FTF40^       SETSTS CHNFTF,1^
BXSETSTSCHNSIMC	010414'	060600	000001		X SIMPL,SIM,SIMPL^       SETSTS CHNSIM,1^
BXSETSTSCHNFALC	010415'	060540	000001		X FAIL,FAL,FAIL^       SETSTS CHNFAL,1^
BXSETSTSCHNCBLC	010416'	060500	000001		X COBOL,CBL,COBOL^       SETSTS CHNCBL,1^
BXSETSTSCHNBLIC	010417'	060440	000001		X BLIMP,BLI,BLISS^       SETSTS CHNBLI,1^
BXSETSTSCHNVASC	010420'	060400	000001		X VAS,VAS,VAS^       SETSTS CHNVAS,1^
BXSETSTSCHNLODC	010421'	060340	000001		X LOADER,LOD^       SETSTS CHNLOD,1^
BXSETSTSCHNDIRC	010422'	060340	000001		X DIRIT,DIR^       SETSTS CHNDIR,1^
BIFNLSTRSWXSETSTSCHNLSTC	010423'	060340	000001		IFN LSTRSW,<X LIST,LST>^       SETSTS CHNLST,1^
BXSETSTSCHNPIPC	010424'	060340	000001		X PIP,PIP^       SETSTS CHNPIP,1^
BXSETSTSCHNCRFC	010425'	060300	000001		X CREF,CRF^       SETSTS CHNCRF,1^
BXSETSTSCHNEDTC	010426'	060340	000001		X EDT,EDT^       SETSTS CHNEDT,1^
BXSETSTSCHNFCMC	010427'	060340	000001		X FCM,FCM^       SETSTS CHNFCM,1^
BC
BDEFINEC				05900	DEFINE X(A,B,C,D,E)
BXC				06000	<       SETSTS CHN'B,17>
BSETS17ORTNSC	010430'			06100	SETS17: ORTNS^
BPROCESXSETSTSCHNF4C	010430'	060740	000017		X FORTRAN,F4,F40^       SETSTS CHNF4,17^
BXSETSTSCHNMACC	010431'	060700	000017		X MACRO,MAC,MACRO^       SETSTS CHNMAC,17^
BXSETSTSCHNFTFC	010432'	060640	000017		X FTFORTRAN,FTF,FTF40^       SETSTS CHNFTF,17^
BXSETSTSCHNSIMC	010433'	060600	000017		X SIMPL,SIM,SIMPL^       SETSTS CHNSIM,17^
BXSETSTSCHNFALC	010434'	060540	000017		X FAIL,FAL,FAIL^       SETSTS CHNFAL,17^
BXSETSTSCHNCBLC	010435'	060500	000017		X COBOL,CBL,COBOL^       SETSTS CHNCBL,17^
BXSETSTSCHNBLIC	010436'	060440	000017		X BLIMP,BLI,BLISS^       SETSTS CHNBLI,17^
BXSETSTSCHNVASC	010437'	060400	000017		X VAS,VAS,VAS^       SETSTS CHNVAS,17^
BXSETSTSCHNLODC	010440'	060340	000017		X LOADER,LOD^       SETSTS CHNLOD,17^
BXSETSTSCHNDIRC	010441'	060340	000017		X DIRIT,DIR^       SETSTS CHNDIR,17^
BIFNLSTRSWXSETSTSCHNLSTC	010442'	060340	000017		IFN LSTRSW,<X LIST,LST>^       SETSTS CHNLST,17^
BXSETSTSCHNPIPC	010443'	060340	000017		X PIP,PIP^       SETSTS CHNPIP,17^
BXSETSTSCHNCRFC	010444'	060300	000017		X CREF,CRF^       SETSTS CHNCRF,17^
BXSETSTSCHNEDTC	010445'	060340	000017		X EDT,EDT^       SETSTS CHNEDT,17^
BXSETSTSCHNFCMC	010446'	060340	000017		X FCM,FCM^       SETSTS CHNFCM,17^
BC				06200	>
BC
BDEFINEC				06400	DEFINE X(A,B,C,D,E)
BXC				06500	<       <SIXBIT /   A/>>
BBNAMORTNSC	010447'			06600	BNAM:   ORTNS^
BPROCESXSIXBITC	010447'	000000	465762		X FORTRAN,F4,F40^       <SIXBIT /   FORTRAN/>^
BXSIXBITC	010450'	000000	554143		X MACRO,MAC,MACRO^       <SIXBIT /   MACRO/>^
BXSIXBITC	010451'	000000	466446		X FTFORTRAN,FTF,FTF40^       <SIXBIT /   FTFORTRAN/>^
BXSIXBITC	010452'	000000	635155		X SIMPL,SIM,SIMPL^       <SIXBIT /   SIMPL/>^
BXSIXBITC	010453'	000000	464151		X FAIL,FAL,FAIL^       <SIXBIT /   FAIL/>^
BXSIXBITC	010454'	000000	435742		X COBOL,CBL,COBOL^       <SIXBIT /   COBOL/>^
BXSIXBITC	010455'	000000	425451		X BLIMP,BLI,BLISS^       <SIXBIT /   BLIMP/>^
BXSIXBITC	010456'	000000	664163		X VAS,VAS,VAS^       <SIXBIT /   VAS/>^
BXSIXBITC	010457'	000000	545741		X LOADER,LOD^       <SIXBIT /   LOADER/>^
BXSIXBITC	010460'	000000	445162		X DIRIT,DIR^       <SIXBIT /   DIRIT/>^
BIFNLSTRSWXSIXBITC	010461'	000000	545163		IFN LSTRSW,<X LIST,LST>^       <SIXBIT /   LIST/>^
BXSIXBITC	010462'	000000	605160		X PIP,PIP^       <SIXBIT /   PIP/>^
BXSIXBITDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 78-7
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	010463'	000000	436245		X CREF,CRF^       <SIXBIT /   CREF/>^
BXSIXBITC	010464'	000000	454464		X EDT,EDT^       <SIXBIT /   EDT/>^
BXSIXBITC	010465'	000000	464355		X FCM,FCM^       <SIXBIT /   FCM/>^
BCOMNITSOSLEBOB2T5DRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 79
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	010466'	373025	010257'	00100	COMNIT:        SOSLE @BOB2(T5) ;ANY MORE SPACE
BJRSTBOU1C	010467'	254000	010476'	00200	        JRST BOU1
BIFNTEMPSKIPNBFLGT5C	010470'	336005	000000*	00300	IFN TEMP,<SKIPN BFLG(T5)        ;DOING TEMPCORE?
BPUSHJPINOLDC	010471'	260740	010557'	00400	        PUSHJ P,INOLD   ;YES, INIT FOR DSK
BSETOMBFLGT5C	010472'	476005	010470*	00500	        SETOM BFLG(T5)  ;AND MARK>
BXCTOTABT5C	010473'	256005	010315'	00600	        XCT OTAB(T5)    ;THE OUT
BSKIPAC	010474'	334000	000000	00700	        SKIPA
BJRSTOUTERC	010475'	254000	001055'	00800	        JRST OUTER
BBOU1IDPBT1BOB1T5C	010476'	136065	010240'	00900	BOU1:   IDPB T1,@BOB1(T5)
BPOPJPC	010477'	263740	000000	01000	        POPJ P,
BIFNTEMPC				01100	IFN TEMP,<
BCOMCHKSKIPEBFLGT5C	010500'	332005	010472*	01200	COMCHK: SKIPE BFLG(T5)
BJRSTCK1BC	010501'	254000	010523'	01300	        JRST CK1B       ;ALREADY SET TO DSK
BPUSHPT1C	010502'	261740	000001	01400	        PUSH P,T1
BMOVET1BJFFT5C	010503'	200045	000000*	01500	        MOVE T1,BJFF(T5)        ;RECOVER START OF BUFFERS
BADDIT1C	010504'	271040	000002	01600	        ADDI T1,2       ;START OF DATA
BHRRMT1TMPFILC	010505'	542040	002153*	01700	        HRRM T1,TMPFIL+1        ;SET UP IOWD
BHRRZT1BOB1T5C	010506'	550065	010240'	01800	        HRRZ T1,@BOB1(T5)       ;THE BYTE POINTER
BSUBT1BJFFT5C	010507'	274045	010503*	01900	        SUB T1,BJFF(T5)
BSUBIT1C	010510'	275040	000002	02000	        SUBI T1,2
BMOVNST1C	010511'	213000	000001	02100	        MOVNS T1        ;SET UP COUNT
BHRLMT1TMPFILC	010512'	506040	010505*	02200	        HRLM T1,TMPFIL+1
BHRLZT1BNAMT5C	010513'	514045	010447'	02300	        HRLZ T1,BNAM(T5)        ;THE TEMPCORE NAME
BMOVEMT1TMPFILC	010514'	202040	002145*	02400	        MOVEM T1,TMPFIL
BMOVET1XWDTMPFILC	010515'	200040	011225'	02500	        MOVE T1,[XWD 3,TMPFIL]  ;WRITE OP
BTMPCORT1C	010516'	047040	000044	02600	        TMPCOR  T1,
BSKIPAC	010517'	334000	000000	02700	        SKIPA   ;ERROR
BJRSTPOPPT1C				02800	        JRST    [POP P,T1
BPOPJPC	010520'	254000	011744'	02900	                POPJ P,]
BPOPPT1C	010521'	262740	000001	03000	        POP P,T1
BPUSHJPINOLDC	010522'	260740	010557'	03100	        PUSHJ P,INOLD   ;SET UP FOR REGULAR OUTPUT
BCK1BXCTRLTBT5C	010523'	256005	010276'	03200	CK1B:   XCT RLTB(T5)    ;DO A RELEASE (WILL WRITE IT OUT)
BPOPJPC	010524'	263740	000000	03300	        POPJ P,>
BC
BINITCHPUSHJPCHKRMC	010525'	260740	001450'	03500	INITCH: PUSHJ P,CHKRM   ;GET SOME SPACE FOR BUFFERS
BPUSHPT1C	010526'	261740	000001	03600	        PUSH P,T1
BPUSHPT2C	010527'	261740	000002	03700	        PUSH P,T2
BIFNTEMPMOVET1JOBFFC	010530'	200040	006551*	03800	IFN TEMP,<      MOVE T1,JOBFF
BMOVEMT1BJFFT5C	010531'	202045	010507*	03900	        MOVEM T1,BJFF(T5)
BMOVST2BOB0T5C	010532'	204105	010221'	04000	        MOVS T2,BOB0(T5)
BMOVEMT2INIT1C	010533'	202100	000000*	04100	        MOVEM T2,INIT1
BXCTOPNTBT5C	010534'	256005	010353'	04200	        XCT OPNTB(T5)
BJRSTEXC	010535'	254000	001410'	04300	        JRST EX ;CAN NOT GET DSK
BXCTOBTBT5C	010536'	256005	010372'	04400	        XCT OBTB(T5)    ;OUTBUF
BIFNTEMPADDIT1C	010537'	271040	000003	04500	IFN TEMP,<ADDI T1,3
BHRLIT1C	010540'	505040	440700	04600	        HRLI T1,440700  ;SET UP BUFFER HEADERS
BMOVEMT1BOB1T5C	010541'	202065	010240'	04700	        MOVEM T1,@BOB1(T5)
BHRLST1C	010542'	507000	000001	04800	        HRLS T1
BADDIT1C	010543'	271040	000001	04900	        ADDI T1,1
BSETZMT1C	010544'	402001	777777	05000	        SETZM -1(T1)
BMOVEIT2T1C	010545'	201101	000176	05100	        MOVEI T2,176(T1)
BBLTT1T2C	010546'	251042	000000	05200	        BLT T1,(T2)
BMOVEIT1C	010547'	201040	001200	05300	        MOVEI T1,200*5
BMOVEMT1BOB2T5DRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 79-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	010550'	202065	010257'	05400	        MOVEM T1,@BOB2(T5)
BMOVSIT1C	010551'	205040	400000	05500	        MOVSI T1,400000
BANDCAMT1BOB0T5C	010552'	412065	010221'	05600	        ANDCAM T1,@BOB0(T5)
BSETZMBFLGT5C	010553'	402005	010500*	05700	        SETZM BFLG(T5)  ;MARK AS TEMPCORE
BPOPPT2C	010554'	262740	000002	05800	        POP P,T2
BPOPPT1C	010555'	262740	000001	05900	        POP P,T1
BPOPJPC	010556'	263740	000000	06000	        POPJ P,
BINOLDPUSHPT1C	010557'	261740	000001	06100	INOLD:  PUSH P,T1>
BHLLZT1JOBNAMC	010560'	510040	002254*	06200	        HLLZ T1,JOBNAM  ;SET UP DSK
BHRRT1BNAMT5C	010561'	540045	010447'	06300	        HRR T1,BNAM(T5)
BMOVEMT1NAMEC	010562'	202040	010352*	06400	        MOVEM T1,NAME
BMOVSIT1SIXBITC	010563'	205040	645560	06500	        MOVSI T1,(SIXBIT /TMP/)
BMOVEMT1NAMEC	010564'	202040	004160*	06600	        MOVEM T1,NAME+1
BSETZMNAMEC	010565'	402000	004163*	06700	        SETZM NAME+2
BSETZMNAMEC	010566'	402000	004137*	06800	        SETZM NAME+3
BIFNTEMPXCTSETS17T5C	010567'	256005	010430'	06900	IFN TEMP,<XCT SETS17(T5)        ;SET MODE TO 17 TO PRESERVE BUFFERS>
BXCTENTBT5C	010570'	256005	010334'	07000	        XCT ENTB(T5)    ;ENTER IT
BJRSTFIUC	010571'	254000	001112'	07100	        JRST FIU
BIFNTEMPXCTSETS1T5C	010572'	256005	010411'	07200	IFN TEMP,<XCT SETS1(T5) ;BACK TO MODE 1>
BIFETEMPC				07300	IFE TEMP,<      POP P,T2>
BPOPPT1C	010573'	262740	000001	07400	        POP P,T1
BPOPJPC	010574'	263740	000000	07500	        POPJ P,
BNONSTDAOBJPSVPTTMNERDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 80
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	010575'	252600	001051'	00100	NONSTD:        AOBJP SVPT,TMNER        ;NOT ENOUGH ROOM TO READ NAME
BPUSHJPSTARGSC	010576'	260740	010727'	00200	        PUSHJ P,STARGS  ;WORRY ABOUT ( AROUND ARGS
BPUSHJPGETNAMC	010577'	260740	000116'	00300	        PUSHJ P,GETNAM  ;GET A FILE NAME ETC
BPUSHJPFINPARC	010600'	260740	010722'	00400	        PUSHJ P,FINPAR  ;END OF ARGS
BAOST1NOSTNMC	010601'	350040	002267*	00500	        AOS T1,NOSTNM   ;ONE MORE NOW
BCAILT1NSDNMC	010602'	301040	000003	00600	        CAIL T1,NSDNM
BJRSTTMSTDC	010603'	254000	001125'	00700	        JRST TMSTD      ;WE DON'T ALLOW THAT MANY
BAOBJPIOPNTTMSTDC	010604'	252300	001125'	00800	        AOBJP IOPNT,TMSTD       ;NOT ENOGH CHANELS FREE
BSUBIIOPNTC	010605'	275300	000001	00900	        SUBI IOPNT,1    ;JUST ONE LESS, NOT ONE MORE IN USE
BMOVECNOSTBFT1C	010606'	200701	010657'	01000	        MOVE C,NOSTBF(T1)       ;GET A BUFFER AREA
BMOVEMCINIT1C	010607'	202700	010533*	01100	        MOVEM C,INIT1
BPUSHPT1C	010610'	261740	000001	01200	        PUSH P,T1       ;SAVE NUMBER
BMOVNIT1NSDCHNT1C	010611'	211041	777773	01300	        MOVNI T1,-NSDCHN(T1)    ;GET CHANEL NUMBER
BMOVET5OPENNSDOPNC	010612'	200240	011746'	01400	        MOVE T5,[OPEN 0,NSDOPN]
BDPBT1POINTT5C	010613'	137040	011747'	01500	        DPB T1,[POINT 4,T5,12]
BPOPPT1C	010614'	262740	000001	01600	        POP P,T1        ;GET IT BACK
BXCTT5C	010615'	256000	000005	01700	        XCT T5  ;DO THE OPEN
BJRSTDSKNAC	010616'	254000	001053'	01800	        JRST DSKNA      ;SORRY
BPUSHJPCHKRMC	010617'	260740	001450'	01900	        PUSHJ P,CHKRM
BXCTNINTABT1C	010620'	256001	010662'	02000	        XCT NINTAB(T1)  ;DO THE INBUF
BMOVECSVNAMSVPTC	010621'	200714	006523*	02100	        MOVE C,SVNAM(SVPT)      ;GET NAME GIVEN
BMOVEMCNONSNMT1C	010622'	202701	001310*	02200	        MOVEM C,NONSNM(T1)      ;AND SAVE IT
BHLLMCEXTABNPROCST1C	010623'	502701	000000*	02300	        HLLM C,EXTAB+NPROCS(T1) ;AND SAVE AS AN EXTENSION
BMOVEMCNSDSWST1C	010624'	202701	002547*	02400	        MOVEM C,NSDSWS(T1)      ;ALSO AS A SWITCH
BHLRSCC	010625'	547000	000016	02500	        HLRS C  ;SET UP FILE NAME (NO TEMP FILES FOR NON-STANDARD)
BHLLCJOBNAMC	010626'	500700	010560*	02600	        HLL C,JOBNAM
BMOVEMCLNAMC	010627'	202700	010562*	02700	        MOVEM C,LNAM
BSKIPNCSVDEVSVPTC	010630'	336714	007573*	02800	        SKIPN C,SVDEV(SVPT)
BMOVSICSIXBITC	010631'	205700	446353	02900	        MOVSI C,(SIXBIT /DSK/)  ;ASSUME DSK NOT SYS
BMOVEMCNONSDVT1C	010632'	202701	001312*	03000	        MOVEM C,NONSDV(T1)      ;SAVE AWAY
BMOVECSVEXTSVPTC	010633'	200714	005417*	03100	        MOVE C,SVEXT(SVPT)
BMOVEMCNONSXTT1C	010634'	202701	001314*	03200	        MOVEM C,NONSXT(T1)
BMOVECSVPPNSVPTC	010635'	200714	005710*	03300	        MOVE C,SVPPN(SVPT)
BMOVEMCNONSPNT1C	010636'	202701	001316*	03400	        MOVEM C,NONSPN(T1)
BSETZMNONUSDT1C	010637'	402001	001261*	03500	        SETZM NONUSD(T1)        ;USED YET??
BMOVSICSIXBITC	010640'	205700	645560	03600	        MOVSI C,(SIXBIT /TMP/)
BMOVEMCLEXTC	010641'	202700	010564*	03700	        MOVEM C,LEXT
BSETZMLEXTC	010642'	402000	010565*	03800	        SETZM LEXT+1
BSETZMLPPNC	010643'	402000	010566*	03900	        SETZM LPPN
BXCTENTABT1C	010644'	256001	010665'	04000	        XCT ENTAB(T1)   ;THE ENTER
BJRSTFIUC	010645'	254000	001112'	04100	        JRST FIU
BSUBSVPTXWDC	010646'	274600	011024'	04200	        SUB SVPT,[XWD 1,1]      ;GET IT BACK TO PROPER PLACE
BAOSNPROC1C	010647'	350000	003610*	04300	        AOS NPROC1      ;ONE MOREPROCESSOR
BMOVET1NSWTABT1C	010650'	200041	010654'	04400	        MOVE T1,NSWTAB(T1)      ;GET THE SWITCH
BIORMT1CALPROC	010651'	436040	003641*	04500	        IORM T1,CALPRO  ;AND SET IN LIST OF ALL
BHRLZST1C	010652'	517000	000001	04600	        HRLZS T1        ;FAKE A SWITCH
BJRSTINTSWC	010653'	254000	002554'	04700	        JRST INTSW      ;AND GO
BC
BNSWTABFORXXXC			000001	04900	NSWTAB: FOR (1,NSDNM,<CAT(NSDS,\XXX)>)^XXX==1
BREPEATNSDNMCATXXXNSDS1C	010654'	000000	001000		CAT(NSDS,\XXX)^NSDS1^
BIFBXXXXXXIFNBCATXXXNSDS2C	010655'	000000	000400		CAT(NSDS,\XXX)^NSDS2^
BIFBXXXXXXIFNBCATXXXNSDS3C	010656'	000000	000200		CAT(NSDS,\XXX)^NSDS3^
BIFBXXXXXXIFNBNOSTBFFORXXXC			000000	05000	NOSTBF: FOR (0,NSDNM,<XWD OBUF+3*XXX,0>)^XXX==0
BREPEATNSDNMDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 80-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BXWDOBUFXXXC	010657'	000000*	000000		XWD OBUF+3*XXX,0
BIFBXXXXXXIFNBXWDOBUFXXXC	010660'	000000*	000000		XWD OBUF+3*XXX,0
BIFBXXXXXXIFNBXWDOBUFXXXC	010661'	000000*	000000		XWD OBUF+3*XXX,0
BIFBXXXXXXIFNBARRAYOBUFC				05100	ARRAY OBUF[9]
BNINTABFORNSDCHNXXXC			000005	05200	NINTAB: FOR (NSDCHN,NSDNM,<OUTBUF XXX,2>,-1)^XXX==NSDCHN
BREPEATNSDNMOUTBUFXXXC	010662'	065240	000002		OUTBUF XXX,2
BIFBIFNBXXXXXXOUTBUFXXXC	010663'	065200	000002		OUTBUF XXX,2
BIFBIFNBXXXXXXOUTBUFXXXC	010664'	065140	000002		OUTBUF XXX,2
BIFBIFNBXXXXXXARRAYNSDNMNONUSDNONSPNNONSXTNONSDVNONSNMC				05300	ARRAY NONSNM,NONSDV,NONSXT,NONSPN,NONUSD[NSDNM]
BENTABFORNSDCHNXXXC			000005	05400	ENTAB:  FOR (NSDCHN,NSDNM,<ENTER XXX,LNAM>,-1)^XXX==NSDCHN
BREPEATNSDNMENTERXXXLNAMC	010665'	077240	010627*		ENTER XXX,LNAM
BIFBIFNBXXXXXXENTERXXXLNAMC	010666'	077200	010665*		ENTER XXX,LNAM
BIFBIFNBXXXXXXENTERXXXLNAMC	010667'	077140	010666*		ENTER XXX,LNAM
BIFBIFNBXXXXXXC
BFORC				05600	FOR (1,NSDNM,<CAT(NSDO,\XXX):MOVEI T5,<XXX-1>*3
BC				05700	        SETOM NONUSD+XXX-1
BXXXC			000001	05800	        JRST COMSTD>)^XXX==1
BREPEATNSDNMCATXXXNSDO1MOVEIT5XXXC	010670'	201240	000000		CAT(NSDO,\XXX)^NSDO1^:MOVEI T5,<XXX-1>*3
BSETOMNONUSDXXXC	010671'	476000	010637*		        SETOM NONUSD+XXX-1
BJRSTCOMSTDC	010672'	254000	010701'		        JRST COMSTD
BIFBXXXXXXIFNBCATXXXNSDO2MOVEIT5XXXC	010673'	201240	000003		CAT(NSDO,\XXX)^NSDO2^:MOVEI T5,<XXX-1>*3
BSETOMNONUSDXXXC	010674'	476000	000000*		        SETOM NONUSD+XXX-1
BJRSTCOMSTDC	010675'	254000	010701'		        JRST COMSTD
BIFBXXXXXXIFNBCATXXXNSDO3MOVEIT5XXXC	010676'	201240	000006		CAT(NSDO,\XXX)^NSDO3^:MOVEI T5,<XXX-1>*3
BSETOMNONUSDXXXC	010677'	476000	000000*		        SETOM NONUSD+XXX-1
BJRSTCOMSTDC	010700'	254000	010701'		        JRST COMSTD
BIFBXXXXXXIFNBC
BCOMSTDSOSLEOBUFT5DRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 81
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	010701'	373005	000000*	00100	COMSTD:        SOSLE OBUF+2(T5)
BJRSTOUT1C	010702'	254000	010706'	00200	        JRST OUT1
BXCTOUTBT5C	010703'	256005	010710'	00300	        XCT OUTB(T5)
BSKIPAC	010704'	334000	000000	00400	        SKIPA
BJRSTOUTERC	010705'	254000	001055'	00500	        JRST OUTER
BOUT1IDPBT1OBUFT5C	010706'	136045	000000*	00600	OUT1:   IDPB T1,OBUF+1(T5)
BPOPJPC	010707'	263740	000000	00700	        POPJ P,
BC
BOUTBFORC				00900	OUTB:   FOR (NSDCHN,NSDNM,<OUT XXX,0
BC				01000	0
BNSDCHNXXXC			000005	01100	0>,-1)^XXX==NSDCHN
BREPEATNSDNMOUTXXXC	010710'	057240	000000		OUT XXX,0
BC	010711'	000000	000000		0
BC	010712'	000000	000000		0
BIFBIFNBXXXXXXOUTXXXC	010713'	057200	000000		OUT XXX,0
BC	010714'	000000	000000		0
BC	010715'	000000	000000		0
BIFBIFNBXXXXXXOUTXXXC	010716'	057140	000000		OUT XXX,0
BC	010717'	000000	000000		0
BC	010720'	000000	000000		0
BIFBIFNBXXXXXXC
BFINPRSPUSHJPSCANC	010721'	260740	000276'	01300	FINPRS: PUSHJ P,SCAN
BFINPARTRNNFL3PARFLGC	010722'	606440	000004	01400	FINPAR: TRNN FL3,PARFLG ;IS THE PAREN FLAG ON??
BPOPJPC	010723'	263740	000000	01500	        POPJ P, ;NO, ARG NOT SURROUNDED BY ()
BCAIECC	010724'	302700	000051	01600	        CAIE C,")"      ;SHOULD HAVE ENDED PROPERLY
BJRSTSYNERRC	010725'	254000	001065'	01700	        JRST SYNERR     ;NO
BJRSTSCANC	010726'	254000	000276'	01800	        JRST SCAN       ;YES, SCAN PAST IT
BC
BSTARGSPUSHJPSCANC	010727'	260740	000276'	02000	STARGS: PUSHJ P,SCAN
BCAINCC	010730'	306700	000050	02100	        CAIN C,"("      ;ARGS SURROUNDED BY PAREN??
BTROAFL3PARFLGC	010731'	664440	000004	02200	        TROA FL3,PARFLG ;YES
BTRZAFL3PARFLGC	010732'	624440	000004	02300	        TRZA FL3,PARFLG ;NO
BJRSTSCANC	010733'	254000	000276'	02400	        JRST SCAN       ;SCAN PAST (
BPOPJPC	010734'	263740	000000	02500	        POPJ P,
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 82
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	;DATA STORAGE ASSIGNMENTS
BC
BPDPIOWDPDLPDLBC	010735'	777700	000000*	00300	PDP:    IOWD    PDL,PDLB                ;INITIAL PDL POINTER
BC
BINTEGEUSRPPNSWBKBSWBKLONAMOEXTOPPNBINNAMC				00500	INTEGER USRPPN,SWBKB,SWBKL,ONAM,OEXT,OPPN,BINNAM
BINTEGEPCNAMSAVPPNSVSWPPCNUMSDATSTIMSAVCHRC				00600	INTEGER PCNAM,SAVPPN,SVSWP,PCNUM,SDAT,STIM,SAVCHR
BINTEGEACCUMDINPTDINCTCORTOPCORT1SVRPPNUMATC				00700	INTEGER ACCUM,DINPT,DINCT,CORTOP,CORT1,SVRPP,NUMAT
BINTEGESVINDSVPDLJOBNAMBROCNTLODSP2LODCT2LODSPLODCTRC				00800	INTEGER SVIND,SVPDL,JOBNAM,BROCNT,LODSP2,LODCT2,LODSP,LODCTR
BINTEGENAMCTNAMPTSVJBFFERRCNTNMLSTPDEFPPNC				00900	INTEGER NAMCT,NAMPT,SVJBFF,ERRCNT,NMLSTP,DEFPPN
BC
BARRAYLODSCTLODSB2LODSBKC				01100	ARRAY LODSBK,LODSB2[LODSCT/5+1]
BARRAYNFILESVPPNSVEXTSVNAMSVDEVSWBKSNSDNMNSDSWSC				01200	ARRAY SWBKS,SVDEV,SVNAM,SVEXT,SVPPN[NFILE],NSDSWS[NSDNM]
BARRAYDDTBUFOPENBLOOKBFPDLPDLBSWBKSWBLKC				01300	ARRAY DDTBUF[^D100],LOOKBF,OPENB[3],PDLB[PDL+1],SWBLK[SWBK+1]
BARRAYERRBUFNESTDPFREBUFBUFTABNESTDPIOPDC				01400	ARRAY ERRBUF[4],BUFTAB,FREBUF[NESTDP+2],IOPD[<NESTDP+2>*3+1]
BARRAYBUFSVACSBUFALTRUNC				01500	ARRAY BUF[200],SVAC[20],SBUF[200],ALTRUN[6]
BIFNTEMPARRAYTMPFILC				01600	IFN TEMP,<ARRAY TMPFIL[2]>
BARRAYNMLSTLUFDSPPNSNAMES2NAMES1C				01700	ARRAY NAMES1,NAMES2,PPNS,UFDS[NMLSTL+1]
BC
BLVARC				01900	LVAR
BC
BIFNTEMPTMPFILTMPFL1C			000001	02100	IFN TEMP,<TMPFL1=TMPFIL+1>
BSVJBFFSVJFFC			000000	02200	SVJFF==SVJBFF
BDEFINEDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 83
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC				00100	DEFINE CODIT (A,B)
BCODITC				00200	<XXZ==.
BC				00300	        B
BC				00400	        LVAR
BC				00500	        ARRAY A[.-XXZ]
BC				00600	        LVAR>
BC
BDEFINEC				00800	DEFINE X(A,B,C,D,E)
BXC				00900	<SIXBIT /B/>
BC
BINIDATCODITXXZC			010736'	01100	INIDAT: CODIT (RUNBLK,<EXP SYSDEV,0,0,0,0,0>)^XXZ==.
BEXPSYSDEVC	010736'	637163	000000		        EXP SYSDEV,0,0,0,0,0
	010737'	000000	000000
	010740'	000000	000000
	010741'	000000	000000
	010742'	000000	000000
	010743'	000000	000000
BLVARARRAYXXZRUNBLKLVARC
BRUNBLKNAMEC			000001	01300	        NAME=RUNBLK+1
BRUNBLKLNAMC			000001	01400	        LNAM=RUNBLK+1
BRUNBLKLEXTC			000002	01500	        LEXT=RUNBLK+2
BRUNBLKLDATC			000003	01600	        LDAT=RUNBLK+3
BRUNBLKLPPNC			000004	01700	        LPPN=RUNBLK+4
BRUNBLKINILOWC			000000	01800	        INILOW=RUNBLK
BC
BCODITC				02000	        CODIT (EXTAB,<PROCESS
BXXZC			010744'	02100	        BLOCK NSDNM>)^XXZ==.
BPROCESXSIXBITC	010744'	462400	000000		X FORTRAN,F4,F40^SIXBIT /F4/^
BXSIXBITC	010745'	554143	000000		X MACRO,MAC,MACRO^SIXBIT /MAC/^
BXSIXBITC	010746'	466446	000000		X FTFORTRAN,FTF,FTF40^SIXBIT /FTF/^
BXSIXBITC	010747'	635155	000000		X SIMPL,SIM,SIMPL^SIXBIT /SIM/^
BXSIXBITC	010750'	464154	000000		X FAIL,FAL,FAIL^SIXBIT /FAL/^
BXSIXBITC	010751'	434254	000000		X COBOL,CBL,COBOL^SIXBIT /CBL/^
BXSIXBITC	010752'	425451	000000		X BLIMP,BLI,BLISS^SIXBIT /BLI/^
BXSIXBITC	010753'	664163	000000		X VAS,VAS,VAS^SIXBIT /VAS/^
BBLOCKNSDNMLVARARRAYXXZEXTABLVARC
BCODITXXZC			010757'	02300	        CODIT(LOKINT,1)^XXZ==.
BC	010757'	000000	000001		        1
BLVARARRAYXXZLOKINTLVARC
BCODITC				02500	        CODIT(LOKNAM,<0
BXXZC			010760'	02600	        XWD LOOKBF,LOOKBF>)^XXZ==.
BC	010760'	000000	000000		        0
BXWDLOOKBFLOOKBFC	010761'	000000*	000000*		        XWD LOOKBF,LOOKBF
BLVARARRAYXXZLOKNAMLVARC
BCODITXXZC			010762'	02800	        CODIT (CALPRO,ALPROCS)^XXZ==.
BALPROCC	010762'	000000	776010		        ALPROCS
BLVARARRAYXXZCALPROLVARC
BCODITXXZC			010763'	03000	        CODIT (NPROC1,NPROCS)^XXZ==.
BNPROCSC	010763'	000000	000010		        NPROCS
BLVARARRAYXXZNPROC1LVARC
BCODITC				03200	        CODIT (DSKLK,<1
BC				03300	        SIXBIT /DSK/
BXXZC			010764'	03400	        XWD LOOKBF,LOOKBF>)^XXZ==.
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 83-2
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC	010764'	000000	000001		        1
BSIXBITC	010765'	446353	000000		        SIXBIT /DSK/
BXWDLOOKBFLOOKBFC	010766'	010761*	010761*		        XWD LOOKBF,LOOKBF
BLVARARRAYXXZDSKLKLVARC
BCODITC				03600	        CODIT (FCOMD,<ASCII /@***SVC.TMP
BC				03700	/
BXXZC			010767'	03800	        BYTE (7) 177,177>)^XXZ==.
BASCIIC	010767'	401245	225246		        ASCII /@***SVC.TMP
	010770'	532065	652232
BC	010771'	500321	200000		/
BBYTEC	010772'	777760	000000		        BYTE (7) 177,177
BLVARARRAYXXZFCOMDLVARC
BCODITXXZC			010773'	04000	        CODIT (FCOMD3,<ASCII /EXEC />)^XXZ==.
BASCIIC	010773'	426610	541500		        ASCII /EXEC /
BLVARARRAYXXZFCOMD3LVARCODITC				04100	        CODIT (FCOMD2,<ASCII /@***EDS.TMP
BC				04200	/
BXXZC			010774'	04300	        BYTE (7) 177,177>)^XXZ==.
BASCIIC	010774'	401245	225212		        ASCII /@***EDS.TMP
	010775'	422465	652232
BC	010776'	500321	200000		/
BBYTEC	010777'	777760	000000		        BYTE (7) 177,177
BLVARARRAYXXZFCOMD2LVARC
BCODITC				04500	        CODIT (CRFRDR,<ASCII /@***CRE.TMP
BC				04600	/
BXXZC			011000'	04700	        BYTE (7) 177,177>)^XXZ==.
BASCIIC	011000'	401245	225206		        ASCII /@***CRE.TMP
	011001'	512125	652232
BC	011002'	500321	200000		/
BBYTEC	011003'	777760	000000		        BYTE (7) 177,177
BLVARARRAYXXZCRFRDRLVARC
BCODITXXZC			011004'	04900	        CODIT (NSDOPN,<EXP 1,SIXBIT /DSK/>)^XXZ==.
BEXPSIXBITC	011004'	000000	000001		        EXP 1,SIXBIT /DSK/
	011005'	446353	000000
BLVARARRAYXXZNSDOPNLVARC
BCODITXXZC			011006'	05100	        CODIT (INIT1,0)^XXZ==.
BC	011006'	000000	000000		        0
BLVARARRAYXXZINIT1LVARC
BCODITC				05300	        CODIT (HED,<IOWD 200,BUF
BXXZC			011007'	05400	        0>)^XXZ==.
BIOWDBUFC	011007'	777600	000000*		        IOWD 200,BUF
BC	011010'	000000	000000		        0
BLVARARRAYXXZHEDLVARCODITC				05500	        CODIT (SHED,<IOWD 200,SBUF
BXXZC			011011'	05600	        0>)^XXZ==.
BIOWDSBUFC	011011'	777600	000000*		        IOWD 200,SBUF
BC	011012'	000000	000000		        0
BLVARARRAYXXZSHEDLVARC
BCODITXXZC			011013'	05800	CODIT (ERBFPT,<POINT 7,ERRBUF>)^XXZ==.
BPOINTERRBUFC	011013'	440700	000000*		        POINT 7,ERRBUF
BLVARARRAYXXZERBFPTLVARC
BINIDATINILENC			000056	06000	INILEN==.-INIDAT
BRUNBLKLOWTOPC		777777	777777	06100	LOWTOP=RUNBLK-1
BENDSTPTDRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 84
RPG.MAC	12-JUL-73 14:59		WFW/RCC/PMH/NGP/VEV/JT/MEG/GMG/GJM - WE'RE JUST HOLYGRAMS

BC			002114'	00100	        END     STPT
BRPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73
RPG.MAC	12-JUL-73 14:59		C
NO ERRORS DETECTED
HI-SEG. BREAK IS 011750
7K CORE USED
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 85
RPG.MAC	12-JUL-73 14:59		SYMBOL TABLE

ACCSUP		020000	SPD	CHKFAL		010123'		COMNIT		010466'		DFLGD		000040	SPD
ACCUM		007212	LVR	CHKFCM		010217'		COMPLS		000020	SPD	DIFFER		004357'	
ACTAB		003122'		CHKFTF		010107'		COMPRT		005263'		DIFINM		004427'	
ACTAB2		003130'		CHKLOD		010153'		COMPS		002537'		DIFLEN		000011	SPD
ACTLG		000006	SPD	CHKLST		010167'		COMPS1		003047'		DIFLOW		004463'	
AFLG		040000	SPD	CHKMAC		010101'		COMPSW		003044'		DIFLU1		004501'	
AFLGD		002000	SPD	CHKPIP		010175'		COMSTD		010701'		DIFOKA		004400'	
ALDN1		001174'		CHKRM		001450'		COMT2		001561'		DIFOKO		004371'	
ALDN1A		001166'		CHKSIM		010115'		COMTAB		001507'		DIFONM		004460'	
ALLCRF		037400	SPD	CHKTRM		000605'		COMTLG		000052	SPD	DIFSW		004437'	
ALLDON		001134'		CHKVAS		010145'		CONSN		000300'		DIFSW1		004440'	
ALPROC		776010	SPD	CHN		000007	SPD	CONVOC		000230'		DIFT2		004514'	
ALTDEV		003714'		CHNBLI		000011	SPD	COPBT		002000	SPD	DIFTAB		004503'	
ALTDV1		003734'		CHNCBL		000012	SPD	COPY		005350'		DIFUP		004464'	
ALTDV2		003731'		CHNCRF		000006	SPD	CORE	047000	000011		DINCT		007234	LVR
ALTDVP		003715'		CHNDIR		000007	SPD	CORT1		007432	LVR	DINPT		007256	LVR
ALTRUN		007151	LVR	CHNEDT		000007	SPD	CORTOP		007427	LVR	DIRDAT		007677	LVR
ALTSRC		000010	SPD	CHNF4		000017	SPD	CPOPJ		004213'		DIRLG		000034	SPD
BADFL		006541'		CHNFAL		000013	SPD	CPOPJ1		002747'		DIRNAM		004567'	
BADNAM		006073'		CHNFCM		000007	SPD	CPOPJ2		003742'		DIRSLS		004551'	
BFLG		011016	LVR	CHNFTF		000015	SPD	CPYDN1		005406'		DIRT2		005011'	
BFLGD		000400	SPD	CHNLOD		000007	SPD	CPYDON		005405'		DIRTAB		004755'	
BINDV		007465	LVR	CHNLST		000007	SPD	CRDAGT		005145'		DNCRF		004327'	
BINNAM		007617	LVR	CHNMAC		000016	SPD	CREATE		007460'		DNLOK		003572'	
BJFF		011021	LVR	CHNPIP		000007	SPD	CREATF		040000	SPD	DOC2		005355'	
BLINUM		000007	SPD	CHNSIM		000014	SPD	CREFIT		000000'		DOC3		005377'	
BLISW		004000	SPD	CHNVAS		000010	SPD	CRFRDR		011134	LVR	DOCOM1		003375'	
BLKLNK		006135'		CK1B		010523'		CRSW		000002	SPD	DOCOMP		003377'	
BNAM		010447'		CKT1		005426'		CS		000015		DODATE		006250'	
BOB		010604	LVR	CKTTY		005417'		CSBL		000006	SPD	DODEL		004531'	
BOB0		010221'		CLG		000006	SPD	CSBT		004335'		DODIR		004525'	
BOB1		010240'		CLMBX		006736'		CSWS		003261'		DODIR1		004534'	
BOB2		010257'		CLUD		005624'		CSWS2		003267'		DODIR2		004535'	
BOU1		010476'		CM		007306'		CTBL		000405'		DODT1		005167'	
BROCNT		007550	LVR	CM1		007317'		CTPOPJ		001503'		DODT2		005170'	
BUF		007713	LVR	CM2		007324'		CURUFD		007641	LVR	DOEDIT		007467'	
BUFTAB		007303	LVR	CM3		007335'		D2SBT		005066'		DOEDP		007521'	
BYENOW		001110'		CM5		007341'		D2SBTL		000006	SPD	DOEDT1		007470'	
C		000016		CM6		007344'		DATE	047000	000014		DOEDT2		007522'	
CALPRO		007561	LVR	CMAIL		007301'		DC1		003402'		DOEDT3		007537'	
CBLNUM		000006	SPD	CMAIL1		007302'		DC2		003405'		DOFL		004532'	
CBLSW		010000	SPD	CMDSN		001000	SPD	DDTBUF		007413	LVR	DOLOD		000002	SPD
CCMBT		010000	SPD	CMNM		004576'		DEBUG		001643'		DONE		001324'	
CCSRNF		100000	SPD	CMNM1		004605'		DECL1		005656'		DONE1		001401'	
CDEBFL		007363	LVR	CMNO		003472'		DECL2		005673'		DONE2		001400'	
CDEBUG		001647'		CMONBT		020000	SPD	DECLAR		005630'		DONE3		001371'	
CFLGD		000020	SPD	CNLBT		004000	SPD	DECO1		005310'		DONEP		001256'	
CHKBLI		010137'		CNMBT		001000	SPD	DECOCT		005304'		DOREN		005231'	
CHKCBL		010131'		CNSBT		000400	SPD	DEFPPN		007215	LVR	DOUBLE		010051'	
CHKCRF		010203'		COMAT		002351'		DELTSW		000002	SPD	DPOPJ		003744'	
CHKDIR		010161'		COMAT1		002363'		DEVCHR	047000	000004		DRDAY		007702	LVR
CHKEDT		010211'		COMCHK		010500'		DEVNA		001122'		DRMON		007705	LVR
CHKF4		010073'		COMMA		000461'	SPD	DFLG		000100	SPD	DRYR		007710	LVR
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 85-2
RPG.MAC	12-JUL-73 14:59		SYMBOL TABLE

DSBT		005045'		EXTAB		007625	LVR	FTFFLG		007360	LVR	GTU1		006047'	
DSBTL		000021	SPD	F4NUM		000001	SPD	FTFNUM		000003	SPD	GTU2		006046'	
DSIZ		010033'		F4SW		400000	SPD	FTFSW		100000	SPD	GTU3		006053'	
DSKBT		200000	SPD	FALNUM		000005	SPD	GBG		007257'		GTU4		006060'	
DSKLK		007462	LVR	FALSW		020000	SPD	GBG1		007265'		GTUNO		006036'	
DSKNA		001053'		FCHBLI		004000	SPD	GBG2		007262'		HASH		000045	
DTABT		000004	SPD	FCHCBL		010000	SPD	GBG3		007271'		HASHSZ		000401	SPD
DVREW		003136'		FCHCRF		000400	SPD	GETB1		000620'		HED		007776	LVR
EDCMND		007157	LVR	FCHDIR		001000	SPD	GETB2		000626'		HELP		005446'	
EDFIN		007464'		FCHEDT		001000	SPD	GETB3		000634'		HELPM		005450'	
EDIT10		007462'		FCHF4		400000	SPD	GETB4		000642'		HFLG		000010	SPD
EDITF		020000	SPD	FCHFAL		020000	SPD	GETCH		000342'		HFLGD		100000	SPD
EDITOR		007450'		FCHFCM		001000	SPD	GETN1		000123'		IBUF1		007237	LVR
EDRS		007471'		FCHFTF		100000	SPD	GETN1A		000140'		IBUF2		007242	LVR
EDSBL		000002	SPD	FCHLOD		001000	SPD	GETN2		000156'		IBUF3		007245	LVR
EDSBT		007546'		FCHLST		001000	SPD	GETNAM		000116'		IBUF4		007250	LVR
EDSWL		000002	SPD	FCHMAC		200000	SPD	GETNMS		000115'		IBUF5		007253	LVR
EDSWT		007542'		FCHPIP		001000	SPD	GETPAR		001717'		IDF		000020	SPD
EDSWT2		007544'		FCHSIM		040000	SPD	GETPP2		000167'		IDP1		005322'	
EFLG		020000	SPD	FCHVAS		002000	SPD	GETPPN	047000	000024		IFL		000006	SPD
EFLGD		000001	SPD	FCOMD		011120	LVR	GETPRL		001720'		IFLG		010000	SPD
ELOD		003552'		FCOMD2		011137	LVR	GETPRO		003560'		IFLGD		000200	SPD
ELOD2		003554'		FCOMD3		011123	LVR	GETPRR		001730'		ILLCHR		001012'	
ELODP		003551'		FDBGSW		200000	SPD	GETPRV		000006	SPD	ILP0		002421'	
ENDBRO		002506'		FDC		006317'		GETSW		002553'		ILP0A		002422'	
ENDLS1		007647'		FDEBUG		001640'		GETTAB	047000	000041		ILP1		002431'	
ENDLST		007643'		FDERR		006335'		GFLG		004000	SPD	ILP1A		002430'	
ENDPRC		003470'		FEMT		006740'		GFLGD		200000	SPD	ILP1B		002435'	
ENDUFD		004102'		FEMT1		006752'		GIXN		007346'		ILP2		002441'	
ENTAB		010665'		FEMT2		006742'		GM		007215'		ILP2A		002440'	
ENTB		010334'		FEMT3		006755'		GM1		007222'		IMEDSW		000040	SPD
ENTC1		004231'		FEMT4		006760'		GM2		007231'		IMN		006604'	
ENTC2		004236'		FEMT5		006746'		GM3		007240'		INCHWL	051200	000000	
ENTCNM		004230'		FHOLE		006634'		GM4		007252'		INCRF		002000	SPD
ENTCRF		004244'		FHOLE1		006636'		GM5		007246'		INIDAT		010736'	
ENTSIZ		000012	SPD	FINC1		004273'		GMBLK		007005'		INILEN		000056	SPD
EOFRT		000367'		FINC2		004323'		GMLN		007210'		INILOW		000000	
EOFRT1		000370'		FINC2A		004324'		GMSTK		007276'		INIT1		011032	LVR
ERBFPT		007231	LVR	FINC4		004315'		GNAM		007076'		INITCH		010525'	
ERRBUF		011107	LVR	FINC5		004333'		GNM		005416'		INLIB		000002	SPD
ERRCM1		001017'		FINCRF		004265'		GOCCS		000005'		INOLD		010557'	
ERRCM2		001026'		FINPAR		010722'		GORUN		000043'		INPRNT		004000	SPD
ERRCM3		001030'		FINPRS		010721'		GPKT		007016'		INTAB		000770'	
ERRCM4		001036'		FIU		001112'		GPKT1		007026'		INTSW		002554'	
ERRCM5		001037'		FL		000000		GPKT2		007022'		INTSW1		002565'	
ERRCM6		001043'		FL2		000010		GPPN		000166'		IOP		000007	SPD
ERRCNT		007347	LVR	FL3		000011		GSTRN		001674'		IOPD		011142	LVR
ERRCOM		001015'		FLMBX		006727'		GSTRN1		001676'		IOPNT		000006	SPD
ERREOF		000374'		FNDAT		003573'		GSW1		002552'		ISPTAB		004173'	
ETMS		001014'		FNXML		006774'		GSW2		002547'		ISREL		003701'	
EVRYTH		005074'		FORFIL		003652'		GTNMX		000211'		JDONE1		001325'	
EX		001410'		FORWDS		000100	SPD	GTPRX		003624'		JFLG		000400	SPD
EXIT	047000	000012		FREBUF		007325	LVR	GTPRX1		003631'		JFLGD		000100	SPD
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 85-3
RPG.MAC	12-JUL-73 14:59		SYMBOL TABLE

JOBDDT		000000	EXT	LOGOUT	047000	000017		NAMPT		010160	LVR	NOSLSH		004620'	
JOBERR		002313'	EXT	LOKINT		007567	LVR	NEDCMA		000010	SPD	NOSPC		007631'	
JOBFF		010530'	EXT	LOKNAM		007352	LVR	NEST		000650'		NOSPC1		001242'	
JOBNAM		007410	LVR	LOLER		010054'		NEST1		000733'		NOSPC2		001243'	
JOBREL		006420'	EXT	LOLS		000002	SPD	NESTB		000762'		NOSTBF		010657'	
JOBSA		000000	EXT	LOOK		000000	SPD	NESTDP		000004	SPD	NOSTNM		007366	LVR
JOBSYM		000000	EXT	LOOKBF		007416	LVR	NESTTD		001067'		NOSW		003234'	
KFLG		200000	SPD	LOWST		007443	LVR	NEXT2		000740'		NOTMP		000714'	
KFLGD		010000	SPD	LOWTOP	777777	777777		NFIL		003561'		NOTYET		003644'	
LATER		005100'		LPPN		000004		NFIL1		003623'		NPROC1		007622	LVR
LAUD		000001	SPD	LPRV		000003	SPD	NFIL2		003622'		NPROCS		000010	SPD
LBITS		000002	SPD	LPTFG		000010	SPD	NFILE		000101	SPD	NREXT		003425'	
LDAT		000003		LST1		007635'		NFLG		000020	SPD	NSDCHN		000005	SPD
LDAT.D		011014'		LSTB2		007756'		NFLGD		000200	SPD	NSDNM		000003	SPD
LDAT.T		011015'		LSTBL		007716'		NINTAB		010662'		NSDO1		010670'	
LDPPN		000000	SPD	LSTCSP		007652'		NMCM		004155'		NSDO2		010673'	
LEXT		000002		LSTDV		007470	LVR	NMLSTL		000010	SPD	NSDO3		010676'	
LFLG		000002	SPD	LSTLP		007563'		NMLSTP		007501	LVR	NSDOPN		011013	LVR
LHUN		000004	SPD	LSTLP1		007560'		NMLSW		010353	LVR	NSDREL		001321'	
LIBSW		000004	SPD	LSTLPP		007564'		NOBDVR		003357'		NSDS1		001000	SPD
LIMSW		001000	SPD	LSTNF		007605'		NOBIN		000400	SPD	NSDS2		000400	SPD
LINES		000003	SPD	LSTRSW		000001	SPD	NOCBD		001164'		NSDS3		000200	SPD
LISDEV		010527	LVR	LSTSW		007702'		NOCOM1		003511'		NSDSWS		007553	LVR
LISTR		007553'		LSWBTB		010016'		NOCOMS		007533'		NSTOU1		001273'	
LISTSW		000001	SPD	LSWBTL		000015	SPD	NOCOR		001061'		NSTOU2		001302'	
LKLUD		006077'		MACNUM		000002	SPD	NOCRDV		004312'		NSTOUT		001257'	
LKLUDE		006124'		MACSW		200000	SPD	NODAT		000004	SPD	NSWTAB		010654'	
LKTAB		000776'		MAIL		007032'		NODEV		000146'		NUMAC		007223	LVR
LKUFD		007652	LVR	MAIL1		007033'		NOEDSW		007505'		NUMAT		007564	LVR
LKUP		006642'		MAKE		007455'		NOEXT		003506'		NUMF		100000	SPD
LKUP1		006661'		MAPST		000400	SPD	NOFIL		001075'		NUMFS		000100	SPD
LKUP2		006667'		MAXNST		000017	SPD	NOFIL1		003650'		NUNDO		000002'	
LKUP3		006651'		MBXHSH		000177	SPD	NOFILP		003772'		NUNPNT		000006	SPD
LKUP4		006646'		MFLG		000200	SPD	NOFIT		001357'		NUNTOP		000007	SPD
LKUP5		006655'		MFLGD		004000	SPD	NOLODS		000200	SPD	NUSER		006127'	
LLG		000040	SPD	MINAM		004611'		NOLOOK		000010	SPD	NXACT		003104'	
LLINK		000002	SPD	ML		007055'		NOLST		003450'		NXEXT		003564'	
LNAM		000001		ML2		007060'		NOLST1		003443'		NXFIL		002376'	
LOADS1		003213'		ML2A		007074'		NOMBX		006731'		NXFIL1		002377'	
LOADS2		003215'		MODIFY		007463'		NONAM		001251'		NXFILP		002512'	
LODCT2		007542	LVR	MODPAR		007440	LVR	NONAM1		001307'		NXSLC		007621'	
LODCTR		007537	LVR	MONLG		000014	SPD	NONSBS		000003	SPD	NXTNM		004170'	
LODNAM		001447'		MONTAB		005215'		NONSDV		007377	LVR	NXTRNM		004167'	
LODR0		003531'		MONTH		006273'		NONSNM		007374	LVR	NXTUFD		004061'	
LODR1		003533'		MULTI		010042'		NONSPN		007405	LVR	OBTB		010372'	
LODR2		003543'		MULTIC		010046'		NONSTD		010575'		OBUF		011046	LVR
LODS1		003216'		MVCR		001477'		NONSXT		007402	LVR	OCTTYP		005557'	
LODSB2		011153	LVR	N		000006		NONUSD		007371	LVR	ODEV		007611	LVR
LODSBK		011150	LVR	NAMCOM		001102'		NOPCDV		000015'		OEXT		007526	LVR
LODSCT		000010	SPD	NAMCT		010155	LVR	NOPREV		001127'		OFLG		002000	SPD
LODSIX		001645'		NAME		000001		NORPRT		005277'		OKLOOK		003570'	
LODSP		007534	LVR	NAMES1		007473	LVR	NORT		000017	SPD	OKPICK		000352'	
LODSP2		007545	LVR	NAMES2		007507	LVR	NOSCAN		000004	SPD	OLDAT		003606'	
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 85-4
RPG.MAC	12-JUL-73 14:59		SYMBOL TABLE

OLDAT1		003607'		PCM1		000004	SPD	RADX10		005561'		SCAN1		000310'	
OLDV		003117'		PCM2		000010	SPD	RCOM		007524'		SCAN2		000315'	
ONAM		007523	LVR	PCNAM		007355	LVR	RDBLK		006237'		SCANS		000256'	
ONSET		003305'		PCNUM		007614	LVR	RDIUFD		003777'		SCANW		006200'	
OPENB		007314	LVR	PCPPN		007146	LVR	RDSBLK		006766'		SCNS1		000264'	
OPIP1		004641'		PDL		000100	SPD	RDUFD1		004020'		SCNS2		000260'	
OPIP2		004642'		PDLB		011073	LVR	RDXTYP		005562'		SCNS3		000272'	
OPIPW		004634'		PDP		010735'		RDYRD		005133'		SCNS4		000273'	
OPMBX		006672'		PDP10		005534'		READER		001063'		SCNUM		000326'	
OPMBX1		006723'		PDPREN		005243'		RECALF		200000	SPD	SCNUM1		000327'	
OPMBX2		006721'		PERF		000200	SPD	RELDT		003361'		SCW1		006206'	
OPMFD		006375'		PFDC		006353'		RELSW		000010	SPD	SCW2		006210'	
OPNTB		010353'		PFLG		000001	SPD	RELT2		003664'		SCW3		006214'	
OPPN		007531	LVR	PFLGD		001000	SPD	RELTAB		001004'		SD0		005775'	
OPUD		006164'		PIPF		010000	SPD	RENEST		000666'		SD1		005776'	
OSWD		004625'		PJOB	047000	000030		RENM		005721'		SD2		005777'	
OTAB		010315'		PLCROS		001633'		RENM1		005736'		SD3		006000'	
OUCRLF		010063'		PLSTSW		007666'		RENTSW		000004	SPD	SD4		006001'	
OUT1		010706'		POPFIL		000752'		REREL		003324'		SD5		006002'	
OUTB		010710'		POST		007356'		RESCAN	051400	000000		SD6		006003'	
OUTBLI		010133'		POST1		007360'		RESET	047000	000000		SDAT		007603	LVR
OUTCBL		010125'		POST1B		007371'		RFL		000005	SPD	SDECL		005742'	
OUTCHR	051040	000000		POST1C		007375'		RFLG		000002	SPD	SDM		005762'	
OUTCRF		010177'		POST3		007404'		RFLGD		000002	SPD	SEMIC		000377'	
OUTDIR		010155'		POST3A		007407'		RJUST		000225'		SEMIC1		000400'	
OUTDV		004225'		POST4		007416'		RLSTAB		001426'		SEND		006410'	
OUTEDT		010205'		POST5		007422'		RLTB		010276'		SETBDV		003062'	
OUTER		001055'		PPN		006031'		RMON		005206'		SETCCS		003010'	
OUTF4		010067'		PPNS		007476	LVR	RND		006140'		SETCP		003637'	
OUTFAL		010117'		PRCLP		003460'		RND1		006143'		SETCR1		003244'	
OUTFCM		010213'		PRCLP2		003477'		RND2		006154'		SETCRC		003240'	
OUTFTF		010103'		PRCNAM		001437'		RPGDB		011023'	SEX	SETCRF		003237'	
OUTLOD		010147'		PRCTAB		004343'		RPGPAR		007435	LVR	SETCRO		003242'	
OUTLST		010163'		PRINT		007550'		RPGRET		002250'		SETDT		003634'	
OUTMAC		010075'		PRMPTF		000100	SPD	RPGRT		002251'		SETLDV		003063'	
OUTNUM		007657'		PRMSW		000001	SPD	RPGSET		001652'		SETLIC	047000	777770	
OUTOCT		003763'		PROCON		001057'		RPGSRC		000004	SPD	SETMAL	047000	777761	
OUTPIP		010171'		PROCS		000001	SPD	RPICKP		002222'		SETMAP		003052'	
OUTPPN		003750'		PROCS0		003161'		RPIDRL		002221'		SETONM		003201'	
OUTSIM		010111'		PROCS1		003147'		RPIDSK		002170'		SETPAR		001732'	
OUTSIX		004206'		PROCS2		003164'		RPINOF		002217'		SETPRE		001743'	
OUTSTR	051140	000000		PROCS3		003173'		RPITMP		002144'		SETPRF		001735'	
OUTSW		004214'		PROCSW		003141'		RPITOK		002166'		SETPRO		002053'	
OUTSW1		004221'		PROMPT		005544'		RPST2		002240'		SETPRV	047000	777767	
OUTVAS		010141'		PROTAB		005340'		RUN	047000	000035		SETPRX		001766'	
P		000017		PRTDIG		005566'		RUNBLK		007124	LVR	SETREL		003712'	
P.RPGR		000001	SPD	PRTIM1		006307'		RUNCMD		002111'		SETRN2		000072'	
P.SPRO		000002	SPD	PTAB		010576	LVR	RUNSW		000001	SPD	SETRNF		000060'	
PALFAL		003646'		PVGEX		000400	SPD	SAVC		007600	LVR	SETRNN		000054'	
PARFLG		000004	SPD	PVTYMX		000200	SPD	SAVCHR		007220	LVR	SETRPG		000100'	
PCDEV		007135	LVR	QFLG		000004	SPD	SAVEXT		634166		SETRUN		000055'	
PCEXT		007143	LVR	QOFIL2		001107'		SAVPPN		007636	LVR	SETS1		010411'	
PCM		007572	LVR	RADX10		005561'		SBUF		010251	LVR	SETS17		010430'	
RPG VERSION 111.0	MACRO 46-7 15:00 12-JUL-73 PAGE 85-5
RPG.MAC	12-JUL-73 14:59		SYMBOL TABLE

SETTM		003605'		STSYM		003020'		TBL2		007113'		TYMSPC		000111	SPD
SETUP		003275'		STTYMX		001711'		TBL3		007134'		TYMX		040000	SPD
SETUSR		003034'		SUJFF		007666	LVR	TBLE		007132'		TYPERR		001045'	
SFDC		006337'		SVAC		007721	LVR	TBLG		000051	SPD	TYPR		007551'	
SFLG		000040	SPD	SVDEV		007162	LVR	TDATE		006255'		UFDENT		004114'	
SFLGD		000010	SPD	SVEXT		007173	LVR	TECO		007456'		UFDLK		004137'	
SHED		010337	LVR	SVIND		007556	LVR	TEMP		000001	SPD	UFDRET		004107'	
SIMNUM		000004	SPD	SVJBFF		007424	LVR	TERMC1		000606'		UFDS		007647	LVR
SIMSW		040000	SPD	SVJFF		000000	SPD	TERMF		200000	SPD	UFDWD		004131'	
SIXOUT		001114'		SVLNM		007633	LVR	TFDC		006363'		UFLGD		040000	SPD
SIZEP		000001	SPD	SVNAM		007165	LVR	TFLGD		000004	SPD	UNRECS		001071'	
SLEEP	047000	000031		SVPDL		007674	LVR	TIMER	047000	000022		USRPPN		007454	LVR
SN1		006414'		SVPPN		007201	LVR	TLSTSW		007674'		USTOP		001461'	
SN1A		006477'		SVPT		000014		TMNER		001051'		UTPCLR	047000	000013	
SN1B		006470'		SVRPP		000000	LVR	TMPCOR	047000	000044		VASNUM		000010	SPD
SN1C		006504'		SVSWP		007671	LVR	TMPF1		000001	SPD	VASSW		002000	SPD
SN2		006543'		SW		000000	SPD	TMPF2		000002	SPD	VCOMPI	000111	000000	INT
SN3		006507'		SWBITS		003227'		TMPF3		000003	SPD	VFLGD		020000	SPD
SN3A		006525'		SWBK		000005	SPD	TMPF4		000004	SPD	WRD4		000001	
SN3B		006535'		SWBKB		007520	LVR	TMPF5		000005	SPD	WRTPAR		001771'	
SN4		006552'		SWBKL		007515	LVR	TMPFIL		007306	LVR	WRTPRB		002004'	
SN4A		006566'		SWBKS		007207	LVR	TMPFL1		000001		WRTPRF		001777'	
SN5		006573'		SWBLK		011145	LVR	TMPFLG		007226	LVR	WRTPRL		001776'	
SN6		006602'		SWCNT		000012		TMSTD		001125'		WTBLK		006231'	
SN7		006632'		SWHELP		004646'		TMSZ		000021		XCTR		001644'	
SN8		006615'		SWHLPM		004650'		TODAY		005200'		XIT		001415'	
SN9		006606'		SWPT		000013		TPML		007147'		XPAND		001470'	
SOONER		005077'		SWPT0		007575	LVR	TPML1		007151'		XSWS		003001'	
SOONR		000100	SPD	SWS0A1		002765'		TPML2		007201'		XXX		000002	SPD
SPACT		040000	SPD	SWSC0A		002754'		TPMLHD		010417	LVR	XXZ		011013'	SPD
SPACT2		020000	SPD	SWSC0B		002767'		TPMLX		007444'		YFLGD		000020	SPD
SPCF		400000	SPD	SWSC0C		002751'		TPOPJ		001504'		YN		006005'	
SPCFND		001226'		SWSC0D		002775'		TPOST		007431'		YN1		006007'	
SPCHR		000321'		SWSC1		002724'		TPPPN		006156'		YN2		006013'	
SPCOK		001245'		SWSC2		002742'		TPS		005603'		YN4		006006'	
SPCOM		100000	SPD	SWSC3		002732'		TPS1		005614'		YN5		006027'	
SPFND		000040'		SWSCAN		002722'		TPS2		005607'		ZFLGD		000040	SPD
SPRC		000000	SPD	SWTAB		002575'		TPS3		005616'		%BFLG		100000	SPD
SPREN		005664'		SWTAB2		002646'		TPSIX		005576'		
SPREND		002101'		SWTAB3		002717'		TRYIDP		005320'		
SPRLP		002054'		SYNERR		001065'		TRYIT		001636'		
SPSTB		007653'		SYSDEV	637163	000000		TRYLST		003427'		
SQFLG		000001	SPD	SYSSW		000000	SPD	TRYPP1		000242'		
SRUS		006117'		T1		000001		TRYPPN		000164'		
SRUSR		006121'		T2		000002		TRYREL		003657'		
STANSW		000000	SPD	T3		000003		TRYSV2		001664'		
STARGS		010727'		T3POPJ		004165'		TRYSVD		001656'		
STCLS		003013'		T4		000004		TSPROP		040000	SPD	
STIM		007606	LVR	T5		000005		TSWRT		007612'		
STINI		003012'		T6		000013		TTAB		010554	LVR	
STNAM		003017'		T7		000014		TYMEX		005533'		
STPT		002114'		TBL		007105'		
0 B`