    P R O G R A M   C O B O L . 		COBOL 4(56)	22-APR-73  19:16		PAGE 1

    0001    IDENTIFICATION DIVISION.
    0002    ENVIRONMENT DIVISION.
    0003    CONFIGURATION SECTION.
    0004    SPECIAL-NAMES.
    0005        CHANNEL (1) IS TOP-OF-PAGE.
    0006    INPUT-OUTPUT SECTION.
    0007    FILE-CONTROL.
    0008        SELECT INFILE    ASSIGN TO DSK RECORDING MODE IS ASCII.
    0009        SELECT OUTFILE   ASSIGN TO DSK RECORDING MODE IS ASCII.
    0010        SELECT SORTFILE  ASSIGN TO DSK,DSK,DSK.
    0011  
    0012    DATA DIVISION.
    0013  
    0014    FILE SECTION.
    0015  
    0016    FD INFILE  VALUE OF ID IS   'SALES DAT'.
    0017    01 I-REC PIC X(34).
    0018  
    0019    SD SORTFILE.
    0020    01 S-REC.
    0021        05 F1   PIC X(10).
    0022        05 F2   PIC X(12).
    0023        05 F3   PIC 9(5).
    0024        05 F4   PIC 9(4).
    0025        05 F5   PIC 9(3).
    0026  *     05 F6   PIC ****.
    0027  *     05 F7   PIC ****.
    0028  *     05 F8   PIC ****.
    0029  *     05 F9   PIC ****.
    0030  *     05 F10  PIC ****.
    0031  
    0032    FD OUTFILE VALUE OF ID IS   'SALES REP'.
    0033    01 R-REC.
    0034        05 F5   PIC Z(8).
    0035        05 FILLER PIC X(1).
    0036        05 F1   PIC X(11).
    0037        05 F2   PIC X(12).
    0038        05 F3   PIC Z(8).
    0039        05 F4   PIC Z(6).
    0040        05 F6   PIC Z(8).
    0041  *     05 F7   PIC ****.
    0042  *     05 F8   PIC ****.
    0043  *     05 F9   PIC ****.
    0044  *     05 F10  PIC ****.
    0045  
    0046    01 R-HEAD PIC X(72).
    0047    01 R-SUB.
    0048        05 SUBTEXT PIC X(32).
    0049        05 SUBF3 PIC Z(8).
    0050        05 SUBF4 PIC Z(6).
    0051        05 SUBF6 PIC Z(8).
    0052  
    0053    WORKING-STORAGE SECTION.
    0054  
    0055    01 W-REC.
    0056        05 F1 PIC X(10).    P R O G R A M   C O B O L . 		COBOL 4(56)	22-APR-73  19:16		PAGE 1-1

    0057        05 F2 PIC X(12).
    0058        05 F3 PIC 9(5).
    0059        05 F4 PIC 9(4).
    0060        05 F5 PIC 9(3).
    0061        05 F6 PIC 9(6).
    0062  *     05 F7   PIC ****.
    0063  *     05 F8   PIC ****.
    0064  *     05 F9   PIC ****.
    0065  *     05 F10  PIC ****.
    0066  
    0067    01 SUB OCCURS 9 TIMES.
    0068        05 SUBF OCCURS 10 TIMES PIC 9(10)V9(5).
    0069  
    0070    01 W-HEAD.
    0071        05 W-HEAD-TEXT PIC X(64) VALUE
    0072        'DISTRICT SALESMAN   ACCOUNT      SERVICE EQUIP   TOTAL    PAGE'.
    0073        05 W-HEAD-PAGE PIC Z(3).
    0074  
    0075    77 W-HEAD-DASH PIC X(3) VALUE "---".
    0076  
    0077    01 SUB-TEXT OCCURS 9 TIMES PIC X(32).
    0078  
    0079    77 ISKIPLINE PIC 9(3).
    0080    01 ISKIP OCCURS 9 TIMES PIC 9(3).
    0081  
    0082    77 I  PIC 9(2).
    0083    77 J  PIC 9(2).
    0084    77 K PIC 9(2).
    0085  
    0086    77 X1 PIC 9(3).
    0087    77 X2 PIC X(10).
    0088    77 X3 PIC *****.
    0089    77 X4 PIC *****.
    0090    77 IFLAG PIC 9(1).
    0091    77 K1 PIC 9(3) VALUE   1. 
    0092    77 K2 PIC 9(3).
    0093    77 K3 PIC 9(3) VALUE  27. 
    0094    77 K4 PIC 9(3) VALUE  31. 
    0095    77 LINESTOSKIP PIC 9(3).
    0096  
    0097    77 DUMMY PIC X(72) VALUE IS SPACES.
    0098  
    0099    PROCEDURE DIVISION.
    0100  
    0101    BEGIN.
    0102        SORT SORTFILE ON ASCENDING KEY F5 IN S-REC,F1 IN S-REC,F2
    0103         IN S-REC  USING INFILE OUTPUT PROCEDURE MAIN-BEGIN THRU MAIN-EXIT.
    0104        DISPLAY 'JOB COMPLETE'.
    0105        STOP RUN.
    0106    MAIN-BEGIN.
    0107        OPEN OUTPUT OUTFILE.
    0108        SUBTRACT 1 FROM K4 GIVING K2.
    0109        SET IFLAG TO 0.
    0110        SET ISKIPLINE TO 1.
    0111        SET ISKIP(1) TO 2.
    0112        SET ISKIP(2) TO 4.    P R O G R A M   C O B O L . 		COBOL 4(56)	22-APR-73  19:16		PAGE 1-2

    0113  *     SET ISKIP(3) TO 0.
    0114  *     SET ISKIP(4) TO 0.
    0115        SET ISKIP(9) TO 1.
    0116        MOVE '         **********' TO SUB-TEXT(1).
    0117        MOVE '********' TO SUB-TEXT(2).
    0118        MOVE '*' TO SUB-TEXT(3).
    0119        MOVE '*' TO SUB-TEXT(4).
    0120        MOVE 'GRAND TOTALS*' TO SUB-TEXT(9).
    0121        RETURN SORTFILE INTO W-REC AT END GO TO EOF.
    0122        PERFORM TOP.
    0123        GO TO LNITM.
    0124    NEWREC.
    0125        MOVE F5 IN W-REC TO X1.
    0126        MOVE F1 IN W-REC TO X2.
    0127  *     MOVE ** IN W-REC TO X3.
    0128  *     MOVE ** IN W-REC TO X4.
    0129        RETURN SORTFILE INTO W-REC AT END GO TO EOF.
    0130        IF X1 NOT EQUAL TO F5 IN W-REC OR X2 NOT EQUAL TO F1 IN
    0131          W-REC GO TO SUB1PAR.
    0132        GO TO LNITM.
    0133    TOP.
    0134        SUBTRACT K2 FROM K4 GIVING LINESTOSKIP.
    0135        WRITE R-HEAD FROM W-HEAD-DASH AFTER ADVANCING LINESTOSKIP.
    0136        WRITE R-HEAD FROM DUMMY.
    0137        MOVE K1 TO W-HEAD-PAGE.
    0138        WRITE R-HEAD FROM W-HEAD BEFORE ADVANCING 2 LINES.
    0139        SET K1 UP BY 1.
    0140        SET K2 TO 3.
    0141    LNITM.
    0142        IF IFLAG=1 GO TO FINAL.
    0143        ADD F3 IN W-REC, F4 IN W-REC GIVING F6 IN W-REC.
    0144        MOVE CORRESPONDING W-REC TO R-REC.
    0145        WRITE R-REC.
    0146        MOVE SPACES TO R-REC.
    0147        ADD ISKIPLINE TO K2.
    0148        ADD F3 IN W-REC TO SUBF(1,1).
    0149        ADD F4 IN W-REC TO SUBF(1,2).
    0150        ADD F6 IN W-REC TO SUBF(1,3).
    0151  *     ADD ** IN W-REC TO SUBF(1,4).
    0152  *     ADD ** IN W-REC TO SUBF(1,5).
    0153  *     ADD ** IN W-REC TO SUBF(1,6).
    0154  *     ADD ** IN W-REC TO SUBF(1,7).
    0155  *     ADD ** IN W-REC TO SUBF(1,8).
    0156  *     ADD ** IN W-REC TO SUBF(1,9).
    0157  *     ADD ** IN W-REC TO SUBF(1,10).
    0158        IF K2>K3 PERFORM TOP.
    0159        GO TO NEWREC.
    0160    SUB1PAR.
    0161        SET I TO 1.
    0162        PERFORM SUB-BEGIN THRU SUB-END.
    0163        IF K2>K3 PERFORM TOP.
    0164        IF X1 NOT EQUAL TO F5 IN W-REC GO TO SUB2PAR.
    0165  
    0166        GO TO LNITM.
    0167    SUB2PAR.
    0168        SET I TO 2.    P R O G R A M   C O B O L . 		COBOL 4(56)	22-APR-73  19:16		PAGE 1-3

    0169        PERFORM SUB-BEGIN THRU SUB-END.
    0170        IF K2>K3 PERFORM TOP.
    0171  *     IF X1 NOT EQUAL ** IN W-REC OR X2 NOT EQUAL
    0172  *         ** IN W-REC GO TO SUB3PAR.
    0173        GO TO LNITM.
    0174    SUB3PAR.
    0175        SET I TO 3.
    0176        PERFORM SUB-BEGIN THRU SUB-END.
    0177        IF K2>K3 PERFORM TOP.
    0178  *     IF X1 NOT EQUAL TO ** IN W-REC GO TO SUB4PAR.
    0179  * 
    0180        GO TO LNITM.
    0181    SUB4PAR.
    0182        SET I TO 4.
    0183        PERFORM SUB-BEGIN THRU SUB-END.
    0184        IF K2>K3 PERFORM TOP.
    0185  *     THIS LINE SHOULD BE BLANK IN THE HIGHEST ORDER SUBTOTAL ROUTINE.
    0186        GO TO LNITM.
    0187    SUB-BEGIN.
    0188        MOVE SUB-TEXT(I) TO SUBTEXT.
    0189        MOVE SUBF(I,1) TO SUBF3.
    0190        MOVE SUBF(I,2) TO SUBF4.
    0191        MOVE SUBF(I,3) TO SUBF6.
    0192  *     MOVE SUBF(I,4) TO SUBFF**.
    0193  *     MOVE SUBF(I,5) TO SUBFF**.
    0194  *     MOVE SUBF(I,6) TO SUBFF**.
    0195  *     MOVE SUBF(I,7) TO SUBFF**.
    0196  *     MOVE SUBF(I,8) TO SUBFF**.
    0197  *     MOVE SUBF(I,9) TO SUBFF**.
    0198  *     MOVE SUBF(I,10) TO SUBFF**.
    0199        MOVE ISKIP(I) TO K.
    0200        WRITE R-SUB BEFORE ADVANCING K LINES.
    0201        MOVE SPACES TO R-SUB.
    0202        ADD ISKIP(I) TO K2.
    0203    SUB-END.
    0204        PERFORM SUB-ADD VARYING J FROM 1 BY 1 UNTIL J>10.
    0205    SUB-ADD.
    0206        IF I=1 ADD SUBF(1,J) TO SUBF(9,J).
    0207        ADD I,1 GIVING K.
    0208        ADD SUBF(I,J) TO SUBF(K,J).
    0209        MOVE ZEROS TO SUBF(I,J).
    0210    EOF.
    0211        SET X1 TO 999.
    0212        SET IFLAG TO 1.
    0213        GO TO SUB1PAR.
    0214    FINAL.
    0215        SET I TO 9.
    0216        PERFORM SUB-BEGIN.
    0217        SUBTRACT K2 FROM K4 GIVING LINESTOSKIP.
    0218        WRITE R-HEAD FROM W-HEAD-DASH AFTER ADVANCING LINESTOSKIP LINES.
    0219        CLOSE OUTFILE.
    0220    MAIN-EXIT.
    0221        EXIT.    P R O G R A M   C O B O L . 		COBOL 4(56)	22-APR-73  19:16		PAGE W-1

WARNINGS:

    0189  MOST SIGNIFICANT DIGITS TRUNCATED ON SUBF
    0189  LEAST SIGNIFICANT DIGITS TRUNCATED ON SUBF
    0190  MOST SIGNIFICANT DIGITS TRUNCATED ON SUBF
    0190  LEAST SIGNIFICANT DIGITS TRUNCATED ON SUBF
    0191  MOST SIGNIFICANT DIGITS TRUNCATED ON SUBF
    0191  LEAST SIGNIFICANT DIGITS TRUNCATED ON SUBF
    0199  MOST SIGNIFICANT DIGITS TRUNCATED ON ISKIP


NO FATAL ERRORS, 7 WARNINGS
  