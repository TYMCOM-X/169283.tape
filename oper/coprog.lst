    P R O G R A M   C O P R O G 		COBOL 4(56)	25-MAR-73  07:34		PAGE 1

    0001    IDENTIFICATION DIVISION.
    0002    PROGRAM-ID. COPROG.
    0003    AUTHOR. ANY PROGRAMMER.
    0004    INSTALLATION. TYMSHARE.
    0005    DATE-WRITTEN. MARCH-21-1973.
    0006    SECURITY. NONE.
    0007    REMARKS. DEMONSTRATION COBOL PROGRAM.
    0008    ENVIRONMENT DIVISION.
    0009    CONFIGURATION SECTION.
    0010    SOURCE-COMPUTER. DECsystem-10. 
    0011    OBJECT-COMPUTER. PDP-10.
    0012    INPUT-OUTPUT SECTION.
    0013    FILE-CONTROL.
    0014           SELECT REVFILE ASSIGN TO DSK
    0015           RECORDING MODE IS ASCII.
    0016           SELECT COSTFILE ASSIGN TO DSK
    0017           RECORDING MODE IS ASCII.
    0018           SELECT OUTFILE ASSIGN TO DSK
    0019           RECORDING MODE IS ASCII.
    0020    DATA DIVISION.
    0021    FILE SECTION.
    0022    FD REVFILE
    0023           VALUE OF IDENTIFICATION IS "REV   DAT".
    0024    01 REVREC PIC S9(6).
    0025    FD COSTFILE
    0026           VALUE OF IDENTIFICATION IS "COST  DAT".
    0027    01 COSTREC PIC S9(6).
    0028    FD OUTFILE
    0029           VALUE OF IDENTIFICATION IS "OUTRPTDAT".
    0030    01 OUTREC.
    0031                   05 OUT-MARGIN PIC X(15).
    0032                   05 OUT-JAN PIC X(7).
    0033                   05 OUT-JAN-ED REDEFINES OUT-JAN PIC ZZZ,ZZ9.
    0034                   05 FILLER PIC X.
    0035                   05 OUT-FEB PIC X(9).
    0036                   05 OUT-FEB-ED REDEFINES OUT-FEB PIC Z,ZZZ,ZZ9.
    0037                   05 FILLER PIC XX.
    0038                   05 OUT-MAR PIC X(7).
    0039                   05 OUT-MAR-ED REDEFINES OUT-MAR PIC ZZZ,ZZ9.
    0040                   05 FILLER PIC XX.
    0041                   05 OUT-QTR PIC X(11).
    0042                   05 OUT-QTR-ED REDEFINES OUT-QTR PIC ZZZ,ZZZ,ZZ9.
    0043    WORKING-STORAGE SECTION.
    0044    01  HEADING-1.
    0045           05 FILLER PIC X(29) VALUE SPACES.
    0046           05 FILLER PIC X(11) VALUE 'ABC COMPANY'.
    0047           05 FILLER PIC X(14) VALUE SPACES.
    0048    01  HEADING-2.
    0049           05 FILLER PIC X(25) VALUE SPACES.
    0050           05 FILLER PIC X(19) VALUE 'OPERATING STATEMENT'.
    0051           05 FILLER PIC X(10) VALUE SPACES.
    0052    01  HEADING-3.
    0053           05 FILLER PIC X(25) VALUE SPACES.
    0054           05 FILLER PIC X(19) VALUE 'FIRST QUARTER 1973 '.
    0055    01  QTRREV      PIC S9(7) VALUE ZEROS COMP.
    0056    01  QTRCOST     PIC S9(7) VALUE ZEROES COMP.    P R O G R A M   C O P R O G 		COBOL 4(56)	25-MAR-73  07:34		PAGE 1-1

    0057    01  QTROVERHEAD PIC S9(7) VALUE ZEROES COMP.
    0058    01  QTROTHER    PIC S9(7) VALUE ZEROES COMP.
    0059    01  QTRTOTCOST  PIC S9(7) VALUE ZEROES COMP.
    0060    01  QTRPROFIT   PIC S9(7) VALUE ZEROES COMP.
    0061    01  QTRPERCENT-AREA.
    0062           05 QTRPERCENT  PIC S99V999 COMP VALUE ZEROES.
    0063    01  TABLE.
    0064           05 HOLDERS OCCURS 3 TIMES INDEXED BY IDX.
    0065                   10 REVENUE      PIC S9(6) COMP.
    0066                   10 COST         PIC S9(6) COMP.
    0067                   10 OVERHEAD     PIC S9(6) COMP.
    0068                   10 OTHER        PIC S9(6) COMP.
    0069                   10 TOTCOST      PIC S9(7) COMP.
    0070                   10 PROFIT       PIC S9(6) COMP.
    0071                   10 PERCENT             PIC S99V999 COMP.
    0072  
    0073    PROCEDURE DIVISION.
    0074    HSE-KEEP.
    0075           OPEN INPUT REVFILE, COSTFILE.
    0076           OPEN OUTPUT OUTFILE.
    0077           SET IDX TO 0.
    0078    WRITE-HEADINGS.
    0079           WRITE OUTREC FROM HEADING-1.
    0080           WRITE OUTREC FROM HEADING-2.
    0081           WRITE OUTREC FROM HEADING-3 BEFORE ADVANCING 4 LINES.
    0082           MOVE SPACES TO OUTREC.
    0083           MOVE 'JANUARY' TO OUT-JAN.
    0084           MOVE ' FEBRUARY' TO OUT-FEB.
    0085           MOVE '  MARCH' TO OUT-MAR.
    0086           MOVE '1ST QUARTER' TO OUT-QTR.
    0087           WRITE OUTREC BEFORE ADVANCING 2 LINES.
    0088           MOVE SPACES TO OUTREC.
    0089    READ-DATA.
    0090           SET IDX UP BY 1.
    0091           READ REVFILE INTO REVENUE (IDX) AT END GO TO COMPUTE-DATA.
    0092           READ COSTFILE INTO COST (IDX) AT END GO TO COMPUTE-DATA.
    0093           IF IDX EQUAL TO 3 GO TO COMPUTE-DATA.
    0094           GO TO READ-DATA.
    0095    COMPUTE-DATA.
    0096           SET IDX TO 1.
    0097    CD1.
    0098           MULTIPLY COST (IDX) BY .5 GIVING OVERHEAD (IDX) ROUNDED.
    0099           MULTIPLY REVENUE (IDX) BY .2 GIVING OTHER (IDX) ROUNDED.
    0100           ADD COST (IDX),OVERHEAD (IDX), OTHER (IDX) TO TOTCOST (IDX).
    0101           SUBTRACT TOTCOST (IDX) FROM REVENUE (IDX) GIVING PROFIT (IDX).
    0102           COMPUTE PERCENT (IDX) =100*(PROFIT (IDX)/
    0103                   REVENUE (IDX)).
    0104           ADD .5 TO PERCENT (IDX).
    0105           ADD REVENUE (IDX)       TO QTRREV.
    0106           ADD COST (IDX)  TO QTRCOST.
    0107           ADD OVERHEAD (IDX)      TO QTROVERHEAD.
    0108           ADD OTHER (IDX) TO QTROTHER.
    0109           ADD TOTCOST (IDX)       TO QTRTOTCOST.
    0110           ADD PROFIT (IDX)        TO QTRPROFIT.
    0111           IF IDX EQUAL TO 3 GO TO WRITE-DATA.
    0112           SET IDX UP BY 1.    P R O G R A M   C O P R O G 		COBOL 4(56)	25-MAR-73  07:34		PAGE 1-2

    0113           GO TO CD1.
    0114    WRITE-DATA.
    0115           MOVE 'SALES REVENUE' TO OUT-MARGIN.
    0116           MOVE REVENUE (1) TO OUT-JAN-ED.
    0117           MOVE REVENUE (2) TO OUT-FEB-ED.
    0118           MOVE REVENUE (3) TO OUT-MAR-ED.
    0119           MOVE QTRREV      TO OUT-QTR-ED.
    0120           WRITE OUTREC BEFORE ADVANCING 2 LINES.
    0121           MOVE 'COST OF SALES' TO OUT-MARGIN.
    0122           MOVE COST (1) TO OUT-JAN-ED.
    0123           MOVE COST (2) TO OUT-FEB-ED.
    0124           MOVE COST (3) TO OUT-MAR-ED.
    0125           MOVE QTRCOST  TO OUT-QTR-ED.
    0126           WRITE OUTREC.
    0127           MOVE 'OVERHEAD     ' TO OUT-MARGIN.
    0128           MOVE OVERHEAD (1) TO OUT-JAN-ED.
    0129           MOVE OVERHEAD (2) TO OUT-FEB-ED.
    0130           MOVE OVERHEAD (3) TO OUT-MAR-ED.
    0131           MOVE QTROVERHEAD  TO OUT-QTR-ED.
    0132           WRITE OUTREC.
    0133           MOVE 'OTHER COSTS' TO OUT-MARGIN.
    0134           MOVE OTHER (1) TO OUT-JAN-ED.
    0135           MOVE OTHER (2) TO OUT-FEB-ED.
    0136           MOVE OTHER (3) TO OUT-MAR-ED.
    0137           MOVE QTROTHER TO OUT-QTR-ED.
    0138           WRITE OUTREC BEFORE ADVANCING 2 LINES.
    0139           MOVE 'TOTAL COSTS' TO OUT-MARGIN.
    0140           MOVE TOTCOST (1) TO OUT-JAN-ED.
    0141           MOVE TOTCOST (2) TO OUT-FEB-ED.
    0142           MOVE TOTCOST (3) TO OUT-MAR-ED.
    0143           MOVE QTRTOTCOST  TO OUT-QTR-ED.
    0144           WRITE OUTREC BEFORE ADVANCING 2 LINES.
    0145           MOVE 'PROFIT     ' TO OUT-MARGIN.
    0146           MOVE PROFIT (1) TO OUT-JAN-ED.
    0147           MOVE PROFIT (2) TO OUT-FEB-ED.
    0148           MOVE PROFIT (3) TO OUT-MAR-ED.
    0149           MOVE QTRPROFIT TO OUT-QTR-ED.
    0150           WRITE OUTREC.
    0151           MOVE '% OF SALES' TO OUT-MARGIN.
    0152           MOVE PERCENT (1) TO OUT-JAN-ED.
    0153           MOVE PERCENT (2) TO OUT-FEB-ED.
    0154           MOVE PERCENT (3) TO OUT-MAR-ED.
    0155           COMPUTE QTRPERCENT= 100 *(QTRPROFIT/QTRREV)
    0156           ADD .5 TO QTRPERCENT.
    0157           MOVE QTRPERCENT TO OUT-QTR-ED.
    0158           WRITE OUTREC.
    0159           PERFORM DASHES THRU DASHES-EXIT.
    0160    EOJ.
    0161           CLOSE REVFILE,COSTFILE,OUTFILE
    0162           STOP RUN.
    0163    DASHES.
    0164           MOVE SPACES TO OUT-MARGIN.
    0165           MOVE '-------' TO OUT-JAN,OUT-MAR.
    0166           MOVE ' --------' TO OUT-FEB.
    0167           MOVE '-----------' TO OUT-QTR.
    0168           WRITE OUTREC.    P R O G R A M   C O P R O G 		COBOL 4(56)	25-MAR-73  07:34		PAGE 1-3

    0169           WRITE OUTREC.
    0170    DASHES-EXIT.    EXIT.    P R O G R A M   C O P R O G 		COBOL 4(56)	25-MAR-73  07:34		PAGE W-1

WARNINGS:

    0101  MOST SIGNIFICANT DIGITS TRUNCATED ON PROFIT
    0102  MOST SIGNIFICANT DIGITS TRUNCATED ON PERCENT
    0140  MOST SIGNIFICANT DIGITS TRUNCATED ON TOTCOST
    0142  MOST SIGNIFICANT DIGITS TRUNCATED ON TOTCOST
    0152  LEAST SIGNIFICANT DIGITS TRUNCATED ON PERCENT
    0153  LEAST SIGNIFICANT DIGITS TRUNCATED ON PERCENT
    0154  LEAST SIGNIFICANT DIGITS TRUNCATED ON PERCENT
    0155  MOST SIGNIFICANT DIGITS TRUNCATED ON QTRPERCENT
    0157  LEAST SIGNIFICANT DIGITS TRUNCATED ON OUT-QTR-ED


NO FATAL ERRORS, 9 WARNINGS
 