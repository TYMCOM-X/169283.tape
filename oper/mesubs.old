            SUBROUTINE INIT(ICNT)
C      STANDARD COMMON FOR 1 PERIOD BENCHMARKS
C      SWAPS 1 PAGE OF COMMON, NDP STORED IN PAGES2-5, EACH
C      PAGE HOLDING 2 SEGMENTS
C      DIMENSIONED FOR 44 MEDIA AND 8 SEGMENTS
C
C
C      MEDIA DIMENSIONS
       DIMENSION D(990),IST(45),IDX(45),IXV(45),CIR(45),C(44),IUSEP(44)
       DIMENSION E(45),XMEDIA(44),H(45),AP(45),NDP(1023,2),NTUSO(44)
C
C      SEGMENT DIMENSIONS
       DIMENSION SEG(8),P(8),XY(8),XNU(8),XP(8),IRC(8),FWT(8)
       DIMENSION RWT(8),WXY(8),IP2(8)
C
C      MEDIA BY SEGMENT DIMENSIONS
       DIMENSION IXK(8,45),IDATA(45,8),IUP(45,8)
C
C      OTHER MISC. DIMENSIONS
       DIMENSION IMED(380),AB(4),ICRAP(2048),IFC(350)
C
C
       COMMON ICRAP,D,ALPHA,E,P,XNU,XMEDIA,AB,H,XNVAL,XOVAL,NOJ,
     1         ITTOP,MKTSG,TOTAL,NACT,NTUSO,IUSEP
C
C
C      SEGMENT EQUIVALENCES
       EQUIVALENCE (ICRAP(2),NDP,SEG),(ICRAP(19),XY),(ICRAP(36),IRC),
     1     (ICRAP(45),WXY),(ICRAP(62),FWT),(ICRAP(79),RWT),
     2     (ICRAP(96),IP2)
C
C      MEDIA EQUIVALENCES
       EQUIVALENCE (ICRAP(105),IST),(ICRAP(151),IDX),(ICRAP(197),IXV),
     1     (ICRAP(243),CIR),(ICRAP(334),C),(ICRAP(423),AP)
C
C
C      OTHER
       EQUIVALENCE (ICRAP(514),IXK),(ICRAP(875),IMED),
     1     (ICRAP(1273),IUP),(ICRAP(1634),IFC),
     2     (D,IDATA)
C
C      END STANDARD COMMON

       HUNK=100000.  
       ITO=1
       J=NOJ+1 
       DO 8040 I=1,MKTSG
         CALL DQCOM (I,N,ITP) 
         CALL NEWCOM(N) 
       DO 2000 IJ=1,NOJ 
       NL=J*(J-1)/2+IJ
       IF(IUSEP(IJ)-1) 8039,8039,8035
8035   NL=(IJ*(IJ-1)/2)+IJ
       IDATA(IJ,I) =NDP(NL,ITP)*(IUSEP(IJ)*(IUSEP(IJ)-1)/2)
       GO TO 2000
8039   IDATA(IJ,I)=NDP(NL,ITP)*ALPHA*E(J)
2000   CONTINUE
C2000   TYPE 8041,IDATA(IJ,I),NTUSO(IJ),XMEDIA(IJ),I,NL
8041   FORMAT(I8,I3,2X,A6,$ S:$,I2,$ DUP#$,I3/)
8040   CONTINUE
       CALL UCOM(IT,N,ITT,ICNT,MKTSG)
       CALL NEWCOM(N)
       DO 1000 IJ=1,NOJ
       DO 1000 I=1,MKTSG
1000   IUP(IJ,I)=      IDATA(IJ,I)
8000   CONTINUE
         CALL NEWCOM(1) 
       RETURN  
       END  
            SUBROUTINE QWRITE  
C      STANDARD COMMON FOR 1 PERIOD BENCHMARKS
C      SWAPS 1 PAGE OF COMMON, NDP STORED IN PAGES2-5, EACH
C      PAGE HOLDING 2 SEGMENTS
C      DIMENSIONED FOR 44 MEDIA AND 8 SEGMENTS
C
C
C      MEDIA DIMENSIONS
       DIMENSION D(990),IST(45),IDX(45),IXV(45),CIR(45),C(44),IUSEP(44)
       DIMENSION E(45),XMEDIA(44),H(45),AP(45),NDP(1023,2),NTUSO(44)
C
C      SEGMENT DIMENSIONS
       DIMENSION SEG(8),P(8),XY(8),XNU(8),XP(8),IRC(8),FWT(8)
       DIMENSION RWT(8),WXY(8),IP2(8)
C
C      MEDIA BY SEGMENT DIMENSIONS
       DIMENSION IXK(8,45),IDATA(45,8),IUP(45,8)
C
C      OTHER MISC. DIMENSIONS
       DIMENSION IMED(380),AB(4),ICRAP(2048),IFC(350)
C
C
       COMMON ICRAP,D,ALPHA,E,P,XNU,XMEDIA,AB,H,XNVAL,XOVAL,NOJ,
     1         ITTOP,MKTSG,TOTAL,NACT,NTUSO,IUSEP
C
C
C      SEGMENT EQUIVALENCES
       EQUIVALENCE (ICRAP(2),NDP,SEG),(ICRAP(19),XY),(ICRAP(36),IRC),
     1     (ICRAP(45),WXY),(ICRAP(62),FWT),(ICRAP(79),RWT),
     2     (ICRAP(96),IP2)
C
C      MEDIA EQUIVALENCES
       EQUIVALENCE (ICRAP(105),IST),(ICRAP(151),IDX),(ICRAP(197),IXV),
     1     (ICRAP(243),CIR),(ICRAP(334),C),(ICRAP(423),AP)
C
C
C      OTHER
       EQUIVALENCE (ICRAP(514),IXK),(ICRAP(875),IMED),
     1     (ICRAP(1273),IUP),(ICRAP(1634),IFC),
     2     (D,IDATA)
C
C      END STANDARD COMMON
         CALL NEWCOM(1) 
       DO 100 J=1,NOJ
       DO 100 IJ=J,NOJ+1
      NL=IJ*(IJ-1)/2+J 
       ZL=(D(NL)-CIR(J)*CIR(IJ))/(AMIN(CIR(J),CIR(IJ))-CIR(J)*CIR(IJ))
       DO 103 I=1,MKTSG 
       P1=(IXK(I,J)/10000.)/H(J)
      P2=(IXK(I,IJ)/10000.)/H(IJ)
103    XP(I)=ZL*AMIN(P1,P2)+(1.-ZL)*P1*P2
            TDUP=0.0
       DO 200 I=1,MKTSG 
200       TDUP=TDUP+XNU(I)*XP(I)
       IF(TDUP)2010,2010,2020 
2010     FRA=1.  
      GO TO  2050 
2020    FRA=TOTAL*D(NL)/TDUP
2050          DO 104 I=1,MKTSG 
104   XP(I)=XP(I)*FRA
       DO 105 I=1,MKTSG 
         CALL DQCOM(I,N,ITP)  
         CALL NEWCOM(N) 
105    NDP(NL,ITP)=XP(I)*100000.*H(IJ)*H(J)
         CALL NEWCOM(1) 
100    CONTINUE 
       RETURN  
       END  
           SUBROUTINE UPDATE(J,ITO,KNN,ICNT,SGN)
C      STANDARD COMMON FOR 1 PERIOD BENCHMARKS
C      SWAPS 1 PAGE OF COMMON, NDP STORED IN PAGES2-5, EACH
C      PAGE HOLDING 2 SEGMENTS
C      DIMENSIONED FOR 44 MEDIA AND 8 SEGMENTS
C
C
C      MEDIA DIMENSIONS
       DIMENSION D(990),IST(45),IDX(45),IXV(45),CIR(45),C(44),IUSEP(44)
       DIMENSION E(45),XMEDIA(44),H(45),AP(45),NDP(1023,2),NTUSO(44)
C
C      SEGMENT DIMENSIONS
       DIMENSION SEG(8),P(8),XY(8),XNU(8),XP(8),IRC(8),FWT(8)
       DIMENSION RWT(8),WXY(8),IP2(8)
C
C      MEDIA BY SEGMENT DIMENSIONS
       DIMENSION IXK(8,45),IDATA(45,8),IUP(45,8)
C
C      OTHER MISC. DIMENSIONS
       DIMENSION IMED(380),AB(4),ICRAP(2048),IFC(350)
C
C
       COMMON ICRAP,D,ALPHA,E,P,XNU,XMEDIA,AB,H,XNVAL,XOVAL,NOJ,
     1         ITTOP,MKTSG,TOTAL,NACT,NTUSO,IUSEP
C
C
C      SEGMENT EQUIVALENCES
       EQUIVALENCE (ICRAP(2),NDP,SEG),(ICRAP(19),XY),(ICRAP(36),IRC),
     1     (ICRAP(45),WXY),(ICRAP(62),FWT),(ICRAP(79),RWT),
     2     (ICRAP(96),IP2)
C
C      MEDIA EQUIVALENCES
       EQUIVALENCE (ICRAP(105),IST),(ICRAP(151),IDX),(ICRAP(197),IXV),
     1     (ICRAP(243),CIR),(ICRAP(334),C),(ICRAP(423),AP)
C
C
C      OTHER
       EQUIVALENCE (ICRAP(514),IXK),(ICRAP(875),IMED),
     1     (ICRAP(1273),IUP),(ICRAP(1634),IFC),
     2     (D,IDATA)
C
C      END STANDARD COMMON
       HUNK=100000.  
       IEND=ITTOP+2
1050   CONTINUE
       DO 8040 IJ=1,NOJ 
       IF(J-IJ)8004,8004,8005 
8004       NL=IJ*(IJ-1)/2+J  
      GO TO  8002 
8005         NL=J*(J-1)/2+IJ  
8002          DO 8040 I=1,MKTSG
         CALL DQCOM(I,N,ITP)  
         CALL NEWCOM(N) 
      IDATA(IJ,I)=NDP(NL,ITP)*ALPHA*IUSEP(J)*IUSEP(IJ)*NTUSO(J)
C      TYPE 8041,IDATA(IJ,I),XMEDIA(J),XMEDIA(IJ),NTUSO(J),NTUSO(IJ),
C    1 NDP(NL,ITP)
8041   FORMAT(I8,2X,A6,2X,A6,2I3,I8/)
8040   CONTINUE
         CALL UCOM(IT,N,ITT,ICNT,MKTSG)  
         CALL NEWCOM(N) 
       DO 100 IJ=1,NOJ  
       DO 100 I=1,MKTSG 
100    IUP(IJ,I)=SGN*  IDATA(IJ,I)+IUP(IJ,I)
8000    CONTINUE
       IF(ITTOP-1)111,111,109
109           IF(ITO-2)110,110,111 
110    ITO=ITO+ITTOP  
             GO TO  1050  
111           CALL NEWCOM(1) 
       RETURN  
       END  
          SUBROUTINE BRING(IJ,IT,ICNT)
C      STANDARD COMMON FOR 1 PERIOD BENCHMARKS
C      SWAPS 1 PAGE OF COMMON, NDP STORED IN PAGES2-5, EACH
C      PAGE HOLDING 2 SEGMENTS
C      DIMENSIONED FOR 44 MEDIA AND 8 SEGMENTS
C
C
C      MEDIA DIMENSIONS
       DIMENSION D(990),IST(45),IDX(45),IXV(45),CIR(45),C(44),IUSEP(44)
       DIMENSION E(45),XMEDIA(44),H(45),AP(45),NDP(1023,2),NTUSO(44)
C
C      SEGMENT DIMENSIONS
       DIMENSION SEG(8),P(8),XY(8),XNU(8),XP(8),IRC(8),FWT(8)
       DIMENSION RWT(8),WXY(8),IP2(8)
C
C      MEDIA BY SEGMENT DIMENSIONS
       DIMENSION IXK(8,45),IDATA(45,8),IUP(45,8)
C
C      OTHER MISC. DIMENSIONS
       DIMENSION IMED(380),AB(4),ICRAP(2048),IFC(350)
C
C
       COMMON ICRAP,D,ALPHA,E,P,XNU,XMEDIA,AB,H,XNVAL,XOVAL,NOJ,
     1         ITTOP,MKTSG,TOTAL,NACT,NTUSO,IUSEP
C
C
C      SEGMENT EQUIVALENCES
       EQUIVALENCE (ICRAP(2),NDP,SEG),(ICRAP(19),XY),(ICRAP(36),IRC),
     1     (ICRAP(45),WXY),(ICRAP(62),FWT),(ICRAP(79),RWT),
     2     (ICRAP(96),IP2)
C
C      MEDIA EQUIVALENCES
       EQUIVALENCE (ICRAP(105),IST),(ICRAP(151),IDX),(ICRAP(197),IXV),
     1     (ICRAP(243),CIR),(ICRAP(334),C),(ICRAP(423),AP)
C
C
C      OTHER
       EQUIVALENCE (ICRAP(514),IXK),(ICRAP(875),IMED),
     1     (ICRAP(1273),IUP),(ICRAP(1634),IFC),
     2     (D,IDATA)
C
C      END STANDARD COMMON
       HUNK=100000.  
         CALL UCOM(IT,N,ITT,ICNT,MKTSG)  
         CALL NEWCOM(N) 
       DO 100 L=1,MKTSG 
100    D(L)=IUP(IJ,L)/HUNK*NTUSO(IJ)
C..ALSO BRING IN DUP VALUES FOR PACKAGES AND MINIMUMS BASED ON
C.. NTUSO = NO OF UNITS OF THE MEDIUM BEING CONSIDERED
       NL=IJ*(IJ-1)/2+IJ
       DO 200 I=1,MKTSG
       CALL DQCOM(I,N,IT)
       CALL NEWCOM(N)
       IDVAL=NTUSO(IJ)*(NTUSO(IJ)-1)/2*NDP(NL,IT)
200    D(I)=D(I)+(IDVAL/HUNK)
       CALL NEWCOM(1)
       RETURN  
       END  
       SUBROUTINE UCOM(IT,N,ITT,ICNT,MKTSG)
       ICNT=ICNT+MKTSG*3
       N=1
3      RETURN
       END
       SUBROUTINE DQCOM(I,N,ITP)
       IF(I-2) 1,1,2
1      N=2
       ITP=I
       GO TO 20
2      IF(I-4) 3,3,4
3      N=3
       ITP=I-2
       GO TO 20
4      IF(I-6) 5,5,6
5      N=4
       ITP=I-4
       GO TO 20
6      N=5
       ITP=I-6
20     RETURN
       END
              SUBROUTINE REACH(IR, XY,IP2,ITUSE)
       NL=ITUSE*(ITUSE-1)/2
       QK1=(ITUSE-XY)/ITUSE
       SDUP=NL-IP2/1000.
       QP2=NL-(ITUSE-1.)*XY+SDUP
       QK2=QP2/NL
       QT=(QK1-QK2)/(QK2-QK1*QK1)
       QS=QT*QK1
       IF(ITUSE-2)4,5,10
4      RCH=XY
       GO TO 8
10       DO 11 I=3,ITUSE
11       QK2=QK2*(QS+I-1.)/(QT+I-1.)
5       RCH=1.-QK2
6      FORMAT(4F6.2,I3/)
8      IR=(1.-RCH)*10000.
       RETURN
       END      
            SUBROUTINE TOTRCH(IRC,FSE,XY,PRCH,TGROSS,FREQ)
C      STANDARD COMMON FOR 1 PERIOD BENCHMARKS
C      SWAPS 1 PAGE OF COMMON, NDP STORED IN PAGES2-5, EACH
C      PAGE HOLDING 2 SEGMENTS
C      DIMENSIONED FOR 44 MEDIA AND 8 SEGMENTS
C
C
C      MEDIA DIMENSIONS
       DIMENSION D(990),IST(45),IDX(45),IXV(45),CIR(45),C(44),IUSEP(44)
       DIMENSION E(45),XMEDIA(44),H(45),AP(45),NDP(1023,2),NTUSO(44)
C
C      SEGMENT DIMENSIONS
       DIMENSION SEG(8),P(8),XY(8),XNU(8),XP(8),IRC(8),FWT(8)
       DIMENSION RWT(8),WXY(8),IP2(8)
C
C      MEDIA BY SEGMENT DIMENSIONS
       DIMENSION IXK(8,45),IDATA(45,8),IUP(45,8)
C
C      OTHER MISC. DIMENSIONS
       DIMENSION IMED(380),AB(4),ICRAP(2048),IFC(350)
C
C
       COMMON ICRAP,D,ALPHA,E,P,XNU,XMEDIA,AB,H,XNVAL,XOVAL,NOJ,
     1         ITTOP,MKTSG,TOTAL,NACT,NTUSO,IUSEP
C
C
C      SEGMENT EQUIVALENCES
       EQUIVALENCE (ICRAP(2),NDP,SEG),(ICRAP(19),XY),(ICRAP(36),IRC),
     1     (ICRAP(45),WXY),(ICRAP(62),FWT),(ICRAP(79),RWT),
     2     (ICRAP(96),IP2)
C
C      MEDIA EQUIVALENCES
       EQUIVALENCE (ICRAP(105),IST),(ICRAP(151),IDX),(ICRAP(197),IXV),
     1     (ICRAP(243),CIR),(ICRAP(334),C),(ICRAP(423),AP)
C
C
C      OTHER
       EQUIVALENCE (ICRAP(514),IXK),(ICRAP(875),IMED),
     1     (ICRAP(1273),IUP),(ICRAP(1634),IFC),
     2     (D,IDATA)
C
C      END STANDARD COMMON
       TRCH=0.
       TGROSS=0.
       TPOP=0.
       DO 10 I=1,MKTSG
       TPOP=TPOP+(XNU(I)/FSE)
       TGROSS=TGROSS+((XY(I)*XNU(I))/FSE)
10     TRCH=TRCH+((1.-IRC(I)/10000.)*(XNU(I)/FSE))
       PRCH=(TRCH*100.)/TPOP
       FREQ=TGROSS/TRCH
       RETURN
       END
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           