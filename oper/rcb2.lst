    P R O G R A M   R C B 2 		COBOL (005001,107000)	21-MAY-73  12:44		PAGE 1
    RCB2.CBL    21-MAY-73  12:43

    0001    IDENTIFICATION DIVISION.
    0002    PROGRAM-ID. RCB2.
    0003    AUTHOR. CHRIS BUSCH.
    0004    INSTALLATION. HOUSTON.
    0005    DATE-WRITTEN. MAY 17,1973.
    0006    DATE-COMPILED. 21-MAY-73. 
    0007    SECURITY. HUSH HUSH SWEET CHARLOTTE.
    0008    REMARKS. COBOL PROG. ASSIGNMENT #2; PAYROLL SYSTEM.
    0009    ENVIRONMENT DIVISION.
    0010    CONFIGURATION SECTION.
    0011    SOURCE-COMPUTER. DECsystem-10. 
    0012    OBJECT-COMPUTER. PDP-10.
    0013    INPUT-OUTPUT SECTION.
    0014    FILE-CONTROL.
    0015           SELECT MASTER-IN ASSIGN TO DSK
    0016           RECORDING MODE IS ASCII.
    0017           SELECT MASTER-OUT ASSIGN TO DSK
    0018           RECORDING MODE IS ASCII.
    0019           SELECT TRANS ASSIGN TO DSK
    0020           RECORDING MODE IS ASCII.
    0021           SELECT PAY-REPORT ASSIGN TO DSK
    0022           RECORDING MODE IS ASCII.
    0023           SELECT CHECKS ASSIGN TO DSK
    0024           RECORDING MODE IS ASCII.
    0025    DATA DIVISION.
    0026    FILE SECTION.
    0027    FD MASTER-IN
    0028           VALUE OF IDENTIFICATION IS "MASTER   ".
    0029    01 MASTER-IN-REC.
    0030              02 SOC-SEC.
    0031                 03 SS1          PIC 9(3).
    0032                 03 SS2          PIC 99.
    0033                03  SS3          PIC 9(4).
    0034              02 EMP-NUM         PIC 9(6).
    0035              02 DEPT-NUM        PIC 9(4).
    0036              02 NO-EXEMPT       PIC 99.
    0037              02 YTD-GROSS       PIC S9(5)V99.
    0038              02 YTD-FIT         PIC S9(4)V99.
    0039              02 YTD-FICA        PIC S9(3)V99.
    0040              02 YTD-INS         PIC S9(3)V99.
    0041    FD TRANS
    0042           VALUE OF IDENTIFICATION IS "TRANS    ".
    0043    01 TRANS-REC.
    0044              02 T-SOC-SEC       PIC 9(9).
    0045                02 LAST-NAME       PIC X(15).
    0046              02 FIRST-NAME      PIC X(10).
    0047              02 HOURS           PIC S9(2)V9.
    0048              02 RATE            PIC S9(2)V999.
    0049    FD MASTER-OUT
    0050           VALUE OF IDENTIFICATION IS "NEWMAS   ".
    0051    01 MASTER-OUT-REC     PIC X(44).
    0052    FD PAY-REPORT
    0053           VALUE OF IDENTIFICATION IS "PAYREP   ".
    0054    01 REPORT-LINE         PIC X(70).
    0055    FD CHECKS
    0056           VALUE OF IDENTIFICATION IS "CHECKS   ".    P R O G R A M   R C B 2 		COBOL (005001,107000)	21-MAY-73  12:44		PAGE 1-1
    RCB2.CBL    21-MAY-73  12:43

    0057    01 CHECKLINE         PIC X(70).
    0058    WORKING-STORAGE SECTION.
    0059    77 GROSS    PIC S9(5)V99.
    0060    77 FIT-WH       PIC S9(4)V99.
    0061    77 FICA-WH      PIC S9(3)V99.
    0062    77 INS-WH       PIC S9(2)V99.
    0063    77 NET-PAY      PIC S9(5)V99.
    0064    77 CHECK-NUM    PIC S9(5).
    0065    01 CHAR-CNTL      PIC 9 VALUE 1.
    0066    01 HEADING1.
    0067      02 FILLER    PIC X(28) VALUE SPACES.
    0068      02 FILLER    PIC X(14) VALUE "PAYROLL REPORT".
    0069    01 HEADING2     PIC X(66) VALUE
    0070      " SOC-SEC          FIRST          LAST       HOURS   HOURLY   GROSS".
    0071    01 HEADING3     PIC X(65) VALUE
    0072      " NUMBER           NAME           NAME        WKD     RATE     PAY".
    0073    01 HEADING4     PIC X(54) VALUE
    0074      "          FIT-WH          FICA-WH       INS-WH     NET".
    0075    01 DETAIL1.
    0076      02 D-SOC-SEC.
    0077         03 D-SS1    PIC XXX.
    0078         03 FILLER   PIC X VALUE "-".
    0079         03 D-SS2    PIC XX.
    0080         03 FILLER   PIC X VALUE "-".
    0081         03 D-SS3    PIC XXXX.
    0082      02 FILLER      PIC XXX VALUE SPACES.
    0083      02 D-FIRST-NAME PIC X(10).
    0084      02 FILLER      PIC X(5) VALUE SPACES.
    0085      02 D-LAST-NAME PIC X(15).
    0086      02 D-HOURS     PIC ZZ.9.
    0087      02 FILLER      PIC X VALUE SPACE.
    0088      02 FILLER      PIC XXX VALUE SPACES.
    0089      02 D-RATE      PIC ZZ.999.
    0090      02 D-GROSS-PAY PIC ZZ,ZZZ.99.
    0091    01 DETAIL2.
    0092      02 FILLER      PIC X(8) VALUE SPACES.
    0093      02 D-FIT-WH    PIC Z,ZZZ.99.
    0094      02 FILLER      PIC X(10) VALUE SPACES.
    0095  
    0096     02 D-FICA-WH    PIC ZZZ.99.
    0097     02 FILLER       PIC X(8) VALUE SPACES.
    0098     02 D-INS-WH     PIC ZZ.99.
    0099     02 FILLER       PIC XXX VALUE SPACES.
    0100     02 D-NET-PAY    PIC ZZ,ZZZ.99.
    0101    01 DETAIL3.
    0102      02 FILLER          PIC X(10) VALUE "CHECK NO. ".
    0103      02 D-CHECK-NUM     PIC ZZ999.
    0104      02 FILLER          PIC X(18) VALUE SPACES.
    0105      02 FILLER          PIC X(15) VALUE "CURRENT DATE:  ".
    0106      02 CURDATE         PIC X(18) VALUE SPACES.
    0107    01 DETAIL4.
    0108      02 FILLER          PIC X(9) VALUE "EMP NO.  ".
    0109      02 D-EMP-NUM       PIC ZZZ999.
    0110      02 FILLER          PIC X(18) VALUE SPACES.
    0111      02 FILLER          PIC X(15) VALUE "PAY PERIOD:    ".
    0112      02 D-EFF-DATE      PIC X(18) VALUE SPACES.    P R O G R A M   R C B 2 		COBOL (005001,107000)	21-MAY-73  12:44		PAGE 1-2
    RCB2.CBL    21-MAY-73  12:43

    0113    01 DETAIL5.
    0114      02 FILLER          PIC X(10) VALUE "PAY TO:   ".
    0115      02 D-C-FIRST-NAME  PIC X(10).
    0116      02 FILLER          PIC X(4) VALUE SPACES.
    0117      02 D-C-LAST-NAME   PIC X(15).
    0118      02 FILLER          PIC X(15) VALUE SPACES.
    0119      02 D-C-NET-PAY     PIC $**,**9.99.
    0120    01 EOF-MASTER         PIC XXX VALUE SPACES.
    0121    01 EOF-TRANS          PIC XXX VALUE SPACES.
    0122    PROCEDURE DIVISION.
    0123    USER-FIRST-PARAGRAPH.
    0124    INITIALIZATION.
    0125       OPEN INPUT  MASTER-IN TRANS.
    0126        OPEN OUTPUT  MASTER-OUT PAY-REPORT CHECKS.
    0127        DISPLAY "ENTER BEGINNING CHECK NUMBER."
    0128        ACCEPT CHECK-NUM.
    0129        DISPLAY "ENTER CURRENT DATE".
    0130        ACCEPT CURDATE.
    0131        DISPLAY "ENTER PAY PERIOD DATE".
    0132        ACCEPT D-EFF-DATE.
    0133        PERFORM HEADING-ROUT.
    0134        SUBTRACT 1 FROM CHECK-NUM.
    0135    MAIN-LINE.
    0136        PERFORM READ-MASTER.
    0137    NEW-TRAN.
    0138        PERFORM READ-TRANS.
    0139        IF SOC-SEC NOT= T-SOC-SEC  GO TO ERROR-ROUTINE.
    0140        ADD 1 TO CHECK-NUM.
    0141        COMPUTE  GROSS = HOURS * RATE.
    0142        COMPUTE  FIT-WH = (GROSS - (NO-EXEMPT * 13)) * .15 .
    0143        COMPUTE  FICA-WH = GROSS * .04
    0144        COMPUTE  INS-WH = NO-EXEMPT * 5.40 .
    0145        IF INS-WH > 14.00  MOVE 14.00 TO INS-WH ELSE NEXT SENTENCE.
    0146        COMPUTE  NET-PAY = GROSS - FIT-WH - FICA-WH - INS-WH.
    0147        ADD FIT-WH TO YTD-FIT.
    0148        ADD FICA-WH TO YTD-FICA.
    0149        ADD INS-WH TO YTD-INS.
    0150        ADD GROSS TO YTD-GROSS.
    0151        MOVE  SS1       TO        D-SS1.
    0152        MOVE  SS2       TO        D-SS2.
    0153        MOVE  SS3       TO        D-SS3.
    0154        MOVE  FIRST-NAME TO D-FIRST-NAME.
    0155        MOVE  LAST-NAME TO D-LAST-NAME.
    0156        MOVE HOURS TO D-HOURS.
    0157        MOVE RATE TO D-RATE.
    0158        MOVE GROSS TO D-GROSS-PAY.
    0159        MOVE DETAIL1 TO REPORT-LINE.
    0160        PERFORM  REPORT-PRINT.
    0161        MOVE FIT-WH TO D-FIT-WH.
    0162        MOVE FICA-WH TO D-FICA-WH.
    0163        MOVE INS-WH TO D-INS-WH.
    0164        MOVE NET-PAY TO D-NET-PAY.
    0165        MOVE DETAIL2 TO REPORT-LINE.
    0166        MOVE  2 TO  CHAR-CNTL.
    0167        PERFORM  REPORT-PRINT.
    0168        MOVE CHECK-NUM TO D-CHECK-NUM.    P R O G R A M   R C B 2 		COBOL (005001,107000)	21-MAY-73  12:44		PAGE 1-3
    RCB2.CBL    21-MAY-73  12:43

    0169        MOVE EMP-NUM TO D-EMP-NUM.
    0170        MOVE FIRST-NAME TO D-C-FIRST-NAME.
    0171        MOVE LAST-NAME TO D-C-LAST-NAME.
    0172        MOVE NET-PAY TO D-C-NET-PAY.
    0173        MOVE DETAIL3 TO CHECKLINE.
    0174        PERFORM CHECK-PRINT.
    0175        MOVE DETAIL4 TO CHECKLINE.
    0176        MOVE  3  TO CHAR-CNTL.
    0177        PERFORM CHECK-PRINT.
    0178        MOVE DETAIL5 TO CHECKLINE.
    0179        MOVE  7  TO CHAR-CNTL.
    0180        PERFORM CHECK-PRINT.
    0181        MOVE  3  TO  CHAR-CNTL.
    0182        PERFORM CHECK-PRINT.
    0183        PERFORM WRITE-MASTER.
    0184        GO TO MAIN-LINE.
    0185    READ-MASTER.
    0186      READ MASTER-IN AT END  MOVE 999 TO EOF-MASTER,GO TO EOF-ROUT.
    0187    READ-TRANS.
    0188      READ TRANS AT END  MOVE 999 TO EOF-TRANS,GO TO EOF-ROUT.
    0189    WRITE-MASTER.
    0190      WRITE MASTER-OUT-REC  FROM MASTER-IN-REC.
    0191    EOF-ROUT.
    0192      IF EOF-MASTER = 999 AND EOF-TRANS = 999 GO TO SHUTDOWN.
    0193        IF EOF-MASTER=999 GO TO NEW-TRAN.
    0194        ELSE  GO TO MAIN-LINE.
    0195    ERROR-ROUTINE.
    0196      DISPLAY "FILES NOT REALLY IN 1 TO 1 SEQUENTIAL CORRESPONDENCE.".
    0197      DISPLAY T-SOC-SEC," NOT EQUAL TO ",SOC-SEC.
    0198      GO TO MAIN-LINE.
    0199    SHUTDOWN.
    0200      CLOSE  MASTER-IN MASTER-OUT TRANS PAY-REPORT CHECKS.
    0201      STOP RUN.
    0202    REPORT-PRINT.
    0203      WRITE REPORT-LINE BEFORE ADVANCING CHAR-CNTL  LINES.
    0204      MOVE SPACES TO REPORT-LINE.
    0205      MOVE 1  TO CHAR-CNTL.
    0206    CHECK-PRINT.
    0207      WRITE CHECKLINE  BEFORE ADVANCING CHAR-CNTL LINES.
    0208      MOVE SPACES TO CHECKLINE.
    0209      MOVE  1  TO   CHAR-CNTL.
    0210    HEADING-ROUT.
    0211      MOVE 2 TO CHAR-CNTL.
    0212      MOVE HEADING1 TO REPORT-LINE.
    0213      PERFORM REPORT-PRINT.
    0214      MOVE HEADING2 TO REPORT-LINE.
    0215      PERFORM REPORT-PRINT.
    0216      MOVE  2 TO CHAR-CNTL.
    0217      MOVE HEADING3 TO REPORT-LINE.
    0218      PERFORM REPORT-PRINT.
    0219      MOVE  2 TO CHAR-CNTL.
    0220      MOVE HEADING4 TO REPORT-LINE.
    0221      PERFORM REPORT-PRINT.    P R O G R A M   R C B 2 		COBOL (005001,107000)	21-MAY-73  12:44		PAGE W-1
    RCB2.CBL    21-MAY-73  12:43

WARNINGS:

    0141  LEAST SIGNIFICANT DIGITS TRUNCATED ON GROSS
    0142  MOST SIGNIFICANT DIGITS TRUNCATED ON FIT-WH
    0142  LEAST SIGNIFICANT DIGITS TRUNCATED ON FIT-WH
    0143  MOST SIGNIFICANT DIGITS TRUNCATED ON FICA-WH
    0143  LEAST SIGNIFICANT DIGITS TRUNCATED ON FICA-WH
    0144  MOST SIGNIFICANT DIGITS TRUNCATED ON INS-WH


NO FATAL ERRORS, 6 WARNINGS
 