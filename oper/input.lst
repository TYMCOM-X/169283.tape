    P R O G R A M   F I X 		COBOL 50A(107000)	15-MAY-73  10:42		PAGE 1
    INPUT.CBL    15-MAY-73  10:42

    0001    IDENTIFICATION DIVISION.
    0002    PROGRAM-ID.  FIX.
    0003    AUTHOR. OTTO R. HAMMER.
    0004    INSTALLATION. SYRACUSE SALES.
    0005    DATE-WRITTEN. 12-MAY-73.
    0006    REMARKS. THIS PROGRAM IS DEDICATED TO MY WIFE AND FAITHFUL CAT.
    0007    ENVIRONMENT DIVISION.
    0008    CONFIGURATION SECTION.
    0009    SOURCE-COMPUTER. DECsystem-10. 
    0010    OBJECT-COMPUTER. PDP-10.
    0011    INPUT-OUTPUT SECTION.
    0012    FILE-CONTROL.
    0013           SELECT RAWDATA ASSIGN TO DSK
    0014           RECORDING MODE IS ASCII.
    0015           SELECT FIXDATA ASSIGN TO DSK
    0016           RECORDING MODE IS ASCII.
    0017           SELECT SORTING ASSIGN TO DSK,DSK,DSK.
    0018    DATA DIVISION.
    0019    FILE SECTION.
    0020    FD RAWDATA
    0021           LABEL RECORDS ARE STANDARD
    0022           VALUE OF IDENTIFICATION IS "INPUT NPG".
    0023    01 CHARS.
    0024              05 CHR PIC X OCCURS 45 TIMES INDEXED BY ICX.
    0025    FD FIXDATA
    0026           LABEL RECORDS ARE STANDARD
    0027           VALUE OF IDENTIFICATION IS "FIXED NPG".
    0028    01 FIXREC.
    0029              05 SOCSEC           PIC X(9).
    0030              05 LNAME            PIC X(12).
    0031              05 DEPT             PIC XXX.
    0032              05 AREA             PIC 9.
    0033              05 DATE-ABST        PIC X(6).
    0034              05 DAY              PIC 9.
    0035              05 ABST-CODE        PIC XX.
    0036              05 ABST-HRS         PIC 99.
    0037    SD SORTING.
    0038    01 SORT-REC.
    0039      05 S-SOC      PIC X(9).
    0040      05 FILLER     PIC X(16).
    0041      05 S-DATE     PIC 9(6).
    0042      05 FILLER     PIC X(13).
    0043    WORKING-STORAGE SECTION.
    0044    01 LETTR.
    0045      05 L OCCURS 25 TIMES PIC X.
    0046      05 L-2 REDEFINES L PIC XX.
    0047      05 L-3 REDEFINES L PIC XXX.
    0048      05 L-25 REDEFINES L PIC X(25).
    0049      05 L-3-N REDEFINES L PIC 999.
    0050      05 L-9-N REDEFINES L PIC 9(9).
    0051    01 LETTR-ED REDEFINES LETTR.
    0052      05 L-ED PIC 9 OCCURS 25 TIMES.
    0053    01 TABLE-DAY.
    0054      05 FILLER PIC XXX VALUE "MON".
    0055      05 FILLER PIC XXX VALUE "TUE".
    0056      05 FILLER PIC XXX VALUE "WED".    P R O G R A M   F I X 		COBOL 50A(107000)	15-MAY-73  10:42		PAGE 1-1
    INPUT.CBL    15-MAY-73  10:42

    0057      05 FILLER PIC XXX VALUE "THR".
    0058      05 FILLER PIC XXX VALUE "FRI".
    0059    01 DAY-TABLE REDEFINES TABLE-DAY.
    0060      05 DAY-WORD PIC XXX OCCURS 5 TIMES INDEXED BY IDX.
    0061    01 TABLE-AREA.
    0062      05 FILLER PIC X(25) VALUE "MANUFACTURING".
    0063      05 FILLER PIC X(25) VALUE "MANUFACTURING ENGINEERING".
    0064      05 FILLER PIC X(25) VALUE "PRODUCTION CONTROL".
    0065      05 FILLER PIC X(25) VALUE "QUALITY CONTROL".
    0066      05 FILLER PIC X(25) VALUE "END".
    0067    01 AREA-TABLE REDEFINES TABLE-AREA.
    0068      05 AREA-WORD PIC X(25) OCCURS 5 TIMES INDEXED BY IAX.
    0069    01 TABLE-CODE.
    0070      05 FILLER PIC XX VALUE "EX".
    0071      05 FILLER PIC XX VALUE "LT".
    0072      05 FILLER PIC XX VALUE "LE".
    0073      05 FILLER PIC XX VALUE "NR".
    0074      05 FILLER PIC XX VALUE "DL".
    0075      05 FILLER PIC XX VALUE "SK".
    0076      05 FILLER PIC XX VALUE "IP".
    0077      05 FILLER PIC XX VALUE "IO".
    0078      05 FILLER PIC XX VALUE "MP".
    0079      05 FILLER PIC XX VALUE "DC".
    0080      05 FILLER PIC XX VALUE "IF".
    0081      05 FILLER PIC XX VALUE "TR".
    0082      05 FILLER PIC XX VALUE "PB".
    0083      05 FILLER PIC XX VALUE "PA".
    0084    01 CODE-TABLE REDEFINES TABLE-CODE.
    0085      05 CODE-WORD PIC XX OCCURS 14 TIMES INDEXED BY IRX.
    0086    77 I    PIC 99, COMP.
    0087    77 IOLD PIC 99, COMP.
    0088    77 IFIN PIC 99, COMP.
    0089    PROCEDURE DIVISION.
    0090    HOUSE-KEEP.
    0091           OPEN INPUT RAWDATA.
    0092           OPEN OUTPUT FIXDATA.
    0093    GET-DATE-DAY.
    0094           READ RAWDATA AT END GO TO END-SORT.
    0095           PERFORM LOOK-SPACE.
    0096           PERFORM MC VARYING I FROM 1 BY 1 UNTIL I>6.
    0097           MOVE LETTR TO DATE-ABST.
    0098           IF DATE-ABST IS NOT NUMERIC GO TO FATAL-DATE.
    0099           SET ICX UP BY 1.
    0100           PERFORM MC VARYING I FROM 1 BY 1 UNTIL I>3.
    0101           SET IDX TO 1.
    0102           SEARCH DAY-WORD AT END GO TO FATAL-DAY
    0103             WHEN DAY-WORD (IDX) EQUALS L-3 MOVE IDX TO DAY.
    0104    GET-AREA.
    0105           READ RAWDATA AT END GO TO END-SORT.
    0106           PERFORM LOOK-SPACE.
    0107           PERFORM MC VARYING I FROM 1 BY 1 UNTIL I>25.
    0108           SET IAX TO 1.
    0109           SEARCH AREA-WORD AT END GO TO FATAL-AREA
    0110             WHEN AREA-WORD (IAX) EQUALS L-25 MOVE IAX TO AREA.
    0111           IF IAX=5 GO TO END-SORT.
    0112    GET-DATA.    P R O G R A M   F I X 		COBOL 50A(107000)	15-MAY-73  10:42		PAGE 1-2
    INPUT.CBL    15-MAY-73  10:42

    0113           READ RAWDATA AT END GO TO END-SORT.
    0114           PERFORM LOOK-SPACE.
    0115    GET-DEPT.
    0116           PERFORM MC VARYING I FROM 1 BY 1 UNTIL I>3.
    0117           IF LETTR="0" GO TO GET-AREA.
    0118           IF L-3-N IS NUMERIC MOVE LETTR TO DEPT ELSE GO TO BAD-DEPT.
    0119    GET-NAME.
    0120           SET ICX UP BY 1.
    0121           MOVE ICX TO IOLD.
    0122           PERFORM LOOK-COMMA.
    0123           PERFORM MC VARYING I FROM 1 BY 1 UNTIL I>IFIN.
    0124           MOVE LETTR TO LNAME.
    0125    GET-SOCSEC.
    0126           SET ICX UP BY 1.
    0127           IF CHR (ICX + 3) NOT EQUAL "-" GO TO BAD-SOC.
    0128           IF CHR (ICX + 6) NOT EQUAL "-" GO TO BAD-SOC.
    0129           PERFORM MC VARYING I FROM 1 BY 1 UNTIL I>3.
    0130           SET ICX UP BY 1.
    0131           PERFORM MC VARYING I FROM 4 BY 1 UNTIL I>5.
    0132           SET ICX UP BY 1.
    0133           PERFORM MC VARYING I FROM 6 BY 1 UNTIL I>9.
    0134           IF L-9-N IS NUMERIC MOVE LETTR TO SOCSEC ELSE GO TO BAD-SOC.
    0135    GET-CODE.
    0136           SET ICX UP BY 1.
    0137           PERFORM MC VARYING I FROM 1 BY 1 UNTIL I>2
    0138           SET IRX TO 1.
    0139           SEARCH CODE-WORD AT END GO TO BAD-CODE
    0140             WHEN CODE-WORD (IRX) EQUALS L-2 MOVE LETTR TO ABST-CODE.
    0141    GET-HRS.
    0142           IF CHR (ICX + 1)="." MOVE "0" TO CHR (ICX) ELSE SET ICX UP BY 1.
    0143    C1.
    0144           PERFORM MC VARYING I FROM 1 BY 1 UNTIL I>3.
    0145           EXAMINE LETTR REPLACING SPACES BY ZEROES.
    0146           MOVE L (1) TO L (2).
    0147           MOVE L-3-N TO ABST-HRS.
    0148    CHECK.
    0149           IF ABST-HRS < 1 OR > 99 GO TO BAD-HRS.
    0150    WRITE-FIXED.
    0151           WRITE FIXREC.
    0152           GO TO GET-DATA.
    0153    END-SORT.
    0154           CLOSE FIXDATA.
    0155           DISPLAY "START SORTING".
    0156           SORT SORTING ON ASCENDING KEY S-SOC,S-DATE
    0157             USING FIXDATA GIVING FIXDATA.
    0158           STOP RUN.
    0159    LOOK-SPACE.
    0160           SET ICX TO 1.
    0161           SEARCH CHR AT END GO TO BAD-LINE-NO
    0162             WHEN CHR (ICX) EQUALS SPACE SET ICX UP BY 1.
    0163    MC.
    0164           IF I=1 MOVE SPACES TO LETTR.
    0165           MOVE CHR (ICX) TO L (I).
    0166           SET ICX UP BY 1.
    0167    LOOK-COMMA.
    0168           SEARCH CHR AT END GO TO BAD-DATA    P R O G R A M   F I X 		COBOL 50A(107000)	15-MAY-73  10:42		PAGE 1-3
    INPUT.CBL    15-MAY-73  10:42

    0169             WHEN CHR (ICX) EQUALS "," SET ICX UP BY 1.
    0170           COMPUTE IFIN = ICX - IOLD - 1.
    0171           SET ICX TO IOLD.
    0172    BAD-LINE-NO.
    0173           DISPLAY "BAD LINE NUMBER".
    0174           DISPLAY CHARS.
    0175           IF DATE-ABST EQUALS SPACES GO TO FATAL-DATE ELSE GO TO GET-DATA.
    0176    FATAL-DATE.
    0177           DISPLAY "BAD DATE".
    0178           DISPLAY CHARS.
    0179           STOP RUN.
    0180    FATAL-DAY.
    0181           DISPLAY "BAD DAY OF THE WEEK".
    0182           DISPLAY CHARS.
    0183           STOP RUN.
    0184    FATAL-AREA.
    0185           DISPLAY "BAD WORK AREA".
    0186           DISPLAY CHARS.
    0187           STOP RUN.
    0188    BAD-DEPT.
    0189           DISPLAY "BAD DEPARTMENT".
    0190           DISPLAY CHARS.
    0191           GO TO GET-DATA.
    0192    BAD-SOC.
    0193           DISPLAY "BAD SOCIAL SECURITY NUMBER".
    0194           DISPLAY CHARS.
    0195           GO TO GET-DATA.
    0196    BAD-DATA.
    0197           DISPLAY "BAD DATA".
    0198           DISPLAY CHARS.
    0199           GO TO GET-DATA.
    0200    BAD-HRS.
    0201           DISPLAY "BAD HOURS WORKED".
    0202           DISPLAY CHARS.
    0203           GO TO GET-DATA.
    0204    BAD-CODE.
    0205           DISPLAY "BAD REASON CODE".
    0206           DISPLAY CHARS
    0207           GO TO GET-DATA.    P R O G R A M   F I X 		COBOL 50A(107000)	15-MAY-73  10:42		PAGE W-1
    INPUT.CBL    15-MAY-73  10:42

WARNINGS:

    0046  REDEFINITION IS NOT THE SAME SIZE AS THE REDEFINED ITEM
    0047  REDEFINITION IS NOT THE SAME SIZE AS THE REDEFINED ITEM
    0049  REDEFINITION IS NOT THE SAME SIZE AS THE REDEFINED ITEM
    0050  REDEFINITION IS NOT THE SAME SIZE AS THE REDEFINED ITEM
    0097  RIGHT-MOST TRUNCATION ON DATE-ABST
    0103  MOST SIGNIFICANT DIGITS TRUNCATED ON DAY
    0110  MOST SIGNIFICANT DIGITS TRUNCATED ON AREA
    0118  RIGHT-MOST TRUNCATION ON DEPT
    0121  MOST SIGNIFICANT DIGITS TRUNCATED ON IOLD
    0124  RIGHT-MOST TRUNCATION ON LNAME
    0134  RIGHT-MOST TRUNCATION ON SOCSEC
    0140  RIGHT-MOST TRUNCATION ON ABST-CODE
    0147  MOST SIGNIFICANT DIGITS TRUNCATED ON ABST-HRS
    0170  MOST SIGNIFICANT DIGITS TRUNCATED ON IFIN


NO FATAL ERRORS, 14 WARNINGS
