90 N$=""
100 PRINT "DATAFILE";
110 INPUT K$
120 FILE #1,K$
130 DIM A(110,5)
140 DIM B(100,20)
150 DIM C(121)
160 DIM P(100,5)
170 DIM K(2,25)
180 DIM H(2,55)
190 DIM T(200,1)
200 DIM M(200,10)
210 DIM N (200,5)
220 MAT M=ZER
230 MAT P= ZER
240 MAT T = ZER
250 MAT N= ZER
260 GOTO 3380
270 REM "PERIODS";
280 D$="NO"
290 READ #1, Q1
300 REM "ITC"
310 READ #1, I5
320 REM "TAX RATE";
330 READ #1, Z1
340 REM "LEVEL DEBT";
350 READ #1, A$
360 IF A$="YES" THEN 530
370 PRINT "D=DATA, I=INPUT";
380 INPUT B$
390 IF B$="D" GOTO 450
400 REM: INPUT = FLAT INT, QTRS (E.G. 10000,40)
410 FOR Y=B2 TO B3
420 M(Y,3)=I6
430 NEXT Y
440 GOTO 530
450 REM; USING DATA LINE;FOR Y=1 TO Q1;READ M(Y,3);NEXT Y, USE WEAVE WITH QTRLY INTEREST DATA
460 FOR Y = 1 TO Q1
470 READ M(Y,3)
480 DATA 0,0,0
490 DATA 0,0,0
500 DATA 0,0,0
510 NEXT Y
520 IF M(1,3) > 1 GOTO 720
530 REM "AMT,RATE,YRS";
540 READ #1, B1,R,S
550 B7=B1
560 N=4
570 REM E=INT(N)*INT(S)
580 E=N*S
590 P=(B1*R/N)/(1-(1+(R/N)/100)^(-E))+.5
600 P=INT(P+.5)/100
610 B6=P
620 R=R*100
630 I7=1
640 IF A$="YES" GOTO 660
650 I7=B3+1
660 FOR Y=I7 TO E+B3
670 I1=INT((B1*R)/(N*100)+.5)/100
680 P1=P-I1
690 B1=B1-P1
700 M(Y,3)=I1
710 NEXT Y
720 C=0
730 FOR X=1 TO Q1/4
740 H(2,X)=H(2,X)/4
750 E1=E1/4
760 FOR Y=1 TO 4
770 C=C+1
780 M(C,2)=H(2,X)
790 S4=M(C,2)+S4
800 NEXT Y
810 NEXT X
820 B1=0
830 REM "RENT DATA";
840 READ #1, B1,B2,B3
850 FOR Y=B2 TO B3
860 M(Y,1)=B1
870 B5=M(1,1)
880 NEXT Y
890 IF B3=Q1 GOTO 920
900 READ #1, B1,B2,B3
910 GOTO 850
920 REM "D/S";
930 READ #1, D1,D2,D3
940 FOR Y= D2TO D3
950 M(Y,4)=D1
960 D6=M(1,4)
970 NEXT Y
980 IF D3=Q1 GOTO 1010
990 READ #1, D1,D2,D3
1000 GOTO 940
1010 REM "EXP";
1020 READ #1, E
1030 FOR Y= 1 TO Q1
1040 M(Y,5)=E
1050 NEXT Y
1060 REM SF RATE IS QUARTERLY DECIMAL (R3) WHICH DISCOUNTS NEG & POS A/T FLOWS (EG .0125=5% SF RATE)
1070 REM "ANNUAL SF RATE";
1080 READ #1, R3
1090 REM "FEE,FRONT(F) OR AMORTZD(A)";
1100 READ #1, H6,F$
1110 IF F$="F"  GOTO 1140
1120 H7=H6/Q1
1130 H6=0
1140 REM"INITIAL AMOUNT";
1150 READ #1, N(1,4)
1160 REM"NET RESID";
1170 READ #1, K1
1180 PRINT "PRINT,ANNUALLY";
1190 INPUT W$,M$
1200 REM "YRLY";
1210 PRINT "CF FILENAME";
1220 INPUT F$
1230 FILE #3,F$
1235 SCRATCH #3
1240 PRINT "L=LONG S=SHORT";
1250 INPUT T$
1260 IF T$="S" GOTO 1370
1270 PRINT "EQUIPMENT COST ";X1;"            DEPRECIABLE LIFE ";X2
1280 PRINT "SALVAGE VALUE ";X3;"             DEPRECIATION METHOD";X9
1290 PRINT "TERM OF LEASE(QTRS) ";Q1;"       ITC ";I5
1300 PRINT "FIT RATE ";Z1;"                  LEVEL DEBT ";A$
1310 PRINT "AMT OF DEBT "; B7;"              RATE "; R/100;"    YEARS ";S
1320 PRINT "QTRLY RENT ";B5;"                QTRLY DEBT SERVICE ";D6
1330 PRINT "QTRLY EXPENSES ";E;"             ANNUAL SINKING FUND RATE ";R3
1340 PRINT "FEE ";H6,H7;"                       INITIAL INVESTMENT ";N(1,4)
1350 PRINT "EST RESIDUAL ";K1
1360 GOTO 1380
1370 PRINT X1;X2;X3;X9;Q1;I5;Z1;A$;B7;R/100;S;B5;B2;B3;D6;D2;D3;E;R3;H6;H7;N(1,4);K1;W$;M$
1380 IF W$="NO" THEN 1490
1400 PRINT USING 1410,N$
1410 :  PRD    RENTAL  DEPRECIA-   INTEREST  INTEREST &   OTHER    INTERNAL   TAX LOSS   TAX SAVING AFTER TAX  CUMULATIVE '
1420 PRINT USING 1430,N$
1430 :         INCOME  TION PLUS   ON AMORT  PRINCIPAL   EXPENSES  CASH FLOW  OR GAIN    OR PAYMENT CASH FLOW  AFTER TAX '
1440 PRINT USING 1450 , Z1*100
1450 :                 FT END FEES  DEBT     ON DEBT               BEFORE TAX            @ ##.#%               CASH FLOW
1460 PRINT
1470 PRINT
1480 V1=V2=V3=V4=V5=V6=V7=V8=V9=0
1490 L1=L2=L3=L4=L5=L6=L7=L8=L9=0
1500 IF X3<>0 GOTO 1520
1510 X3=X1-S4
1520 FOR Y=1 TO Q1+1
1530 M(Q1+1,1)=K1
1540 L9=L9+1
1550 M(Y,2)=M(Y,2)+H7
1560 M(1,2)=M(1,2)+H6
1570 M(Q1+1,2)=X3
1580 M(Y,6)=M(Y,1)-M(Y,4)-M(Y,5)
1590 T7=M(Y,6)
1600 M(Q1+1,6)=K1
1610 M(Y,7)=M(Y,1)-M(Y,2)-M(Y,3)-M(Y,5)-(T7-M(Y,6))
1620 M(Q1+1,7)=K1-X3
1630 M(Y,8)=-M(Y,7)*Z1
1640 M(Y,9)=M(Y,8)+M(Y,6)
1650 M(1,9)=M(1,9)+I5
1660 REM M(1,9)=M(1,9)+I5/4
1670 REM M(2,9)=M(2,9)+I5/4
1680 REM M(3,9)=M(3,9)+I5/4
1690 REM M(4,9)=M(4,9)+I5/4
1700 M(Q1+1,9)=K1-(K1-X3)*Z1
1710 L1=L1+M(Y,2)
1720 V1=V1+M(Y,1)
1730 V2=V2+M(Y,2)
1740 V3=V3+M(Y,3)
1750 V4=V4+M(Y,4)
1760 L2=L2+M(Y,3)
1770 V5=V5+M(Y,5)
1780 V6=V6+M(Y,6)
1790 V7=V7+M(Y,7)
1800 V8=V8+M(Y,8)
1810 L3=L3+M(Y,6)
1820 V9=V9+M(Y,9)
1830 L4=L4+M(Y,7)
1840 L5=L5+M(Y,8)
1850 L6=L6+M(Y,9)
1860 T5=T5+M(Y,9)
1870 M(Y,10)=M(Y,2)+M(Y,3)+M(Y,5)
1880 IF W$="NO" THEN 2000
1890 IF M$="NO" THEN 1990
1900 A5=4
1910 IF L9<>4 THEN 2000
1920 IF M(Y,1)<>0 GOTO 1950
1930 PRINT USING 1960 ,Y/4,M(Q1-1,1)*3,L1,L2,M(Q1-1,4)*3,M(Y,5)*4,L3,L4,L5,L6,T5
1940 IF M(Y,1)=0 GOTO 1970
1950 PRINT USING 1960 , Y/4,M(Y,1)*A5,L1,L2,M(Y,4)*4,M(Y,5)*4,L3,L4,L5,L6,T5
1960: ### ######### ######### ######### ########## ########## ########## ########## ########## ########## ########### ###########
1970 L1=L2=L3=L4=L5=L6=L7=L8=L9=0
1980 GOTO 2000
1990 PRINT USING 1960 ,Y,M(Y,1),M(Y,2),M(Y,3),M(Y,4),M(Y,5),M(Y,6),M(Y,7),M(Y,8),M(Y,9),T5
2000 T(Y,1)=M(Y,9)
2010 WRITE #3, T(Y,1)
2020 NEXT Y

2040 K2=(K1-X3)*Z1
2050 K3=K1-((K1-X3)*Z1)
2060 IF M$="NO" THEN 2080
2070 PRINT USING 1960 , (Q1/4)+1,K1,X3,0,0,0,K1,K1-X3,-K2,K3,T5
2080 PRINT
2090 PRINT USING 2100 ,V1,V2,V3,V4,V5,V6,V7,V8,V9,T5
2100: TOT ######### ######### ######### ########## ########## ########## ########## ########## ########## ########### ###########
2110 PRINT
2120 B1=Q1+1
2130 FOR Y=2 TO B1+1
2140 N(Y,1)=T(Y-1,1)
2150 NEXT Y
2160 REM SINKING FUND ROUTINE
2165 MAT A = ZER
2170 FOR Y= 1 TO B1
2180 A(Y,1)=T(Y,1)
2190 NEXT Y
2200 DIM E(110)
2210 IF D$="YES" THEN 2230
2220 GOTO 2280
2230 PRINT "SF RATE,*P/Y,INVESTMENT,RESIDUAL";
2240 INPUT R,P,C,Z2
2250 Z3=Z2-((Z2-X3)*Z1)
2260 A(B1,1)=Z3
2270 GOTO 2310
2280 R=R3
2290 P=4
2300 C=N(1,4)
2310 N1=Y1=N2=N3=T=N5=0
2320 R5=R
2330 REM: ASSORT NEGATIVE FROM POSITIVE
2340 T=0
2350 FOR Y=1 TO B1
2360 T =T+1
2370 IF A(Y,1)<0 GO TO 2390
2380 NEXT Y
2390 FOR Y = T TO B1
2400 A (Y,2) = A (Y,1)
2410 T1=T1+1
2420 C(Y)=0
2430 NEXT Y
2440 FOR Y =B1 TO T STEP -1
2450 C(Y)=C(Y)+A(Y,2)/((1+R/P)^Y)
2460 N5=N5+C(Y)
2470 NEXT Y
2480 FOR Y = T-1 TO 1 STEP -1
2490 N2=N1+N5
2500 N1 = N1+A(Y,1)/((1+R/P)^Y)
2510 IF N1+N5 <1 GOTO 2550
2520 Y1=Y
2530 N3=ABS(N2)*((1+R/P)^Y)
2540 GOTO 2560
2550 NEXT Y
2560 FOR Y=1 TOY1
2570 A(Y,4)=A(Y,1)
2580 NEXT Y
2590 A(Y1,4)=A(Y,1)-N3
2600 C1=P
2610 FOR I=1 TO B1
2620 DIM Z(121)
2630 Z(I)=A(I,4)
2640 NEXT I
2650 REM THIS SUBROUTINE DOES THE LEASE RATE OF RETURN CALCULATION
2660 R=Z=0
2670 J=0
2680 Z=0
2690 FOR J=1 TO 6
2700 Z=.1^J
2710 R =R+Z
2720 Y=0
2730 FOR I=1 TO B1
2740 Y=Y+Z(I)/((1+R/C1)^I)
2750 NEXT I
2760 IF Y-C>0 THEN 2710
2770 R=R-Z
2780 NEXT J
2790 PRINT "AT RESIDUAL  ";A(B1,1),Z3
2800 PRINT "THE IRR IS ";R*100;"% AND THE BAL IS ";C-Y;" USING A ";R5;"% SF RATE"
2810 PRINT "THE EQUIVALENT PRE-TAX RETURN IS ";R*100/(1-Z1);"%"
2820 PRINT "AGAIN ";
2830 INPUT D$
2840 IF D$= "YES" GOTO 2160
2850 :     ###     ########.##  ########.##  ########.##  ########.##  #######.##
2860 N(1,4)=-C
2865 N(B1+1,1)=A(B1,1)
2870 FOR Y=2 TO B1+1
2880 IF N(Y-1,4)<0 GOTO2920
2890 N(Y,5)=N(Y-1,4)*(R5/4)
2900 N(Y,4)=N(Y-1,4)+N(Y,5)+N(Y,1)
2910 GOTO 3040
2920 IF N(Y,1)<=0 GOTO 3010
2930 N(Y,2)=ABS(N(Y-1,4))*(R/4)
2940 N(B1+1,2)=ABS(N(B1,4))*(R5/4)
2950 N(Y,3)=N(Y,1)-N(Y,2)
2960 N(Y,4)=N(Y-1,4)+N(Y,3)
2970 IF N(Y,2)>N(Y,1) THEN 2990
2980 GOTO 3040
2990 N(Y,3)=N(Y,1)-N(Y,2)
3000 GOTO 3030
3010 N(Y,2)=N(Y-1,4)*(R5/4)
3020 N(Y,3)=N(Y,1)+N(Y,2)
3030 N(Y,4)=N(Y-1,4)+N(Y,3)
3040 NEXT Y
3050 PRINT "PRINT";
3060 INPUT R$
3070 IF R$="NO" THEN 3360
3080 PRINT"1=QTRLY,2=YRLY";
3090 INPUT U$
3100 R6=R*100
3110 PRINT USING 3130,N$
3120 R7=R5/4
3130 :    PERIOD       CASH        INTEREST     PRINCIPAL    BALANCE      EARNINGS '
3140 PRINT USING 3150 ,R6,R7
3150 :              AVAILABLE      AT###.###%    PAYMENT    REMAINING     AT###.###%
3160 PRINT
3170 PRINT
3180 FOR Y=1 TO B1+1
3190 IF Y=1 GOTO 3270
3200 U=U+1
3210 U1=U1+N(Y,1)
3220 U2=U2+N(Y,2)
3230 U3=U3+N(Y,3)
3240 U4=N(Y,4)
3250 U5=U5+N(Y,5)
3260 IF U$="2" GOTO 3300
3270 PRINT USING 2850 ,F1,N(Y,1),N(Y,2),N(Y,3),N(Y,4),N(Y,5)
3280 F1=F1+1
3290 GOTO 3350
3300 IF Y=B1+1 GOTO 3320
3310 IF U<>4 GOTO 3350
3320 F2=F2+1
3330 PRINT USING 2850 ,F2,U1,U2,U3,U4,U5
3340 U=U1=U2=U3=U4=U5=0
3350 NEXT Y
3360 GOTO 4320
3370 REM DEP ROUTINE+-DDB;2 YRS    SYD REMAINDER
3380 REM "DEPR AMT, YRS";
3390 READ #1, X1,X2
3400 REM "SALVAGE VALUE,$,DEP METHOD(1=ADR,2=GL,3=SL,4=150%,5=SYD,6=DATA)";
3410 READ #1, X3,X9
3420 ON X9, GOTO 3430,3650,3850,3930,4090,4250
3430 E=0
3440 P1=2*(1/X2)
3450 H(1,1)=X1
3460 FOR Y=1 TO 2
3470 H(2,Y)=H(1,Y)*P1
3480 H(1,Y+1)=H(1,Y)-H(2,Y)
3490 NEXT Y
3500 Q=X2-2
3510 FOR Y=1 TO Q
3520 H=H+Y
3530 NEXT Y
3540 FOR I=Q+1 TO 1 STEP -1
3550 E=E+1
3560 I1=I-1
3570 K=(I1/H)*H(1,3)
3580 K(1,1)=H(1,3)
3590 IF K(1,E)-K<= X3 THEN 3630
3600 K(1,E+1)=K(1,E)-K
3610 H(2,E+2)=K
3620 NEXT I
3630 H(2,E+2)=K(1,E)-X3
3640 GOTO 270
3650 REM GUIDELINE
3660 E = 0
3670 P1=2*(1/X2)
3680 H(1,1)=X1
3690 FOR Y = 1 TO 3
3700 H(2,Y)=H(1,Y)*P1
3710 H(1,Y+1)=H(1,Y)-H(2,Y)
3720 NEXT Y
3730 Q=X2-3
3740 FOR Y = 1 TO Q
3750 H = H+Y
3760 NEXT Y
3770 H(1,4)=H(1,4)-X3
3780 FOR I = Q+1 TO 1 STEP -1
3790 E=E+1
3800 I1=I-1
3810 K=(I1/H)*H(1,4)
3820 H(2,E+3)=K
3830 NEXT I
3840 GOTO 270
3850 REM S/L DEP
3860 E=0
3870 Q=X2
3880 FOR Y= 1 TO Q
3890 H(2,Y)=X1/X2
3900 NEXT Y
3910 H(2,Q+1)=X3
3920 GOTO 270
3930 REM 150% DB,SWITCH YEAR S/B X4
3940 P1=1.5*(1/X2)
3950 H(1,1)=X1
3960 PRINT "SWITCH YEAR";
3970 INPUT X4
3980 FOR Y=1 TO X4
3990 H(2,Y)=H(1,Y)*P1
4000 H(1,Y+1)=H(1,Y)-H(2,Y)
4010 NEXT Y
4020 X5=K=0
4030 X5=X2-X4
4040 K=H(1,Y+1)
4050 FOR Y=X4+1 TO X2
4060 H(2,Y)=K/X5
4070 NEXT Y
4080 GOTO 270
4090 REM SYD
4100 H(1,1)=X1
4110 FOR Y=1 TO X2
4120 H=H+Y
4130 NEXT Y
4140 FOR I=X2+1 TO 1 STEP -1
4150 E=E+1
4160 I1=I-1
4170 K=(I1/H)*H(1,1)
4180 K(1,1)=H(1,1)
4190 IF K(1,E)-K<=X3 THEN 4230
4200 K(1,E+1)=K(1,E)-K
4210 H(2,E)=K
4220 NEXT I
4230 H(2,E+2)=K(1,E)-X3
4240 GO TO 270
4250 REM DATA
4260 DATA 165289,141322,126446,111570,96694,81818,64256,27066,0,0,0,0,0,0,0
4270 FOR Y = 1 TO X2
4280 READ H(2,Y)
4290 NEXT Y
4300 GOTO 270
4310 REM EARNINGS
4320 PRINT "UNEARNED INC";
4330 INPUT E(1)
4340 PRINT "QTLY CF EARNGS RATE,CDS(Y OR N)";
4350 INPUT E9,D$
4355 PRINT "ITC;1=PASS THRU, 2=AMORTIZED";
4356 INPUT E$
4360 IF E(1)=0 THEN 4970
4365 IF E$="1" GOTO 4390
4366 E(6) = I5
4367 GOTO 4390
4390 FOR P= 1 TO 6 STEP 5
4400 H=0
4410 S=Q1/4
4420 FOR I=1 TO S
4430 H=H+I
4440 NEXT I
4450 C=0
4460 D=1
4470 FOR Y=S+1 TO 1 STEP -1
4480 C=C+1
4490 I1=Y-1
4500 B(C,P)=(I1/H)*E(P)
4510 NEXT Y
4520 D=6
4530 NEXT P
4540 A1=A2=A3=A4=A5=0
4550 FOR Y=1 TO Q1
4560 A1=A1+1
4570 A2=A2+M(Y,3)
4580 A3=A3+M(Y,5)
4590 A4=A4+M(Y,9)
4600 B(Y,10)=A4
4610 IF A1<>4 GOTO 4660
4620 B(Y/4,2)=A2
4630 B(Y/4,3)=A3
4640 B(Y/4,9)=A4
4650 A1=A2=A3=0
4660 NEXT Y
4670 C1=C2=0
4680 T6=0
4690 FOR Y=1 TO Q1+1
4700 C1=C1+1
4710 T6=T6+T(Y,1)
4720 B(Y,10)=T6
4730 B(Y,11)=B(Y,10)+B(Y,12)
4740 B(Y+1,12)=B(Y,11)*E9
4750 C2=C2+B(Y,12)
4760 IF C1<>4 THEN 4790
4770 B(Y/4,7)=C2
4780 C1=C2=0
4790 NEXT Y
4800 PRINT
4805 IF E$<>"1" GOTO 4810
4807 B(1,6)=I5
4810 PRINT USING 4820,N$
4820 :   YR     INCOME    CD INTEREST     INTEREST    INTEREST   LOSS/GAIN    TAXES       ITC       C.F. EARN   NET EARNINGS '
4830 REM DATA LINE FOR CD INT EG 3500,3500,3500,3500,2625
4840 DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
4850 PRINT
4860 FOR Y=1 TO S
4870 IF D$="N" GOTO 4890
4880 READ B(Y,14)
4890 B(Y,4)=B(Y,1)+B(Y,14)-B(Y,2)-B(Y,3)
4900 B(Y,5)=B(Y,4)*.5
4910 B(Y,8)=B(Y,5)+B(Y,6)+B(Y,7)
4920 PRINT USING 4930 ,Y,B(Y,1),B(Y,14),B(Y,2),B(Y,3),B(Y,4),B(Y,5),B(Y,6),B(Y,7),B(Y,8)
4930 :  ###  #######.##  #######.##  #######.##  #######.##  #######.##  #######.## #######.##  #######.## #######.##
4940 NEXT Y
4950 GOTO 4320
4960 GOTO 4970
4970 END
    