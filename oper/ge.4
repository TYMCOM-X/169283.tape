1 * TEXT OUTPUT BEGINS IN LINE 16, VERSION IN LINE 20E TRANSLATOR ONLY IF"
2 STRING QSTR(10)(100),LNUM(15),SNUM(15),STMTHD(11)
3 INTEGER CFLG,NST(32),IFF(100),COMNT(32)
4 COMMON QSTR,IXQ,CFLG,LNUM
5 STRING FNI(40),FNO(40),FND(40)
5.1 STRING STEMP(300)
6 IFFX=0
6.1 FLNUM=999.
7 897 FORMAT(/S,&)
8 898 FORMAT(S)
9 DATA NST(5),NST(11),NST(13),NST(14),NST(15),NST(16),NST(18)/7*1/
9.1 DATA NST(19),NST(20),NST(21),NST(22),NST(23),NST(24),NST(25)/7*1/
9.2 DATA NST(26),NST(27),NST(28),NST(29),NST(30)/5*1/
10 DATA NST(1),NST(2),NST(3),NST(4),NST(6),NST(7),NST(8)/2,3,4,5,6,7,8/
10.1 DATA NST(9),NST(10),NST(12),NST(17),NST(31),NST(32)/9,10,11,12,13,14/
11 
12 
13 DATA COMNT(5),COMNT(22),COMNT(23)/3*1/
13.1 DATA COMNT(11),COMNT(13),COMNT(18),COMNT(19),COMNT(20),COMNT(21)/6*2/
14 DATA COMNT(14),COMNT(15),COMNT(16),COMNT(17)/4*0/
15 DATA COMNT(24),COMNT(25),COMNT(26),COMNT(27),COMNT(28),COMNT(29),COMNT(30)/7*3/
16 STRING INPSTR(300),CRSTR(300),NXSTR(100),RSTR(300),TSTR(12)
17 ** ON INTERRUPT GO TO 910
18 910 CONTINUE
19 * ON INTERRUPT GO TO 900
20 * CLOSE (*)
21 GO TO 930
22 900 CLOSE (-1)
23 930 STEMP='INPUT FILE: '
23.1 WRITE(1,897) STEMP
24 READ(0,898,ERR=900,END=900)FNI
25 CLOSE (2)
25.1 OPEN(2,FNI,INPUT,ERR=900)
26 GO TO 931
27 901 CLOSE (-1)
28 931 STEMP='OUTPUT FILE: '
28.1 WRITE(1,897) STEMP
29 READ(0,898,ERR=901,END=901)FNO
30 CLOSE (3)
30.1 OPEN (3,FNO,OUTPUT,ERR=901)
31 CLOSE (3)
31.1 OPEN(3,"GETYM.TMP",OUTPUT,ERR=902)
32 GO TO 933
33 903 CLOSE (-1)
34 933 STEMP='DIAGNOSTIC FILE (OR TEL): '
34.1 WRITE(1,897) STEMP
35 READ(0,898,ERR=903,END=903)FND
36 CLOSE (4)
36.1 OPEN(4,FND,OUTPUT,ERR=903)
37 ** ON INTERRUPT GO TO 906
38 READ(2,898)INPSTR
39 5 I=NUMPUL(INPSTR)
39.1 IORG=1
39.2 IXIF=1
40 LNUM=LEFT(INPSTR,I)+' '
40.1 INPSTR=SUBSTR(INPSTR,I+1)
41 
42 I=NUMPUL(INPSTR)
43 IF (I.NE.0) GO TO 801
43.1 SNUM=''
43.2 GO TO 10
44 801 SNUM=LEFT(INPSTR,I)+" "
44.1 INPSTR=SUBSTR(INPSTR,I+1)
45 
46 10 READ(2,898,END=999)NXSTR
47 I=NUMPUL(NXSTR)+1
48 17 IF(SUBSTR3(NXSTR,I,1).NE.' ') GO TO 802
48.1 I=I+1
48.2 GO TO 17
49 802 IF(SUBSTR3(NXSTR,I,1).NE.'&') GO TO 20
50 INPSTR=INPSTR+SUBSTR(NXSTR,I+1)
50.1 GO TO 10
51 
52 20 CALL CRUNCH(INPSTR,CRSTR)
53 IF (SNUM.NE.'') GO TO 21
54 IF(LEFT(INPSTR,1).NE.'C') GO TO 814
54.1 INPSTR='*'+SUBSTR(INPSTR,2)
54.2 GO TO 70
55 814 IF(LEFT(CRSTR,1).EQ.'*') GO TO 70
56 21 ISC=INDEX(CRSTR,';')
57 16 CONTINUE
58.011 I=1
58.012 STMTHD='ASCII'
58.013 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.021 I=2
58.022 STMTHD='FILENAME'
58.023 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.031 I=3
58.032 STMTHD='DATA'
58.033 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.041 I=4
58.042 STMTHD='FORMAT'
58.043 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.051 I=5
58.052 STMTHD='IMPLICIT'
58.053 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.061 I=6
58.062 STMTHD='EQUIVALENCE'
58.063 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.071 I=7
58.072 STMTHD='IF'
58.073 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.081 I=8
58.082 STMTHD='READ'
58.083 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.091 I=9
58.092 STMTHD='INPUT'
58.093 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.101 I=10
58.102 STMTHD='PRINT'
58.103 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.111 I=11
58.112 STMTHD='ENTRY'
58.113 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.121 I=12
58.122 STMTHD='RETURN'
58.123 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.131 I=13
58.132 STMTHD='LOAD'
58.133 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.141 I=14
58.142 STMTHD='CALLBREAK'
58.143 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.151 I=15
58.152 STMTHD='CALLPID'
58.153 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.161 I=16
58.162 STMTHD='CALLEXITLM'
58.163 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.171 I=17
58.172 STMTHD='CALLBYE'
58.173 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.181 I=18
58.182 STMTHD='CHECK'
58.183 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.191 I=19
58.192 STMTHD='NOCHECK'
58.193 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.201 I=20
58.202 STMTHD='LINE'
58.203 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.211 I=21
58.212 STMTHD='NOLINE'
58.213 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.221 I=22
58.222 STMTHD='ENCODE'
58.223 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.231 I=23
58.232 STMTHD='DECODE'
58.233 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.241 I=24
58.242 STMTHD='FILELIST'
58.243 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.251 I=25
58.252 STMTHD='SET'
58.253 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.261 I=26
58.262 STMTHD='OPENFILE'
58.263 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.271 I=27
58.272 STMTHD='CLOSEFILE'
58.273 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.281 I=28
58.282 STMTHD='BACKSPACE'
58.283 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.291 I=29
58.292 STMTHD='REWIND'
58.293 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.301 I=30
58.302 STMTHD='ENDFILE'
58.303 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.311 I=31
58.312 STMTHD='CHAIN'
58.313 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
58.321 I=32
58.322 STMTHD='WRITE'
58.323 IF(INDEX(CRSTR,STMTHD).EQ.IXIF) GO TO 30
60 GO TO 80
61 
62 
63 * FOUND A STMT THAT NEEDS TRANSLATING
64 30 GO TO(31,32,33,34,35,36,37,38,39,40,41,42,43,44),NST(I)
65 31 STEMP=STMTHD+' FOUND IN LINE '+LNUM
65.1 WRITE (4,898) STEMP
66 IF(COMNT(I).EQ.0) GO TO 829
66.1 GO TO (831,832,833),COMNT(I)
66.2 831 STEMP='USE BFO'
66.3 GO TO 830
66.4 832 STEMP='MANUALLY REPROGRAM'
66.5 GO TO 830
66.6 833 STEMP='CONVERT I-O'
66.7 GO TO 830
66.8 830 WRITE(4,898) STEMP
66.9 829 CONTINUE
67 CRSTR='*'+CRSTR
67.1 GO TO 90
68 *
69 * ALPHA AND FILENAME HERE
70 *
71 32 CONTINUE
72 33 CRSTR='STRING '+SUBSTR(CRSTR,NST(I)*3)
73 TSTR='('+STR((NST(I)-1)*4)+')'
74 CRSTR=CRSTR+TSTR
74.1 J=1
75 330 I=INDEX3(CRSTR,',',J)
76 IF(I.EQ.0)GO TO 90
77 CRSTR=LEFT(CRSTR,I-1)+TSTR+SUBSTR(CRSTR,I)
77.1 J=I+5
78 GO TO 330
79 *
80 ******* HANDLE OCTAL CONSTANTS IN DATA STMT HERE****
81 *
82 34 I=1
83 340 I=INDEX3(CRSTR,'/',I)
83.1 J=INDEX3(CRSTR,'/',I+1)
84 IF(I.EQ.0) GO TO 90
85 342 IF(SUBSTR3(CRSTR,I+1,1).EQ.'O') GO TO 341
86 I=INDEX3(CRSTR,',',I+1)
87 IF(I.GT.J)GO TO 340
88 GO TO 342
89 341 STEMP='OCTAL CONSTANT FOUND IN LINE '+LNUM
89.1 WRITE(4,898) STEMP
90 STEMP='MANUALLY REPROGRAM'
90.1 WRITE(4,898) STEMP
91 CRSTR='*'+CRSTR
91.1 GO TO 90
92 *
93 ********EQUIVALENCE****
94 *
95 36 STEMP='EQUIVALENCE FOUND IN LINE '+LNUM
95.1 WRITE(4,898) STEMP
96 STEMP='BE SURE TYPES MATCH!!'
96.1 WRITE(4,898) STEMP
97 GO TO 90
98 *
99 ******IF(X> ** IF X< ******HERE***
100 *
101 37 I=INDEX(CRSTR,'<')
101.1 J=INDEX(CRSTR,'>')
102 IF(I.EQ.0.AND.J.EQ.0) GO TO 50
103 IF(I.LE.J) GO TO 803
103.1 CRSTR=LEFT(CRSTR,I-1)+'.LT.'+SUBSTR(CRSTR,I+1)
103.2 GO TO 37
104 803 CRSTR=LEFT(CRSTR,J-1)+'.GT.'+SUBSTR(CRSTR,J+1)
104.1 GO TO 37
105 50 IPCNT=1
106 DO 51 I=4,LENGTH(CRSTR)
107 TSTR=SUBSTR3(CRSTR,I,1)
108 IF(TSTR.NE.')') GO TO 804
108.1 IPCNT=IPCNT-1
108.2 GO TO 52
109 804 IF(TSTR.EQ.'(')IPCNT=IPCNT+1
110 GO TO 51
111 52 IF(IPCNT.NE.0) GO TO 51
111.1 IXIF=I+1
111.2 GO TO 16
112 51 CONTINUE
113 *
114 *
115 *******RETURN #****
116 *
117 41 IF(LENGTH(CRSTR).EQ.IXIF+5) GO TO 90
118 IF (NUMPUL(SUBSTR(CRSTR,7)).EQ.0) GO TO 90
119 STEMP='ALTERNATE RETURN IN LINE '+LNUM+'... MANUALLY REPROGRAM'
119.1 WRITE (4,898) STEMP
120 ** CRSTR='*'+CRSTR
120.1 ** GO TO 90
121 *
122 *****CALL BYE******
123 42 CRSTR=LEFT(CRSTR,IXIF-1)+'LOGOUT'
123.1 GO TO 90
124 *
125 *****CHAIN***
126 *
127 43 CRSTR=LEFT(CRSTR,IXIF-1)+'LINK '+SUBSTR(CRSTR,IXIF+5)
127.1 GO TO 90
128 *
129 *****************
130 *
131 * FORMATS TREATED HERE****
132 *
133 ****************
134 35 IF(CRSTR.NE.'FORMAT(V)') GO TO 805
134.1 IFFX=IFFX+1
134.2 IFF(IFFX)=VAL(SNUM)
134.3 CRSTR='*'+CRSTR
134.4 GO TO 90
135 805 I=8
135.1 J=1
136 IF(SUBSTR3(CRSTR,I,1).NE.'"') GO TO 57
136.1 I=9
136.2 GO TO 55
137 57 I=INDEX3(CRSTR,'"',I)+1
137.1 J=J+1
138 IF(I.EQ.1)GO TO 90
139 IF(.NOT.(SUBSTR3(CRSTR,I-2,1).EQ.'/'))GO TO 57
140 *
141 *****PERHAPS CARR.CONTROL
142 *
143 55 TSTR=QSTR(J)
144 IF(.NOT.(TSTR.EQ.'1'.OR.TSTR.EQ.' '.OR.TSTR.EQ.'-'.OR.TSTR.EQ.'+'.OR.TSTR.EQ.'&'.OR.TSTR.EQ.'0'))GO TO 57
145 CRSTR='*'+CRSTR
146 STEMP='CARRIAGE CONTROL CHAR FOUND IN FORMAT IN LINE '+LNUM
146.1 WRITE(4,898) STEMP
147 GO TO 90
148 *
149 ****************************
150 *****READ,WRITE,INPUT,PRINT*********
151 **********
152 *
153 44 CONTINUE
154 38 CONTINUE
155 39 CONTINUE
156 40 J=NST(I)
157 IF(J.EQ.8) GO TO 815
157.1 I=IXIF+5
157.2 GO TO 816
157.3 815 I=IXIF+4
158 816 TSTR=SUBSTR3(CRSTR,I,1)
159 IF(TSTR.EQ.',')GO TO 60
160 IF(TSTR.EQ.':')GO TO 60
161 IF(TSTR.GE.'0'.AND.TSTR.LE.'9')GO TO 65
162 IF(TSTR.NE.'(') GO TO 69
162.1 IRFLG=-1
162.2 IF (J.EQ.8.OR.J.EQ.14)GO TO 66
163 GO TO 69
164 *
165 *::: DISPLAY AND ACCEPT CONVERSION***
166 *
167 60 IF(J.EQ.10.OR.J.EQ.14) GO TO 806
167.1 TSTR="ACCEPT '?'"
167.2 GO TO 68
167.3 806 TSTR='DISPLAY '
167.4 I=I+1
168 68 CRSTR=LEFT(CRSTR,IXIF-1)+TSTR+SUBSTR(CRSTR,I)
168.1 GO TO 69
169 *
170 ******WRITE(1,FMT)---READ(0,FMT)*********
171 *
172 65 IF(J.EQ.10.OR.J.EQ.14) GO TO 817
172.1 TSTR='READ(0,'
172.2 GO TO 818
172.3 817 TSTR='WRITE(1,'
173 818 K=INDEX3(CRSTR,',',I+1)
173.1 IF(K.EQ.0) GO TO 819
173.2 CRSTR=LEFT(CRSTR,K-1)+')'+SUBSTR(CRSTR,K+1))
173.3 GO TO 820
173.4 819 CRSTR=CRSTR+')'
173.5 820 IRFLG=-1
174 GO TO 68
175 *
176 * LOOK FOR POSIBLE FILENAME INSTEAD OF NUMMBER**
177 *
178 66 TSTR=SUBSTR3(CRSTR,I+1,1)
179 IF(TSTR.NE.'"') GO TO 807
179.1 CRSTR='*'+CRSTR
179.2 GO TO 67
180 807 IF('A'.GT.TSTR.OR.TSTR.GT.'Z') GO TO 69
180.1 STEMP='POSSIBLE '
180.2 WRITE(4,897) STEMP
181 67 STEMP='FILE NAME USED AS FILE NUMBER IN LINE '+LNUM
181.1 WRITE(4,898) STEMP
182 69 IF(J.EQ.10.OR.J.EQ.14)GO TO 80
183 GO TO 90
184 *
185 *
186 *
187 *
188 *
189 **************
190 80 CALLFUNCSRCH ( CRSTR)
191 90 IF(ISC.EQ.0)GO TO 100
192 ISC=INDEX(CRSTR,';')
192.1 RSTR=SUBSTR(CRSTR,ISC+1)
193 CRSTR=LEFT(CRSTR,ISC-1)
194 100 K=1
195 DO 101 I=IORG,IXQ
196 J=INDEX3(CRSTR,'"',K)
196.1 IF(J.EQ.0) GO TO 106
197 CRSTR=LEFT(CRSTR,J)+QSTR(I)+'"'+SUBSTR(CRSTR,J+1)
198 K=J+LENGTH(QSTR(I))+2
199 101 CONTINUE
200 * QUOTES NOW ALL FILLED IN
201 *
202 106 IORG=I+1
203 IF(VAL(LNUM).LE.999) GO TO 808
203.1 FLNUM=FLNUM+.001 
203.2 LNUM=SUBSTR(STR(FLNUM),2)+' '
204 808 IF(IRFLG.EQ.0) GO TO 809
204.1 LNUM='\'+LNUM
204.2 IRFLG=0
205 809 STEMP=LNUM+SNUM+CRSTR
205.1 WRITE(3,898) STEMP
206 IF(ISC.NE.0) GO TO 810
206.1 INPSTR=NXSTR
206.2 GO TO 5
207 810 LNUM=SUBSTR(STR(VAL(LNUM)+.001),2)+' '
208 CRSTR=RSTR
209 I=NUMPUL(CRSTR)
210 IF(I.EQ.0) GO TO 821
210.1 SNUM=LEFT(CRSTR,I)+' '
210.2 CRSTR=SUBSTR(CRSTR,I+1)
210.3 GO TO 21
210.4 821 SNUM=''
211 GO TO 21
212 
213 70 IF(VAL(LNUM).LE.999) GO TO 811
213.1 FLNUM=FLNUM+.001
213.2 LNUM=SUBSTR(STR(FLNUM),2)+' '
214 811 STEMP=LNUM+SNUM+INPSTR
214.1 WRITE(3,898) STEMP
215 INPSTR=NXSTR
215.1 GO TO 5
216 
217 999 IF(IEOF.NE.0) GO TO 812
217.1 IEOF=1
217.2 GO TO 20
217.3 812 CONTINUE
218 *
219 *
220 *  FILL IN FORMAT WITH FREE FORM
221 *
222 CLOSE(3)
222.1 CLOSE(2)
222.2 OPEN(2,"GETYM.TMP",INPUT)
222.3 OPEN(3,FNO,OUTPUT)
223 105 READ(2,898,END=9999)INPSTR
224 IF (LEFT(INPSTR,1).NE.'\') GO TO 110
225 INPSTR=SUBSTR(INPSTR,2)
226 IF(IFFX.EQ.0)GO TO 110
227 J=INDEX(INPSTR,',')
227.1 K=INDEX(INPSTR,')')
228 IF(J.GT.K)GO TO 110
228.1 CRSTR=SUBSTR3(INPSTR,J+1,K-J-1)
229 DO 115 L=1,LENGTH(CRSTR)
230 TSTR=SUBSTR3(CRSTR,L,1)
231 IF(TSTR.LT.'0'.OR.TSTR.GT.'9')GO TO 110
232 115 CONTINUE
233 JVAL=VAL(CRSTR)
234 DO 120 I=1,IFFX
235 IF(IFF(I).EQ.JVAL)GO TO 140
236 120 CONTINUE
237 GO TO 110
238 *
239 * REPAIR FREE FORMAT
240 *
241 140 INPSTR=LEFT(INPSTR,J-1)+SUBSTR(INPSTR,K)
242 110 IF(LENGTH(INPSTR).LE.72) GO TO 813
242.1 STEMP=LEFT(INPSTR,72)+CHAR(106)
242.11 WRITE(3,897) STEMP
242.2 INPSTR=SUBSTR(INPSTR,73)
242.3 GO TO 110
243 813 WRITE(3,898)INPSTR
243.1  GO TO 105
244 *
245 9999 CLOSE(2)
245.1 CLOSE(3)
246 STEMP='EOF'
246.1 DISPLAY STEMP
247 QUIT
248 902 STEMP= "UNABLE TO OPEN SCRATCH FILE, ABORTING JOB"
248.1 DISPLAY STEMP
249 
250 QUIT
251 906
251.1 CLOSE(2)
251.2 CLOSE(3)
251.3 CLOSE(4)
252 STEMP=CHAR(109)+'ABORTED'
252.1 DISPLAY STEMP
253 ** ON INTERRUPT GO TO 900
254 GO TO 900
255 *
256 END
300 SUBROUTINE CRUNCH(INPSTR,CRSTR)
301 STRING QSTR(10)(100)
302 COMMON QSTR,IXQ
303 * REMOVE BLANKS AND STRING EXPRS FROM INPSTR
304 STRING CRSTR(100),INPSTR(100)
305 STRING TCHR(1)
306 L=1
306.1 IXQ=0
306.2 CRSTR=''
307 10 DO 20 I=L,LENGTH(INPSTR)
308 TCHR=SUBSTR3(INPSTR,I,1)
309 IF(TCHR.EQ." ".OR.TCHR.EQ.CHAR(10)) GO TO 20
310 IF(TCHR.NE.'"')GOTO 45
311 * QUOTES HANDLED HERE
312 IXQ=IXQ+1
312.1 QSTR(IXQ)=''
313 DO 25 J=I+1,LENGTH(INPSTR)
314 TCHR=SUBSTR3(INPSTR,J,1)
315 IF(TCHR.EQ.'"')GOTO 26
316 25 QSTR(IXQ)=QSTR(IXQ)+TCHR
317 26 CRSTR=CRSTR+'"'
318 L=J+1
319 GOTO10
320 *
321 * HOLLERITH CONVERTED HERE
322 *
323 45 IF (TCHR.NE.'H')GOTO31
324 J=LENGTH(CRSTR)
325 TCHR=SUBSTR3(CRSTR,J,1)
326 IF(TCHR.LT."0".OR.TCHR.GT."9") GOTO30
327 *
328 * #H
329 *
330 K=VAL(TCHR)
331 32 J=J-1
331.1 TCHR=SUBSTR3(CRSTR,J,1)
332 IF(TCHR.LT."0".OR.TCHR.GT."9") GOTO40
333 K=K+VAL(TCHR)*10
334 GOTO32
335 *
336 * NOW CHECK TO MAKE SURE CHAR PRECEEDING HOLLERITH FIELD IS NOT ALPHA
337 *
338 40 IF(TCHR.GE."A". AND.TCHR.LE."Z")GOTO30
339 CRSTR=LEFT(CRSTR,J)+'"'
340 IXQ=IXQ+1
340.1 QSTR(IXQ)=SUBSTR3(INPSTR,I+1,K)
340.2 L=I+K+1
341 GOTO10
342 *
343 * TACK ON CHAR
344 *
345 30 TCHR='H'
346 31 CRSTR=CRSTR+TCHR
347 20 CONTINUE
348 *
349 RETURN
350 END
453 SUBROUTINE NUMPUL(STR)
455 * RETURNS A NUMBER=NUMBER OF NUMERIC
456 * CHARS AT HEAD OF 'STR'+LEADING BLANKS
457 STRING STR(100),TCH(1)
458 I=0
458.1 J=1
458.2 K=0
459 9 IF(SUBSTR3(STR,J,1).NE.' ') GO TO 11
459.1 J=J+1
459.2 I=I+1
459.3 GO TO 9
459.4 11 CONTINUE
460 *
461 DO 10 J=J,LENGTH(STR)
462 TCH=SUBSTR3(STR,J,1)
463 IF(TCH.LT.'0'.OR.TCH.GT.'9') GOTO20
464 10 I=I+1
464.1 K=1
465 20 IF(K.NE.0) GO TO 21
465.1 NUMPUL=0
465.2 RETURN
466 21 NUMPUL=I
467 RETURN
468 END
473 SUBROUTINE FUNCSRCH(STR)
474 INTEGER CFLG
475 STRING QSTR(10)(100),LNUM(15)
476 COMMON QSTR,IXQ,CFLG,LNUM
477 STRING STR(300),TSTR(1),FNAMES(13)(5),FSUB(10)(60)
478 * DATA FNAMES/'AND','OR','EOR','NUMF','USE','DAT','LOC','LOF','RND','RRAND','CLK','IDATE','BCLK'/
479 * DATA FSUB/3*'FIX','POSITION','SIZE','RAND','SETRAND(-1)','SUBSTR(DATE(X),8)','VAL(RIGHT(STR(YEAR(X)),2)+LEFT(DATE,2)+SUBSTR3(DATE,4,2))'/
480 * FSUB(10)='VAL(SUBSTR3(DATE(Z),8,2))+VAL(SUBSTR(DATE(X),11))/60'
481 
482 
483 
484 *FIND A FUNCTION**************
485 *
486 *
487 DO 10 I=1,13
488 J=INDEX(STR,FNAMES(I))
489 IF(J.EQ.0)GOTO10
490 IF(J.EQ.1)GOTO15
491 TSTR=SUBSTR3(STR,J-1,1)
492 IF((TSTR.GE.'A'.AND.TSTR.LE.'Z').OR.TSTR.EQ.'.')GOTO10
493 15 TSTR=SUBSTR3(STR,J+LENGTH(FNAMES(I)),1)
494 IF(TSTR.GE.'A'.AND.TSTR.LE.'Z')GOTO10
495 IF(TSTR.GE.'0'.AND.TSTR.LE.'9')GOTO10
496 IF(I.LE.6)WRITE(4)FNAMES(I)+' FUNCTION FOUND IN LINE '+LNUM
497 IF (I.GE.7) GO TO 18
498 16 IF(I.LE.4)WRITE(4)'USE BFO'.ELSE.(WRITE(4)'MANUALLY TRANSLATE')
499 STR='*'+STR
500 GOTO10
501 18 IF(I.GE.13)STR=LEFT(STR,J-1)+SUBSTR(STR,INDEX3(STR,')',J)+1)
502 STR=LEFT(STR,J-1)+FSUB(I-6)+SUBSTR(STR,J+LENGTH(FNAMES(I)))
503 10 CONTINUE
504 RETURN
505 END
 