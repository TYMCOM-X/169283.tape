BTITLEDLIBINT	SFO LIBRARY INTERFACE ROUTINES	MACRO 46-7 11:20 12-JUN-73 PAGE 1
LIBINT.MAC	11-JUN-73 14:39	

BC				00100	TITLE	LIBINT	SFO LIBRARY INTERFACE ROUTINES
BC
BTWOSEGC	400000'			00300		TWOSEG
BRELOCC	400000'			00400		RELOC	400000
BTYP.STC			000015	00500	TYP.ST=	15		;; STRING TYPE.
BLC			000016	00600	L=	16			; ARG BLK POINTER REGISTER.
BNUUOSC			000005	00700	NUUOS=	5			; NR OF STRING UUO'S.
BSTMUUOC			000005	00800	STMUUO=	5			; STM UUO OP CODE.
BSTKSZC			000240	00900	STKSZ=	240
BC
BC
BDEFINEC				01200		DEFINE	STRFMT
BSTRFMTC				01300	<
BC				01400	;; RETURNS 0 IN AC4 IF FORMAT IS A STRING, ELSE 1.
BC				01500		CLEARM	Z1		;; USE Z1 AS TEMP,SINCE IT'S UNBUSY.
BC				01600		LDB	2,[POINT 4,(L),12]  ;; TYPE OF FORMAT.
BC				01700		CAIE	2,TYP.STR	;; STACK STRING IF FORMAT IS ONE.
BC				01800		JRST	.+5		;; IF NOT STRING,SET UP AS CHARACTER ARRAY.
BC				01900		JSP	17,SESTRT	;; NEW EXPRESSION.
BC				02000		HRRZ	1,(L)		;; ADDR OF STRING POINTERWORD.
BC				02100		JSP	17,STRNG	;; PLACE STRING ON STACK.
BC				02200		JRST	.+4		;; DONE,, WATCH OUT FOR INSERTIONS.
BC				02300		HRRZ	2,(L)		;; GET FORMAT ADDR (NOT STRING).
BC				02400		HRRZ	3,1(L)		;; FORMAT SIZE     (NOT STRING).
BC				02500		AOS	Z1		;; SET  FLAG FOR RETURN.
BC				02600		MOVE	1,UNIT		;; GET UNIT AS 1'ST ARG.
BC				02700		MOVE	4,Z1		;; GET FLAG IN AC4 TO RETURN.
BC				02800						>
BDEFINESAVEMC				02900	        DEFINE  SAVEM   <
BC				03000	        MOVEM   17,B+17         ;; SAVE
BC				03100	        MOVEI   17,B            ;;    THE
BC				03200	        BLT     17,B+16         ;;       REGISTERS.     
BC				03300		
BC				03400						>
BC
BDEFINEC				03600		DEFINE	SSAVEM
BSSAVEMC				03700	<	SAVEM
BC				03800		MOVEI	1,WDSTCLR	;;CLEAR STORAGE AREAS.
BC				03900		CLEARM	OPNPRM(1)
BC				04000		SOJGE	1,.-1
BC				04100					>
BC
BC
BDEFINEC				04400		DEFINE	WORD(X)
BWORDC				04500	<	HRRZ	1,X		;;REPLACE A WORD BY THE WORD
BC				04600		MOVE	1,(1)		;;WHICH ITS RIGHT HALF POINTS TO.
BC				04700		MOVEM	1,X
BC				04800					>
BC
BC
BDEFINEC				05100	DEFINE RSTOREM
BRSTOREC				05200	<	HRLZI	17,B
BC				05300		BLT	17,17
LIBINT	SFO LIBRARY INTERFACE ROUTINES	MACRO 46-7 11:20 12-JUN-73 PAGE 1-2
LIBINT.MAC	11-JUN-73 14:39	

BC				05400		POPJ	17,
BC				05500						>
BC
BDEFINEC				05700		DEFINE CLLN(PROC)
BCLLNC				05800	<	SAVEM
BC				05900		JSP	17,PROC		;; CALL PROC W/OUT ARGUMENTS.
BC				06000		MOVEM	1,B		;; FCN VALUE MAYBE?
BC				06100		RSTOREM			;; ALL DONE.
BC				06200						>
BC
BDEFINEC				06400		DEFINE	UERRND
BUERRNDC				06500	<
BC				06600		HRRZ	1,1(L)		;;END= ADDRSS.
BC				06700		SKIPE	1		;; IF NO END=, DON'T SET.
BC				06800		MOVEM	1,EOFLAB	;;STORE IN GLOBAL VARIABLE.
BC				06900		HRRZ	1,2(L)		;;ERR= ADDRESS.
BC				07000		SKIPE	1		;; IF NO ERR=, DON'T SET.
BC				07100		MOVEM	1,ERRLAB	;;STORE IN GLOBAL VARIABLE.
BC				07200		HRRE	1,(L)		; UNIT.
BC				07300		MOVEM	1,UNIT		;;STORE.
BC				07400					>
BC
BC
BDEFINEC				07700	        DEFINE  CLL(PROC)
BCLLC				07800	<       SAVEM                   ;; SAVE ALL AC'S.
BC				07900	        JSP     17,ARGS         ;; GET THE ARGUMENTS.
BC				08000	        JSP     17,PROC         ;; CALL THE ROUTINE.
BC				08100		MOVEM	1,B		;;FOR FUNCTION VALUE,IF ANY.
BC				08200		RSTOREM
BC				08300	                        >
BC
BC
BDEFINEC				08600	        DEFINE  CLLSK(PROC)
BCLLSKC				08700	<       SAVEM           	;;SAVE AC'S.
BC				08800	        JSP     17,PROC 	;;CALL THE PROCEDURE.
BC				08900	        MOVEM   1,Z1    	;;SAVE THE 0 OR 1 RETURN.
BC				09000	        HLRZI   17,B    	;;GET READY TO --
BC				09100	        BLT     17,17   	;;RESTORE ALL AC'S.
BC				09200	        POP     17,17   	;;MUST GET RETURN ADDR AND ADD THE
BC				09300	        ADD     17,Z1   	;;0 OR 1 TO SIMULATE SKIPPING.
BC				09400	        JRST    (17)    	;;RETURN.
BC				09500	                                >
BC
BC
BINIT%C	400000'			09800	INIT%::				;
BJSPSFOIOSFOIOC	400000'	265740	000000*	09900		JSP	17,SFOIO##	; MORE INITIALIZATION.
BJSPIOINITIOINITC	400001'	265740	000000*	10000		JSP	17,IOINIT##	; SAME HERE.
BJSPDBGDBGC	400002'	265740	000000*	10005		JSP	17,DBG##
BMOVEPUSHJUUOC	400003'	200000	401003'	10100		MOVE	0,[PUSHJ 17,UUO]	; UUO HANDLER INIT.
BMOVEM.JB41C	400004'	202000	000000*	10200		MOVEM	0,.JB41
BMOVEIOWDSTKSZSTAKC	400005'	200740	401004'	10300		MOVE	17,[IOWD STKSZ,STAK]	; INITIALIZE STACK POINTER.
BMOVEC	400006'	200040	000135	10400		MOVE	1,135			; OOOOOOOH!
BJRSTC	400007'	254001	000001	10500		JRST	1(1)			; SEXY, HUH?
LIBINT	SFO LIBRARY INTERFACE ROUTINES	MACRO 46-7 11:20 12-JUN-73 PAGE 1-3
LIBINT.MAC	11-JUN-73 14:39	

BC
BIOPARMC	400010'			10700	IOPARM:
BHRRELC	400010'	570056	777777	10800		HRRE	1,-1(L)		; STORE NUMBER OF ARGUMENTS-3
BADDIC	400011'	271040	000003	10900		ADDI	1,3		; IN ARGN.
BMOVMMARGNC	400012'	216040	000264'	11000		MOVMM	1,ARGN
BJSPGETWDIC	400013'	265500	400761'	11100		JSP	12,GETWDI	; GET UNIT.
BMOVEMUNITC	400014'	202640	000263'	11200		MOVEM	15,UNIT
BAOSLC	400015'	350000	000016	11300		AOS	L		;ADJUST L.
BMOVELC	400016'	200056	000000	11400		MOVE	1,(L)		; IF END= IS 0, DONT FOOL AROUND.
BJUMPEIOP1C	400017'	322040	400023'	11500		JUMPE	1,IOP1
BJSPGETWDC	400020'	265500	400765'	11600		JSP	12,GETWD	; END=
BSKIPEC	400021'	332000	000001	11700		SKIPE	1		; ,SET EOFLAB IF NOT 0.
BMOVEMEOFLABC	400022'	202040	000000*	11800		MOVEM	1,EOFLAB
BIOP1AOSLC	400023'	350000	000016	11900	IOP1:	AOS	L		; ADJUST L.
BMOVELC	400024'	200056	000000	12000		MOVE	1,(L)		;LIKEWISE WITH ERR=.
BJUMPEIOP2C	400025'	322040	400031'	12100		JUMPE	1,IOP2
BJSPGETWDC	400026'	265500	400765'	12200		JSP	12,GETWD	; GET ERR=
BSKIPEC	400027'	332000	000001	12300		SKIPE	1		; AND SET IF NONZERO.
BMOVEMERRLABC	400030'	202040	000000*	12400		MOVEM	1,ERRLAB
BIOP2AOJALC	400031'	344717	000000	12500	IOP2:	AOJA	L,(17)		; ADJUST L AND RETURN.
BC
BONINT%SAVEMC	400032'			12700	ONINT%::	SAVEM	^
BMOVEMBC	400032'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400033'	201740	000242'		        MOVEI   17,B            
BBLTBC	400034'	251740	000260'		        BLT     17,B+16         
BJSPGETWDIC	400035'	265500	400761'	12800		JSP	12,GETWDI
BJSPONINTONINTC	400036'	265740	000000*	12900		JSP	17,ONINT##
BRSTOREHRLZIBC	400037'	515740	000242'	13000		RSTOREM^	HRLZI	17,B
BBLTC	400040'	251740	000017			BLT	17,17
BPOPJC	400041'	263740	000000			POPJ	17,
BC
BOFINT%CLLNC	400042'			13200	OFINT%::	CLLN	OFINT##	;
BSAVEMMOVEMBC	400042'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400043'	201740	000242'		        MOVEI   17,B            
BBLTBC	400044'	251740	000260'		        BLT     17,B+16         
BJSPOFINTOFINTC	400045'	265740	000000*			JSP	17,OFINT##			
BMOVEMBC	400046'	202040	000242'			MOVEM	1,B		
BRSTOREHRLZIBC	400047'	515740	000242'			RSTOREM	^	HRLZI	17,B
BBLTC	400050'	251740	000017			BLT	17,17
BPOPJC	400051'	263740	000000			POPJ	17,
BC
BC
BC
BSTRG%JSPSTRNGC	400052'	265740	000000*	13600	STRG%::	JSP	17,STRNG
BRSTOREHRLZIBC	400053'	515740	000242'	13700		RSTOREM^	HRLZI	17,B
BBLTC	400054'	251740	000017			BLT	17,17
BPOPJC	400055'	263740	000000			POPJ	17,
BC
BSTRGA%JSPSTRNGAC	400056'	265740	000000*	13900	STRGA%::	JSP	17,STRNGA
BRSTOREHRLZIBC	400057'	515740	000242'	14000		RSTOREM^	HRLZI	17,B
BBLTC	400060'	251740	000017			BLT	17,17
BPOPJC	400061'	263740	000000			POPJ	17,
BC
BSSTR%JSPSSTORDLIBINT	SFO LIBRARY INTERFACE ROUTINES	MACRO 46-7 11:20 12-JUN-73 PAGE 1-4
LIBINT.MAC	11-JUN-73 14:39	

BC	400062'	265740	000000*	14200	SSTR%::	JSP	17,SSTOR
BRSTOREHRLZIBC	400063'	515740	000242'	14300		RSTOREM^	HRLZI	17,B
BBLTC	400064'	251740	000017			BLT	17,17
BPOPJC	400065'	263740	000000			POPJ	17,
BC
BSSTRA%JSPSSTORAC	400066'	265740	000000*	14500	SSTRA%::	JSP	17,SSTORA
BRSTOREHRLZIBC	400067'	515740	000242'	14600		RSTOREM^	HRLZI	17,B
BBLTC	400070'	251740	000017			BLT	17,17
BPOPJC	400071'	263740	000000			POPJ	17,
BC
BC
BSEST%SAVEMC	400072'			14900	SEST%::	SAVEM^
BMOVEMBC	400072'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400073'	201740	000242'		        MOVEI   17,B            
BBLTBC	400074'	251740	000260'		        BLT     17,B+16         
BJSPSESTRTC	400075'	265740	000000*	15000		JSP	17,SESTRT
BRSTOREHRLZIBC	400076'	515740	000242'	15100		RSTOREM^	HRLZI	17,B
BBLTC	400077'	251740	000017			BLT	17,17
BPOPJC	400100'	263740	000000			POPJ	17,
BC
BSBST%CLLSAVEMC	400101'			15300	SBST%::	CLL	SUBSTR^       SAVEM ^
BMOVEMBC	400101'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400102'	201740	000242'		        MOVEI   17,B            
BBLTBC	400103'	251740	000260'		        BLT     17,B+16         
BJSPARGSC	400104'	265740	400411'		        JSP     17,ARGS         
BJSPSUBSTRC	400105'	265740	000000*		        JSP     17,SUBSTR         
BMOVEMBC	400106'	202040	000242'			MOVEM	1,B		
BRSTOREHRLZIBC	400107'	515740	000242'			RSTOREM^	HRLZI	17,B
BBLTC	400110'	251740	000017			BLT	17,17
BPOPJC	400111'	263740	000000			POPJ	17,
BC
BSMAX%CLLSAVEMC	400112'			15500	SMAX%::	CLL	SMAX^       SAVEM ^
BMOVEMBC	400112'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400113'	201740	000242'		        MOVEI   17,B            
BBLTBC	400114'	251740	000260'		        BLT     17,B+16         
BJSPARGSC	400115'	265740	400411'		        JSP     17,ARGS         
BJSPSMAXC	400116'	265740	000000*		        JSP     17,SMAX         
BMOVEMBC	400117'	202040	000242'			MOVEM	1,B		
BRSTOREHRLZIBC	400120'	515740	000242'			RSTOREM^	HRLZI	17,B
BBLTC	400121'	251740	000017			BLT	17,17
BPOPJC	400122'	263740	000000			POPJ	17,
BC
BSMIN%CLLSAVEMC	400123'			15700	SMIN%::	CLL	SMIN^       SAVEM ^
BMOVEMBC	400123'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400124'	201740	000242'		        MOVEI   17,B            
BBLTBC	400125'	251740	000260'		        BLT     17,B+16         
BJSPARGSC	400126'	265740	400411'		        JSP     17,ARGS         
BJSPSMINC	400127'	265740	000000*		        JSP     17,SMIN         
BMOVEMBC	400130'	202040	000242'			MOVEM	1,B		
BRSTOREHRLZIBC	400131'	515740	000242'			RSTOREM^	HRLZI	17,B
BBLTC	400132'	251740	000017			BLT	17,17
BPOPJC	400133'	263740	000000			POPJ	17,
BC
BLNGTH%CLLNSAVEMDLIBINT	SFO LIBRARY INTERFACE ROUTINES	MACRO 46-7 11:20 12-JUN-73 PAGE 1-5
LIBINT.MAC	11-JUN-73 14:39	

BC	400134'			15900	LNGTH%::	CLLN	LENGTH^	SAVEM^
BMOVEMBC	400134'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400135'	201740	000242'		        MOVEI   17,B            
BBLTBC	400136'	251740	000260'		        BLT     17,B+16         
BJSPLENGTHC	400137'	265740	000000*			JSP	17,LENGTH		
BMOVEMBC	400140'	202040	000242'			MOVEM	1,B		
BRSTOREHRLZIBC	400141'	515740	000242'			RSTOREM	^	HRLZI	17,B
BBLTC	400142'	251740	000017			BLT	17,17
BPOPJC	400143'	263740	000000			POPJ	17,
BC
BINDX%CLLSAVEMC	400144'			16100	INDX%::	CLL	INDEX^       SAVEM ^
BMOVEMBC	400144'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400145'	201740	000242'		        MOVEI   17,B            
BBLTBC	400146'	251740	000260'		        BLT     17,B+16         
BJSPARGSC	400147'	265740	400411'		        JSP     17,ARGS         
BJSPINDEXC	400150'	265740	000000*		        JSP     17,INDEX         
BMOVEMBC	400151'	202040	000242'			MOVEM	1,B		
BRSTOREHRLZIBC	400152'	515740	000242'			RSTOREM^	HRLZI	17,B
BBLTC	400153'	251740	000017			BLT	17,17
BPOPJC	400154'	263740	000000			POPJ	17,
BC
BSKSE%CLLSKSAVEMC	400155'			16300	SKSE%::	CLLSK	SKPSE^       SAVEM ^
BMOVEMBC	400155'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400156'	201740	000242'		        MOVEI   17,B            
BBLTBC	400157'	251740	000260'		        BLT     17,B+16         
BJSPSKPSEC	400160'	265740	000000*		        JSP     17,SKPSE 	
BMOVEMZ1C	400161'	202040	000001'		        MOVEM   1,Z1    	
BHLRZIBC	400162'	555740	000242'		        HLRZI   17,B    	
BBLTC	400163'	251740	000017		        BLT     17,17   	
BPOPC	400164'	262740	000017		        POP     17,17   	
BADDZ1C	400165'	270740	000001'		        ADD     17,Z1   	
BJRSTC	400166'	254017	000000		        JRST    (17)    	
BC
BSKSN%CLLSKSAVEMC	400167'			16500	SKSN%::	CLLSK	SKPSN^       SAVEM ^
BMOVEMBC	400167'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400170'	201740	000242'		        MOVEI   17,B            
BBLTBC	400171'	251740	000260'		        BLT     17,B+16         
BJSPSKPSNC	400172'	265740	000000*		        JSP     17,SKPSN 	
BMOVEMZ1C	400173'	202040	000001'		        MOVEM   1,Z1    	
BHLRZIBC	400174'	555740	000242'		        HLRZI   17,B    	
BBLTC	400175'	251740	000017		        BLT     17,17   	
BPOPC	400176'	262740	000017		        POP     17,17   	
BADDZ1C	400177'	270740	000001'		        ADD     17,Z1   	
BJRSTC	400200'	254017	000000		        JRST    (17)    	
BC
BSKSL%CLLSKSAVEMC	400201'			16700	SKSL%::	CLLSK	SKPSL^       SAVEM ^
BMOVEMBC	400201'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400202'	201740	000242'		        MOVEI   17,B            
BBLTBC	400203'	251740	000260'		        BLT     17,B+16         
BJSPSKPSLC	400204'	265740	000000*		        JSP     17,SKPSL 	
BMOVEMZ1C	400205'	202040	000001'		        MOVEM   1,Z1    	
BHLRZIBC	400206'	555740	000242'		        HLRZI   17,B    	
BBLTC	400207'	251740	000017		        BLT     17,17   	
BPOPDLIBINT	SFO LIBRARY INTERFACE ROUTINES	MACRO 46-7 11:20 12-JUN-73 PAGE 1-6
LIBINT.MAC	11-JUN-73 14:39	

BC	400210'	262740	000017		        POP     17,17   	
BADDZ1C	400211'	270740	000001'		        ADD     17,Z1   	
BJRSTC	400212'	254017	000000		        JRST    (17)    	
BC
BSKSLE%CLLSKSAVEMC	400213'			16900	SKSLE%::	CLLSK	SKPSLE^       SAVEM ^
BMOVEMBC	400213'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400214'	201740	000242'		        MOVEI   17,B            
BBLTBC	400215'	251740	000260'		        BLT     17,B+16         
BJSPSKPSLEC	400216'	265740	000000*		        JSP     17,SKPSLE 	
BMOVEMZ1C	400217'	202040	000001'		        MOVEM   1,Z1    	
BHLRZIBC	400220'	555740	000242'		        HLRZI   17,B    	
BBLTC	400221'	251740	000017		        BLT     17,17   	
BPOPC	400222'	262740	000017		        POP     17,17   	
BADDZ1C	400223'	270740	000001'		        ADD     17,Z1   	
BJRSTC	400224'	254017	000000		        JRST    (17)    	
BC
BSKSG%CLLSKSAVEMC	400225'			17100	SKSG%::	CLLSK	SKPSG^       SAVEM ^
BMOVEMBC	400225'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400226'	201740	000242'		        MOVEI   17,B            
BBLTBC	400227'	251740	000260'		        BLT     17,B+16         
BJSPSKPSGC	400230'	265740	000000*		        JSP     17,SKPSG 	
BMOVEMZ1C	400231'	202040	000001'		        MOVEM   1,Z1    	
BHLRZIBC	400232'	555740	000242'		        HLRZI   17,B    	
BBLTC	400233'	251740	000017		        BLT     17,17   	
BPOPC	400234'	262740	000017		        POP     17,17   	
BADDZ1C	400235'	270740	000001'		        ADD     17,Z1   	
BJRSTC	400236'	254017	000000		        JRST    (17)    	
BC
BSKSGE%CLLSKSAVEMC	400237'			17300	SKSGE%::	CLLSK	SKPSGE^       SAVEM ^
BMOVEMBC	400237'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400240'	201740	000242'		        MOVEI   17,B            
BBLTBC	400241'	251740	000260'		        BLT     17,B+16         
BJSPSKPSGEC	400242'	265740	000000*		        JSP     17,SKPSGE 	
BMOVEMZ1C	400243'	202040	000001'		        MOVEM   1,Z1    	
BHLRZIBC	400244'	555740	000242'		        HLRZI   17,B    	
BBLTC	400245'	251740	000017		        BLT     17,17   	
BPOPC	400246'	262740	000017		        POP     17,17   	
BADDZ1C	400247'	270740	000001'		        ADD     17,Z1   	
BJRSTC	400250'	254017	000000		        JRST    (17)    	
BC
BSCHAR%CLLSAVEMC	400251'			17500	SCHAR%::	CLL	CHAR^       SAVEM ^
BMOVEMBC	400251'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400252'	201740	000242'		        MOVEI   17,B            
BBLTBC	400253'	251740	000260'		        BLT     17,B+16         
BJSPARGSC	400254'	265740	400411'		        JSP     17,ARGS         
BJSPCHARC	400255'	265740	000000*		        JSP     17,CHAR         
BMOVEMBC	400256'	202040	000242'			MOVEM	1,B		
BRSTOREHRLZIBC	400257'	515740	000242'			RSTOREM^	HRLZI	17,B
BBLTC	400260'	251740	000017			BLT	17,17
BPOPJC	400261'	263740	000000			POPJ	17,
BC
BSDATE%CLLNSAVEMC	400262'			17700	SDATE%::	CLLN	DATE^	SAVEM^
BMOVEMBC	400262'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBDLIBINT	SFO LIBRARY INTERFACE ROUTINES	MACRO 46-7 11:20 12-JUN-73 PAGE 1-7
LIBINT.MAC	11-JUN-73 14:39	

BC	400263'	201740	000242'		        MOVEI   17,B            
BBLTBC	400264'	251740	000260'		        BLT     17,B+16         
BJSPDATEC	400265'	265740	000000*			JSP	17,DATE		
BMOVEMBC	400266'	202040	000242'			MOVEM	1,B		
BRSTOREHRLZIBC	400267'	515740	000242'			RSTOREM	^	HRLZI	17,B
BBLTC	400270'	251740	000017			BLT	17,17
BPOPJC	400271'	263740	000000			POPJ	17,
BSASC%CLLNSAVEMC	400272'			17900	SASC%::	CLLN	ASC^	SAVEM^
BMOVEMBC	400272'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400273'	201740	000242'		        MOVEI   17,B            
BBLTBC	400274'	251740	000260'		        BLT     17,B+16         
BJSPASCC	400275'	265740	000000*			JSP	17,ASC		
BMOVEMBC	400276'	202040	000242'			MOVEM	1,B		
BRSTOREHRLZIBC	400277'	515740	000242'			RSTOREM	^	HRLZI	17,B
BBLTC	400300'	251740	000017			BLT	17,17
BPOPJC	400301'	263740	000000			POPJ	17,
BC
BSRMOV%CLLNSAVEMC	400302'			18100	SRMOV%::	CLLN	SREMOVE^	SAVEM^
BMOVEMBC	400302'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400303'	201740	000242'		        MOVEI   17,B            
BBLTBC	400304'	251740	000260'		        BLT     17,B+16         
BJSPSREMOVC	400305'	265740	000000*			JSP	17,SREMOVE		
BMOVEMBC	400306'	202040	000242'			MOVEM	1,B		
BRSTOREHRLZIBC	400307'	515740	000242'			RSTOREM	^	HRLZI	17,B
BBLTC	400310'	251740	000017			BLT	17,17
BPOPJC	400311'	263740	000000			POPJ	17,
BC
BIVAL%CLLSAVEMC	400312'			18300	IVAL%::	CLL	SFIVAL^       SAVEM ^
BMOVEMBC	400312'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400313'	201740	000242'		        MOVEI   17,B            
BBLTBC	400314'	251740	000260'		        BLT     17,B+16         
BJSPARGSC	400315'	265740	400411'		        JSP     17,ARGS         
BJSPSFIVALC	400316'	265740	000000*		        JSP     17,SFIVAL         
BMOVEMBC	400317'	202040	000242'			MOVEM	1,B		
BRSTOREHRLZIBC	400320'	515740	000242'			RSTOREM^	HRLZI	17,B
BBLTC	400321'	251740	000017			BLT	17,17
BPOPJC	400322'	263740	000000			POPJ	17,
BC
BVAL%CLLSAVEMC	400323'			18500	VAL%::	CLL	SFVAL^       SAVEM ^
BMOVEMBC	400323'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400324'	201740	000242'		        MOVEI   17,B            
BBLTBC	400325'	251740	000260'		        BLT     17,B+16         
BJSPARGSC	400326'	265740	400411'		        JSP     17,ARGS         
BJSPSFVALC	400327'	265740	000000*		        JSP     17,SFVAL         
BMOVEMBC	400330'	202040	000242'			MOVEM	1,B		
BRSTOREHRLZIBC	400331'	515740	000242'			RSTOREM^	HRLZI	17,B
BBLTC	400332'	251740	000017			BLT	17,17
BPOPJC	400333'	263740	000000			POPJ	17,
BC
BDVAL%CLLSAVEMC	400334'			18700	DVAL%::	CLL	SFDVAL^       SAVEM ^
BMOVEMBC	400334'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400335'	201740	000242'		        MOVEI   17,B            
BBLTBDLIBINT	SFO LIBRARY INTERFACE ROUTINES	MACRO 46-7 11:20 12-JUN-73 PAGE 1-8
LIBINT.MAC	11-JUN-73 14:39	

BC	400336'	251740	000260'		        BLT     17,B+16         
BJSPARGSC	400337'	265740	400411'		        JSP     17,ARGS         
BJSPSFDVALC	400340'	265740	000000*		        JSP     17,SFDVAL         
BMOVEMBC	400341'	202040	000242'			MOVEM	1,B		
BRSTOREHRLZIBC	400342'	515740	000242'			RSTOREM^	HRLZI	17,B
BBLTC	400343'	251740	000017			BLT	17,17
BPOPJC	400344'	263740	000000			POPJ	17,
BC
BCVAL%CLLSAVEMC	400345'			18900	CVAL%::	CLL	SFCVAL^       SAVEM ^
BMOVEMBC	400345'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400346'	201740	000242'		        MOVEI   17,B            
BBLTBC	400347'	251740	000260'		        BLT     17,B+16         
BJSPARGSC	400350'	265740	400411'		        JSP     17,ARGS         
BJSPSFCVALC	400351'	265740	000000*		        JSP     17,SFCVAL         
BMOVEMBC	400352'	202040	000242'			MOVEM	1,B		
BRSTOREHRLZIBC	400353'	515740	000242'			RSTOREM^	HRLZI	17,B
BBLTC	400354'	251740	000017			BLT	17,17
BPOPJC	400355'	263740	000000			POPJ	17,
BC
BSTR%SAVEMC	400356'			19100	STR%::	SAVEM^
BMOVEMBC	400356'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400357'	201740	000242'		        MOVEI   17,B            
BBLTBC	400360'	251740	000260'		        BLT     17,B+16         
BHLRZC	400361'	554056	000000	19200		HLRZ	1,(16)		; TYPE IS 1'ST ARGUMENT.
BHRRZC	400362'	550116	000000	19300		HRRZ	2,(16)		; ADDRESS IS SECOND ARG.
BJSPSFSTRC	400363'	265740	000000*	19400		JSP	17,SFSTR		; CALL STR.
BRSTOREHRLZIBC	400364'	515740	000242'	19500		RSTOREM	^	HRLZI	17,B
BBLTC	400365'	251740	000017			BLT	17,17
BPOPJC	400366'	263740	000000			POPJ	17,
BC
BSLFT%CLLSAVEMC	400367'			19700	SLFT%::	CLL	LEFT^       SAVEM ^
BMOVEMBC	400367'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400370'	201740	000242'		        MOVEI   17,B            
BBLTBC	400371'	251740	000260'		        BLT     17,B+16         
BJSPARGSC	400372'	265740	400411'		        JSP     17,ARGS         
BJSPLEFTC	400373'	265740	000000*		        JSP     17,LEFT         
BMOVEMBC	400374'	202040	000242'			MOVEM	1,B		
BRSTOREHRLZIBC	400375'	515740	000242'			RSTOREM^	HRLZI	17,B
BBLTC	400376'	251740	000017			BLT	17,17
BPOPJC	400377'	263740	000000			POPJ	17,
BC
BSRGHT%CLLSAVEMC	400400'			19900	SRGHT%::	CLL	RIGHT^       SAVEM ^
BMOVEMBC	400400'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400401'	201740	000242'		        MOVEI   17,B            
BBLTBC	400402'	251740	000260'		        BLT     17,B+16         
BJSPARGSC	400403'	265740	400411'		        JSP     17,ARGS         
BJSPRIGHTC	400404'	265740	000000*		        JSP     17,RIGHT         
BMOVEMBC	400405'	202040	000242'			MOVEM	1,B		
BRSTOREHRLZIBC	400406'	515740	000242'			RSTOREM^	HRLZI	17,B
BBLTC	400407'	251740	000017			BLT	17,17
BPOPJC	400410'	263740	000000			POPJ	17,
BC
BC
BARGSHLREDLIBINT	SFO LIBRARY INTERFACE ROUTINES	MACRO 46-7 11:20 12-JUN-73 PAGE 1-9
LIBINT.MAC	11-JUN-73 14:39	

BC	400411'	574656	777777	20200	ARGS:   HLRE    15,-1(16)       ; GET NR OF ARGUMENTS.
BMOVNC	400412'	210640	000015	20300	        MOVN    15,15           ; MAKE POSITIVE.
BJUMPEC	400413'	322657	000000	20400		JUMPE	15,(17)		; IF NO ARGUMENTS,RETURN.
BMOVEIC	400414'	201600	000001	20500		MOVEI	14,1		; REGISTER NUMBER TO START WITH.
BAR1HLRZC	400415'	554016	000000	20600	AR1:	HLRZ	0,(16)		; GET TYPE.
BCAINTYP.STC	400416'	306000	000015	20700		CAIN	0,TYP.STR		; IF STRING,IGNORE.
BJRSTAR2C	400417'	254000	400424'	20800		JRST	AR2
BHRRZC	400420'	550016	000000	20900		HRRZ	0,(16)		; GET ARG. ADDR.
BMOVEC	400421'	200020	000000	21000		MOVE	0,@		; GET ARGUMENT.
BMOVEMC	400422'	202014	000000	21100		MOVEM	0,(14)		; PLACE IN APPROPRIATE REGISTER.
BAOSC	400423'	350000	000014	21200		AOS	14		; INC AC 14.
BAR2AOSC	400424'	350000	000016	21300	AR2:	AOS	16		; FOR NEXT ONE.
BAOJLAR1C	400425'	341640	400415'	21400		AOJL	15,AR1		; FOR NEXT ONE.
BJRSTC	400426'	254017	000000	21500	        JRST    (17)            ; RETURN.
BC	
BSPNT%JRSTSFPRINC	400427'	254000	000000*	21700	SPNT%::	JRST	SFPRINT
BC
BC
BC
BC	
BC
BC
BSTM%C	400430'			22700	STM%::				;
BJSPSTMC	400430'	265740	000000*	22800		JSP	17,STM		; ELSE DO WHAT MUST BE DONE.
BRSTOREHRLZIBC	400431'	515740	000242'	22900		RSTOREM^	HRLZI	17,B
BBLTC	400432'	251740	000017			BLT	17,17
BPOPJC	400433'	263740	000000			POPJ	17,
BC
BC
BC
BUUOSAVEMC	400434'			23300	UUO:	SAVEM^
BMOVEMBC	400434'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400435'	201740	000242'		        MOVEI   17,B            
BBLTBC	400436'	251740	000260'		        BLT     17,B+16         
BLDBPOINTC	400437'	135140	401005'	23400		LDB	3,[POINT 9,40,8]
BCAILENUUOSC	400440'	303140	000005	23500		CAILE	3,NUUOS		; OP CODES GO FROM 1-NUUOS.
BHALTC	400441'	254200	000000	23600		HALT			; IF OUTSIDE RANGE.
BLDBPOINTC	400442'	135100	401006'	23700		LDB	2,[POINT 4,40,12]
BCAIESTMUUOC	400443'	302140	000005	23800		CAIE	3,STMUUO	; STAY WITH AC FIELD IF STM.
BMOVEBC	400444'	200102	000242'	23900		MOVE	2,B(2)		; PICK UP REGISTER.
BHRRZC	400445'	550040	000040	24000		HRRZ	1,40		; GET EA.
BCAIESTMUUOC	400446'	302140	000005	24100		CAIE	3,STMUUO	; STAY WITH 'Y' FIELD IF STM.
BMOVEC	400447'	200041	000000	24200		MOVE	1,(1)		; GET STRING POINTER WORD.
BC	
BJRSTUUOTABC	400450'	254003	400450'	24400		JRST	UUOTAB-1(3)	; DO CORRECT ONE.
BUUOTABJRSTSTRG%C	400451'	254000	400052'	24500	UUOTAB:	JRST	STRG%
BJRSTSTRGA%C	400452'	254000	400056'	24600		JRST	STRGA%
BJRSTSSTR%C	400453'	254000	400062'	24700		JRST	SSTR%
BJRSTSSTRA%C	400454'	254000	400066'	24800		JRST	SSTRA%
BJRSTSTM%C	400455'	254000	400430'	24900		JRST	STM%
BC
BEXTERNSFRSFRFSFRFASFWSFWFSFWFASFPRINSFPC				25100		EXTERN	SFR,SFRF,SFRFA,SFW,SFWF,SFWFA,SFPRINT,SFP
BEXTERNSFSETPSFSZSFCLSSFCLSASFOPNSFOPNAC				25200		EXTERN	SFSETP,SFSZ,SFCLS,SFCLSALL,SFOPN,SFOPNA
BEXTERNSFOIOIOINITIOSAVEIORESTINTELDLIBINT	SFO LIBRARY INTERFACE ROUTINES	MACRO 46-7 11:20 12-JUN-73 PAGE 1-10
LIBINT.MAC	11-JUN-73 14:39	

BC				25300		EXTERN	SFOIO,IOINIT,IOSAVE,IORESTORE,INTEL
BEXTERNRLELDBELCMPELLGCELSTRELINTELAC				25400		EXTERN	RLEL,DBEL,CMPEL,LGCEL,STREL,INTELA
BEXTERNRLELADBELACMPELALGCELASTRELASFEOLC				25500		EXTERN	RLELA,DBELA,CMPELA,LGCELA,STRELA,SFEOL
BEXTERNSFOPNSFOPNASFCLSSFCLSAIOSAVEIORESTC				25600		EXTERN	SFOPN,SFOPNA,SFCLS,SFCLSALL,IOSAVE,IORESTORE
BEXTERNSTRNGSTRNGASSTORSSTORASESTRTSUBSTRC				25700		EXTERN	STRNG,STRNGA,SSTOR,SSTORA,SESTRT,SUBSTR
BEXTERNSMAXSMINSKPSNSKPSESKPSLSKPSGSKPSLEC				25800		EXTERN	SMAX,SMIN,SKPSN,SKPSE,SKPSL,SKPSG,SKPSLE
BEXTERNDATECHARASCSREMOVSFIVALSFVALSFDVALSFCVALSFSTRC				25900		EXTERN	DATE,CHAR,ASC,SREMOVE,SFIVAL,SFVAL,SFDVAL,SFCVAL,SFSTR
BEXTERNSKPSGESTRINTINDEXLENGTHLEFTRIGHTC				26000		EXTERN	SKPSGE,STRINT,INDEX,LENGTH,LEFT,RIGHT
BEXTERNERRLABERRVARBUFCNTEOFLAB.JB41STMC				26100		EXTERN	ERRLAB,ERRVAR,BUFCNT,EOFLAB,.JB41,STM
BC
BC	
BOPEN%SSAVEMSAVEMC	400456'			26400	OPEN%::	SSAVEM	^	SAVEM^
BMOVEMBC	400456'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400457'	201740	000242'		        MOVEI   17,B            
BBLTBC	400460'	251740	000260'		        BLT     17,B+16         
BMOVEIWDSTCLC	400461'	201040	000021			MOVEI	1,WDSTCLR	
BCLEARMOPNPRMC	400462'	402001	000265'			CLEARM	OPNPRM(1)
BSOJGEC	400463'	365040	400462'			SOJGE	1,.-1
BJSPIOPARMC	400464'	265740	400010'	26500		JSP   17,IOPARM			; GET UNIT, END/ERR,#ARGS-3,ADJ. L
BSKIPNARGNC	400465'	336000	000264'	26600		SKIPN	ARGN		; IF # REMAINING ARGS=0,SKIP.
BJRSTCALL2C	400466'	254000	400527'	26700		JRST	CALL2		; ELSE CALL SFOPNA.
BC	
BOPEN1C	400467'			26900	OPEN1:				; SET UP REMAINING PARAMETERS.
BLDBPOINTLC	400467'	135300	401007'	27000		LDB	6,[POINT 5,(L),8]
BMOVELC	400470'	200056	000000	27100		MOVE	1,(L)		; GET ARGUMENT BLOCK WORD.
BMOVEMOPNPRMC	400471'	202046	000265'	27200		MOVEM	1,OPNPRM(6)
BAOSLC	400472'	350000	000016	27300		AOS	L		; SET APPROPRIATE WORD, INC L,
BSOSLEARGNC	400473'	373000	000264'	27400		SOSLE	ARGN		; PROCESS ANY REMAINING
BJRSTOPEN1C	400474'	254000	400467'	27500		JRST	OPEN1		; ARGUMENTS.
BC	
BWORDC				27700		WORD	AXS		; REPLACE THESE WORDS
BHRRZAXSC	400475'	550040	000266'			HRRZ	1,AXS				
BMOVEC	400476'	200041	000000			MOVE	1,(1)		
BMOVEMAXSC	400477'	202040	000266'			MOVEM	1,AXS		
BWORDHRRZBFCNTC	400500'	550040	000270'	27800		WORD(BFCNT)^	HRRZ	1,BFCNT		
BMOVEC	400501'	200041	000000			MOVE	1,(1)		
BMOVEMBFCNTC	400502'	202040	000270'			MOVEM	1,BFCNT
BWORDHRRZMODEC	400503'	550040	000276'	27900		WORD(MODE)^	HRRZ	1,MODE		
BMOVEC	400504'	200041	000000			MOVE	1,(1)		
BMOVEMMODEC	400505'	202040	000276'			MOVEM	1,MODE
BWORDHRRZRECSIZC	400506'	550040	000300'	28000		WORD(RECSIZ)^	HRRZ	1,RECSIZ		
BMOVEC	400507'	200041	000000			MOVE	1,(1)		
BMOVEMRECSIZC	400510'	202040	000300'			MOVEM	1,RECSIZ
BC	
BLDBPOINTFNAMEC	400511'	135040	401010'	28200		LDB	1,[POINT 4,FNAME,12]
BCAIETYP.STC	400512'	302040	000015	28300		CAIE	1,TYP.STR		; IF FILENAME IS TYPE STRING,
BJRSTCALL2C	400513'	254000	400527'	28400		JRST	CALL2		; SKIP,ELSE PROCEED.
BC	
BCALL1C	400514'			28600	CALL1:				; CALL SFOPN AFTER PLACING 
BJSPSESTRTC	400514'	265740	400075*	28700		JSP	17,SESTRT	;FILE ID ON STRING STACK.
BMOVEFNAMEC	400515'	200040	000272'	28800		MOVE	1,FNAME		; GET ADDR OF STRNG POINTER WORD.
BJSPSTRNGC	400516'	265740	400052*	28900		JSP	17,STRNG	; STACK IT.
BMOVEUNITC	400517'	200040	000263'	29000		MOVE	1,UNIT		; SET UP FOR CALL.
BMOVEAXSDLIBINT	SFO LIBRARY INTERFACE ROUTINES	MACRO 46-7 11:20 12-JUN-73 PAGE 1-11
LIBINT.MAC	11-JUN-73 14:39	

BC	400520'	200100	000266'	29100		MOVE	2,AXS
BADDMODEC	400521'	270100	000276'	29200		ADD	2,MODE
BMOVERECSIZC	400522'	200140	000300'	29300		MOVE	3,RECSIZ
BJSPSFOPNC	400523'	265740	000000*	29400		JSP	17,SFOPN
BRSTOREHRLZIBC	400524'	515740	000242'	29500		RSTOREM	^	HRLZI	17,B
BBLTC	400525'	251740	000017			BLT	17,17
BPOPJC	400526'	263740	000000			POPJ	17,
BC	
BCALL2C	400527'			29700	CALL2:				; SET UP AND CALL SFOPNA.
BMOVEUNITC	400527'	200040	000263'	29800		MOVE	1,UNIT
BMOVEAXSC	400530'	200200	000266'	29900		MOVE	4,AXS
BADDMODEC	400531'	270200	000276'	30000		ADD	4,MODE
BMOVERECSIZC	400532'	200240	000300'	30100		MOVE	5,RECSIZ
BMOVEIC	400533'	201140	000001	30200		MOVEI	3,1		; FNAME LITERAL SIZE - ASSUME 1 AT
BHRRZFNAMEC	400534'	550640	000272'	30300		HRRZ	15,FNAME	; FIRST. GET ADDR OF LITERAL.
BLDBPOINTC	400535'	135640	401011'	30400		LDB	15,[POINT 7,(15),34]
BSKIPEC	400536'	332000	000014	30500		SKIPE	14		; IF LOWBYTE IS NULL,LENGTH=1,
BAOSC	400537'	350000	000003	30600		AOS	3 	; ELSE 2. (WORDS)
BJSPSFOPNAC	400540'	265740	000000*	30700		JSP	17,SFOPNA
BC	
BCLOSE%SSAVEMSAVEMC	400541'			30900	CLOSE%::	SSAVEM^	SAVEM^
BMOVEMBC	400541'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400542'	201740	000242'		        MOVEI   17,B            
BBLTBC	400543'	251740	000260'		        BLT     17,B+16         
BMOVEIWDSTCLC	400544'	201040	000021			MOVEI	1,WDSTCLR	
BCLEARMOPNPRMC	400545'	402001	000265'			CLEARM	OPNPRM(1)
BSOJGEC	400546'	365040	400545'			SOJGE	1,.-1
BUERRNDC				31000		UERRND	^
BHRRZLC	400547'	550056	000001			HRRZ	1,1(L)		
BSKIPEC	400550'	332000	000001			SKIPE	1		
BMOVEMEOFLABC	400551'	202040	400022*			MOVEM	1,EOFLAB	
BHRRZLC	400552'	550056	000002			HRRZ	1,2(L)		
BSKIPEC	400553'	332000	000001			SKIPE	1		
BMOVEMERRLABC	400554'	202040	400030*			MOVEM	1,ERRLAB	
BHRRELC	400555'	570056	000000			HRRE	1,(L)		; UNIT.
BMOVEMUNITC	400556'	202040	000263'			MOVEM	1,UNIT		
BJSPSFCLSC	400557'	265740	000000*	31100		JSP	17,SFCLS	; CALL SFCLS.
BRSTOREHRLZIBC	400560'	515740	000242'	31200		RSTOREM	^	HRLZI	17,B
BBLTC	400561'	251740	000017			BLT	17,17
BPOPJC	400562'	263740	000000			POPJ	17,
BC	
BC
BRTB%SETZMV2C	400563'	402000	000000'	31500	RTB%::	SETZM	V2		; SET CODE FOR READ UNFORMATTED.
BJRSTBCOMC	400564'	254000	400566'	31600		JRST	BCOM		; GO TO COMMON CODING.
BC
BWTB%SETOMV2C	400565'	476000	000000'	31800	WTB%::	SETOM	V2		; SET CODE FOR WRITE UNFORMATTED.
BC
BBCOMSSAVEMSAVEMC	400566'			32000	BCOM:	SSAVEM^	SAVEM^
BMOVEMBC	400566'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400567'	201740	000242'		        MOVEI   17,B            
BBLTBC	400570'	251740	000260'		        BLT     17,B+16         
BMOVEIWDSTCLC	400571'	201040	000021			MOVEI	1,WDSTCLR	
BCLEARMOPNPRMC	400572'	402001	000265'			CLEARM	OPNPRM(1)
BSOJGEDLIBINT	SFO LIBRARY INTERFACE ROUTINES	MACRO 46-7 11:20 12-JUN-73 PAGE 1-12
LIBINT.MAC	11-JUN-73 14:39	

BC	400573'	365040	400572'			SOJGE	1,.-1
BJSPIOPARMC	400574'	265740	400010'	32100		JSP	17,IOPARM	; UNIT,END=,ERR=.
BMOVEUNITC	400575'	200040	000263'	32200		MOVE	1,UNIT		; ARG.
BMOVMV2C	400576'	214200	000000'	32300		MOVM	4,V2		; GET READ/WRITE CODE.
BJSPBRWC	400577'	265764	400722'	32400		JSP	17,@BRW(4)	; CALL THE ROUTINE.
BRSTOREHRLZIBC	400600'	515740	000242'	32500		RSTOREM	^	HRLZI	17,B
BBLTC	400601'	251740	000017			BLT	17,17
BPOPJC	400602'	263740	000000			POPJ	17,
BC
BC	
BIN%SETZMV2C	400603'	402000	000000'	32800	IN%::	SETZM	V2		; SET CODE FOR 'IN' (0).
BJRSTIOCC	400604'	254000	400606'	32900		JRST	IOC		; GO TO COMMON CODINE.
BC
BOUT%SETOMV2C	400605'	476000	000000'	33100	OUT%::	SETOM	V2		; SET CODE FOR 'OUT' (-1).
BC
BIOCSSAVEMSAVEMC	400606'			33300	IOC:	SSAVEM	^	SAVEM^
BMOVEMBC	400606'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400607'	201740	000242'		        MOVEI   17,B            
BBLTBC	400610'	251740	000260'		        BLT     17,B+16         
BMOVEIWDSTCLC	400611'	201040	000021			MOVEI	1,WDSTCLR	
BCLEARMOPNPRMC	400612'	402001	000265'			CLEARM	OPNPRM(1)
BSOJGEC	400613'	365040	400612'			SOJGE	1,.-1
BJSPIOPARMC	400614'	265740	400010'	33400		JSP	17,IOPARM	; GET UNIT, END=, ERR=.
BSTRFMTC				33500		STRFMT	^
BCLEARMZ1C	400615'	402000	000001'			CLEARM	Z1		
BLDBPOINTLC	400616'	135100	401012'			LDB	2,[POINT 4,(L),12]  
BCAIETYP.STC	400617'	302100	000015			CAIE	2,TYP.STR	
BJRSTC	400620'	254000	400625'			JRST	.+5		
BJSPSESTRTC	400621'	265740	400514*			JSP	17,SESTRT	
BHRRZLC	400622'	550056	000000			HRRZ	1,(L)		
BJSPSTRNGC	400623'	265740	400516*			JSP	17,STRNG	
BJRSTC	400624'	254000	400630'			JRST	.+4		
BHRRZLC	400625'	550116	000000			HRRZ	2,(L)		
BHRRZLC	400626'	550156	000001			HRRZ	3,1(L)		
BAOSZ1C	400627'	350000	000001'			AOS	Z1		
BMOVEUNITC	400630'	200040	000263'			MOVE	1,UNIT		
BMOVEZ1C	400631'	200200	000001'			MOVE	4,Z1		
BMOVMV2C	400632'	214240	000000'	33600		MOVM	5,V2		; 0 OR 1,DEPENDING.
BADDC	400633'	270240	000005	33700		ADD	5,5		; DOUBLE IT.
BADDC	400634'	270200	000005	33800		ADD	4,5		; + STRING/FORMAT CODE.
BJSPRWCALLC	400635'	265764	400716'	33900		JSP	17,@RWCALL(4)	; CALL THE APPROPRIATE ROUTINE.
BRSTOREHRLZIBC	400636'	515740	000242'	34000		RSTOREM^	HRLZI	17,B
BBLTC	400637'	251740	000017			BLT	17,17
BPOPJC	400640'	263740	000000			POPJ	17,
BC
BC	
BFIN%SSAVEMSAVEMC	400641'			34300	FIN%::	SSAVEM	^	SAVEM^
BMOVEMBC	400641'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400642'	201740	000242'		        MOVEI   17,B            
BBLTBC	400643'	251740	000260'		        BLT     17,B+16         
BMOVEIWDSTCLC	400644'	201040	000021			MOVEI	1,WDSTCLR	
BCLEARMOPNPRMC	400645'	402001	000265'			CLEARM	OPNPRM(1)
BSOJGEC	400646'	365040	400645'			SOJGE	1,.-1
LIBINT	SFO LIBRARY INTERFACE ROUTINES	MACRO 46-7 11:20 12-JUN-73 PAGE 1-13
LIBINT.MAC	11-JUN-73 14:39	

BOTSFINJSPSFEOLC	400647'	265740	000000*	34400	OTSFIN:	JSP	17,SFEOL
BRSTOREHRLZIBC	400650'	515740	000242'	34500		RSTOREM^	HRLZI	17,B
BBLTC	400651'	251740	000017			BLT	17,17
BPOPJC	400652'	263740	000000			POPJ	17,
BC	
BC	
BIOLST%C	400653'			34800	IOLST%::				; I/O LIST THING.
BSSAVEMSAVEMC				34900		SSAVEM^	SAVEM^
BMOVEMBC	400653'	202740	000261'		        MOVEM   17,B+17         
BMOVEIBC	400654'	201740	000242'		        MOVEI   17,B            
BBLTBC	400655'	251740	000260'		        BLT     17,B+16         
BMOVEIWDSTCLC	400656'	201040	000021			MOVEI	1,WDSTCLR	
BCLEARMOPNPRMC	400657'	402001	000265'			CLEARM	OPNPRM(1)
BSOJGEC	400660'	365040	400657'			SOJGE	1,.-1
BCKAGINLDBPOINTLC	400661'	135100	401007'	35000	CKAGIN:	LDB	2,[POINT 5,(L),8]		; CLASS.
BLDBPOINTLC	400662'	135140	401012'	35100		LDB	3,[POINT 4,(L),12]		; TYPE.
BJRSTC	400663'	254002	400664'	35200	JRST	.+1(2)			; PROCESS APPROPRIATE DATA CLASS.
BJRSTOTSZERC	400664'	254000	400712'	35300		JRST	OTSZERO		; NOT IN.
BJRSTOTSDATC	400665'	254000	400671'	35400		JRST	OTSDATA		; SINGLE DATA ITEM.
BJRSTOTSSLIC	400666'	254000	400700'	35500		JRST	OTSSLIST	; MULTIPLE.
BJRSTOTSELIC	400667'	254000	400715'	35600		JRST	OTSELIST	; NOT IN.
BJRSTOTSFINC	400670'	254000	400647'	35700		JRST	OTSFIN		; END OF I/O LIST.
BC	
BOTSDATC	400671'			35900	OTSDATA:			; DATA ITEM, GET TYPE AND CALL
BJSPGETWDC	400671'	265500	400765'	36000		JSP	12,GETWD	; GET ARG ADDR UNLESS STRING.
BCAINTYP.STC	400672'	306140	000015	36050		CAIN	3,TYP.STR	; IF STRING,GET POINTER.
BMOVEC	400673'	200041	000000	36100		MOVE	1,(1)		;
BMOVEMLLSAVEC	400674'	202700	000262'	36200		MOVEM	L,LSAVE		; APPROPRIATE ROUTINE.
BJSPDTATC	400675'	265763	400724'	36300		JSP	17,@DTAT(3)
BAOSLLSAVEC	400676'	350700	000262'	36400		AOS	L,LSAVE
BJRSTCKAGINC	400677'	254000	400661'	36500		JRST	CKAGIN		; INC FOR NXT ELEMENT, CHECK AGAIN.
BC	
BOTSSLIC	400700'			36700	OTSSLIST:			; 
BLDBPOINTLC	400700'	135140	401013'	36750		LDB	3,[POINT 4,2(L),12]  ; FOR ARRAY,MUST GET TYPEFROM DIFFERENT WORD.
BMOVELC	400701'	200056	000002	36800		MOVE	1,2(L)		; ADDR OF ARRAY, UNLESS STRING.
BCAINTYP.STC	400702'	306140	000015	36900		CAIN	3,TYP.STR	; IF STRING,
BMOVEC	400703'	200041	000000	37000		MOVE	1,(1)		; GET POINTER.
BHRRZLC	400704'	550116	000000	37100		HRRZ	2,(L)		; GET COUNT AS 2'ND ARGUMENT.
BMOVEMLLSAVEC	400705'	202700	000262'	37200		MOVEM	L,LSAVE
BJSPDTATAC	400706'	265763	400742'	37300		JSP	17,@DTATA(3)
BMOVELLSAVEC	400707'	200700	000262'	37400		MOVE	L,LSAVE
BADDILC	400710'	271700	000003	37500		ADDI	L,3		; FOR NEXT ITEM IN ARG. BLOCK.
BJRSTCKAGINC	400711'	254000	400661'	37600		JRST	CKAGIN
BC	
BOTSZERRSTOREHRLZIBC	400712'	515740	000242'	37800	OTSZERO:	RSTOREM^	HRLZI	17,B
BBLTC	400713'	251740	000017			BLT	17,17
BPOPJC	400714'	263740	000000			POPJ	17,
BOTSELIHALTC	400715'	254200	000000	37900	OTSELIST:	HALT
BC	
BRWCALLEXPSFRFSFRFASFWFSFWFAC	400716'	000000	000000*	38100	RWCALL:	EXP	SFRF,SFRFA,SFWF,SFWFA
	400717'	000000	000000*
	400720'	000000	000000*
	400721'	000000	000000*
BBRWEXPSFRSFWDLIBINT	SFO LIBRARY INTERFACE ROUTINES	MACRO 46-7 11:20 12-JUN-73 PAGE 1-14
LIBINT.MAC	11-JUN-73 14:39	

BC	400722'	000000	000000*	38200	BRW:	EXP	SFR,SFW		; UNFORMATTED READ,WRITE.
	400723'	000000	000000*
BDTATEXPINTELHHHRLELHHHDBELHHHCMPELSTRELC	400724'	000000	000000*	38300	DTAT:	EXP	INTEL,H,H,H,RLEL,H,H,H,DBEL,H,H,H,CMPEL,STREL
	400725'	000000	400760'
	400726'	000000	400760'
	400727'	000000	400760'
	400730'	000000	000000*
	400731'	000000	400760'
	400732'	000000	400760'
	400733'	000000	400760'
	400734'	000000	000000*
	400735'	000000	400760'
	400736'	000000	400760'
	400737'	000000	400760'
	400740'	000000	000000*
	400741'	000000	000000*
BDTATAEXPINTELAHHHRLELAHHHDBELAHHHCMPELASTRELAC	400742'	000000	000000*	38400	DTATA:	EXP	INTELA,H,H,H,RLELA,H,H,H,DBELA,H,H,H,CMPELA,STRELA
	400743'	000000	400760'
	400744'	000000	400760'
	400745'	000000	400760'
	400746'	000000	000000*
	400747'	000000	400760'
	400750'	000000	400760'
	400751'	000000	400760'
	400752'	000000	000000*
	400753'	000000	400760'
	400754'	000000	400760'
	400755'	000000	400760'
	400756'	000000	000000*
	400757'	000000	000000*
BHHALTC	400760'	254200	000000	38500	H:	HALT
BC
BGETWDIC	400761'			38700	GETWDI:	; GETWD, BUT FOR IMMEDIATE MODE THINGYS.
BLDBPOINTLC	400761'	135540	401014'	38800		LDB	13,[POINT 5,(L),17] ; I AND X FIELDS.
BHRRELC	400762'	570656	000000	38900		HRRE	15,(L)		; RGHT HALF.
BMOVEC	400763'	200040	000015	39000		MOVE	1,15
BJUMPEC	400764'	322552	000000	39100		JUMPE	13,(12)	; RETURN IF I AND X FIELDS ZERO.
BC				39200				; ELSE FALL THROUGH INTO GETWD.
BGETWDC	400765'			39300	GETWD:	; CALLED BY JSP 12,GETWD. RETURNS IN REG 1 THE
BC				39400	;	RIGHT HALF OF (16). IF THE INDEX-REG FIELD AND/OR THE
BC				39500	;	INDIRECT FIELD IS ON IN (16), RETURNS IN REG 1 THE
BC				39600	;	EFFECTIVE ADDRESS, AND, IN AC 15 (OCTAL), THE CONTENTS
BC				39700	;	OF THE STORAGE WORD POINTEG TO BY AC1.
BLDBPOINTLC	400765'	135540	401015'	39800		LDB	13,[POINT 4,(L),17] ;GET X-FIELD.
BHRRELC	400766'	570656	000000	39900		HRRE	15,(L)	; RIGHT HALF,EXTEND.
BCLEARMC	400767'	402000	000001	40000		CLEARM	1	; AC1 ZERO.
BJUMPEGW1C	400770'	322540	400773'	40100		JUMPE	13,GW1	; GO AROUNG IF NO XREG.
BCAIGC	400771'	307540	000017	40200		CAIG	13,17	;ELSE GET ADDR OF USER'S AC IN AC1.
BHRREBC	400772'	570053	000242'	40300		HRRE	1,B(13)	; WOOPS, I MEAN CONTENTS OF USERS XREG.
BGW1ADDC	400773'	270040	000015	40400	GW1:	ADD	1,15	; (XREG)+Y FIELD.
BCAIGC	400774'	307040	000017	40500		CAIG	1,17	; MEM ADDR A REG????
BMOVEIBC	400775'	201041	000242'	40600		MOVEI	1,B(1)	; YES -- GET ADDR OF USER'S REGISTER.
BGW2MOVEC	400776'	200640	000001	40700	GW2:	MOVE	15,1	; COPY INTO AC15.
BLDBPOINTLDLIBINT	SFO LIBRARY INTERFACE ROUTINES	MACRO 46-7 11:20 12-JUN-73 PAGE 1-15
LIBINT.MAC	11-JUN-73 14:39	

BC	400777'	135540	401016'	40800		LDB	13,[POINT 1,(L),13] ; I FIELD.
BSKIPEC	401000'	332000	000013	40900		SKIPE	13	; NO INDIRECT, IGN.
BMOVEC	401001'	200655	000000	41000		MOVE	15,(15)	; INDIRECT -- GET WORD IN AC15.
BJRSTC	401002'	254012	000000	41100		JRST	(12)	; GO,GO, FORTRAN!!!!!!
BC	
BRELOCC	000000'			41300		RELOC
BC
BV2ZC	000000'	000000	000000	41500	V2:	Z
BZ1ZC	000001'	000000	000000	41600	Z1:     Z               ; SKIP FLAG FOR STRING RELATIONALS.
BSTAKBLOCKSTKSZC	000002'			41700	STAK:	BLOCK	STKSZ
BBBLOCKC	000242'			41800	B:      BLOCK   20              ; REGISTER SAVE AREA.
BLSAVEZC	000262'	000000	000000	41900	LSAVE:	Z
BUNITZC	000263'	000000	000000	42000	UNIT:	Z
BARGNZC	000264'	000000	000000	42100	ARGN:	Z
BOPNPRMC	000265'			42200	OPNPRM:		; DEFN'S FROM HERE THRU 'ASSOC' MUST STAY IN ORDER.
BDIALOGZC	000265'	000000	000000	42300	DIALOG:	Z
BAXSZC	000266'	000000	000000	42400	AXS:	Z
BDVCZC	000267'	000000	000000	42500	DVC:	Z
BBFCNTZC	000270'	000000	000000	42600	BFCNT:	Z
BBKSIZZC	000271'	000000	000000	42700	BKSIZ:	Z
BFNAMEZC	000272'	000000	000000	42800	FNAME:	Z
BPROTZC	000273'	000000	000000	42900	PROT:	Z
BDIRECZC	000274'	000000	000000	43000	DIREC:	Z
BLIMITZC	000275'	000000	000000	43100	LIMIT:	Z
BMODEZC	000276'	000000	000000	43200	MODE:	Z
BFSIZEZC	000277'	000000	000000	43300	FSIZE:	Z
BRECSIZZC	000300'	000000	000000	43400	RECSIZ:	Z
BDISPOSZC	000301'	000000	000000	43500	DISPOS:	Z
BVERZC	000302'	000000	000000	43600	VER:	Z
BREELSZC	000303'	000000	000000	43700	REELS:	Z
BMNTZC	000304'	000000	000000	43800	MNT:	Z
BERRZC	000305'	000000	000000	43900	ERR:	Z
BASSOCZC	000306'	000000	000000	44000	ASSOC:	Z
BC
BASSOCOPNPRMWDSTCLC			000021	44200	WDSTCLR=	ASSOC-OPNPRM
BC
BRELOCC	401003'			44400		RELOC
BENDINIT%C			400000'	44500		END	INIT%
BLIBINT	SFO LIBRARY INTERFACE ROUTINES	MACRO 46-7 11:20 12-JUN-73
LIBINT.MAC	11-JUN-73 14:39		C
NO ERRORS DETECTED
HI-SEG. BREAK IS 401017
LO-SEG. BREAK IS 000307
3K CORE USED
LIBINT	SFO LIBRARY INTERFACE ROUTINES	MACRO 46-7 11:20 12-JUN-73 PAGE 2
LIBINT.MAC	11-JUN-73 14:39		SYMBOL TABLE

AR1		400415'		IOP1		400023'		SFP		000000	EXT	UNIT		000263'	
AR2		400424'		IOP2		400031'		SFPRIN		400427'	EXT	UUO		400434'	
ARGN		000264'		IOPARM		400010'		SFR		400722'	EXT	UUOTAB		400451'	
ARGS		400411'		IOREST		000000	EXT	SFRF		400716'	EXT	V2		000000'	
ASC		400275'	EXT	IOSAVE		000000	EXT	SFRFA		400717'	EXT	VAL%		400323'	INT
ASSOC		000306'		IVAL%		400312'	INT	SFSETP		000000	EXT	VER		000302'	
AXS		000266'		L		000016		SFSTR		400363'	EXT	WDSTCL		000021	
B		000242'		LEFT		400373'	EXT	SFSZ		000000	EXT	WTB%		400565'	INT
BCOM		400566'		LENGTH		400137'	EXT	SFVAL		400327'	EXT	Z1		000001'	
BFCNT		000270'		LGCEL		000000	EXT	SFW		400723'	EXT	.JB41		400004'	EXT
BKSIZ		000271'		LGCELA		000000	EXT	SFWF		400720'	EXT	
BRW		400722'		LIMIT		000275'		SFWFA		400721'	EXT	
BUFCNT		000000	EXT	LNGTH%		400134'	INT	SKPSE		400160'	EXT	
CALL1		400514'		LSAVE		000262'		SKPSG		400230'	EXT	
CALL2		400527'		MNT		000304'		SKPSGE		400242'	EXT	
CHAR		400255'	EXT	MODE		000276'		SKPSL		400204'	EXT	
CKAGIN		400661'		NUUOS		000005		SKPSLE		400216'	EXT	
CLOSE%		400541'	INT	OFINT		400045'	EXT	SKPSN		400172'	EXT	
CMPEL		400740'	EXT	OFINT%		400042'	INT	SKSE%		400155'	INT	
CMPELA		400756'	EXT	ONINT		400036'	EXT	SKSG%		400225'	INT	
CVAL%		400345'	INT	ONINT%		400032'	INT	SKSGE%		400237'	INT	
DATE		400265'	EXT	OPEN%		400456'	INT	SKSL%		400201'	INT	
DBEL		400734'	EXT	OPEN1		400467'		SKSLE%		400213'	INT	
DBELA		400752'	EXT	OPNPRM		000265'		SKSN%		400167'	INT	
DBG		400002'	EXT	OTSDAT		400671'		SLFT%		400367'	INT	
DIALOG		000265'		OTSELI		400715'		SMAX		400116'	EXT	
DIREC		000274'		OTSFIN		400647'		SMAX%		400112'	INT	
DISPOS		000301'		OTSSLI		400700'		SMIN		400127'	EXT	
DTAT		400724'		OTSZER		400712'		SMIN%		400123'	INT	
DTATA		400742'		OUT%		400605'	INT	SPNT%		400427'	INT	
DVAL%		400334'	INT	PROT		000273'		SREMOV		400305'	EXT	
DVC		000267'		RECSIZ		000300'		SRGHT%		400400'	INT	
EOFLAB		400551'	EXT	REELS		000303'		SRMOV%		400302'	INT	
ERR		000305'		RIGHT		400404'	EXT	SSTOR		400062'	EXT	
ERRLAB		400554'	EXT	RLEL		400730'	EXT	SSTORA		400066'	EXT	
ERRVAR		000000	EXT	RLELA		400746'	EXT	SSTR%		400062'	INT	
FIN%		400641'	INT	RTB%		400563'	INT	SSTRA%		400066'	INT	
FNAME		000272'		RWCALL		400716'		STAK		000002'		
FSIZE		000277'		SASC%		400272'	INT	STKSZ		000240		
GETWD		400765'		SBST%		400101'	INT	STM		400430'	EXT	
GETWDI		400761'		SCHAR%		400251'	INT	STM%		400430'	INT	
GW1		400773'		SDATE%		400262'	INT	STMUUO		000005		
GW2		400776'		SEST%		400072'	INT	STR%		400356'	INT	
H		400760'		SESTRT		400621'	EXT	STREL		400741'	EXT	
IN%		400603'	INT	SFCLS		400557'	EXT	STRELA		400757'	EXT	
INDEX		400150'	EXT	SFCLSA		000000	EXT	STRG%		400052'	INT	
INDX%		400144'	INT	SFCVAL		400351'	EXT	STRGA%		400056'	INT	
INIT%		400000'	INT	SFDVAL		400340'	EXT	STRINT		000000	EXT	
INTEL		400724'	EXT	SFEOL		400647'	EXT	STRNG		400623'	EXT	
INTELA		400742'	EXT	SFIVAL		400316'	EXT	STRNGA		400056'	EXT	
IOC		400606'		SFOIO		400000'	EXT	SUBSTR		400105'	EXT	
IOINIT		400001'	EXT	SFOPN		400523'	EXT	TYP.ST		000015		
IOLST%		400653'	INT	SFOPNA		400540'	EXT	
  y@
*e