IDENTIFICATION DIVISION.
ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT DOUT1, ASSIGN TO DSK.
    SELECT TEMP, ASSIGN TO DSK, DSK, DSK.
    SELECT RAW, ASSIGN TO DSK
     RECORDING MODE IS ASCII.
DATA DIVISION.
FILE SECTION.
FD RAW, VALUE OF IDENTIFICATION IS 'HW1RAWDAT'.
01 RAWCARD.
    02 NAME, PIC X(9).
    02 TITLE, PIC X(1).
    02 REVENUE, PIC 9(6).
SD TEMP.
01 SORTRECORD.
    02 S-NAME, PIC X(9).
    02 S-TITLE, PIC X(1).
    02 FILLER, PIC X(6).
FD DOUT1, VALUE OF IDENTIFICATION IS 'DOUT1 REP'.
01 REPORTRECORD.
    02 TITLEREP, PIC X(6).
    02 NAMEREP, PIC X(11).
    02 REVENUE-R, PIC Z(6).
    02 R-XTRA, PIC X(3).
01 HEADER, PIC X(26).
01 HEADER1 PIC X(1).
WORKING-STORAGE SECTION.
01 STOREREC.
    02 SNAME, PIC X(9).
    02 STITLE, PIC X(1).
    02 SREV, PIC X(6).
PROCEDURE DIVISION.
MAIN SECTION.
BEGIN.
    SORT TEMP ON ASCENDING KEY S-TITLE, S-NAME OF SORTRECORD, USING
     RAW, OUTPUT PROCEDURE MAKE-REPORT.
MAKE-REPORT SECTION.
INIT.
    OPEN OUTPUT DOUT1.
    MOVE ' ' TO HEADER1.
    WRITE HEADER1 BEFORE ADVANCING 5 LINES.
    MOVE 'TITLE NAME         REVENUE' TO HEADER.
    WRITE HEADER BEFORE ADVANCING 2 LINES.
    MOVE '.00' TO R-XTRA.
LOOP.
    RETURN TEMP INTO STOREREC, AT END GO TO FINISH.
    MOVE SNAME TO NAMEREP.
    MOVE STITLE TO TITLEREP.
    MOVE SREV TO REVENUE-R.
    WRITE REPORTRECORD.
    GO TO LOOP.
FINISH.
    CLOSE DOUT1.
    STOP RUN.
