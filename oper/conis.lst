    P R O G R A M   C O N I S 		COBOL (005001,107000)	31-MAY-73  07:23		PAGE 1
    CONIS.CBL    31-MAY-73  07:23

    0001    IDENTIFICATION DIVISION.
    0002    PROGRAM-ID. CONIS.
    0003    AUTHOR. BILL CONIS.
    0004    INSTALLATION. TYMSHARE.
    0005    DATE-WRITTEN. APRIL 20,1973.
    0006    DATE-COMPILED. 31-MAY-73. 
    0007    SECURITY. NONE.
    0008    REMARKS. DEMO PROGRAM.
    0009    ENVIRONMENT DIVISION.
    0010    CONFIGURATION SECTION.
    0011    SOURCE-COMPUTER. DECsystem-10. 
    0012    OBJECT-COMPUTER. PDP-10.
    0013    INPUT-OUTPUT SECTION.
    0014    FILE-CONTROL.
    0015           SELECT DATAFILE ASSIGN TO DSK
    0016           RECORDING MODE IS ASCII.
    0017           SELECT OUTFILE ASSIGN TO TEL
    0018           RECORDING MODE IS ASCII.
    0019    DATA DIVISION.
    0020    FILE SECTION.
    0021    FD DATAFILE
    0022           LABEL RECORDS ARE STANDARD
    0023           VALUE OF IDENTIFICATION IS "DATAF    ".
    0024    01 DATAREC.
    0025                      05 COMP-IX PIC 9(6).
    0026                      05 STOR-IX PIC 9(5).
    0027                      05 COMP-X PIC 9(5).
    0028                      05 STOR-X PIC 9(4).
    0029                      05 PRODUCTS PIC 9(5).
    0030                      05 IX-GROWTH PIC V99.
    0031                      05 X-GROWTH PIC V99.
    0032                      05 PR-GROWTH PIC VP9.
    0033    FD OUTFILE
    0034            VALUE OF IDENTIFICATION IS "REPORTDAT".
    0035    01 OUTREC.
    0036                      05 MARGIN PIC X(22).
    0037                      05 Q1 PIC $(11).
    0038                      05 Q1R REDEFINES Q1 PIC Z(11).
    0039                      05 Q1RR REDEFINES Q1 PIC X(11).
    0040                      05 APRIL PIC $(11).
    0041                      05 APRILR REDEFINES APRIL PIC Z(11).
    0042                      05 APRILRR REDEFINES APRIL PIC X(11).
    0043                      05 MAY PIC $(11).
    0044                      05 MAYR REDEFINES MAY PIC Z(11).
    0045                      05 MAYRR REDEFINES MAY PIC X(11).
    0046                      05 JUNE PIC $(11).
    0047                      05 JUNER REDEFINES JUNE PIC Z(11).
    0048                      05 JUNERR REDEFINES JUNE PIC X(11).
    0049    WORKING-STORAGE SECTION.
    0050    77 QTRREV PIC 9(11) VALUE ZEROES.
    0051    77 APRILREV PIC 9(11) VALUE ZEROES.
    0052    77 MAYREV PIC 9(11) VALUE ZEROES.
    0053    77 JUNEREV PIC 9(11) VALUE ZEROES.
    0054    77 TOTAL-QTR PIC 9(11) VALUE ZEROES.
    0055    77 TOTAL-APRIL PIC 9(11) VALUE ZEROES.
    0056    77 TOTAL-MAY PIC 9(11) VALUE ZEROES.    P R O G R A M   C O N I S 		COBOL (005001,107000)	31-MAY-73  07:23		PAGE 1-1
    CONIS.CBL    31-MAY-73  07:23

    0057    77 TOTAL-JUNE PIC 9(11) VALUE ZEROES.
    0058    77 GRAND-TOTAL-QTR PIC 9(11) VALUE ZEROES.
    0059    77 GRAND-TOTAL-APRIL PIC 9(11) VALUE ZEROES.
    0060    77 GRAND-TOTAL-MAY PIC 9(11) VALUE ZEROES.
    0061    77 GRAND-TOTAL-JUNE PIC 9(11) VALUE ZEROES.
    0062    77 COUNT PIC 9 VALUE ZEROES.
    0063    77 PERCENT PIC V99.
    0064    01  HEADING-1.
    0065            05 FILLER PIC X(29) VALUE SPACES.
    0066            05 FILLER PIC X(12) VALUE 'TYMSHARE INC'.
    0067            05 FILLER PIC X(25) VALUE SPACES.
    0068    01  HEADING-2.
    0069            05 FILLER PIC X(26) VALUE SPACES.
    0070            05 FILLER PIC X(17) VALUE 'NEW YORK DISTRICT'.
    0071            05 FILLER PIC X(23) VALUE SPACES.
    0072    01  HEADING-3.
    0073            05 FILLER PIC X(28) VALUE SPACES.
    0074            05 FILLER PIC X(14) VALUE IS 'EASTERN REGION'.
    0075            05 FILLER PIC X(24) VALUE SPACES.
    0076    01  HEADING-4.
    0077            05 FILLER PIC X(22) VALUE SPACES.
    0078            05 FILLER PIC X(22) VALUE '1ST QUARTER      APRIL'.
    0079            05 FILLER PIC X(22) VALUE '        MAY       JUNE'.
    0080    PROCEDURE DIVISION.
    0081    HSE-KEEP.
    0082            OPEN INPUT DATAFILE.
    0083            OPEN OUTPUT OUTFILE.
    0084    WRITE-HEADINGS.
    0085            WRITE OUTREC FROM HEADING-1.
    0086            WRITE OUTREC FROM HEADING-2.
    0087            WRITE OUTREC FROM HEADING-3 BEFORE ADVANCING 3 LINES.
    0088            WRITE OUTREC FROM HEADING-4 BEFORE ADVANCING 2 LINES.
    0089    READ-DATA.
    0090           READ DATAFILE RECORD AT END GO TO EOJ.
    0091    SET-UP.
    0092           ADD 1 TO COUNT.
    0093           IF COUNT IS EQUAL TO 1 MOVE COMP-IX TO QTRREV, MOVE
    0094           IX-GROWTH TO PERCENT, MOVE 'TYMCOM IX COMPUTE     ' TO 
    0095           MARGIN, GO TO PROCESSING.
    0096           IF COUNT IS EQUAL TO 2 MOVE STOR-IX TO QTRREV, MOVE
    0097           'TYMCOM IX STORAGE     ' TO MARGIN, GO TO PROCESSING.
    0098           IF COUNT IS EQUAL TO 3 MOVE COMP-X TO QTRREV, MOVE
    0099           X-GROWTH TO PERCENT, MOVE 'TYMCOM X COMPUTE      ' TO
    0100           MARGIN, GO TO PROCESSING.
    0101           IF COUNT IS EQUAL TO 4 MOVE STOR-X TO QTRREV, MOVE
    0102           'TYMCOM X STORAGE      ' TO MARGIN, GO TO PROCESSING.
    0103           IF COUNT IS EQUAL TO 5 MOVE PRODUCTS TO QTRREV, MOVE
    0104           PR-GROWTH TO PERCENT, MOVE 'PRODUCTS              ' TO
    0105           MARGIN, GO TO PROCESSING.
    0106           GO TO PROCESSING.
    0107    PROCESSING.
    0108           COMPUTE APRILREV ROUNDED = (QTRREV / 3) * PERCENT+(QTRREV / 3).
    0109           COMPUTE MAYREV ROUNDED = APRILREV * PERCENT + APRILREV.
    0110           COMPUTE JUNEREV ROUNDED = MAYREV * PERCENT + MAYREV.
    0111           ADD QTRREV TO TOTAL-QTR.
    0112           ADD QTRREV TO GRAND-TOTAL-QTR.    P R O G R A M   C O N I S 		COBOL (005001,107000)	31-MAY-73  07:23		PAGE 1-2
    CONIS.CBL    31-MAY-73  07:23

    0113           ADD APRILREV TO TOTAL-APRIL.
    0114           ADD APRILREV TO GRAND-TOTAL-APRIL.
    0115           ADD MAYREV TO TOTAL-MAY.
    0116           ADD MAYREV TO GRAND-TOTAL-MAY.
    0117           ADD JUNEREV TO TOTAL-JUNE.
    0118           ADD JUNEREV TO GRAND-TOTAL-JUNE.
    0119           IF COUNT IS EQUAL TO 1 MOVE QTRREV TO Q1, MOVE APRILREV TO 
    0120           APRIL, MOVE MAYREV TO MAY, MOVE JUNEREV TO JUNE; ELSE MOVE 
    0121           QTRREV TO Q1R, MOVE APRILREV TO APRILR, MOVE MAYREV TO 
    0122           MAYR, MOVE JUNEREV TO JUNER.
    0123           IF COUNT IS EQUAL TO 5 WRITE OUTREC AFTER ADVANCING 1 LINES; 
    0124           ELSE WRITE OUTREC.
    0125           IF COUNT IS EQUAL TO 2 OR COUNT IS EQUAL TO 4 MOVE
    0126           SPACES TO MARGIN, MOVE '   --------' TO Q1RR, MOVE 
    0127           '     ------' TO APRILRR, MOVE '     ------' TO MAYRR, 
    0128           MOVE '     ------' TO JUNERR, WRITE OUTREC, MOVE 
    0129           'TYMCOM IX TOTAL       ' TO MARGIN, MOVE TOTAL-QTR TO
    0130           Q1R, MOVE TOTAL-APRIL TO APRILR, MOVE TOTAL-MAY TO MAYR, 
    0131           MOVE TOTAL-JUNE TO JUNER, MOVE ZEROES TO TOTAL-QTR, 
    0132           TOTAL-APRIL, TOTAL-MAY, TOTAL-JUNE.
    0133           IF COUNT IS EQUAL TO 4 MOVE 'TYMCOM X TOTAL        ' TO 
    0134           MARGIN, WRITE OUTREC BEFORE ADVANCING 2 LINES.
    0135           IF COUNT IS EQUAL TO 2 WRITE OUTREC BEFORE ADVANCING
    0136           2 LINES.
    0137           IF COUNT IS EQUAL TO 4 MOVE 'TOTAL SERVICE         ' TO 
    0138           MARGIN, MOVE GRAND-TOTAL-QTR TO Q1R, MOVE GRAND-TOTAL-APRIL
    0139           TO APRILR, MOVE GRAND-TOTAL-MAY TO MAYR, MOVE 
    0140           GRAND-TOTAL-JUNE TO JUNER, WRITE OUTREC.
    0141           IF COUNT IS EQUAL TO 5 GO TO EOJ; ELSE GO TO SET-UP.
    0142    EOJ.
    0143           MOVE 'TOTAL REVENUES        ' TO MARGIN.
    0144           MOVE GRAND-TOTAL-QTR TO Q1R.
    0145           MOVE GRAND-TOTAL-APRIL TO APRILR.
    0146           MOVE GRAND-TOTAL-MAY TO MAYR.
    0147           MOVE GRAND-TOTAL-JUNE TO JUNER.
    0148           WRITE OUTREC AFTER ADVANCING 2 LINES.
    0149            CLOSE DATAFILE,OUTFILE
    0150            STOP RUN.    P R O G R A M   C O N I S 		COBOL (005001,107000)	31-MAY-73  07:23		PAGE W-1
    CONIS.CBL    31-MAY-73  07:23

WARNINGS:

    0119  MOST SIGNIFICANT DIGITS TRUNCATED ON Q1
    0120  MOST SIGNIFICANT DIGITS TRUNCATED ON APRIL
    0120  MOST SIGNIFICANT DIGITS TRUNCATED ON MAY
    0120  MOST SIGNIFICANT DIGITS TRUNCATED ON JUNE


NO FATAL ERRORS, 4 WARNINGS
    