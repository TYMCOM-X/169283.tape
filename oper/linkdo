PAGED SIMPL PROCEDURES ON THE XDS-940

(FILE (CSW:33)LINKDOC)

        A MECHANISM FOR LINKING BETWEEN SIMPL PROCEDURES ON THE XDS-940
IS DESCRIBED.  THIS MECHANISM IS PROVIDED IN ORDER TO EXPAND THE 
AVAILABLE ADDRESS SPACE FOR PROCEDURES.  IT USES THE PAGING FACILITIES
OF THE SYSTEM TO PROVIDE AN EXPANDED STORE.  TWENTYSEVEN 2048-WORD PAGES
(=54K WORDS) ARE POTENTIALLY AVAILABLE FOR PROCEDURES BY USE OF THE
PAGING FACILITY.  A DETAILED DESCRIPTION OF THE USE AND INTERNAL
OPERATION OF THE PAGING FACILITY IS PROVIDED ELSEWHERE.  THIS DOCUMENT
IS AN OVERVIEW OF THE FACILITY.  THE XDDT AND BRS MANUALS GIVE CERTAIN
SUPPORTING INFORMATION.

GOALS

        IN DESIGNING AND IMPLEMENTING THE PAGING FACILITY, THE FOLLOWING
GOALS WERE AMONG THOSE CONSIDERED:

        1)  NO CHANGES TO THE SIMPL COMPILER ON THE XDS-940 ARE
            REQUIRED.

        2)  NO LOGICAL DIFFERENCES ARE TO BE INTRODUCED BY THE PAGING
            SCHEME, AT LEAST FOR THE GREAT MAJORITY OF CASES.

        3)  ALL PROCEDURES MAY APPEAL TO ALL OTHER PROCEDURES BY NAME IN
            THE NORMAL MANNER.

        4)  PROCEDURES MAY BE PAGED OR UN-PAGED.  A PAGED PROCEDURE IS
            ONE WHICH RESIDES IN A PAGE WHICH IS MAPPED IN AND OUT OF
            CENTRAL MEMORY ADDRESS SPACE FROM THE DRUM, AS REQUIRED
            BY THE PAGING MECHANISM (THE "LINKER").

        5)  PROCEDURES MAY BE LOCAL OR GLOBAL IN THE SIMPL SENSE.
            THIS ATTRIBUTE IS INDEPENDENT OF THE PAGING ATTRIBUTE.

        6)  KNOWLEDGE OF THE PAGING STATUS OF A GLOBAL, PAGED PROCEDURE
            IS CONCENTRATED, RATHER THAN DISTRIBUTED; ONLY THE
            LINKER AND A GLOBAL PAGED PROCEDURE KNOW THAT THE
            PROCEDURE IS PAGED.

        7)  OBVIOUS OPPORTUNITIES FOR AVOIDING OR REDUCING THE
            LINKAGE OVERHEAD IN SPECIAL CASES SHOULD BE SEIZED, IF
            NO MANUAL INTERVENTION OR SPECIAL ACTIONS ARE REQUIRED.

        8)  THE TOTAL CENTRAL MEMORY ADDRESS SPACE MANAGED BY THE LINKER
            SHOULD BE VARIABLE IN SOME MANNER.

        9)  THE EFFICIENCY OF THE LINKAGE MECHANISM, IN THE CASES OF
            MULTIPLE CALLS AND RESIDENT CALLEE, SHOULD RECEIVE
            SPECIAL ATTENTION.

        10) A FORM OF "WORKING SET" MANAGEMENT IS NEEDED.

        11) TRACING AND OTHER DEBUGGING OR TIMING AIDS ARE DESIREABLE.

        12) THE RESIDENT CODE, STORAGE, AND CONTROL INFORMATION FOR
            THE LINKER SHOULD BE KEPT WITHIN REASONABLE LIMITS.

        13) SUFFICIENT INFORMATION AND FUNCTIONS SHOULD BE PROVIDED TO
            ALLOW FOR THE CONSTRUCTION AND LOADING OF SAVE-TYPE
            FILES IN A REASONABLE MANNER.

        14) THE SIMPL PROCEDURES MUST COMPILE AND EXECUTE ON THE
            PDP-10 WITH AT MOST A TRIVIAL CHANGE IN A FEW MACRO
            DEFINITIONS.

        15) ALTERNATE ENTRIES TO PROCEDURES MUST BE CAPABLE OF BEING
            FLOATED.

        16) THE LINKAGE NUST BE CAPABLE OF BEING INITIALIZED AND
            RESTARTED FROM ANY (NON-DESTRUCTIVE) STATE.

        17) ALLOCATION OF THE AVAILABLE SPACE BETWEEN FIXED (I.E.:
            RESIDENT) AND PAGED CODE IS TO BE PERFORMED DYNAMICALLY AT
            RELOCATABLE-LOAD TIME.

ACHIEVEMENTS

        GOALS 1,3,4,5,6,8,14,15,16, AND 17 WERE ACHIEVED.

        GOAL 2, WHICH CONSTRAINS LOGICAL DIFFERENCES BETWEEN GLOBAL
PAGED PROCEDURES AND OTHER PROCEDURES WAS ACHIEVED WITH THE FOLLOWING
EXCEPTION:  PASSING ADDRESSES FROM A PAGED PROCEDURE IS A DELICATE
MATTER.  ADDRESSES ARISE BY USE OF PROCEDURE NAMES, VARIABLE ADDRESSES,
ARRAY ADDRESSES, AND LITERALS AS ARGUMENTS.  PROCEDURE NAMES PRESENT
A PROBLEM IN ONLY ONE CASE:  IF A PROCEDURE NAME FOR
A PROCEDURE DECLAREDWITHIN ONE'S OWN FILE IS PASSED TO A PROCEDURE
NOT IN YOUR OWN FILE, THEN THE POTENTIAL FOR AN ERROR EXISTS.
OTHERWISE, PROCEDURE NAMES PRESENT NO PROBLEM, AS SPECIAL PROCESSING
IN THE LINKER WILL DDETECT AND SUITABLY TREAT ANY SPECIAL
CASES WHICH ARISE FROM THIS ACTION.  ALL OTHER FORMS OF ADDRESSES
ARE LIKE THE SPECIAL PROCEDURE CASE, AND FACE THE FOLLOWING CONSTRAINT:
IF THE ADDRESS REFERS TO A PLACE IN A FLOATING PAGE,
THEN THAT ADDRESS CAN BE TRANSMITTED SAFELY ONLY WHEN THE ADDRESS, THE
CALLER, AND THE CALLEE ARE CO-RESIDENT IN THE SAME PAGE.  IN ALL OTHER
CASES, NO GURANTEE CAN BE MADE THAT THE PAGE IN WHICH THE ADDRESS HAS
MEANING WILL BE RESIDENT WHEN THE ADDRESS IS USED FOR A CORE REFERENCE.

        GOALS 7 AND 9, WHICH REFER TO EFFICIENCY IN SPECIAL CASES, ARE
ADDRESSED IN THE FOLLOWING WAYS:

        A)  IN-FILE APPEALS TO GLOBAL PAGED PROCEDURES ARE BOUND AT
COMPILE TIME TO EFFECT THE STANDARD SIMPL LINKAGE.

        B)  NORMAL, DIRECT APPEALS TO GLOBAL PAGED PROCEDURES ARE
MODIFIED, IN PLACE, DURING THE FIRST INSTANCE OF A PARTICULAR CALL
TO ACHIEVE A PERFORMANCE INCREASE IN SUCCESSIVE CALLS.  THIS IS DONE
BY USING CALL POPS WHICH SELECTIVELY SAVE THE GENERAL REGISTERS.

        ADDITIONAL REFINEMENT OF THIS TYPE IS POSSIBLE IN THE SPECIAL
CASE OF AN IN-PAGE (BUT OUT-OF FILE) CALL TO A GLOBAL PAGED PROCEDURE,
BUT HAS NOT YET BEEN IMPLEMENTED.

        GOAL 10, RELATING TO "WORKING SETS", HAS BEEN REALIZED
IN THE FOLLOWING SENSE:  AT THE TIME THAT THE RELOCATABLE BINARY FILES
ARE BEING LOADED TO FORM THE FLOATING PAGES, THEN ANY TWO GIVEN
PAGES MAY BE FORCED TO OCCUPY DIFFERENT POSITIONS WITHIN THE CENTRAL
MEMORY ADDRESS SPACE (THEY ARE SAID TO OCCUPY DIFFERENT "WINDOWS").
THUS, IT IS POSSIBLE TO ARRANGE THINGS BY ANAPPROPRIATE LOADING SEQUENCE
SO THAT ONE CAN HAVE UP TO 4K OF FLOATING PROCEDURES NON COMPETITIVE FOR
CORE SPACE.

        GOAL 11, RELATING TO DEBUGGING AND TIMING AIDS, HAS NOT BEEN
REALIZED EXPLICITLY, BUT "HOOKS" HAVE BEEN PLACED IN THE LINKER TO
FACILITATE IMPLEMENTATION OF SUCH FEATURES IF DESIRED.

        GOAL 12,, RELATED TO RESIDENT SPACE OF THE LINKER, HAS BEEN
ADDRESSED AS FOLLOWS:

        A)  THOUGH NO ATTEMPT HAS BEEN MADE TO BE CAUTIOUS WITH SPACE
IN THE MAIN-LINE, HIGH FREQUENCY PATHS OF THE LINKER (PERFORMANCE WAS
OF PRIMARY PRIORITY), ELSEWHERE AN ATTEMPT HAS BEEN MADE TO UTILIZE
PROCEDURE NESTING TECHNIQUES AND CONTROL INFORMATION PACKING TO CONSERVE
SPACE.

        B)  SOME LOW CORE SPACE, NORMALLY NOT AVAILABLE TO SIMPL
PROCEDURES, HAS BEEN USED.

        C)  A STACK IS STILIZED FOR CALL-RELATED STORAGE OF INFORMATION.
THIS STACK IS SMALL IN RELATION TO TOE AMOUNT OF STORAGE
REQUIRED IF THE REQUISITE INFORMATION WERE STORED IN SPACE RESERVED
FOR EACH GLOBAL PAGED PROCEDURE.

        D)  AN ATTEMPT HAS BEEN MADE TO CONSTRAIN THE NUMBER OF
RESIDENT WORDS OF CONTROL AND STORAGE SPACE REQUIRED FOR EACH GLOBAL
PAGED PROCEDURE; A CONSTANT STORAGE PENALTY OF MODERATE SIZE WAS
PREFERRED TO A STORAGE PENALTY WHICH WHICH INCREASED LINEARLY AS THE
NUMBER OF GLOBAL PAGED PROCEDURES.  TRADE-OFFS OF THIS KIND HAVE, OF
COURSE, BEEN TEMPERED WITH THE AUTOUR'S BIASES.

        E)  THE LINKER HAS CERTAIN ASSEMBLY VARIABLES WHICH ALLOW
FOR ASSEMBLY-TIME TRADE-OFFS TO BE MADE BETWEEN SPACE AND EXECUTION TIME
WITHIN SOME USEFUL LIMITS.

        F)  RUN-TIME ERROR CONDITIONS ARE HANDLED BY GLOBAL PAGED
PROCEDURES.  TRACING AND TIMING FUNCTIONS CAN BE SIMILARLY HANDLED,
THOUGH ONE MUST BE CAREFUL OF HEISENBERG EFFECT PROBLEMS.

        GOAL 13, RELATING TO SAVE-FILE CREATION FACILITIES, HAS
BEEN ADDRESSED IN THE FOLLOWING MANNER:

        A)  CERTAIN INTERNAL LINKER FACILITIES HAVE BEEN INPLEMENTED
AS GLOBAL PROCEDURES USING THE STANDARD SIMPL INTERFACE.  USING THESE
FACILITIES, AN EXTENDED FORMAT SAVE FILE CAN BE CONSTRUCTED BY
A GLOBAL PAGED PROCEDURE.  BY USING INTERNALLY REQUIRED FUNCTIONS FOR
THIS ADDITIONAL FACILITY (WITH, ADMITTEDLY, A SMALL INCREASE IN SIZE),
TOTAL SPACE IS CONSERVED.

        B)  SYSTEM FUNCTIONS WILL LOAD THE SAVE FILE IN AN AUTOMATIC
FASHION.

        C)  AUTOMATIC LOADING OF THE SAVE FILE IN AN XDDT ENVIRONMENT
IS NOT POSSIBLE.  SPECIAL FACILITIES HAVE BEEN IMPLEMENTED, HOWEVER,
WHICH APPROXIMATE THE FACILITY PROVIDED BY THE SYSTEM.

        IN ADDITION TO THE GOALS AND ACHIEVEMENTS DISCUSSED ABOVE,
AN ATTEMPT HAS BEEN MADE TO PROVIDE ERROR CHECKING WHEN THE
TIME OR SPACE PENALTIES WERE JUDGED NOT TOO GREAT, AND AN ATTEMPT
WAS MADE TO DESIGN AND IMPLEMENT THE LINKER SO THAT IT CAN BE READ,
DEBUGGED, AND MODIFIED.
 