10 REM LEASE ANALYZER - MAY, 1973  F. WALKER
20 REM PGM IS DONE IN SECTIONS.  INPUT VARIALBES LISTED BELOW.
30 REM L$  LESSEE
40 REM S$  SLSMN
50 REM  E$  EQUIP
60 REM  A$  ADV OR ARR
70 REM  C  COST
80 REM  T  TERM IN YEARS
90 REM  R  RESIDUAL PERCENT
100 REM  I  ITC OPTION
110 REM  I1  ITC NONSTD PERCENT
119%0 PRINT 'SUMMARIZED'
120 REM  D  DEPREC
124 0
130 REM  D1  SALVAGE VALUE
140 REM  F PAYMENT FREQ
150 REM  C2  C2C
160 REM  D2  DRR
170 REM  B  BROKERS OR BRANCH FEE
180 DIM T$ (13)
190 DIM M(15,200)
191 T$(1) = 'RECPT'
192 T$(2) = '  EXP'
193 T$(3)= '  EXP'
194 T$(4) = ' PAID'
195 T$(5)= ' CASH'
196 T$(6) = 'PAID'
197 T$(7) = ' CASH'
198 T$(8)= ' CASH'
199 T$(9) = ' DEPN'
200 T$(10)= 'INCOM'
201 T$(11)= ' EQTY'
202 T$(12) = ' PROF'
203 T$(13) = 'FUND'
204 T$(14) = '  INT'
205 T$(15) = '  BAL'
210 PRINT 'LESSEE,SLSMN,EQUIP'
220 INPUT L$,S$,E$
230 PRINT 'COST,TERM(YRS),RESID'
240 INPUT C,T,R
250 PRINT 'ITC(STD=1,NONSTD=2,NONE=0),(IF 2)NONSTD %'
260 INPUT I,I1
270 PRINT 'DEPRECIATION(NEW=1,USED=2,CSA=3),SALVAGE VALUE'
280 INPUT D,D1
290 PRINT 'PAYMENTS/YR,ADV(Y OR N)'
300 INPUT F,A$
310 PRINT 'C2C,DRR'
320 INPUT C2,D2
330 PRINT 'BROKER/BRANCH FEE'
340 INPUT B
350 T9=T*12+15
360 MAT M = ZER
370 DIM X$(15)
380 DIM Y$(15)
390 X$(2)= 'MISC'
391 X$(3)='  INT'
392 X$(4)= 'PRINC'
393 X$(5)='PRETX'
394 X$(6)='  TAX'
395 X$(7)='  A-T'
396 X$(9)='PRETX'
397 X$(14)=' FUND'
398 X$(15)='  BAL'
800 REM THIS IS THE EXPENSE ALLOC SECTION
810 REM  R8  RATE PER PERIOD
820 REM  E2  EXPENSE IN PERIOD ZERO
830 REM  B  BROKERS EXP - INPUT
833 R8 = .125/F
835 IF C > 2500000. GOTO 880
840 IF C > 1000000. GOTO 900
850 IF C > 500000. GOTO 920
860 E2 = 1
870 GOTO 930
880 E2 = .25
890 GOTO 930
900 E2 =.5
910 GOTO 930
920 E2 = .75
930 M(1,2) = E2 + M(1,2) + B
940 FOR K = 13 TO T*12 STEP 12/F
950 M(K,2) = M(K,2) + R8
960 NEXT K
970 REM EXIT EXPENSE RTN
1150 PRINT
1252 INPUT X4
5000 REM SINKING FUND ROUTINE
5010 REM  A3  BAL
5020 REM  F  FIRST POSITIVE INDICATOR (0 = OF,1=ON)
5030 REM  R4  S.F. RATE = .5 * DEBT COST UP TO 4%
5040 REM  S1  SIGNCOUNT
5050 REM  S2  LASTSIGN (0=+,1=-,2=START)
5060 A3 = 0
5070 F5 = 0
5080 S1 = 0
5090 S2 = 0
5100 R4 = .5 * L(T) 
5110 IF R4 > .04 GOTO 5130
5120 GOTO 5140
5130 R4 = .04
5140 FOR K = 1 TO T9
5150 IF M(K,8) >0  GOTO 5230
5160 IF M(K,8) = 0 GOTO 5310
5170 L = K
5180 IF S2 = 1 GOTO 5310
5190 IF S2 = 0 GOTO 5210
5200 S1 = S1 + 1
5210 S2 = 1
5220 GOTO 5310
5230 IF F5 = 1 GO TO 5260
5240 J = K
5250 F5 = 1
5260 IF S2 = 0 GOTO 5310
5270 IF S2 0 2 GOTO 5290
5280 S1 = S1 + 1
5290 S2 = 0
5310 NEXT K
5320 IF S1 < 2 GOTO 5540
5330 FOR K =L TO J STEP -1
5340 IF A3 > 0 GOTO 5360
5350 GOTO 5370
5360 A3 = A3 / (1 + R4)
5370 IF M(K,8) = 0 GOTO 5460
5380 IF M(K,8) < 0 GOTO 5440
5390 IF A3 = 0 GOTO 5460
5400 IF M(K,8) < A3 GOTO 5440
5410 M(K,8) = A3
5420 A3 = 0
5430 GOTO 5460
5440 M(K,13) = M(K,8)
5450 A3 = A3 - M(K,8)
5460 NEXT K
5470 IF A3 > 0 GOTO 5490
5480 M(J,13) = M(J,13) + A3
5490 M(J,15) = M(J,13)
5500 FOR K = J + 1 TO L
5510 M(K,14) = R4 * M(K-1,15)
5520 M(K,15) = M(K-1,15) + M(K,14) + M(K,13)
5530 NEXT K
5540 REM END SINKING FUND
8100 REM ROR CALCULATION
8110 REM  R5  ROR
8120 REM  R6  TEST ROR
8130 REM  P1  PV
8140 REM  P2  DERIVATIVE OF PV
8145 REM  S3  CF HOLDING AREA
8150 R5 = (1.1) & (1/12) - 1
8160 R6 = R5
8170 P1 = 0
8180 P2 = 0
8190 FOR K = 1 TO T9
8200 S3 = M(K,8) - M(K,13)
8210 P1 = P1 + (S3/((1.0 + R6) & K))
8220 P2 = P2 - K * (S3/((1.0+R6) & (K+1)))
8230 NEXT K
8240 R5 = R6 - (P1/P2)
8250 IF ABS(R5-R6) < 1.00001 &(1/12) - 1.0 GOTO 8270
8260 GOTO 8160
8270 R5 = (1.0 + R5) & 12 - 1.0
8280 REM END OF ROR CALCULATION
8600 REM DETERMINE IF LEASE RATE REQUIRES ADJUSTMENT
8620 IF D2 = 0 GOTO 10000
8640 REM TEST TARGET AGAINST CURRENT RATE
8650 IF ABS(R5-D2)< .00001 GOTO 10000
8660 REM IF THERE IS AN ACCEPTABLE MARGIN, GO TO CASH ALLOC
8670 REM OTHERWISE ADJUST LEASE RAATE
8680 REM  F6  FIRST TIME SW - INIT TO ZERO IN HSKPG
8690 REM  R7  NEXT RLRATE
8700 REM  D5  DIFF IN ROR AND D2
8710 REM  Q   OLD LEASE RATE (PRIOR N)
8720 REM  Q1  OLD YIELD (PRIOR ROR: R5)
8800 IF F5 = 1 GOTO 8880
8810 F5 = 1
8820 D5 = (R5 - D2)/5
8830 IF D5 < N GOTO 8860
8840 R7 = N - D5
8870 GOTO 8890
8880 R7 = Q - (((Q-N) * (Q1-D2))/(Q1-R5))
8890 Q = N
8900 Q1 = R5
8910 N = R7
8920 GOTO 2500
8930 REM GO RECALC LR'S ,ETC.
8940 REM END OF ADJ LEASE RATE
10000 REM ALLOCATION OF AFTER-CASH TAX SECTION
10010 REM  A4  BALANCE
10020 REM  A5  AMOUNT - HOLDING AREA.
10100 A4 = 0
10110 FOR K = 1 TO T9
10120 A5 = M(K,8) - M(K,13)
10130 IF (A4 + A5) < 0 GOTO10150
10140 GOTO 10190
10150 M(K,11) = A5
10160 A4 = A4 + A5
10170 NEXT K
10180 GOTO 10240
10190 M(K,11) = -A4
10200 M(K,12) = A4 + A5
10210 FOR L = K + 1 TO T9
10220 M(L,12) = M(L,8) - M(L,13)
10230 NEXT L
10240 REM END OF ALLOCATION SECTION
11000 REM OUTPUT SECTION. ALSO DOES MINOR CALCULATIONS - PTY, A-T-CASH%
11010 REM 1ST CALC = PTY - REUSING VALIABLES FROM ROR RTN
11020 REM  R9  NEW  STARTING VALUE
11030 REM  R6,P1,P2,S3
11100 R9 = (1.1) & (1/12) - 1.0
11110 R6 = R9
111164
11120 P1 = 0
11130 P2 = 0
11140 FOR K = 1 TO T9
11150 S3 = M(K,1)
11160 P1 = P1 + (S3/((1.0 + R6) & K))
11170 P2 = P2 - K * (S3/((1.0+R6) & (K+1)))
11180 NEXT K
11190 IF I = 0 GOTO 11238
11200 IF I = 2 GOTO 11220
11210 I1 = 7
11215 REM NEXT 2 ADD IN ITC IF APPLICABLE
11220 P1 = P1 + (I1/((1.0+R6) & 9)
11230 P2 = P2 - 9 * (I1/((1.0+R6)&10))
11233 GOTO 11240
11238 I1 = 0
11240 REM NEXT STMTS ADD RESID
11250 P1 = P1 + R/((1.0+R6) & (T*12))
11260 P2 = P2 - (T*12) * (R/((1.0+R6) & (T*12+1))
11280 R9 = R6 - (P1/P2)
11290 IF ABS(R9-R6) < (1.00001 & (1/12) - 1.0) GOTO 11310
11300 GOTO 11110
11310 R9 = ((1.0+R9) & 12) - 1.0
11320 REM END PTY CALC
11400 REM DETERMINE  $ AMT OF LR'S
11410 REM  A6  $ AMT OF LR'S
11420 REM  A1  % AMT OF LR'S
11430 A6 = A1 * C
11450 REM LOAN PYMTS IN $
11460 REM  A  AMT IN %
11470 REM  A7  AMT IN $
11480 A7 = A * C
11490 REM AFTER TAX CASH
11500 REM  S4 SUM A-T CASH
11510 S4 = 0
11520 FOR K = 1 TO T9
11530 S4 = S4 + M(K,8)
11540 NEXT K
11550 S4 = S4 / C
11600 REM THIS THE SUMMARY OUTPUT AREA
11610 PRINT 'SUMMARY OUTPUT'
11620 PRINT 'LESSEE' L$, 'SLSMN', S$, 'EQUIP',E$
11630 PRINT
11640 PRINT 'COST', C, 'TERM,' (YRS) RESIDUAL ',R
11650 PRINT
11660 PRINT 'ITC% 'I1,'DEPREC TYPE ',D,' FEE ',B
11670 PRINT
11680 PRINT '   *   *   *   '
11690 /RINT
11700 PRINT 'DRR ',R5,'  PTY ',R9, '  C2C ',R1
11710 PRINT
11730 IF F = 12 GOTO 11780
11740 IF F = 4 GOTO 11800
11750 IF F = 2 GOTO 11820
11760 B$ = 'ANNUALLY'
11770 GOTO 11830
11780 B$ = 'MONTHLY'
11790 GOTO 11830
11800 B$ = 'QUARTERLY'
11810 GOTO 11830
11820 B$ = 'SEMI-ANNUALLY'
11830 IF A$ = 'Y' GOTO 11860
11840 C$ = 'ARREARS'
11850 GOTO 11870
11860 C$ = 'ADVANCE'
11870 PRINT 'LSE PYMTS $ ',A6,'LSE PYMT %',A1,B$,' IN ',C$
11880 PRINT
11890 PRINT 'LOAN AMORT PYMTS $ ',A7,'AFTER TAX CASH %',S4
11900 PRINT
11920 PRINT 'CASH FLOWS'
11930 INPUT F$
11940 IF F$ = 'N' GOTO 13500
11942 PRINT 'BY COL'
11944 INPUT F$
11946 IF F$ = 'Y' GOTO 12500
11960 INPUT F$
11970 IF F$ = 'N' GOTO 12070
11975 L = I@1
11980 PRINT 'Q,S,A'
11990 INPUT F$
12000 IF F$ = 'Q' GOTO 12040
12010 IF F$ = 'S' GOTO 12060
12020 L = 12
12030 GOTO 12070
12040 L = 3
12050 GOTO 12070
12060 L = 6
12070 FOR K = 1 TO T9
12080 FOR J = 1 TO T9 STEP L12090 A9 = A9 + M(J,1)
12100 B9 = B9 +M(J,2)
12110 C9=C9+M(J,3)
12120 D9=D9+M(J,4)
12130 E9=E9+M(J,5)
12140 F9=F9+M(J,6)
12150 G9=G9+M(J,7)
12160 NEXT J
12170 PRINT J,A9,B9,C9,D9,E9,F9,G9
12180 K=K+L
12190 NEXT K
12250 FOR K=1 TO T9
12260 FOR J=1 TO T9 STEP L
12270 H9=H9+M(J,8)
12280 I9=I9+M(J,9)
12290 J9=J9+M(J,10)
12300 K9=K9+M(J,11)
12310 L9=L9+M(J,12)
12320 M9=M9+M(J,13)
12322 N9=N9+M(J,14)
12324 O9=O9+M(J,15)
12330 NEXT J
12340 PRINT J,H9,I9,J9,K9,L9,M9,N9,O9
12350 K=K+L
12360 NEXT K
12380 PRINT 'END OF RUN'
12400 GOTO 13500
12500 REM THIS IS THE COLUMN PRINT SECTION
12510 PRINT 'ENTER COL DESIRED'
12522 IF X4=0 GOTO 13500
12530 PRINT 'M,Q,S,A'
12540INPUT F$
12550 IF F$='M' GOTO 12600
12560 IF F$='Q' GOTO 12620
12570 IF F$= 'S' GOTO 12640
12580 L=12
12590 GOTO 12650
12600 L=1
12610 GOTO 12650
12620 L=3
12630 GOTO 12650
12640 L=6
12650 A9=0
12652 PRINT X$(X4)
12654 PRINT T$(X4)
12660 FOR K=1 TO T9
12670 FOR J=1 TO T9 STEP L
12680 A9=A9+M(J,X4)
12690 NEXT J
12700 PRINT J,A9
12710 K=K+L
12720 NEXT K
12730 GOTO 12510
13500 END
   