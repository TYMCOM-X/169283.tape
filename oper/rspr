C               MAIN PROGRAM - PRINT ROTATION SCHEDULE
      COMMON IPK(20),IPG(720),IB(30,2),IPL(4000),JPK(14),IPA(20),JPL(20)
     1,ITA(6,7),NAME(6),KVAL(10),VAL(10),LDATE(3),LYEAR,LBASE
      COMMON IBO(20,5),IUNIV(7)
      DIMENSION MON(12),KPKG(10),KPL(3000),KBR(10),COST(20),MIN(20,3),JJ
     1PK(15,10)
      DIMENSION KTXT(8),MTN(3),IHEAD1(60),IHEAD2(60),IHEAD3(60)
      DATA MON/3HJAN,3HFEB,3HMAR,3HAPR,3HMAY,3HJUN,3HJUL,3HAUG,3HSEP,3HO
     1CT,3HNOV,3HDEC/
      DATA INNN,IDDD,IALL/3HN  ,3HD  ,3HA  /
      DATA IBLK/3H   /
      IHEAD1(1)=3HRAL
      IHEAD1(2)=3HSTO
      IHEAD1(3)=3HN P
      IHEAD1(4)=3HURI
      IHEAD1(5)=3HNA 
      IHEAD1(6)=3HCOM
      IHEAD1(7)=3HPAN
      IHEAD1(8)=3HY  
      IHEAD2(1)=3HNET
      IHEAD2(2)=3HWOR
      IHEAD2(3)=3HK T
      IHEAD2(4)=3HELE
      IHEAD2(5)=3HVIS
      IHEAD2(6)=3HION
      IHEAD2(7)=3H PE
      IHEAD2(8)=3HRFO
      IHEAD2(9)=3HRMA
      IHEAD2(10)=3HNCE
      IHEAD2(11)=3H RE
      IHEAD2(12)=3HPOR
      IHEAD2(13)=3HT  
         OPEN (6,'ROTAT',OUTPUT)
      WRITE (6,914)(IHEAD1(I),I=1,20)
      WRITE (6,914)(IHEAD2(I),I=1,20)
  914 FORMAT (20A3)
      CLOSE (6)
         OPEN (6,'ROTAT',OUTPUT)
      READ (6,924)IHEAD1
      READ (6,924)IHEAD2
  924 FORMAT (60A1)
      CLOSE (6)
        TYPE 1301
        TYPE 1305
         OPEN(5,'HUTB',RANDIO,BINARY)
      IADR=1
      READ(5#IADR)IUNIV
      CLOSE(5)
         OPEN(2,'BRAN1',RANDIO,BINARY)
         OPEN(3,'PROG',RANDIO,BINARY)
         OPEN(4,'PLAY',RANDIO,BINARY)
      IADR=1
      READ(2#IADR)IB,IBO
      IADR=1
      READ(3#IADR)IPK,IPG
      IADR=1
      READ(4#IADR)IPL
      LYEAR=IPL(3999)
      LBASE=IPL(4000)
1       TYPE 1301
        TYPE 1306
        ACCEPT 1313,ISTART,IWEEK,(KPKG(I),I=1,10)
      IM=ISTART/100
      ID=MOD(ISTART,100)
      CALL DAYCALC(IM,ID,KD1,LBASE,LYEAR,LSIG)
      KD2=KD1+7*IWEEK-1
      KNT=0
2       TYPE 1301
        CLOSE(2)
        CLOSE(3)
        CLOSE(4)
         OPEN(6,'ROTAT',OUTPUT)
      DO 4 I=1,3000
      KPL(I)=999999
      IF(IPL(I).EQ.0)GO TO 4
      KD=MOD(IABS(IPL(I)),1000)
      IF(KD.LT.KD1)GO TO 4
      IF(KD.GT.KD2)GO TO 4
      KPK=IABS(IPL(I))/100000
      DO 5 J=1,10
      IF(KPKG(J).EQ.KPK)GO TO 6
    5 CONTINUE
      GO TO 4
    6 KPG=MOD(IABS(IPL(I)),100000)
      KPG=KPG/1000
      KPL(I)=100*KD+KPG
      KNT=KNT+1
    4 CONTINUE
        TYPE 1301
        TYPE 1307,KNT
      CALL SORTIP(KPL,3000,IPL)
        TYPE 1308
         OPEN(3,'PROG',RANDIO,BINARY)
      JJ=0
      DO 17 I=1,10
      IF(KPKG(I).LE.0)GO TO 17
      JJ=JJ+1
      CALL FINDPK(KPKG(I),L,M,IPK)
      IF(L.GT.0)GO TO 18
        TYPE 1312,KPKG(I)
      GO TO 17
   18 IADR=KPKADR(L)
        CALL NREAD(IADR)
      READ(3#IADR)JPK
        DO 1203 J=2,15
1203     JJPK(J,JJ)=JPK(J-1)
      JJPK(1,JJ)=KPKG(I)
   17 CONTINUE
      CLOSE(3)
      CALL HEADING (IHEAD1,IHEAD2,IHEAD3,JJ,JJPK,ILINE,0,40)
      IADR=1
         OPEN(4,'PLAY',RANDIO,BINARY)
      READ(4#IADR)KPL
      CLOSE(4)
      DO 20 I=1,20
        DO 1202 J=1,3
1202     MIN(I,J)=0
   20 COST(I)=0.
      M1=1
      KWK=1
      KDAY=KD1
        TYPE 900,IM,ID
   14 WRITE(6,900)IM,ID
      ILINE=ILINE+1
         OPEN(2,'BRAN1',RANDIO,BINARY)
  900 FORMAT('WEEK OF ',I2,'/',I2)
      DO 35 M=1,KNT
      I=IPL(M)
      N=MOD(IABS(KPL(I)),1000)
   33 IF(N.LE.KDAY+6)GO TO 36
      KDAY=KDAY+7
      IF(KDAY.GT.KD2)GO TO 40
      NK=KDAY+LBASE
      CALL CALCDAY(NK,JM,JD)
      IF (ILINE.GT.45) CALL HEADING (IHEAD1,IHEAD2,IHEAD3,JJ,JJPK,ILINE,
     10,0)
      CALL BLANK (6,1)
      WRITE(6,900)JM,JD
        TYPE 911,JM,JD
  911 FORMAT (/'WEEK OF ',I2,'/',I2)
      ILINE=ILINE+2
      GO TO 33
   36 N=N+LBASE
      CALL CALCDAY(N,LM,LD)
      LEN=60
      IF(KPL(I).LT.0)LEN=30
      KPK=IABS(KPL(I))/100000
      KPG=IABS(KPL(I))/1000
      KPG=MOD(KPG,100)
      JADR=4000+20*(I-1)
        CALL NREAD(JADR)
         OPEN(4,'PLAY',RANDIO,BINARY)
      READ(4#JADR)JPL
      JJPL=(JPL(2)+100)/200
      CLOSE(4)
      LPG=100*KPG+KPK
      CALL FINDPG(LPG,L,MM,IPG)
      IF(L.GT.0)GO TO 37
        TYPE 1309,KPG,KPK
      GO TO 35
   37 IADR=KPGADR(L)
        CALL NREAD(IADR)
         OPEN(3,'PROG',RANDIO,BINARY)
      READ(3#IADR)IPA
      CLOSE(3)
   11 WRITE(6,901)LM,LD,IPA(7),(IPA(J),J=1,6),KPK
        TYPE 901,LM,LD,IPA(7),(IPA(J),J=1,6),KPK
  901 FORMAT(2X,I2,'/',I2,2X,A3,1X,6A3,I4,2X,$)
      KSW=1
      IF(LEN.GT.30)GO TO 38
      CALL FINDBR(JPL(1),L,MM,IB)
      IF(L.GT.0)GO TO 41
        TYPE 1310,JPL(1),KPL(I)
      GO TO 35
   41 IF (JJPL.NE.1) MIN(L,2)=MIN(L,2)+1
      IF (JJPL.NE.1) COST(L)=COST(L)+0.3*JPL(20)
      IADR=KBRADR(L)
        CALL NREAD(IADR)
      READ(2#IADR)ITA
      GO TO (44,61,62)KSW
   44 WRITE(6,902)LEN,(ITA(6,J),J=1,6)
        TYPE 902,LEN,(ITA(6,J),J=1,6)
  902 FORMAT(I4,':',6A3,23X,$)
      GO TO 50
   38 CALL FINDBR(JPL(1),L,MM,IB)
      IF(L.GT.0)GO TO 42
49      TYPE 1311,JPL(1),JPL(3),KPL(I)
      GO TO 35
   42 IF(JPL(3).LE.0)GO TO 65
      CALL FINDBR(JPL(3),LL,MM,IB)
      IF(LL.LE.0)GO TO 49
   65 IADR=KBRADR(L)
      READ(2#IADR)ITA
      ISEC=MOD(JPL(2),100)
      IF(ISEC.NE.0)GO TO 43
      IF (JJPL.NE.1) MIN(L,1)=MIN(L,1)+1
      IF (JJPL.NE.1) COST(L)=COST(L)+0.6*JPL(20)
      GO TO 44
   43 IF(ISEC.NE.30)GO TO 60
      KSW=2
      LEN=ISEC
      GO TO 41
   61 WRITE(6,903)ISEC,(ITA(6,J),J=1,6)
        TYPE 903,ISEC,(ITA(6,J),J=1,6)
      KSW=3
      L=LL
      GO TO 41
   60 IF (JJPL.NE.1) MIN(L,3)=MIN(L,3)+1
      IF (JJPL.NE.1) COST(L)=COST(L)+0.01*JPL(20)*ISEC
      WRITE(6,903)ISEC,(ITA(6,J),J=1,6)
        TYPE 903,ISEC,(ITA(6,J),J=1,6)
      IADR=KBRADR(LL)
        CALL NREAD(IADR)
      READ(2#IADR)ITA
      ISEC=60-ISEC
      MIN(LL,3)=MIN(LL,3)+1
      COST(LL)=COST(LL)+0.01*JPL(20)*ISEC
   62 WRITE(6,903)ISEC,(ITA(6,J),J=1,6)
        TYPE 903,ISEC,(ITA(6,J),J=1,6)
  903 FORMAT(I4,':',6A3,$)
   50 IF (JPL(13).NE.0)WRITE(6,904)(JPL(J),J=13,19)
      IF(JPL(13).NE.0)TYPE 904,(JPL(J),J=13,19)
  904 FORMAT(2X,7A3,$)
      WRITE(6,1300)
        TYPE 1300
      ILINE=ILINE+1
      IF (ILINE.GT.53) CALL HEADING (IHEAD1,IHEAD2,IHEAD3,JJ,JJPK,ILINE,
     1JM,JD)
   35 CONTINUE
   40 CALL HEADING (IHEAD1,IHEAD2,IHEAD3,JJ,JJPK,ILINE,13,0)
      WRITE(6,930)
  930 FORMAT(6X,'BRAND',7X,'60"S',4X,'30"S',2X,'OTHERS',6X,'COST')
      CALL BLANK (6,1)
        TYPE 930
        TYPE 1301
        DO 1201 J=1,3
1201     MTN(3)=0
      TCT=0.
      DO 30 I=1,20
      IF(COST(I).LE.0.)GO TO 30
      KADR=KBRADR(I)
        CALL NREAD(KADR)
      READ(2#KADR)ITA
      WRITE(6,931)(ITA(6,J),J=1,6),(MIN(I,J),J=1,3),COST(I)
        TYPE 931,(ITA(6,J),J=1,6),(MIN(I,J),J=1,3),COST(I)
  931 FORMAT(6A3,I4,I8,I8,F10.0)
        DO 1200 J=1,3
1200     MTN(J)=MTN(J)+MIN(I,J)
      TCT=TCT+COST(I)
   30 CONTINUE
      CALL BLANK (6,2)
      WRITE (6,1302)MTN,TCT
        TYPE 1303,MTN,TCT
10      CLOSE(2)
        CLOSE(3)
        CLOSE(4)
        TYPE 1304
  999 STOP
1300    FORMAT(' ')
1301    FORMAT( /)
1302    FORMAT(' TOTAL',13X,I4,2I8,F10.0)
1303    FORMAT( //' TOTAL',13X,I4,2I8,F10.0)
1304    FORMAT( ' END OF PROGRAM')
1305    FORMAT(' FACT : PRINT ROTATION SCHEDULE')
1306    FORMAT(' ENTER START DATE,WEEKS,BUY,#"S : ',$)
1307    FORMAT(' START SORT',I4)
1308    FORMAT(' END SORT')
1309    FORMAT(' NO PACKAGE ON FILE',2I8)
1310    FORMAT(' NO BRAND "A" ON FILE',2I8)
1311    FORMAT(' NO BRAND ON FILE',3I8)
1312    FORMAT(' NO DESCRIPTION FOR PACKAGE',I8)
1313    FORMAT(12I8)
        END
        SUBROUTINE BLANK(N,M)
1       FORMAT(128X)
        DO 2 I=1,M
        WRITE(N,1)
        K=K+1
2       CONTINUE
        RETURN
        END
        SUBROUTINE CENTER(IH,IB,K,ID,IR)
        DIMENSION IH(60),ID(9),IR(60)
        DO 800 I=1,60
800     IR(I)=3H   
        IX=K*9
        DO 10 J=60,1,-1
        IF(IH(J).NE.IB)GO TO 20
10      CONTINUE
20      N=(60-J-IX)/2
        DO 30 I=J,1,-1
        IR(I+N)=IH(I)
30      CONTINUE
        IF(IX.EQ.0)GO TO 60
        J=J+N
        DO 50 I=1,9
        J=J+1
        IR(J)=ID(I)
50      CONTINUE
60      DO 801 I=1,60
801     IH(I)=IR(I)
        RETURN
        END
        SUBROUTINE HEADING(IH1,IH2,IH3,JJ,JJPK,ILINE,JM,JD)
        DIMENSION IH1(60),IH2(60),IH3(60),ID(9),IR(60),JJPK(15,10)
        DIMENSION IH(60)
        IF(JD.NE.40)GO TO 41
        TYPE 900
900     FORMAT(' HEADING LINE')
        IB=3H   
        DO 40 I=1,3
        TYPE 901
901     FORMAT(' ')
        ACCEPT 500,(IR(J),J=1,60)
500     FORMAT(60A1)
        IF(IR(3).EQ.IB)GO TO 40
        DO 35 J=1,60
        GO TO (10,20,30),I
10      IH1(J)=IR(J)
        GO TO 35
20      IH2(J)=IR(J)
        GO TO 35
30      IH3(J)=IR(J)
35      CONTINUE
40      CONTINUE
        TYPE 902
902     FORMAT(' DATE OF REPORT :')
        ACCEPT 510,(ID(I),I=2,9)
        ID(1)=1H 
510     FORMAT(8A1)
        DO 905 I=1,60
905     IH(I)='   '
        CALL CENTER(IH1,IB,0,ID,IR)
        CALL CENTER(IH2,IB,0,ID,IR)
        CALL CENTER(IH3,IB,0,ID,IR)
41      WRITE(6,910)
910     FORMAT(1H1)
        WRITE(6,501)(IH1(I),I=1,60)
        WRITE(6,501)(IH2(I),I=1,60)
        WRITE(6,501)(IH3(I),I=1,60)
501     FORMAT( 34X,60A1,28X)
        CALL BLANK(6,1)
        ZXZ=8030400000
        TYPE 511,ZXZ,ZXZ,ZXZ,ZXZ,ZXZ,ZXZ,ZXZ,ZXZ,ZXZ,ZXZ,
     1  (IH1(I),I=1,60),(IH2(I),I=1,60),(IH3(I),I=1,60)
511     FORMAT( 10A1/,3(34X,60A1,28X,/))
        IF(JM.EQ.13)GO TO 31
        WRITE(6,502)
502     FORMAT( 51X,' SCHEDULE OF PARTICIPATIONS')
        CALL BLANK(6,1)
        TYPE 512
512     FORMAT( 51X,' SCHEDULE  OF PARTICIPATIONS'/)
        DO 5 K=1,JJ
        TYPE 503,JJPK(1,K),(JJPK(J,K),J=4,15)
503     FORMAT(' BUY: ',I2,5X,12A3)
        WRITE(6,503)JJPK(1,K),(JJPK(J,K),J=4,15)
5       CONTINUE
        CALL BLANK(6,2)
        TYPE 901
        TYPE 504
        WRITE(6,504)
504     FORMAT( 3X,' PARTICIPATIONS',15X,'BUY  ',3X,'LENGTHS/BRANDS',
     1 30X,'REMARKS')
        CALL BLANK(6,1)
        TYPE 901
        ILINE=JJ+9
        IF(JM.EQ.0)GO TO 50
        WRITE(6,505)JM,JD
505     FORMAT(' WEEK OF ',I2,'/',I2)
        TYPE 505,JM,JD
        ILINE=ILINE+1
        GO TO 50
31      WRITE(6,506)
        TYPE 506
506     FORMAT( 47X,' BRAND PARTICIPATIONS/COST SUMMARY',25X,
     1  'CONFIDENTIAL')
        CALL BLANK(6,2)
        TYPE 901
50      RETURN
        END
   