    P R O G R A M   T Y M T S T 		COBOL (005001,107001)	 5-JUL-73  20:21		PAGE 1
    TYMTST.CBL    05-JUL-73  20:14

    0001    IDENTIFICATION DIVISION.
    0002    PROGRAM-ID. TYMTST.
    0003    AUTHOR. ROB TRENCK.
    0004    INSTALLATION. METRO.
    0005    DATE-WRITTEN. 7-5-73.
    0006    DATE-COMPILED. 05-JUL-73. 
    0007    REMARKS. HOMEWORK PROBLEM FOR COBOL TRAINING CLASS, 7-13 TO 7-14.
    0008    ENVIRONMENT DIVISION.
    0009    CONFIGURATION SECTION.
    0010    SOURCE-COMPUTER. DECsystem-10. 
    0011    OBJECT-COMPUTER. PDP-10.
    0012    INPUT-OUTPUT SECTION.
    0013    FILE-CONTROL.
    0014           SELECT VENDOR ASSIGN TO DSK
    0015           RECORDING MODE IS ASCII.
    0016           SELECT NVNTRY ASSIGN TO DSK
    0017           RECORDING MODE IS ASCII.
    0018           SELECT REP-FILE ASSIGN TO DSK
    0019           RECORDING MODE IS ASCII.
    0020           SELECT SORT-FILE ASSIGN TO DSK
    0021           RECORDING MODE IS ASCII.
    0022    DATA DIVISION.
    0023    FILE SECTION.
    0024    FD VENDOR
	       ^

***				FATAL - VALUE OF ID & VALUE OF DATE-WRITTEN NOT ALLOWED

    0025           BLOCK CONTAINS 1 RECORD
    0026           RECORD CONTAINS 23 CHARACTERS
    0027           LABEL RECORDS ARE OMITTED
    0028           VALUE OF IDENTIFICATION IS "VENDORDAT"
    0029           DATA RECORDS ARE VEND-REC.
    0030    01  VEND-REC.
    0031           02 VEND-NAME PIC X(15).
    0032           02 VEND-NO   PIC 999.
    0033           02 VEND-CPU  PIC 9(3)V99.
    0034    FD NVNTRY
	       ^

***				FATAL - VALUE OF ID & VALUE OF DATE-WRITTEN NOT ALLOWED

    0035           BLOCK CONTAINS 1 RECORD
    0036           RECORD CONTAINS 14 CHARACTERS
    0037           LABEL RECORDS ARE OMITTED
    0038           VALUE OF IDENTIFICATION IS "NVNTRYDAT"
    0039           DATA RECORDS ARE INV-REC.
    0040    01 INV-REC.
    0041           02 INV-NO    PIC 999.
    0042           02 INV-QOH   PIC 9999.
    0043           02 INV-MIN   PIC 999.
    0044           02 INV-REORDER PIC 9999.
    0045    FD REP-FILE
	       ^

***				FATAL - VALUE OF ID & VALUE OF DATE-WRITTEN NOT ALLOWED    P R O G R A M   T Y M T S T 		COBOL (005001,107001)	 5-JUL-73  20:21		PAGE 1-1
    TYMTST.CBL    05-JUL-73  20:14


    0046           BLOCK CONTAINS 1 RECORD
    0047           RECORD CONTAINS 72 CHARACTERS
    0048           LABEL RECORDS ARE OMITTED
    0049           VALUE OF IDENTIFICATION IS "REP   DAT"
    0050           DATA RECORDS ARE REP-REC, GOOD-STUFF.
    0051    01 REP-REC PIC X(72).
    0052    01 GOOD-STUFF.
    0053           02 SORT-NAME PIC X(15)
	                                 ^

***				PERIOD ASSUMED

    0054           02 FILLER    PIC XXXXX.
    0055           02 SORT-NO    PIC 999.
    0056           02 FILLER    PIC X(6).
    0057           02 SORT-QUAN PIC 9999.
    0058           02 FILLER    PIC X(6).
    0059           02 SORT-AMT  PIC $(6).99.
    0060    DATA DIVISION.
	    ^

***				FATAL - FD EXPECTED

    0061    FILE SECTION.
    0062    SD SORT-FILE
	       ^

***				FATAL - AT LEAST 3 DEVICES MUST BE ASSIGNED TO A SORT FILE

    0063    01 SORT-REC.
	    ^

***				FATAL - IMPROPER CLAUSE

    0064    02 SORT-NAME PIC X(15).
	   1^ 2^

***				1) FATAL - NEW RECORD EXPECTED HERE
***				2) FATAL - PICTURE NOT PERMITTED

    0065    02 SORT-NO   PIC 999.
    0066    02 SORT-QUAN PIC 9999.
    0067    02 SORT-AMT  PIC 9(6)V99.
    0068    WORKING-STORAGE SECTION.
    0069    PROCEDURE DIVISION.
    0070    USER-FIRST-PARAGRAPH.
    0071           SORT SORT-FILE ASCENDING SORT-NAME,
	                                    ^

***				FATAL - NOT UNIQUELY DEFINED

    0072                   INPUT PROCEDURE GET-IN,
    0073                   OUTPUT PROCEDURE GET-OUT.
    0074           STOP RUN.
    0075    GET-IN SECTION.    P R O G R A M   T Y M T S T 		COBOL (005001,107001)	 5-JUL-73  20:21		PAGE 1-2
    TYMTST.CBL    05-JUL-73  20:14

    0076           OPEN INPUT VENDOR, NVNTRY.
    0077    READ-INV.
    0078           READ NVNTRY AT END GO TO CLOSE-IN.
    0079           IF INV-QOH < INV-MIN GO TO GOTCHA,
    0080                   OTHERWISE GO TO READ-INV.
	                  1^        2^

***				1) FATAL - THIS PROCEDURE NAME IS NOT DEFINED
***				2) FATAL - 'DEPENDING ON' CLAUSE EXPECTED

    0081    GOTCHA.
    0082           READ VENDOR AT END GO TO CLOSE-IN.
    0083           IF VEND-NO < INV-NO GO TO GOTCHA.
    0084           IF VEND-NO = INV-NO GO TO ITEM-FOUND.
    0085           IF VEND-NO > INV-NO GO TO TROUBLE.
    0086    ITEM-FOUND.
    0087           MULTIPLY INV-REORDER BY VEND-CPU GIVING SORT-AMT.
	                                                   ^

***				FATAL - NOT UNIQUELY DEFINED
***				FATAL - IMPROPER CLASS

    0088           MOVE VEND-NAME TO SORT-NAME.
	                             ^

***				FATAL - NOT UNIQUELY DEFINED

    0089           MOVE VEND-NO TO SORT-NO.
	                           ^

***				FATAL - NOT UNIQUELY DEFINED

    0090           MOVE INV-REORDER TO SORT-QUAN.
	                               ^

***				FATAL - NOT UNIQUELY DEFINED

    0091           RELEASE SORT-REC.
	                   ^

***				FATAL - RECORD NAME EXPECTED

    0092           GO TO READ-INV.
    0093    TROUBLE.
    0094           DISPLAY "INPUT FILES ARE NOT IN CORRECT SEQUENCE".
    0095           CLOSE VENDOR, NVNTRY.
    0096           STOP RUN.
    0097    CLOSE-IN.
    0098           CLOSE VENDOR, NVNTRY.
    0099    GET-OUT SECTION.
    0100    OPEN-OUTPUT.
    0101           OPEN OUTPUT REP-FILE.
    0102           MOVE SPACES TO REP-REC.
    0103           MOVE "                            SIMPLE COMPANY " TO REP-REC.
    0104           PRINT  REP-REC BEFORE ADVANCING 2.
	           ^    P R O G R A M   T Y M T S T 		COBOL (005001,107001)	 5-JUL-73  20:21		PAGE 1-3
    TYMTST.CBL    05-JUL-73  20:14


***				FATAL - STATEMENT EXPECTED

    0105           MOVE "                            VENDOR REPORT" TO REP-REC.
    0106           PRINT REP-REC BEFORE ADVANCING 3.
	           ^

***				FATAL - STATEMENT EXPECTED

    0107           MOVE SPACES TO REP-REC.
    0108           MOVE "   VENDOR          ITEM" TO REP-REC.
    0109           PRINT REP-REC BEFORE ADVANCING 1.
	           ^

***				FATAL - STATEMENT EXPECTED

    0110           MOVE "    NAME          NUMBER   QUANTITY      AMOUNT" TO REP-REC.
    0111           PRINT REP-REC BEFORE ADVANCING 1.
	           ^

***				FATAL - STATEMENT EXPECTED

    0112           MOVE SPACES TO REP-REC.
    0113    PRINT-IT.
    0114           RETURN SORT-FILE AT END GO TO E-O-J.
    0115           MOVE CORRESPONDING SORT-REC TO GOOD-STUFF.
	                              ^

***				FATAL - NOT DEFINED

    0116           WRITE GOOD-STUFF AFTER ADVANCING 2.
    0117           GO TO PRINT-IT.
    0118    E-O-J.
    0119           CLOSE REP-FILE.

22 FATAL ERRORS, 1 WARNING
