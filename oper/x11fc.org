#TIME SERIES PROGRAM FILE  -  JANUARY 26, 1970                                   000
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
C                                                                       X11A0020
C     X-11 SEASONAL ADJUSTMENT PROGRAM                                  X11A0030
C     U.S. BUREAU OF THE CENSUS                                         X11A0040
C     ECONOMIC RESEARCH AND ANALYSIS DIVISION                           X11A0050
C     JULIUS SHISKIN, CHIEF                                             X11A0060
C     PROGRAMMED BY MORTON SOMER                                        X11A0070
C     CHART ROUTINE BY NORMAN BAKKA AND MORTON SOMER                    X11A0080
C     NOVEMBER 1, 1968                                                  X11A0090
C                                                                       X11A0100
      COMMON/CA/NW,STMP(600)                                            X11A0110
      COMMON/CC/RATI(36),LTERM(12),STS(372),STSI(360)                   X11A0120
      COMMON/CF/LSER,LYR,PART,KSWK,FINAB,FINAP,KPART,AORB,OUT,MCD,SIGM, X11A0130
     1SIGML,SIGMU,IN,RADIF1,RADIF2,KDEC,NEWPAG,SPC,NAME(14)             X11A0140
      COMMON/CJ/MULADD                                                  X11A0150
      COMMON/CL/STI(360),KMTYP(360),STTDRF(360),D(7),DWT(7),FSTAR,KPRNT X11A0160
      COMMON/CM/LFDA,LLDA,KFULSM,KCHOPT,LOPT,KDWOPT,LFDC,LFDR,KTCOPT,   X11A0170
     1KSPOPT,KEXOPT,KSWT,MDEC,PCDIF(3),SMP(24),STPTDF(372),STOR(360),   X11A0180
     2STOPA(360),STPMF(360),STOPMA(360),LCYR                            X11A0190
      DIMENSION TOC(25),VSK(5),VTK(3),NF4(4),DIFRAT(6),KDCML(6)         X11A0200
      DATA NR,NP,NA,NWS /5,6,10,11/                                     X11A0210
      DATA MAX,NEWPG,SPACE /360,1H^,1H?/                                X11A0220
      DATA KDATA,KWEIGH /6H DATA ,6HWEIGHT/                             X11A0230
      DATA BLANK,KBLNK /6H      ,6H      /                              X11A0240
      DATA OUTK /3HOUT/                                                 X11A0250
      DATA (DIFRAT(I),I=1,6)/6HRATIOS,6HDIFFER,6HENCES ,6H PER C,       X11A0260
     1 6HENT CH,6HANGE  /                                               X11A0270
      DATA AS,BS,HS,TS,ZS/6HAAAAAA,6HBBBBBB,1HH,1HT,1HZ/                X11A0280
      DATA (KDCML(I),I=1,6)/1H1,1H2,1H3,1H4,1H5,1H0/                    X11A0290
      DATA(NF4(I),I=1,4) /6H(12F6.,1H0,6H,I2,A6,1H)/                    X11A0300
      DATA(TOC(I),I=1,25)/6HMULTIP,6HLICATI,2HVE,6HSEASON,6HAL ADJ,     X11A0310
     1 6HUSTMEN,2HT.,6HSTANDA,2HRD,6HSTANDA,2HRD,6HADDITI,2HVE,6HSUMMAR,X11A0320
     2 6HY MEAS,4HURES,6H    LO,2HNG,6H    FU,2HLL,2HNO,6H     A,       X11A0330
     3 6H IF SI,6HGNIFIC,4HANT./                                        X11A0340
      DATA (VSK(I),I=1,5) /2H 3,3H3X3,3H3X5,3H3X9,3HSTA/                X11A0350
      DATA (VTK(I),I=1,3) /2H 9,2H13,2H23/                              X11A0360
      NW = NA                                                           X11A0370
      NEWPAG = NEWPG                                                    X11A0380
      SPC = SPACE                                                       X11A0390
    1 KPART = 4                                                         X11A0400
      PART = AS                                                         X11A0410
      AORB = BS                                                         X11A0420
      KHED = 1                                                          X11A0430
      KEDIT = KDATA                                                     X11A0440
C --- WRITE BLANK PAGE AT START OF EACH SERIES                          X11A0450
      WRITE (NW,14) NEWPAG                                              X11A0460
   14 FORMAT (A1)                                                       X11A0470
    2 KSWERR = 0                                                        X11A0480
      KSWK = 1                                                          X11A0490
      KSWT = 4                                                          X11A0500
C --- READ SERIES OPTION CARD                                           X11A0510
    3 READ (NR,5) TCARD,LSER,LFDA,LYR,LSTMO,LSTYR,KDEC,MULADD,KFULSM,   X11A0520
     1 KPROPT,KCHOPT,DWT,LOPT,KDWOPT,LCYR,LAYR,SIGM,KSER,SIGML,SIGMU,   X11A0530
     2 LTERM,KTCOPT,KEXOPT                                              X11A0540
    5 FORMAT (A1,A6,4I2,5I1,7F4.3,2I1,2I2,F2.1,A6,2F2.1,14I1)           X11A0550
      IF (TCARD-ZS) 7,9999,7                                            X11A0560
C --- TEST NUMBER OF RECORDS ON OUTPUT TAPE                             X11A0570
    7 IF (KRCRDS-17500) 97,410,410                                      X11A0580
C --- REWIND OUTPUT TAPE AND ALTERNATE OUTPUT UNITS                     X11A0590
  410 KRCRDS = 0                                                        X11A0600
      WRITE (NP,411) NEWPAG                                             X11A0610
      WRITE (NW,411) NEWPAG                                             X11A0620
  411 FORMAT (A1,14H   END OF REEL/)                                    X11A0630
      REWIND NW                                                         X11A0640
      NTMP = NW                                                         X11A0650
      NW = NWS                                                          X11A0660
      NWS = NTMP                                                        X11A0670
   97 IF (TCARD-HS) 9000,86,9000                                        X11A0680
C     READ TITLE CARD                                                   X11A0690
   86 READ (NR,85) TCARD,NAME                                           X11A0700
   85 FORMAT (A1,13A6,A1)                                               X11A0710
      IF (TCARD-TS) 9000,6,9000                                         X11A0720
    6 KHED = 1                                                          X11A0730
C     SET NO. OF DECIMAL PLACES IN INPUT                                X11A0740
   76 IF(KDEC)74,74,73                                                  X11A0750
   73 IF (KDEC-5) 75,75,74                                              X11A0760
   74 KDEC = 6                                                          X11A0770
   75 NF4(2) = KDCML(KDEC)                                              X11A0780
      KPRNT = 1                                                         X11A0790
      DO 65 I = 1,11                                                    X11A0800
   65 STMP(I+20) = TOC(I)                                               X11A0810
C --- CHECK LENGTH OF SERIES                                            X11A0820
      LLDA = (LSTYR-LYR)*12+LSTMO                                       X11A0830
      LENGTH = LLDA-LFDA+1                                              X11A0840
      IF (LENGTH-36) 9190,58,58                                         X11A0850
   58 IF (LLDA-MAX) 59,59,9200                                          X11A0860
   59 KRCRDS = KRCRDS + 2*LENGTH + 240                                  X11A0870
   61 KYR = LYR                                                         X11A0880
C --- KRCRDS COUNTS APPROX. NO. OF OUTPUT RECORDS                       X11A0890
      LFMO = 1                                                          X11A0900
    9 LLMO = LFMO + 11                                                  X11A0910
C --- READ DATA CARDS. CHECK DATE AND IDENT                             X11A0920
C --- REGARDLESS OF MONTH IN WHICH SERIES STARTS, STOR(1) IS EQUATED TO X11A0930
C --- JANUARY, STOR(2) TO FEB , ETC.                                    X11A0940
      READ (NR,NF4) (STOR(I),I=LFMO,LLMO),MYR,MSER                      X11A0950
      IF (LSER-MSER) 9010,13,9010                                       X11A0960
   13 IF (KYR-MYR) 9030,18,9030                                         X11A0970
   18 IF (KYR-LSTYR) 15,19,19                                           X11A0980
   15 KYR = KYR +1                                                      X11A0990
   16 LFMO = LLMO +1                                                    X11A1000
      GO TO 9                                                           X11A1010
   19 IF (LFDA-1) 39,49,39                                              X11A1020
C --- TEST START AND END MONTHS                                         X11A1030
   39 J = LFDA - 1                                                      X11A1040
      DO 62 I = 1,J                                                     X11A1050
      IF (STOR(I)) 9210,62,9210                                         X11A1060
   62 CONTINUE                                                          X11A1070
   49 IF (LLDA-LLMO) 66,64,66                                           X11A1080
   66 J = LLDA + 1                                                      X11A1090
      DO 70 I = J,LLMO                                                  X11A1100
      IF (STOR(I)) 9220,70,9220                                         X11A1110
   70 CONTINUE                                                          X11A1120
   64 IF (MULADD-1) 17,27,9090                                          X11A1130
C     TEST FOR ZERO, NEGATIVE DATA- MULTIPLICATIVE VERSION              X11A1140
   17 I = LFDA                                                          X11A1150
   28 IF (STOR(I)) 9020,9020,29                                         X11A1160
   29 IF (I-LLDA) 37,26,26                                              X11A1170
   37 I = I + 1                                                         X11A1180
      GO TO 28                                                          X11A1190
   26 RADIF1 = DIFRAT(1)                                                X11A1200
      RADIF2 = BLANK                                                    X11A1210
      PCDIF(1) =DIFRAT(4)                                               X11A1220
      PCDIF(2) =DIFRAT(5)                                               X11A1230
      PCDIF(3) =DIFRAT(6)                                               X11A1240
      LDEC = 100                                                        X11A1250
      MDEC = 1                                                          X11A1260
      GO TO 41                                                          X11A1270
C --- SET TITLES FOR ADDITIVE VERSION                                   X11A1280
   27 STMP(21) = BLANK                                                  X11A1290
      STMP(22) = TOC(12)                                                X11A1300
      STMP(23) = TOC(13)                                                X11A1310
      RADIF1 = DIFRAT(2)                                                X11A1320
      RADIF2 = DIFRAT(3)                                                X11A1330
      PCDIF(1) = BLANK                                                  X11A1340
      PCDIF(2) = DIFRAT(2)                                              X11A1350
      PCDIF(3) = DIFRAT(3)                                              X11A1360
      LDEC = 0                                                          X11A1370
      MDEC = 0                                                          X11A1380
C --- SET ALL CALENDAR FACTORS TO 100. FOR MULT. OR 0. FOR ADD. VERSION X11A1390
   41 DO 20 I = LFDA,LLDA                                               X11A1400
      STTDRF(I) = LDEC                                                  X11A1410
      STPMF(I) = LDEC                                                   X11A1420
      STPTDF(I) = LDEC                                                  X11A1430
C --- SET PRIOR ADJUSTED SERIES EQUAL TO  ORIGINAL                      X11A1440
      STOPMA(I)=STOR(I)                                                 X11A1450
   20 STOPA(I)=STOR(I)                                                  X11A1460
      IF (KFULSM-1) 649,42,9080                                         X11A1470
C --- SET TITLES FOR SUMMARY MEASURES RUN                               X11A1480
   42 STMP(24) = TOC(14)                                                X11A1490
      STMP(25) = TOC(15)                                                X11A1500
      STMP(26) = TOC(16)                                                X11A1510
      STMP(27) = BLANK                                                  X11A1520
      GO TO 644                                                         X11A1530
C --- TEST PRINTOUT OPTION                                              X11A1540
  649 IF (KPROPT-2) 12,67,9100                                          X11A1550
   12 IF (KPROPT-1) 644,63,644                                          X11A1560
C --- LONG PRINTOUT                                                     X11A1570
   63 KPRNT = 2                                                         X11A1580
      KRCRDS = KRCRDS + 2*LENGTH + 80                                   X11A1590
      STMP(28) = TOC(17)                                                X11A1600
      STMP(29) = TOC(18)                                                X11A1610
      GO TO 644                                                         X11A1620
C --- FULL PRINTOUT                                                     X11A1630
   67 KPRNT = 7                                                         X11A1640
      KRCRDS = KRCRDS + 3*LENGTH + 240                                  X11A1650
      STMP(28) = TOC(19)                                                X11A1660
      STMP(29) = TOC(20)                                                X11A1670
C --- STANDARD PRINTOUT. TEST CHART OPTION                              X11A1680
  644 IF (KCHOPT-1) 637,638,636                                         X11A1690
  636 IF (KCHOPT-2) 9110,643,9110                                       X11A1700
C --- STANDARD CHARTS                                                   X11A1710
  637 KRCRDS = KRCRDS + 2*LENGTH + 200                                  X11A1720
      GO TO 43                                                          X11A1730
C --- NO CHARTS                                                         X11A1740
  638 STMP(30) = BLANK                                                  X11A1750
      STMP(31) = TOC(21)                                                X11A1760
      GO TO 43                                                          X11A1770
C --- ALL CHARTS                                                        X11A1780
  643 STMP(30) = TOC(22)                                                X11A1790
      STMP(31) = TOC(20)                                                X11A1800
      KRCRDS = KRCRDS + 4*LENGTH + 220                                  X11A1810
C --- WRITE TITLE PAGE                                                  X11A1820
   43 WRITE (NW,310)                                                    X11A1830
  310 FORMAT (44X,32HX-11 SEASONAL ADJUSTMENT PROGRAM/                  X11A1840
     147X,25HU.S. BUREAU OF THE CENSUS/                                 X11A1850
     141X,39HECONOMIC RESEARCH AND ANALYSIS DIVISION/                   X11A1860
     2 54X,16HNOVEMBER 1, 1968//                                        X11A1870
     312X,51HTHE X-11 PROGRAM IS DIVIDED INTO SEVEN MAJOR PARTS-/       X11A1880
     4 17X,22HPART       DESCRIPTION)                                   X11A1890
      WRITE (NW,323)                                                    X11A1900
  323 FORMAT (18X,28HA. PRIOR ADJUSTMENTS, IF ANY/                      X11A1910
     618X,55HB. PRELIMINARY ESTIMATES OF IRREGULAR COMPONENT WEIGHTS/   X11A1920
     725X,34HAND REGRESSION TRADING DAY FACTORS/                        X11A1930
     818X,27HC. FINAL ESTIMATES OF ABOVE/                               X11A1940
     918X,68HD. FINAL ESTIMATES OF SEASONAL, TREND-CYCLE AND IRREGULAR CX11A1950
     1OMPONENTS/                                                        X11A1960
     218X,20HE. ANALYTICAL TABLES/                                      X11A1970
     3 18X,19HF. SUMMARY MEASURES)                                      X11A1980
      WRITE (NW,324)                                                    X11A1990
  324 FORMAT (18X, 9HG. CHARTS/                                         X11A2000
     512X,99HTABLES ARE IDENTIFIED BY THEIR PART LETTER AND SEQUENCE WITX11A2010
     6HIN THE PART. A GIVEN TABLE HAS THE SAME/                         X11A2020
     712X,99HIDENTIFICATION IN THE STANDARD, LONG AND FULL PRINTOUTS. THX11A2030
     8E SAME NUMBER IS GIVEN TO CORRESPONDING /                         X11A2040
     912X,99HTABLES IN PARTS B, C AND D. THUS, TABLES B10., C10. AND D10X11A2050
     1. ARE ALL TABLES OF SEASONAL FACTORS.   /                         X11A2060
     212X,99HWHERE NO CORRESPONDING TABLE EXISTS THE SEQUENCE NO. IS NOTX11A2070
     3 USED IN THE PART. THUS, B8. AND D8. ARE/                         X11A2080
     412X,50HTABLES OF UNMODIFIED SI RATIOS BUT THERE IS NO C8.///)     X11A2090
      WRITE (NW,321) NAME,LSER,LFDA,LYR,LSTMO,LSTYR,(STMP(I),I=21,31)   X11A2100
  321 FORMAT (47X,16HTHIS SERIES RUN ,2A6/                              X11A2110
     412X,14HSERIES TITLE- ,11A6,A1,13H  SERIES NO. ,A6/                X11A2120
     545X,16HPERIOD COVERED- ,I2,1H/,I2,4H TO ,I2,1H/,I2//              X11A2130
     636X,14HTYPE OF RUN - ,2A6,A3,3A6,A1/                              X11A2140
     742X,A6,A3,10HPRINTOUT. ,A6,A3,7HCHARTS.)                          X11A2150
C --- WRITE LOG ENTRY                                                   X11A2160
      DO 642 I = 1,3                                                    X11A2170
  642 STMP(I) = BLANK                                                   X11A2180
      OUT = OUTK                                                        X11A2190
C --- TEST LENGTH OF MONTH ADJUSTMENT OPTION                            X11A2200
   25 IF (LOPT-1) 34,35,9120                                            X11A2210
C --- WITH                                                              X11A2220
   35 LOPT = 4                                                          X11A2230   OUT = BLANK                                                       X11A2240
C --- WITHOUT                                                           X11A2250
C --- TEST FOR PRIOR TRADING DAY FACTORS                                X11A2260
   34 KSWV = 0                                                          X11A2270
      I = 1                                                             X11A2280
   94 IF (DWT(I)) 9250,96,95                                            X11A2290
   95 KSWV = 1                                                          X11A2300
   96 IF (I-7) 98,31,98                                                 X11A2310
   98 I = I + 1                                                         X11A2320
      GO TO 94                                                          X11A2330
   31 IF (KSWV) 103,99,103                                              X11A2340
  103 IF (MULADD) 9260,36,9260                                          X11A2350
C --- NO PRIOR T.D.FACTORS. SET EQUAL TO 1.                             X11A2360
   99 KSWT = KSWT - 1                                                   X11A2370
      IF (MULADD) 104,102,104                                           X11A2380
  102 DO 32 I = 1,7                                                     X11A2390
   32 DWT(I) = 1.                                                       X11A2400
      GO TO 69                                                          X11A2410
  104 LOPT = 0                                                          X11A2420
      OUT = OUTK                                                        X11A2430
      GO TO 69                                                          X11A2440
   36 WRITE (NW,311) OUT                                                X11A2450
  311 FORMAT (28X,33HPRIOR TRADING DAY ADJUSTMENT WITH,A3,28H LENGTH OF X11A2460
     1MONTH ADJUSTMENT.)                                                X11A2470
C --- TEST TRADING DAY REGRESSION OPTION                                X11A2480
   69 IF (KDWOPT-3) 624,630,9130                                        X11A2490
  624 IF (KDWOPT-1) 620,630,630                                         X11A2500
C --- TEST SIGMA LIMIT FOR EXCLUDING EXTREMES FROM T.D. REGRESSION      X11A2510
  630 IF (SIGM) 9140,628,629                                            X11A2520
  628 SIGM = 2.5                                                        X11A2530
C --- TEST T.D.REGRESSION COMPUTE AND APPLY DATES                       X11A2540
  629 LLYR = LYR + (LLDA-1)/12                                          X11A2550
      IF (LCYR) 9050,611,610                                            X11A2560
  610 IF (LYR-LCYR) 613,611,9050                                        X11A2570
  613 IF (LLYR-LCYR) 9050,614,614                                       X11A2580
  611 LCYR = LYR                                                        X11A2590
  612 LFDC = LFDA                                                       X11A2600
      GO TO 615                                                         X11A2610
  614 LFDC = (LCYR-LYR)*12+1                                            X11A2620
  615 IF (LAYR) 9050,617,616                                            X11A2630
  616 IF (LYR-LAYR) 619,617,9050                                        X11A2640
  619 IF (LLYR-LAYR) 9050,621,621                                       X11A2650
  617 LAYR = LYR                                                        X11A2660
  618 LFDR = LFDA                                                       X11A2670
      GO TO 631                                                         X11A2680
  621 LFDR = (LAYR-LYR)*12+1                                            X11A2690
  631 WRITE (NW,312) LCYR,SIGM                                          X11A2700
  312 FORMAT (12X,43HTRADING DAY REGRESSION COMPUTED STARTING 19,I2,    X11A2710
     136H EXCLUDING IRREGULAR VALUES OUTSIDE ,F3.1,14H-SIGMA LIMITS.)   X11A2720
      IF (KDWOPT-2) 681,627,626                                         X11A2730
  681 WRITE (NW,313)                                                    X11A2740
  313 FORMAT (38X,45HTRADING DAY REGRESSION ESTIMATES NOT APPLIED.)     X11A2750
      GO TO 620                                                         X11A2760
  626 STMP(1) = TOC(23)                                                 X11A2770
      STMP(2) = TOC(24)                                                 X11A2780
      STMP(3) = TOC(25)                                                 X11A2790
  627 WRITE (NW,314) LAYR,(STMP(I),I=1,3)                               X11A2800
  314 FORMAT (29X,52HTRADING DAY REGRESSION ESTIMATES APPLIED STARTING 1X11A2810
     19,I2,3A6)                                                         X11A2820
C --- TEST FOR PRIOR MONTHLY ADJUSTMENT FACTORS                         X11A2830
  620 IF (KSER-KBLNK) 51,106,51                                         X11A2840
C --- READ PRIOR MONTHLY FACTORS AND CHECK DATES AND IDENT.             X11A2850
   51 LFMO = 1                                                          X11A2860
      WRITE (NW,315)                                                    X11A2870
  315 FORMAT (48X,25HPRIOR MONTHLY ADJUSTMENT.)                         X11A2880
      KYR = LYR                                                         X11A2890
      KEDIT = KWEIGH                                                    X11A2900
      IF (MULADD) 52,352,52                                             X11A2904
  352 NF4(2) = KDCML(3)                                                 X11A2905
   52 LLMO = LFMO + 11                                                  X11A2910
      READ (NR,NF4) (STPMF(I),I=LFMO,LLMO),MYR,MSER                     X11A2920
   53 FORMAT (12F6.3,I2,A6)                                             X11A2930
      IF (KSER-MSER) 9060,54,9060                                       X11A2940
   54 IF (KYR-MYR) 9070,55,9070                                         X11A2950
   55 IF (KYR-LSTYR) 56,57,57                                           X11A2960
   56 KYR = KYR + 1                                                     X11A2970
      LFMO = LLMO + 1                                                   X11A2980
      GO TO 52                                                          X11A2990
   57 IF (LFDA-1) 81,83,81                                              X11A3000
   81 J = LFDA - 1                                                      X11A3010
      DO 82 I = 1,J                                                     X11A3020
      IF (STPMF(I)) 9230,82,9230                                        X11A3030
   82 CONTINUE                                                          X11A3040
   83 IF (LLDA-LLMO) 105,87,105                                         X11A3050
  105 J = LLDA + 1                                                      X11A3060
      DO 84 I = J,LLMO                                                  X11A3070
      IF (STPMF(I)) 9240,84,9240                                        X11A3080
   84 CONTINUE                                                          X11A3090
   87 IF (MULADD) 30,21,30                                              X11A3100
C --- CHECK FOR ZERO, NEGATIVE WTS. -MULT. ADJUSTMENT ONLY.             X11A3110
   21 I = LFDA                                                          X11A3120
   24 IF (STPMF(I)) 9040,9040,22                                        X11A3130
   22 IF (I - LLDA) 23,30,23                                            X11A3140
   23 I = I + 1                                                         X11A3150
      GO TO 24                                                          X11A3160
C --- TEST SIGMA LIMITS FOR GRADUATING EXTREMES                         X11A3170
  106 KSWT = KSWT - 2                                                   X11A3180
   30 IF (SIGMU) 9150,78,77                                             X11A3190
   78 SIGMU = 2.5                                                       X11A3200
   77 IF (SIGML) 9150,88,89                                             X11A3210
   88 SIGML = 1.5                                                       X11A3220
   89 IF (SIGMU-SIGML) 9150,79,79                                       X11A3230
   79 WRITE (NW,316) SIGML,SIGMU                                        X11A3240
  316 FORMAT (31X,47HSIGMA LIMITS FOR GRADUATING EXTREME VALUES ARE ,   X11A3250
     1F3.1,5H AND ,F3.1)                                                X11A3260
C --- TEST SEASONAL FACTOR CURVE MOVING AVERAGES                        X11A3270
   44 KSWV = 0                                                          X11A3280
      I = 1                                                             X11A3290
   46 IF (LTERM(I)) 640,640,639                                         X11A3300
  639 IF (LTERM(I)-5) 645,645,9170                                      X11A3310
  640 STMP(I) = BLANK                                                   X11A3320
      GO TO 641                                                         X11A3330
  645 KSWV = 1                                                          X11A3340
      J = LTERM(I)                                                      X11A3350
      STMP(I)=VSK(J)                                                    X11A3360
  641 IF (I-12) 48,47,47                                                X11A3370
   48 I = I + 1                                                         X11A3380
      GO TO 46                                                          X11A3390
   47 IF (KSWV) 646,632,646                                             X11A3400
  646 WRITE (NW,317) (STMP(I),I=1,12)                                   X11A3410
  317 FORMAT (15X,89HMOVING AVERAGES FOR SEASONAL FACTOR CURVES- J   F  X11A3420
     1 M   A   M   J   J   A   S   O   N   D/58X,12A4)                  X11A3430
C --- TEST TREND CYCLE MOVING AVERAGE                                   X11A3440
  632 IF (KTCOPT-3) 633,635,9180                                        X11A3450
  633 IF (KTCOPT-1) 634,635,635                                         X11A3460
  634 KTCOPT = 4                                                        X11A3470
      GO TO 623                                                         X11A3480
  635 STMP(1) = VTK(KTCOPT)                                             X11A3490
      WRITE (NW,318)STMP(1)                                             X11A3500
  318 FORMAT (25X,53HMOVING AVERAGE FOR THE VARIABLE TREND CYCLE ROUTINEX11A3510
     1- ,A2,15H-TERM HENDERSON)                                         X11A3520
  623 IF (KEXOPT-1) 665,663,9270                                        X11A3530
  663 WRITE (NW,664)                                                    X11A3540
  664 FORMAT (25X,70HMODIFY EXTREME VALUES BEFORE COMPUTING THE TABLE B7X11A3550
     1. TREND CYCLE CURVE)                                              X11A3560
  665 IF (KSWT) 647,647,652                                             X11A3570
C --- SERIES REJECTED                                                   X11A3580
  647 WRITE (NW,320)                                                    X11A3590
  320 FORMAT (/48X,15HSERIES REJECTED)                                  X11A3600
      GO TO 1                                                           X11A3610
  652 WRITE (NP,319) LSER,LFDA,LYR,LSTMO,LSTYR,(STMP(I),I=21,29)        X11A3620
  319 FORMAT (8X,A6,2X,I2,1H/,I2,3H - ,I2,1H/,I2,2X,2A6,A3,3A6,A1,2X,A6,X11A3630
     1A3,9H PRINTOUT)                                                   X11A3640
      DO 92 I = 1,24                                                    X11A3650
   92 SMP(I) = 0                                                        X11A3660
      IF (KSWT-1) 33,90,33                                              X11A3670
C --- WRITE UNADJUSTED ORIGINAL SERIES -A1.                             X11A3680
   33 CALL RITE (1,STOR,LFDA,LLDA,2,7,0)                                X11A3690
      KSWK = 0                                                          X11A3700
      AORB = AS                                                         X11A3710
      IF (KSWT - 2) 60, 40, 60                                          X11A3720
C --- WRITE PRIOR MONTHLY FACTORS -A2.                                  X11A3730
   60 CALL RITE (2,STPMF,LFDA,LLDA,2,3,0)                               X11A3740
C --- COMPUTE AVGE. MONTH-TO-MONTH CHANGE IN PRIOR MONTHLY FACTORS      X11A3750
      CALL SUMRY (STPMF,SMP,LFDA,LLDA,1)                                X11A3760
C --- DIVIDE ORIGINAL BY P.M.F..RESULT IS PRIOR MONTHLY ADJUSTED        X11A3770
C --- ---IN ADDITIVE VERSION ROUTINE ADDMUL SUBTRACTS SECOND SERIES FROMX11A3780
C --- FIRST. READ *SUBTRACT B FROM A* FOR *DIVIDE A BY B* AND           X11A3790
C --- *DIFFERENCES* FOR *RATIOS* THRUOUT FOR ADDITIVE PROGRAM.          X11A3800
      CALL ADDMUL (STOPMA,STOR,STPMF,LFDA,LLDA)                         X11A3810
C --- SET PRIOR ADJUSTED EQUAL TO PRIOR MONTHLY ADJUSTED                X11A3820
      DO 71 I = LFDA, LLDA                                              X11A3830
   71 STOPA(I) = STOPMA(I)                                              X11A3840
C --- TEST FOR PRIOR TRADING DAY ADJUSTMENT                             X11A3850
      IF (KSWT-4) 90,50,90                                              X11A3860
C --- WRITE PRIOR MONTHLY ADJUSTED SERIES BEFORE T.D. ADJUSTMENT -A3.   X11A3870
   50 CALL RITE (3,STOPMA,LFDA,LLDA,5,7,0)                              X11A3880
C --- COMPUTE MONTHLY T.D.FACTORS FROM 7 PRIOR DAILY WEIGHTS            X11A3890
   40 CALL DOW (DWT,STPTDF,LYR,LFDA,LLDA,LOPT)                          X11A3900
C --- SET TRADING DAY REGRESSION FACTORS EQUAL TO PRIOR T.D.FACTORS     X11A3910
      DO 80 I = LFDA,LLDA                                               X11A3920
   80 STTDRF(I) = STPTDF(I)                                             X11A3930
C --- WRITE PRIOR TRADING DAY FACTORS -A4.                              X11A3940
      CALL RITE (4,STPTDF,LFDA,LLDA,5,4,DWT)                            X11A3950
C --- DIVIDE PRIOR MONTHLY ADJUSTED OR ORIGINAL BY PRIOR T.D. FACTORS.  X11A3960
      CALL ADDMUL (STOPA,STOPMA,STPTDF,LFDA,LLDA)                       X11A3970
   90 CALL SUBX11                                                       X11A3980
      GO TO 1                                                           X11A3990
C --- REJECT MESSAGES                                                   X11A4000
 9000 GO TO (9001, 3), KHED                                             X11A4010
 9001 WRITE (NP,9002) LSER                                              X11A4020
 9002 FORMAT (8H REJECT ,A6,24H NO HEADER OR TITLE CARD)                X11A4030
      KHED = 2                                                          X11A4040
      GO TO 2                                                           X11A4050
 9800 IF (KSWT) 9802,9802,9801                                          X11A4060
 9801 KSWT = 0                                                          X11A4070
      LENGTH = 0                                                        X11A4080
      WRITE (NP,9805) LSER                                              X11A4090
 9805 FORMAT (8H REJECT ,A6)                                            X11A4100
 9802 KSWERR = KSWERR + 1                                               X11A4110
      IF (KSWERR - 31) 9803,9804,9806                                   X11A4120
 9803 GO TO KRR1,(9012,9022,9032,9051,9092,9141,9151,9191,9201,9212,9222X11A4130
     1,9251,9261)                                                       X11A4140
 9804 WRITE (NP,9300)                                                   X11A4150
 9300 FORMAT (20X,43HERROR MESSAGES FOR THIS SERIES DISCONTINUED)       X11A4160
 9806 GO TO KRR2,(13,29,18,22,620,54,55,649,17,644,43,34,630,629,44,645,X11A4170
     1623,61,49,64,83,87,31,69,665)                                     X11A4180
 9010 ASSIGN 13 TO KRR2                                                 X11A4190
 9011 ASSIGN 9012 TO KRR1                                               X11A4200
      GO TO 9800                                                        X11A4210
 9012 WRITE (NP,9013) KEDIT,KYR,MSER                                    X11A4220
 9013 FORMAT (20X,4HTHE ,A6,12H CARD FOR 19,I2,16H IS FROM SERIES ,A6)  X11A4230
      GO TO 9806                                                        X11A4240
 9020 ASSIGN 29 TO KRR2                                                 X11A4250
 9021 ASSIGN 9022 TO KRR1                                               X11A4260
      NYR = (I-1)/12                                                    X11A4270
      NMO = I - NYR * 12                                                X11A4280
      NYR = NYR + LYR                                                   X11A4290
      GO TO 9800                                                        X11A4300
 9022 WRITE (NP,9023) KEDIT,NMO,NYR                                     X11A4310
 9023 FORMAT (20X,4HTHE ,A6,5H FOR ,I2,1H/,I2,20H IS ZERO OR NEGATIVE)  X11A4320
      GO TO 9806                                                        X11A4330
 9030 ASSIGN 18 TO KRR2                                                 X11A4340
 9031 ASSIGN 9032 TO KRR1                                               X11A4350
      GO TO 9800                                                        X11A4360
 9032 WRITE (NP,9033) KEDIT,KYR,MYR                                     X11A4370
 9033 FORMAT (20X,4HTHE , A6,12H CARD FOR 19,I2,12H IS DATED 19,I2)     X11A4380
      GO TO 9806                                                        X11A4390
 9040 ASSIGN 22 TO KRR2                                                 X11A4400
      GO TO 9021                                                        X11A4410
 9050 ASSIGN 620 TO KRR2                                                X11A4420
      ASSIGN 9051 TO KRR1                                               X11A4430
      GO TO 9800                                                        X11A4440
 9051 WRITE (NP,9052)                                                   X11A4450
 9052 FORMAT (20X,55HREGRESSION DATES (COLS 51-52 OR 53-54) ARE INCONSISX11A4460
     1TENT)                                                             X11A4470
      GO TO 9806                                                        X11A4480
 9060 ASSIGN 54 TO KRR2                                                 X11A4490
      GO TO 9011                                                        X11A4500
 9070 ASSIGN 55 TO KRR2                                                 X11A4510
      GO TO 9031                                                        X11A4520
 9080 ASSIGN 649 TO KRR2                                                X11A4530
      KCOL = 18                                                         X11A4540
      KERR = KFULSM                                                     X11A4550
      GO TO 9091                                                        X11A4560
 9090 ASSIGN 17 TO KRR2                                                 X11A4570
      KCOL = 17                                                         X11A4580
      KERR = MULADD                                                     X11A4590
 9091 ASSIGN 9092 TO KRR1                                               X11A4600
      GO TO 9800                                                        X11A4610
 9092 WRITE (NP,9093) KCOL,KERR                                         X11A4620
 9093 FORMAT (20X,30HTHE ENTRY IN OPTION CARD COL. ,I2,4H IS ,I1,21H WHIX11A4630
     1CH IS NOT DEFINED)                                                X11A4640
      GO TO 9806                                                        X11A4650
 9100 ASSIGN 644 TO KRR2                                                X11A4660
      KCOL = 19                                                         X11A4670
      KERR = KPROPT                                                     X11A4680
      GO TO 9091                                                        X11A4690
 9110 ASSIGN 43 TO KRR2                                                 X11A4700
      KCOL = 20                                                         X11A4710
      KERR = KCHOPT                                                     X11A4720
      GO TO 9091                                                        X11A4730
 9120 ASSIGN 34 TO KRR2                                                 X11A4740
      KCOL = 49                                                         X11A4750
      KERR = LOPT                                                       X11A4760
      GO TO 9091                                                        X11A4770
 9130 ASSIGN 630 TO KRR2                                                X11A4780
      KCOL = 50                                                         X11A4790
      KERR = KDWOPT                                                     X11A4800
      GO TO 9091                                                        X11A4810
 9140 ASSIGN 629 TO KRR2                                                X11A4820
      ASSIGN 9141 TO KRR1                                               X11A4830
      GO TO 9800                                                        X11A4840
 9141 WRITE (NP,9142)                                                   X11A4850
 9142 FORMAT (20X,45HNEGATIVE SIGMA LIMIT NOT ALLOWED (COLS 55-56))     X11A4860
      GO TO 9806                                                        X11A4870
 9150 ASSIGN 44 TO KRR2                                                 X11A4880
      ASSIGN 9151 TO KRR1                                               X11A4890
      GO TO 9800                                                        X11A4900
 9151 WRITE (NP,9152)                                                   X11A4910
 9152 FORMAT (20X,49HSIGMA LIMITS (COLS. 63-64 OR 65-66) ARE INCORRECT) X11A4920
      GO TO 9806                                                        X11A4930
 9170 ASSIGN 645 TO KRR2                                                X11A4940
      KCOL = I + 66                                                     X11A4950
      KERR = LTERM(I)                                                   X11A4960
      GO TO 9091                                                        X11A4970
 9180 ASSIGN 623 TO KRR2                                                X11A4980
      KCOL = 79                                                         X11A4990
      KERR = KTCOPT                                                     X11A5000
      GO TO 9091                                                        X11A5010
 9190 ASSIGN 61 TO KRR2                                                 X11A5020
      ASSIGN 9191 TO KRR1                                               X11A5030
      GO TO 9800                                                        X11A5040
 9191 WRITE (NP,9192)                                                   X11A5050
 9192 FORMAT (20X,38HTHE SERIES IS LESS THAN 36 MONTHS LONG)            X11A5060
      GO TO 9806                                                        X11A5070
 9200 ASSIGN 61 TO KRR2                                                 X11A5080
      ASSIGN 9201 TO KRR1                                               X11A5090
      LSTYR = LYR + 29                                                  X11A5100
      GO TO 9800                                                        X11A5110
 9201 WRITE (NP,9202)                                                   X11A5120
 9202 FORMAT (20X,42HSERIES EXCEEDS 30 CALENDAR YEARS IN LENGTH)        X11A5130
      GO TO 9806                                                        X11A5140
 9210 ASSIGN 49 TO KRR2                                                 X11A5150
 9211 ASSIGN 9212 TO KRR1                                               X11A5160
      GO TO 9800                                                        X11A5170
 9212 WRITE (NP,9213) KEDIT                                             X11A5180
 9213 FORMAT (20X,4HTHE ,A6,33H SERIES STARTS IN THE WRONG MONTH)       X11A5190
      GO TO 9806                                                        X11A5200
 9220 ASSIGN 64 TO KRR2                                                 X11A5210
 9221 ASSIGN 9222 TO KRR1                                               X11A5220
      GO TO 9800                                                        X11A5230
 9222 WRITE (NP,9223) KEDIT                                             X11A5240
 9223 FORMAT (20X,4HTHE ,A6,31H SERIES ENDS IN THE WRONG MONTH)         X11A5250
      GO TO 9806                                                        X11A5260
 9230 ASSIGN 83 TO KRR2                                                 X11A5270
      GO TO 9211                                                        X11A5280
 9240 ASSIGN 87 TO KRR2                                                 X11A5290
      GO TO 9221                                                        X11A5300
 9250 ASSIGN 31 TO KRR2                                                 X11A5310
      ASSIGN 9251 TO KRR1                                               X11A5320
      GO TO 9800                                                        X11A5330
 9251 WRITE (NP,9252)                                                   X11A5340
 9252 FORMAT (20X,46HNEGATIVE PRIOR TRADING DAY WEIGHTS NOT ALLOWED)    X11A5350
      GO TO 9806                                                        X11A5360
 9260 ASSIGN 69 TO KRR2                                                 X11A5370
      ASSIGN 9261 TO KRR1                                               X11A5380
      GO TO 9800                                                        X11A5390
 9261 WRITE (NP,9262)                                                   X11A5400
 9262 FORMAT (20X,63HPRIOR TRADING DAY ADJUSTMENT NOT ALLOWED IN ADDITIVX11A5410
     1E ADJUSTMENT)                                                     X11A5420
      GO TO 9806                                                        X11A5430
 9270 ASSIGN 665 TO KRR2                                                X11A5440
      KCOL = 80                                                         X11A5450
      KERR = KEXOPT                                                     X11A5460
      GO TO 9091                                                        X11A5470
C --- FINISH                                                            X11A5480
 9999 WRITE (NW,411) NEWPAG                                             X11A5490
      WRITE (NP,411) NEWPAG                                             X11A5500
      REWIND NW                                                         X11A5510
10000 STOP                                                              X11A5520
      END                                                               X11A5530
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
      SUBROUTINE SUBX11                                                 X11B0020
      COMMON/CA/NW,STMP(600)                                            X11B0030
      COMMON/CB/RATIC,NTERM,STC(360),STCI(360)                          X11B0040
      COMMON/CC/RATI(36),LTERM(12),STS(372),STSI(360)                   X11B0050
      COMMON/CF/LSER,LYR,PART,KSWK,FINAB,FINAP,KPART,AORB,OUT,MCD,SIGM, X11B0060
     1SIGML,SIGMU,IN,RADIF1,RADIF2,KDEC,NEWPAG,SPC,NAME(14)             X11B0070
      COMMON/CJ/MULADD                                                  X11B0080
      COMMON/CL/STI(360),KMTYP(360),STTDRF(360),D(7),DWT(7),FSTAR,KPRNT X11B0090
      COMMON/CM/LFDA,LLDA,KFULSM,KCHOPT,LOPT,KDWOPT,LFDC,LFDR,KTCOPT,   X11B0100
     1KSPOPT,KEXOPT,KSWT,MDEC,PCDIF(3),SMP(24),STPTDF(372),STOR(360),   X11B0110
     2STOPA(360),STPMF(360),STOPMA(360),LCYR                            X11B0120
      DIMENSION STCIME(360),STCSI(360),STSP(360),STSIE(360),STDEV(360), X11B0130
     1STIME(360),STMCD(360),STOCCA(360),STOME(360),STWT(360),           X11B0140
     2 SMO(48),SMCI(48),SMI(48),SMC(48),SMS(48),SMTD(24),               X11B0150
     3 SMMCD(48),SMOME(12),SMCIME(12),SMIME(12),SMIC(12),SMO2(12)       X11B0160
C --- THIS EQUIVALENCE IS USED ONLY TO REDUCE SIZE OF PROGRAM STORAGE   X11B0170
      EQUIVALENCE (STTDRF,STMCD,STSP),(STPTDF,STSIE),(STOPMA,STIME),    X11B0180
     1 (STOCCA,STOME),(STCSI,STCIME),(STOPA,SMO),(STOPA(49),SMCI),      X11B0190
     2 (STOPA(97),SMI),(STOPA(145),SMC),(STOPA(193),SMS),(STOPA(241),   X11B0200
     3 SMTD),(STOPA(265),SMMCD),(STOPA(313),SMOME),(STOPA(325),SMCIME), X11B0210
     4 (STOPA(337),SMIME),(STOPA(349),SMIC)                             X11B0220
      EQUIVALENCE (STMP(2),STMP2),(STOR(2),STOR2),(STCI(2),STCI2)       X11B0230
      DATA BLANK,FINAL,PRELIM /6H      ,6H FINAL,6HPRELIM/              X11B0240
      DATA BS,CS,DS,ES/6HBBBBBB,6HCCCCCC,6HDDDDDD,6HEEEEEE/             X11B0250
      DATA FS,GS /6HFFFFFF,6HGGGGGG/                                    X11B0260
      DATA STAR /6H******/                                              X11B0270
      FINAB = BLANK                                                     X11B0280
      FINAP = PRELIM                                                    X11B0290
      KSECT = 1                                                         X11B0300
   90 KPART = 1                                                         X11B0310
      PART = BS                                                         X11B0320
C --- WRITE ORIGINAL OR PRIOR ADJUSTED -B1.                             X11B0330
      CALL RITE (1,STOPA,LFDA,LLDA,2,7,0)                               X11B0340
C --- SET COMPLETELY CALENDAR ADJUSTED SERIES EQUAL TO PRIOR ADJUSTED   X11B0350
C --- OR ORIGINAL                                                       X11B0360
      DO 91 I = LFDA, LLDA                                              X11B0370
      STOCCA(I) = STOPA(I)                                              X11B0380
   91 STCSI(I) = STOPA(I)                                               X11B0390
C --- THE FOLLOWING CODING IS USED IN PARTS B,C, AND D                  X11B0400
C --- CENTERED 12-TERM MVG AVGE OF ORIGINAL OR PRIOR ADJUSTED           X11B0410
C --- IN PART C, MODIFIED BY PRELIM WTS AND IN PART D MOD. BY FINAL WTS.X11B0420
  100 MFDA = LFDA + 6                                                   X11B0430
      MLDA = LLDA - 6                                                   X11B0440
      DO 101 I = MFDA, MLDA                                             X11B0450
  101 STC(I) =(STCSI(I-6) + STCSI(I+6) + 2.*(STCSI(I-5) + STCSI(I-4) +  X11B0460
     1STCSI(I-3) + STCSI(I-2) + STCSI(I-1) + STCSI(I) + STCSI(I+1) +    X11B0470
     2STCSI(I+2) + STCSI(I+3) + STCSI(I+4) + STCSI(I+5)))/24.           X11B0480
C --- THE VARIABLE*KPRNT* CONTROLS THE PRINTING AND SUPPRESSION OF      X11B0490
C --- TABLES. KPRNT IS ASSIGNED THE VALUE 1,2, OR 7 FOR THE SHORT, LONG,X11B0500
C --- OR FULL PRINTOUTS RESPECTIVELY. KPRNT IS INCREASED BY 2 AT THE ENDX11B0510
C --- OF PART B AND AGAIN AT THE END OF PART C THUS GIVING A UNIQUE     X11B0520
C --- VALUE TO EACH COMBINATION OF PRINTOUT AND PART. THE VALUES        X11B0530
C --- SELECTED WERE CHOSEN TO REDUCE THE NO. OF TESTS REQUIRED BEFORE   X11B0540
C --- EACH CALL TO *RITE*)                                              X11B0550
      IF (KPRNT-2) 251,252,251                                          X11B0560
  251 IF (KPRNT-6) 253,253,252                                          X11B0570
C --- WRITE TREND CYCLE -B2,C2, OR D2.                                  X11B0580
  252 CALL RITE (2,STC,MFDA,MLDA,5,7,0)                                 X11B0590
C --- DIVIDE ORIGINAL BY TREND CYCLE FOR SI RATIOS                      X11B0600
  253 CALL ADDMUL (STSI,STCSI,STC,MFDA,MLDA)                            X11B0610
      KADD = 0                                                          X11B0620
      GO TO (112,113,113),KPART                                         X11B0630
C --- PART B ONLY                                                       X11B0640
  112 KTABL = 3+KADD                                                    X11B0650
      IF (KPRNT-7) 110,254,110                                          X11B0660
C --- WRITE SI RATIOS -B3, OR B8.                                       X11B0670
  254 CALL RITE (KTABL,STSI,MFDA,MLDA,5,4,0)                            X11B0680
C --- COMPUTE 5-TERM MVG AVG OF EACH MONTH SEPARATELY FOR ESTIMATE OF   X11B0690
C --- SEASONAL FACTORS. TO CENTER COMPUTE A CENTERED 12-TERM M.A. OF    X11B0700
C --- ENTIRE SERIES                                                     X11B0710
  110 CALL VSFC (MFDA,MLDA,KSECT)                                       X11B0720
C --- DIVIDE SI RATIOS BY ESTIMATED SEASONAL FACTORS FOR ESTIMATE OF IRRX11B0730
      CALL ADDMUL (STI,STSI,STS,MFDA,MLDA)                              X11B0740
C --- IDENTIFY EXTREME IRREGULAR VALUES -SEE XTRM FOR METHOD            X11B0750
      CALL XTRM (STI,STDEV,STWT,MFDA,MLDA,SIGMU,SIGML,KEXT)             X11B0760
C --- REPLACE CORRESPONDING SI RATIOS FOR IRR. VALUES RECVING LESS THAN X11B0770
C --- FULL WEIGHT                                                       X11B0780
C --- STI USED TO STORE REPLACEMENT VALUES ONLY FOR WRITING B4. OR B9.  X11B0790
      DO 148 I = LFDA, LLDA                                             X11B0800
  148 STI(I) = 10**10                                                   X11B0810
C --- FOR EACH MONTH SEPARATELY                                         X11B0820
      DO 163 I = 1,12                                                   X11B0830
      KFDA = MFDA + I - 1                                               X11B0840
      SIN = 0.                                                          X11B0850
      TMP = 0.                                                          X11B0860
      DO 140 II = KFDA,MLDA,12                                          X11B0870
      TMP = TMP + STSI(II)                                              X11B0880
  140 SIN = SIN + 1.                                                    X11B0890
      TMP = TMP/SIN                                                     X11B0900
      DO 163 J = KFDA, MLDA, 12                                         X11B0910
C --- TEST FOR FULL WEIGHT -100.                                        X11B0920
      IF (STWT(J)-100.) 123,163,123                                     X11B0930
  123 KSWEX = 2                                                         X11B0940
C --- COMPUTE AVGE OF NON-FULL WT. VALUE  TIMES ITS WT. AND 4 NEAREST   X11B0950
C --- FULL WT. VALUES                                                   X11B0960
      STSI(J) = STSI(J) * STWT(J)/100.                                  X11B0970
      N = 0                                                             X11B0980
      NT = 400                                                          X11B0990
      IF (J-12-KFDA) 125,125,124                                        X11B1000
  124 IF (J+24-MLDA)126,126,125                                         X11B1010
  125 NT = 300                                                          X11B1020
  126 K = 12                                                            X11B1030
      K2 = 12                                                           X11B1040
      KSWA = 0                                                          X11B1050
  131 L = J - K                                                         X11B1060
      IF (L-KFDA) 132,133,133                                           X11B1070
  132 KSWA = 1                                                          X11B1080
      GO TO 135                                                         X11B1090
  133 IF (STWT(L)-100.) 141,134,141                                     X11B1100
  134 STSI(J) = STSI(J) + STSI(L)                                       X11B1110
      N = N + 100                                                       X11B1120
      IF (N-NT) 135,143,143                                             X11B1130
  135 M = J + K2                                                        X11B1140
      IF (M-MLDA) 137,137,136                                           X11B1150
  136 IF (KSWA) 145,139,145                                             X11B1160
  137 IF (STWT(M)-100.) 142,138,142                                     X11B1170
  138 STSI(J) = STSI(J) + STSI(M)                                       X11B1180
      N = N + 100                                                       X11B1190
      IF (N-NT) 139,143,143                                             X11B1200
  139 K2 = K2 + 12                                                      X11B1210
  141 K = K + 12                                                        X11B1220
      GO TO 131                                                         X11B1230
  142 K2 = K2 + 12                                                      X11B1240
      GO TO 135                                                         X11B1250
C --- IF FEWER THAN 4 FULL WEIGHT VALUES IN MONTH, REPLACE EXTREME WITH X11B1260
C --- AVGE OF ALL SI RATIOS.                                            X11B1270
  145 STSI(J) = TMP                                                     X11B1280
      GO TO 171                                                         X11B1290
  143 X = N                                                             X11B1300
      STSI(J) = STSI(J)/(STWT(J)+X)*100.                                X11B1310
  171 STI(J) = STSI(J)                                                  X11B1320
  163 CONTINUE                                                          X11B1330
      KTABL = 4 + KADD                                                  X11B1340
      IN = 1                                                            X11B1350
      IF (KPRNT-7) 256,255,256                                          X11B1360
C --- WRITE REPLACEMENT VALUES FOR EXTREME SI RATIOS -B4. OR B9.        X11B1370
  255 CALL RITE (KTABL,STI,MFDA,MLDA,6,6,STDEV)                         X11B1380
  256 GO TO (169,180), KSECT                                            X11B1390
C --- PART C + D ONLY.                                                  X11B1400
  113 IF (KPRNT-6) 169,169,257                                          X11B1410
C --- WRITE MODIFIED SI RATIOS -C4. OR D4.                              X11B1420
  257 CALL RITE (4,STSI,MFDA,MLDA,5,4,0)                                X11B1430
C --- THE FOLLOWING CODING IS USED IN PARTS B,C AND D                   X11B1440
C --- COMPUTE ESTIMATE OF SEASONAL FACTORS                              X11B1450
  169 CALL VSFC (MFDA,MLDA,KSECT)                                       X11B1460
C --- REPLACE 6 MISSING VALUES AT EACH END DUE TO USE OF CENTERED       X11B1470
C --- 12-TERM TREND CYCLE MOVING AVERAGE                                X11B1480
      DO 170 I = 1,6                                                    X11B1490
      J = LFDA + I - 1                                                  X11B1500
      K = LLDA - I + 1                                                  X11B1510
      STS(J) = STS(J+12)                                                X11B1520
  170 STS(K) = STS(K-12)                                                X11B1530
C --- OBTAIN PRLIM SEASONALLY ADJUSTED SERIES                           X11B1540
      CALL ADDMUL (STCI,STCSI,STS,LFDA,LLDA)                            X11B1550
      IF (KPRNT-6) 259,259,258                                          X11B1560
C --- WRITE SEASONAL FACTORS -B5.,C5., OR D5.                           X11B1570
  258 CALL RITE (5,STS,LFDA,LLDA,4,4,0)                                 X11B1580
C --- WRITE SEASONALLY ADJUSTED SERIES -B6.,C6., OR D6.                 X11B1590
      CALL RITE (6,STCI,LFDA,LLDA,5,7,0)                                X11B1600
  259 KSECT = 2                                                         X11B1610
      GO TO (160,168,168),KPART                                         X11B1620
C --- PART B ONLY                                                       X11B1630
  160 NTERM = 999                                                       X11B1640
C --- APPLY VARIABLE TREND CYCLE ROUTINE TO SEASONALLY ADJUSTED SERIES  X11B1650
C --- *VTC MODIFIED SO 13-TERM M.A. IS SELECTED FOR I/C OF 1. OR MORE*  X11B1660
      IF (KEXOPT) 161,168,161                                           X11B1670
C --- MODIFY CI VALUES BEFORE TREND CYCLE ROUTINE IF OPTION SELECTED    X11B1680
  161 CALL VTC (LFDA,LLDA,KTCOPT)                                       X11B1690
C --- DIVIDE SEASONALLY ADJUSTED SERIES BY TREND CYCLE FOR ESTIMATE OF IX11B1700
C --- IRREGULAR                                                         X11B1710
      CALL ADDMUL (STI,STCI,STC,LFDA,LLDA)                              X11B1720
C --- IDENTIFY EXTREME IRREGULAR VALUES                                 X11B1730
      CALL XTRM (STI,STDEV,STWT,LFDA,LLDA,SIGMU,SIGML,KEXT)             X11B1740
C --- REPLACE CORRESPONDING CI VALUES FOR IRRS. RECVING LESS THAN FULL  X11B1750
C --- WEIGHT                                                            X11B1760
      DO 167 I = LFDA, LLDA                                             X11B1770
      IF (STWT(I)-100.) 162,167,167                                     X11B1780
  162 STCI(I) = STCI(I)*STWT(I)/100.                                    X11B1790
      N = 0                                                             X11B1800
      NT = 400                                                          X11B1810
      IF (I-1-LFDA) 165,165,164                                         X11B1820
  164 IF (I+1-LLDA) 166,165,165                                         X11B1830
  165 NT = 300                                                          X11B1840
  166 K = 1                                                             X11B1850
      K2 = 1                                                            X11B1860
      KSWA = 0                                                          X11B1870
  146 L = I - K                                                         X11B1880
      IF (L-LFDA) 150,151,151                                           X11B1890
  150 KSWA = 1                                                          X11B1900
      GO TO 153                                                         X11B1910
  151 IF (STWT(L)-100.) 158,152,152                                     X11B1920
  152 STCI(I) = STCI(I) + STCI(L)                                       X11B1930
      N = N + 100                                                       X11B1940
      IF (N-NT) 153,144,144                                             X11B1950
  153 L = I + K2                                                        X11B1960
      IF(L-LLDA) 155,155,154                                            X11B1970
  154 IF (KSWA) 144,157,144                                             X11B1980
  155 IF (STWT(L)-100.) 159,156,159                                     X11B1990
  156 STCI(I) = STCI(I) + STCI(L)                                       X11B2000
      N = N + 100                                                       X11B2010
      IF (N-NT) 157,144,144                                             X11B2020
  157 K2 = K2 + 1                                                       X11B2030
  158 K = K + 1                                                         X11B2040
      GO TO 146                                                         X11B2050
  159 K2 = K2 + 1                                                       X11B2060
      GO TO 153                                                         X11B2070
  144 X = N                                                             X11B2080
      STCI(I) = STCI(I)/(STWT(I)+X)*100.                                X11B2090
  167 CONTINUE                                                          X11B2100
C --- THE FOLLOWING CODING IS USED IN PARTS B,C AND D                   X11B2110
C --- APPLY THE VARIABLE TREND CYCLE ROUTINE TO THE (MODIFIED) CI VALUESX11B2120
  168 CALL VTC (LFDA,LLDA,KTCOPT)                                       X11B2130
  178 IF (KPRNT-5) 260,262,261                                          X11B2140
  260 GO TO (262,261,262,261),KPRNT                                     X11B2150
C --- WRITE TREND CYCLE -B7.,C7., OR D7.                                X11B2160
  261 CALL RITE (7,STC,LFDA,LLDA,5,7,0)                                 X11B2170
C --- DIVIDE B1 BY B7 *C1 BY C7,D1 BY D7* TO OBTAIN SI RATIOS           X11B2180
  262 CALL ADDMUL (STSI,STCSI,STC,LFDA,LLDA)                            X11B2190
      MFDA = LFDA                                                       X11B2200
      MLDA = LLDA                                                       X11B2210
  179 KADD = 5                                                          X11B2220
      GO TO (112,676,176),KPART                                         X11B2230
C --- PART C ONLY                                                       X11B2240
  676 IF (KPRNT-9) 180,264,180                                          X11B2250
C --- WRITE MODIFIED SI RATIOS C9.                                      X11B2260
  264 CALL RITE (9,STSI,LFDA,LLDA,5,4,0)                                X11B2270
C --- PART B AND C                                                      X11B2280
C --- COMPUTE WEIGHTED 7-TERM MVG AVG OF EACH MONTH SEPARATELY FOR      X11B2290
C --- ESTIMATE OF SEASONAL FACTORS. TO CENTER COMPUTE CENTERED 12-TERM MX11B2300
C --- MOVING AVGE OF ENTIRE SERIES                                      X11B2310
  180 CALL VSFC (MFDA,MLDA,KSECT)                                       X11B2320
      IF (KPRNT-3) 265,267,266                                          X11B2330
  265 IF (KPRNT-1) 266,267,266                                          X11B2340
C --- WRITE SEASONAL FACTORS -B10. OR C10.                              X11B2350
  266 CALL RITE (10,STS,LFDA,LLDA,4,4,0)                                X11B2360
C --- DIVIDE PRIOR ADJUSTED SERIES*B1. OR A1* BY SEASONAL FACTORS TO    X11B2370
C --- OBTAIN A PRELIM SEASONALLY ADJUSTED SERIES                        X11B2380
  267 CALL ADDMUL (STCI,STOPA,STS,LFDA,LLDA)                            X11B2390
      IF (KPRNT-4) 269,269,268                                          X11B2400
C --- WRITE SEASONALLY ADJUSTED SERIES -B11. OR C11.                    X11B2410
  268 CALL RITE (11,STCI,LFDA,LLDA,5,7,0)                               X11B2420
C --- DIVIDE SEASONALLY ADJUSTED SERIES BY TREND CYCLE TO OBTAIN PRELIM X11B2430
C --- IRREGULAR                                                         X11B2440
  269 CALL ADDMUL (STI,STCI,STC,LFDA,LLDA)                              X11B2450
      IF (KPRNT-3) 187,187,240                                          X11B2460
C --- WRITE IRREGULAR SERIES -B13. OR C13. *B12. +C12. NOT USED*        X11B2470
  240 CALL RITE (13,STI,LFDA,LLDA,3,5,0)                                X11B2480
  187 KSWK = KDWOPT * 4 + KSWT                                          X11B2490
      IF (KDWOPT) 300,300,204                                           X11B2500
  204 KSWK = KSWK - 4                                                   X11B2510
C --- COMPUTE TRADING DAY REGRESSION FACTORS FOR ALL OPTIONS EXCEPT     X11B2520
C --- *SKIP REGRESSION*                                                 X11B2530
  207 CALL TRADAY (LFDC,LLDA,LCYR,SIGM,KPART,LOPT,KSWT)                 X11B2540
      IF (MULADD) 208,203,208                                           X11B2545
C --- IF MULT., ADD 1. TO EACH DAILY FACTOR                             X11B2550
  203 DO 200 I = 1, 7                                                   X11B2560
  200 D(I) = D(I) + 1.                                                  X11B2570
C --- COMPUTE MONTHLY FACTORS FROM 7 T.D.REGR. FACTORS                  X11B2580
      MOPT = 0                                                          X11B2584
      GO TO (208,205,208,205),KSWT                                      X11B2585
  205 MOPT = 8                                                          X11B2586
  208 CALL DOW (D,STTDRF,LYR,LFDA,LLDA,MOPT)                            X11B2590
      IF (KPRNT-1) 271,302,271                                          X11B2600
C --- WRITE T.D.REGRESSION FACTORS -B16. OR C16.                        X11B2610
  271 CALL RITE (16,STTDRF,LFDR,LLDA,4,4,D)                             X11B2620
C --- SKIP BALANCE OF TRADING DAY REGR. IF *COMPUTE BUT DO NOT APPLY*   X11B2630
C --- OPTION WAS SELECTED                                               X11B2640
  302 IF (KDWOPT-2) 300,230,202                                         X11B2650
C --- DISREGARD RESULTS OF F-TEST IN PART B IF *APPLY ON BASIS OF F* O  X11B2660
C --- OPTION SELECTED AND APPLY T.D.REGRESSION                          X11B2670
  202 IF (KPART-1) 206,201,206                                          X11B2680
C --- IN PART C APPLY T.D. REGR. OR NOT ON BASIS OF F.                  X11B2690
  206 IF (FSTAR-BLANK) 201,221,201                                      X11B2700
  221 KSWK = KSWK - 8                                                   X11B2710
      GO TO 300                                                         X11B2720
  201 KSWK = KSWK - 4                                                   X11B2730
C --- DIVIDE IRREGULAR BY T.D. REGR FACTORS TO OBTAIN AN IRREGULAR FREE X11B2740
C --- OF T.D.VARIATION                                                  X11B2750
  230 CALL ADDMUL (STI,STI,STTDRF,LFDR,LLDA)                            X11B2760
C --- COMPUTE WEIGHTS FOR IRREGULAR COMPONENT                           X11B2770
  300 CALL XTRM (STI,STDEV,STWT,LFDA,LLDA,SIGMU,SIGML,KEXT)             X11B2780
C --- WRITE WEIGHTS FOR IRREGULAR COMPONENT -B17. OR C17.               X11B2790
      IN = 1                                                            X11B2800
      DO 233 I = LFDA,LLDA                                              X11B2805
  233 STMP(I) = STPTDF(I)                                               X11B2806
      IF (KPRNT-1) 272,273,272                                          X11B2810
  272 CALL RITE (17,STWT,LFDA,LLDA,6,1,STDEV)                           X11B2820
C --- IF THERE ARE PRIOR T.D. WEIGHTS AND REGR.T.D. WTS B18.,C18,B19,C19X11B2830
C --- ARE PRINTED OUT. IF THERE ARE NO T.D. WIGHTS THEY ARE SUPPRESSED. X11B2840
C --- IF THERE ARE PRIOR T.D. WTS. BUT NO REGR. WTS. B18 AND C18 ARE THEX11B2850
C --- SAME AS A4 AND B19 AND C19 ARE THE SAME AS B1. IF THERE ARE REGR  X11B2860
C --- WTS AND NO PRIOR T.D. WTS B18 AND C18 ARE THE SAME AS B16 +C16    X11B2870
C --- AND B19 + C19 ARE PRINTED OUT                                     X11B2880
  273 GO TO (359,356,359,356,355,340,355,340),KSWK                      X11B2890
  356 IF (KPRNT-2) 359,359,358                                          X11B2900
  358 CALL RITE (18,0,0,0,18,0,0)                                       X11B2910
  359 GO TO 232                                                         X11B2940
  355 IF (KPART - 1) 366,366,373                                        X11B2945
  373 IF (LOPT) 366,366,340                                             X11B2950
  366 DO 314 I = LFDR,LLDA                                              X11B2955
  314 STMP(I) = STTDRF(I)                                               X11B2956
      IF (KPRNT-2) 232,232,357                                          X11B2960
  357 CALL RITE (18,0,0,0,19,0,0)                                       X11B2970
      GO TO 232                                                         X11B2980
C --- COMBINE PRIOR AND REGR WTS                                        X11B2990
  340 DO 337 I = 1, 7                                                   X11B3000
  337 D(I) = D(I) + DWT(I) - 1.                                         X11B3010
C --- COMPUTE MONTHLY FACTORS FROM COMBINED DAILY WTS.                  X11B3020
      CALL DOW (D,STMP,LYR,LFDR,LLDA,LOPT)                              X11B3030
      IF (KPRNT-2) 232,232,275                                          X11B3040
C --- WWRITE TRADING DAY FACTORS FROM COMBINED WTS. -B18. OR C18.       X11B3050
  275 CALL RITE (18,STMP,LFDA,LLDA,4,4,D)                               X11B3060
  232 IF (KPART-1) 350,350,351                                          X11B3070
C --- PART C ONLY                                                       X11B3080
C --- COMPUTE AVGE MONTH-TO-MONTH CHANGES OF COMBINED T.D. FACTORS      X11B3090
  351 DO 311 I = LFDA,LLDA                                              X11B3095
  311 STTDRF(I) = STMP(I)                                               X11B3096
      CALL SUMRY (STTDRF,SMTD,LFDA,LLDA,1)                              X11B3100
C --- PART B AND C                                                      X11B3110
C --- DIVIDE PRIOR MONTHLY ADJUSTED -*A3 OR A1* BY COMBINED T.D. FACTORSX11B3120
C --- TO OBTAIN CALENDAR ADJUSTED SERIES                                X11B3130
  350 CALL ADDMUL (STOCCA,STOPMA,STMP,LFDA,LLDA)                        X11B3140
      IF (KSWK-3) 370,354,352                                           X11B3150
  370 IF (KSWK-1) 352,354,352                                           X11B3160
  352 IF (KPRNT-2) 354,354,277                                          X11B3170
C --- WRITE ORIGINAL SERIES ADJUSTED FOR CALENDAR VARIATION -B19 OR C19.X11B3180
  277 CALL RITE (19,STOCCA,LFDA,LLDA,2,7,0)                             X11B3190
C --- MODIFY THE ORIGINAL SERIES ADJUSTED FOR CALENDAR VARIATION FOR    X11B3200
C --- EXTREMES WHERE IRREGULAR VALUES RECVD LESS THAN FULL WT.          X11B3210
  354 IF (MULADD) 336,353,336                                           X11B3220
  336 DO 347 I = LFDA,LLDA                                              X11B3230
      STCSI(I) = STOCCA(I)                                              X11B3240
      IF (STWT(I)-100.) 338,347,338                                     X11B3250
  338 STCSI(I) = STOCCA(I)-(STI(I)*(1.0-STWT(I)/100.))                  X11B3260
  347 CONTINUE                                                          X11B3270
      GO TO 335                                                         X11B3280
  353 DO 348 I = LFDA,LLDA                                              X11B3290
      STCSI(I) = STOCCA(I)                                              X11B3300
      IF (STWT(I)-100.) 333,348,333                                     X11B3310
  333 STCSI(I)=STOCCA(I)*((100.-STWT(I))/STI(I)+STWT(I)/100.)           X11B3320
  348 CONTINUE                                                          X11B3330
  335 KPRNT = KPRNT + 2                                                 X11B3340
      GO TO (346,332),KPART                                             X11B3350
C --- BEGIN PART C                                                      X11B3360
  346 KPART = 2                                                         X11B3370
      PART = CS                                                         X11B3380
      GO TO 343                                                         X11B3390
C --- BEGIN PART D                                                      X11B3400
  332 KPART = 3                                                         X11B3410
      PART = DS                                                         X11B3420
  343 KSECT = 1                                                         X11B3430
      IF (KPRNT-5) 278,281,279                                          X11B3440
  278 IF (KPRNT-3) 279,281,279                                          X11B3450
C --- WRITE MODIFIED ORIGINAL SERIES - C1. OR D1.                       X11B3460
  279 CALL RITE (1,STCSI,LFDA,LLDA,5,7,0)                               X11B3470
  281 FINAP = FINAL                                                     X11B3480
      GO TO 100                                                         X11B3490
C --- PART D ONLY                                                       X11B3500
C --- DIVIDE CALENDAR ADJUSTED SERIES *C19 IF REGRESSION OPTION SELECTEDX11B3510
C ---  B1 IF PRIOR ADJUSTMENT ONLY OR A1 IF NO CALENDAR ADJUSTMENT* BY TX11B3520
C --- TREND CYCLE -D7. TO OBTAIN FINAL UNMODIFIED SI RATIOS             X11B3530
  176 CALL ADDMUL (STSIE,STOCCA,STC,LFDA,LLDA)                          X11B3540
C --- COMPUTE SEASONAL FACTORS                                          X11B3550
      CALL VSFC (MFDA,MLDA,KSECT)                                       X11B3560
      FINAB = FINAL                                                     X11B3570
C --- WRITE UNMODIFIED SI RATIOS -D8.                                   X11B3580
      CALL RITE (8,STSIE,LFDA,LLDA,5,4,0)                               X11B3590
  654 FORMAT (/20X,23HSTABLE SEASONALITY TEST)                          X11B3600
      WRITE (NW,654)                                                    X11B3610
C --- PERFORM ANALYSIS OF VARIANCE ON UNMODIFIED SI RATIOS              X11B3620
      CALL FTEST (STSIE,LFDA,LLDA)                                      X11B3630
C --- IDENTIFY SI RATIOS WHICH ARE NOT IDENTICAL IN D7. AND D8.         X11B3640
      DO 677 I = LFDA,LLDA                                              X11B3650
      STMP(I) =10.**10                                                  X11B3660
      IF (STSIE(I) - STSI(I)) 678,677,678                               X11B3670
  678 STMP(I) = STSI(I)                                                 X11B3680
  677 CONTINUE                                                          X11B3690
C --- WRITE FINAL REPLACEMANT VALUES FOR EXTREME SI RATIOS -D9.         X11B3700
      CALL RITE (9,STMP,LFDA,LLDA,6,4,0)                                X11B3710
C --- COMPUTE YEAR AHEAD SEASONAL FACTORS                               X11B3720
  198 J = LLDA + 1                                                      X11B3730
      K = LLDA + 12                                                     X11B3740
      DO 197 I = J,K                                                    X11B3750
  197 STS(I) =(3.*STS(I-12)-STS(I-24))/2.                               X11B3760
C --- WRITE FINAL SEASONAL FACTORS - D10.                               X11B3770
      CALL RITE (10,STS,LFDA,LLDA,1,4,0)                                X11B3780
  191 IF (KFULSM) 211,209,211                                           X11B3790
C --- SUMMARY MEASURES VERSION ONLY                                     X11B3800
C --- REPLACE FINAL SEASONALLY ADJUSTED SERIES WITH D1.                 X11B3810
  211 DO 212 I = LFDA,LLDA                                              X11B3820
  212 STCI(I) = STCSI(I)                                                X11B3830
C --- APPLY VARIABLE TREND CYCLE ROUTINE TO D1                          X11B3840
      CALL VTC (LFDA,LLDA,KTCOPT)                                       X11B3850
C --- REPLACE FINAL SEASONALLY ADJUSTED SERIES WITH B1.                 X11B3860
      DO 213 I = LFDA,LLDA                                              X11B3870
  213 STCI(I) = STOR(I)                                                 X11B3880
      GO TO 214                                                         X11B3890
C --- FULL ADJUSTMENT VERSION ONLY                                      X11B3900
C --- DIVIDE D1 BY FINAL SEASONAL FACTORS TO OBTAIN A MODIFIED SEASONAL-X11B3910
C --- LY ADJUSTED SERIES                                                X11B3920
  209 CALL ADDMUL (STCI,STCSI,STS,LFDA,LLDA)                            X11B3930
C --- APPLY THE VARIABLE TREND CYCLE ROUTINE TO THE MOD. SEASONALLY ADJ.X11B3940
C --- SERIES TO OBTAIN FINAL TREND CYCLE                                X11B3950
      CALL VTC (LFDA,LLDA,KTCOPT)                                       X11B3960
C --- DIVIDE THE CALENDAR ADJ. SERIES *C19,B1, OR A1* BY FINAL SEASONAL X11B3970
C --- FACTORS TO OBTAIN A FINAL SEASONALLY ADJ. SERIES                  X11B3980
      CALL ADDMUL (STCI,STOCCA,STS,LFDA,LLDA)                           X11B3990
C --- FOR ALL VERSIONS                                                  X11B4000
C --- WRITE FINAL SEASONALLY ADJUSTED SERIES -D11.                      X11B4010
  214 CALL RITE (11,STCI,LFDA,LLDA,2,7,0)                               X11B4020
C --- WRITE FINAL TREND CYCLE -D12.                                     X11B4030
  190 CALL RITE (12,STC,LFDA,LLDA,2,7,0)                                X11B4040
C --- DIVIDE FINAL SEASONALLY ADJUSTED SERIES BY FINAL TREND CYCLE TO   X11B4050
C --- OBTAIN THE FINAL IRREGULAR                                        X11B4060
      CALL ADDMUL (STI,STCI,STC,LFDA,LLDA)                              X11B4070
C --- WRITE FINAL IRREGULAR -D13.                                       X11B4080
      CALL RITE (13,STI,LFDA,LLDA,3,5,0)                                X11B4090
C --- BEGIN PART E                                                      X11B4100
  334 KPART = 5                                                         X11B4110
      PART = ES                                                         X11B4120
C --- COMPUTE MODIFIED ORIGINAL, SEASONALLLY ADJUSTED AND IRREGUAAR     X11B4130
C --- SERIES BY REPLACING THOSE VALUES WHICH WERE ASSIGNED ZERO WT. IN  X11B4140
C --- TABLE C17.                                                        X11B4150
      DO 362 I = LFDA,LLDA                                              X11B4160
      IF (STWT(I)) 360,367,360                                          X11B4170
  360 STOME(I) = STOR(I)                                                X11B4180
      STCIME(I)= STCI(I)                                                X11B4190
      STIME(I) = STI(I)                                                 X11B4200
      GO TO 362                                                         X11B4210
C --- REPLACE SEASONALLY ADJUSTED VALUES WITH FINAL TREND CYCLE VALUES  X11B4220
  367 STCIME(I) = STC(I)                                                X11B4230
  368 IF (MULADD) 364,363,364                                           X11B4240
C --- IF MULTIPLICATIVE, REPLACE IRREGULAR VALUES WITH 100. AND ORIGINALX11B4250
C --- VALUES WITH THE PRODUCT OF THE FINAL TREND CYCLE, FINAL SEASONAL FX11B4260
C --- FACTORS, COMBINED TRADING DAY FACTORS AND PRIOR MONTHLY FACTORS   X11B4270
  363 STIME(I) = 100.                                                   X11B4280
      STOME(I) = STC(I)*STS(I)/100.*STTDRF(I)/100.*STPMF(I)/100.        X11B4290
      GO TO 362                                                         X11B4300
C --- IF ADDITIVE, REPLACE IRREGULAR VALUES WITH 0. AND ORIGINAL VALUES X11B4310
C --- WITH THE SUM OF THE  ABOVE                                        X11B4320
  364 STIME(I) = 0.                                                     X11B4330
      STOME(I) = STC(I)+STS(I)+STTDRF(I)+STPMF(I)                       X11B4340
  362 CONTINUE                                                          X11B4350
C --- WRITE ORIGINAL SERIES MODIFIED FIR EXTREMES -E1.                  X11B4360
  436 CALL RITE (1,STOME,LFDA,LLDA,2,7,0)                               X11B4370
      IF (KFULSM) 422,421,422                                           X11B4380
C --- FOR FULL ADJUSTMENT ONLY, WRITE MODIFIED SEASONALLY ADJUSTED      X11B4390
C --- SERIES -E2.                                                       X11B4400
  421 CALL RITE (2,STCIME,LFDA,LLDA,2,7,0)                              X11B4410
C --- WRITE MODIFIED IRREGULAR SERIES -E3                               X11B4420
  422 CALL RITE (3,STIME,LFDA,LLDA,3,5,0)                               X11B4430
      IF (KFULSM) 466,438,466                                           X11B4440
C --- FOR FULL ADJUSTMENT ONLY COMPUTE AND WRITE RATIOS OF ANNUAL TOTALSX11B4450
C --- B1/D11 AND E1/E2   -E4.                                           X11B4460
  438 CALL RITE (4,0,0,0,0,0,0)                                         X11B4470
      J = 1                                                             X11B4480
      JYRA = LYR                                                        X11B4490
      IF (LFDA-1) 431,432,431                                           X11B4500
  431 J = 13                                                            X11B4510
      JYRA = LYR + 1                                                    X11B4520
  432 KYRA = LYR + LLDA/12 - 1                                          X11B4530
      DO 434 I = JYRA,KYRA                                              X11B4540
      TOTO = 0.                                                         X11B4550
      TOTOM = 0.                                                        X11B4560
      TOTA = 0.                                                         X11B4570
      TOTAM = 0.                                                        X11B4580
      K = J + 11                                                        X11B4590
      DO 433 L = J,K                                                    X11B4600
      TOTO = TOTO + STOR(L)                                             X11B4610
      TOTOM = TOTOM + STOME(L)                                          X11B4620
      TOTA = TOTA + STCI(L)                                             X11B4630
  433 TOTAM = TOTAM + STCIME(L)                                         X11B4640
      J = J + 12                                                        X11B4650
      IF (MULADD) 424,423,424                                           X11B4660
  423 TOTO = TOTO/TOTA*100.                                             X11B4670
      TOTOM = TOTOM/TOTAM*100.                                          X11B4680
      GO TO 434                                                         X11B4690
  424 TOTO = TOTO - TOTA                                                X11B4700
      TOTOM = TOTOM - TOTAM                                             X11B4710
  434 WRITE (NW,435) SPC,I,TOTO,TOTOM                                   X11B4720
  435 FORMAT (A1,5H   19,I2,5X,F8.1,5X,F8.1)                            X11B4730
  466 MFDA = LFDA + 1                                                   X11B4740
      MLDA = LLDA - 1                                                   X11B4750
C --- COMPUTE AVGE CHANGES IN ORIGINAL AND SEASONALLY ADJUSTED SERIES   X11B4760
      IF (MULADD) 437,440,437                                           X11B4770
  437 CALL ADDMUL (STMP2,STOR2,STOR,LFDA,MLDA)                          X11B4780
      GO TO 444                                                         X11B4790
  440 DO 448 I = MFDA,LLDA                                              X11B4800
  448 STMP(I) = (STOR(I)-STOR(I-1))/STOR(I-1)*100.                      X11B4810
C --- WRITE AVGE CHANGES IN ORIGINAL SERIES -E5.                        X11B4820
  444 CALL RITE (5,STMP,MFDA,LLDA,5,4,0)                                X11B4830
      IF (KFULSM) 439,467,439                                           X11B4840
  467 IF (MULADD) 430,455,430                                           X11B4850
  430 CALL ADDMUL (STMP2,STCI2,STCI,LFDA,MLDA)                          X11B4860
      GO TO 420                                                         X11B4870
  455 DO 425 I = MFDA,LLDA                                              X11B4880
  425 STMP(I) = (STCI(I)-STCI(I-1))/STCI(I-1)*100.                      X11B4890
C --- WRITE AVGE CHANGES IN SEASONALLY ADJUSTED SERIES -E6.             X11B4900
  420 CALL RITE (6,STMP,MFDA,LLDA,5,4,0)                                X11B4910
C --- COMPUTE AVGE CHANGES IN I + C OVER 1-12 MONTH SPANS               X11B4920
  439 CALL SUMRY (STI,SMI,LFDA,LLDA,2)                                  X11B4930
      CALL SUMRY (STC,SMC,LFDA,LLDA,2)                                  X11B4940
      DO 400 I = 1,12                                                   X11B4950
C --- COMPUTE I/C TO DETERMINE MCD                                      X11B4960
  400 SMIC(I) = SMI(I)/SMC(I)                                           X11B4970
      MCD = 5                                                           X11B4980
  402 IF (SMIC(MCD) - .995) 401,426,426                                 X11B4990
  401 IF (MCD-1) 412,412,413                                            X11B5000
  413 MCD = MCD - 1                                                     X11B5010
      GO TO 402                                                         X11B5020
C---  COMPUTE MCD MOVING AVERAGE                                        X11B5030
  426 MCD = MCD + 1                                                     X11B5040
  427 MFDA = LFDA + MCD/2                                               X11B5050
      MLDA = LLDA - (MCD-1)/2                                           X11B5060
      J = (MCD+2)/2                                                     X11B5070
      XMCD = MCD                                                        X11B5080
      DO 408 I = MFDA, MLDA                                             X11B5090
      TMP = 0.                                                          X11B5100
      DO 407 I2 = 1, MCD                                                X11B5110
      L = I + I2 - J                                                    X11B5120
  407 TMP = TMP + STCI(L)                                               X11B5130
  408 STMCD(I) = TMP/XMCD                                               X11B5140
C --- COMPUTE AVGE MO-TO-MO CHANGES IN MCD FOR SUMMARY MEASURES TABLE   X11B5150
      CALL SUMRY (STMCD,SMMCD,MFDA,MLDA,3)                              X11B5160
C --- COMPUTE AVGE DURATION OF RUN OF MCD SERIES                        X11B5170
      CALL AVDUR (STMCD,MFDA,MLDA,ADRMCD)                               X11B5180
  412 KPART = 6                                                         X11B5190
      PART = FS                                                         X11B5200
C --- WRITE MCD MOVING AVERAGE -F1.                                     X11B5210
      CALL RITE (1,STMCD,MFDA,MLDA,5,7,0)                               X11B5220
C --- COMPUTE MEASURES FOR SUMMARY MEASURES TABLE                       X11B5230
      CALL SUMRY (STS,SMS,LFDA,LLDA,2)                                  X11B5240
      CALL SUMRY (STOR,SMO,LFDA,LLDA,2)                                 X11B5250
      CALL SUMRY (STCI,SMCI,LFDA,LLDA,3)                                X11B5260
      CALL SUMRY (STOME,SMOME,LFDA,LLDA,4)                              X11B5270
      IF (KFULSM) 469,458,469                                           X11B5280
C --- IN SUMMARY MEASURES RUN REPLACE SEASONALLY ADJUSTED WITH ORIGINAL X11B5290
  469 DO 468 I = 1,12                                                   X11B5300
  468 SMCIME(I) = SMOME(I)                                              X11B5310
      GO TO 459                                                         X11B5320
  458 CALL SUMRY (STCIME,SMCIME,LFDA,LLDA,4)                            X11B5330
  459 CALL SUMRY (STIME,SMIME,LFDA,LLDA,4)                              X11B5340
      CALL AVDUR (STCI,LFDA,LLDA,ADRCI)                                 X11B5350
      CALL AVDUR (STI,LFDA,LLDA,ADRI)                                   X11B5360
      CALL AVDUR (STC   ,LFDA,LLDA,ADRC)                                X11B5370
C --- IF MCD IS 1, MCD IS SAME AS SEASONALLY ADJUSTED SERIES            X11B5380
      IF (MCD-1) 464,454,464                                            X11B5390
  454 ADRMCD = ADRCI                                                    X11B5400
      DO 465 I = 1,12                                                   X11B5410
  465 SMMCD(I) = SMCI(I)                                                X11B5420
C --- WRITE TABLE HEADING FOR SUMMARY MEASURES                          X11B5430
  464 CALL RITE (2,0,0,0,0,0,0)                                         X11B5440
      SWO = BLANK                                                       X11B5450
      IF (KDWOPT-2) 284,285,283                                         X11B5460
  283 IF (FSTAR-BLANK) 285,284,285                                      X11B5470
  284 GO TO (286,285,286,285), KSWT                                     X11B5480
  285 SWO = STAR                                                        X11B5490
C --- WRITE AVGE CHANGE W/O REGARD TO SIGN. 1-12 MOS. SPAN              X11B5500
  286 WRITE (NW,1000) PCDIF,AORB,SWO                                    X11B5510
 1000 FORMAT (                                                          X11B5520
     19X,7HAVERAGE,2A6,A4,43H WITHOUT REGARD TO SIGN OVER INDICATED SPANX11B5530
     2/                                                                 X11B5540
     314X,4HSPAN/                                                       X11B5550
     415X,2HIN,6X,A1,88H1     D11     D13     D12     D10      A2     C1X11B5560
     58      F1             E1      E2      E3/                         X11B5570
     613X,59HMONTHS    O      CI       I       C       S       P      TDX11B5580
     7A1,40H     MCD           MOD.O   MOD.CI  MOD.I)                   X11B5590
      DO 443 I = 1,12                                                   X11B5600
      J = I + 12                                                        X11B5610
      IF (I-8) 442,443,441                                              X11B5620
  441 IF (I-10)442,443,442                                              X11B5630
  442 WRITE(NW,1001)I,SMO(I),SMCI(I),SMI(I),SMC(I),SMS(I),SMP(I),SMTD(I)X11B5640
     1,SMMCD(I),SMOME(I),SMCIME(I),SMIME(I)                             X11B5650
 1001 FORMAT (15X,I2,8F8.2,9X,3F8.2)                                    X11B5660
C --- COMPUTE CONTRIBUTIONS TO ORIGINAL SERIES IN FULL ADJUST. RUN ONLY X11B5670
      SMO2(I)=SMI(J)+SMC(J)+SMS(J)+SMP(J)+SMTD(J)                       X11B5680
  428 SMI(J) = SMI(J)/SMO2(I)                                           X11B5690
      SMC(J) = SMC(J)/SMO2(I)                                           X11B5700
      SMS(J) = SMS(J)/SMO2(I)                                           X11B5710
      SMP(J) = SMP(J)/SMO2(I)                                           X11B5720
      SMTD(J)=SMTD(J)/SMO2(I)                                           X11B5730
      SMO2(I)=SMO2(I)/SMO(J)                                            X11B5740
  443 CONTINUE                                                          X11B5750
      IF (KFULSM) 429,499,429                                           X11B5760
  499 WRITE (NW,1002) SWO                                               X11B5770
 1002 FORMAT (/9X,67HRELATIVE CONTRIBUTIONS OF COMPONENTS TO VARIANCE INX11B5780
     1 ORIGINAL SERIES/                                                 X11B5790
     2 14X,4HSPAN/                                                      X11B5800
     315X,58HIN    D13     D12     D10      A2     C18            RATIO/X11B5810
     413X,42HMONTHS   I       C       S       P      TD,A1,18H    TOTAL X11B5820
     5  (X100))                                                         X11B5830
      DO 447 I = 1,12                                                   X11B5840
      J = I + 12                                                        X11B5850
      IF (I-8) 446,447,445                                              X11B5860
  445 IF (I-10)446,447,446                                              X11B5870
  446 WRITE (NW,1003) I,SMI(J),SMC(J),SMS(J),SMP(J),SMTD(J),SMO2(I)     X11B5880
 1003 FORMAT (15X,I2,2P5F8.2,9H   100.00, F8.2)                         X11B5890
  447 CONTINUE                                                          X11B5900
C --- WRITE AVERAGE DURATIONS OF RUN                                    X11B5910
  429 WRITE (NW,1004) ADRCI,ADRI,ADRC,ADRMCD,(SMIC(I),I=1,12),MCD       X11B5920
 1004 FORMAT(/9X,55HAVERAGE DURATION OF RUN      CI      I       C      X11B5930
     1MCD/33X,4F8.2//9X25HI/C RATIO FOR MONTHS SPAN/23X,89H1       2    X11B5940
     2   3       4       5       6       7       8       9      10      X11B5950
     111      12/17X,12F8.2//                                           X11B5960
     3 9X,31HMONTHS FOR CYCLICAL DOMINANCE  ,I2/)                       X11B5970
      WRITE (NW,1005) (PCDIF(I),I=1,3),AORB                             X11B5980
 1005 FORMAT (9X,7HAVERAGE,2A6,A4,63H WITH REGARD TO SIGN AND STANDARD DX11B5990
     1EVIATION OVER INDICATED SPAN/                                     X11B6000
     214X,4HSPAN,8X,A1,1H1,15X,3HD13,14X,3HD12,14X,3HD10,14X,3HD11,15X, X11B6010
     32HF1/15X,2HIN,10X,1HO,16X,1HI,16X,1HC,16X,1HS,16X,2HCI,14X,3HMCD/ X11B6020
     413X,106HMONTHS   AVGE    S.D.     AVGE    S.D.     AVGE    S.D.   X11B6030
     5  AVGE    S.D.     AVGE    S.D.     AVGE    S.D.)                 X11B6040
      DO 451 I = 1,12                                                   X11B6050
      J = I + 24                                                        X11B6060
      K = I+36                                                          X11B6070
      IF (I-8) 450,451,449                                              X11B6080
  449 IF (I-10)450,451,450                                              X11B6090
C --- WRITE AVERAGE CHANGE WITH REGARD TO SIGN                          X11B6100
  450 WRITE (NW,1006) I,SMO(J),SMO(K),SMI(J),SMI(K),SMC(J),SMC(K),SMS(J)X11B6110
     1,SMS(K),SMCI(J),SMCI(K),SMMCD(J),SMMCD(K)                         X11B6120
 1006 FORMAT (15X,I2,6(F9.2,F8.2))                                      X11B6130
  451 CONTINUE                                                          X11B6140
      IF (SWO-STAR) 457,289,457                                         X11B6150
  289 WRITE (NW,1007) OUT                                               X11B6160
 1007 FORMAT (//10X,37H*(TRADING DAY ADJUSTMENT FACTORS WITH,A3,28H LENGX11B6170
     1TH OF MONTH ADJUSTMENT))                                          X11B6180
C --- BEGIN PART G                                                      X11B6190
  457 PART = GS                                                         X11B6200
      KPART = 7                                                         X11B6210
      MLDA = LLDA+12                                                    X11B6220
      IF (KCHOPT-1) 506,510,506                                         X11B6230
C --- CHART G1                                                          X11B6240
  506 CALL CHART (2,MDEC,0,LFDA,LLDA,LLDA,LYR,1,STCI,STC,STC)           X11B6250
      IF (KFULSM) 510,507,510                                           X11B6260
C --- CHART G2                                                          X11B6270
  507 CALL CHART (3,0,2,LFDA,MLDA,LLDA,LYR,2,STSIE,STSI,STS)            X11B6280
      IF (KCHOPT) 508,510,508                                           X11B6290
C --- CHART G3                                                          X11B6300
  508 CALL CHART (3,0,0,LFDA,MLDA,LLDA,LYR,3,STSIE,STSI,STS)            X11B6310
C --- CHART G4                                                          X11B6320
  509 CALL CHART (2,0,0,LFDA,LLDA,LLDA,LYR,4,STI,STIME,STIME)           X11B6330
  510 RETURN                                                            X11B6340
      END                                                               X11B6350
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
C --- THIS ROUTINE DIVIDES ARRAY1 BY ARAAY2*100. OR SUBTRACTS ARRAY2    X11C0020
C --- FROM ARRAY1 DEPENDING ON WHETHER A MULTIPLICATIVE AR ADDITIVE ADJ X11C0030
C --- IS BEING MADE.                                                    X11C0040
      SUBROUTINE ADDMUL (RESULT,ARRAY1,ARRAY2,JFDA,JLDA)                X11C0050
      DIMENSION RESULT(600),ARRAY1(600),ARRAY2(600)                     X11C0060
      COMMON/CJ/MULADD                                                  X11C0070
      IF (MULADD) 2,1,2                                                 X11C0080
    1 DO 3 I = JFDA,JLDA                                                X11C0090
    3 RESULT(I) = ARRAY1(I)/ARRAY2(I)*100.                              X11C0100
      RETURN                                                            X11C0110
    2 DO 4 I = JFDA,JLDA                                                X11C0120
    4 RESULT(I) = ARRAY1(I)-ARRAY2(I)                                   X11C0130
      RETURN                                                            X11C0140
      END                                                               X11C0150
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
C --- THIS ROUTINE COMPUTES THE AVERAGE DURATION OF RUN OF THE SERIES I X11D0020
C --- IN *ARRAY*.                                                       X11D0030
      SUBROUTINE AVDUR (ARRAY, JFDA, JLDA, ADR)                         X11D0040
      DIMENSION ARRAY (600)                                             X11D0050
      RUNS = 1.                                                         X11D0060
      ADR = JLDA - JFDA                                                 X11D0070
      K = JLDA - 1                                                      X11D0080
      KSW = 0                                                           X11D0090
      IF (ARRAY(JFDA+1) -  ARRAY(JFDA)) 20, 21, 21                      X11D0100
   20 KSW = 1                                                           X11D0110
   21 DO 9 I = JFDA, K                                                  X11D0120
   15 IF (ARRAY(I+1) - ARRAY(I)) 16, 9, 17                              X11D0130
   16 IF (KSW-1) 8,9,8                                                  X11D0140
    8 KSW = 1                                                           X11D0150
      GO TO 18                                                          X11D0160
   17 IF (KSW) 7,9,7                                                    X11D0170
    7 KSW = 0                                                           X11D0180
   18 RUNS = RUNS + 1.                                                  X11D0190
    9 CONTINUE                                                          X11D0200
   19 ADR = ADR/RUNS                                                    X11D0210
      RETURN                                                            X11D0220
      END                                                               X11D0230
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
      SUBROUTINE CHART (NOSER,LOG,MO,IBEG,IEND,IENDA,LYR,LTABL,A,B,C)   X11E0020
      COMMON/CA/NW,NX(112),Y(12),STMP(476)                              X11E0030
      DIMENSION A(600),B(600),C(612),MO1(12),MO2(12),NM(4),NY(4),NZ(111)X11E0040
      DATA NLETX,NAST,NLETO,NBLANK,NPLUS/1HX,1H*,1HO,1H ,1H+/           X11E0050
      DATA(MO1(N),N=1,12)/6HJANUAR,6HFEBRUA,6HMARCH ,6HAPRIL ,6HMAY   , X11E0060
     1 6HJUNE  ,6HJULY  ,6HAUGUST,6HSEPTEM,6HOCTOBE,6HNOVEMB,6HDECEMB/  X11E0070
      DATA(MO2(N),N=1,12)/1HY,2HRY,1H ,1H ,1H ,1H ,1H ,1H ,3HBER,1HR,   X11E0080
     1 2HER,2HER/                                                       X11E0090
      DATA (NM(I),I=1,4)/6H(4H  1,6H9I2,1X,1H ,3HA1)/                   X11E0100
      DATA (NY(I),I=1,4)/6H(1X,A3,6H,I2,1X,1H ,3HA1)/                   X11E0110
      DATA(NZ(I),I=1,111)/6H   111,6H1X 110,6H2X 109,6H3X 108,6H4X 107, X11E0120
     1  6H 5X106,6H 6X105,6H 7X104,6H 8X103,6H 9X102,6H10X101,6H11X100, X11E0130
     1  6H12X 99,6H13X 98,6H14X 97,6H15X 96,6H16X 95,6H17X 94,6H18X 93, X11E0140
     1  6H19X 92,6H20X 91,6H21X 90,6H22X 89,6H23X 88,6H24X 87,6H25X 86, X11E0150
     1  6H26X 85,6H27X 84,6H28X 83,6H29X 82,6H30X 81,6H31X 80,6H32X 79, X11E0160
     1  6H33X 78,6H34X 77,6H35X 76,6H36X 75,6H37X 74,6H38X 73,6H39X 72, X11E0170
     1  6H40X 71,6H41X 70,6H42X 69,6H43X 68,6H44X 67,6H45X 66,6H46X 65, X11E0180
     1  6H47X 64,6H48X 63,6H49X 62,6H50X 61,6H51X 60,6H52X 59,6H53X 58, X11E0190
     1  6H54X 57,6H55X 56,6H56X 55,6H57X 54,6H58X 53,6H59X 52,6H60X 51, X11E0200
     1  6H61X 50,6H62X 49,6H63X 48,6H64X 47,6H65X 46,6H66X 45,6H67X 44, X11E0210
     1  6H68X 43,6H69X 42,6H70X 41,6H71X 40,6H72X 39,6H73X 38,6H74X 37, X11E0220
     1  6H75X 36,6H76X 35,6H77X 34,6H78X 33,6H79X 32,6H80X 31,6H81X 30, X11E0230
     1  6H82X 29,6H83X 28,6H84X 27,6H85X 26,6H86X 25,6H87X 24,6H88X 23, X11E0240
     1  6H89X 22,6H90X 21,6H91X 20,6H92X 19,6H93X 18,6H94X 17,6H95X 16, X11E0250
     1  6H96X 15,6H97X 14,6H98X 13,6H99X 12,6H100X11,6H101X10,6H102X 9, X11E0260
     1  6H103X 8,6H104X 7,6H105X 6,6H106X 5,6H107X 4,6H108X 3,6H109X 2, X11E0270
     1  6H110X 1/                                                       X11E0280
      NYEAR=LYR                                                         X11E0290
      N = 1                                                             X11E0300
      DO 105 I = 1,111                                                  X11E0310
  105 NX(I) = NBLANK                                                    X11E0320
C --- FIND LARGEST AND SMALLEST VALUES                                  X11E0330
  221 BIG = -999999.                                                    X11E0340
      SMALL = 999999.                                                   X11E0350
      IF (NOSER-2) 510,520,530                                          X11E0360
  530 DO 534 I = IBEG,IEND                                              X11E0370
      IF (C(I)-BIG) 531,534,532                                         X11E0380
  531 IF (C(I)-SMALL) 533,534,534                                       X11E0390
  532 BIG = C(I)                                                        X11E0400
      GO TO 534                                                         X11E0410
  533 SMALL = C(I)                                                      X11E0420
  534 CONTINUE                                                          X11E0430
  520 DO 524 I = IBEG,IENDA                                             X11E0440
      IF (B(I)-BIG) 521,524,522                                         X11E0450
  521 IF (B(I)-SMALL) 523,524,524                                       X11E0460
  522 BIG = B(I)                                                        X11E0470
      GO TO 524                                                         X11E0480
  523 SMALL = B(I)                                                      X11E0490
  524 CONTINUE                                                          X11E0500
  510 DO 514 I = IBEG,IENDA                                             X11E0510
      IF (A(I)-BIG) 511,514,512                                         X11E0520
  511 IF (A(I)-SMALL) 513,514,514                                       X11E0530
  512 BIG = A(I)                                                        X11E0540
      GO TO 514                                                         X11E0550
  513 SMALL = A(I)                                                      X11E0560
  514 CONTINUE                                                          X11E0570
      SMALL = AINT(SMALL)                                               X11E0580
  291 ASSIGN 297 TO JUMP                                                X11E0590
  293 CALL RITE (LTABL,0,0,0,0,0,0)                                     X11E0600
      GO TO JUMP,(297,153)                                              X11E0610
  297 ASSIGN 153 TO JUMP                                                X11E0620
  296 IF (LOG) 101,101,100                                              X11E0630
C --- ARITHMETIC CHART                                                  X11E0640
  101 IF (SMALL) 103,103,104                                            X11E0650
  103 SMALL = SMALL - 1.                                                X11E0660
  104 KDIV = (BIG-SMALL)/11. + 1.                                       X11E0670
      DIV = KDIV                                                        X11E0680
      Y(1) = SMALL                                                      X11E0690
      BIG = SMALL                                                       X11E0700
      DO 148 I = 2,12                                                   X11E0710
      BIG = BIG +  DIV                                                  X11E0720
  148 Y(I) = BIG                                                        X11E0730
      KL = 0                                                            X11E0740
      CYCLE = 110./(BIG-SMALL)                                          X11E0750
  153 WRITE (NW,16)                                                     X11E0760
   16 FORMAT(20H    SCALE-ARITHMETIC)                                   X11E0770
      WRITE (NW,1) Y                                                    X11E0780
    1 FORMAT(1H 2XF7.0,11(3XF7.0))                                      X11E0790
      WRITE (NW,27)                                                     X11E0800
   27 FORMAT(7X1H.11(9X1H.))                                            X11E0810
      IF (MO) 5000,5000,3500                                            X11E0820
C --- DETERMINE LOG SCALE                                               X11E0830
  100 IF (SMALL) 106,106,107                                            X11E0840
  106 SMALL = 1.                                                        X11E0850
  107 KVAL = BIG/SMALL                                                  X11E0860
      WT = 1.                                                           X11E0870
      IF (KVAL-2) 20, 420, 420                                          X11E0880
  420 IF (KVAL-4) 30, 421, 421                                          X11E0890
  421 IF (KVAL-10) 40, 422, 422                                         X11E0900
  422 IF (KVAL-100) 50,423,423                                          X11E0910
  423 IF (KVAL-10000) 60,70,70                                          X11E0920
C --- HEADINGS FOR VARIOUS LOG CHARTS                                   X11E0930
   20 DO 29 I = 1,6                                                     X11E0940
      Y(I)= SMALL*WT                                                    X11E0950
   29 WT = WT + .2                                                      X11E0960
      WRITE (NW, 9)                                                     X11E0970
    9 FORMAT(33H    SCALE-SEMI-LOG  QUARTER CYCLE)                      X11E0980
      WRITE (NW, 3) (Y(I), I = 1, 6)                                    X11E0990
    3 FORMAT (3XF7.0,21XF8.0,16XF8.0,14XF8.0,10XF8.0,9XF8.0)            X11E1000
      WRITE (NW,21)                                                     X11E1010
   21 FORMAT (7X1H.28X1H.23X1H.21X1H.17X1H.16X1H.)                      X11E1020
      KL = 1                                                            X11E1030
      CYCLE = 365.4121                                                  X11E1040
      GO TO 5000                                                        X11E1050
   30 DO 31 I = 1,7                                                     X11E1060
      Y(I) = SMALL*WT                                                   X11E1070
   31 WT = WT +.5                                                       X11E1080
      WRITE (NW, 11)                                                    X11E1090
   11 FORMAT(33H    SCALE-SEMI-LOG  HALF CYCLE   )                      X11E1100
      WRITE (NW, 4) (Y(I), I = 1, 7)                                    X11E1110
    4 FORMAT (3XF7.0,24XF8.0,15XF8.0,10XF8.0, 6XF8.0,4XF8.0,3XF8.0)     X11E1120
      WRITE (NW,22)                                                     X11E1130
   22 FORMAT (7X1H.31X1H.22X1H.17X1H.13X1H.11X1H.10X1H.)                X11E1140
      KL = 2                                                            X11E1150
      CYCLE = 182.706                                                   X11E1160
      GO TO 5000                                                        X11E1170
   40 Y(1)= SMALL                                                       X11E1180
      WT = 2.                                                           X11E1190
      DO 41 I=2,6                                                       X11E1200
      Y(I)= SMALL* WT                                                   X11E1210
   41 WT = WT + 2.                                                      X11E1220
      WRITE (NW, 13)                                                    X11E1230
   13 FORMAT(33H    SCALE-SEMI-LOG  ONE CYCLE    )                      X11E1240
      WRITE (NW, 5) (Y(I), I = 1, 6)                                    X11E1250
    5 FORMAT (3XF7.0,25XF8.0,25XF8.0,12XF8.0, 5XF8.0,3XF8.0)            X11E1260
      WRITE (NW,23)                                                     X11E1270
   23 FORMAT (7X1H.32X1H.32X1H.19X1H.12X1H.10X1H.)                      X11E1280
      KL = 3                                                            X11E1290
      CYCLE = 110.                                                      X11E1300
      GO TO 5000                                                        X11E1310
   50 Y(1) = SMALL                                                      X11E1320
      Y(2) = SMALL*4.0                                                  X11E1330
      Y(3) = SMALL*7.0                                                  X11E1340
      Y(4) = SMALL*10.0                                                 X11E1350
      Y(5) =SMALL* 40.0                                                 X11E1360
      Y(6) = SMALL*70.0                                                 X11E1370
      Y(7) = SMALL*100.0                                                X11E1380
      WRITE (NW, 14)                                                    X11E1390
   14 FORMAT(33H    SCALE-SEMI-LOG  TWO CYCLE    )                      X11E1400
      WRITE (NW, 6) (Y(I), I = 1, 7)                                    X11E1410
    6 FORMAT(1H 2XF7.0,27XF7.0, 6XF7.0, 2XF7.0,27XF7.0, 6XF7.0,F7.0)    X11E1420
      WRITE (NW,24)                                                     X11E1430
   24 FORMAT(7X1H.33X1H.12X1H.8X1H.33X1H.12X1H.7X1H.)                   X11E1440
      KL = 4                                                            X11E1450
      CYCLE = 55.                                                       X11E1460
      GO TO 5000                                                        X11E1470
   60 DO 61 I = 1,5                                                     X11E1480
      Y(I) = SMALL*WT                                                   X11E1490
   61 WT = 10.*WT                                                       X11E1500
      WRITE (NW,15)                                                     X11E1510
   15 FORMAT(33H    SCALE-SEMI-LOG  FOUR CYCLE   )                      X11E1520
      WRITE (NW, 7) (Y(I), I=1,5)                                       X11E1530
    7 FORMAT(1H ,2XF7.0,20XF7.0,21XF7.0,19XF8.0,20XF8.0)                X11E1540
      WRITE (NW,25)                                                     X11E1550
   25 FORMAT(7X1H.26X1H.27X1H.26X1H.27X1H.)                             X11E1560
      KL = 5                                                            X11E1570
      CYCLE = 27.5                                                      X11E1580
      GO TO 5000                                                        X11E1590
   70 WRITE (NW,19)                                                     X11E1600
   19 FORMAT (30H    SCALE-SEMI-LOG  FIVE CYCLE)                        X11E1610
      DO 71 I = 1,6                                                     X11E1620
      Y(I) = SMALL*WT                                                   X11E1630
   71 WT = 10.*WT                                                       X11E1640
      WRITE (NW,8) (Y(I),I=1,6)                                         X11E1650
    8 FORMAT (3XF7.0,5(14XF8.0))                                        X11E1660
      WRITE (NW,26)                                                     X11E1670
   26 FORMAT(7X1H.21X1H.21X1H.21X1H.21X1H.21X1H.)                       X11E1680
      KL = 6                                                            X11E1690
      CYCLE = 22.                                                       X11E1700
C --- PLOT POINTS                                                       X11E1710
 5000 I = IBEG                                                          X11E1720
      N = 12                                                            X11E1730
      ASSIGN 703 TO JPLOT                                               X11E1740
 1099 NPLOTA = 112                                                      X11E1750
      NPLOTB = 112                                                      X11E1760
      NPLOTC = 112                                                      X11E1770
      IF (LOG) 102,102,1002                                             X11E1780
  102 CX = C(I)-SMALL                                                   X11E1790
      BX = B(I)-SMALL                                                   X11E1800
      AX = A(I)-SMALL                                                   X11E1810
      GO TO 1003                                                        X11E1820
 1002 IF (NOSER-2) 610,620,630                                          X11E1830
  630 CX = ALOG10(C(I)/SMALL)                                           X11E1840
  620 BX = ALOG10(B(I)/SMALL)                                           X11E1850
  610 AX = ALOG10(A(I)/SMALL)                                           X11E1860
 1003 IF (NOSER-2) 910,920,930                                          X11E1870
  930 NPLOTC = CX * CYCLE + 1.5                                         X11E1880
  933 IF (NPLOTC-111) 936,934,934                                       X11E1890
  934 NPLOTC = 111                                                      X11E1900
      GO TO 935                                                         X11E1910
  936 IF (NPLOTC) 937,937,935                                           X11E1920
  937 NPLOTC = 1.                                                       X11E1930
  935 NX(NPLOTC) = NPLUS                                                X11E1940
  920 IF (I-IENDA) 921,921,397                                          X11E1950
  921 NPLOTB = BX * CYCLE + 1.5                                         X11E1960
  923 IF (NPLOTB-111) 926,924,924                                       X11E1970
  924 NPLOTB = 111                                                      X11E1980
      GO TO 925                                                         X11E1990
  926 IF (NPLOTB) 927,927,925                                           X11E2000
  927 NPLOTB = 1.                                                       X11E2010
  925 NX(NPLOTB) = NLETO                                                X11E2020
  910 NPLOTA = AX * CYCLE + 1.5                                         X11E2030
  913 IF (NPLOTA-111) 916,914,914                                       X11E2040
  914 NPLOTA = 111                                                      X11E2050
      GO TO 915                                                         X11E2060
  916 IF (NPLOTA) 917,917,915                                           X11E2070
  917 NPLOTA = 1.                                                       X11E2080
  915 NX(NPLOTA) = NLETX                                                X11E2090
 1004 JH = NPLOTA                                                       X11E2100
      JL = NPLOTA                                                       X11E2110
      IF (NOSER-2) 399,363,351                                          X11E2120
  351 IF (NPLOTC-NPLOTB) 359,356,352                                    X11E2130
  352 IF (NPLOTC-NPLOTA) 392,355,353                                    X11E2140
  353 IF (NPLOTB-NPLOTA) 395,354,391                                    X11E2150
  354 NX(NPLOTB) = NAST                                                 X11E2160
      GO TO 391                                                         X11E2170
  355 NX(NPLOTC) = NAST                                                 X11E2180
      GO TO 392                                                         X11E2190
  356 IF (NPLOTC-NPLOTA) 355,358,357                                    X11E2200
  357 NX(NPLOTC) = NAST                                                 X11E2210
      GO TO 391                                                         X11E2220
  358 NX(NPLOTC) = NAST                                                 X11E2230
      GO TO 399                                                         X11E2240
  359 IF (NPLOTC-NPLOTA) 361,360,393                                    X11E2250
  360 NX(NPLOTC) = NAST                                                 X11E2260
      GO TO 393                                                         X11E2270
  361 IF (NPLOTB-NPLOTA) 394,362,396                                    X11E2280
  362 NX(NPLOTB) = NAST                                                 X11E2290
      GO TO 394                                                         X11E2300
  363 IF (NPLOTB-NPLOTA) 392,364,393                                    X11E2310
  364 NX(NPLOTB) = NAST                                                 X11E2320
      GO TO 399                                                         X11E2330
  395 JH = NPLOTC                                                       X11E2340
  392 JL = NPLOTB                                                       X11E2350
      GO TO 399                                                         X11E2360
  396 JH = NPLOTB                                                       X11E2370
  394 JL = NPLOTC                                                       X11E2380
      GO TO 399                                                         X11E2390
  397 JL = NPLOTC                                                       X11E2400
  391 JH = NPLOTC                                                       X11E2410
      GO TO 399                                                         X11E2420
  393 JH = NPLOTB                                                       X11E2430
  399 NY(3) = NZ(JL)                                                    X11E2440
      NM(3) = NZ(JL)                                                    X11E2450
      GO TO JPLOT,(703,2999)                                            X11E2460
  703 M = I                                                             X11E2470
  720 IF (M-12) 1000,1000,701                                           X11E2480
  701 M = M-12                                                          X11E2490
      IF(M-12)  702, 702,701                                            X11E2500
  702 IF(M-1) 1000,705,1000                                             X11E2510
  705 NYEAR = NYEAR + 1                                                 X11E2520
 1000 WRITE (NW,NY) MO1(M),NYEAR,(NX(IPLOT),IPLOT=JL,JH)                X11E2530
 4000 I = I + 1                                                         X11E2540
      GO TO 1098                                                        X11E2550
C ---  12 MONTHLY CHARTS                                                X11E2560
 3500 WRITE (NW, 17) MO1(N), MO2(N)                                     X11E2570
   17 FORMAT(1H 2A6)                                                    X11E2580
      NYEAR = LYR-1                                                     X11E2590
      IF(IBEG-N)3001,3001,3002                                          X11E2600
 3002 IF(IBEG-12) 800,800,801                                           X11E2610
  800 NYEAR = NYEAR +1                                                  X11E2620
  801 IST = N+12                                                        X11E2630
      GO TO 3006                                                        X11E2640
 3001 IST = N                                                           X11E2650
 3006 I = IST                                                           X11E2660
      ASSIGN 2999 TO JPLOT                                              X11E2670
      GO TO 1099                                                        X11E2680
 2999 NYEAR = NYEAR + 1                                                 X11E2690
 3000 WRITE (NW,NM) NYEAR,(NX(IPLOT),IPLOT = JL,JH)                     X11E2700
      I = I + 12                                                        X11E2710
 1098 NX(NPLOTA) = NBLANK                                               X11E2720
      NX(NPLOTB) = NBLANK                                               X11E2730
      NX(NPLOTC) = NBLANK                                               X11E2740
      IF (I-IEND) 1099,1099,3010                                        X11E2750
 3010 IF (LOG) 3011,3011,3012                                           X11E2760
 3011 WRITE (NW,27)                                                     X11E2770
      WRITE (NW, 1) (Y(I), I = 1, 12)                                   X11E2780
      N=N+1                                                             X11E2790
      IF (N-12) 293,293,9999                                            X11E2800
 3012 GO TO (3021,3022,3023,3024,3025,3026),KL                          X11E2810
 3021 WRITE (NW,21)                                                     X11E2820
      WRITE (NW,3)(Y(I),I=1,6)                                          X11E2830
      GO TO 9999                                                        X11E2840
 3022 WRITE (NW,22)                                                     X11E2850
      WRITE (NW,4) (Y(I),I=1,7)                                         X11E2860
      GO TO 9999                                                        X11E2870
 3023 WRITE (NW,23)                                                     X11E2880
      WRITE (NW,5) (Y(I),I=1,6)                                         X11E2890
      GO TO 9999                                                        X11E2900
 3024 WRITE (NW,24)                                                     X11E2910
      WRITE (NW,6) (Y(I),I=1,7)                                         X11E2920
      GO TO 9999                                                        X11E2930
 3025 WRITE (NW,25)                                                     X11E2940
      WRITE (NW,7)(Y(I),I=1,5)                                          X11E2950
      GO TO 9999                                                        X11E2960
 3026 WRITE (NW,26)                                                     X11E2970
      WRITE (NW,8) (Y(I),I=1,6)                                         X11E2980
 9999 RETURN                                                            X11E2990
      END                                                               X11E3000
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
C --- THIS ROUTINE COMBINES SEVEN DAILY WEIGHTS INTO MONTHLY FACTORS    X11F0020
      SUBROUTINE DOW (DWT,ARRAY,KYR,KFDA,JLDA,JOPT)                     X11F0030
      DIMENSION ARRAY(600),DWT(7),MDAYS(12),WT(4),ADJ(12)               X11F0040
      COMMON/CJ/MULADD                                                  X11F0050
      DATA (MDAYS(I), I=1,12)/3,0,3,2,3,2,3,3,2,3,2,3/                  X11F0060
      DATA (ADJ(I),I=1,12)/28.25,30.,31.,28.25,30.4375,30.4375,30.4375, X11F0070
     1 30.4375,29.,30.,31.,28./                                         X11F0075
      TKON = 0.                                                         X11F0080
      IF (MULADD) 33,2,33                                               X11F0090
    2 TKON = 28.                                                        X11F0100
      DO 1 I = 1,4                                                      X11F0110
      M = I + JOPT                                                      X11F0120
    1 WT(I) = ADJ(M)                                                    X11F0130
C --- STANDARDIZE WEIGHTS TO TOTAL 7.0                                  X11F0140
    3 TMP = 0                                                           X11F0150
    6 DO 32 I = 1,7                                                     X11F0160
   32 TMP = TMP + DWT(I)                                                X11F0170
      DO 31 I = 1, 7                                                    X11F0180
   31 DWT(I) = (DWT(I)*7.)/TMP                                          X11F0190
   33 JFDA = (KFDA-1)/12*12+1                                           X11F0195
      JYR = KYR + JFDA/12                                               X11F0196
C --- SET PERPETUAL CALENDAR                                            X11F0200
      I = JYR + 12 -((JYR+11)/28) * 28                                  X11F0210
      I = I + (I-1)/4                                                   X11F0220
      I = I - ((I-1)/7) * 7                                             X11F0230
      M = 1                                                             X11F0240
    5 JL = JLDA + 12                                                    X11F0270
      L = JYR - 1                                                       X11F0280
    8 DO 30 J = JFDA,JL                                                 X11F0310
      ARRAY(J) = TKON                                                   X11F0320
      N = MDAYS(M)                                                      X11F0330
      IF (N) 19, 13, 19                                                 X11F0340
   13 L = L + 1                                                         X11F0350
      N = 4                                                             X11F0360
      IF (L - (L/4) * 4) 25, 9, 25                                      X11F0370
    9 N = 1                                                             X11F0375
   19 K = 0                                                             X11F0380
   20 ARRAY(J) = ARRAY(J) + DWT(I)                                      X11F0390
      I = I + 1                                                         X11F0400
      IF (I - 7) 22, 22, 21                                             X11F0410
   21 I = 1                                                             X11F0420
   22 K = K + 1                                                         X11F0430
      IF (K-N) 20, 25, 25                                               X11F0440
   25 IF (MULADD) 28,325,28                                             X11F0450
  325 ARRAY(J) = ARRAY(J)/WT(N)* 100.                                   X11F0460
   28 M = M + 1                                                         X11F0470
      IF (M-12) 30, 30, 29                                              X11F0480
   29 M = 1                                                             X11F0490
   30 CONTINUE                                                          X11F0500
  999 RETURN                                                            X11F0510
      END                                                               X11F0520
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
C --- THIS ROUTINE COMPUTES THE ANALYSIS-OF-VARIANCE F-TEST.            X11G0020
      SUBROUTINE FTEST (ARRAY,JFDA,JLDA)                                X11G0030
      DIMENSION ARRAY(600)                                              X11G0040
      COMMON/CA/NW,NM(12),SUMM(12),SSQT,SUMT,F,FSTAR,SSR,SSM,KDFR,KDFT, X11G0050
     1FMSM,FMSR,NT,STMP(565)                                            X11G0060
      DATA BLANK,STAR/6H      ,6H******/                                X11G0070
      DO 1 I=1,12                                                       X11G0080
      NM(I) = 0                                                         X11G0090
    1 SUMM(I) = 0.                                                      X11G0100
      NT = 0                                                            X11G0110
      SUMT = 0.                                                         X11G0120
      SSQT = 0.                                                         X11G0130
      DO 11 I = 1,12                                                    X11G0140
      J = I + JFDA - 1                                                  X11G0150
      DO 11 M = J,JLDA,12                                               X11G0160
   10 NM(I) = NM(I) + 1                                                 X11G0170
      NT = NT + 1                                                       X11G0180
      SUMM(I) = SUMM(I) + ARRAY(M)                                      X11G0190
      SUMT = SUMT + ARRAY(M)                                            X11G0200
      SSQT = SSQT + ARRAY(M)**2                                         X11G0210
   11 CONTINUE                                                          X11G0220
      ST = NT                                                           X11G0230
      SSQT = SSQT - SUMT**2/ST                                          X11G0240
      SSM = 0.                                                          X11G0250
      DO 12 I = 1,12                                                    X11G0260
      SM = NM(I)                                                        X11G0270
   12 SSM = SSM + SUMM(I)**2/SM                                         X11G0280
      SSM = SSM - SUMT**2/ST                                            X11G0290
      SSR = SSQT - SSM                                                  X11G0300
      KDFR = NT - 12                                                    X11G0310
      KDFT = NT - 1                                                     X11G0320
      FMSM = SSM/11.                                                    X11G0330
      DFR = KDFR                                                        X11G0340
      FMSR = SSR/DFR                                                    X11G0350
      F = FMSM/FMSR                                                     X11G0360
      ASSIGN 30 TO JUMP                                                 X11G0370
      FSTAR = BLANK                                                     X11G0380
   14 IF (F-2.34) 19,18,18                                              X11G0390
   18 FSTAR = STAR                                                      X11G0400
      ASSIGN 27 TO JUMP                                                 X11G0410
   19 WRITE (NW,100) SSM,FMSM,F,FSTAR,SSR,KDFR,FMSR,SSQT,KDFT           X11G0420
      GO TO JUMP,(27,30)                                                X11G0430
  100 FORMAT (43X, 6HSUM OF,5X,7HDGRS.OF,9X,4HMEAN/                     X11G0440
     142X,7HSQUARES,4X, 7HFREEDOM,9X,6HSQUARE,9X,1HF/                   X11G0450
     220X,14HBETWEEN MONTHS,F17.3,7X,2H11,F17.3,F12.3,A2/               X11G0460
     326X,8HRESIDUAL,F17.3,I9,F17.3/                                    X11G0470
     429X,5HTOTAL,F17.3,I9)                                             X11G0480
   27 WRITE (NW,101)                                                    X11G0490
  101 FORMAT (30X,52H**STABLE SEASONALITY PRESENT AT THE 1 PER CENT LEVEX11G0500
     1L)                                                                X11G0510
      RETURN                                                            X11G0520
   30 WRITE (NW,102)                                                    X11G0530
  102 FORMAT (30X,57HNO EVIDENCE OF STABLE SEASONALITY AT THE 1 PER CENTX11G0540
     1 LEVEL)                                                           X11G0550
      RETURN                                                            X11G0560
      END                                                               X11G0570
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
C --- THIS ROUTINE COMPUTES WEIGHTED MOVING AVERAGES FOR VSFC AND VTC.  X11H0020
C --- WEIGHTS ARE ORDERED SO THAT FIRST N WEIGHTS ARE APPLIED TO VALUES X11H0030
C --- FOR FIRST AND LAST MOVING AVERAGE TERMS. LAST N VALUES ARE FOR    X11H0040
C --- MIDDLE TERMS. WITHIN EACH SET OF N VALUES FOR END TERMS, FIRST    X11H0050
C --- WEIGHT IS APPLIED TO FIRST AND LAST INPUT VALUE.                  X11H0060
      SUBROUTINE MVAVG (STB,STA,LF,LL,N,WT)                             X11H0070
      DIMENSION STA(600),STB(600),WT(276)                               X11H0080
      M = N/2                                                           X11H0090
      DO 1 I = 1,M                                                      X11H0100
      II = LF + I - 1                                                   X11H0110
      JJ = LL - I + 1                                                   X11H0120
      STB(II) = 0.                                                      X11H0130
      STB(JJ) = 0.                                                      X11H0140
      KK = LF                                                           X11H0150
      MM = LL                                                           X11H0160
      NN = N * (I-1)                                                    X11H0170
      DO 1 J = 1,N                                                      X11H0180
      NN = NN + 1                                                       X11H0190
      STB(II) = STB(II) + STA(KK)*WT(NN)                                X11H0200
      STB(JJ) = STB(JJ) + STA(MM)*WT(NN)                                X11H0210
      KK = KK + 1                                                       X11H0220
    1 MM = MM - 1                                                       X11H0230
      IF (N-M-M) 2,4,2                                                  X11H0240
    2 II = II + 1                                                       X11H0250
      JJ = JJ - 1                                                       X11H0260
      DO 3 I = II,JJ                                                    X11H0270
      KK = I - M - 1                                                    X11H0280
      STB(I) = 0.                                                       X11H0290
      DO 3 J = 1,N                                                      X11H0300
      KK = KK + 1                                                       X11H0310
      MM = NN + J                                                       X11H0320
    3 STB(I) = STB(I) + STA(KK)*WT(MM)                                  X11H0330
    4 RETURN                                                            X11H0340
      END                                                               X11H0350
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
C --- TABLE OUTPUT ROUTINE. WRITES THE HEADING LINE ON ALL PAGES AND    X11I0020
C --- ALL MONTHLY TABLES.                                               X11I0030
      SUBROUTINE RITE (KTABL,ARRAY,LFDA,LLDA,JAVG,JDCM,ARR)             X11I0040
      COMMON/CA/NW,STMP(600)                                            X11I0050
      COMMON/CB/RATIC,NTERM,STC(360),STCI(360)                          X11I0060
      COMMON/CC/RATI(36),LTERM(12),STS(372),STSI(360)                   X11I0070
      COMMON/CF/LSER,LYR,PART,KSWK,FINAB,FINAP,KPART,AORB,OUT,MCD,SIGM, X11I0080
     1SIGML,SIGMU,IN,RADIF1,RADIF2,KDEC,NEWPAG,SPC,NAME(14)             X11I0090
      COMMON/CJ/MULADD                                                  X11I0100
      DIMENSION ARRAY(612),ARR(612),TMP(12),AVGMON(12),TOTMON(12),      X11I0110
     1 FA2(6), FA3(10),FA4(6), FB1(5), FB2(8), FB3(4), FB4(7), FB5(4),  X11I0120
     2 FB6(6),FB7(6),FB13(4),FB14(11),FB15(5),FB16(12),FB17(7),FB18(10),X11I0130
     3 FB19(10),FE1(7),FE2(6),FE3(5),FE4(10),FE5(7),FE6(11),            X11I0140
     4 NF1(8),NF2(17),TYRLY(4),SDEV(12),TITLE(16),DIFRAT(6),KDCML(6),   X11I0150
     5 FF1(3),FF2(3),FC4(4),KSE(11)                                     X11I0160
      DATA BLANK /6H      /                                             X11I0170
      DATA (KDCML(I),I=1,6)/1H1,1H2,1H3,1H4,1H5,1H0/                    X11I0180
      DATA (DIFRAT(I),I=1,6)/6HRATIOS,6HDIFFER,6HENCES ,6H PER C,       X11I0190
     1 6HENT CH,6HANGE  /                                               X11I0200
      DATA (TYRLY(I),I=1,4)/6H  AVGE,6H TOTAL,6H  S.D.,6H  S.D./        X11I0210
      DATA (NF1(I),I=1,8) /6H(A1,3X,6H2H19I2,6H,2X12(,6H1X,F7.,6H      ,X11I0220
     16H)6XF8.,6H      ,1H)/                                            X11I0230
      DATA(NF2(I),I=1,17)/6H(A1,12,6HX,14H ,6HTABLE ,6HTOTAL-,6H , F9., X11I0240
     1 1H ,6H,A1,8X,6H,6HMEA,6HN- F7.,1H ,6H,8X,16,6HHSTD. ,6HDEVIAT,   X11I0250
     2 6HION- ,,6H   F7.,1H ,1H)/                                       X11I0260
      DATA (NF3,NF4,NF5)/6H2H19I2,6H4HAVGE,6H4HS.D./                    X11I0270
      DATA (FA2 (I),I=1,6 )/                                            X11I0280
     1 6HPRIOR ,6HMONTHL,6HY ADJU,6HSTMENT,6H FACTO,6HRS    /           X11I0290
      DATA (FA3 (I),I=1,10)/                                            X11I0300
     1 6HORIGIN,6HAL SER,6HIES AD,6HJUSTED,6H BY PR,6HIOR MO,6HNTHLY ,  X11I0310
     1 6HADJUST,6HMENT F,6HACTORS/                                      X11I0320
      DATA (FA4 (I),I=1,6 )/                                            X11I0330
     1 6HPRIOR ,6HTRADIN,6HG DAY ,6HADJUST,6HMENT F,6HACTORS/           X11I0340
      DATA (FB1 (I),I=1,5 )/                                            X11I0350
     1 6HPRIOR ,6HADJUST,6HED ORI,6HGINAL ,6HSERIES/                    X11I0360
      DATA (FB2 (I),I=1,8 )/                                            X11I0370
     1 6HTREND ,6HCYCLE-,6H CENTE,6HRED 12,6H-TERM ,6HMOVING,6H AVERA,  X11I0380
     1 6HGE    /                                                        X11I0390
      DATA (FB3 (I),I=1,4 )/                                            X11I0400
     1 6H FINAL,6H  UNMO,6HDIFIED,6H  SI  /                             X11I0410
      DATA (FB4 (I),I=1,7 )/                                            X11I0420
     1 6H FINAL,6H REPLA,6HCEMENT,6H VALUE,6HS FOR ,6HEXTREM,6HE SI  /  X11I0430
      DATA (KSE(I),I=1,11)/6H(6X,4H,6HI   , ,6H 12F8.,6H      ,6H/6X,4H,X11I0440
     1 6HS   , ,6H 12F8.,6H      ,6H/4X6HR,6HATIO 2,6H2F8.2)/           X11I0450
      DATA (FC4 (I),I=1,4 )/                                            X11I0460
     1 6H FINAL,6H    MO,6HDIFIED,6H  SI  /                             X11I0470
      DATA (FB5 (I),I=1,4 )/                                            X11I0480
     1 6H      ,6H SEASO,6HNAL FA,6HCTORS /                             X11I0490
      DATA (FB6 (I),I=1,6 )/                                            X11I0500
     1 6H      ,6H SEASO,6HNALLY ,6HADJUST,6HED SER,6HIES   /           X11I0510
      DATA (FB7 (I),I=1,6 )/                                            X11I0520
     1 6H FINAL,6H TREND,6H CYCLE,6H - HEN,6HDERSON,6H CURVE/           X11I0530
      DATA (FB13(I),I=1,4 )/                                            X11I0540
     1 6H      ,6H IRREG,6HULAR S,6HERIES /                             X11I0550
      DATA (FB14(I),I=1,11)/                                            X11I0560
     1 6HEXTREM,6HE IRRE,6HGULAR ,6HVALUES,6H EXCLU,6HDED FR,6HOM TRA,  X11I0570
     1 6HDING D,6HAY REG,6HRESSIO,6HN     /                             X11I0580
      DATA (FB15(I),I=1,5 )/                                            X11I0590
     1 6HPRELIM,6H TRADI,6HNG DAY,6H REGRE,6HSSION /                    X11I0600
      DATA (FB16(I),I=1,12)/                                            X11I0610
     1 6HTRADIN,6HG DAY ,6HADJUST,6HMENT F,6HACTORS,6H DERIV,6HED FRO,  X11I0620
     1 6HM REGR,6HESSION,6H COEFF,6HICIENT,6HS     /                    X11I0630
      DATA (FB17(I),I=1,7 )/                                            X11I0640
     1 6HPRELIM,6H WEIGH,6HTS FOR,6H IRREG,6HULAR C,6HOMPONE,6HNT    /  X11I0650
      DATA (FB18(I),I=1,10)/                                            X11I0660
     1 6HTRADIN,6HG-DAY ,6HADJUST,6HMENT F,6HACTORS,6H FROM ,6HCOMBIN,  X11I0670
     1 6HED DAI,6HLY WEI,6HGHTS  /                                      X11I0680
      DATA (FB19(I),I=1,10)/                                            X11I0690
     1 6H   ADJ,6HUSTED*,6H ORIGI,6HNAL SE,6HRIES  ,6HMODIFI,6HED BY ,  X11I0700
     1 6HPRELIM,6H WEIGH,6HTS    /                                      X11I0710
      DATA (FE1 (I),I=1,7 )/                                            X11I0720
     1 6HORIGIN,6HAL SER,6HIES MO,6HDIFIED,6H FOR E,6HXTREME,6HS     /  X11I0730
      DATA (FE2 (I),I=1,6 )/                                            X11I0740
     1 6HMODIFI,6HED SEA,6HSONALL,6HY ADJU,6HSTED S,6HERIES /           X11I0750
      DATA (FE3 (I),I=1,5 )/                                            X11I0760
     1 6HMODIFI,6HED IRR,6HEGULAR,6H SERIE,6HS     /                    X11I0770
      DATA (FE4 (I),I=1,10)/                                            X11I0780
     1 6H     R,6HATIOS ,6HOF ANN,6HUAL TO,6HTALS, ,6HORIGIN,6HAL AND,  X11I0790
     1 6H ADJUS,6HTED SE,6HRIES  /                                      X11I0800
      DATA (FE5 (I),I=1,7 )/                                            X11I0810
     1 6HMONTH-,6HTO-MON,6HTH CHA,6HNGES I,6HN ORIG,6HINAL S,6HERIES /  X11I0820
      DATA (FE6 (I),I=1,11)/                                            X11I0830
     1 6HMONTH-,6HTO-MON,6HTH CHA,6HNGES I,6HN FINA,6HL SEAS,6HONALLY,  X11I0840
     1 6H ADJUS,6HTED SE,6HRIES (,6HD11.) /                             X11I0850
      DATA (FF1 (I),I=1,3 )/                                            X11I0860
     1 6HMCD MO,6HVING A,6HVERAGE/                                      X11I0870
      DATA (FF2 (I),I=1,3 )/                                            X11I0880
     1 6HSUMMAR,6HY MEAS,6HURES  /                                      X11I0890
      DATA FG1 /6HCHART /                                               X11I0900
      ASSIGN 901 TO KRITE                                               X11I0910
      ASSIGN 999 TO KEXIT                                               X11I0920
      JFDA = LFDA                                                       X11I0930
      JLDA = LLDA                                                       X11I0940
      KAVG = JAVG                                                       X11I0950
      DO 992 I = 1,16                                                   X11I0960
  992 TITLE(I) = BLANK                                                  X11I0970
      GO TO (200,200,200,100,500,600,700),KPART                         X11I0980
  100 GO TO (101,102,103,104),KTABL                                     X11I0990
  101 KPAGE = 1                                                         X11I1000
      DO 111 I = 1,3                                                    X11I1010
  111 TITLE(I) = FB19(I+2)                                              X11I1020
      GO TO 900                                                         X11I1030
  102 DO 121 I = 1, 6                                                   X11I1040
  121 TITLE(I) = FA2(I)                                                 X11I1050
      GO TO 900                                                         X11I1060
  103 DO 131 I = 1,10                                                   X11I1070
  131 TITLE(I) = FA3(I)                                                 X11I1080
      GO TO 900                                                         X11I1090
  104 DO 141 I = 1, 6                                                   X11I1100
  141 TITLE(I) = FA4(I)                                                 X11I1110
      ASSIGN 142 TO KRITE                                               X11I1120
      GO TO 900                                                         X11I1130
  142 WRITE (NW,143) (ARR(I),I=1,7),OUT                                 X11I1140
  143 FORMAT (79H A4A. PRIOR DAILY WEIGHTS - MON     TUE     WED    THURX11I1150
     1     FRI     SAT     SUN/ 23X, 7F8.3/                             X11I1160
     247H A4B. PRIOR TRADING DAY ADJUSTMENT FACTORS WITH,A3,27H LENGTH OX11I1170
     3F MONTH ADJUSTMENT)                                               X11I1180
      ASSIGN 145 TO KEXIT                                               X11I1190
      GO TO 901                                                         X11I1200
  145 WRITE (NW, 144)                                                   X11I1210
  144 FORMAT (58H A4C. PRIOR TRADING DAY ADJUSTMENT FACTORS, ONE YEAR AHX11I1220
     1EAD)                                                              X11I1230
      GO TO 315                                                         X11I1240
  200 GO TO (201,202,203,204,205,206,207,203,204,205,206,207,213,214,   X11I1250
     1 215,216,217,218,219),KTABL                                       X11I1260
  201 IF (KPART-2) 224,234,234                                          X11I1270
  224 IF (KSWK-1) 222,101,222                                           X11I1280
  222 DO 233 I = 1, 5                                                   X11I1290
  233 TITLE(I) = FB1(I)                                                 X11I1300
      GO TO 900                                                         X11I1310
  234 DO 235 I = 1,10                                                   X11I1320
  235 TITLE(I) = FB19(I)                                                X11I1330
      TITLE(8) = FINAP                                                  X11I1340
      IF (KSWK-1) 254,254,231                                           X11I1350
  254 TITLE(1) = BLANK                                                  X11I1360
      TITLE(2) = BLANK                                                  X11I1370
      GO TO 900                                                         X11I1380
  231 ASSIGN 301 TO KRITE                                               X11I1390
      GO TO 900                                                         X11I1400
  202 DO 223 I = 1,8                                                    X11I1410
  223 TITLE(I) = FB2(I)                                                 X11I1420
      GO TO 900                                                         X11I1430
  203 DO 264 I = 2,4                                                    X11I1440
  264 TITLE(I) = FB3(I)                                                 X11I1450
      GO TO 356                                                         X11I1460
  204 IF (KPART-2) 266,267,310                                          X11I1470
  310 IF (KTABL-9) 267,230,230                                          X11I1480
  230 ASSIGN 227 TO KEXIT                                               X11I1490
      GO TO 266                                                         X11I1500
  267 DO 269 I = 1,5                                                    X11I1510
  269 TITLE(I) = FC4(I)                                                 X11I1520
  356 TITLE(5) = RADIF1                                                 X11I1530
      TITLE(6) = RADIF2                                                 X11I1540
      GO TO 899                                                         X11I1550
  266 DO 265 I = 2,7                                                    X11I1560
  265 TITLE(I) = FB4(I)                                                 X11I1570
      TITLE(8) = RADIF1                                                 X11I1580
      TITLE(9) = RADIF2                                                 X11I1590
      GO TO 899                                                         X11I1600
  227 WRITE (NW,226) SPC                                                X11I1610
  226 FORMAT (A1,91HD 9A. YEAR TO YEAR CHANGE IN IRREGULAR AND SEASONAL X11I1620
     1COMPONENTS AND MOVING SEASONALITY RATIO/                          X11I1630
     214X,91HJAN     FEB     MAR     APR     MAY     JUN     JUL     AUGX11I1640
     3     SEP     OCT     NOV     DEC)                                 X11I1650
      KSE(4) = KDCML(3)                                                 X11I1660
      KSE(8) = KDCML(3)                                                 X11I1670
      IF (MULADD) 330,331,330                                           X11I1680
  330 KSE(4) = KDCML(2)                                                 X11I1690
      KSE(8) = KDCML(2)                                                 X11I1700
  331 WRITE (NW,KSE) RATI                                               X11I1710
      GO TO 999                                                         X11I1720
  205 DO 225 I=2,4                                                      X11I1730
  225 TITLE(I)=FB5(I)                                                   X11I1740
      IF (KAVG-1) 899,344,899                                           X11I1750
  344 ASSIGN 345 TO KEXIT                                               X11I1760
      GO TO 899                                                         X11I1770
  345 WRITE (NW,232) SPC                                                X11I1780
  232 FORMAT (A1,38HD10A. SEASONAL FACTORS, ONE YEAR AHEAD)             X11I1790
      ASSIGN 999 TO KEXIT                                               X11I1800
      GO TO 316                                                         X11I1810
  206 DO 236 I = 2,6                                                    X11I1820
  236 TITLE(I) = FB6(I)                                                 X11I1830
      GO TO 899                                                         X11I1840
  207 DO 238 I =1,6                                                     X11I1850
  238 TITLE(I) = FB7(I)                                                 X11I1860
      ASSIGN 239 TO KRITE                                               X11I1870
      GO TO 899                                                         X11I1880
  239 WRITE (NW, 237) NTERM, RATIC                                      X11I1890
  237 FORMAT (19X,I2,45H-TERM MOVING AVERAGE SELECTED.   I/C RATIO IS,  X11I1900
     1F6.2)                                                             X11I1910
      GO TO 901                                                         X11I1920
  213 DO 242 I = 2,4                                                    X11I1930
  242 TITLE(I) = FB13(I)                                                X11I1940
      GO TO 899                                                         X11I1950
  214 DO 245 I = 1,11                                                   X11I1960
  245 TITLE(I) = FB14(I)                                                X11I1970
      ASSIGN 270 TO KRITE                                               X11I1980
      GO TO 900                                                         X11I1990
  270 WRITE (NW,271) SIGM                                               X11I2000
  271 FORMAT (9X,9H(OUTSIDE ,F3.1,13H-SIGMA LIMIT))                     X11I2010
      GO TO 901                                                         X11I2020
  215 DO 244 I = 2,5                                                    X11I2030
  244 TITLE(I) = FB15(I)                                                X11I2040
      TITLE(1) = FINAP                                                  X11I2050
      GO TO 632                                                         X11I2060
  216 DO 246 I = 1,12                                                   X11I2070
  246 TITLE(I) = FB16(I)                                                X11I2080
      IF (KPART-2) 900,384,900                                          X11I2090
  384 ASSIGN 386 TO KRITE                                               X11I2100
      GO TO 900                                                         X11I2110
  386 WRITE (NW,385) (ARR(I),I=1,7)                                     X11I2120
  385 FORMAT (96H C16A. REGRESSION COEFFICIENTS - MON       TUE       WEX11I2130
     1D      THUR       FRI       SAT       SUN/27X,7F10.3/             X11I2140
     248H C16B. REGRESSION TRADING DAY ADJUSTMENT FACTORS)              X11I2150
      ASSIGN 388 TO KEXIT                                               X11I2160
      GO TO 901                                                         X11I2170
  388 WRITE (NW,387)                                                    X11I2180
  387 FORMAT (64H C16C. REGRESSION TRADING DAY ADJUSTMENT FACTORS, ONE YX11I2190
     1EAR AHEAD)                                                        X11I2200
      GO TO 315                                                         X11I2210
  315 ASSIGN 999 TO KEXIT                                               X11I2220
  316 JFDA = JLDA + 1                                                   X11I2230
      JLDA = JFDA + 11                                                  X11I2240
      KAVG = 6                                                          X11I2250
      GO TO 901                                                         X11I2260
  217 DO 247 I = 2,7                                                    X11I2270
  247 TITLE(I) = FB17(I)                                                X11I2280
      TITLE(1) = FINAP                                                  X11I2290
      ASSIGN 277 TO KRITE                                               X11I2300
      GO TO 900                                                         X11I2310
  277 WRITE (NW,276) SPC,SIGML,SIGMU                                    X11I2320
  276 FORMAT (A1,8X,22HGRADUATION RANGE FROM ,F3.1,4H TO ,F3.1,6H SIGMA)X11I2330
      GO TO 901                                                         X11I2340
  218 DO 248 I = 1,10                                                   X11I2350
  248 TITLE(I) = FB18(I)                                                X11I2360
      IF (KAVG-18) 323,327,322                                          X11I2370
  322 ASSIGN 324 TO KRITE                                               X11I2380
      GO TO 900                                                         X11I2390
  324 WRITE (NW,325) PART                                               X11I2400
  325 FORMAT (9X,15H(SAME AS TABLE ,A1,4H16.))                          X11I2410
      GO TO 999                                                         X11I2420
  327 ASSIGN 328 TO KRITE                                               X11I2430
      GO TO 900                                                         X11I2440
  328 WRITE (NW,326)                                                    X11I2450
  326 FORMAT (9X,20H(SAME AS TABLE A 4.))                               X11I2460
      GO TO 999                                                         X11I2470
  323 IF (KPART-2) 900,250,900                                          X11I2480
  250 ASSIGN 275 TO KRITE                                               X11I2490
      GO TO 900                                                         X11I2500
  275 WRITE(NW,272) (ARR(I),I=1,7),OUT                                  X11I2510
  272 FORMAT (83H C18A. COMBINED DAILY WEIGHTS - MON     TUE     WED    X11I2520
     1THUR     FRI     SAT     SUN/27X, 7F8.3/                          X11I2530
     251H C18B. COMBINED TRADING-DAY ADJUSTMENT FACTORS WITH,A3,27H LENGX11I2540
     3TH OF MONTH ADJUSTMENT)                                           X11I2550
      ASSIGN 274 TO KEXIT                                               X11I2560
      GO TO 901                                                         X11I2570
  274 WRITE (NW,273)                                                    X11I2580
  273 FORMAT (62H C18C. COMBINED TRADING-DAY ADJUSTMENT FACTORS, ONE YEAX11I2590
     1R AHEAD)                                                          X11I2600
      GO TO 315                                                         X11I2610
  219 DO 249 I = 1,5                                                    X11I2620
  249 TITLE(I) = FB19(I)                                                X11I2630
      ASSIGN 301 TO KRITE                                               X11I2640
      GO TO 900                                                         X11I2650
  301 DO 304 I = 1,10                                                   X11I2660
  304 TITLE(I) = BLANK                                                  X11I2670
      GO TO (901,287,291,288,296,298,291,291),KSWK                      X11I2680
  287 IF (KTABL-1) 335,293,335                                          X11I2690
  288 IF (KTABL-1) 335,291,335                                          X11I2700
  335 WRITE (NW,329)                                                    X11I2710
  329 FORMAT (9X,20H(SAME AS TABLE B 1.))                               X11I2720
      GO TO 999                                                         X11I2730
  291 DO 292 I = 1,6                                                    X11I2740
  292 TITLE(I) = FA2(I)                                                 X11I2750
      WRITE (NW,381) TITLE                                              X11I2760
  381 FORMAT (9X,15H*ADJUSTED BY...,16A6)                               X11I2770
  293 GO TO (901,294,901,294,296,298,296,298),KSWK                      X11I2780
  294 DO 295 I = 1,6                                                    X11I2790
  295 TITLE(I) = FA4(I)                                                 X11I2800
      GO TO 300                                                         X11I2810
  296 DO 297 I = 1,12                                                   X11I2820
  297 TITLE(I) = FB16(I)                                                X11I2830
      GO TO 300                                                         X11I2840
  298 DO 299 I = 1,10                                                   X11I2850
  299 TITLE(I) = FB18(I)                                                X11I2860
  300 WRITE (NW,381) TITLE                                              X11I2870
      GO TO 901                                                         X11I2880
  500 GO TO (501,502,503,504,505,506),KTABL                             X11I2890
  501 DO 550 I = 1,7                                                    X11I2900
  550 TITLE(I)=FE1(I)                                                   X11I2910
      GO TO 900                                                         X11I2920
  502 DO 551 I =1,6                                                     X11I2930
  551 TITLE(I) = FE2(I)                                                 X11I2940
      GO TO 900                                                         X11I2950
  503 DO 552 I = 1,5                                                    X11I2960
  552 TITLE(I)=FE3(I)                                                   X11I2970
      GO TO 900                                                         X11I2980
  504 DO 554 I = 1,10                                                   X11I2990
  554 TITLE(I) = FE4(I)                                                 X11I3000
      IF (MULADD) 553,557,553                                           X11I3010
  553 TITLE(1) = DIFRAT(2)                                              X11I3020
      TITLE(2) = DIFRAT(3)                                              X11I3030
  557 ASSIGN  556 TO KRITE                                              X11I3040
      GO TO 900                                                         X11I3050
  556 WRITE (NW,555)                                                    X11I3060
  555 FORMAT (4X,4HYEAR,6X,21HUNMODIFIED   MODIFIED)                    X11I3070
      GO TO 999                                                         X11I3080
  505 DO 558 I = 1,7                                                    X11I3090
  558 TITLE(I) = FE5(I)                                                 X11I3100
      GO TO 900                                                         X11I3110
  506 DO 559 I = 1,11                                                   X11I3120
  559 TITLE(I) = FE6(I)                                                 X11I3130
      GO TO 900                                                         X11I3140
  600 GO TO (601,602),KTABL                                             X11I3150
  601 DO 658 I = 1,3                                                    X11I3160
  658 TITLE(I) = FF1(I)                                                 X11I3170
      ASSIGN 659 TO KRITE                                               X11I3180
      GO TO 900                                                         X11I3190
  659 WRITE (NW,651) MCD                                                X11I3200
  651 FORMAT (12X, 7HMCD IS , I2)                                       X11I3210
      IF (MCD-1) 901,653,901                                            X11I3220
  653 WRITE (NW,652)                                                    X11I3230
  652 FORMAT (9X,13HSEE TABLE D11)                                      X11I3240
      GO TO 999                                                         X11I3250
  602 DO 660 I = 1,3                                                    X11I3260
  660 TITLE (I) = FF2(I)                                                X11I3270
  632 ASSIGN 999 TO KRITE                                               X11I3280
      GO TO 900                                                         X11I3290
  700 GO TO (701,702,702,704),KTABL                                     X11I3300
  701 ASSIGN 711 TO KRITE                                               X11I3310
      GO TO 710                                                         X11I3320
  702 ASSIGN 721 TO KRITE                                               X11I3330
      GO TO 710                                                         X11I3340
  704 ASSIGN 741 TO KRITE                                               X11I3350
  710 TITLE(1) = FG1                                                    X11I3360
      GO TO 900                                                         X11I3370
  711 WRITE (NW,750)                                                    X11I3380
  750 FORMAT (9X,43H(X) - D11. FINAL SEASONALLY ADJUSTED SERIES/        X11I3390
     1        9X,28H(O) - D12. FINAL TREND CYCLE/                       X11I3400
     2        9X,27H(*) - COINCIDENCE OF POINTS)                        X11I3410
      GO TO 999                                                         X11I3420
  721 WRITE (NW,751) RADIF1,RADIF2,RADIF1,RADIF2                        X11I3430
  751 FORMAT (9X,31H(X) - D 8. FINAL UNMODIFIED SI ,2A6/                X11I3440
     1        9X,20H(O) - D 9. FINAL SI ,2A6,21HMODIFIED FOR EXTREMES/  X11I3450
     2        9X,33H(+) - D10. FINAL SEASONAL FACTORS/                  X11I3460
     2        9X,27H(*) - COINCIDENCE OF POINTS)                        X11I3470
      GO TO 999                                                         X11I3480
  741 WRITE (NW,752)                                                    X11I3490
  752 FORMAT (9X,33H(X) - D13. FINAL IRREGULAR SERIES/                  X11I3500
     1        9X,42H(O) - E 3. FINAL MODIFIED IRREGULAR SERIES/         X11I3510
     2        9X,27H(*) - COINCIDENCE OF POINTS)                        X11I3520
      GO TO 999                                                         X11I3530
  899 TITLE(1) = FINAB                                                  X11I3540
  900 WRITE (NW,800) NEWPAG,NAME,KPAGE,LSER                             X11I3550
  800 FORMAT (A1,17X,13A6,A2,2X,3H P.,I2,9H, SERIES ,A6)                X11I3560
      WRITE (NW,801) SPC,PART,KTABL, (TITLE(I),I=1,16)                  X11I3570
  801 FORMAT (2A1,I2,2H. ,16A6)                                         X11I3580
      KPAGE = KPAGE + 1                                                 X11I3590
      GO TO KRITE,(901,142,301,239,270,386,277,324,328,275,556,659,999, X11I3600
     1 711,721,741)                                                     X11I3610
  901 KDCM = JDCM                                                       X11I3620
      KYRLY = 1                                                         X11I3630
      GO TO (1,2,3,4,5,6,7),KDCM                                        X11I3640
    1 KYRLY = 4                                                         X11I3650
      GO TO 2                                                           X11I3660
    3 IF (MULADD) 9,2,9                                                 X11I3670
    4 IF (MULADD) 9,11,9                                                X11I3680
   11 KDCM = 1                                                          X11I3690
      GO TO 2                                                           X11I3700
    5 KYRLY = 3                                                         X11I3710
      GO TO 4                                                           X11I3720
    6 KYRLY = 4                                                         X11I3730
      GO TO 4                                                           X11I3740
    7 KYRLY = 2                                                         X11I3750
    9 KDCM = KDEC                                                       X11I3760
    2 YRLY = TYRLY(KYRLY)                                               X11I3770
      NF1(2) = NF3                                                      X11I3780
      NF1(5) = KDCML(KDCM)                                              X11I3790
      NF1(7) = KDCML(KDCM)                                              X11I3800
      NF2(6) = KDCML(KDCM)                                              X11I3810
      NF2(10) = KDCML(KDCM)                                             X11I3820
      NF2(16) = KDCML(KDCM)                                             X11I3830
   40 WRITE (NW,99) SPC,YRLY                                            X11I3840
   99 FORMAT (A1,3X,110HYEAR      JAN     FEB     MAR     APR     MAY   X11I3850
     1  JUN     JUL     AUG     SEP     OCT     NOV     DEC         ,A6)X11I3860
      SK = 100.                                                         X11I3870
      IF (MULADD) 20,21,20                                              X11I3880
   20 SK = 0.                                                           X11I3890
   21 KSWR = 1                                                          X11I3900
      JYR = LYR + (JFDA-1)/12                                           X11I3910
      JDEC = (JLDA+11)/12 *12                                           X11I3920
   43 TOTAL=0.0                                                         X11I3930
      YRDEV = 0.0                                                       X11I3940
      TOTDEV = 0.0                                                      X11I3950
      DO 48 I = 1, 12                                                   X11I3960
      TMP(I) = 10.**10                                                  X11I3970
      AVGMON(I) = 0.0                                                   X11I3980
      SDEV(I) = 0.0                                                     X11I3990
   48 TOTMON(I) = 0.0                                                   X11I4000
      JMON=JFDA                                                         X11I4010
      IM = JMON - (JMON-1)/12 * 12                                      X11I4020
      KMON = JMON - IM + 12                                             X11I4030
   45 YRTOT=0.0                                                         X11I4040
      YRDEV = 0.0                                                       X11I4050
      DO 44 I=JMON,KMON                                                 X11I4060
      TMP(IM) = ARRAY(I)                                                X11I4070
      TOTMON(IM) = TOTMON(IM) + 1.                                      X11I4080
      TOTDEV = TOTDEV + TMP(IM)**2                                      X11I4090
      SDEV(IM) = SDEV(IM) + (TMP(IM)-SK)**2                             X11I4100
      YRDEV = YRDEV + (TMP(IM)-SK)**2                                   X11I4110
      AVGMON(IM) = AVGMON(IM) + TMP(IM)                                 X11I4120
      YRTOT = YRTOT + TMP(IM)                                           X11I4130
      TOTAL = TOTAL + TMP(IM)                                           X11I4140
   44 IM = IM + 1                                                       X11I4150
      P = KMON + 1 - JMON                                               X11I4160
      GO TO (86,50,82,87),KYRLY                                         X11I4170
   82 YRTOT = SQRT(YRDEV/P)                                             X11I4180
      GO TO 50                                                          X11I4190
   86 YRTOT = YRTOT/P                                                   X11I4200
      GO TO 50                                                          X11I4210
   87 YRTOT = ARR(IN)                                                   X11I4220
      IN = IN + 1                                                       X11I4230
   50 WRITE (NW,NF1) SPC,JYR,(TMP(I),I=1,12),YRTOT                      X11I4240
   51 JYR = JYR + 1                                                     X11I4250
      JMON=KMON+1                                                       X11I4260
      KMON=KMON+12                                                      X11I4270
      IM = 1                                                            X11I4280
      IF (KMON-JDEC) 45,46,70                                           X11I4290
   46 KMON = JLDA                                                       X11I4300
      DO 41 I = 1,12                                                    X11I4310
   41 TMP(I) = 10.**10                                                  X11I4320
      GO TO 45                                                          X11I4330
   70 WRITE (NW,802) SPC                                                X11I4340
  802 FORMAT (A1)                                                       X11I4350
      GO TO (80,73,75,80,73,89),KAVG                                    X11I4360
   73 NF1(2) = NF4                                                      X11I4370
      DO 71 I = 1,12                                                    X11I4380
   71 AVGMON(I) =AVGMON(I)/TOTMON(I)                                    X11I4390
      GO TO 72                                                          X11I4400
   75 NF1(2) = NF5                                                      X11I4410
      NF1(5) = KDCML(1)                                                 X11I4420
      DO 76 I = 1,12                                                    X11I4430
   76 AVGMON(I) = SQRT(SDEV(I)/TOTMON(I))                               X11I4440
   72 WRITE (NW,NF1) SPC,(AVGMON(I),I=1,12)                             X11I4450
   80 IF (KAVG-3) 81,81,88                                              X11I4460
   81 TOTN = JLDA+1-JFDA                                                X11I4470
      AVGE = TOTAL/TOTN                                                 X11I4480
      TOTDEV = SQRT(TOTDEV/TOTN - AVGE**2)                              X11I4490
      WRITE (NW,NF2) SPC,TOTAL,BLANK,AVGE,TOTDEV                        X11I4500
      GO TO 89                                                          X11I4510
   88 WRITE (NW,NF2) SPC,TOTAL                                          X11I4520
   89 GO TO KEXIT,(999,145,227,345,388,274)                             X11I4530
  999 RETURN                                                            X11I4540
      END                                                               X11I4550
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
      SUBROUTINE SUMRY (ARRAY,SM,LFDA,LLDA,N)                           X11J0020
C     AVERAGE PERCENT CHANGE WITHOUT REGARD TO SIGN FOR 1-12 MONTHS     X11J0030
C     SPANS IN SM(1)-SM(12). AVGE PCT CHANGE WITH REGARD TO SIGN -      X11J0040
C     SM(25)-SM(36). AVGE PCT CHANGE W/O REGARD TO SIGN SQUARED -       X11J0050
C     SM(13)-SM(24). STND.DEVIATION OF PERCENT CHANGES - SM(37)-SM(48). X11J0060
      COMMON/CJ/MULADD                                                  X11J0070
      DIMENSION ARRAY(600),SM(48)                                       X11J0080
      K = LLDA                                                          X11J0090
      DO 20 I = 1,12                                                    X11J0100
      K = K-1                                                           X11J0110
      P = K-LFDA+1                                                      X11J0120
      SM(I) = 0.                                                        X11J0130
      DO 3 J = LFDA,K                                                   X11J0140
      M = I + J                                                         X11J0150
      IF (MULADD) 2,1,2                                                 X11J0160
    1 SM(I)=SM(I)+ABS((ARRAY(M) - ARRAY(J))*100./ARRAY(J))              X11J0170
      GO TO 3                                                           X11J0180
    2 SM(I)=SM(I)+ABS(ARRAY(M) - ARRAY(J))                              X11J0190
    3 CONTINUE                                                          X11J0200
      SM(I) = SM(I)/P                                                   X11J0210
      IF (N-3) 4,6,20                                                   X11J0220
    4 SM(I+12) = SM(I)**2                                               X11J0230
    5 IF (N-2) 20,6,20                                                  X11J0240
    6 SM(I+24) = 0                                                      X11J0250
      SM(I+36) = 0                                                      X11J0260
      DO 9 J = LFDA,K                                                   X11J0270
      M = I + J                                                         X11J0280
      IF (MULADD) 8,7,8                                                 X11J0290
    7 SM(I+24) = SM(I+24)+(ARRAY(M) - ARRAY(J))*100./ARRAY(J)           X11J0300
      GO TO 9                                                           X11J0310
    8 SM(I+24) = SM(I+24)+ARRAY(M) - ARRAY(J)                           X11J0320
    9 CONTINUE                                                          X11J0330
      SM(I+24) = SM(I+24)/P                                             X11J0340
      DO 12 J = LFDA,K                                                  X11J0350
      M = I + J                                                         X11J0360
      IF (MULADD) 11,10,11                                              X11J0370
   10 ARRAY(J)=ARRAY(J)                                                 X11J0380
      SM(I+36)=SM(I+36)+(SM(I+24)-(ARRAY(M)-ARRAY(J))*100./ARRAY(J))**2 X11J0390
      GO TO 12                                                          X11J0400
   11 SM(I+36)=SM(I+36)+(ARRAY(M) - ARRAY(J)-SM(I+24))**2               X11J0410
   12 CONTINUE                                                          X11J0420
      SM(I+36) = SQRT(SM(I+36)/P)                                       X11J0430
   20 CONTINUE                                                          X11J0440
      RETURN                                                            X11J0450
      END                                                               X11J0460
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
C --- THIS ROUTINE COMPUTES SEVEN DAILY WEIGHTS FROM THE DATA BY        X11K0020
C --- REGRESSION METHODS.                                               X11K0030
      SUBROUTINE TRADAY (KFDA,KLDA,LYR,SIGM,KPART,LOPT,KSWT)            X11K0040
      REAL MATRX                                                        X11K0050
      COMMON/CA/NW,STMP(600)                                            X11K0060
      COMMON /CJ/MULADD                                                 X11K0070
      COMMON/CL/ARRAY(360),KARRAY(360),STDR(360),DR(7),DP(7),FSTAR,KPRNTX11K0080
      DIMENSION KDAYS(12),MDAYS(12),TMEAN(22),TC(22),X(7),C(6),S(7),V(6)X11K0090
     1,TP(7),DC(7),T1(7),STAR1(7),STAR2(7),SETDAF(3),ADJ(8)             X11K0100
     2,MATRX(6,7),WT(3)                                                 X11K0110
      DATA (ADJ(I),I=1,8) /31.,30.,29.,0.,30.4375,30.4375,30.4375,0./   X11K0120
      DATA STAR /6H******/                                              X11K0130
      DATA BLANK /6H      /                                             X11K0140
      DATA (KDAYS(I), I = 1,12)/3,0,3,2,3,2,3,3,2,3,2,3/                X11K0150
      DATA (MDAYS(I), I = 1,12)/0,3,3,6,1,4,6,2,5,0,3,5/                X11K0160
 8200 FORMAT (22X,65HCOMBINED      PRIOR    REGRESSION   ST.ERROR       X11K0170
     1  T          T/                                                   X11K0180
     223X,52HWEIGHT      WEIGHT      COEFF.    (COMB.WT.)       (,I1,   X11K0190
     317H)     (PRIOR WT.)/                                             X11K0200
     411X,9H   MONDAY,F9.3,7X,F5.3,3F12.3,A1,4X,F7.3,A2/                X11K0210
     511X,9H  TUESDAY,F9.3,7X,F5.3,3F12.3,A1,4X,F7.3,A2/                X11K0220
     611X,9HWEDNESDAY,F9.3,7X,F5.3,3F12.3,A1,4X,F7.3,A2/                X11K0230
     711X,9H THURSDAY,F9.3,7X,F5.3,3F12.3,A1,4X,F7.3,A2/                X11K0240
     811X,9H   FRIDAY,F9.3,7X,F5.3,3F12.3,A1,4X,F7.3,A2/                X11K0250
     911X,9H SATURDAY,F9.3,7X,F5.3,3F12.3,A1,4X,F7.3,A2/                X11K0260
     911X,9H   SUNDAY,F9.3,7X,F5.3,3F12.3,A1,4X,F7.3,A2)                X11K0270
 8201 FORMAT (26X,46H*   COMBINED WT. SIGNIFICANTLY DIFFERENT FROM ,I1, X11K0280
     1 20H AT 1 PER CENT LEVEL)                                         X11K0290
 8202 FORMAT (26X,78H**  COMBINED WT. SIGNIFICANTLY DIFFERENT FROM PRIORX11K0300
     1 WEIGHT AT 1 PER CENT LEVEL)                                      X11K0310
 8203 FORMAT (//21X,9HSOURCE OF, 9X, 6HSUM OF,5X,7HDGRS.OF,9X,4HMEAN/   X11K0320
     122X,8HVARIANCE,9X,7HSQUARES,4X,7HFREEDOM,9X,6HSQUARE,9X,1HF//     X11K0330
     220X,10HREGRESSION,F17.3,7X,2H6.,F17.3,F12.3,A3/                   X11K0340
     325X,5HERROR,F17.3,F9.0,F17.3/                                     X11K0350
     425X,5HTOTAL,F17.3,F9.0)                                           X11K0360
 8204 FORMAT (26X,66H*** RESIDUAL TRADING DAY VARIATION PRESENT AT THE 1X11K0370
     1 PER CENT LEVEL/)                                                 X11K0380
 8205 FORMAT (11X,86HSTANDARD ERRORS OF TRADING DAY ADJUSTMENT FACTORS DX11K0390
     1ERIVED FROM REGRESSION COEFFICIENTS/15X,15H31-DAY MONTHS- ,F8.2/  X11K0400
     215X,15H30-DAY MONTHS- ,F8.2/15X,15H29-DAY MONTHS- ,F8.2/15X,23H28-X11K0410
     3DAY MONTHS-      .00)                                             X11K0420
      LFDA = KFDA                                                       X11K0430
      LLDA = KLDA                                                       X11K0440
      TKON = 100.                                                       X11K0450
   81 KON = 1                                                           X11K0460
      IF (MULADD) 198,199,198                                           X11K0470
  198 TKON = 0.                                                         X11K0480
      KON = 0                                                           X11K0490
  199 IF (KPART-1) 200,200,300                                          X11K0500
C --- DETERMINE DAY-OF-WEEK OF FIRST DAY OF FIRST MONTH OF SERIES       X11K0510
C ---     DETERMINE D-O-W OF JAN.1 OF LYR. 1=MON., 7=SUN.               X11K0520
  200 N = LYR + 12 - ((LYR + 11)/28) * 28                               X11K0530
      N = N + (N-1)/4                                                   X11K0540
      N = N - ((N-1)/7) * 7                                             X11K0550
C ---    D-O-W FOR ACTUAL FIRST MONTH OF SERIES                         X11K0560
      J = LFDA - (LFDA-1)/12*12                                         X11K0570
      N = N + MDAYS(J)                                                  X11K0580
C ---    ADD A DAY IF FIRST MONTH IS IN LEAP YEAR AND AFTER FEB.        X11K0590
      L = LYR - 1                                                       X11K0600
      IF (J-2) 11,11,12                                                 X11K0610
   12 L = LYR                                                           X11K0620
      IF (LYR-LYR/4*4) 11,13,11                                         X11K0630
   13 N = N + 1                                                         X11K0640
   11 IF (N - 7) 10, 10, 9                                              X11K0650
    9 N = N - 7                                                         X11K0660
   10 M = N                                                             X11K0670
C --- STORE TYPE CODE FOR EACH MONTH IN KARRAY.ALSO ACCUMULATE IRREGULARX11K0680
C ---   AND COUNT BY TYPE TO GET TYPE MEAN                              X11K0690
      DO 8 I = LFDA, LLDA                                               X11K0700
      STMP(I) = 10.**10                                                 X11K0710
      K = KDAYS(J)                                                      X11K0720
C --- TEST FOR FEB.                                                     X11K0730
      IF (K) 4, 1, 4                                                    X11K0740
C --- TEST FOR LEAP YEAR FEB.                                           X11K0750
    1 L = L + 1                                                         X11K0760
      IF (L - (L/4) * 4) 2, 3, 2                                        X11K0770
C --- NON-LEAP YEAR FEB. TYPE CODE IS 15                                X11K0780
    2 MTYPE = 15                                                        X11K0790
      GO TO 14                                                          X11K0800
C --- LEAP YEAR FEB. TYPE CODE IS 16-22 FOR 1ST DAY MON. THRU SUN.      X11K0810
    3 MTYPE = M + 15                                                    X11K0820
      K = 1                                                             X11K0830
      GO TO 14                                                          X11K0840
C --- TYPE CODES FOR NON-FEB ARE 1-7  AND  8-14 FOR 30 AND 31 DAY MOS.  X11K0850
    4 MTYPE = (K - 2) * 7 + M                                           X11K0860
C --- STORE TYPE CODE IN KARRAY                                         X11K0870
   14 KARRAY(I) = MTYPE                                                 X11K0880
C --- FIND FIRST DAY FOR NEXT MONTH IN SERIES                           X11K0890
      M = M + K                                                         X11K0900
      IF (M - 7) 6, 6, 5                                                X11K0910
    5 M = M - 7                                                         X11K0920
    6 J = J + 1                                                         X11K0930
      IF (J - 12) 8, 8, 7                                               X11K0940
    7 J = 1                                                             X11K0950
    8 CONTINUE                                                          X11K0960
C --- COMPUTE SIGMA LIMITS AND IDENTIFY EXTREME IRREGULARS              X11K0970
      KSTD = 1                                                          X11K0980
   21 DO 22 I = 1, 22                                                   X11K0990
      TC(I) = 0.                                                        X11K1000
   22 TMEAN(I) = 0.                                                     X11K1010
      TK = 0.                                                           X11K1020
      TSD = 0.                                                          X11K1030
      DO 24 I = LFDA, LLDA                                              X11K1040
      M = KARRAY(I)                                                     X11K1050
      IF (M - 15) 23, 23, 24                                            X11K1060
   23 TMEAN(M) = TMEAN(M) + ARRAY(I)                                    X11K1070
      TC(M) = TC(M) + 1.                                                X11K1080
      TK = TK + 1.                                                      X11K1090
   24 CONTINUE                                                          X11K1100
      DO 25 I = 1, 15                                                   X11K1110
   25 TMEAN(I) = TMEAN(I)/TC(I)                                         X11K1120
C --- COMPUTE SQ.DEV. OF IRR.FM.TYPE-MEANS FOR NON-LEAP YEAR FEBS.      X11K1130
      DO 28 I = LFDA, LLDA                                              X11K1140
      M = KARRAY(I)                                                     X11K1150
      IF (M - 15) 27, 27, 28                                            X11K1160
   27 TSD = TSD + (ARRAY(I) - TMEAN(M))**2                              X11K1170
   28 CONTINUE                                                          X11K1180
      TSD = SQRT(TSD/TK) * SIGM                                         X11K1190
C --- IDENTIFY EXTREME IRREGULARS BY ADDING 22 TO TYPE CODE             X11K1200
      DO 35 I = LFDA, LLDA                                              X11K1210
      M = KARRAY(I)                                                     X11K1220
      IF (M - 22) 29, 29, 35                                            X11K1230
   29 IF (M - 15) 30, 30, 33                                            X11K1240
   30 IF (ABS(ARRAY(I)-TMEAN(M))-TSD) 35,35,32                          X11K1250
   33 IF (ABS(ARRAY(I)-TKON)-TSD) 35,35,32                              X11K1260
   32 KARRAY(I) = KARRAY(I) + 22                                        X11K1270
      STMP(I) = ARRAY(I)                                                X11K1280
   35 CONTINUE                                                          X11K1290
      GO TO ( 36, 37), KSTD                                             X11K1300
   36 KSTD = 2                                                          X11K1310
      GO TO 21                                                          X11K1320
  300 DO 302 I = LFDA, LLDA                                             X11K1330
  333 IF (KARRAY(I)-22) 302,302,301                                     X11K1340
  301 KARRAY(I) = KARRAY(I) - 22                                        X11K1350
      GO TO 333                                                         X11K1355
  302 CONTINUE                                                          X11K1360
      KSTD = 1                                                          X11K1370
  310 TSD = 0.                                                          X11K1380
      TK = 0.                                                           X11K1390
      DO 304 I = LFDA, LLDA                                             X11K1400
      IF (KARRAY(I) - 22) 303,303,304                                   X11K1410
  303 TSD = TSD + (ARRAY(I) - STDR(I))**2                               X11K1420
      TK = TK + 1.                                                      X11K1430
  304 CONTINUE                                                          X11K1440
      TSD = SQRT(TSD/TK) * SIGM                                         X11K1450
      DO 308 I = LFDA, LLDA                                             X11K1460
      STMP(I) = 10.**10                                                 X11K1470
  305 IF (ABS(ARRAY(I)-STDR(I))-TSD) 308,308,307                        X11K1480
  307 KARRAY(I) = KARRAY(I) + 22                                        X11K1490
      STMP(I) = ARRAY(I)                                                X11K1500
  308 CONTINUE                                                          X11K1510
      GO TO (309, 37), KSTD                                             X11K1520
  309 KSTD = 2                                                          X11K1530
      GO TO 310                                                         X11K1540
C --- REGRESSION COMPUTATION                                            X11K1550
   37 IF (KPRNT-2) 39,38,38                                             X11K1560
   38 CALL RITE (14,STMP,LFDA,LLDA,6,4,0)                               X11K1570
      CALL RITE (15,0,0,0,0,0,0)                                        X11K1580
   39 SUMY = 0.                                                         X11K1590
      SUMYSQ = 0.                                                       X11K1600
      DO 40 I = 1, 6                                                    X11K1610
      DO 40 J = 1, 7                                                    X11K1620
   40 MATRX(I,J) = 0.                                                   X11K1630
      DO 58 I = LFDA, LLDA                                              X11K1640
      DO 41 J = 1, 7                                                    X11K1650
   41 X(J) = 0.                                                         X11K1660
      M = KARRAY(I)                                                     X11K1670
      Y = ARRAY(I)                                                      X11K1680
      IF (M-7) 251,251,201                                              X11K1690
  201 M = M-7                                                           X11K1700
      IF (M-8) 245,210,202                                              X11K1710
  202 M = M-8                                                           X11K1720
      IF (M-7) 203,203,58                                               X11K1730
C --- 28 DAY MONTH                                                      X11K1732
  210 IF (MULADD) 56,211,56                                             X11K1734
  211 GO TO (212,213,212,213),KSWT                                      X11K1736
  212 Y = Y*.2825-28.                                                   X11K1738
      GO TO 56                                                          X11K1740
  213 Y = Y*.28-28.                                                     X11K1742
      GO TO 56                                                          X11K1744
C --- 29 DAY MONTH                                                      X11K1746
  203 N = 1                                                             X11K1748
      IF (MULADD) 50,220,50                                             X11K1750
  220 GO TO (221,222,221,222),KSWT                                      X11K1752
  221 Y = Y * .2825 - 29.                                               X11K1754
      GO TO 50                                                          X11K1756
  222 Y = (Y/100.-1.)*(28.+DP(M))                                       X11K1758
      GO TO 50                                                          X11K1760
C --- 30 DAY MONTH                                                      X11K1762
  251 N = 2                                                             X11K1764
      IF (MULADD) 50,252,50                                             X11K1766
  252 M1 = M + 1                                                        X11K1768
      IF (M1-8) 254,253,253                                             X11K1770
  253 M1 = 1                                                            X11K1772
  254 Y =(Y/100.-1.)*(28.+DP(M)+DP(M1))                                 X11K1774
      GO TO 50                                                          X11K1780
C --- 31 DAY MONTH                                                      X11K1790
  245 N = 3                                                             X11K1800
      IF (MULADD) 50,246,50                                             X11K1810
  246 M1 = M+1                                                          X11K1820
      M2 = M+2                                                          X11K1830
      IF (M1-7) 249,248,247                                             X11K1840
  247 M1 = M1-7                                                         X11K1850
  248 M2 = M2-7                                                         X11K1860
  249 Y = (Y/100.-1.)*(28.+DP(M)+DP(M1)+DP(M2))                         X11K1870
   50 DO 53 J = 1, N                                                    X11K1880
      IF (M - 7) 52, 52, 51                                             X11K1890
   51 M = M - 7                                                         X11K1900
   52 X(M) = 1.                                                         X11K1910
   53 M = M + 1                                                         X11K1920
      IF (X(7)) 56, 56, 54                                              X11K1930
   54 DO 55 J = 1, 6                                                    X11K1940
   55 X(J) = X(J) - 1.                                                  X11K1950
   56 SUMY = SUMY + Y                                                   X11K1960
      SUMYSQ = SUMYSQ + Y * Y                                           X11K1970
      DO 57 M = 1, 6                                                    X11K1980
      MATRX(M,7) = MATRX(M,7) + Y * X(M)                                X11K1990
      DO 57 J = 1, 6                                                    X11K2000
   57 MATRX(M,J) = MATRX(M,J) + X(M) * X(J)                             X11K2010
   58 CONTINUE                                                          X11K2020
      DO 59 I = 1, 6                                                    X11K2030
   59 V(I) = MATRX(I,7)                                                 X11K2040
      DO 65 I = 1, 6                                                    X11K2050
   61 R = 1./MATRX(I,1)                                                 X11K2060
      DO 62 J = 1, 6                                                    X11K2070
   62 MATRX(I,J) = R * MATRX(I, J+1)                                    X11K2080
      MATRX(I,7) = R                                                    X11K2090
      DO 65 M = 1, 6                                                    X11K2100
      IF (M - I) 63, 65, 63                                             X11K2110
   63 R = -MATRX(M,1)                                                   X11K2120
      DO 64 J = 1, 6                                                    X11K2130
   64 MATRX(M,J) = MATRX(M,J+1) + R * MATRX(I,J)                        X11K2140
      MATRX(M,7) = R * MATRX(I,7)                                       X11K2150
   65 CONTINUE                                                          X11K2160
      S(7) = 0.                                                         X11K2170
      DO 66 I = 1, 6                                                    X11K2180
      DO 66 J = 2, 7                                                    X11K2190
   66 S(7) = S(7) + MATRX(I,J)                                          X11K2200
      DO 67 I = 1, 6                                                    X11K2210
   67 C(I) = MATRX(I,I+1)                                               X11K2220
      DSS = 0.                                                          X11K2230
      XN = 0.                                                           X11K2240
      DO 69 I = LFDA,LLDA                                               X11K2250
      IF (KARRAY(I)-22) 68,68,69                                        X11K2260
   68 XN = XN + 1.                                                      X11K2270
   69 CONTINUE                                                          X11K2280
      DR(7) = 0.                                                        X11K2290
      DO 71 I = 1, 6                                                    X11K2300
      DR(I) = MATRX(I,1)                                                X11K2310
      DR(7) = DR(7) - MATRX(I,1)                                        X11K2320
   71 DSS = DSS + DR(I) * V(I)                                          X11K2330
      RSS = SUMYSQ - DSS                                                X11K2340
      TMP = RSS/(XN - 6.)                                               X11K2350
      SE = SQRT(TMP)                                                    X11K2360
      F = (DSS/6.)/TMP                                                  X11K2370
      FSTAR = BLANK                                                     X11K2380
      IF (F-2.95) 75,75,74                                              X11K2390
   74 FSTAR = STAR                                                      X11K2400
   75 IF (KPRNT-2) 107,109,109                                          X11K2410
  109 DO 72 I = 1,6                                                     X11K2420
   72 S(I) = SE * SQRT(C(I))                                            X11K2430
      S(7) = SE * SQRT(S(7))                                            X11K2440
      TMP = XN - 6.                                                     X11K2450
      DSSM = DSS/6.                                                     X11K2460
      RSSM = RSS/TMP                                                    X11K2470
      SUMM = SUMYSQ/XN                                                  X11K2480
      SIGT1 = 0.                                                        X11K2490
      SIGT2 = 0.                                                        X11K2500
      DO 97 I = 1, 7                                                    X11K2510
      STAR1(I) = BLANK                                                  X11K2520
      STAR2(I) = BLANK                                                  X11K2530
      IF (MULADD) 110,92,110                                            X11K2540
   92 X(I) = DP(I)                                                      X11K2550
      DC(I) = DP(I) + DR(I)                                             X11K2560
      TP(I) = DR(I)/S(I)                                                X11K2570
      T1(I) = (DC(I)-1.)/S(I)                                           X11K2580
      IF (ABS(TP(I))-2.62) 95,95,94                                     X11K2590
   94 STAR2(I) = STAR                                                   X11K2600
      SIGT2 = 1.                                                        X11K2610
      GO TO 95                                                          X11K2620
  110 X(I) = 10.**10                                                    X11K2630
      TP(I) = 10.**10                                                   X11K2640
      DC(I) = DR(I)                                                     X11K2650
      T1(I) = DC(I)/S(I)                                                X11K2660
   95 IF (ABS(T1(I))-2.62) 97,97,96                                     X11K2670
   96 STAR1(I) = STAR                                                   X11K2680
      SIGT1 = 1.                                                        X11K2690
   97 CONTINUE                                                          X11K2700
  104 WRITE (NW,8200) KON,(DC(I),X(I),DR(I),S(I),T1(I),STAR1(I),TP(I),  X11K2710
     1STAR2(I), I = 1,7)                                                X11K2720
      IF (SIGT1 - 1.)99, 98, 99                                         X11K2730
   98 WRITE (NW,8201) KON                                               X11K2740
   99 IF (SIGT2 -1.) 101, 100, 101                                      X11K2750
  100 WRITE (NW, 8202)                                                  X11K2760
  101 WRITE (NW,8203) DSS,DSSM,F,FSTAR,RSS,TMP,RSSM,SUMYSQ,XN           X11K2770
      IF (FSTAR-BLANK)102,105,102                                       X11K2780
  102 WRITE (NW, 8204)                                                  X11K2790
  105 DO 106 K = 1,3                                                    X11K2800
      M = K + LOPT                                                      X11K2810
      WT(K) = ADJ(M)                                                    X11K2820
      M = 4 - K                                                         X11K2830
      SETDAF(M) = 0.                                                    X11K2840
      L = K+1                                                           X11K2850
      DO 106 I = 1,K                                                    X11K2860
      DO 106 J = 2,L                                                    X11K2870
  106 SETDAF(M) = SETDAF(M) + MATRX(I,J)                                X11K2880
      DO 108 I = 1,3                                                    X11K2890
  108 SETDAF(I) = SQRT(SETDAF(I))*100.*SE/WT(I)                         X11K2900
      WRITE (NW,8205) SETDAF                                            X11K2910
  107 RETURN                                                            X11K2920
      END                                                               X11K2930
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
      SUBROUTINE VSFC (LFDA,LLDA,KSECT)                                 X11L0020
C --- SEASONAL FACTOR CURVE ROUTINE.                                    X11L0030
      COMMON/CA/NW,STMP(600)                                            X11L0040
      COMMON/CC/RATI(36),LTERM(12),STS(372),STSI(360)                   X11L0050
      COMMON/CF/LSER,LYR,PART,KSWK,FINAB,FINAP,KPART,AORB,OUT,MCD,SIGM, X11L0060
     1SIGML,SIGMU,IN,RADIF1,RADIF2,KDEC,NEWPAG,SPC,NAME(14)             X11L0070
      COMMON/CJ/MULADD                                                  X11L0080
      DIMENSION W3X9(66), W3A9(50), W3B9(45), W3C9(32), W3D9(28),       X11L0090
     1 W3E9(18), W3X5(28), W3A5(18),W3B5(15), W3C5(8), W3X3(15),        X11L0100
     2 W3A3(8), W3B3(6), W3X1(6),STSP(57),STAVG(57)                     X11L0110
C --- WEIGHTS FOR 3X9 MOVING AVGE. WEIGHTS IN W3A9-W3E9 ARE FOR SERIES  X11L0120
C --- SHORTER THAN 11 YEARS.                                            X11L0130
      DATA (W3X9(I),I=1,66) /                                           X11L0140
     2 .246, .221, .197, .173, .112, .051, .0  , .0  , .0  , .0  , .0  ,X11L0150
     3 .208, .192, .176, .160, .144, .092, .028, .0  , .0  , .0  , .0  ,X11L0160
     4 .173, .163, .154, .143, .133, .123, .079, .032, .0  , .0  , .0  ,X11L0170
     5 .141, .137, .132, .128, .123, .117, .113, .075, .034, .0  , .0  ,X11L0180
     6 .084, .120, .118, .117, .116, .114, .113, .111, .073, .034, .0  ,X11L0190
     7 .037, .074, .111, .111, .111, .111, .111, .111, .111, .074, .037/X11L0200
      DATA (W3A9(I),I=1,50) /                                           X11L0210
     2 .246, .221, .197, .173, .112, .051, .0  , .0  , .0  , .0  ,      X11L0220
     3 .208, .192, .176, .160, .144, .092, .028, .0  , .0  , .0  ,      X11L0230
     4 .173, .163, .154, .143, .133, .123, .079, .032, .0  , .0  ,      X11L0240
     5 .141, .137, .132, .128, .123, .117, .113, .075, .034, .0  ,      X11L0250
     6 .084, .120, .118, .117, .116, .114, .113, .111, .073, .034/      X11L0260
      DATA (W3B9(I),I=1,45) /                                           X11L0270
     2 .246, .221, .197, .173, .112, .051, .0  , .0  , .0  ,            X11L0280
     3 .208, .192, .176, .160, .144, .092, .028, .0  , .0  ,            X11L0290
     4 .173, .163, .154, .143, .133, .123, .079, .032, .0  ,            X11L0300
     5 .141, .137, .132, .128, .123, .117, .113, .075, .034,            X11L0310
     6 .111, .111, .111, .111, .111, .111, .111, .111, .111/            X11L0320
      DATA (W3C9(I),I=1,32) /                                           X11L0330
     2 .246, .221, .197, .173, .112, .051, .0  , .0  ,                  X11L0340
     3 .208, .192, .176, .160, .144, .092, .028, .0  ,                  X11L0350
     4 .173, .163, .154, .143, .133, .123, .079, .032,                  X11L0360
     5 .125, .125, .125, .125, .125, .125, .125, .125/                  X11L0370
      DATA (W3D9(I),I=1,28) /                                           X11L0380
     2 .246, .221, .197, .173, .112, .051, .0  ,                        X11L0390
     3 .208, .192, .176, .160, .144, .092, .028,                        X11L0400
     4 .143, .143, .143, .143, .143, .143, .143,                        X11L0410
     5 .143, .143, .143, .143, .143, .143, .143/                        X11L0420
      DATA (W3E9(I),I=1,18)/                                            X11L0430
     2 .246, .221, .197, .173, .112, .051,                              X11L0440
     3 .167, .167, .167, .167, .167, .167,                              X11L0450
     4 .167, .167, .167, .167, .167, .167/                              X11L0460
C --- WEIGHTS FOR 3X5 MOVING AVERAGE.                                   X11L0470
      DATA (W3X5(I),I=1,28) /                                           X11L0480
     2 .283, .283, .283, .150, .0  , .0  , .0  ,                        X11L0490
     3 .250, .250, .250, .183, .067, .0  , .0  ,                        X11L0500
     4 .150, .217, .217, .217, .133, .067, .0  ,                        X11L0510
     5 .067, .133, .200, .200, .200, .133, .067/                        X11L0520
      DATA (W3A5(I),I=1,18) /                                           X11L0530
     2 .283, .283, .283, .150, .0  , .0  ,                              X11L0540
     3 .250, .250, .250, .183, .067, .0  ,                              X11L0550
     4 .150, .217, .217, .217, .133, .067/                              X11L0560
      DATA (W3B5(I),I=1,15)/                                            X11L0570
     2 .283, .283, .283, .150, .0  ,                                    X11L0580
     3 .250, .250, .250, .183, .067,                                    X11L0590
     4 .200, .200, .200, .200, .200/                                    X11L0600
      DATA (W3C5(I),I=1,8)/                                             X11L0610
     2 .283, .283, .283, .150,                                          X11L0620
     3 .250, .250, .250, .250/                                          X11L0630
C --- WEIGHTS FOR 3X3 MOVING AVERAGE.                                   X11L0640
      DATA (W3X3(I),I=1,15) /                                           X11L0650
     2 .407, .407, .185, .0  , .0  ,                                    X11L0660
     3 .259, .370, .259, .111, .0  ,                                    X11L0670
     4 .111, .222, .333, .222, .111/                                    X11L0680
      DATA (W3A3(I),I=1,8 ) /                                           X11L0690
     2 .407, .407, .185, .0  ,                                          X11L0700
     3 .259, .370, .259, .111/                                          X11L0710
      DATA (W3B3(I),I=1,6)/                                             X11L0720
     2 .407, .407, .185,                                                X11L0730
     3 .333, .333, .333/                                                X11L0740
C --- WEIGHTS FOR 3-TERM MOVING AVERAGE.                                X11L0750
      DATA (W3X1(I),I=1,6) /                                            X11L0760
     2 .610, .390, .0  ,                                                X11L0770
     3 .333, .333, .333/                                                X11L0780
      MFDA = LFDA                                                       X11L0790
      MLDA = LLDA                                                       X11L0800
      KFDA = MFDA + 11                                                  X11L0810
C --- FOR EACH MONTH SEPARATELY.                                        X11L0820
      DO 291 J = MFDA,KFDA                                              X11L0830
      M = J-(J-1)/12*12                                                 X11L0840
      K = 3                                                             X11L0850
C --- MOVE MONTH TO *STSP*.                                             X11L0860
      DO 260 I = J,MLDA,12                                              X11L0870
      K = K + 1                                                         X11L0880
  260 STSP(K) = STSI(I)                                                 X11L0890
      IF (KPART-3) 256,401,256                                          X11L0900
  401 IF (KSECT-2) 256,402,256                                          X11L0910
C --- COMPUTE IBAR,SBAR,AND RATIO IN FINAL ROUND ONLY.                  X11L0920
C --- COMPUTE 7-TERM MOVING AVERAGE FOR ESTIMATE OF S.                  X11L0930
  402 DO 20 I = 1,3                                                     X11L0940
      STSP(I) =(STSP(4)+STSP(5)+STSP(6))/3.                             X11L0950
      KI = K + I                                                        X11L0960
   20 STSP(KI)  = (STSP(K)+STSP(K-1)+STSP(K-2))/3.                      X11L0970
      DO 21 I = 4,K                                                     X11L0980
   21 STAVG(I) = (STSP(I-3)+STSP(I-2)+STSP(I-1)+STSP(I)+STSP(I+1)+      X11L0990
     1STSP(I+2)+STSP(I+3))/7.                                           X11L1000
C --- COMPUTE SBAR.                                                     X11L1010
   30 RATI(M+12) = 0.                                                   X11L1020
      DO 242 I = 5,K                                                    X11L1030
      IF (MULADD) 241,261,241                                           X11L1040
  241 RATI(M+12) = RATI(M+12) + ABS(STAVG(I-1)-STAVG(I))                X11L1050
      GO TO 242                                                         X11L1060
  261 RATI(M+12)=RATI(M+12)+ABS(STAVG(I-1)-STAVG(I))/STAVG(I)*100.      X11L1070
  242 CONTINUE                                                          X11L1080
      P = K-4                                                           X11L1090
      RATI(M+12) = RATI(M+12)/P                                         X11L1100
C --- DIVIDE SI/S FOR ESTIMATE OF I                                     X11L1110
      CALL ADDMUL (STAVG,STSP,STAVG,4,K)                                X11L1120
C --- COMPTUE IBAR                                                      X11L1130
      RATI(M) = 0.                                                      X11L1140
      DO 244 I = 5,K                                                    X11L1150
      IF (MULADD) 243,263,243                                           X11L1160
  243 RATI(M) = RATI(M) + ABS(STAVG(I-1)-STAVG(I))                      X11L1170
      GO TO 244                                                         X11L1180
  263 RATI(M)=RATI(M)+ABS(STAVG(I-1)-STAVG(I))/STAVG(I)*100.            X11L1190
  244 CONTINUE                                                          X11L1200
      RATI(M) = RATI(M)/P                                               X11L1210
C --- COMPUTE IBAR/SBAR RATIO. LARGEST RATIO PRINTED IS 999.99.         X11L1220
      RATI(M+24) = 999.99                                               X11L1230
      IF (RATI(M)-RATI(M+12)*999.99) 255,256,256                        X11L1240
  255 RATI(M+24) = RATI(M)/RATI(M+12)                                   X11L1250
  256 NTERM = LTERM(M)                                                  X11L1260
C --- CHECK IF MOVING AVERAGE FOR THIS MONTH PRESELECTED.               X11L1270
      IF (NTERM) 267,267,264                                            X11L1280
  264 GO TO (286,283,279,272,268),NTERM                                 X11L1290
C --- STABLE SEASONAL. AVERAGE OF ALL SI RATIOS FOR THIS MONTH.         X11L1300
  268 TMP = 0.                                                          X11L1310
      DO 269 I = 4,K                                                    X11L1320
  269 TMP = TMP + STSP(I)                                               X11L1330
      SUM = K - 3                                                       X11L1340
      TMP = TMP/SUM                                                     X11L1350
      DO 270 I = 4,K                                                    X11L1360
  270 STAVG(I) = TMP                                                    X11L1370
      GO TO 290                                                         X11L1380
C --- COMPUTE 3X9 MOVING AVERAGE.                                       X11L1390
  272 IF (K-13) 273,276,275                                             X11L1400
  273 IF (K-11) 274,288,277                                             X11L1410
  274 IF (K-9) 268,231,289                                              X11L1420
  275 CALL MVAVG(STAVG,STSP,4,K,11,W3X9)                                X11L1430
      GO TO 290                                                         X11L1440
  276 CALL MVAVG(STAVG,STSP,4,K,10,W3A9)                                X11L1450
      GO TO 290                                                         X11L1460
  277 CALL MVAVG(STAVG,STSP,4,K,9,W3B9)                                 X11L1470
      GO TO 290                                                         X11L1480
  288 CALL MVAVG(STAVG,STSP,4,K,8,W3C9)                                 X11L1490
      GO TO 290                                                         X11L1500
  289 CALL MVAVG(STAVG,STSP,4,K,7,W3D9)                                 X11L1510
      GO TO 290                                                         X11L1520
  231 CALL MVAVG(STAVG,STSP,4,K,6,W3E9)                                 X11L1530
      GO TO 290                                                         X11L1540
  267 IF (KSECT-1) 279,283,279                                          X11L1550
C --- COMPUTE 3X5 MOVING AVERAGE.                                       X11L1560
  279 IF (K-9) 234,281,280                                              X11L1570
  234 IF (K-7) 268,233,232                                              X11L1580
  280 CALL MVAVG(STAVG,STSP,4,K,7,W3X5)                                 X11L1590
      GO TO 290                                                         X11L1600
  281 CALL MVAVG(STAVG,STSP,4,K,6,W3A5)                                 X11L1610
      GO TO 290                                                         X11L1620
  232 CALL MVAVG(STAVG,STSP,4,K,5,W3B5)                                 X11L1630
      GO TO 290                                                         X11L1640
  233 CALL MVAVG(STAVG,STSP,4,K,4,W3C5)                                 X11L1650
      GO TO 290                                                         X11L1660
C --- COMPUTE 3X3 MOVING AVERAGE.                                       X11L1670
  283 IF (K-7) 235,285,284                                              X11L1680
  235 IF (K-5) 268,268,236                                              X11L1690
  284 CALL MVAVG(STAVG,STSP,4,K,5,W3X3)                                 X11L1700
      GO TO 290                                                         X11L1710
  285 CALL MVAVG(STAVG,STSP,4,K,4,W3A3)                                 X11L1720
      GO TO 290                                                         X11L1730
  236 CALL MVAVG(STAVG,STSP,4,K,3,W3B3)                                 X11L1740
      GO TO 290                                                         X11L1750
C --- COMPUTE 3-TERM MOVING AVERAGE                                     X11L1760
  286 CALL MVAVG(STAVG,STSP,4,K,3,W3X1)                                 X11L1770
  290 L = J                                                             X11L1780
      DO 291 I = 4,K                                                    X11L1790
      STMP(L) = STAVG(I)                                                X11L1800
  291 L = L + 12                                                        X11L1810
C --- COMPUTE CENTERED 12-TERM MOVING AVERAGE.                          X11L1820
      J = MFDA + 6                                                      X11L1830
      K = MLDA - 6                                                      X11L1840
      DO 300 I = J,K                                                    X11L1850
  300 STS(I)=(STMP(I-6)+STMP(I+6)+2.*(STMP(I-5)+STMP(I-4)+STMP(I-3)+    X11L1860
     1STMP(I-2)+STMP(I-1)+STMP(I)+STMP(I+1)+STMP(I+2)+STMP(I+3)+        X11L1870
     2STMP(I+4)+STMP(I+5)))/24.                                         X11L1880
C --- FILL IN MISSING END TERMS BY REPEATING FIRST AND LAST AVAILABLE   X11L1890
C --- MOVING AVERAGE VALUES 6 TIMES.                                    X11L1900
      K = MFDA                                                          X11L1910
      L = MLDA                                                          X11L1920
      DO 303 I = 1,6                                                    X11L1930
      STS(K) = STS(MFDA+6)                                              X11L1940
      STS(L) = STS(MLDA-6)                                              X11L1950
      K = K + 1                                                         X11L1960
  303 L = L - 1                                                         X11L1970
C --- DIVIDE SEASONALS BY 12-TERM MOVING AVERAGE.                       X11L1980
      CALL ADDMUL (STS,STMP,STS,MFDA,MLDA)                              X11L1990
      RETURN                                                            X11L2000
      END                                                               X11L2010
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
C --- VARIABLE TREND-CYCLE ROUTINE.                                     X11M0020
      SUBROUTINE VTC (LFDA,LLDA,KTCOPT)                                 X11M0030
      COMMON/CA/NW,STI(600)                                             X11M0040
      COMMON/CB/RATIC,NTERM,STC(360),STCI(360)                          X11M0050
      COMMON/CJ/MULADD                                                  X11M0060
      DIMENSION W9H(45),W13H(91),W23H(276)                              X11M0070
C --- 9-TERM HENDERSON WEIGHTS.                                         X11M0080
      DATA (W9H(I),I=1,45) /                                            X11M0090
     1 .581, .424, .185,-.034,-.156, .0  , .0  , .0  , .0  ,            X11M0100
     2 .298, .354, .282, .126,-.011,-.049, .0  , .0  , .0  ,            X11M0110
     3 .086, .242, .315, .259, .120, .0  ,-.022, .0  , .0  ,            X11M0120
     4-.029, .102, .255, .324, .263, .120,-.004,-.031, .0  ,            X11M0130
     5-.041,-.010, .119, .267, .330, .267, .119,-.010,-.041/            X11M0140
C --- 13-TERM HENDERSON WEIGHTS.                                        X11M0150
      DATA (W13H(I),I=1,91) /                                           X11M0160
     1 .421, .353, .244, .120, .012,-.058,-.092,.0,.0,.0,.0,.0,.0,      X11M0170
     2 .279, .292, .254, .174, .080, .002,-.038,-.043,.0,.0,.0,.0,.0,   X11M0180
     3 .148, .216, .241, .216, .149, .068, .003,-.025,-.016,.0,.0,.0,.0,X11M0190
     4 .046, .131, .201, .230, .208, .145, .066, .004,-.022,-.009,.0,.0,X11M0200
     4 .0  ,                                                            X11M0210
     5-.018, .050, .136, .205, .235, .210, .145, .067, .003,-.022,-.011,X11M0220
     6 .0  , .0  ,                                                      X11M0230
     7-.034,-.006, .061, .144, .212, .238, .213, .147, .066, .001,-.025,X11M0240
     8-.017, .0  ,                                                      X11M0250
     9-.019,-.028, .0  , .066, .147, .214, .240, .214, .147, .066, .0  ,X11M0260
     1-.028,-.019/                                                      X11M0270
C --- 23-TERM HENDERSON WEIGHTS.                                        X11M0280
      DATA (W23H(I),I=1,69)/                                            X11M0290
     1 .288, .263, .227, .182, .133, .084, .039, .002,-.028,-.049,-.064,X11M0300
     2-.077, .0  , .0  , .0  , .0  , .0  , .0  , .0  , .0  , .0 ,.0,.0, X11M0310
     3 .224, .219, .203, .176, .141, .101, .061, .025,-.004,-.024,-.035,X11M0320
     4-.041,-.046, .0  , .0  , .0  , .0  , .0  , .0  , .0  , .0  ,.0,.0,X11M0330
     5 .166, .176, .177, .166, .146, .116, .082, .049, .018,-.005,-.019,X11M0340
     6-.025,-.025,-.022, .0  , .0  , .0  , .0  , .0  , .0  , .0  ,.0,.0/X11M0350
      DATA (W23H(I), I=70,138)/                                         X11M0360
     7 .112, .134, .150, .154, .147, .129, .103, .073, .042, .015,-.004,X11M0370
     8-.015,-.018,-.014,-.008, .0  , .0  , .0  , .0  , .0  , .0  ,.0,.0,X11M0380
     9 .066, .095, .119, .136, .142, .137, .121, .098, .068, .040, .015,X11M0390
     1-.003,-.012,-.013,-.008,-.001, .0  , .0  , .0  , .0  , .0  ,.0,.0,X11M0400
     2 .027, .059, .088, .114, .131, .139, .134, .119, .095, .067, .039,X11M0410
     3 .015,-.002,-.011,-.011,-.006, .003, .0  , .0  , .0  , .0  ,.0,.0/X11M0420
      DATA (W23H(I),I=139,207)/                                         X11M0430
     4 .001, .027, .059, .089, .114, .132, .138, .134, .118, .096, .068,X11M0440
     5 .039, .015,-.003,-.011,-.012,-.006, .002, .0  , .0  , .0  ,.0,.0,X11M0450
     6-.015, .005, .031, .060, .090, .116, .133, .140, .135, .120, .096,X11M0460
     7 .068, .039, .015,-.003,-.011,-.013,-.007, .001, .0  , .0  ,.0,.0,X11M0470
     8-.021,-.010, .008, .034, .064, .094, .118, .136, .140, .137, .120,X11M0480
     9 .097, .068, .039, .014,-.003,-.013,-.013,-.007,-.002, .0  ,.0,.0/X11M0490
      DATA (W23H(I),I=208,276)/                                         X11M0500
     1-.019,-.017,-.007, .011, .037, .067, .095, .120, .137, .143, .138,X11M0510
     2 .122, .097, .069, .040, .014,-.005,-.014,-.015,-.010,-.003,.0,.0,X11M0520
     3-.011,-.016,-.015,-.005, .013, .039, .068, .097, .122, .138, .144,X11M0530
     4 .138, .122, .097, .068, .039, .013,-.005,-.015,-.016,-.011,-.004,X11M0540
     5 .0  ,                                                            X11M0550
     6-.004,-.011,-.016,-.015,-.005, .013, .039, .068, .097, .122, .138,X11M0560
     7 .148, .138, .122, .097, .068, .039, .013,-.005,-.015,-.016,-.011,X11M0570
     8-.004/                                                            X11M0580
C --- CALCULATE 13-TERM HENDERSON. DROP END TERMS. CALC  IRREGULAR SER. X11M0590
 4000 MFDA = LFDA + 6                                                   X11M0600
      MLDA = LLDA - 6                                                   X11M0610
      DO 1 I = MFDA,MLDA                                                X11M0620
    1 STC(I) = .240057*STCI(I) + .214337*(STCI(I+1)+STCI(I-1)) +        X11M0630
     1.147357*(STCI(I+2)+ STCI(I-2)) +.065492*(STCI(I+3)+STCI(I-3)) -   X11M0640
     2.027864*(STCI(I+5)+ STCI(I-5)) -.019350*(STCI(I+6)+STCI(I-6))     X11M0650
      CALL ADDMUL (STI,STCI,STC,MFDA,MLDA)                              X11M0660
C --- CALCULATE IBAR/CBAR RATIO                                         X11M0670
      APCC = 0.                                                         X11M0680
      APCI = 0.                                                         X11M0690
      K = MLDA - 1                                                      X11M0700
      DO 4 I = MFDA,K                                                   X11M0710
      IF (MULADD) 2,3,2                                                 X11M0720
    2 APCC = APCC + ABS(STC(I+1)-STC(I))                                X11M0730
      APCI = APCI + ABS(STI(I+1)-STI(I))                                X11M0740
      GO TO 4                                                           X11M0750
    3 APCC = APCC + ABS(STC(I+1)-STC(I))/STC(I)                         X11M0760
      APCI = APCI + ABS(STI(I+1)-STI(I))/STI(I)                         X11M0770
    4 CONTINUE                                                          X11M0780
      RATIC = APCI/APCC                                                 X11M0790
C --- CHECK IF TREND-CYCLE MOVING AVERAGE PRESELECTED.                  X11M0800
      IF (KTCOPT-3) 7,23,6                                              X11M0810
    7 IF (KTCOPT-1) 6,9,13                                              X11M0820
    6 IF (RATIC-.995) 9,22,22                                           X11M0830
   22 IF (NTERM-999) 5,13,5                                             X11M0840
    5 IF (RATIC-3.495) 13,23,23                                         X11M0850
    9 NTERM = 9                                                         X11M0860
      CALL MVAVG (STC,STCI,LFDA,LLDA,9,W9H)                             X11M0870
      RETURN                                                            X11M0880
   13 NTERM = 13                                                        X11M0890
      CALL MVAVG (STC,STCI,LFDA,LLDA,13,W13H)                           X11M0900
      RETURN                                                            X11M0910
   23 NTERM = 23                                                        X11M0920
      CALL MVAVG (STC,STCI,LFDA,LLDA,23,W23H)                           X11M0930
      RETURN                                                            X11M0940
      END                                                               X11M0950
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
C --- THIS ROUTINE COMPUTES WEIGHTS FOR IRREGULAR COMPONENT AND IDENTIF X11N0020
C --- IES EXTREME IRREGULAR VALUES.                                     X11N0030
      SUBROUTINE XTRM (ARRAY,STDEV,STWT,KFDA,KLDA,TMPU,TMPL,KEXT)       X11N0040
      COMMON/CJ/MULADD                                                  X11N0050
      DIMENSION ARRAY(600),STDEV(600),STWT(600)                         X11N0060
      SK = 100                                                          X11N0070
      IF (MULADD) 298,299,298                                           X11N0080
  298 SK = 0                                                            X11N0090
C --- SET ALL WEIGHTS EQUAL TO 100. TO START.                           X11N0100
  299 DO 300 I = KFDA,KLDA                                              X11N0110
  300 STWT(I) = 100.0                                                   X11N0120
C --- IN FIRST ROUND, IDENTIFY EXTREMES OUTSIDE UPPER LIMIT FOR         X11N0130
C --- EXCLUSION FROM SECOND ROUND.                                      X11N0140
      SIGMU = TMPU                                                      X11N0150
      SIGML = TMPU                                                      X11N0160
C --- DETERMINE IF AT LEAST 5 YEARS AVAILABLE FOR MOVING STANDARD DEVTN X11N0170
      NFDA = (KFDA+10)/12 * 12 + 1                                      X11N0180
      NLDA = KLDA/12 * 12 - 59                                          X11N0190
      ITMP = 59                                                         X11N0200
      IF (NLDA-NFDA) 318,301,301                                        X11N0210
C --- LESS THAN 5 YEARS AVAILABLE.                                      X11N0220
  318 ITMP = ITMP + NLDA - NFDA                                         X11N0230
      NLDA = NFDA                                                       X11N0240
  301 KSWS = 1                                                          X11N0250
C --- COMPUTE MOVING 5-YEAR STD. DEV. EXCLUDING ZERO WT. IRREGULARS.    X11N0260
  314 DO 312 I = NFDA,NLDA,12                                           X11N0270
      SDEV = 0                                                          X11N0280
      K = I + ITMP                                                      X11N0290
      XN = 0.                                                           X11N0300
      DO 303 M = I,K                                                    X11N0310
      IF (STWT(M)) 302,303,302                                          X11N0320
  302 SDEV = SDEV + (ARRAY(M)-SK)**2                                    X11N0330
      XN = XN + 1.                                                      X11N0340
  303 CONTINUE                                                          X11N0350
      SDEV = SQRT(SDEV/XN)                                              X11N0360
      IF (NLDA-NFDA) 320,320,319                                        X11N0370
  320 J = KFDA                                                          X11N0380
      K = KLDA                                                          X11N0390
      GO TO 308                                                         X11N0400
C --- APPLY TO CENTRAL YEAR. AT ENDS OF SERIES APPLY TO ALL VALUES UP T X11N0410
C --- TO CENTRAL YEAR.                                                  X11N0420
  319 IF (I-NFDA) 304,305,304                                           X11N0430
  304 IF (I-NLDA) 307,306,307                                           X11N0440
  305 J = KFDA                                                          X11N0450
      K = NFDA + 35                                                     X11N0460
      GO TO 308                                                         X11N0470
  306 J = NLDA + 24                                                     X11N0480
      K = KLDA                                                          X11N0490
      GO TO 308                                                         X11N0500
  307 J = I + 24                                                        X11N0510
      K = I + 35                                                        X11N0520
C --- COMPUTE DEVIATION OF EACH IRREGULAR VALUE.                        X11N0530
  308 DO 312 M = J,K                                                    X11N0540
      STDEV(M) = SDEV                                                   X11N0550
      TEMP = (ABS(ARRAY(M)-SK))/SDEV                                    X11N0560
      IF (TEMP-SIGMU) 309,310,310                                       X11N0570
  309 IF (TEMP-SIGML) 312,312,311                                       X11N0580
C --- ASSIGN ZERO WT. IF OUTSIDE UPPER LIMIT.                           X11N0590
  310 STWT(M) = 0                                                       X11N0600
      KEXT = KEXT + 1                                                   X11N0610
      GO TO 312                                                         X11N0620
C --- GRADUATE IF BETWEEN LIMITS.                                       X11N0630
  311 STWT(M) = (SIGMU-TEMP)*100./(SIGMU-SIGML)                         X11N0640
  312 CONTINUE                                                          X11N0650
      GO TO (313, 315), KSWS                                            X11N0660
C --- START SECOND ROUND.                                               X11N0670
  313 KSWS = 2                                                          X11N0680
      KEXT = 0                                                          X11N0690
      SIGML = TMPL                                                      X11N0700
      GO TO 314                                                         X11N0710
C --- STORE STD.DEVS. FOR PRINTING ON TABLE OF WEIGHTS.                 X11N0720
  315 J = 1                                                             X11N0730
      DO 316 I = KFDA, KLDA, 12                                         X11N0740
      STDEV(J) = STDEV(I)                                               X11N0750
      STDEV(J+1) = STDEV(I)                                             X11N0760
  316 J = J + 1                                                         X11N0770
  317 RETURN                                                            X11N0780
      END                                                               X11N0790
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
T AUG 1965   U. S. TOTAL RETAIL SALES IN MILLIONS OF DOLLARS                    
01290301219801371101411501452001444201425001404501395201481901382801631453  P204
01221301194801357601402501411601453301425901377101401201453801440101773854  P204
01314701264201460901545001533301560001526101548101576501568501575101912455  P204
01372701355101552701507401610901657901538201618701558201613001649301938056  P204
01474101405801594501628501720501711401686401749001637301694901713301984457  P204
01528601378301546401636201736401660301659601700001632601736001703902117458  P204
01622501496101696701782101860001870801833201805401757001909501763502145459  P204
01631201582901763201897301854801891801806601815301784801864801838502215360  P204
01580301507101771401761801853201890701792201832501815801876101922402288161  P204
01700701604201919301909702022602025401913801992001886302057602091102412762  P204
01826101708701965302051802122802073702054002101801926702152802149402510463  P204
01915401875802050202118602250802224202214502177802131302260502172002771964  P204
Z                                                                               
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
C --- QUARTERLY SEASONAL ADJUSTMENT PROGRAM                             X1QA0020
C     U.S. CENSUS BUREAU                                                X1QA0030
C     ECONOMIC RESEARCH AND ANALYSIS DIVISION                           X1QA0040
C     WRITTEN BY NORMAN BAKKA                                           X1QA0050
C                                                                       X1QA0060
C --- FEBRUARY 1, 1968                                                  X1QA0070
C --- INPUT ROUTINE                                                     X1QA0080
C  (1)READS AND EDITS HEADER CARD                                       X1QA0090
C  (2)READS AND EDITS INPUT SERIES                                      X1QA0100
C  (3)CALLS QSAP, WHICH IS THE MAIN SEASONAL ADJUSTMENT PROGRAM         X1QA0110
      INTEGER ADD                                                       X1QA0120
      REAL MADJ(3)                                                      X1QA0130
      DIMENSION XORG(125), AADJ(3), ADJ(3), SUMM(4), SEAS(4),           X1QA0140
     1          PRNT(3), RUN(4), PB7(2), QUAR(4)                        X1QA0150
      COMMON /TADJ/ ADD                                                 X1QA0160
      COMMON /RITE/ NR,NYEAR,TITLE(10),SERNO,KPAGE                      X1QA0170
      COMMON /INPT/ XORG,IB,IE,MEAS,KB7,MLG,JDEC,KP,NP                  X1QA0180
      COMMON /SIGM/ SIGML, SIGMU, SD5(125)                              X1QA0190
      DATA NEWPG /6H^^^^^^/                                             X1QA0200
      DATA HS,ZS /1HH, 1HZ/                                             X1QA0210
      DATA (MADJ(I),I=1,3) /6HMULTIP, 6HLICATI, 2HVE/                   X1QA0220
      DATA (AADJ(I),I=1,3) /1H , 6HADDITI, 2HVE/                        X1QA0230
      DATA (SUMM(I),I=1,4) /6HSUMMAR, 6HY MEAS, 4HURES, 1H /            X1QA0240
      DATA (SEAS(I),I=1,4) /6HSEASON, 6HAL ADJ, 6HUSTMEN, 1HT /         X1QA0250
      DATA (PRNT(I),I=1,3) /6HSTNDRD, 6H  LONG, 6H  FULL/               X1QA0260
      DATA (PB7(I),I=1,2) /3HOUT, 1H /                                  X1QA0270
      DATA (QUAR(I),I=1,4) /3H1ST, 3H2ND, 3H3RD, 3H4TH/                 X1QA0280
C --- ASSIGNMENT OF INPUT/OUTPUT VARIABLES(UNITS)                       X1QA0290
      IR = 1                                                            X1QA0300
      JO = 6                                                            X1QA0310
      NR = 10                                                           X1QA0320
      LR = 11                                                           X1QA0330
      RECORD = 0.0                                                      X1QA0340
  200 KERR = 1                                                          X1QA0350
C --- READ HEADER CARD                                                  X1QA0360
  201 READ (IR,1) CARD,SERNO,MQ,MYR,NQ,NYR,ADD,MEAS,NP,SIGML,SIGMU,KB7, X1QA0370
     1      (TITLE(I),I=1,10)                                           X1QA0380
    1 FORMAT (A1,A6, 2(I1,I2), 3I1, 2F2.1, I1, 9A6,A5)                  X1QA0390
C     FIRST COLUMN MUST HAVE 'H' PUNCH,  A 'Z' PUNCH INDICATES LAST CARDX1QA0400
C           AND THUS END OF JOB                                         X1QA0410
      IF (CARD-HS) 10,11,10                                             X1QA0420
   10 IF (CARD-ZS) 101,999,101                                          X1QA0430
C --- END OF JOB                                                        X1QA0440
  999 WRITE (NR,1000) NEWPG                                             X1QA0450
 1000 FORMAT (A1,11HEND OF REEL)                                        X1QA0460
      WRITE (JO,1001)                                                   X1QA0470
 1001 FORMAT (12HOEND OF REEL)                                          X1QA0480
      REWIND NR                                                         X1QA0490
      REWIND IR                                                         X1QA0500
      STOP                                                              X1QA0510
C --- EDIT OF OPTION CARD                                               X1QA0520
   11 KERR = 1                                                          X1QA0530
      IF (MQ) 102,102,12                                                X1QA0540
   12 IF (MQ-5) 13,102,102                                              X1QA0550
   13 IF (NQ) 103,103,14                                                X1QA0560
   14 IF (NQ-5) 15,103,103                                              X1QA0570
   15 IF (NYR-MYR) 104,104,16                                           X1QA0580
   16 IB = MQ                                                           X1QA0590
      IE = (NYR-MYR)*4 + NQ                                             X1QA0600
      IF (IE-IB-11) 105,17,17                                           X1QA0610
   17 IF (ADD-2) 18,106,106                                             X1QA0620
   18 IF (MEAS-2)19,107,107                                             X1QA0630
   19 IF (NP-3)20,108,108                                               X1QA0640
   20 IF (SIGMU-SIGML) 109,21,21                                        X1QA0650
   21 IF (KB7-2) 30,110,110                                             X1QA0660
C --- STANDARD MULTIPLICATIVE SEASONAL ADJUSTMENT RUN                   X1QA0670
   30 IF (SIGMU) 109,31,32                                              X1QA0680
   31 SIGML = 1.5                                                       X1QA0690
      SIGMU = 2.5                                                       X1QA0700
   32 DO 33 I=1,4                                                       X1QA0710
   33 RUN(I) = SEAS(I)                                                  X1QA0720
      DO 34 I=1,3                                                       X1QA0730
   34 ADJ(I) = MADJ(I)                                                  X1QA0740
      KPAGE = 0                                                         X1QA0750
      MLG =  2                                                          X1QA0760
      JDEC = 2                                                          X1QA0770
      KP = NP + 1                                                       X1QA0780
      MEAS = MEAS + 1                                                   X1QA0790
      KB7 = KB7 + 1                                                     X1QA0800
C --- SUMMARY MEASURES RUN                                              X1QA0810
      IF (MEAS-1) 45,45,40                                              X1QA0820
   40 DO 41 I=1,4                                                       X1QA0830
   41 RUN(I)  = SUMM(I)                                                 X1QA0840
C --- ADDITIVE RUN                                                      X1QA0850
   45 IF (ADD) 50,50,46                                                 X1QA0860
   46 DO 47 I=1,3                                                       X1QA0870
   47 ADJ(I) = AADJ(I)                                                  X1QA0880
      JDEC = 1                                                          X1QA0890
      MLG = 1                                                           X1QA0900
C --- SET M AND N TO READ FIRST DATA CARD                               X1QA0910
   50 NYEAR = MYR                                                       X1QA0920
      M = 1                                                             X1QA0930
      N = 4                                                             X1QA0940
C --- READ INPUT SERIES                                                 X1QA0950
C     INPUT IS EDITED FOR DATE SEQUENCE AND CONSISTENT SERIES NUMBERING X1QA0960
   52 READ (IR,2) (XORG(I),I=M,N),KYR,SERIE                             X1QA0970
    2 FORMAT (4(12X, F6.0), I2, A6)                                     X1QA0980
C --- EDIT FOR CORRECT SERIES IDENTIFICATION (COLS 75-80)               X1QA0990
      IF (SERNO-SERIE) 120,55,120                                       X1QA1000
C --- FIELDS PRECEEDING QUARTER SPECIFIED AS FIRST MUST BE BLANK        X1QA1010
   55 IF (N-1) 56,56,59                                                 X1QA1020
   56 IF (IB-2) 59,57,57                                                X1QA1030
   57 K = IB-1                                                          X1QA1040
      DO 58 I=1,K                                                       X1QA1050
      IF (XORG(I)) 121,58,121                                           X1QA1060
   58 CONTINUE                                                          X1QA1070
C --- EDIT FOR DATE SEQUENCE (COLS 73-74)                               X1QA1080
   59 IF (KYR-MYR) 122,60,122                                           X1QA1090
C --- TEST FOR LAST CARD OF SERIES                                      X1QA1100
   60 IF (MYR-NYR) 61,65,61                                             X1QA1110
C --- SET M,N, AND MYR TO READ NEXT CARD                                X1QA1120
   61 MYR = MYR + 1                                                     X1QA1130
      M = M + 4                                                         X1QA1140
      N = N + 4                                                         X1QA1150
      GO TO 52                                                          X1QA1160
C --- FIELDS AFTER QUARTER SPECIFIED AS LAST MUST BE BLANK              X1QA1170
   65 IF (NQ-4) 66,70,70                                                X1QA1180
   66 J = IE + 1                                                        X1QA1190
      K = (NYR-NYEAR+1) *4                                              X1QA1200
      DO 67 I=J,K                                                       X1QA1210
      IF (XORG(I)) 123,67,123                                           X1QA1220
   67 CONTINUE                                                          X1QA1230
C --- IF MULTIPLICATIVE ADJUSTMENT - EDIT SERIES FOR ZERO               X1QA1240
C        OR NEGATIVE DATA                                               X1QA1250
   70 IF (ADD) 71,71,73                                                 X1QA1260
   71 DO 72 I=IB,IE                                                     X1QA1270
      IF (XORG(I)) 124,124,72                                           X1QA1280
   72 CONTINUE                                                          X1QA1290
C --- WRITE TITLE PAGE                                                  X1QA1300
   73 WRITE (NR,3) NEWPG, (TITLE(I),I=1,10), SERNO, QUAR(MQ), NYEAR,    X1QA1310
     1             QUAR(NQ), NYR, (ADJ(I),I=1,3), (RUN(I),I=1,4),       X1QA1320
     2             PRNT(KP), SIGML, SIGMU, PB7(KB7)                     X1QA1330
    3 FORMAT (A1, 42X, 37HQUARTERLY SEASONAL ADJUSTMENT PROGRAM /       X1QA1340
     1            49X, 25HU.S. BUREAU OF THE CENSUS /                   X1QA1350
     2            42X, 39HECONOMIC RESEARCH AND ANALYSIS DIVISION /     X1QA1360
     3            53X, 17HFEBRUARY 1, 1968 ///                          X1QA1370
     4 10X,14HSERIES TITLE- , 10A6, 10X, 11HSERIES NO.  ,A6 /           X1QA1380
     5 37X,16HPERIOD COVERED- ,A3,8H QUAR,19,I2,4H TO ,A3,8H QUAR,19,I2/X1QA1390
     6 36X,14HTYPE OF RUN - ,2A6,A2,1X,4A6 /                            X1QA1400
     7 52X, A6, 9H PRINTOUT / 31X, 47HSIGMA LIMITS FOR GRADUATING EXTREMX1QA1410
     8E VALUES ARE ,F3.1,5H AND , F3.1 /                                X1QA1420
     9 31X, 35HB7. TREND-CYCLE CURVE COMPUTED WITH, A3, 26H MODIFICATIONX1QA1430
     1 FOR EXTREMES)                                                    X1QA1440
C --- IF SERIES IS REJECTED, WRITE FACT ON TITLE PAGE                   X1QA1450
      GO TO (76,75),KERR                                                X1QA1460
   75 WRITE (NR,4)                                                      X1QA1470
    4 FORMAT (////// 40X,25HSERIES REJECTED - SEE LOG)                  X1QA1480
      GO TO 200                                                         X1QA1490
C --- WRITE LOG ENTRY - ONLY IF SERIES WAS NOT REJECTED                 X1QA1500
   76 WRITE (JO,5) SERNO, (ADJ(I),I=1,3), (RUN(I),I=1,4), PRNT(KP)      X1QA1510
    5 FORMAT (1X,A6,12X,2A6,A2,1X,4A6,5X,A6,9H PRINTOUT)                X1QA1520
C                                                                       X1QA1530
C --- CALL SEASONAL ADJUSTMENT ROUTINE                                  X1QA1540
C                                                                       X1QA1550
      CALL QSAP                                                         X1QA1560
C ---                                                                   X1QA1570
      IF (NP-1) 81,82,83                                                X1QA1580
   81 RECORD = RECORD + 1.0                                             X1QA1590
      GO TO 84                                                          X1QA1600
   82 RECORD = RECORD + 1.5                                             X1QA1610
      GO TO 84                                                          X1QA1620
   83 RECORD = RECORD + 2.5                                             X1QA1630
   84 IF (RECORD - 35.0) 200,90,90                                      X1QA1640
C --- ALTERNATE OUTPUT SERVOS                                           X1QA1650
   90 WRITE (NR,1000) NEWPG                                             X1QA1660
      WRITE (JO,1001)                                                   X1QA1670
      REWIND NR                                                         X1QA1680
      NTMP = NR                                                         X1QA1690
      NR = LR                                                           X1QA1700
      LR = NTMP                                                         X1QA1710
      RECORD = 0.0                                                      X1QA1720
      GO TO 200                                                         X1QA1730
C --- REJECT MESSAGE                                                    X1QA1740
  101 GO TO (330,201),KERR                                              X1QA1750
  330 KERR = 2                                                          X1QA1760
      WRITE (JO,301) SERNO                                              X1QA1770
  301 FORMAT ( 1X,A6,25H REJECTED, NO HEADER CARD)                      X1QA1780
      GO TO 201                                                         X1QA1790
  102 KVAR = MQ                                                         X1QA1800
      KCOL = 8                                                          X1QA1810
      KFAIL = 1                                                         X1QA1820
      GO TO 202                                                         X1QA1830
  103 KVAR = NQ                                                         X1QA1840
      KCOL = 11                                                         X1QA1850
      KFAIL = 2                                                         X1QA1860
      GO TO 202                                                         X1QA1870
  106 KVAR = ADD                                                        X1QA1880
      KCOL = 14                                                         X1QA1890
      KFAIL =3                                                          X1QA1900
      GO TO 202                                                         X1QA1910
  107 KVAR = MEAS                                                       X1QA1920
      KCOL = 15                                                         X1QA1930
      KFAIL = 4                                                         X1QA1940
      GO TO 202                                                         X1QA1950
  108 KVAR = NP                                                         X1QA1960
      KCOL = 16                                                         X1QA1970
      KFAIL = 5                                                         X1QA1980
      GO TO 202                                                         X1QA1990
  110 KVAR = KB7                                                        X1QA2000
      KCOL = 21                                                         X1QA2010
      KFAIL = 6                                                         X1QA2020
  202 KERR = 2                                                          X1QA2030
      WRITE (JO,302) SERNO, KVAR,KCOL                                   X1QA2040
  302 FORMAT ( 1X,A6, 11H REJECTED, ,I1,35H-PUNCH IS INAPPROPRIATE FOR CX1QA2050
     1OLUMN ,I2)                                                        X1QA2060
      GO TO (13,15,18,19,20,30),KFAIL                                   X1QA2070
  104 KERR = 2                                                          X1QA2080
      WRITE (JO,304) SERNO,MYR,NYR                                      X1QA2090
  304 FORMAT ( 1X,A6,10H REJECTED,,18H BEGINNING YEAR IS,I3,18H, ENDING X1QA2100
     1YEAR IS, ,I3)                                                     X1QA2110
      GO TO 17                                                          X1QA2120
  105 KERR = 2                                                          X1QA2130
      WRITE (JO,305) SERNO                                              X1QA2140
  305 FORMAT (1X,A6,61H REJECTED, SERIES DOES NOT HAVE AT LEAST 3 FULL YX1QA2150
     1EARS OF DATA)                                                     X1QA2160
      GO TO 17                                                          X1QA2170
  109 KERR = 2                                                          X1QA2180
      WRITE (JO,309) SERNO,SIGML,SIGMU                                  X1QA2190
  309 FORMAT (1X,A6,24H REJECTED, EITHER LOWER(,F3.1,11H) OR UPPER(,F3.1X1QA2200
     1, 31H) SIGMA LIMIT IS NOT ACCEPTABLE)                             X1QA2210
      GO TO 32                                                          X1QA2220
  120 KERR = 2                                                          X1QA2230
      WRITE (JO,320) SERNO,SERIE                                        X1QA2240
  320 FORMAT ( 1X,A6,11H REJECTED, ,A6,23H IS WRONG SERIES NUMBER)      X1QA2250
      GO TO 55                                                          X1QA2260
  121 KERR = 2                                                          X1QA2270
      WRITE (JO,321) SERNO                                              X1QA2280
  321 FORMAT ( 1X,A6,34H REJECTED, BEGINS IN WRONG QUARTER)             X1QA2290
      GO TO 59                                                          X1QA2300
  122 KERR = 2                                                          X1QA2310
      WRITE (JO,322) SERNO,MYR,KYR                                      X1QA2320
  322 FORMAT ( 1X,A6,25H REJECTED, YEAR SHOULD BE,I3, 8H ,BUT IS,I3)    X1QA2330
      GO TO 60                                                          X1QA2340
  123 KERR = 2                                                          X1QA2350
      WRITE (JO,323) SERNO                                              X1QA2360
  323 FORMAT ( 1X,A6,32H REJECTED, ENDS IN WRONG QUARTER)               X1QA2370
      GO TO 70                                                          X1QA2380
  124 KERR = 2                                                          X1QA2390
      WRITE (JO,324) SERNO                                              X1QA2400
  324 FORMAT ( 1X,A6,32H REJECTED, ZERO OR NEGATIVE DATA)               X1QA2410
      GO TO 73                                                          X1QA2420
      END                                                               X1QA2430
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
      SUBROUTINE QSAP                                                   X1QB0020
      INTEGER ADD                                                       X1QB0030
      REAL IBAR(4),IBAR2(4),MOBAR(4),MCIBAR(4),MIBAR(4)                 X1QB0040
      DIMENSION XORG(125), XTCSI(125), XTC(125), XSI(125), XTCI(125),   X1QB0050
     1          XTEMP(125),XMORG(125), XMTCI(125), XMI(125), XSIT(125), X1QB0060
     2          WQCD(4), RATIO(4), WTH5(15), WORD(6), XTEM(4), XTEM2(4),X1QB0070
     3          OBAR(4),CIBAR(4),CBAR(4),SBAR(4),QBAR(4),               X1QB0080
     4          OBAR2(4),CIBAR2(4),CBAR2(4),SBAR2(4),QBAR2(4),          X1QB0090
     5          SDCO(4),SDCCI(4),SDCC(4),SDCS(4),SDCQ(4),SDCI(4),       X1QB0100
     6          RIC(4),RII(4),RIS(4),RTOT(4),RATO(4)                    X1QB0110
      COMMON /TADJ/ ADD                                                 X1QB0120
      COMMON /EXTR/ XS(125),XI(125), XWT(125)                           X1QB0130
      COMMON /INPT/ XORG,IB,IE,MEAS,KB7,MLG,JDEC,KP,NP                  X1QB0140
      COMMON /RITE/ NR, NYEAR, TITLE(10), SERNO, KPAGE                  X1QB0150
      COMMON /MORE/ SFC,BPF,KPART,MCD                                   X1QB0160
      DATA W3X3,W3X5 /6H, 3X3 ,6H, 3X5 /                                X1QB0170
      DATA (WTH5(I),I=1,15) /.670,.403,-.073,.0,.0,                     X1QB0180
     1                       .257,.522,.294,-.073,.0,                   X1QB0190
     2                      -.073,.294,.558,.294,-.073/                 X1QB0200
      DATA (WQCD(I),I=1,4) /4*1.0/                                      X1QB0210
      DATA PRE,FIN,BLA /6HPRELIM,6H FINAL,1H /                          X1QB0220
      DATA (WORD(I),I=1,6) /6H PERCE, 6H DIFFE, 6HNT CHA,               X1QB0230
     1                      6HRENCE , 3HNGE, 1H /                       X1QB0240
      BPF = BLA                                                         X1QB0250
      KPART = 1                                                         X1QB0260
      DO 100 I=IB,IE                                                    X1QB0270
  100 XTCSI(I) = XORG(I)                                                X1QB0280
C --- WRITE ORIGINAL SERIES - TABLE B1                                  X1QB0290
      CALL WRIT (XORG,IB,IE,1,1,1,1)                                    X1QB0300
C --- TREND-CYCLE, CENTERED 4-TERM MOVING AVERAGE  (TABLE 2)            X1QB0310
  120 IB1 = IB + 2                                                      X1QB0320
      IE1 = IE - 2                                                      X1QB0330
      DO 121 I=IB1,IE1                                                  X1QB0340
  121 XTC(I) = (XTCSI(I-2) + XTCSI(I+2) + 2.0*(XTCSI(I-1) + XTCSI(I) +  X1QB0350
     1          XTCSI(I+1))) / 8.0                                      X1QB0360
      GO TO (130,122,122,130,130,122,130,130,122),KP                    X1QB0370
  122 CALL WRIT (XTC,IB1,IE1,2,2,1,1)                                   X1QB0380
C --- SI RATIOS -- PRELIMINARY  (TABLE 3 OR 4)                          X1QB0390
  130 SFC = W3X3                                                        X1QB0400
      JTBLE = KPART / 2 + 3                                             X1QB0410
      CALL DIVSUB (XTCSI,XTC,XSI,IB1,IE1)                               X1QB0420
      GO TO (132,132,131,132,132,131,132,132,131),KP                    X1QB0430
  131 CALL WRIT (XSI,IB1,IE1,3,JTBLE,JDEC,JDEC)                         X1QB0440
  132 GO TO (140,150,150),KPART                                         X1QB0450
C --- PART B - REPLACE  EXTREME SI RATIOS - TABLE B4                    X1QB0460
  140 CALL SI (XSI,IB1,IE1,XTEMP,1)                                     X1QB0470
      GO TO (150,150,141),KP                                            X1QB0480
  141 CALL WRIT (XTEMP,IB1,IE1,4,4,JDEC,4)                              X1QB0490
C --- SEASONAL FACTORS -- PRELIMINARY (TABLE 5)                         X1QB0500
  150 CALL QSF (XSI,XS,IB1,IE1,1)                                       X1QB0510
C        FILL IN MISSING TERMS                                          X1QB0520
      XS(IB) = XS(IB+4)                                                 X1QB0530
      XS(IB+1) = XS(IB+5)                                               X1QB0540
      XS(IE) = XS(IE-4)                                                 X1QB0550
      XS(IE-1) = XS(IE-5)                                               X1QB0560
      GO TO (152,152,151,152,152,151,152,152,151),KP                    X1QB0570
  151 CALL WRIT (XS,IB,IE,5,5,JDEC,JDEC)                                X1QB0580
C --- SEASONALLY ADJUST DATA -- PRELIMINARY  (TABLE 6)                  X1QB0590
  152 CALL DIVSUB (XTCSI,XS,XTCI,IB,IE)                                 X1QB0600
      GO TO (154,154,153,154,154,153,154,154,153),KP                    X1QB0610
  153 CALL WRIT (XTCI,IB,IE,6,6,1,1)                                    X1QB0620
C --- TREND-CYCLE CURVE - TABLE 7                                       X1QB0630
  154 CALL MOVAVE (XTCI,XTC,WTH5,IB,IE,5,2,0)                           X1QB0640
      GO TO (155,174,174),KPART                                         X1QB0650
  155 GO TO (174,156),KB7                                               X1QB0660
C --- IF KB7 = 2, MODIFY EXTREME VALUES BEFORE COMPUTING THE B-7        X1QB0670
C                 TREND-CYCLE CURVE                                     X1QB0680
C --- FIND EXTREME SEASONALLY ADJUSTED VALUES                           X1QB0690
  156 CALL DIVSUB (XTCI,XTC,XI,IB,IE)                                   X1QB0700
      CALL XTRMES (XI,IB,IE,XWT)                                        X1QB0710
C --- REPLACE EXTREME VALUES                                            X1QB0720
      DO 169 I=IB,IE                                                    X1QB0730
      IF (XWT(I) - 1.0) 160,169,169                                     X1QB0740
  160 SUM = XTCI(I) * XWT(I)                                            X1QB0750
      COUNT = 0.0                                                       X1QB0760
      N = IE                                                            X1QB0770
      INC = 1                                                           X1QB0780
  161 M = I                                                             X1QB0790
  162 IF (M-N) 163,165,163                                              X1QB0800
  163 M = M + INC                                                       X1QB0810
      IF (XWT(M) - 1.0) 162,164,164                                     X1QB0820
  164 SUM = SUM + XTCI(M)                                               X1QB0830
      COUNT = COUNT + 1.0                                               X1QB0840
  165 IF (INC) 167,166,166                                              X1QB0850
  166 INC = -1                                                          X1QB0860
      N = IB                                                            X1QB0870
      GO TO 161                                                         X1QB0880
  167 XTCI(I) = SUM / (COUNT + XWT(I))                                  X1QB0890
  169 CONTINUE                                                          X1QB0900
C --- COMPUTE MOVING AVERAGE OF MODIFIED SERIES                         X1QB0910
      CALL MOVAVE (XTCI,XTC,WTH5,IB,IE,5,2,0)                           X1QB0920
  174 GO TO (176,175,175,176,175,175,176,175,175),KP                    X1QB0930
  175 CALL WRIT (XTC,IB,IE,7,7,1,1)                                     X1QB0940
C --- SI RATIOS  (TABLE 8 OR 9)                                         X1QB0950
  176 SFC = W3X5                                                        X1QB0960
      GO TO (181,185,190),KPART                                         X1QB0970
C        PART B                                                         X1QB0980
  181 CALL DIVSUB (XORG,XTC,XSI,IB,IE)                                  X1QB0990
      GO TO (183,183,182),KP                                            X1QB1000
  182 CALL WRIT (XSI,IB,IE,3,8,JDEC,JDEC)                               X1QB1010
C --- PART B - REPLACE  EXTREME SI RATIOS - TABLE B9                    X1QB1020
  183 CALL SI (XSI,IB,IE,XTEMP,2)                                       X1QB1030
      GO TO (200,200,184),KP                                            X1QB1040
  184 CALL WRIT (XTEMP,IB,IE,4,9,JDEC,4)                                X1QB1050
      GO TO 200                                                         X1QB1060
C        PART C                                                         X1QB1070
  185 CALL DIVSUB (XTCSI,XTC,XSI,IB,IE)                                 X1QB1080
      GO TO (200,200,200,200,200,186),KP                                X1QB1090
  186 CALL WRIT (XSI,IB,IE,3,9,JDEC,JDEC)                               X1QB1100
      GO TO 200                                                         X1QB1110
C        PART D                                                         X1QB1120
  190 BPF = FIN                                                         X1QB1130
C --- FINAL UNMODIFIED SI RATIOS - TABLE D8                             X1QB1140
      CALL DIVSUB (XORG,XTC,XSIT,IB,IE)                                 X1QB1150
      CALL WRIT (XSIT,IB,IE,3,8,JDEC,JDEC)                              X1QB1160
      CALL FTEST (XSIT,IB,IE,NR)                                        X1QB1170
C --- FINAL REPLACEMENT VALUES FOR EXTREME SI RATIOS - TABLE D9         X1QB1180
      CALL DIVSUB (XTCSI,XTC,XSI,IB,IE)                                 X1QB1190
      DO 193 I=IB,IE                                                    X1QB1200
      IF (XSIT(I)-XSI(I)) 192,191,192                                   X1QB1210
  191 XTEMP(I) = 9999999999.                                            X1QB1220
      GO TO 193                                                         X1QB1230
  192 XTEMP(I) = XSI(I)                                                 X1QB1240
  193 CONTINUE                                                          X1QB1250
      CALL WRIT (XTEMP,IB,IE,4,9,JDEC,JDEC)                             X1QB1260
C --- SEASONAL FACTORS  (TABLE 10)                                      X1QB1270
  200 CALL QSF (XSI,XS,IB,IE,2)                                         X1QB1280
      GO TO (530,201,201,530,201,201,201,201,201),KP                    X1QB1290
  201 CALL WRIT (XS,IB,IE,5,10,JDEC,JDEC)                               X1QB1300
      GO TO (530,530,524),KPART                                         X1QB1310
C --- SEASONAL FACTORS ONE YEAR AHEAD                                   X1QB1320
  524 J = IE - IE/4*4 + 1                                               X1QB1330
      XTEMP(J)   = (3.0* XS(IE-3) - XS(IE-7)) / 2.0                     X1QB1340
      XTEMP(J+1) = (3.0* XS(IE-2) - XS(IE-6)) / 2.0                     X1QB1350
      XTEMP(J+2) = (3.0* XS(IE-1) - XS(IE-5)) / 2.0                     X1QB1360
      XTEMP(J+3) = (3.0* XS(IE)   - XS(IE-4)) / 2.0                     X1QB1370
      IYEAR = NYEAR                                                     X1QB1380
      NYEAR = NYEAR + IE/4                                              X1QB1390
      J3 = J + 3                                                        X1QB1400
      CALL WRIT (XTEMP,J,J3,11,0,JDEC,JDEC)                             X1QB1410
      NYEAR = IYEAR                                                     X1QB1420
C --- SEASONALLY ADJUST  (TABLE 11)                                     X1QB1430
  530 CALL DIVSUB (XORG,XS,XTCI,IB,IE)                                  X1QB1440
      GO TO (242,242,230),KPART                                         X1QB1450
  230 GO TO (242,240),MEAS                                              X1QB1460
C --- IF PART D AND SUMMARY MEASURES RUN, REPLACE SEASONALLY ADJUSTED   X1QB1470
C     SERIES BY ORIGINAL SERIES                                         X1QB1480
  240 DO 241 I=IB,IE                                                    X1QB1490
  241 XTCI(I) = XORG(I)                                                 X1QB1500
  242 GO TO (2002,2002,243,2002,2002,243,243,243,243),KP                X1QB1510
  243 CALL WRIT (XTCI,IB,IE,6,11,1,1)                                   X1QB1520
      GO TO (2002,2002,255),KPART                                       X1QB1530
C --- FINAL TREND-CYCLE, TABLE D12                                      X1QB1540
C --- DIVIDE MODIFIED ORIGINAL SERIES BY FINAL SEASONAL FACTORS         X1QB1550
  255 CALL DIVSUB (XTCSI,XS,XTEMP,IB,IE)                                X1QB1560
      GO TO (259,257),MEAS                                              X1QB1570
C --- IF SUMMARY MEASURES RUN, COMPUTE MOVING AVERAGE OF                X1QB1580
C     OF MODIFIED ORIGINAL                                              X1QB1590
  257 DO 258 I=IB,IE                                                    X1QB1600
  258 XTEMP(I) = XTCSI(I)                                               X1QB1610
  259 CALL MOVAVE (XTEMP,XTC,WTH5,IB,IE,5,2,0)                          X1QB1620
      CALL WRIT (XTC,IB,IE,7,12,1,1)                                    X1QB1630
C --- IRREGULAR  (TABLE 13)                                             X1QB1640
 2002 CALL DIVSUB (XTCI,XTC,XI,IB,IE)                                   X1QB1650
      GO TO (270,261,261,261,261,261,261,261,261),KP                    X1QB1660
  261 CALL WRIT (XI,IB,IE,8,13,JDEC,3)                                  X1QB1670
      GO TO (270,270,6000),KPART                                        X1QB1680
C --- WEIGHTS FOR IRREGULAR - TABLES B17 AND C17                        X1QB1690
  270 CALL XTRMES (XI,IB,IE,XWT)                                        X1QB1700
      BPF = PRE                                                         X1QB1710
      GO TO (280,272,272,271,271,271),KP                                X1QB1720
  271 BPF = FIN                                                         X1QB1730
  272 CALL WRIT (XWT,IB,IE,9,17,JDEC,4)                                 X1QB1740
C --- MODIFY ORIGINAL SERIES BY WEIGHTS - TABLES C1 AND D1              X1QB1750
  280 DO 402 I=IB,IE                                                    X1QB1760
      XTCSI(I) = XORG(I)                                                X1QB1761
      IF (XWT(I) - 1.0) 399,402,402                                     X1QB1770
  399 IF (ADD) 400,400,401                                              X1QB1780
  400 XTCSI(I) = (XORG(I) * (1.0+XWT(I) * (XI(I)-1.0))) / XI(I)         X1QB1790
      GO TO 402                                                         X1QB1800
  401 XTCSI(I) = XORG(I) - (XI(I) * (1.0 - XWT(I)))                     X1QB1810
  402 CONTINUE                                                          X1QB1820
      KPART = KPART + 1                                                 X1QB1830
      GO TO (286,285,285,286,285,285),KP                                X1QB1840
  285 CALL WRIT (XTCSI,IB,IE,10,1,1,1)                                  X1QB1850
  286 BPF = BLA                                                         X1QB1860
      KP = KP + 3                                                       X1QB1870
      GO TO 120                                                         X1QB1880
C                                                                       X1QB1890
C --- PART E                                                            X1QB1900
C                                                                       X1QB1910
C --- MODIFY ORIGINAL,SEASONALLY ADJUSTED,AND IRREGULAR FOR EXTREMES    X1QB1920
C --- TABLES E1, E2, AND E3                                             X1QB1930
 6000 DO 636 I=IB,IE                                                    X1QB1940
      TORG = XORG(I)                                                    X1QB1950
      TSA = XTCI(I)                                                     X1QB1960
      TI = XI(I)                                                        X1QB1970
      IF (XWT(I)) 635,630,635                                           X1QB1980
  630 IF (ADD) 632,632,631                                              X1QB1990
  631 TORG = XTC(I) + XS(I)                                             X1QB2000
      TI = 0.0                                                          X1QB2010
      GO TO 633                                                         X1QB2020
  632 TORG = XTC(I) * XS(I)                                             X1QB2030
      TI = 1.0                                                          X1QB2040
  633 TSA = XTC(I)                                                      X1QB2050
      GO TO (635,634),MEAS                                              X1QB2060
  634 TORG = XTC(I)                                                     X1QB2070
  635 XMTCI(I) = TSA                                                    X1QB2080
      XMI(I) = TI                                                       X1QB2090
      XMORG(I) = TORG                                                   X1QB2100
  636 CONTINUE                                                          X1QB2110
      KPART = 4                                                         X1QB2120
      CALL WRIT (XMORG,IB,IE,1 ,1,1,1)                                  X1QB2130
      GO TO (637,638),MEAS                                              X1QB2140
  637 CALL WRIT (XMTCI,IB,IE,2 ,2,1,1)                                  X1QB2150
  638 CALL WRIT (XMI,IB,IE,3 ,3,JDEC,3)                                 X1QB2160
C --- RATIOS OF ANNUAL TOTALS - TABLE E4                                X1QB2170
      GO TO (640,2003),MEAS                                             X1QB2180
  640 CALL WRIT (XORG,IB,IE,4,4,1,1)                                    X1QB2190
      IB1 = (IB+2)/4*4 +1                                               X1QB2200
      IE1 = IE/4*4                                                      X1QB2210
      KYEAR = NYEAR + IB1/4                                             X1QB2220
      DO 644 I=IB1,IE1,4                                                X1QB2230
      IF (ADD) 641,641,642                                              X1QB2240
  641 ET1 = (XORG(I)+XORG(I+1)+XORG(I+2)+XORG(I+3)) /                   X1QB2250
     1        (XTCI(I)+XTCI(I+1)+XTCI(I+2)+XTCI(I+3))                   X1QB2260
      ET3 = (XMORG(I)+XMORG(I+1)+XMORG(I+2)+XMORG(I+3)) /               X1QB2270
     1        (XMTCI(I)+XMTCI(I+1)+XMTCI(I+2)+XMTCI(I+3))               X1QB2280
      GO TO 643                                                         X1QB2290
  642 ET1 = (XORG(I)+XORG(I+1)+XORG(I+2)+XORG(I+3)) -                   X1QB2300
     1        (XTCI(I)+XTCI(I+1)+XTCI(I+2)+XTCI(I+3))                   X1QB2310
      ET3 = (XMORG(I)+XMORG(I+1)+XMORG(I+2)+XMORG(I+3)) -               X1QB2320
     1        (XMTCI(I)+XMTCI(I+1)+XMTCI(I+2)+XMTCI(I+3))               X1QB2330
  643 WRITE (NR,25) KYEAR,ET1,ET3                                       X1QB2340
   25 FORMAT (4X,2H19,I2,15X,F7.2,29X,F7.2)                             X1QB2350
  644 KYEAR = KYEAR + 1                                                 X1QB2360
C --- CHANGES IN ORGINAL SERIES  (TABLE E5)                             X1QB2370
 2003 IB1 = IB+1                                                        X1QB2380
      IE1 = IE-1                                                        X1QB2390
      DO 651 I=IB,IE1                                                   X1QB2400
      XTEMP(I+1) = XORG(I+1) - XORG(I)                                  X1QB2410
      IF (ADD) 650,650,651                                              X1QB2420
  650 XTEMP(I+1) = XTEMP(I+1) / XORG(I)                                 X1QB2430
  651 CONTINUE                                                          X1QB2440
      CALL WRIT (XTEMP,IB1,IE,5,5,JDEC,JDEC)                            X1QB2450
      GO TO (655,660),MEAS                                              X1QB2460
C --- CHANGES IN FINAL SEASONALLY ADJUSTED SERIES  (TABLE E6)           X1QB2470
  655 DO 653 I=IB,IE1                                                   X1QB2480
      XTEMP(I+1) = XTCI(I+1) - XTCI(I)                                  X1QB2490
      IF (ADD) 652,652,653                                              X1QB2500
  652 XTEMP(I+1) = XTEMP(I+1) / XTCI(I)                                 X1QB2510
  653 CONTINUE                                                          X1QB2520
      CALL WRIT (XTEMP,IB1,IE,6,6,JDEC,JDEC)                            X1QB2530
C                                                                       X1QB2540
C --- PART F                                                            X1QB2550
C                                                                       X1QB2560
  660 KPART = 5                                                         X1QB2570
      CALL AVEC (XTCI,IB,IE,CIBAR,CIBAR2,SDCCI)                         X1QB2580
      CALL AVEDUR (XTCI,IB,IE,ADRCI)                                    X1QB2590
      CALL AVEDUR (XTC,IB,IE,ADRC)                                      X1QB2600
      CALL AVEDUR (XI,IB,IE,ADRI)                                       X1QB2610
C --- FIND QCD AND COMPUTE QCD MOVING AVERAGE                           X1QB2620
      CALL AVEC (XTC,IB,IE,CBAR,CBAR2,SDCC)                             X1QB2630
      CALL AVEC (XI,IB,IE,IBAR,IBAR2,SDCI)                              X1QB2640
      DO 500 I=1,4                                                      X1QB2650
  500 RATIO(I) = IBAR(I) / CBAR(I)                                      X1QB2660
      I = 3                                                             X1QB2670
  501 IF (RATIO(I)-.995) 502,502,505                                    X1QB2680
  502 I = I - 1                                                         X1QB2690
      IF (I) 503,503,501                                                X1QB2700
  503 MCD = 1                                                           X1QB2710
      DO 504 I=IB,IE                                                    X1QB2720
  504 XTEMP(I) = XTCI(I)                                                X1QB2730
      NT1 = IB                                                          X1QB2740
      NT2 = IE                                                          X1QB2750
      GO TO 506                                                         X1QB2760
  505 MCD = I + 1                                                       X1QB2770
      NT1 = IB + MCD/2                                                  X1QB2780
      NT2 = IE - (MCD-1)/2                                              X1QB2790
      CALL MOVAVE (XTCI,XTEMP,WQCD,IB,IE,MCD,0,0)                       X1QB2800
  506 CALL AVEDUR (XTEMP,NT1,NT2,ADRQCD)                                X1QB2810
      CALL AVEC (XTEMP,NT1,NT2,QBAR,QBAR2,SDCQ)                         X1QB2820
      CALL WRIT (XTEMP,NT1,NT2,1,1,1,1)                                 X1QB2830
C --- SUMMARY MEASURES                                                  X1QB2840
      CALL WRIT (XORG,0,0,2,2,1,1)                                      X1QB2850
      CALL AVEC (XORG,IB,IE,OBAR,OBAR2,SDCO)                            X1QB2860
      CALL AVEC (XS  ,IB,IE,SBAR,SBAR2,SDCS)                            X1QB2870
      CALL AVEC (XMORG,IB,IE,MOBAR,XTEM,XTEM2)                          X1QB2880
      CALL AVEC (XMTCI,IB,IE,MCIBAR,XTEM,XTEM2)                         X1QB2890
      CALL AVEC (XMI,IB,IE,MIBAR,XTEM,XTEM2)                            X1QB2900
      WRITE (NR,10) WORD(ADD+1),WORD(ADD+3),WORD(ADD+5)                 X1QB2910
   10 FORMAT(/7X7HAVERAGE2A6,A3,43H WITHOUT REGARD TO SIGN OVER INDICATEX1QB2920
     1D SPAN /14X4HSPAN22X20HTABLE NO. AND SYMBOL37X15HMODIFIED SERIES /X1QB2930
     215X 2HIN 9X 2HB1 8X 3HD11 7X 3HD13 7X 3HD12 7X 3HD10 7X 2HF1 18X  X1QB2940
     32HE1 8X 2HE2 8X 2HE3 / 12X 8HQUARTERS 7X 1HO 8X 2HCI 9X 1HI 9X 1HCX1QB2950
     49X 1HS 8X 3HQCD 18X 1HO 8X 2HCI 9X 1HI)                           X1QB2960
      DO 510 I=1,4                                                      X1QB2970
  510 WRITE (NR,11) I,OBAR(I),CIBAR(I),IBAR(I),CBAR(I),SBAR(I),QBAR(I), X1QB2980
     1MOBAR(I),MCIBAR(I),MIBAR(I)                                       X1QB2990
   11 FORMAT (16XI1,3X6F10.2,10X3F10.2)                                 X1QB3000
      GO TO (512,520),MEAS                                              X1QB3010
  512 DO 515 I=1,4                                                      X1QB3020
      TEMPS = CBAR(I)**2 + IBAR(I)**2 + SBAR(I)**2                      X1QB3030
      RIC(I) = CBAR(I)**2 / TEMPS * 100.                                X1QB3040
      RII(I) = IBAR(I)**2 / TEMPS * 100.                                X1QB3050
      RIS(I) = SBAR(I)**2 / TEMPS * 100.                                X1QB3060
      RTOT(I) = RIC(I) + RII(I) + RIS(I)                                X1QB3070
  515 RATO(I) = (TEMPS / OBAR(I)**2) *100.                              X1QB3080
      WRITE (NR,12) WORD(ADD+1),WORD(ADD+3),WORD(ADD+5)                 X1QB3090
   12 FORMAT(/7X39HRELATIVE CONTRIBUTIONS OF COMPONENTS TO2A6,A4,18HIN OX1QB3100
     1RIGINAL SERIES /14X4HSPAN7X20HTABLE NO. AND SYMBOL /15X2HIN9X3HD13X1QB3110
     27X3HD127X3HD10 /12X8HQUARTERS7X1HI9X1HC9X1HS7X5HTOTAL5X5HRATIO )  X1QB3120
      DO 516 I=1,4                                                      X1QB3130
  516 WRITE (NR,13) I,RII(I),RIC(I),RIS(I),RTOT(I),RATO(I)              X1QB3140
   13 FORMAT (16XI1,3X5F10.2)                                           X1QB3150
  520 WRITE (NR,14) ADRCI,ADRI,ADRC,ADRQCD                              X1QB3160
   14 FORMAT(/7X23HAVERAGE DURATION OF RUN7X2HCI9X1HI9X1HC7X3HQCD/      X1QB3170
     1 30X4F10.2)                                                       X1QB3180
      WRITE (NR,15) (RATIO(I),I=1,4),MCD                                X1QB3190
   15 FORMAT(/7X 27HI/C RATIO FOR QUARTERS SPAN /                       X1QB3200
     1 19X,1H1,9X,1H2,9X,1H3,9X,1H4 / 10X, 4F10.2 //                    X1QB3210
     2 7X,31HQUARTERS FOR CYCLICAL DOMINANCE,11X,I1)                    X1QB3220
      WRITE (NR,16) WORD(ADD+1),WORD(ADD+3),WORD(ADD+5)                 X1QB3230
   16 FORMAT(/7X 7HAVERAGE 2A6,A4,62HWITH REGARD TO SIGN AND STANDARD DEX1QB3240
     1VIATION OVER INDICATED SPAN /                                     X1QB3250
     214X4HSPAN11X3H B113X3HD1313X3HD1213X3HD1013X3HD1113X3H F1 /       X1QB3260
     315X2HIN13X1HO15X1HI15X1HC15X1HS15X2HCI13X3HQCD /                  X1QB3270
     412X104HQUARTERS     AVG    S.D.     AVG    S.D.     AVG    S.D.   X1QB3280
     5  AVG    S.D.     AVG    S.D.     AVG    S.D. )                   X1QB3290
      DO 525 I=1,4                                                      X1QB3300
  525 WRITE (NR,17) I,OBAR2(I),SDCO(I),IBAR2(I),SDCI(I),CBAR2(I),SDCC(I)X1QB3310
     1,SBAR2(I),SDCS(I),CIBAR2(I),SDCCI(I),QBAR2(I),SDCQ(I)             X1QB3320
   17 FORMAT (16X I1, 3X 12F8.2)                                        X1QB3330
C --- WRITE CHARTS                                                      X1QB3340
  910 IF (ADD) 911,911,913                                              X1QB3350
  911 DO 912 I=IB,IE                                                    X1QB3360
      XMI(I) = XMI(I) * 100.                                            X1QB3370
      XI(I) = XI(I) * 100.                                              X1QB3380
      XSIT(I) = XSIT(I) * 100.                                          X1QB3390
      XSI(I) = XSI(I) * 100.                                            X1QB3400
  912 XS(I) = XS(I) * 100.                                              X1QB3410
  913 CALL CHART (2,MLG,1,IB,IE,XTCI,XTC,XTC,1)                         X1QB3420
      GO TO (914,916),MEAS                                              X1QB3430
  914 CALL CHART (3,1,2,IB,IE,XSIT,XSI,XS,2)                            X1QB3440
      IF (NP) 916,916,915                                               X1QB3450
  915 CALL CHART (3,1,1,IB,IE,XSIT,XSI,XS,3)                            X1QB3460
      CALL CHART (2,1,1,IB,IE,XI,XMI,XMI,4)                             X1QB3470
  916 RETURN                                                            X1QB3480
      END                                                               X1QB3490
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
C --- SUBROUTINE TO WRITE OUTPUT                                        X1QC0020
      SUBROUTINE WRIT (X,KB,KE,KTAB,MTAB,KDEC,NOP)                      X1QC0030
C --- X = ARRAY TO BE PRINTED FROM KB TO KE                             X1QC0040
C --- KTAB = LOCATION OF WRITE STATEMENT FOR CORRECT TITLE FORMAT       X1QC0050
C --- MTAB = TABLE NUMBER                                               X1QC0060
C --- KDEC = NUMBER OF DECIMAL PLACES, 1 = NONE, 2 = ONE PLACE          X1QC0070
C --- NOP   = 1,TOTAL. = 2,AVG. = 3,S.D., = 4,MOVING 5-YEAR S.D.        X1QC0080
      INTEGER ADD                                                       X1QC0090
      DIMENSION X(125), TAVG(4), PART(3), SINAME(4), MOD(9)             X1QC0100
      COMMON /SIGM/ SIGML,SIGMU,SD5(125)                                X1QC0110
      COMMON /RITE/ NR, NYEAR, TITLE(10), SERNO, KPAGE                  X1QC0120
      COMMON /MORE/ SFC,BPF,KPART,MCD                                   X1QC0130
      COMMON /XYBK/ Y(30), Z(30)                                        X1QC0140
      COMMON /TADJ/ ADD                                                 X1QC0150
      DATA NEWPG,SPACE /1H^, 1H?/                                       X1QC0160
      DATA (TAVG(I),I=1,4) /6H TOTAL, 6H   AVG, 6H  S.D., 6H  S.D./     X1QC0170
      DATA (SINAME(I),I=1,4) /6HRATIOS, 6HDIFFER, 1H , 5HENCES/         X1QC0180
      DATA MOD(3),MOD(4),MOD(8),MOD(9) /2HUN, 1H , 2HUN, 1H /           X1QC0190
      DATA (PART(I),I=1,3),PARTE,PARTF /1HB, 1HC, 1HD, 1HE, 1HF/        X1QC0200
      XBAR = 1.0                                                        X1QC0210
      IF (ADD) 301,301,300                                              X1QC0220
  300 XBAR = 0.0                                                        X1QC0230
  301 K = KPART                                                         X1QC0240
      TABLE = MTAB                                                      X1QC0250
      IF (KTAB-11) 45,61,45                                             X1QC0260
C --- WRITE SERIES TITLE                                                X1QC0270
   45 KPAGE = KPAGE + 1                                                 X1QC0280
      WRITE (NR,30) NEWPG, (TITLE(I),I=1,10),KPAGE, SERNO               X1QC0290
   30 FORMAT (A1, 29X, 10A6, 8X, 4HPAGE, I3, 9H, SERIES , A6)           X1QC0300
C --- WRITE TABLE TITLE                                                 X1QC0310
      GO TO (50,50,50,70,80),KPART                                      X1QC0320
C --- PARTS B, C, AND D.                                                X1QC0330
   50 GO TO (51,52,53,54,55,56,57,58,59,60),KTAB                        X1QC0340
   51 WRITE (NR,1) PART(K),TABLE                                        X1QC0350
    1 FORMAT (1XA1,F3.0,16H ORIGINAL SERIES)                            X1QC0360
      GO TO 201                                                         X1QC0370
   52 WRITE (NR,2) PART(K),TABLE                                        X1QC0380
    2 FORMAT (1XA1,F3.0,44H TREND-CYCLE, CENTERED 4-TERM MOVING AVERAGE)X1QC0390
      GO TO 201                                                         X1QC0400
   53 WRITE (NR,3) PART(K),TABLE,BPF,MOD(MTAB),SINAME(ADD+1),           X1QC0410
     1       SINAME(ADD+3)                                              X1QC0420
    3 FORMAT (1XA1,F3.0,A6,1XA2,12HMODIFIED SI 2A6)                     X1QC0430
      GO TO 201                                                         X1QC0440
   54 WRITE (NR,4) PART(K),TABLE,BPF,SINAME(ADD+1),SINAME(ADD+3)        X1QC0450
    4 FORMAT (1XA1,F3.0,A6,35H REPLACEMENT VALUES FOR EXTREME SI 2A6)   X1QC0460
      GO TO 201                                                         X1QC0470
   55 WRITE (NR,5) PART(K),TABLE,BPF,SFC                                X1QC0480
    5 FORMAT (1XA1,F3.0,A6,17H SEASONAL FACTORSA6,14HMOVING AVERAGE)    X1QC0490
      GO TO 201                                                         X1QC0500
   56 WRITE (NR,6) PART(K),TABLE,BPF                                    X1QC0510
    6 FORMAT (1XA1,F3.0,A6,27H SEASONALLY ADJUSTED SERIES)              X1QC0520
      GO TO 201                                                         X1QC0530
   57 WRITE (NR,7) PART(K),TABLE,BPF                                    X1QC0540
    7 FORMAT (1XA1,F3.0,A6,36H TREND-CYCLE, 5-TERM HENDERSON CURVE)     X1QC0550
      GO TO 201                                                         X1QC0560
   58 WRITE (NR,8) PART(K),TABLE,BPF                                    X1QC0570
    8 FORMAT (1XA1,F3.0,A6,17H IRREGULAR SERIES)                        X1QC0580
      GO TO 201                                                         X1QC0590
   59 WRITE (NR,9) PART(K),TABLE,BPF,SIGML,SIGMU                        X1QC0600
    9 FORMAT (1XA1,F3.0,A6,29H WEIGHTS FOR IRREGULAR SERIES/            X1QC0610
     1       16X 22HGRADUATION RANGE FROM F4.1,4H TO F4.1,6H SIGMA)     X1QC0620
      GO TO 201                                                         X1QC0630
   60 WRITE (NR,10)PART(K),TABLE,BPF                                    X1QC0640
   10 FORMAT (1XA1,F3.0,29H ORIGINAL SERIES MODIFIED BY A6,8H WEIGHTS)  X1QC0650
      GO TO 201                                                         X1QC0660
   61 WRITE (NR,19)                                                     X1QC0670
   19 FORMAT (38H D10A. SEASONAL FACTORS ONE YEAR AHEAD)                X1QC0680
      GO TO 201                                                         X1QC0690
C --- PART E                                                            X1QC0700
   70 GO TO (71,72,73,74,75,76),KTAB                                    X1QC0710
   71 WRITE (NR,11) PARTE,TABLE                                         X1QC0720
   11 FORMAT (1X,A1,F3.0,38H ORIGINAL SERIES MODIFIED FOR EXTREMES)     X1QC0730
      GO TO 201                                                         X1QC0740
   72 WRITE (NR,12) PARTE,TABLE                                         X1QC0750
   12 FORMAT (1X,A1,F3.0,36H MODIFIED SEASONALLY ADJUSTED SERIES)       X1QC0760
      GO TO 201                                                         X1QC0770
   73 WRITE (NR,13) PARTE,TABLE                                         X1QC0780
   13 FORMAT (1X,A1,F3.0,26H MODIFIED IRREGULAR SERIES)                 X1QC0790
      GO TO 201                                                         X1QC0800
   74 WRITE (NR,14) PARTE,TABLE,SINAME(ADD+1),SINAME(ADD+3)             X1QC0810
   14 FORMAT (1X,A1,F3.0,2A6,57HOF ANNUAL TOTALS, ORIGINAL AND SEASONALLX1QC0820
     1Y ADJUSTED SERIES / 23X, 10HUNMODIFIED, 26X, 8HMODIFIED )         X1QC0830
      RETURN                                                            X1QC0840
   75 WRITE (NR,15) PARTE,TABLE                                         X1QC0850
   15 FORMAT (1X,A1,F3.0,46H QUARTER-TO-QUARTER CHANGES IN ORIGINAL SERIX1QC0860
     1ES)                                                               X1QC0870
      GO TO 201                                                         X1QC0880
   76 WRITE (NR,16) PARTE,TABLE                                         X1QC0890
   16 FORMAT (1X,A1,F3.0,70H QUARTER-TO-QUARTER CHANGES IN FINAL SEASONAX1QC0900
     1LLY ADJUSTED SERIES (D11.) )                                      X1QC0910
      GO TO 201                                                         X1QC0920
C --- PART F                                                            X1QC0930
   80 GO TO (81,83),KTAB                                                X1QC0940
   81 WRITE (NR,17) PARTF,TABLE,MCD                                     X1QC0950
   17 FORMAT (1X,A1,F3.0,19H QCD MOVING AVERAGE / 11X,6HQCD IS,I2)      X1QC0960
      IF (MCD-1) 82,82,201                                              X1QC0970
   82 WRITE (NR,32)                                                     X1QC0980
   32 FORMAT (6X,15H SEE TABLE D11.)                                    X1QC0990
      RETURN                                                            X1QC1000
   83 WRITE (NR,18) PARTF,TABLE                                         X1QC1010
   18 FORMAT (1X,A1,F3.0,17H SUMMARY MEASURES)                          X1QC1020
      RETURN                                                            X1QC1030
  201 WRITE (NR,31) SPACE, TAVG(NOP)                                    X1QC1040
   31 FORMAT (A1,3X,4HYEAR,10X,8H1ST QUAR,16X,8H2ND QUAR,16X,8H3RD QUAR,X1QC1050
     1        16X,8H4TH QUAR,16X,A6)                                    X1QC1060
      DO 204 I=1,125                                                    X1QC1070
      IF (I-KB) 203,202,202                                             X1QC1080
  202 IF (I-KE) 204,204,203                                             X1QC1090
  203 X(I) = 9999999999.0                                               X1QC1100
  204 CONTINUE                                                          X1QC1110
      J1 = (KB+3) /4 * 4 - 3                                            X1QC1120
      J2 = J1 + 3                                                       X1QC1130
      NO = (KE-1)/4 * 4                                                 X1QC1140
      TOTAL = 0.0                                                       X1QC1150
      NT = 0                                                            X1QC1160
      DO 230 J=J1,KE,4                                                  X1QC1170
      IF (J-J1) 211,211,210                                             X1QC1180
  210 IF (J-NO) 213,212,212                                             X1QC1190
  211 M = KB                                                            X1QC1200
      N = J2                                                            X1QC1210
      GO TO 214                                                         X1QC1220
  212 M = J                                                             X1QC1230
      N = KE                                                            X1QC1240
      GO TO 214                                                         X1QC1250
  213 M = J                                                             X1QC1260
      N = J + 3                                                         X1QC1270
  214 NT = NT + 1                                                       X1QC1280
      SUBTOT = 0.0                                                      X1QC1290
      DO 215 I=M,N                                                      X1QC1300
  215 SUBTOT = SUBTOT + X(I)                                            X1QC1310
      TOTAL = TOTAL + SUBTOT                                            X1QC1320
      COUNT = N - M + 1                                                 X1QC1330
      YRAVG = SUBTOT / COUNT                                            X1QC1340
      GO TO (216,217,218,220),NOP                                       X1QC1350
  216 Y(NT) = SUBTOT                                                    X1QC1360
      GO TO 230                                                         X1QC1370
  217 Y(NT) = YRAVG                                                     X1QC1380
      GO TO 230                                                         X1QC1390
  218 YRSD = 0.0                                                        X1QC1400
      DO 219 I=M,N                                                      X1QC1410
  219 YRSD = YRSD + (X(I)-XBAR) **2                                     X1QC1420
      Y(NT) = SQRT(YRSD/COUNT)                                          X1QC1430
      GO TO 230                                                         X1QC1440
  220 Y(NT) = SD5(N)                                                    X1QC1450
  230 CONTINUE                                                          X1QC1460
      KYEAR = NYEAR + J1 / 4                                            X1QC1470
      N = 1                                                             X1QC1480
C --- WRITE LINE(YEAR) OF DATA                                          X1QC1490
      J = J1                                                            X1QC1500
  103 K = J + 3                                                         X1QC1510
      GO TO (104,107),KDEC                                              X1QC1520
  104 IF (MTAB-17) 106,105,106                                          X1QC1530
C --- LINE FOR TABLE OF WEIGHTS FOR IRREGULAR                           X1QC1540
  105 WRITE (NR,20) SPACE,KYEAR, (X(I),I=J,K), Y(N)                     X1QC1550
   20 FORMAT (A1,3X,2H19,I2,10X,2PF8.1,3(16X,F8.1),14X,0PF8.0)          X1QC1560
      GO TO 108                                                         X1QC1570
C --- LINE FOR DATA WITH NO DECIMAL PLACES                              X1QC1580
  106 WRITE (NR,21) SPACE,KYEAR, (X(I),I=J,K), Y(N)                     X1QC1590
   21 FORMAT (A1,3X,2H19,I2,10X,F8.0,3(16X,F8.0),14X,F8.0)              X1QC1600
      GO TO 108                                                         X1QC1610
C --- LINE FOR DATA WITH ONE PLACE AFTER DECIMAL POINT                  X1QC1620
  107 WRITE (NR,22) SPACE,KYEAR, (X(I),I=J,K),Y(N)                      X1QC1630
   22 FORMAT (A1,3X,2H19,I2,10X,2PF8.1,3(16X,F8.1),14X,F8.1)            X1QC1640
  108 J = J + 4                                                         X1QC1650
      KYEAR = KYEAR + 1                                                 X1QC1660
      N = N + 1                                                         X1QC1670
      IF (K-KE) 103,109,109                                             X1QC1680
  109 WRITE (NR,23)                                                     X1QC1690
   23 FORMAT (1H )                                                      X1QC1700
C --- COMPUTE AVERAGE OR STND DEV FOR EACH QUARTER                      X1QC1710
C                                                                       X1QC1720
C     TABLES FOR WHICH ABOVE IS NOT PRINTED                             X1QC1730
      IF (KPART-3) 122,120,123                                          X1QC1740
  120 IF (MTAB-9) 121,999,121                                           X1QC1750
  121 IF (KTAB-11) 122,999,122                                          X1QC1760
  122 IF (KTAB-5) 123,150,123                                           X1QC1770
  123 GO TO (130,130,130,999),NOP                                       X1QC1780
  130 DO 139 N=1,4                                                      X1QC1790
      IST = N + 4*((KB+3-N)/4)                                          X1QC1800
  133 SUM = 0.0                                                         X1QC1840
      C = 0.0                                                           X1QC1850
      DO 136 I=IST,KE,4                                                 X1QC1860
      C = C + 1.0                                                       X1QC1870
      GO TO (134,134,135),NOP                                           X1QC1880
  134 SUM = SUM + X(I)                                                  X1QC1890
      GO TO 136                                                         X1QC1900
  135 SUM = SUM + (X(I)-XBAR) **2                                       X1QC1910
  136 CONTINUE                                                          X1QC1920
      GO TO (137,137,138),NOP                                           X1QC1930
  137 Y(N) = SUM / C                                                    X1QC1940
      GO TO 139                                                         X1QC1950
  138 Y(N) = SQRT(SUM/C)                                                X1QC1960
  139 CONTINUE                                                          X1QC1970
      M = (NOP+1)/2 + 1                                                 X1QC1980
      GO TO (140,141),KDEC                                              X1QC1990
  140 WRITE (NR,24) TAVG(M), (Y(I),I=1,4)                               X1QC2000
   24 FORMAT (2X,A6,12X,F6.0,3(18X,F6.0))                               X1QC2010
      GO TO 150                                                         X1QC2020
  141 WRITE (NR,25) TAVG(M), (Y(I),I=1,4)                               X1QC2030
   25 FORMAT (2X,A6,12X,2PF6.1,3(18X,F6.1))                             X1QC2040
C --- WRITE TABLE TOTAL                                                 X1QC2050
C                                                                       X1QC2060
C     DETERMINE WHICH TABLES ALSO HAVE TABLE AVG AND STND DEV           X1QC2070
  150 IF (MTAB-13) 151,170,151                                          X1QC2080
  151 IF (MTAB-12) 152,170,152                                          X1QC2090
  152 GO TO (153,160,154,155,160),KPART                                 X1QC2100
  153 IF (MTAB-1) 160,170,160                                           X1QC2110
  154 IF (MTAB-11) 160,170,160                                          X1QC2120
  155 IF (MTAB-3) 170,170,160                                           X1QC2130
C --- TABLE TOTAL ONLY                                                  X1QC2140
  160 GO TO (161,162),KDEC                                              X1QC2150
  161 WRITE (NR,26) TOTAL                                               X1QC2160
   26 FORMAT (20X, 12HTABLE TOTAL ,F10.0)                               X1QC2170
      GO TO 999                                                         X1QC2180
  162 WRITE (NR,27) TOTAL                                               X1QC2190
   27 FORMAT (20X, 12HTABLE TOTAL ,2PF10.1)                             X1QC2200
      GO TO 999                                                         X1QC2210
C --- TOTAL,AVERAGE, AND STANDARD DEVIATION OF TABLE                    X1QC2220
  170 C = KE - KB + 1                                                   X1QC2230
      XBAR = TOTAL / C                                                  X1QC2240
      SDEV = 0.0                                                        X1QC2250
      DO 171 I=KB,KE                                                    X1QC2260
  171 SDEV = SDEV + (X(I)-XBAR) **2                                     X1QC2270
      SDEV = SQRT(SDEV/C)                                               X1QC2280
      GO TO (172,173),KDEC                                              X1QC2290
  172 WRITE (NR,28) TOTAL,XBAR,SDEV                                     X1QC2300
   28 FORMAT (20X,12HTABLE TOTAL ,F10.0,5X,5HMEAN ,F10.0,5X,15HSTD. DEVIX1QC2310
     1ATION ,F10.0)                                                     X1QC2320
      GO TO 999                                                         X1QC2330
  173 WRITE (NR,29) TOTAL,XBAR,SDEV                                     X1QC2340
   29 FORMAT (20X,12HTABLE TOTAL ,2PF10.1,5X,5HMEAN ,F10.1,5X,15HSTD. DEX1QC2350
     1VIATION ,F10.1)                                                   X1QC2360
  999 RETURN                                                            X1QC2370
      END                                                               X1QC2380
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
C --- SEASONAL FACTOR CURVE SUBROUTINE                                  X1QD0020
      SUBROUTINE QSF (XSI,XS,KB,KE,ITER)                                X1QD0030
      INTEGER ADD                                                       X1QD0040
      DIMENSION XSI(125),XS(125),WT3A(6),WT4A(8),W3X3(15),WT3B(6),      X1QD0050
     1          WT4B(8),WT5B(15),WT6B(18),W3X5(28)                      X1QD0060
      COMMON /SIGM/ SIGML,SIGMU,XCF(125)                                X1QD0070
      COMMON /XYBK/ X(30),Y(30)                                         X1QD0080
      COMMON /TADJ/ ADD                                                 X1QD0090
      DATA (WT3A(I),I=1,6)   /.407,.407,.185,                           X1QD0100
     1                        .333,.333,.333/                           X1QD0110
      DATA (WT4A(I),I=1,8)  /.407,.407,.185,.0,                         X1QD0120
     1                       .259,.370,.259,.111/                       X1QD0130
      DATA (W3X3(I),I=1,15) /.407,.407,.185,.0,.0,                      X1QD0140
     1                       .259,.370,.259,.111,.0,                    X1QD0150
     1                       .111,.222,.333,.222,.111/                  X1QD0160
      DATA (WT3B(I),I=1,6)   /.333,.333,.333,                           X1QD0170
     1                        .333,.333,.333/                           X1QD0180
      DATA (WT4B(I),I=1,8)   /.283,.283,.283,.150,                      X1QD0190
     1                        .250,.250,.250,.250/                      X1QD0200
      DATA (WT5B(I),I=1,15)  /.283,.283,.283,.150,.0,                   X1QD0210
     1                        .250,.250,.250,.183,.067,                 X1QD0220
     2                        .200,.200,.200,.200,.200/                 X1QD0230
      DATA (WT6B(I),I=1,18)  /.283,.283,.283,.150,.000,.000,            X1QD0240
     1                        .250,.250,.250,.183,.067,.000,            X1QD0250
     2                        .150,.217,.217,.217,.133,.067/            X1QD0260
      DATA (W3X5(I),I=1,28)  /.283,.283,.283,.150,.000,.000,.000,       X1QD0270
     1                        .250,.250,.250,.183,.067,.000,.000,       X1QD0280
     2                        .150,.217,.217,.217,.133,.067,.000,       X1QD0290
     3                        .067,.133,.200,.200,.200,.133,.067/       X1QD0300
      KBT = KB-1                                                        X1QD0310
      DO 30 K=1,4                                                       X1QD0320
      KBT = KBT+1                                                       X1QD0330
      J = 0                                                             X1QD0340
      DO 10 I=KBT,KE,4                                                  X1QD0350
      J = J+1                                                           X1QD0360
   10 X(J) = XSI(I)                                                     X1QD0370
      J1 = J                                                            X1QD0380
      IF (J-7) 12,12,11                                                 X1QD0390
   11 J1 = 7                                                            X1QD0400
   12 KTER = ITER - 1                                                   X1QD0410
      J1 = J1 + 7*KTER                                                  X1QD0420
      GO TO (13,113,13,14,15,15,15,  13,13,33,34,35,36,37),J1           X1QD0430
  113 Y(1) = (X(1) + X(2)) / 2.0                                        X1QD0431
      Y(2) = (X(1) + X(2)) / 2.0                                        X1QD0432
      GO TO 40                                                          X1QD0433
   13 CALL MOVAVE (X,Y,WT3A,1,J,3,1,0)                                  X1QD0440
      GO TO 40                                                          X1QD0450
   14 CALL MOVAVE (X,Y,WT4A,1,J,4,2,1)                                  X1QD0460
      GO TO 40                                                          X1QD0470
   15 CALL MOVAVE (X,Y,W3X3,1,J,5,2,0)                                  X1QD0480
      GO TO 40                                                          X1QD0490
   33 CALL MOVAVE (X,Y,WT3B,1,J,3,1,0)                                  X1QD0500
      GO TO 40                                                          X1QD0510
   34 CALL MOVAVE (X,Y,WT4B,1,J,4,2,1)                                  X1QD0520
      GO TO 40                                                          X1QD0530
   35 CALL MOVAVE (X,Y,WT5B,1,J,5,2,0)                                  X1QD0540
      GO TO 40                                                          X1QD0550
   36 CALL MOVAVE (X,Y,WT6B,1,J,6,3,1)                                  X1QD0560
      GO TO 40                                                          X1QD0570
   37 CALL MOVAVE (X,Y,W3X5,1,J,7,3,0)                                  X1QD0580
   40 J = 0                                                             X1QD0590
      DO 30 I=KBT,KE,4                                                  X1QD0600
      J = J + 1                                                         X1QD0610
   30 XS(I) = Y(J)                                                      X1QD0620
C --- CENTER SEASONAL FACTORS                                           X1QD0630
      DO 20 I=KB,KE                                                     X1QD0640
   20 XCF(I) = XS(I)                                                    X1QD0650
      M = KB + 2                                                        X1QD0660
      N = KE - 2                                                        X1QD0670
      DO 23 I=M,N                                                       X1QD0680
      IF (ADD) 22,22,21                                                 X1QD0690
   21 XS(I) = XS(I) - ((XCF(I-2) + XCF(I+2) + 2.0 * (XCF(I-1) + XCF(I) +X1QD0700
     1                  XCF(I+1))) / 8.0)                               X1QD0710
      GO TO 23                                                          X1QD0720
   22 XS(I) = XS(I) / ((XCF(I-2) + XCF(I+2) + 2.0 * (XCF(I-1) + XCF(I) +X1QD0730
     1                  XCF(I+1))) / 8.0)                               X1QD0740
   23 CONTINUE                                                          X1QD0750
      BEG = (XCF(KB) + XCF(KB+4) + 2.0 * (XCF(KB+1) + XCF(KB+2) +       X1QD0760
     1       XCF(KB+3))) / 8.0                                          X1QD0770
      END = (XCF(KE) + XCF(KE-4) + 2.0 * (XCF(KE-1) + XCF(KE-2) +       X1QD0780
     1       XCF(KE-3))) / 8.0                                          X1QD0790
      IF (ADD) 25,25,24                                                 X1QD0800
   24 XS(KB) = XS(KB) - BEG                                             X1QD0810
      XS(KB+1) = XS(KB+1) - BEG                                         X1QD0820
      XS(KE) = XS(KE) - END                                             X1QD0830
      XS(KE-1) = XS(KE-1) - END                                         X1QD0840
      GO TO 26                                                          X1QD0850
   25 XS(KB) = XS(KB) / BEG                                             X1QD0860
      XS(KB+1) = XS(KB+1) / BEG                                         X1QD0870
      XS(KE) = XS(KE) / END                                             X1QD0880
      XS(KE-1) = XS(KE-1) / END                                         X1QD0890
   26 RETURN                                                            X1QD0900
      END                                                               X1QD0910
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
C --- SUBROUTINE TO FIND EXTEME VALUES IN ARRAY XI                      X1QE0020
      SUBROUTINE XTRMES(XI,KB,KE,XWT)                                   X1QE0030
      INTEGER ADD                                                       X1QE0040
      DIMENSION XWT(125),XI(125)                                        X1QE0050
      COMMON /TADJ/ ADD                                                 X1QE0060
      COMMON /SIGM/ SIGML,SIGMU,SD5(125)                                X1QE0070
      ITER = 1                                                          X1QE0080
      XBAR = 1.0                                                        X1QE0090
      IF (ADD) 9,9,8                                                    X1QE0100
    8 XBAR = 0.0                                                        X1QE0110
    9 MB = (KB+2) / 4*4+1                                               X1QE0120
      ME =  KE / 4 * 4 - 19                                             X1QE0130
      IF (ME-MB) 11,11,12                                               X1QE0140
   11 ME = 1                                                            X1QE0150
   12 DO 29 I=MB,ME,4                                                   X1QE0160
      SDEV = 0.0                                                        X1QE0170
      IF (ME-MB) 13,13,14                                               X1QE0180
   13 J = KB                                                            X1QE0190
      K = KE                                                            X1QE0200
      GO TO 15                                                          X1QE0210
   14 J = I                                                             X1QE0220
      K = I + 19                                                        X1QE0230
   15 C = 0.0                                                           X1QE0240
      DO 18 M=J,K                                                       X1QE0250
      GO TO (17,16),ITER                                                X1QE0260
   16 IF (XWT(M)) 18,18,17                                              X1QE0270
   17 C = C + 1.0                                                       X1QE0280
      SDEV = SDEV + (XI(M)-XBAR) **2                                    X1QE0290
   18 CONTINUE                                                          X1QE0300
      SDEV = SQRT(SDEV/C)                                               X1QE0310
      IF (ME-MB) 24,24,19                                               X1QE0320
   19 IF (I-MB) 20,21,20                                                X1QE0330
   20 IF (I-ME) 23,22,23                                                X1QE0340
   21 J = KB                                                            X1QE0350
      K = MB + 11                                                       X1QE0360
      GO TO 24                                                          X1QE0370
   22 J = ME + 8                                                        X1QE0380
      K = KE                                                            X1QE0390
      GO TO 24                                                          X1QE0400
   23 J = I + 8                                                         X1QE0410
      K = I + 11                                                        X1QE0420
   24 DO 29 M=J,K                                                       X1QE0430
      SD5(M) = SDEV                                                     X1QE0440
      IF (SDEV) 27,27,40                                                X1QE0450
   40 TEMP = (ABS(XI(M)-XBAR)) / SDEV                                   X1QE0460
      IF (TEMP-SIGMU) 25,25,26                                          X1QE0470
   25 IF (TEMP-SIGML) 27,27,28                                          X1QE0480
   26 XWT(M) = 0.0                                                      X1QE0490
      GO TO 29                                                          X1QE0500
   27 XWT(M) = 1.0                                                      X1QE0510
      GO TO 29                                                          X1QE0520
   28 XWT(M) = (SIGMU-TEMP) / (SIGMU-SIGML)                             X1QE0530
   29 CONTINUE                                                          X1QE0540
      GO TO (30,31),ITER                                                X1QE0550
   30 ITER = 2                                                          X1QE0560
      GO TO 9                                                           X1QE0570
   31 RETURN                                                            X1QE0580
      END                                                               X1QE0590
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
C --- MOVING AVERAGE SUBROUTINE                                         X1QF0020
      SUBROUTINE MOVAVE (X,Y,WT,J,K,NTRMS,NENDT,NOCEN)                  X1QF0030
C ---   X = INPUT SERIES                                                X1QF0040
C       Y = OUTPUT SERIES -I.E. INPUT SERIES AFTER MOVING AVERAGE TAKEN X1QF0050
C       J = LOCATION OF FIRST DATA VALUE OF INPUT SERIES                X1QF0060
C       K = LOCATION OF LAST DATA VALUE OF INPUT SERIES                 X1QF0070
C       WT = WEIGHTS TO BE USED FOR MOVING AVERAGE                      X1QF0080
C --- NENDT = NUMBER OF END TERMS                                       X1QF0090
C --- NTRMS = NUMBER OF TERMS IN MOVING AVERAGE                         X1QF0100
      DIMENSION X(125), Y(125), WT(30)                                  X1QF0110
      IF (NENDT) 5,5,1                                                  X1QF0120
    1 DO  3 N=1,NENDT                                                   X1QF0130
      SUMWT = 0.0                                                       X1QF0140
      TEMP1 = 0.0                                                       X1QF0150
      TEMP2 = 0.0                                                       X1QF0160
      DO 2 I=1,NTRMS                                                    X1QF0170
      KWT = N * NTRMS - NTRMS + I                                       X1QF0180
      KTRM1 = J + I - 1                                                 X1QF0190
      KTRM2 = K - I + 1                                                 X1QF0200
      TEMP1 = TEMP1 + (X(KTRM1) * WT(KWT))                              X1QF0210
      TEMP2 = TEMP2 + (X(KTRM2) * WT(KWT))                              X1QF0220
    2 SUMWT = SUMWT + WT(KWT)                                           X1QF0230
      KBEG = J + N - 1                                                  X1QF0240
      KEND = K + 1 - N                                                  X1QF0250
      Y(KBEG) = TEMP1 / SUMWT                                           X1QF0260
      Y(KEND) = TEMP2 / SUMWT                                           X1QF0270
    3 CONTINUE                                                          X1QF0280
C --- CENTRAL TERMS                                                     X1QF0290
    5 IF (NOCEN) 6,6,10                                                 X1QF0300
    6 K1= K + 1 - NTRMS                                                 X1QF0310
      SUMWT = 0                                                         X1QF0320
      DO 7 I=1,NTRMS                                                    X1QF0330
      KWT = NENDT*NTRMS + I                                             X1QF0340
    7 SUMWT = SUMWT + WT(KWT)                                           X1QF0350
      DO 9 N=J,K1                                                       X1QF0360
      TEMP1 = 0.0                                                       X1QF0370
      DO 8 I=1,NTRMS                                                    X1QF0380
      KWT = NENDT*NTRMS + I                                             X1QF0390
      KTRM1= N + I - 1                                                  X1QF0400
    8 TEMP1 = TEMP1 +(X(KTRM1) * WT(KWT))                               X1QF0410
      KTRM2 = N + NTRMS/2                                               X1QF0420
    9 Y(KTRM2) = TEMP1 / SUMWT                                          X1QF0430
   10 RETURN                                                            X1QF0440
      END                                                               X1QF0450
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
      SUBROUTINE REPLCE (X,Y,J,K,XWT)                                   X1QG0020
C --- THIS SUBROUTINE REPLACES VALUES IN ARRAY -X- WHICH HAVE A WEIGHT  X1QG0030
C     LESS THAN 1.0                                                     X1QG0040
C --- THE REPLACEMENT VALUES ARE STORED IN ARRAY -Y-                    X1QG0050
      DIMENSION X(125), Y(125), XWT(125)                                X1QG0060
      DO 100 I=J,K                                                      X1QG0070
      R = X(I)                                                          X1QG0080
      IF (XWT(I) - 1.0) 10,100,100                                      X1QG0090
   10 SUM = X(I) * XWT(I)                                               X1QG0100
      KNO = 0                                                           X1QG0110
      IF (I-1-J) 12,12,11                                               X1QG0120
   11 IF (K-I-1) 13,13,19                                               X1QG0130
C --- EXTREME VALUES IN FIRST 2 LOCATIONS AT EITHER END OF ARRAY ARE    X1QG0140
C      REPLACED BY THE THREE NEAREST NONEXTREME VALUES                  X1QG0150
   12 M = J                                                             X1QG0160
      N = K                                                             X1QG0170
      INC = 1                                                           X1QG0180
      GO TO 14                                                          X1QG0190
   13 M = K                                                             X1QG0200
      N = J                                                             X1QG0210
      INC = -1                                                          X1QG0220
   14 IF (XWT(M)-1.0) 15,17,17                                          X1QG0230
   15 IF (M-N) 16,40,16                                                 X1QG0240
   16 M = M + INC                                                       X1QG0250
      GO TO 14                                                          X1QG0260
   17 SUM = SUM + X(M)                                                  X1QG0270
      KNO = KNO + 1                                                     X1QG0280
      IF (KNO-3) 15,40,40                                               X1QG0290
C --- EXTREME CENTER VALUES ARE REPLACED BY TWO NEAREST NONEXTREME      X1QG0300
C      VALUES ON EACH SIDE                                              X1QG0310
   19 K2 = 2                                                            X1QG0320
      MM = I                                                            X1QG0330
C                                                                       X1QG0340
   20 INC = 1                                                           X1QG0350
      N = K                                                             X1QG0360
C                                                                       X1QG0370
   21 NO = 0                                                            X1QG0380
      M = MM                                                            X1QG0390
C                                                                       X1QG0400
   22 IF (M-N) 23,30,23                                                 X1QG0410
   23 M = M + INC                                                       X1QG0420
      IF (XWT(M)-1.0) 22,24,24                                          X1QG0430
C                                                                       X1QG0440
   24 SUM = SUM + X(M)                                                  X1QG0450
      NO = NO + 1                                                       X1QG0460
      IF (NO-K2) 22,30,30                                               X1QG0470
C                                                                       X1QG0480
   30 KNO = KNO + NO                                                    X1QG0490
      IF (KNO-4) 31,39,39                                               X1QG0500
   31 IF (MM-I) 39,32,39                                                X1QG0510
C                                                                       X1QG0520
   32 IF (INC) 34,34,33                                                 X1QG0530
   33 M2 = M                                                            X1QG0540
      N = J                                                             X1QG0550
      K2 = 4 - NO                                                       X1QG0560
      INC = -1                                                          X1QG0570
      GO TO 21                                                          X1QG0580
C                                                                       X1QG0590
   34 K2 = 4 - KNO                                                      X1QG0600
      MM = M2                                                           X1QG0610
      GO TO 20                                                          X1QG0620
C                                                                       X1QG0630
   39 IF (KNO-4) 41,50,50                                               X1QG0640
   40 IF (KNO -3) 41,50,50                                              X1QG0650
   41 SUM = 0.0                                                         X1QG0660
      DO 42 L=J,K                                                       X1QG0670
   42 SUM = SUM + X(L)                                                  X1QG0680
      CT =  K - J + 1                                                   X1QG0690
      GO TO 51                                                          X1QG0700
   50 CT = KNO                                                          X1QG0710
      CT = CT + XWT(I)                                                  X1QG0720
   51 R = SUM / CT                                                      X1QG0730
  100 Y(I) =  R                                                         X1QG0740
      RETURN                                                            X1QG0750
      END                                                               X1QG0760
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
C --- SUBROUTINE TO CALCULATE AVERAGE QUARTER-TO-QUARTER CHANGE         X1QH0020
      SUBROUTINE AVEC (X,J,K,XBAR,XBAR2,SDC)                            X1QH0030
C --- INPUT IS ARRAY X - LOCATION OF 1ST VALUE IS  J, OF LAST IS K.     X1QH0040
C --- OUTPUT                                                            X1QH0050
C           SDC  = STD. DEV. OF CHANGES WITH REGARD TO SIGN             X1QH0060
C           XBAR = AVERAGE CHANGE WITHOUT REGARD TO SIGN                X1QH0070
C           XBAR2 = AVG CHANGE WITH REGARD TO SIGN                      X1QH0080
C --- IF ADDITIVE ADJUSTMENT, CHANGES ARE QUARTER-TO-QUARTER DIFFERENCE X1QH0090
C     IF MULTIPLICATIVE, QUARTER-TO-QUARTER PERCENT CHANGE              X1QH0100
      INTEGER ADD                                                       X1QH0110
      DIMENSION X(125), XBAR(4), XBAR2(4), SDC(4)                       X1QH0120
      COMMON /TADJ/ ADD                                                 X1QH0130
      DO 10 M=1,4                                                       X1QH0140
      XBAR(M) = 0.0                                                     X1QH0150
      XBAR2(M) = 0.0                                                    X1QH0160
      SDC(M) = 0.0                                                      X1QH0170
      KM = K - M                                                        X1QH0180
      COUNT = KM - J + 1                                                X1QH0190
      DO 3  I=J,KM                                                      X1QH0200
      N = I + M                                                         X1QH0210
      IF (ADD) 1,1,2                                                    X1QH0220
    1 XBAR(M) = XBAR(M) + ABS(X(N)-X(I)) / X(I) * 100.0                 X1QH0230
      XBAR2(M) = XBAR2(M) + (X(N)-X(I)) / X(I) * 100.0                  X1QH0240
      GO TO 3                                                           X1QH0250
    2 XBAR(M) = XBAR(M) + ABS(X(N)-X(I))                                X1QH0260
      XBAR2(M) = XBAR2(M) + (X(N)-X(I))                                 X1QH0270
    3 CONTINUE                                                          X1QH0280
      XBAR(M) = XBAR(M) / COUNT                                         X1QH0290
      XBAR2(M) = XBAR2(M) / COUNT                                       X1QH0300
      IF (ADD) 6,6,4                                                    X1QH0310
    4 DO 5 I=J,KM                                                       X1QH0320
      N = I + M                                                         X1QH0330
    5 SDC(M) = SDC(M) + (X(N)-X(I) - XBAR2(M)) **2                      X1QH0340
      GO TO 8                                                           X1QH0350
    6 DO 7 I=J,KM                                                       X1QH0360
      N = I + M                                                         X1QH0370
    7 SDC(M) = SDC(M) + ((X(N)-X(I)) / X(I) * 100.0 - XBAR2(M)) **2     X1QH0380
    8 IF (SDC(M)) 10,10,9                                               X1QH0390
    9 SDC(M) = SQRT(SDC(M)/COUNT)                                       X1QH0400
   10 CONTINUE                                                          X1QH0410
      RETURN                                                            X1QH0420
      END                                                               X1QH0430
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
C --- AVERAGE DURATION OF RUN SUBROUTINE                                X1QI0020
      SUBROUTINE AVEDUR(Y,L,M,ADR)                                      X1QI0030
      DIMENSION Y(125)                                                  X1QI0040
      I = L                                                             X1QI0050
      RUNS = 1.                                                         X1QI0060
      IF (Y(I)-Y(I+1)) 15,12,18                                         X1QI0070
   12 I = I + 1                                                         X1QI0080
      IF (I-M) 13,21,21                                                 X1QI0090
   13 IF (Y(I)-Y(I+1)) 15,12,17                                         X1QI0100
   15 I = I + 1                                                         X1QI0110
      IF (I-M) 16,21,21                                                 X1QI0120
   16 IF (Y(I)-Y(I+1)) 15,15,17                                         X1QI0130
   17 RUNS = RUNS + 1.0                                                 X1QI0140
   18 I = I + 1                                                         X1QI0150
      IF (I-M) 19,21,21                                                 X1QI0160
   19 IF (Y(I)-Y(I+1)) 20,18,18                                         X1QI0170
   20 RUNS = RUNS + 1.0                                                 X1QI0180
      GO TO 15                                                          X1QI0190
   21 COUNT = M - L                                                     X1QI0200
      ADR = COUNT / RUNS                                                X1QI0210
      RETURN                                                            X1QI0220
      END                                                               X1QI0230
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
C --- SUBROUTINE TO DIVIDE/SUBTRACT TWO SERIES                          X1QJ0020
      SUBROUTINE DIVSUB (X,Y,Z,J,K)                                     X1QJ0030
      INTEGER ADD                                                       X1QJ0040
      DIMENSION X(125), Y(125), Z(125)                                  X1QJ0050
      COMMON /TADJ/ ADD                                                 X1QJ0060
      DO 12 I=J,K                                                       X1QJ0070
      IF (ADD) 11,11,10                                                 X1QJ0080
   10 Z(I) = X(I) - Y(I)                                                X1QJ0090
      GO TO 12                                                          X1QJ0100
   11 Z(I) = X(I) / Y(I)                                                X1QJ0110
   12 CONTINUE                                                          X1QJ0120
      RETURN                                                            X1QJ0130
      END                                                               X1QJ0140
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
C --- SUBROUTINE TO COMPUTE SI RATIOS FOR PART B (TABLES 4 AND 9)       X1QK0020
      SUBROUTINE SI (XSI,J,K,XSIT,ITER)                                 X1QK0030
      DIMENSION XSI(125), XSIT(125), WT(30)                             X1QK0040
      COMMON /EXTR/ XS(125), XI(125), XWT(125)                          X1QK0050
      COMMON /XYBK/ X(30), Y(30)                                        X1QK0060
      CALL QSF (XSI,XS,J,K,ITER)                                        X1QK0070
      CALL DIVSUB (XSI,XS,XI,J,K)                                       X1QK0080
      CALL XTRMES (XI,J,K,XWT)                                          X1QK0090
      L = J - 1                                                         X1QK0100
      DO 11 N=1,4                                                       X1QK0110
      L = L + 1                                                         X1QK0120
      M = 0                                                             X1QK0130
      DO 9 I=L,K,4                                                      X1QK0140
      M = M + 1                                                         X1QK0150
      WT(M) = XWT(I)                                                    X1QK0160
    9 X(M) = XSI(I)                                                     X1QK0170
      CALL REPLCE (X,Y,1,M,WT)                                          X1QK0180
      M = 0                                                             X1QK0190
      DO 10 I=L,K,4                                                     X1QK0200
      M = M + 1                                                         X1QK0210
   10 XSIT(I) = Y(M)                                                    X1QK0220
   11 CONTINUE                                                          X1QK0230
      DO 14 I=J,K                                                       X1QK0240
      IF (XSIT(I)-XSI(I)) 12,13,12                                      X1QK0250
   12 XSI(I) = XSIT(I)                                                  X1QK0260
      GO TO 14                                                          X1QK0270
   13 XSIT(I) = 9999999999.                                             X1QK0280
   14 CONTINUE                                                          X1QK0290
      RETURN                                                            X1QK0300
      END                                                               X1QK0310
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
C --- F-TEST SUBROUTINE                                                 X1QL0020
      SUBROUTINE FTEST (X,KB,KE,NR)                                     X1QL0030
      INTEGER ADD                                                       X1QL0040
      DIMENSION X(125)                                                  X1QL0050
      COMMON /TADJ/ ADD                                                 X1QL0060
      DATA BLANK,STAR /1H , 2H**/                                       X1QL0070
      DIV = 1.                                                          X1QL0080
      IF (ADD) 8,8,7                                                    X1QL0090
    7 DIV = 10000.                                                      X1QL0100
    8 T = 0.0                                                           X1QL0110
      CF = 0.0                                                          X1QL0120
      SSBQ = 0.0                                                        X1QL0130
      SST = 0.0                                                         X1QL0140
      DO 30 N=1,4                                                       X1QL0150
      T1 = 0.0                                                          X1QL0160
      SSQ = 0.0                                                         X1QL0170
      IST = N                                                           X1QL0180
      IF (KB-N) 13,13,11                                                X1QL0190
   11 IST = N + 4                                                       X1QL0200
   13 DO 16 I=IST,KE,4                                                  X1QL0210
      T1 = T1 + 1.0                                                     X1QL0220
      SSQ = SSQ + X(I)                                                  X1QL0230
   16 SST = SST + X(I) **2                                              X1QL0240
      SSBQ = SSBQ + SSQ*SSQ / T1                                        X1QL0250
      CF = CF + SSQ                                                     X1QL0260
   30 T = T + T1                                                        X1QL0270
      CF = CF * CF / T                                                  X1QL0280
      KDFBQ = 3                                                         X1QL0290
      KDFR = T - 4.0                                                    X1QL0300
      KDFT = T - 1.0                                                    X1QL0310
      SSBQ = (SSBQ - CF) / DIV                                          X1QL0320
      SST = (SST - CF) / DIV                                            X1QL0330
      SSR = SST - SSBQ                                                  X1QL0340
      QMS = SSBQ / 3.0                                                  X1QL0350
      CF = KDFR                                                         X1QL0360
      RMS = SSR / CF                                                    X1QL0370
      FRATIO = QMS / RMS                                                X1QL0380
      TEST = BLANK                                                      X1QL0390
      IF (FRATIO-4.20) 44,43,43                                         X1QL0400
   43 TEST = STAR                                                       X1QL0410
   44 WRITE (NR,104)SSBQ,KDFBQ,QMS,FRATIO,TEST,SSR,KDFR,RMS,SST,KDFT    X1QL0420
  104 FORMAT (35X, 23HSTABLE SEASONALITY TEST /                         X1QL0430
     1        43X, 27HSUM OF   DEGREES OF    MEAN /                     X1QL0440
     2        42X, 38HSQUARES    FREEDOM     SQUARE        F /          X1QL0450
     320X,16HBETWEEN QUARTERS, 4PF13.3,8X,I2,F12.3,0PF12.3,A2 /         X1QL0460
     4 20X, 8HRESIDUAL, 6X, 4PF15.3, I10, F12.3 /                       X1QL0470
     5 20X, 5HTOTAL, 9X, F15.3, I10 )                                   X1QL0480
      IF (TEST-STAR) 42,39,42                                           X1QL0490
   39 WRITE (NR,105)                                                    X1QL0500
  105 FORMAT (25X51H**STABLE SEASONALITY PRESENT AT THE 1 PERCENT LEVEL)X1QL0510
      RETURN                                                            X1QL0520
   42 WRITE (NR,106)                                                    X1QL0530
  106 FORMAT (25X,58H  NO EVIDENCE OF STABLE SEASONALITY AT THE 1 PERCENX1QL0540
     1T LEVEL)                                                          X1QL0550
      RETURN                                                            X1QL0560
      END                                                               X1QL0570
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
      SUBROUTINE CHART (NS,LS,MO,IBEG,IEND,A,B,C,LTAB)                  X1QM0020
      DIMENSION A(125), B(125), C(125), Y(12), DATE(4), T(5), SINAME(4) X1QM0030
      INTEGER ADD                                                       X1QM0040
      COMMON /TADJ/ ADD                                                 X1QM0050
      COMMON /RITE/ NR, NYEAR, TITLE(10), SERNO, KPAGE                  X1QM0060
      COMMON /LINE/ VAL(3), NX(112), LOG, NOSER, BIG, SMALL, KSCLE      X1QM0070
      DATA NEWPG /1H^/                                                  X1QM0080
      DATA (DATE(I),I=1,4) /3H1ST, 3H2ND, 3H3RD, 3H4TH/                 X1QM0090
      DATA (T(I),I=1,5) /6H QUAR., 6H  HALF, 6H   ONE, 6H   TWO,        X1QM0100
     1                   6H  FOUR/                                      X1QM0110
      DATA (SINAME(I),I=1,4) /6HRATIOS, 6HDIFFER, 1H , 5HENCES/         X1QM0120
      KEXT = 1                                                          X1QM0130
      NOSER =  NS                                                       X1QM0140
      LOG = LS                                                          X1QM0150
C --- WRITE CHART TITLE AND LEGEND                                      X1QM0160
      GO TO (40,45),MO                                                  X1QM0170
   40 KPAGE = KPAGE + 1                                                 X1QM0180
      WRITE (NR,1) NEWPG,(TITLE(I),I=1,10),KPAGE,SERNO,LTAB             X1QM0190
    1 FORMAT (A1,29X,10A6,8X,4HPAGE,I3,9H, SERIES ,A6/2H G,I2,7H. CHART)X1QM0200
      GO TO (41,42,42,43),LTAB                                          X1QM0210
   41 WRITE (NR,2)                                                      X1QM0220
    2 FORMAT (10X,41H(X)- D11.FINAL SEASONALLY ADJUSTED SERIES /        X1QM0230
     1        10X,26H(0)- D12.FINAL TREND-CYCLE )                       X1QM0240
      GO TO 44                                                          X1QM0250
   42 WRITE (NR,3) SINAME(ADD+1),SINAME(ADD+3),SINAME(ADD+1),SINAME(ADD+X1QM0260
     13)                                                                X1QM0270
    3 FORMAT (10X,18H(X)- D8. FINAL SI ,2A6,13HWITH EXTREMES /          X1QM0280
     1        10X,18H(0)- D9. FINAL SI ,2A6,16HWITHOUT EXTREMES /       X1QM0290
     2        10X,31H(+)- D10.FINAL SEASONAL FACTORS )                  X1QM0300
      GO TO 44                                                          X1QM0310
   43 WRITE (NR,4)                                                      X1QM0320
    4 FORMAT (10X,31H(X)- D13.FINAL IRREGULAR SERIES /                  X1QM0330
     1        10X,40H(0)- E3. FINAL MODIFIED IRREGULAR SERIES )         X1QM0340
   44 WRITE (NR,5)                                                      X1QM0350
    5 FORMAT (10X,26H(*)- COINCIDENCE OF POINTS)                        X1QM0360
C --- FIND LARGEST AND SMALLEST VALUES                                  X1QM0380
   45 BIG = A(IBEG)                                                     X1QM0390
      SMALL = A(IBEG)                                                   X1QM0400
      DO 59 I=IBEG,IEND                                                 X1QM0410
      DO 59 M=1,3                                                       X1QM0420
      GO TO (51,52,53),M                                                X1QM0430
   51 TEMP = A(I)                                                       X1QM0440
      GO TO 55                                                          X1QM0450
   52 TEMP = B(I)                                                       X1QM0460
      GO TO 55                                                          X1QM0470
   53 TEMP = C(I)                                                       X1QM0480
   55 IF (TEMP-BIG) 57,57,56                                            X1QM0490
   56 BIG = TEMP                                                        X1QM0500
   57 IF (TEMP-SMALL) 58,59,59                                          X1QM0510
   58 SMALL = TEMP                                                      X1QM0520
   59 CONTINUE                                                          X1QM0530
      SMALL = AINT(SMALL)                                               X1QM0540
      GO TO (70,60),LOG                                                 X1QM0550
C --- DETERMINE LOG SCALE                                               X1QM0560
   60 KVAL = BIG / SMALL                                                X1QM0570
      IF (KVAL-2) 81,61,61                                              X1QM0580
   61 IF (KVAL-4) 82,62,62                                              X1QM0590
   62 IF (KVAL-10) 83,63,63                                             X1QM0600
   63 IF (KVAL-100)84,84,85                                             X1QM0610
C --- ARITHMETIC SCALE                                                  X1QM0620
   70 KDIV = (BIG-SMALL) /11.0 + 1.0                                    X1QM0630
      DIV = KDIV                                                        X1QM0640
      Y(1) = SMALL                                                      X1QM0650
      BIG = SMALL                                                       X1QM0660
      DO 71 I=2,12                                                      X1QM0670
      BIG = BIG + DIV                                                   X1QM0680
   71 Y(I) = BIG                                                        X1QM0690
      GO TO (72,109),MO                                                 X1QM0700
   72 WRITE (NR,16)                                                     X1QM0710
      WRITE (NR,6) (Y(I),I=1,12)                                        X1QM0720
    6 FORMAT (12F10.0)                                                  X1QM0730
      WRITE (NR,7)                                                      X1QM0740
    7 FORMAT (8X1H.9X1H.9X1H.9X1H.9X1H.9X1H.9X1H.9X1H.9X1H.9X1H.9X1H.9X X1QM0750
     1 1H.)                                                             X1QM0760
      GO TO 102                                                         X1QM0770
   81 KSCLE = 1                                                         X1QM0780
      GO TO 86                                                          X1QM0790
   82 KSCLE = 2                                                         X1QM0800
      GO TO 86                                                          X1QM0810
   83 KSCLE = 3                                                         X1QM0820
      GO TO 86                                                          X1QM0830
   84 KSCLE = 4                                                         X1QM0840
      GO TO 86                                                          X1QM0850
   85 KSCLE = 5                                                         X1QM0860
   86 WRITE (NR,8) T(KSCLE)                                             X1QM0870
    8 FORMAT (4X,14HSCALE-SEMI LOG,2X,A6,6H CYCLE)                      X1QM0880
   87 WT = 1.0                                                          X1QM0890
      GO TO (90,92,94,96,98),KSCLE                                      X1QM0900
   90 DO 91 I=1,6                                                       X1QM0910
      Y(I) = SMALL * WT                                                 X1QM0920
   91 WT = WT + 0.2                                                     X1QM0930
      WRITE (NR,10) (Y(I),I=1,6)                                        X1QM0940
   10 FORMAT (4XF7.0,22XF7.0,18XF7.0,14XF7.0,12XF7.0,8XF7.0)            X1QM0950
      GO TO 100                                                         X1QM0960
   92 DO 93 I=1,7                                                       X1QM0970
      Y(I) = SMALL * WT                                                 X1QM0980
   93 WT = WT + 0.5                                                     X1QM0990
      WRITE (NR,11) (Y(I),I=1,7)                                        X1QM1000
   11 FORMAT (4XF7.0,25XF7.0,16XF7.0,11XF7.0,8XF7.0,5XF7.0,2XF7.0)      X1QM1010
      GO TO 100                                                         X1QM1020
   94 Y(1) = SMALL                                                      X1QM1030
      WT = 2.0                                                          X1QM1040
      DO 95 I=2,6                                                       X1QM1050
      Y(I) = SMALL * WT                                                 X1QM1060
   95 WT = WT + 2.0                                                     X1QM1070
      WRITE (NR,12) (Y(I),I=1,6)                                        X1QM1080
   12 FORMAT (4XF7.0,26XF7.0,27XF7.0,12XF7.0,7XF7.0,2XF7.0)             X1QM1090
      GO TO 100                                                         X1QM1100
   96 Y(1) = SMALL                                                      X1QM1110
      Y(2) = SMALL * 4.0                                                X1QM1120
      Y(3) = SMALL * 7.0                                                X1QM1130
      Y(4) = SMALL *10.0                                                X1QM1140
      Y(5) = SMALL *40.0                                                X1QM1150
      Y(6) = SMALL *70.0                                                X1QM1160
      Y(7) = SMALL *100.0                                               X1QM1170
      WRITE (NR,13) (Y(I),I=1,7)                                        X1QM1180
   13 FORMAT (4XF7.0,25XF7.0,7XF7.0,2XF7.0,26XF7.0,6XF7.0,1XF7.0)       X1QM1190
      GO TO 100                                                         X1QM1200
   98 DO 99 I=1,5                                                       X1QM1210
      Y(I) = SMALL * WT                                                 X1QM1220
   99 WT = 10.0 * WT                                                    X1QM1230
      WRITE (NR,14) (Y(I),I=1,5)                                        X1QM1240
   14 FORMAT (4XF7.0,20XF7.0,22XF7.0,20XF7.0,19XF7.0)                   X1QM1250
  100 GO TO (101,999),KEXT                                              X1QM1260
  101 KEXT = 2                                                          X1QM1270
C --- CHART IN CHRONOLOGICAL ORDER                                      X1QM1280
  102 LYR = NYEAR                                                       X1QM1290
      DO 104 I=IBEG,IEND                                                X1QM1291
      VAL(1) = A(I)                                                     X1QM1300
      VAL(2) = B(I)                                                     X1QM1310
      VAL(3) = C(I)                                                     X1QM1320
      CALL PLOT                                                         X1QM1330
      M = I - (I-1)/4*4                                                 X1QM1340
      IF (M-1) 104,103,104                                              X1QM1350
  103 IF (I-IBEG) 104,104,1031                                          X1QM1360
 1031 LYR = LYR + 1                                                     X1QM1361
  104 WRITE (NR,15) DATE(M),LYR,(NX(N),N=1,112)                         X1QM1370
   15 FORMAT (1X,A3,I2,2X,112A1)                                        X1QM1380
      GO TO (105,87),LOG                                                X1QM1390
  105 WRITE (NR,7)                                                      X1QM1400
      WRITE (NR,6) (Y(I),I=1,12)                                        X1QM1410
  999 RETURN                                                            X1QM1420
C --- QUARTERLY CHARTS                                                  X1QM1430
  109 DO 116 N=1,4                                                      X1QM1440
      KPAGE = KPAGE + 1                                                 X1QM1450
      WRITE (NR,1) NEWPG,(TITLE(I),I=1,10),KPAGE,SERNO,LTAB             X1QM1460
      WRITE (NR,3) SINAME(ADD+1),SINAME(ADD+3),SINAME(ADD+1),SINAME(ADD+X1QM1470
     13)                                                                X1QM1480
      WRITE (NR,5)                                                      X1QM1490
      WRITE (NR,16)                                                     X1QM1500
   16 FORMAT (4X16HSCALE-ARITHMETIC)                                    X1QM1510
      WRITE (NR,6) (Y(I),I=1,12)                                        X1QM1520
      WRITE (NR,7)                                                      X1QM1530
      WRITE (NR,17) DATE(N)                                             X1QM1540
   17 FORMAT (1X,A3,8H QUARTER)                                         X1QM1550
      LYR = NYEAR - 1                                                   X1QM1560
      IF (IBEG-N) 113,113,110                                           X1QM1570
  110 IF (IBEG-4) 111,111,112                                           X1QM1580
  111 LYR = LYR + 1                                                     X1QM1590
  112 IST = N + 4                                                       X1QM1600
      GO TO 114                                                         X1QM1610
  113 IST = N                                                           X1QM1620
  114 DO 115 I=IST,IEND,4                                               X1QM1630
      VAL(1) = A(I)                                                     X1QM1640
      VAL(2) = B(I)                                                     X1QM1650
      VAL(3) = C(I)                                                     X1QM1660
      CALL PLOT                                                         X1QM1670
      LYR = LYR + 1                                                     X1QM1680
  115 WRITE (NR,18) LYR,(NX(L),L=1,112)                                 X1QM1690
   18 FORMAT (4H  19,I2,2X,112A1)                                       X1QM1700
      WRITE (NR,7)                                                      X1QM1710
  116 WRITE (NR,6) (Y(I),I=1,12)                                        X1QM1720
      RETURN                                                            X1QM1730
      END                                                               X1QM1740
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
      SUBROUTINE PLOT                                                   X1QN0020
      DIMENSION KPOINT(3), CYCLE(5)                                     X1QN0030
      COMMON /LINE/ VAL(3), NX(112), LOG, NOSER, BIG, SMALL, KSCLE      X1QN0040
      DATA NLETX,NAST,NLETO,NBLANK,NDOT,NPLUS /1HX,1H*,1HO,1H ,1H.,1H+/ X1QN0050
      DATA (CYCLE(I),I=1,5) /.30103, .60206, 1.0, 2.0, 4.0/             X1QN0060
      DO 100 N=1,112                                                    X1QN0070
  100 NX(N) = NBLANK                                                    X1QN0080
      GO TO (102,101),LOG                                               X1QN0090
  101 NX(1  ) = NDOT                                                    X1QN0100
      NX(112) = NDOT                                                    X1QN0110
      GO TO (200,300,400,500,600),KSCLE                                 X1QN0120
  200 NX(30 ) = NDOT                                                    X1QN0130
      NX(55 ) = NDOT                                                    X1QN0140
      NX(76 ) = NDOT                                                    X1QN0150
      NX(95 ) = NDOT                                                    X1QN0160
      GO TO 102                                                         X1QN0170
  300 NX(33 ) = NDOT                                                    X1QN0180
      NX(56 ) = NDOT                                                    X1QN0190
      NX(74 ) = NDOT                                                    X1QN0200
      NX(89 ) = NDOT                                                    X1QN0210
      NX(101) = NDOT                                                    X1QN0220
      GO TO 102                                                         X1QN0230
  400 NX(34 ) = NDOT                                                    X1QN0240
      NX(68 ) = NDOT                                                    X1QN0250
      NX(87 ) = NDOT                                                    X1QN0260
      NX(101) = NDOT                                                    X1QN0270
      GO TO 102                                                         X1QN0280
  500 NX(33 ) = NDOT                                                    X1QN0290
      NX(47 ) = NDOT                                                    X1QN0300
      NX(56 ) = NDOT                                                    X1QN0310
      NX(89 ) = NDOT                                                    X1QN0320
      NX(103) = NDOT                                                    X1QN0330
      GO TO 102                                                         X1QN0340
  600 NX(28 ) = NDOT                                                    X1QN0350
      NX(57 ) = NDOT                                                    X1QN0360
      NX(84 ) = NDOT                                                    X1QN0370
  102 DO 107 M=1,3                                                      X1QN0380
      IF (VAL(M)-BIG) 104,104,103                                       X1QN0390
  103 VAL(M) = BIG                                                      X1QN0400
  104 GO TO (105,106),LOG                                               X1QN0410
  105 KPOINT(M) = (VAL(M)-SMALL) / (BIG-SMALL) * 111.0 + 1.5            X1QN0420
      GO TO 107                                                         X1QN0430
  106 KPOINT(M) = ALOG10(VAL(M)/SMALL) / CYCLE(KSCLE) * 111.0 + 1.5     X1QN0440
  107 CONTINUE                                                          X1QN0450
      NA = KPOINT(1)                                                    X1QN0460
      NB = KPOINT(2)                                                    X1QN0470
      NC = KPOINT(3)                                                    X1QN0480
      NX(NC) = NPLUS                                                    X1QN0490
      NX(NA) = NLETX                                                    X1QN0500
      NX(NB) = NLETO                                                    X1QN0510
      IF (NA-NB) 109,108,109                                            X1QN0520
  108 NX(NA) = NAST                                                     X1QN0530
  109 IF (NOSER-2) 110,114,110                                          X1QN0540
  110 IF (NA-NC) 112,111,112                                            X1QN0550
  111 NX(NA) = NAST                                                     X1QN0560
  112 IF (NB-NC) 114,113,114                                            X1QN0570
  113 NX(NB) = NAST                                                     X1QN0580
  114 RETURN                                                            X1QN0590
      END                                                               X1QN0600
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
H  U2551503641  1020 SHORT-TERM BANK BALANCES, U. S. CAPITAL, MIL. OF $ 10/10/66
00004900004900004900020900020900020900030400030400030400034900034900034950  U255
00021300021300021300022900022900022900016000016000016000027300027300027351  U255
00023600023600023600023300023300023300018800018800018800023600023600023652  U255
00019200019200019200010600010600010600014600014600014600020000020000020053  U255
00017200017200017200030400030400030400041600041600041600039600039600039654  U255
00017900017900017900028500028500028500015500015500015500034300034300034355  U255
00017600017600017600030900030900030900029500029500029500040600040600040656  U255
00042500042500042500023300023300023300015100015100015100023700023700023757  U255
00028300028300028300037300037300037300029400029400029400020200020200020258  U255
00008700008700008700022200022200022200013100013100013100041700041700041759  U255
00030400030400030400023600023600023600061900061900061900063600063600063660  U255
00055600055600055600035900035900035900021300021300021300079700079700079761  U255
00045500045500045500004100004100004100009400009400009400053400053400053462  U255
00012300012300012300050200050200050200017400017400017400069100069100069163  U255
000609000609000609000731000731000731000112000112000112                  64  U255
Z                                                                               
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
C                                                                       DFNA0020
C     VARIABLE SPAN DIFFUSION INDEX PROGRAM                             DFNA0030
C     U.S. BUREAU OF THE CENSUS                                         DFNA0040
C     ECONOMIC RESEARCH AND ANALYSIS DIVISION                           DFNA0050
C     WRITTEN BY NORMAN BAKKA                                           DFNA0060
C     DECEMBER 1, 1965                                                  DFNA0070
C                                                                       DFNA0080
      REAL LOW, IBAR(11), NRISE(250)                                    DFNA0090
      DIMENSION X(250), INPUT(250), NOSER(250), XCI(250),               DFNA0100
     1          XC(250), XI(250), XMCD(250),                            DFNA0110
     2          RISE(12,250), SUMSER(12,250),                           DFNA0120
     3          WMCD(11), SP15(120), IVS(99), SERID(24), NSPAN(13),     DFNA0130
     4          Y(12), CIBAR(11), CBAR(11), RATIO(11)                   DFNA0140
      COMMON /OUTPUT/ LR,TITLE(14),KPAGE,SERIES,INVT,N,LYEAR,CONST,NP   DFNA0150
      COMMON /WEIGHT/ SWT(20),NT,SERNO                                  DFNA0160
      EQUIVALENCE (XC,XI,XMCD),(NRISE,X),(NOSER,INPUT)                  DFNA0170
      DATA NR,NEWPG,ZEND /5, 1H^, 6HZZZZZZ/                             DFNA0180
      DATA (WMCD(I),I=1,11) /11*1.0/                                    DFNA0190
C --- WEIGHTS FOR 15-TERM SPENCER MOVING AVERAGE                        DFNA0200
      DATA (SP15(I),I=1,60) /                                           DFNA0210
     1  .327, .305, .240, .162, .009,-.016,-.019,-.009,                 DFNA0220
     2  .000, .000, .000, .000, .000, .000, .000,                       DFNA0230
     3  .253, .275, .253, .188, .066, .009,-.016,-.019,                 DFNA0240
     4 -.009, .000, .000, .000, .000, .000, .000,                       DFNA0250
     5  .152, .217, .239, .217, .144, .066, .009,-.016,                 DFNA0260
     6 -.019,-.009, .000, .000, .000, .000, .000,                       DFNA0270
     7  .057, .135, .201, .223, .209, .144, .066, .009,                 DFNA0280
     8 -.016,-.019,-.009, .000, .000, .000, .000/                       DFNA0290
      DATA (SP15(I),I=61,120)/                                          DFNA0300
     9 -.002, .055, .133, .198, .231, .209, .144, .066,                 DFNA0310
     1  .009,-.016,-.019,-.009, .000, .000, .000,                       DFNA0320
     1 -.023, .002, .059, .137, .209, .231, .209, .144,                 DFNA0330
     2  .066, .009,-.016,-.019,-.009, .000, .000,                       DFNA0340
     3 -.021,-.018, .007, .063, .144, .209, .231, .209,                 DFNA0350
     4  .144, .066, .009,-.016,-.019,-.009, .000,                       DFNA0360
     5 -.009,-.019,-.016, .009, .066, .144, .209, .231,                 DFNA0370
     6  .209, .144, .066, .009,-.016,-.019,-.009 /                      DFNA0380
      LR = 10                                                           DFNA0390
      NP = NEWPG                                                        DFNA0400
C --- INTIALIZE                                                         DFNA0410
 1111 LBEG = 999                                                        DFNA0420
      MEND = 0                                                          DFNA0430
      KERR = 1                                                          DFNA0440
      KPAGE = 0                                                         DFNA0450
      KOUNT = 0                                                         DFNA0460
      DO 100 J =1,12                                                    DFNA0470
      DO 100 I=1,250                                                    DFNA0480
      RISE(J,I) =0.0                                                    DFNA0490
  100 SUMSER(J,I) = 0.0                                                 DFNA0500
C --- READ TITLE CARD                                                   DFNA0510
      READ (NR,1) (TITLE(I),I=1,14)                                     DFNA0520
    1 FORMAT (13A6,A2)                                                  DFNA0530
      WRITE (LR,11) NEWPG, (TITLE(I),I=1,14)                            DFNA0540
   11 FORMAT (A1,20X,14A6)                                              DFNA0550
C --- IF 1ST WORD IS -ZZZZZZ- ,END OF JOB                               DFNA0560
      IF (TITLE(1)-ZEND) 102,101,102                                    DFNA0570
  101 WRITE (LR,2)                                                      DFNA0580
    2 FORMAT (1X,10HEND OF JOB)                                         DFNA0590
      REWIND LR                                                         DFNA0600
      REWIND NR                                                         DFNA0610
      STOP                                                              DFNA0620
C --- READ OPTION CARD                                                  DFNA0630
  102 READ (NR,3) NSER,LYEAR,NCUM,CONST,HIGH                            DFNA0640
    3 FORMAT (2I2,I1,F5.0,F4.3)                                         DFNA0650
      IF (NSER) 901,901,103                                             DFNA0660
  103 IF (LYEAR) 902,902,104                                            DFNA0670
  104 IF (HIGH) 105,105,106                                             DFNA0680
  105 HIGH = .05                                                        DFNA0690
  106 LOW = -HIGH                                                       DFNA0700
C --- READ INVERTED COMPONENTS CARD(S)                                  DFNA0710
      READ (NR,4) (IVS(I),I=1,NSER)                                     DFNA0720
    4 FORMAT (80I1)                                                     DFNA0730
C --- READ CARDS CONTAINING OUTPUT SERIES NUMBERS                       DFNA0740
      READ (NR,5)(SERID(I),I=1,24)                                      DFNA0750
    5 FORMAT (12A6)                                                     DFNA0760
C --- READ CARD CONTAINING SPANS TO BE USED                             DFNA0770
  107 READ (NR,6) NOP,(NSPAN(I),I=1,13),NT,NWT                          DFNA0780
    6 FORMAT (16I2)                                                     DFNA0790
C --- DETERMINE NUMBER OF SPANS TO BE USED                              DFNA0800
      DO 110 I=1,13                                                     DFNA0810
      IF (NSPAN(I)) 111,111,110                                         DFNA0820
  110 CONTINUE                                                          DFNA0830
C                                                                       DFNA0840
  111 KSPANS = I - 1                                                    DFNA0850
      IF (KSPANS) 903,903,115                                           DFNA0860
C --- IF NWT=1,READ WEIGHT CARDS                                        DFNA0870
  115 IF (NWT) 117,117,116                                              DFNA0880
  116 READ (NR,7) (SWT(I),I=1,NT)                                       DFNA0890
    7 FORMAT (F6.5)                                                     DFNA0900
      GO TO 120                                                         DFNA0910
C                                                                       DFNA0920
  117 IF (NT) 120,120,118                                               DFNA0930
  118 DO 119 I=1,NT                                                     DFNA0940
  119 SWT(I) = 1.0                                                      DFNA0950
C ---                                                                   DFNA0960
  120 IF (NOP) 121,121,122                                              DFNA0970
C     USE SPANS FOR ONE COMPONENT ONLY                                  DFNA0980
  121 NOP = 1                                                           DFNA0990
      GO TO 125                                                         DFNA1000
C     USE SPANS FOR ALL COMPONENT SERIES                                DFNA1010
  122 NOP = 2                                                           DFNA1020
C --- WRITE TITLE PAGE                                                  DFNA1030
  125 WRITE (LR,8) NSER                                                 DFNA1040
    8 FORMAT (50X,I3,11H COMPONENTS/                                    DFNA1050
     1 59X,14H SERIES NUMBER / 45X,31H SPAN     DIFFUSION   CUMULATED)  DFNA1060
      DO 126 I=1,KSPANS                                                 DFNA1070
  126 WRITE (LR,9) NSPAN(I), SERID(I), SERID(I+12)                      DFNA1080
    9 FORMAT (47X,I2,3H MO,3X,A6,6X,A6)                                 DFNA1090
C --- READ DATA CARDS                                                   DFNA1100
C                                                                       DFNA1110
C --- READ FIRST CARD OF SERIES                                         DFNA1120
  200 KOUNT = KOUNT + 1                                                 DFNA1130
      READ (NR,10) (Y(I),I=1,12),JYEAR,SERNO                            DFNA1140
   10 FORMAT (12F6.0,I2,A6)                                             DFNA1150
      IF (LYEAR-JYEAR) 201,201,905                                      DFNA1160
  201 DO 202 I=1,12                                                     DFNA1170
      IF (Y(I)) 203,202,203                                             DFNA1180
  202 CONTINUE                                                          DFNA1190
  203 L = I + 12*(JYEAR-LYEAR)                                          DFNA1200
      L1 = L-1                                                          DFNA1210
      DO 204 J=I,12                                                     DFNA1220
      L1 = L1 + 1                                                       DFNA1230
  204 X(L1) = Y(J)                                                      DFNA1240
      M = L1 - 11                                                       DFNA1250
C --- READ NEXT CARD                                                    DFNA1260
  210 M = M + 12                                                        DFNA1270
      N = M + 11                                                        DFNA1280
      READ (NR,10) (X(I),I=M,N),KYEAR,SERIE                             DFNA1290
C --- TEST FOR LAST CARD OF SERIES                                      DFNA1300
      DO 211 I=M,N                                                      DFNA1310
      IF (X(I)) 211,220,211                                             DFNA1320
  211 CONTINUE                                                          DFNA1330
C --- EDIT DATA CARD FOR CORRECT SERIES NUMBER                          DFNA1340
      IF (SERNO - SERIE) 906,212,906                                    DFNA1350
C --- EDIT DATA CARD FOR CORRECT DATA SEQUENCE                          DFNA1360
  212 JYEAR = JYEAR + 1                                                 DFNA1370
      IF (JYEAR-KYEAR) 907,210,907                                      DFNA1380
C --- WRITE INPUT SERIES                                                DFNA1390
  220 INVT = IVS(KOUNT)                                                 DFNA1400
      M = I - 1                                                         DFNA1410
      DO 219 I=L,M                                                      DFNA1420
  219 INPUT(I) = X(I)                                                   DFNA1430
      CALL WRITI (INPUT,L,M,1)                                          DFNA1440
C --- TAKE MOVING AVERAGE OF INPUT SERIES, IF CALLED FOR                DFNA1450
      IF (NT) 223,223,221                                               DFNA1460
  221 CALL MOVAVE (X,XCI,L,M,SWT,NT,0)                                  DFNA1470
      L = L + NT/2                                                      DFNA1480
      M = M - (NT-1)/2                                                  DFNA1490
      DO 222 I=L,M                                                      DFNA1500
      INPUT(I) = XCI(I) + 0.5                                           DFNA1510
  222 X(I) = INPUT(I)                                                   DFNA1520
      CALL WRITI (INPUT,L,M,3)                                          DFNA1530
C --- FIND DIRECTION OF CHANGE                                          DFNA1540
C       FOR EACH SPAN                                                   DFNA1550
  223 DO 340 J=1,KSPANS                                                 DFNA1560
      N = NSPAN(J)                                                      DFNA1570
      L1   = L + (N+1) /2                                               DFNA1580
      M1   = M - N/2                                                    DFNA1590
C       FOR EACH MONTH-TO-MONTH                                         DFNA1600
      DO 340I=L1,M1                                                     DFNA1610
      K = I + N/2                                                       DFNA1620
      K1 = K - N                                                        DFNA1630
      TESTX = (200.*(X(K)-X(K1))) /(ABS(X(K)) + ABS(X(K1)))             DFNA1640
      IF (TESTX-HIGH) 330,330,332                                       DFNA1650
  330 IF (TESTX-LOW) 334,331,331                                        DFNA1660
  331 RISE(J,I) = RISE(J,I) + 0.5                                       DFNA1670
      GO TO 340                                                         DFNA1680
  332 IF (INVT) 333,333,340                                             DFNA1690
  333 RISE(J,I) = RISE(J,I) + 1.0                                       DFNA1700
      GO TO 340                                                         DFNA1710
  334 IF (INVT) 340,340,333                                             DFNA1720
  340 SUMSER(J,I) = SUMSER(J,I) + 1.0                                   DFNA1730
C --- FIND LATEST ANY ONE INPUT SERIES BEGINS                           DFNA1740
      IF (M-MEND) 342,342,341                                           DFNA1750
  341 MEND = M                                                          DFNA1760
C --- FIND EARLIEST ANY ONE INPUT SERIES BEGINS                         DFNA1770
  342 IF (L-LBEG) 343,344,344                                           DFNA1780
  343 LBEG = L                                                          DFNA1790
C --- TEST FOR MORE INPUT SERIES                                        DFNA1800
  344 IF (KOUNT-NSER) 345,346,346                                       DFNA1810
  345 GO TO (107,200),NOP                                               DFNA1820
  346 GO TO (350,1111),KERR                                             DFNA1830
C                                                                       DFNA1840
C --- FIRST SELECTED SPAN                                               DFNA1850
C                                                                       DFNA1860
  350 J = 1                                                             DFNA1870
C --- COMPUTE PERCENT OF SERIES RISING                                  DFNA1880
 2222 L = LBEG + (NSPAN(J)+1) /2                                        DFNA1890
      M = MEND - NSPAN(J)/2                                             DFNA1900
      N = NSPAN(J)                                                      DFNA1910
      DO 353 I=L,M                                                      DFNA1920
      NRISE(I) = RISE(J,I)                                              DFNA1930
      NOSER(I) = SUMSER(J,I)                                            DFNA1940
  353 XCI(I) = RISE(J,I) *100.0 / SUMSER(J,I)                           DFNA1950
      CALL ROUND (XCI,L,M)                                              DFNA1960
      SERIES = SERID(J)                                                 DFNA1970
      CALL WRITR (XCI,L,M,1,1)                                          DFNA1980
      CALL WRITR (NRISE,L,M,6,1)                                        DFNA1990
      CALL WRITI (NOSER,L,M,2)                                          DFNA2000
C --- CUMULATE THE DIFFUSION INDEX                                      DFNA2010
      X(L-1) = CONST                                                    DFNA2020
      DO 355 I=L,M                                                      DFNA2030
  355 X(I) = XCI(I) - 50.0 + X(I-1)                                     DFNA2040
      NPT = 1                                                           DFNA2050
 3333 CALL AVEC (XCI,L,M,CIBAR)                                         DFNA2060
      CALL AVEDUR(XCI,L,M,ADRCI)                                        DFNA2070
C --- WEIGHTED 15-MONTH MOVING AVERAGE - TREND-CYCLE COMPONENT          DFNA2080
      CALL MOVAVE (XCI,XC,L,M,SP15,15,7)                                DFNA2090
      CALL ROUND (XC,L,M)                                               DFNA2100
      CALL AVEC (XC,L,M,CBAR)                                           DFNA2110
      CALL AVEDUR (XC,L,M,ADRC)                                         DFNA2120
      CALL WRITR (XC,L,M,2,NPT)                                         DFNA2130
C --- SUBTRACT CYCLICAL FROM CYCLICAL-IRREGULAR COMPONENT - IRREGULAR   DFNA2140
      DO 360 I=L,M                                                      DFNA2150
  360 XI(I) = XCI(I) - XC(I)                                            DFNA2160
      CALL AVEC (XI,L,M,IBAR)                                           DFNA2170
      CALL AVEDUR (XI,L,M,ADRI)                                         DFNA2180
      CALL WRITR (XI,L,M,3,NPT)                                         DFNA2190
C --- COMPUTE MCD                                                       DFNA2200
      DO 361 I=1,11                                                     DFNA2210
  361 RATIO(I) = IBAR(I) / CBAR(I)                                      DFNA2220
C --- COMPUTE MCD MOVING AVERAGE                                        DFNA2230
      DO 362 I=1,11                                                     DFNA2240
      K = 12 - I                                                        DFNA2250
      IF (RATIO(K)-.995) 362,363,363                                    DFNA2260
  362 CONTINUE                                                          DFNA2270
      MCD = 1                                                           DFNA2280
      ADRMCD = ADRCI                                                    DFNA2290
      GO TO 390                                                         DFNA2300
  363 IF(K-8) 364,368,366                                               DFNA2310
  364 IF(K-6) 365,368,367                                               DFNA2320
  365 IF(K-4) 368,368,367                                               DFNA2330
  366 MCD = 11                                                          DFNA2340
      GO TO 380                                                         DFNA2350
  367 MCD = K + 1                                                       DFNA2360
  368 MCD = K + 1                                                       DFNA2370
  380 CALL MOVAVE (XCI,XMCD,L,M,WMCD,MCD,0)                             DFNA2380
      L1 = L + MCD/2                                                    DFNA2390
      M1 = M - (MCD-1)/2                                                DFNA2400
      CALL ROUND (XMCD,L1,M1)                                           DFNA2410
      CALL AVEDUR (XMCD,L1,M1,ADRMCD)                                   DFNA2420
      CALL WRITR (XMCD,L1,M1,4,NPT)                                     DFNA2430
C --- WRITE OUT SUMMARY MEASURES TABLE                                  DFNA2440
  390 CALL WRITR (0,0,0,5,NPT)                                          DFNA2450
      WRITE (LR,20) (CIBAR(I),I=1,11),(CBAR(I),I=1,11),(IBAR(I),I=1,11),DFNA2460
     1 (RATIO(I),I=1,11),MCD,ADRCI,ADRC,ADRI,ADRMCD                     DFNA2470
   20 FORMAT (29X1H18X1H28X1H38X1H48X1H58X1H68X1H78X1H88X1H97X2H107X2H11DFNA2480
     1 /6X6HCI-BAR9X11(3XF6.2)/7X5HC-BAR9X11(3XF6.2)/7X5HI-BAR9X        DFNA2490
     2 11(3XF6.2)/7X14HI-BAR / C-BAR 11(3XF6.2)/                        DFNA2500
     3 13X29HMONTHS FOR CYCLICAL DOMINANCE I4/                          DFNA2510
     4 13X23HAVERAGE DURATION OF RUN/32X2HCI10X1HC10X1HI8X3HMCD/        DFNA2520
     5 23X4(6XF5.2))                                                    DFNA2530
      GO TO (400,500),NPT                                               DFNA2540
C --- WRITE CUMULATED INDEX                                             DFNA2550
  400 SERIES = SERID(J+12)                                              DFNA2560
      CALL WRITR (X,L,M,1,2)                                            DFNA2570
      IF (NCUM) 401,500,401                                             DFNA2580
  401 DO 402 I=L,M                                                      DFNA2590
  402 XCI(I) = X(I)                                                     DFNA2600
      NPT = 2                                                           DFNA2610
      GO TO 3333                                                        DFNA2620
C --- NEXT SPAN FOR DIFFUSION INDEX                                     DFNA2630
  500 J = J + 1                                                         DFNA2640
      IF (J-KSPANS) 2222,2222,1111                                      DFNA2650
C --- EDIT FAILURES                                                     DFNA2660
  901 WRITE (LR,30) NSER                                                DFNA2670
   30 FORMAT (17H RUN TERMINATED, I2,49H IS NOT MEANINGFUL FOR NUMBER OFDFNA2680
     1 COMPONENT SERIES)                                                DFNA2690
      GO TO 101                                                         DFNA2700
  902 WRITE (LR,31) LYEAR                                               DFNA2710
   31 FORMAT (17H RUN TERMINATED, I2,38H IS SPECIFIED AS EARLIEST YEAR ODFNA2720
     1F DATA)                                                           DFNA2730
      GO TO 101                                                         DFNA2740
  903 WRITE (LR,32)                                                     DFNA2750
   32 FORMAT (58H RUN TERMINATED, A ZERO OR NEGATIVE SPAN IS NOT ACCEPTADFNA2760
     1BLE)                                                              DFNA2770
      GO TO 101                                                         DFNA2780
  905 WRITE (LR,33) SERNO,LYEAR                                         DFNA2790
   33 FORMAT (24H RUN TERMINATED, SERIES A6,17H BEGINS BEFORE 19,I2)    DFNA2800
      GO TO 101                                                         DFNA2810
  906 WRITE (LR,34)                                                     DFNA2820
   34 FORMAT (68H SERIES NUMBER ERROR, RUN WILL BE TERMINATED UPON COMPLDFNA2830
     1ETION OF EDIT)                                                    DFNA2840
      KERR = 2                                                          DFNA2850
      GO TO 212                                                         DFNA2860
  907 WRITE (LR,35)                                                     DFNA2870
   35 FORMAT (68H DATE SEQUENCE ERROR, RUN WILL BE TERMINATED UPON COMPLDFNA2880
     1ETION OF EDIT)                                                    DFNA2890
      KERR = 2                                                          DFNA2900
      GO TO 210                                                         DFNA2910
      END                                                               DFNA2920
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
C --- SUBROUTINE TO WRITE OUTPUT TABLES OF INTEGER NUMBERS              DFNB0020
      SUBROUTINE WRITI (KARRY,J,K,LTAB)                                 DFNB0030
      DIMENSION KARRY(250), INVERT(4)                                   DFNB0040
      COMMON /OUTPUT/ LR,TITLE(14),KPAGE,SERIES,INVT,N,KYR1,CONST,NP    DFNB0050
      COMMON /WEIGHT/ SWT(20),NT,SERNO                                  DFNB0060
      DATA (INVERT(I),I=1,4) /1H , 6HINVERT, 1H , 2HED/                 DFNB0070
      KPAGE = KPAGE + 1                                                 DFNB0080
      GO TO (8,9,8),LTAB                                                DFNB0090
    8 SERIES = SERNO                                                    DFNB0100
    9 WRITE (LR,1) NP, (TITLE(I),I=1,14), KPAGE, SERIES                 DFNB0110
    1 FORMAT (A1,10X,14A6,17X,4HPAGE,I4 / 107X,7HSERIES ,A6)            DFNB0120
      GO TO (10,11,12),LTAB                                             DFNB0130
   10 WRITE (LR,2) INVERT(INVT+1),INVERT(INVT+3)                        DFNB0140
    2 FORMAT (4X, 9HCOMPONENT, 12X, 2A6)                                DFNB0150
      GO TO 15                                                          DFNB0160
   11 WRITE (LR,3) N                                                    DFNB0170
    3 FORMAT (25H 1B NUMBER OF SERIES USED,30X,I2,8H MO SPAN)           DFNB0180
      GO TO 15                                                          DFNB0190
   12 WRITE (LR,6) NT,(SWT(I),I=1,NT)                                   DFNB0200
    6 FORMAT (4X,I2,34H-MONTH MOVING AVERAGE OF COMPONENT/              DFNB0210
     1        4X,16HWEIGHTS APPLIED ,10F10.5 / 10F10.5)                 DFNB0220
   15 WRITE (LR,4)                                                      DFNB0230
    4 FORMAT (105H    YEAR      JAN     FEB     MAR     APR     MAY     DFNB0240
     1JUN     JUL     AUG     SEP     OCT     NOV     DEC)              DFNB0250
      NYEAR = KYR1                                                      DFNB0260
      DO 22 I=1,250                                                     DFNB0270
      IF (I-J) 21,20,20                                                 DFNB0280
   20 IF (I-K) 22,22,21                                                 DFNB0290
   21 KARRY(I) = 9999999                                                DFNB0300
   22 CONTINUE                                                          DFNB0310
      M = 1                                                             DFNB0320
   23 M1 = M + 11                                                       DFNB0330
      WRITE (LR,5) NYEAR, (KARRY(I),I=M,M1)                             DFNB0340
    5 FORMAT (6H    19,I2,2X,12(2X,I6))                                 DFNB0350
      IF (M1-K) 24,99,99                                                DFNB0360
   24 M = M + 12                                                        DFNB0370
      NYEAR = NYEAR + 1                                                 DFNB0380
      GO TO 23                                                          DFNB0390
   99 RETURN                                                            DFNB0400
      END                                                               DFNB0410
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
C --- SUBROUTINE TO WRITE OUTPUT TABLES OF REAL NUMBERS                 DFNC0020
      SUBROUTINE WRITR (ARRAY,J,K,LTAB,NPT)                             DFNC0030
      DIMENSION ARRAY(250)                                              DFNC0040
      COMMON /OUTPUT/ LR,TITLE(14),KPAGE,SERIES,INVT,N,KYR1,CONST,NP    DFNC0050
      KPAGE = KPAGE + 1                                                 DFNC0060
      WRITE (LR,1) NP, (TITLE(I),I=1,14), KPAGE, SERIES                 DFNC0070
    1 FORMAT (A1,10X,14A6,17X,4HPAGE,I4  / 107X,7HSERIES ,A6)           DFNC0080
      GO TO (20,30),NPT                                                 DFNC0090
   20 GO TO (21,22,23,24,25,26),LTAB                                    DFNC0100
   21 WRITE (LR,2) N                                                    DFNC0110
    2 FORMAT (19H 1  DIFFUSION INDEX,36X,I2,8H MO SPAN)                 DFNC0120
      GO TO 50                                                          DFNC0130
   22 WRITE (LR,3) N                                                    DFNC0140
    3 FORMAT (52H 2  WEIGHTED 15-MO MOVING AVERAGE OF DIFFUSION INDEX,  DFNC0150
     1        3X,I2,8H MO SPAN)                                         DFNC0160
      GO TO 50                                                          DFNC0170
   23 WRITE (LR,4) N                                                    DFNC0180
    4 FORMAT (42H 3  IRREGULAR COMPONENT OF DIFFUSION INDEX,13X,I2,     DFNC0190
     1        8H MO SPAN)                                               DFNC0200
      GO TO 50                                                          DFNC0210
   24 WRITE (LR,5) N                                                    DFNC0220
    5 FORMAT (41H 4  MCD MOVING AVERAGE OF DIFFUSION INDEX,14X,I2,      DFNC0230
     1        8H MO SPAN)                                               DFNC0240
      GO TO 50                                                          DFNC0250
   25 WRITE (LR,6) N                                                    DFNC0260
    6 FORMAT (39H 5  SUMMARY MEASURES OF DIFFUSION INDEX,16X,I2,        DFNC0270
     1        8H MO SPAN)                                               DFNC0280
      RETURN                                                            DFNC0290
   26 WRITE (LR,7) N                                                    DFNC0300
    7 FORMAT (27H 1A NUMBER OF SERIES RISING,28X,I2,8H MO SPAN)         DFNC0310
      GO TO 50                                                          DFNC0320
   30 GO TO (31,32,33,34,35),LTAB                                       DFNC0330
   31 WRITE (LR,11) CONST,N                                             DFNC0340
   11 FORMAT (44H 1  CUMULATED DIFFUSION INDEX-CONSTANT ADDED,F8.1,3X,  DFNC0350
     1 I2,8H MO SPAN)                                                   DFNC0360
      GO TO 50                                                          DFNC0370
   32 WRITE (LR,12) N                                                   DFNC0380
   12 FORMAT (52H 2  WEIGHTED 15-MO MOVING AVERAGE OF CUMULATED INDEX,  DFNC0390
     1 3X,I2,8H MO SPAN)                                                DFNC0400
      GO TO 50                                                          DFNC0410
   33 WRITE (LR,13) N                                                   DFNC0420
   13 FORMAT (52H 3  IRREGULAR COMPONENT OF CUMULATED DIFFUSION INDEX,  DFNC0430
     1 3X,I2,8H MO SPAN)                                                DFNC0440
      GO TO 50                                                          DFNC0450
   34 WRITE (LR,14) N                                                   DFNC0460
   14 FORMAT (51H 4  MCD MOVING AVERAGE OF CUMULATED DIFFUSION INDEX,   DFNC0470
     1 4X,I2,8H MO SPAN)                                                DFNC0480
      GO TO 50                                                          DFNC0490
   35 WRITE (LR,15) N                                                   DFNC0500
   15 FORMAT (49H 5  SUMMARY MEASURES OF CUMULATED DIFFUSION INDEX,     DFNC0510
     1 6X,I2,8H MO SPAN)                                                DFNC0520
      RETURN                                                            DFNC0530
   50 WRITE (LR,16)                                                     DFNC0540
   16 FORMAT (105H    YEAR      JAN     FEB     MAR     APR     MAY     DFNC0550
     1JUN     JUL     AUG     SEP     OCT     NOV     DEC)              DFNC0560
      NYEAR = KYR1                                                      DFNC0570
      DO 53 I=1,250                                                     DFNC0580
      IF (I-J) 52,51,51                                                 DFNC0590
   51 IF (I-K) 53,53,52                                                 DFNC0600
   52 ARRAY(I) = 999999999.0                                            DFNC0610
   53 CONTINUE                                                          DFNC0620
      M = 1                                                             DFNC0630
   54 M1 = M + 11                                                       DFNC0640
      WRITE (LR,17) NYEAR, (ARRAY(I),I=M,M1)                            DFNC0650
   17 FORMAT (6H    19,I2,2X,12(1X,F7.1))                               DFNC0660
      IF (M1-K) 55,99,99                                                DFNC0670
   55 M = M + 12                                                        DFNC0680
      NYEAR = NYEAR + 1                                                 DFNC0690
      GO TO 54                                                          DFNC0700
   99 RETURN                                                            DFNC0710
      END                                                               DFNC0720
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
C --- MOVING AVERAGE SUBROUTINE                                         DFND0020
      SUBROUTINE MOVAVE (X,Y,J,K,WT,NTRMS,NENDT)                        DFND0030
      DIMENSION X(250), Y(250), WT(120)                                 DFND0040
      IF (NENDT) 5,5,1                                                  DFND0050
    1 DO  3 N=1,NENDT                                                   DFND0060
      SUMWT = 0.0                                                       DFND0070
      TEMP1 = 0.0                                                       DFND0080
      TEMP2 = 0.0                                                       DFND0090
      DO 2 I=1,NTRMS                                                    DFND0100
      KWT = N * NTRMS - NTRMS + I                                       DFND0110
      KTRM1 = J + I - 1                                                 DFND0120
      KTRM2 = K - I + 1                                                 DFND0130
      TEMP1 = TEMP1 + (X(KTRM1) * WT(KWT))                              DFND0140
      TEMP2 = TEMP2 + (X(KTRM2) * WT(KWT))                              DFND0150
    2 SUMWT = SUMWT + WT(KWT)                                           DFND0160
      KBEG = J + N - 1                                                  DFND0170
      KEND = K + 1 - N                                                  DFND0180
      Y(KBEG) = TEMP1 / SUMWT                                           DFND0190
      Y(KEND) = TEMP2 / SUMWT                                           DFND0200
    3 CONTINUE                                                          DFND0210
C --- CENTRAL TERMS                                                     DFND0220
    5 K1= K + 1 - NTRMS                                                 DFND0230
      SUMWT = 0                                                         DFND0240
      DO 7 I=1,NTRMS                                                    DFND0250
      KWT = NENDT*NTRMS + I                                             DFND0260
    7 SUMWT = SUMWT + WT(KWT)                                           DFND0270
      DO 9 N=J,K1                                                       DFND0280
      TEMP1 = 0.0                                                       DFND0290
      DO 8 I=1,NTRMS                                                    DFND0300
      KWT = NENDT*NTRMS + I                                             DFND0310
      KTRM1= N + I - 1                                                  DFND0320
    8 TEMP1 = TEMP1 +(X(KTRM1) * WT(KWT))                               DFND0330
      KTRM2 = N + NTRMS/2                                               DFND0340
    9 Y(KTRM2) = TEMP1 / SUMWT                                          DFND0350
   10 RETURN                                                            DFND0360
      END                                                               DFND0370
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
C --- SUBROUTINE TO COMPUTE AVERAGE MONTH-TO-MONTH DIFFERENCE           DFNE0020
      SUBROUTINE AVEC (ARRAY,J,K,XBAR)                                  DFNE0030
      DIMENSION ARRAY(250), XBAR(11)                                    DFNE0040
      DO 11 L=1,11                                                      DFNE0050
      XBAR(L) = 0.0                                                     DFNE0060
      KL = K - L                                                        DFNE0070
      DO 10 I=J,KL                                                      DFNE0080
      LI = L + I                                                        DFNE0090
   10 XBAR(L) = XBAR(L) + ABS(ARRAY(LI) - ARRAY(I))                     DFNE0100
      SUM = K - J - L + 1                                               DFNE0110
   11 XBAR(L) = XBAR(L) / SUM                                           DFNE0120
      RETURN                                                            DFNE0130
      END                                                               DFNE0140
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
C --- SUBROUTINE TO COMPUTE AVERAGE DURATION OF RUN                     DFNF0020
      SUBROUTINE AVEDUR (Y,J,K,ADR)                                     DFNF0030
      DIMENSION Y(250)                                                  DFNF0040
      I = J                                                             DFNF0050
      M = K                                                             DFNF0060
      RUNS = 1.0                                                        DFNF0070
      IF (Y(I)-Y(I+1)) 15,12,18                                         DFNF0080
   12 I = I + 1                                                         DFNF0090
      IF (I-M) 13,21,21                                                 DFNF0100
   13 IF (Y(I)-Y(I+1)) 15,12,17                                         DFNF0110
   15 I = I + 1                                                         DFNF0120
      IF (I-M) 16,21,21                                                 DFNF0130
   16 IF (Y(I)-Y(I+1)) 15,15,17                                         DFNF0140
   17 RUNS = RUNS + 1.0                                                 DFNF0150
   18 I = I + 1                                                         DFNF0160
      IF (I-M) 19,21,21                                                 DFNF0170
   19 IF (Y(I)-Y(I+1)) 20,18,18                                         DFNF0180
   20 RUNS = RUNS + 1.0                                                 DFNF0190
      GO TO 15                                                          DFNF0200
   21 COUNT = K - J                                                     DFNF0210
      ADR = COUNT / RUNS                                                DFNF0220
      RETURN                                                            DFNF0230
      END                                                               DFNF0240
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
C --- SUBROUTINE TO ROUND DATA TO ONE DECIMAL PLACE                     DFNG0020
      SUBROUTINE ROUND (ARRAY,J,K)                                      DFNG0030
      DIMENSION ARRAY(250)                                              DFNG0040
      DO 12 I=J,K                                                       DFNG0050
      IF (ARRAY(I)) 10,11,11                                            DFNG0060
   10 ARRAY(I) = (ARRAY(I)-.10)                                         DFNG0070
   11 KTEMP = (ARRAY(I) +.05) *100.0                                    DFNG0080
      ARRAY(I) = KTEMP / 10                                             DFNG0090
   12 ARRAY(I) = ARRAY(I) / 10.0                                        DFNG0100
      RETURN                                                            DFNG0110
      END                                                               DFNG0120
* INSERT APPROPRIATE CONTROL CARD FOR YOUR SYSTEM HERE BEFORE COMPILING     0010
 DIFFUSION AND CUMULATED DIFFUSION INDEXES     TEST RUN  12/1/65                
0548101000                                                                      
                                                                                
TEST01TEST05                                                                    
TEST01TEST05                                                                    
1 0105                                                                          
02201002235002216702198302180002184702189302194002204702215302226002186348  U635
02146702107002060702014301968001940701913301886001851001816001781001801349  U635
01821701842001869001896001923001983302043702104002179302254702330002344750  U635
02359302374002431702489302547002581002615002649002651302653702656002672751  U635
02689302706002689702673302657002626302595702565002600702636302672002709352  U635
02746702784002792702801302810002834002858002882002872302862702853002817353  U635
02781702746002728002710002692002689302686702684002662002640002618002600354  U635
02582702565002616302667702719002801002883002965003025003085003145003190755  U635
03236303282003337703393303449003495003541003587003606703626303646003660356  U635
03674703689003693703698303703003727003751003775003724303673703623003495757  U635
03368303241003171303101703032003008302984702961002973002985002997003018058  U635
03039003060003123303186703250003278303306703335003343303351703360003411759  U635
03463303515003553303591703630003616703603303590003576703563303550003495060  U635
03440003385003373303361703350003390003430003470003493303516703540003550061  U635
03560003570003611703653303695003741703788303835003821703808303795003761762  U635
03728303695003731703768303805003870003935004000004040004080004120004165063  U635
042100042550042866043183043500                                          64  U635
00077800078000079100079500079100079800080400081500081500081000081300080748  P977
00081700081700081400082100082200081500080800079200078600078200077800079049  P977
00078500078500078600077100077800077600077400076500078900080100081300080850  P977
00081800082600083200084700085300086100088100088600088800089200089000089251  P977
00089200089200089400090300090700090800090100089700089600089500088900089452  P977
00090000089900090400090500090300091000090800091800092500093200094300095053  P977
00095000094800094700094300093400093100093200092700093000093100092400091454  P977
00090600090800090300089800090400090400091000091700091700091300091600091655  P977
00092300092500093700093400094700095800098700096700096100096300096500096456  P977
00096600096600096500098100098600098700099200098700099600101100101600102457  P977
00103200104300104800105400104300102600101500100600100300099200098800099558  P977
00099000098900098800097600097600098600099500100700100700101000102100099259  P977
00097100098600099100099700100300100900100900101400101200101200101700102260  P977
00101800102400102300100500100300099500099100098500099100098900099000098461  P977
00099400099000098800099800099800100400100100100200099600100100099500100162  P977
00099700099600099000098900098800098300098800099500099300098900099100098663  P977
000979000978000983000975000975                                          64  P977
00025600025900026200026400026600027000027500027800028300028400028600028548  R910
00029600029500029400029100028700028300027800027400027000026700026400026349  R910
00026300026400026400026500026700026800027200027600028300029200030100031150  R910
00032000032900033800034700035600036500037200037800038300038700039000039351  R910
00039600039900040200040300040300040200040200040300040400040600040900041152  R910
00042700042800043000043400043700044000044400044600044700044300044200043953  R910
00043500043300043000042600042200042100041900041500041400041500041600041654  R910
00041700041800041900042000042300042600042800043500043800044300044600045155  R910
00045500046100046500047200047800048300048600048900049500049800050300050656  R910
00050900051300051700052000052000052100052300052300052400052200052000051957  R910
00051600051200050800050400049900049600049400049300049400049500049700050158  R910
00050100050300050700051100051500052000052200051900051800051500051800052759  R910
00053100053600053900054100054300054400054400054400054600054400054300053860  R910
00053700053700053500053400053400053400053600053900053900054300054700055161  R910
00055400055700056000056100056400056300056900057000057300057400057600057862  R910
00057900058000058100058300058500058700058900058900059100059300059800060163  R910
000600000601000603000605000605                                          64  R910
00657800679900707500734100753900770800792000811800832800839200849100861848  H248
00867100878500893200915100941100963400983701006701030701063101093501121249  H248
01144301173001199301225801256901296101349101386401422801437201430201432550  H248
01443901450501456301452201448301443501431401446401458901466301480601491651  H248
01503701520701531601554801601301658701695701717201749501803101846301902552  H248
01956402000402054602094502127902151502182302200202216102235102255502262753  H248
02256202257502247802250602245902248102254302256702263602275702291602319054  H248
02351202393002450102502102550702603202647702696602747702776702806602842055  H248
02873202912002945702975902997703015703031103055203066403083903110703127956  H248
03145103171203193203209503232503254303276503294603309003320703334103339257  H248
03344603331203314503303303293203283203279803276603270703273503281603309258  H248
03349403392203428303475203520303569003621403683203741503793703829003857859  H248
03896003944503987404034604065704098204126704150304178804188804203604213960  H248
04210904203504204104186704187004189504190304198704205204222104244204277461  H248
04296004322004353204401704443704482604520004558804583804620604668904717462  H248
04765904815404863104915204959305007905058805106905141005194105232405278463  H248
053212053791054315054727055220                                          64  H248
00230000240000242300244600247000251300255600260000261300262600264000266048  W752
00268000270000271300272600274000270400266700263000263600264300265000263449  W752
00261700260000262600265300268000266400264700263000270000277000284000290050  W752
00296000302000303600305300307000306700306400306000313000320000327000333051  W752
00339000345000347000349000351000350400349700349000349600350300351000352052  W752
00353000354000360300366600373000373300373600374000374600375300376000374753  W752
00373400372000368000364000360000358700357400356000355700355400355000354754  W752
00354400354000354600355300356000363000370000377000382300387600393000393055  W752
00393000393000400000407000414000421000428000435000436000437000438000438056  W752
00438000438000438600439300440000454300468600483000483600484300485000473057  W752
00461000449000438400427700417000418300419600421000430600440300450000450358  W752
00450600451000463000475000487000500300513600527000530000533000536000535459  W752
00534700534000534300534600535000522400509700497000497600498300499000498460  W752
00497700497000497000497000497000497600498300499000498000497000496000496661  W752
00497300498000499000500000501000500400499700499000500000501000502000501462  W752
00500700500000500300500600501000501000501000501000500700500400500000499763  W752
004994004990004990004990004990                                          64  W752
ZZZZZZ                                                                          
//CENSUSII JOB                                                                  
// EXEC FORTGCLG,PARM.FORT>:MAP,ID,BCD:                                         
//FORT.SYSIN   DD   *                                                           
C     PROGRAM DECK USES BCD     REGION REQUIRED IS 150K                 X11A0010
C     IBM 360 VERSION OF                                                X11A0020
C     X-11 SEASONAL ADJUSTMENT PROGRAM                                  X11A0030
C     U.S. BUREAU OF THE CENSUS                                         X11A0040
C     ECONOMIC RESEARCH AND ANALYSIS DIVISION                           X11A0050
C     JULIUS SHISKIN, CHIEF                                             X11A0060
C     PROGRAMMED BY MORTON SOMER                                        X11A0070
C     CHART ROUTINE BY NORMAN BAKKA AND MORTON SOMER                    X11A0080
C     NOVEMBER 1, 1968                                                  X11A0090
C     THIS ADAPTATION TAKES INPUT FROM THE DATA BANK OUTLINED IN        X11A0091
C             COMPUTERIZED ECONOMIC ANALYSIS BY LAWRENCE SALZMAN.       X11A0092
C             THE ALPHAMERIC CONTROL VARIABLES IN COLUMNS 1-4 OF THIS   X11A0093
C             VERSION CORRESPOND TO THOSE FOUND IN COLUMNS 77-80 ON THE X11A0094
C             DATA CARDS IN THE ORIGINAL VERSION. ON THE CONTROL CARD   X11A0095
C             THE ALPHAMERIC CONTROL VARIABLE IS SWITCHED ALSO, I.E.,   X11A0096
C             PUNCH AS AN A4,A2 RATHER THAN THE OTHER WAY AROUND AS IN  X11A0097
C             THE ORIGINAL VERSION.  THE ORIGINAL STATEMENTS ARE FOUND  X11A0098
C             AS COMMENT CARDS RIGHT AFTER EACH STATEMENT CHANGED.      X11A0099
C                                                                       X11A0100
      COMMON/CA/NW,STMP(600)                                            X11A0110
      COMMON/CC/RATI(36),LTERM(12),STS(372),STSI(360)                   X11A0120
      COMMON/CF/LSER,LYR,PART,KSWK,FINAB(2),FINAP(2),KPART,AORB,OUT,MCD,X11A0130
     1 SIGM,SIGML,SIGMU,IN,RADIF1(2),RADIF2,KDEC,NEWPAG,SPC,NAME(20),   X11A0140
     2 LBK,LBNK,TCARD,KSER,LAYR,LSTMO,LSTYR,KPROPT                      X11A0141
      COMMON/CJ/MULADD                                                  X11A0150
      COMMON/CL/STI(360),KMTYP(360),STTDRF(360),D(7),DWT(7),FSTAR,KPRNT X11A0160
      COMMON/CM/LFDA,LLDA,KFULSM,KCHOPT,LOPT,KDWOPT,LFDC,LFDR,KTCOPT,   X11A0170
     1KSPOPT,KEXOPT,KSWT,MDEC,PCDIF(4),SMP(24),STPTDF(372),STOR(360),   X11A0180
     2STOPA(360),STPMF(360),STOPMA(360),LCYR                            X11A0190
      DIMENSION TOC(28),VSK(5),VTK(3),NF4(6),DIFRAT(9),KDCML(6),KDATA(2)X11A0200
     1,KWEIGH(2),KEDIT(2)                                               X11A0201
      DATA IDUM,NR,NP,NA,NWS/0,5,6,6,6/                                 X11A0210
      DATA MAX,NEWPG,SPACE,N2X,NA2 /360,1H1,1H ,3H2X,,3HA2,/            X11A0220
      DATA KDATA/4H DAT,2HA /                                           X11A0230
      DATA KWEIGH/4HWEIG,2HHT/                                          X11A0231
      DATA BLANK,KBLNK/4H    ,4H    /                                   X11A0240
      DATA OUTK /3HOUT/                                                 X11A0250
      DATA DIFRAT/4HRATI,2HOS,4HDIFF,4HEREN,4HCES ,4H PER,4H CEN,4HT CH,X11A0260
     1 4HANGE/                                                          X11A0270
      DATA AS,BS,HS,TS,ZS/4HAAAA,4HBBBB,1HH,1HT,1HZ/                    X11A0280
      DATA KDCML/1H1,1H2,1H3,1H4,1H5,1H0/                               X11A0290
      DATA NF4/4H(A4,,3HA2,,4HI2,1,4H2F6.,1H0,1H)/                      X11A0300
C     DATA NF4/4H  (1,4H2F6.,1H0,4H,I2,,3HA2,,3HA4)/                    X11A0300
C     THE FOLLOWING CARDS HAVE BEEN ADJUSTED TO ACCEPT DATA IN THE      X11A0301
C             FORMAT OF THE ABOVE MENTIONED BOOK - X11A0300, A0520,     X11A0302
C             A0530, A0550, A0780, A0950, A2905, A2915, A2920, A2930    X11A0303
      DATA TOC/4HMULT,4HIPLI,4HCATI,2HVE,4HSEAS,4HONAL,4H ADJ,4HUSTM,   X11A0310
     1 4HENT.,4HSTAN,4HDARD,4HSTAN,4HDARD,4HADDI,4HTIVE,4HSUMM,4HARY ,  X11A0320
     2 4HMEAS,4HURES,4HLONG,4H  FU,4HLL  ,4H NO ,4H   A,4H IF ,4HSIGN,  X11A0330
     3 4HIFIC,4HANT./                                                   X11A0340
      DATA VSK/2H 3,3H3X3,3H3X5,3H3X9,3HSTA/                            X11A0350
      DATA VTK/2H 9,2H13,2H23/                                          X11A0360
      NW = NA                                                           X11A0370
      NEWPAG = NEWPG                                                    X11A0380
      SPC = SPACE                                                       X11A0390
    1 KPART = 4                                                         X11A0400
      PART = AS                                                         X11A0410
      AORB = BS                                                         X11A0420
      KHED = 1                                                          X11A0430
      KEDIT(1)=KDATA(1)                                                 X11A0440
      KEDIT(2)=KDATA(2)                                                 X11A0441
C --- WRITE BLANK PAGE AT START OF EACH SERIES                          X11A0450
      WRITE (NW,14) NEWPAG                                              X11A0460
   14 FORMAT (A1)                                                       X11A0470
    2 KSWERR = 0                                                        X11A0480
      KSWK = 1                                                          X11A0490
      KSWT = 4                                                          X11A0500
C --- READ SERIES OPTION CARD                                           X11A0510
    3 READ (NR,5) TCARD,LSER,LBK,LFDA,LYR,LSTMO,LSTYR,KDEC,MULADD,KFULSMX11A0520
     1,KPROPT,KCHOPT,DWT,LOPT,KDWOPT,LCYR,LAYR,SIGM,KSER,LBNK,SIGML,    X11A0530
     2SIGMU,LTERM,KTCOPT,KEXOPT                                         X11A0540
C   3 READ (NR,5) TCARD,LBK,LSER,LFDA,LYR,LSTMO,LSTYR,KDEC,MULADD,KFULSMX11A0520
C    1,KPROPT,KCHOPT,DWT,LOPT,KDWOPT,LCYR,LAYR,SIGM,LBNK,KSER,SIGML,    X11A0530
    5 FORMAT (A1,A4,A2,4I2,5I1,7F4.3,2I1,2I2,F2.1,A4,A2,2F2.1,14I1)     X11A0550
C   5 FORMAT (A1,A2,A4,4I2,5I1,7F4.3,2I1,2I2,F2.1,A2,A4,2F2.1,14I1)     X11A0550
      IF (TCARD-ZS) 410,9999,410                                        X11A0560
  410 KRCRDS = 0                                                        X11A0600
   97 IF (TCARD-HS) 9000,86,9000                                        X11A0680
C     READ TITLE CARD                                                   X11A0690
   86 READ (NR,85) TCARD,NAME                                           X11A0700
   85 FORMAT (A1,19A4,A3)                                               X11A0710
      IF (TCARD-TS) 9000,6,9000                                         X11A0720
    6 KHED = 1                                                          X11A0730
C     SET NO. OF DECIMAL PLACES IN INPUT                                X11A0740
   76 IF(KDEC)74,74,73                                                  X11A0750
   73 IF (KDEC-5) 75,75,74                                              X11A0760
   74 KDEC = 6                                                          X11A0770
   75 NF4(5)=KDCML(KDEC)                                                X11A0780
C  75 NF4(3)=KDCML(KDEC)                                                X11A0780
      KPRNT = 1                                                         X11A0790
      DO 65 I=1,13                                                      X11A0800
   65 STMP(I+20)=TOC(I)                                                 X11A0810
C --- CHECK LENGTH OF SERIES                                            X11A0820
      LLDA = (LSTYR-LYR)*12+LSTMO                                       X11A0830
      LENGTH = LLDA-LFDA+1                                              X11A0840
      IF (LENGTH-36) 9190,58,58                                         X11A0850
   58 IF (LLDA-MAX) 59,59,9200                                          X11A0860
   59 KRCRDS = KRCRDS + 2*LENGTH + 240                                  X11A0870
   61 KYR = LYR                                                         X11A0880
C --- KRCRDS COUNTS APPROX. NO. OF OUTPUT RECORDS                       X11A0890
      LFMO = 1                                                          X11A0900
    9 LLMO = LFMO + 11                                                  X11A0910
C --- READ DATA CARDS. CHECK DATE AND IDENT                             X11A0920
C --- REGARDLESS OF MONTH IN WHICH SERIES STARTS, STOR(1) IS EQUATED TO X11A0930
C --- JANUARY, STOR(2) TO FEB , ETC.                                    X11A0940
      READ(NR,NF4)MSER,LBLK,MYR,(STOR(I),I=LFMO,LLMO)                   X11A0950
C     READ(NR,NF4)(STOR(I),I=LFMO,LLMO),MYR,LBLK,MSER                   X11A0950
      IF (LSER-MSER) 9010,13,9010                                       X11A0960
   13 IF (KYR-MYR) 9030,18,9030                                         X11A0970
   18 IF (KYR-LSTYR) 15,19,19                                           X11A0980
   15 KYR = KYR +1                                                      X11A0990
   16 LFMO = LLMO +1                                                    X11A1000
      GO TO 9                                                           X11A1010
   19 IF (LFDA-1) 39,49,39                                              X11A1020
C --- TEST START AND END MONTHS                                         X11A1030
   39 J = LFDA - 1                                                      X11A1040
      DO 62 I = 1,J                                                     X11A1050
      IF (STOR(I)) 9210,62,9210                                         X11A1060
   62 CONTINUE                                                          X11A1070
   49 IF (LLDA-LLMO) 66,64,66                                           X11A1080
   66 J = LLDA + 1                                                      X11A1090
      DO 70 I = J,LLMO                                                  X11A1100
      IF (STOR(I)) 9220,70,9220                                         X11A1110
   70 CONTINUE                                                          X11A1120
   64 IF (MULADD-1) 17,27,9090                                          X11A1130
C     TEST FOR ZERO, NEGATIVE DATA- MULTIPLICATIVE VERSION              X11A1140
   17 I = LFDA                                                          X11A1150
   28 IF (STOR(I)) 9020,9020,29                                         X11A1160
   29 IF (I-LLDA) 37,26,26                                              X11A1170
   37 I = I + 1                                                         X11A1180
      GO TO 28                                                          X11A1190
   26 RADIF1(1)=DIFRAT(1)                                               X11A1200
      RADIF1(2)=DIFRAT(2)                                               X11A1201
      RADIF2=BLANK                                                      X11A1210
      PCDIF(1)=DIFRAT(6)                                                X11A1220
      PCDIF(2)=DIFRAT(7)                                                X11A1230
      PCDIF(3)=DIFRAT(8)                                                X11A1240
      PCDIF(4)=DIFRAT(9)                                                X11A1241
      LDEC = 100                                                        X11A1250
      MDEC = 1                                                          X11A1260
      GO TO 41                                                          X11A1270
C --- SET TITLES FOR ADDITIVE VERSION                                   X11A1280
   27 STMP(21) = BLANK                                                  X11A1290
      STMP(22)=TOC(14)                                                  X11A1300
      STMP(23)=TOC(15)                                                  X11A1310
      STMP(24)=BLANK                                                    X11A1311
      RADIF1(1)=DIFRAT(3)                                               X11A1320
      RADIF1(2)=DIFRAT(4)                                               X11A1321
      RADIF2=DIFRAT(5)                                                  X11A1330
      PCDIF(1) = BLANK                                                  X11A1340
      PCDIF(2)=DIFRAT(3)                                                X11A1350
      PCDIF(3)=DIFRAT(4)                                                X11A1360
      PCDIF(4)=DIFRAT(5)                                                X11A1361
      LDEC = 0                                                          X11A1370
      MDEC = 0                                                          X11A1380
C --- SET ALL CALENDAR FACTORS TO 100. FOR MULT. OR 0. FOR ADD. VERSION X11A1390
   41 DO 20 I = LFDA,LLDA                                               X11A1400
      STTDRF(I) = LDEC                                                  X11A1410
      STPMF(I) = LDEC                                                   X11A1420
      STPTDF(I) = LDEC                                                  X11A1430
C --- SET PRIOR ADJUSTED SERIES EQUAL TO  ORIGINAL                      X11A1440
      STOPMA(I)=STOR(I)                                                 X11A1450
   20 STOPA(I)=STOR(I)                                                  X11A1460
      IF (KFULSM-1) 649,42,9080                                         X11A1470
C --- SET TITLES FOR SUMMARY MEASURES RUN                               X11A1480
   42 STMP(25)=TOC(16)                                                  X11A1490
      STMP(26)=TOC(17)                                                  X11A1500
      STMP(27)=TOC(18)                                                  X11A1510
      STMP(28)=TOC(19)                                                  X11A1520
      STMP(29)=BLANK                                                    X11A1521
      GO TO 644                                                         X11A1530
C --- TEST PRINTOUT OPTION                                              X11A1540
  649 IF (KPROPT-2) 12,67,9100                                          X11A1550
   12 IF (KPROPT-1) 644,63,644                                          X11A1560
C --- LONG PRINTOUT                                                     X11A1570
   63 KPRNT = 2                                                         X11A1580
      KRCRDS = KRCRDS + 2*LENGTH + 80                                   X11A1590
      STMP(30)=BLANK                                                    X11A1600
      STMP(31)=TOC(20)                                                  X11A1610
      GO TO 644                                                         X11A1620
C --- FULL PRINTOUT                                                     X11A1630
   67 KPRNT = 7                                                         X11A1640
      KRCRDS = KRCRDS + 3*LENGTH + 240                                  X11A1650
      STMP(30)=TOC(21)                                                  X11A1660
      STMP(31)=TOC(22)                                                  X11A1670
C --- STANDARD PRINTOUT. TEST CHART OPTION                              X11A1680
  644 IF (KCHOPT-1) 637,638,636                                         X11A1690
  636 IF (KCHOPT-2) 9110,643,9110                                       X11A1700
C --- STANDARD CHARTS                                                   X11A1710
  637 KRCRDS = KRCRDS + 2*LENGTH + 200                                  X11A1720
      GO TO 43                                                          X11A1730
C --- NO CHARTS                                                         X11A1740
  638 STMP(32)=BLANK                                                    X11A1750
      STMP(33)=TOC(23)                                                  X11A1760
      GO TO 43                                                          X11A1770
C --- ALL CHARTS                                                        X11A1780
  643 STMP(32)=TOC(24)                                                  X11A1790
      STMP(33)=TOC(22)                                                  X11A1800
      KRCRDS = KRCRDS + 4*LENGTH + 220                                  X11A1810
C --- WRITE TITLE PAGE                                                  X11A1820
   43 WRITE (NW,310)                                                    X11A1830
  310 FORMAT (44X,32HX-11 SEASONAL ADJUSTMENT PROGRAM/                  X11A1840
     147X,26HU. S. BUREAU OF THE CENSUS /                               X11A1850
     241X,39HECONOMIC RESEARCH AND ANALYSIS DIVISION /                  X11A1860
     352X,16HNOVEMBER 1, 1968 //                                        X11A1870
     312X,51HTHE X-11 PROGRAM IS DIVIDED INTO SEVEN MAJOR PARTS-/       X11A1880
     4 17X,22HPART       DESCRIPTION)                                   X11A1890
      WRITE (NW,323)                                                    X11A1900
  323 FORMAT (18X,28HA. PRIOR ADJUSTMENTS, IF ANY/                      X11A1910
     618X,55HB. PRELIMINARY ESTIMATES OF IRREGULAR COMPONENT WEIGHTS/   X11A1920
     725X,34HAND REGRESSION TRADING DAY FACTORS/                        X11A1930
     818X,27HC. FINAL ESTIMATES OF ABOVE/                               X11A1940
     918X,68HD. FINAL ESTIMATES OF SEASONAL, TREND-CYCLE AND IRREGULAR CX11A1950
     1OMPONENTS/                                                        X11A1960
     218X,20HE. ANALYTICAL TABLES/                                      X11A1970
     3 18X,19HF. SUMMARY MEASURES)                                      X11A1980
      WRITE (NW,324)                                                    X11A1990
  324 FORMAT (18X, 9HG. CHARTS/                                         X11A2000
     512X,99HTABLES ARE IDENTIFIED BY THEIR PART LETTER AND SEQUENCE WITX11A2010
     6HIN THE PART. A GIVEN TABLE HAS THE SAME/                         X11A2020
     712X,99HIDENTIFICATION IN THE STANDARD, LONG AND FULL PRINTOUTS. THX11A2030
     8E SAME NUMBER IS GIVEN TO CORRESPONDING /                         X11A2040
     912X,99HTABLES IN PARTS B, C AND D. THUS, TABLES B10., C10. AND D10X11A2050
     1. ARE ALL TABLES OF SEASONAL FACTORS.   /                         X11A2060
     212X,99HWHERE NO CORRESPONDING TABLE EXISTS THE SEQUENCE NO. IS NOTX11A2070
     3 USED IN THE PART. THUS, B8. AND D8. ARE/                         X11A2080
     412X,50HTABLES OF UNMODIFIED SI RATIOS BUT THERE IS NO C8.///)     X11A2090
      WRITE (NW,321)NAME,LSER,LFDA,LYR,LSTMO,LSTYR,(STMP(I),I=21,33)    X11A2100
  321 FORMAT(47X,16HTHIS SERIES RUN ,3A4/                               X11A2110
     112X,14HSERIES TITLE- ,16A4,A3,13H  SERIES NO. ,A4/                X11A2120
     245X,16HPERIOD COVERED- ,I2,1H/,I2,4H TO ,I2,1H/,I2//              X11A2130
     336X,14HTYPE OF RUN - ,3A4,A3,5A4/                                 X11A2140
     442X,2A4,11H PRINTOUT. ,2A4,8H CHARTS.)                            X11A2150
C --- WRITE LOG ENTRY                                                   X11A2160
      DO 642 I = 1,3                                                    X11A2170
  642 STMP(I) = BLANK                                                   X11A2180
      OUT = OUTK                                                        X11A2190
C --- TEST LENGTH OF MONTH ADJUSTMENT OPTION                            X11A2200
   25 IF (LOPT-1) 34,35,9120                                            X11A2210
C --- WITH                                                              X11A2220
   35 LOPT = 4                                                          X11A2230
      OUT = BLANK                                                       X11A2240
C --- WITHOUT                                                           X11A2250
C --- TEST FOR PRIOR TRADING DAY FACTORS                                X11A2260
   34 KSWV = 0                                                          X11A2270
      I = 1                                                             X11A2280
   94 IF (DWT(I)) 9250,96,95                                            X11A2290
   95 KSWV = 1                                                          X11A2300
   96 IF (I-7) 98,31,98                                                 X11A2310
   98 I = I + 1                                                         X11A2320
      GO TO 94                                                          X11A2330
   31 IF (KSWV) 103,99,103                                              X11A2340
  103 IF (MULADD) 9260,36,9260                                          X11A2350
C --- NO PRIOR T.D.FACTORS. SET EQUAL TO 1.                             X11A2360
   99 KSWT = KSWT - 1                                                   X11A2370
      IF (MULADD) 104,102,104                                           X11A2380
  102 DO 32 I = 1,7                                                     X11A2390
   32 DWT(I) = 1.                                                       X11A2400
      GO TO 69                                                          X11A2410
  104 LOPT = 0                                                          X11A2420
      OUT = OUTK                                                        X11A2430
      GO TO 69                                                          X11A2440
   36 WRITE (NW,311) OUT                                                X11A2450
  311 FORMAT (28X,33HPRIOR TRADING DAY ADJUSTMENT WITH,A3,28H LENGTH OF X11A2460
     1MONTH ADJUSTMENT.)                                                X11A2470
C --- TEST TRADING DAY REGRESSION OPTION                                X11A2480
   69 IF (KDWOPT-3) 624,630,9130                                        X11A2490
  624 IF (KDWOPT-1) 620,630,630                                         X11A2500
C --- TEST SIGMA LIMIT FOR EXCLUDING EXTREMES FROM T.D. REGRESSION      X11A2510
  630 IF (SIGM) 9140,628,629                                            X11A2520
  628 SIGM = 2.5                                                        X11A2530
C --- TEST T.D.REGRESSION COMPUTE AND APPLY DATES                       X11A2540
  629 LLYR = LYR + (LLDA-1)/12                                          X11A2550
      IF (LCYR) 9050,611,610                                            X11A2560
  610 IF (LYR-LCYR) 613,611,9050                                        X11A2570
  613 IF (LLYR-LCYR) 9050,614,614                                       X11A2580
  611 LCYR = LYR                                                        X11A2590
  612 LFDC = LFDA                                                       X11A2600
      GO TO 615                                                         X11A2610
  614 LFDC = (LCYR-LYR)*12+1                                            X11A2620
  615 IF (LAYR) 9050,617,616                                            X11A2630
  616 IF (LYR-LAYR) 619,617,9050                                        X11A2640
  619 IF (LLYR-LAYR) 9050,621,621                                       X11A2650
  617 LAYR = LYR                                                        X11A2660
  618 LFDR = LFDA                                                       X11A2670
      GO TO 631                                                         X11A2680
  621 LFDR = (LAYR-LYR)*12+1                                            X11A2690
  631 WRITE (NW,312) LCYR,SIGM                                          X11A2700
  312 FORMAT (12X,43HTRADING DAY REGRESSION COMPUTED STARTING 19,I2,    X11A2710
     136H EXCLUDING IRREGULAR VALUES OUTSIDE ,F3.1,14H-SIGMA LIMITS.)   X11A2720
      IF (KDWOPT-2) 681,627,626                                         X11A2730
  681 WRITE (NW,313)                                                    X11A2740
  313 FORMAT (38X,45HTRADING DAY REGRESSION ESTIMATES NOT APPLIED.)     X11A2750
      GO TO 620                                                         X11A2760
  626 STMP(1)=TOC(25)                                                   X11A2770
      STMP(2)=TOC(26)                                                   X11A2780
      STMP(3)=TOC(27)                                                   X11A2790
      STMP(4)=TOC(28)                                                   X11A2791
  627 WRITE (NW,314)LAYR,(STMP(I),I=1,4)                                X11A2800
  314 FORMAT (29X,52HTRADING DAY REGRESSION ESTIMATES APPLIED STARTING 1X11A2810
     19,I2,4A4)                                                         X11A2820
C --- TEST FOR PRIOR MONTHLY ADJUSTMENT FACTORS                         X11A2830
  620 IF (KSER-KBLNK) 51,106,51                                         X11A2840
C --- READ PRIOR MONTHLY FACTORS AND CHECK DATES AND IDENT.             X11A2850
   51 LFMO = 1                                                          X11A2860
      WRITE (NW,315)                                                    X11A2870
  315 FORMAT (48X,25HPRIOR MONTHLY ADJUSTMENT.)                         X11A2880
      KYR = LYR                                                         X11A2890
      KEDIT(1)=KWEIGH(1)                                                X11A2900
      KEDIT(2)=KWEIGH(2)                                                X11A2901
      IF (MULADD) 52,352,52                                             X11A2904
  352 NF4(5) = KDCML(3)                                                 X11A2905
C 352 NF4(2) = KDCML(3)                                                 X11A2905
   52 LLMO = LFMO + 11                                                  X11A2910
      NF4(2) = N2X                                                      X11A2915
C     NF4(5) = N2X                                                      X11A2915
      READ (NR,NF4) MSER,MYR, (STPMF(I), I=LFMO,LLMO)                   X11A2920
C     READ (NR,NF4) (STPMF(I), I=LFMO,LLMO),MYR,MSER                    X11A2920
      NF4(2) = NA2                                                      X11A2930
C     NF4(5) = NA2                                                      X11A2930
      IF (KSER-MSER) 9060,54,9060                                       X11A2940
   54 IF (KYR-MYR) 9070,55,9070                                         X11A2950
   55 IF (KYR-LSTYR) 56,57,57                                           X11A2960
   56 KYR = KYR + 1                                                     X11A2970
      LFMO = LLMO + 1                                                   X11A2980
      GO TO 52                                                          X11A2990
   57 IF (LFDA-1) 81,83,81                                              X11A3000
   81 J = LFDA - 1                                                      X11A3010
      DO 82 I = 1,J                                                     X11A3020
      IF (STPMF(I)) 9230,82,9230                                        X11A3030
   82 CONTINUE                                                          X11A3040
   83 IF (LLDA-LLMO) 105,87,105                                         X11A3050
  105 J = LLDA + 1                                                      X11A3060
      DO 84 I = J,LLMO                                                  X11A3070
      IF (STPMF(I)) 9240,84,9240                                        X11A3080
   84 CONTINUE                                                          X11A3090
   87 IF (MULADD) 30,21,30                                              X11A3100
C --- CHECK FOR ZERO, NEGATIVE WTS. -MULT. ADJUSTMENT ONLY.             X11A3110
   21 I = LFDA                                                          X11A3120
   24 IF (STPMF(I)) 9040,9040,22                                        X11A3130
   22 IF (I - LLDA) 23,30,23                                            X11A3140
   23 I = I + 1                                                         X11A3150
      GO TO 24                                                          X11A3160
C --- TEST SIGMA LIMITS FOR GRADUATING EXTREMES                         X11A3170
  106 KSWT = KSWT - 2                                                   X11A3180
   30 IF (SIGMU) 9150,78,77                                             X11A3190
   78 SIGMU = 2.5                                                       X11A3200
   77 IF (SIGML) 9150,88,89                                             X11A3210
   88 SIGML = 1.5                                                       X11A3220
   89 IF (SIGMU-SIGML) 9150,79,79                                       X11A3230
   79 WRITE (NW,316) SIGML,SIGMU                                        X11A3240
  316 FORMAT (31X,47HSIGMA LIMITS FOR GRADUATING EXTREME VALUES ARE ,   X11A3250
     1F3.1,5H AND ,F3.1)                                                X11A3260
C --- TEST SEASONAL FACTOR CURVE MOVING AVERAGES                        X11A3270
   44 KSWV = 0                                                          X11A3280
      I = 1                                                             X11A3290
   46 IF (LTERM(I)) 640,640,639                                         X11A3300
  639 IF (LTERM(I)-5) 645,645,9170                                      X11A3310
  640 STMP(I) = BLANK                                                   X11A3320
      GO TO 641                                                         X11A3330
  645 KSWV = 1                                                          X11A3340
      J = LTERM(I)                                                      X11A3350
      STMP(I)=VSK(J)                                                    X11A3360
  641 IF (I-12) 48,47,47                                                X11A3370
   48 I = I + 1                                                         X11A3380
      GO TO 46                                                          X11A3390
   47 IF (KSWV) 646,632,646                                             X11A3400
  646 WRITE (NW,317) (STMP(I),I=1,12)                                   X11A3410
  317 FORMAT (15X,89HMOVING AVERAGES FOR SEASONAL FACTOR CURVES- J   F  X11A3420
     1 M   A   M   J   J   A   S   O   N   D/58X,12A4)                  X11A3430
C --- TEST TREND CYCLE MOVING AVERAGE                                   X11A3440
  632 IF (KTCOPT-3) 633,635,9180                                        X11A3450
  633 IF (KTCOPT-1) 634,635,635                                         X11A3460
  634 KTCOPT = 4                                                        X11A3470
      GO TO 623                                                         X11A3480
  635 STMP(1) = VTK(KTCOPT)                                             X11A3490
      WRITE (NW,318)STMP(1)                                             X11A3500
  318 FORMAT (25X,53HMOVING AVERAGE FOR THE VARIABLE TREND CYCLE ROUTINEX11A3510
     1- ,A2,15H-TERM HENDERSON)                                         X11A3520
  623 IF (KEXOPT-1) 665,663,9270                                        X11A3530
  663 WRITE (NW,664)                                                    X11A3540
  664 FORMAT (25X,70HMODIFY EXTREME VALUES BEFORE COMPUTING THE TABLE B7X11A3550
     1. TREND CYCLE CURVE)                                              X11A3560
  665 IF (KSWT) 647,647,652                                             X11A3570
C --- SERIES REJECTED                                                   X11A3580
  647 WRITE (NW,320)                                                    X11A3590
  320 FORMAT (/48X,15HSERIES REJECTED)                                  X11A3600
      GO TO 1                                                           X11A3610
  652 WRITE(NP,319)LSER,LFDA,LYR,LSTMO,LSTYR,(STMP(I),I=21,31)          X11A3620
  319 FORMAT(8X,A4,2X,I2,1H/,I2,3H - ,I2,1H/,I2,2X,3A4,A3,5A4,2X,2A4,   X11A3630
     19H PRINTOUT)                                                      X11A3640
      DO 92 I = 1,24                                                    X11A3650
   92 SMP(I) = 0                                                        X11A3660
      IF (KSWT-1) 33,90,33                                              X11A3670
C --- WRITE UNADJUSTED ORIGINAL SERIES -A1.                             X11A3680
   33 CALL RITE (1,STOR,LFDA,LLDA,2,7,0)                                X11A3690
      KSWK = 0                                                          X11A3700
      AORB = AS                                                         X11A3710
      IF (KSWT - 2) 60, 40, 60                                          X11A3720
   60 CALL RITE (2,STPMF,LFDA,LLDA,2,3,0)                               X11A3740
C --- COMPUTE AVGE. MONTH-TO-MONTH CHANGE IN PRIOR MONTHLY FACTORS      X11A3750
C --- WRITE PRIOR MONTHLY FACTORS -A2.                                  X11A3730
      CALL ADDMUL (STOPMA,STOR,STPMF,LFDA,LLDA)                         X11A3810
C --- *DIFFERENCES* FOR *RATIOS* THRUOUT FOR ADDITIVE PROGRAM.          X11A3800
C --- FIRST. READ *SUBTRACT B FROM A* FOR *DIVIDE A BY B* AND           X11A3790
C --- ---IN ADDITIVE VERSION ROUTINE ADDMUL SUBTRACTS SECOND SERIES FROMX11A3780
C --- DIVIDE ORIGINAL BY P.M.F..RESULT IS PRIOR MONTHLY ADJUSTED        X11A3770
      CALL SUMRY (STPMF,SMP,LFDA,LLDA,1)                                X11A3760
C --- SET PRIOR ADJUSTED EQUAL TO PRIOR MONTHLY ADJUSTED                X11A3820
      DO 71 I = LFDA, LLDA                                              X11A3830
   71 STOPA(I) = STOPMA(I)                                              X11A3840
C --- TEST FOR PRIOR TRADING DAY ADJUSTMENT                             X11A3850
      IF (KSWT-4) 90,50,90                                              X11A3860
C --- WRITE PRIOR MONTHLY ADJUSTED SERIES BEFORE T.D. ADJUSTMENT -A3.   X11A3870
   50 CALL RITE (3,STOPMA,LFDA,LLDA,5,7,0)                              X11A3880
C --- COMPUTE MONTHLY T.D.FACTORS FROM 7 PRIOR DAILY WEIGHTS            X11A3890
   40 CALL DOW (DWT,STPTDF,LYR,LFDA,LLDA,LOPT)                          X11A3900
C --- SET TRADING DAY REGRESSION FACTORS EQUAL TO PRIOR T.D.FACTORS     X11A3910
      DO 80 I = LFDA,LLDA                                               X11A3920
   80 STTDRF(I) = STPTDF(I)                                             X11A3930
C --- WRITE PRIOR TRADING DAY FACTORS -A4.                              X11A3940
      CALL RITE (4,STPTDF,LFDA,LLDA,5,4,DWT)                            X11A3950
C --- DIVIDE PRIOR MONTHLY ADJUSTED OR ORIGINAL BY PRIOR T.D. FACTORS.  X11A3960
      CALL ADDMUL (STOPA,STOPMA,STPTDF,LFDA,LLDA)                       X11A3970
   90 CALL SUBX11                                                       X11A3980
      GO TO 1                                                           X11A3990
C --- REJECT MESSAGES                                                   X11A4000
 9000 GO TO (9001, 3), KHED                                             X11A4010
 9001 WRITE (NP,9002) LSER                                              X11A4020
 9002 FORMAT(8H REJECT ,A4,24H NO HEADER OR TITLE CARD)                 X11A4030
      KHED = 2                                                          X11A4040
      GO TO 2                                                           X11A4050
 9800 IF (KSWT) 9802,9802,9801                                          X11A4060
 9801 KSWT = 0                                                          X11A4070
      LENGTH = 0                                                        X11A4080
      WRITE (NP,9805) LSER                                              X11A4090
 9805 FORMAT(8H REJECT ,A4)                                             X11A4100
 9802 KSWERR = KSWERR + 1                                               X11A4110
      IF (KSWERR - 31) 9803,9804,9806                                   X11A4120
 9803 GO TO KRR1,(9012,9022,9032,9051,9092,9141,9151,9191,9201,9212,9222X11A4130
     1,9251,9261)                                                       X11A4140
 9804 WRITE (NP,9300)                                                   X11A4150
 9300 FORMAT (20X,43HERROR MESSAGES FOR THIS SERIES DISCONTINUED)       X11A4160
 9806 GO TO KRR2,(13,29,18,22,620,54,55,649,17,644,43,34,630,629,44,645,X11A4170
     1623,61,49,64,83,87,31,69,665)                                     X11A4180
 9010 ASSIGN 13 TO KRR2                                                 X11A4190
 9011 ASSIGN 9012 TO KRR1                                               X11A4200
      GO TO 9800                                                        X11A4210
 9012 WRITE(NP,9013)(KEDIT(I),I=1,2),KYR,MSER                           X11A4220
 9013 FORMAT(20X,4HTHE ,A4,A2,12H CARD FOR 19,I2,16H IS FROM SERIES ,A4)X11A4230
      GO TO 9806                                                        X11A4240
 9020 ASSIGN 29 TO KRR2                                                 X11A4250
 9021 ASSIGN 9022 TO KRR1                                               X11A4260
      NYR = (I-1)/12                                                    X11A4270
      NMO = I - NYR * 12                                                X11A4280
      NYR = NYR + LYR                                                   X11A4290
      GO TO 9800                                                        X11A4300
 9022 WRITE(NP,9023)(KEDIT(I),I=1,2),NMO,NYR                            X11A4310
 9023 FORMAT(20X,4HTHE ,A4,A2,5H FOR ,I2,1H/,I2,20H IS ZERO OR NEGATIVE)X11A4320
      GO TO 9806                                                        X11A4330
 9030 ASSIGN 18 TO KRR2                                                 X11A4340
 9031 ASSIGN 9032 TO KRR1                                               X11A4350
      GO TO 9800                                                        X11A4360
 9032 WRITE(NP,9033)(KEDIT(I),I=1,2),KYR,MYR                            X11A4370
 9033 FORMAT(20X,4HTHE ,A4,A2,12H CARD FOR 19,I2,12H IS DATED 19,I2)    X11A4380
      GO TO 9806                                                        X11A4390
 9040 ASSIGN 22 TO KRR2                                                 X11A4400
      GO TO 9021                                                        X11A4410
 9050 ASSIGN 620 TO KRR2                                                X11A4420
      ASSIGN 9051 TO KRR1                                               X11A4430
      GO TO 9800                                                        X11A4440
 9051 WRITE (NP,9052)                                                   X11A4450
 9052 FORMAT (20X,55HREGRESSION DATES [COLS 51-52 OR 53-54] ARE INCONSISX11A4460
     1TENT)                                                             X11A4470
      GO TO 9806                                                        X11A4480
 9060 ASSIGN 54 TO KRR2                                                 X11A4490
      GO TO 9011                                                        X11A4500
 9070 ASSIGN 55 TO KRR2                                                 X11A4510
      GO TO 9031                                                        X11A4520
 9080 ASSIGN 649 TO KRR2                                                X11A4530
      KCOL = 18                                                         X11A4540
      KERR = KFULSM                                                     X11A4550
      GO TO 9091                                                        X11A4560
 9090 ASSIGN 17 TO KRR2                                                 X11A4570
      KCOL = 17                                                         X11A4580
      KERR = MULADD                                                     X11A4590
 9091 ASSIGN 9092 TO KRR1                                               X11A4600
      GO TO 9800                                                        X11A4610
 9092 WRITE (NP,9093) KCOL,KERR                                         X11A4620
 9093 FORMAT (20X,30HTHE ENTRY IN OPTION CARD COL. ,I2,4H IS ,I1,21H WHIX11A4630
     1CH IS NOT DEFINED)                                                X11A4640
      GO TO 9806                                                        X11A4650
 9100 ASSIGN 644 TO KRR2                                                X11A4660
      KCOL = 19                                                         X11A4670
      KERR = KPROPT                                                     X11A4680
      GO TO 9091                                                        X11A4690
 9110 ASSIGN 43 TO KRR2                                                 X11A4700
      KCOL = 20                                                         X11A4710
      KERR = KCHOPT                                                     X11A4720
      GO TO 9091                                                        X11A4730
 9120 ASSIGN 34 TO KRR2                                                 X11A4740
      KCOL = 49                                                         X11A4750
      KERR = LOPT                                                       X11A4760
      GO TO 9091                                                        X11A4770
 9130 ASSIGN 630 TO KRR2                                                X11A4780
      KCOL = 50                                                         X11A4790
      KERR = KDWOPT                                                     X11A4800
      GO TO 9091                                                        X11A4810
 9140 ASSIGN 629 TO KRR2                                                X11A4820
      ASSIGN 9141 TO KRR1                                               X11A4830
      GO TO 9800                                                        X11A4840
 9141 WRITE (NP,9142)                                                   X11A4850
 9142 FORMAT (20X,45HNEGATIVE SIGMA LIMIT NOT ALLOWED [COLS 55-56])     X11A4860
      GO TO 9806                                                        X11A4870
 9150 ASSIGN 44 TO KRR2                                                 X11A4880
      ASSIGN 9151 TO KRR1                                               X11A4890
      GO TO 9800                                                        X11A4900
 9151 WRITE (NP,9152)                                                   X11A4910
 9152 FORMAT (20X,49HSIGMA LIMITS [COLS. 63-64 OR 65-66] ARE INCORRECT) X11A4920
      GO TO 9806                                                        X11A4930
 9170 ASSIGN 645 TO KRR2                                                X11A4940
      KCOL = I + 66                                                     X11A4950
      KERR = LTERM(I)                                                   X11A4960
      GO TO 9091                                                        X11A4970
 9180 ASSIGN 623 TO KRR2                                                X11A4980
      KCOL = 79                                                         X11A4990
      KERR = KTCOPT                                                     X11A5000
      GO TO 9091                                                        X11A5010
 9190 ASSIGN 61 TO KRR2                                                 X11A5020
      ASSIGN 9191 TO KRR1                                               X11A5030
      GO TO 9800                                                        X11A5040
 9191 WRITE (NP,9192)                                                   X11A5050
 9192 FORMAT (20X,38HTHE SERIES IS LESS THAN 36 MONTHS LONG)            X11A5060
      GO TO 9806                                                        X11A5070
 9200 ASSIGN 61 TO KRR2                                                 X11A5080
      ASSIGN 9201 TO KRR1                                               X11A5090
      LSTYR = LYR + 29                                                  X11A5100
      GO TO 9800                                                        X11A5110
 9201 WRITE (NP,9202)                                                   X11A5120
 9202 FORMAT (20X,42HSERIES EXCEEDS 30 CALENDAR YEARS IN LENGTH)        X11A5130
      GO TO 9806                                                        X11A5140
 9210 ASSIGN 49 TO KRR2                                                 X11A5150
 9211 ASSIGN 9212 TO KRR1                                               X11A5160
      GO TO 9800                                                        X11A5170
 9212 WRITE(NP,9213)(KEDIT(I),I=1,2)                                    X11A5180
 9213 FORMAT(20X,4HTHE ,A4,A2,33H SERIES STARTS IN THE WRONG MONTH)     X11A5190
      GO TO 9806                                                        X11A5200
 9220 ASSIGN 64 TO KRR2                                                 X11A5210
 9221 ASSIGN 9222 TO KRR1                                               X11A5220
      GO TO 9800                                                        X11A5230
 9222 WRITE(NP,9223)(KEDIT(I),I=1,2)                                    X11A5240
 9223 FORMAT(20X,4HTHE ,A4,A2,31H SERIES ENDS IN THE WRONG MONTH)       X11A5250
      GO TO 9806                                                        X11A5260
 9230 ASSIGN 83 TO KRR2                                                 X11A5270
      GO TO 9211                                                        X11A5280
 9240 ASSIGN 87 TO KRR2                                                 X11A5290
      GO TO 9221                                                        X11A5300
 9250 ASSIGN 31 TO KRR2                                                 X11A5310
      ASSIGN 9251 TO KRR1                                               X11A5320
      GO TO 9800                                                        X11A5330
 9251 WRITE (NP,9252)                                                   X11A5340
 9252 FORMAT (20X,46HNEGATIVE PRIOR TRADING DAY WEIGHTS NOT ALLOWED)    X11A5350
      GO TO 9806                                                        X11A5360
 9260 ASSIGN 69 TO KRR2                                                 X11A5370
      ASSIGN 9261 TO KRR1                                               X11A5380
      GO TO 9800                                                        X11A5390
 9261 WRITE (NP,9262)                                                   X11A5400
 9262 FORMAT (20X,63HPRIOR TRADING DAY ADJUSTMENT NOT ALLOWED IN ADDITIVX11A5410
     1E ADJUSTMENT)                                                     X11A5420
      GO TO 9806                                                        X11A5430
 9270 ASSIGN 665 TO KRR2                                                X11A5440
      KCOL = 80                                                         X11A5450
      KERR = KEXOPT                                                     X11A5460
      GO TO 9091                                                        X11A5470
C --- FINISH                                                            X11A5480
 9999 WRITE (NW,411) NEWPAG                                             X11A5490
      WRITE (NP,411) NEWPAG                                             X11A5500
  411 FORMAT (A1,14H   END OF REEL/)                                    X11A0630
      REWIND NW                                                         X11A5510
10000 STOP                                                              X11A5520
      END                                                               X11A5530
C --- LIP FOR SUBX11,SUBX1S                                             X11B0010
      SUBROUTINE SUBX11                                                 X11B0020
      COMMON/CA/NW,STMP(600)                                            X11B0030
      COMMON/CB/RATIC,NTERM,STC(360),STCI(360)                          X11B0040
      COMMON/CC/RATI(36),LTERM(12),STS(372),STSI(360)                   X11B0050
      COMMON/CF/LSER,LYR,PART,KSWK,FINAB(2),FINAP(2),KPART,AORB,OUT,MCD,X11B0060
     1 SIGM,SIGML,SIGMU,IN,RADIF1(2),RADIF2,KDEC,NEWPAG,SPC,NAME(20),   X11B0070
     2 LBK,LBNK,TCARD,KSER,LAYR,LSTMO,LSTYR,KPROPT                      X11B0071
      COMMON/CJ/MULADD                                                  X11B0080
      COMMON/CL/STI(360),KMTYP(360),STTDRF(360),D(7),DWT(7),FSTAR,KPRNT X11B0090
      COMMON/CM/LFDA,LLDA,KFULSM,KCHOPT,LOPT,KDWOPT,LFDC,LFDR,KTCOPT,   X11B0100
     1KSPOPT,KEXOPT,KSWT,MDEC,PCDIF(4),SMP(24),STPTDF(372),STOR(360),   X11B0110
     2STOPA(360),STPMF(360),STOPMA(360),LCYR                            X11B0120
      DIMENSION STCIME(360),STCSI(360),STSP(360),STSIE(360),STDEV(360), X11B0130
     1STIME(360),STMCD(360),STOCCA(360),STOME(360),STWT(360),           X11B0140
     2 SMO(48),SMCI(48),SMI(48),SMC(48),SMS(48),SMTD(24),               X11B0150
     3 SMMCD(48),SMOME(12),SMCIME(12),SMIME(12),SMIC(12),SMO2(12),      X11B0160
     4 FINAL(2),PRELIM(2)                                               X11B0161
C --- THIS EQUIVALENCE IS USED ONLY TO REDUCE SIZE OF PROGRAM STORAGE   X11B0170
      EQUIVALENCE (STTDRF,STMCD,STSP),(STPTDF,STSIE),(STOPMA,STIME),    X11B0180
     1 (STOCCA,STOME),(STCSI,STCIME),(STOPA,SMO),(STOPA(49),SMCI),      X11B0190
     2 (STOPA(97),SMI),(STOPA(145),SMC),(STOPA(193),SMS),(STOPA(241),   X11B0200
     3 SMTD),(STOPA(265),SMMCD),(STOPA(313),SMOME),(STOPA(325),SMCIME), X11B0210
     4 (STOPA(337),SMIME),(STOPA(349),SMIC)                             X11B0220
      EQUIVALENCE (STMP(2),STMP2),(STOR(2),STOR2),(STCI(2),STCI2)       X11B0230
      DATA DUM/1H /,BLANK/4H    /,FINAL/4H FIN,2HAL/,PRELIM/4HPREL,2HIM/X11B0240
      DATA BS,CS,DS,ES/4HBBBB,4HCCCC,4HDDDD,4HEEEE/                     X11B0250
      DATA FS,GS/4HFFFF,4HGGGG/                                         X11B0260
      DATA STAR/4H****/                                                 X11B0270
      FINAB(1)=BLANK                                                    X11B0280
      FINAB(2)=BLANK                                                    X11B0281
      FINAP(1)=PRELIM(1)                                                X11B0290
      FINAP(2)=PRELIM(2)                                                X11B0291
      KSECT = 1                                                         X11B0300
   90 KPART = 1                                                         X11B0310
      PART = BS                                                         X11B0320
C --- WRITE ORIGINAL OR PRIOR ADJUSTED -B1.                             X11B0330
      CALL RITE (1,STOPA,LFDA,LLDA,2,7,0)                               X11B0340
C --- SET COMPLETELY CALENDAR ADJUSTED SERIES EQUAL TO PRIOR ADJUSTED   X11B0350
C --- OR ORIGINAL                                                       X11B0360
      DO 91 I = LFDA, LLDA                                              X11B0370
      STOCCA(I) = STOPA(I)                                              X11B0380
   91 STCSI(I) = STOPA(I)                                               X11B0390
C --- THE FOLLOWING CODING IS USED IN PARTS B,C, AND D                  X11B0400
C --- CENTERED 12-TERM MVG AVGE OF ORIGINAL OR PRIOR ADJUSTED           X11B0410
C --- IN PART C, MODIFIED BY PRELIM WTS AND IN PART D MOD. BY FINAL WTS.X11B0420
  100 MFDA = LFDA + 6                                                   X11B0430
      MLDA = LLDA - 6                                                   X11B0440
      DO 101 I = MFDA, MLDA                                             X11B0450
  101 STC(I) =(STCSI(I-6) + STCSI(I+6) + 2.*(STCSI(I-5) + STCSI(I-4) +  X11B0460
     1STCSI(I-3) + STCSI(I-2) + STCSI(I-1) + STCSI(I) + STCSI(I+1) +    X11B0470
     2STCSI(I+2) + STCSI(I+3) + STCSI(I+4) + STCSI(I+5)))/24.           X11B0480
C --- THE VARIABLE*KPRNT* CONTROLS THE PRINTING AND SUPPRESSION OF      X11B0490
C --- TABLES. KPRNT IS ASSIGNED THE VALUE 1,2, OR 7 FOR THE SHORT, LONG,X11B0500
C --- OR FULL PRINTOUTS RESPECTIVELY. KPRNT IS INCREASED BY 2 AT THE ENDX11B0510
C --- OF PART B AND AGAIN AT THE END OF PART C THUS GIVING A UNIQUE     X11B0520
C --- VALUE TO EACH COMBINATION OF PRINTOUT AND PART. THE VALUES        X11B0530
C --- SELECTED WERE CHOSEN TO REDUCE THE NO. OF TESTS REQUIRED BEFORE   X11B0540
C --- EACH CALL TO *RITE*)                                              X11B0550
      IF (KPRNT-2) 251,252,251                                          X11B0560
  251 IF (KPRNT-6) 253,253,252                                          X11B0570
C --- WRITE TREND CYCLE -B2,C2, OR D2.                                  X11B0580
  252 CALL RITE (2,STC,MFDA,MLDA,5,7,0)                                 X11B0590
C --- DIVIDE ORIGINAL BY TREND CYCLE FOR SI RATIOS                      X11B0600
  253 CALL ADDMUL (STSI,STCSI,STC,MFDA,MLDA)                            X11B0610
      KADD = 0                                                          X11B0620
      GO TO (112,113,113),KPART                                         X11B0630
C --- PART B ONLY                                                       X11B0640
  112 KTABL = 3+KADD                                                    X11B0650
      IF (KPRNT-7) 110,254,110                                          X11B0660
C --- WRITE SI RATIOS -B3, OR B8.                                       X11B0670
  254 CALL RITE (KTABL,STSI,MFDA,MLDA,5,4,0)                            X11B0680
C --- COMPUTE 5-TERM MVG AVG OF EACH MONTH SEPARATELY FOR ESTIMATE OF   X11B0690
C --- SEASONAL FACTORS. TO CENTER COMPUTE A CENTERED 12-TERM M.A. OF    X11B0700
C --- ENTIRE SERIES                                                     X11B0710
  110 CALL VSFC (MFDA,MLDA,KSECT)                                       X11B0720
C --- DIVIDE SI RATIOS BY ESTIMATED SEASONAL FACTORS FOR ESTIMATE OF IRRX11B0730
      CALL ADDMUL (STI,STSI,STS,MFDA,MLDA)                              X11B0740
C --- IDENTIFY EXTREME IRREGULAR VALUES -SEE XTRM FOR METHOD            X11B0750
      CALL XTRM (STI,STDEV,STWT,MFDA,MLDA,SIGMU,SIGML,KEXT)             X11B0760
C --- REPLACE CORRESPONDING SI RATIOS FOR IRR. VALUES RECVING LESS THAN X11B0770
C --- FULL WEIGHT                                                       X11B0780
C --- STI USED TO STORE REPLACEMENT VALUES ONLY FOR WRITING B4. OR B9.  X11B0790
      DO 148 I = LFDA, LLDA                                             X11B0800
  148 STI(I) = 10**10                                                   X11B0810
C --- FOR EACH MONTH SEPARATELY                                         X11B0820
      DO 163 I = 1,12                                                   X11B0830
      KFDA = MFDA + I - 1                                               X11B0840
      SIN = 0.                                                          X11B0850
      TMP = 0.                                                          X11B0860
      DO 140 II = KFDA,MLDA,12                                          X11B0870
      TMP = TMP + STSI(II)                                              X11B0880
  140 SIN = SIN + 1.                                                    X11B0890
      TMP = TMP/SIN                                                     X11B0900
      DO 163 J = KFDA, MLDA, 12                                         X11B0910
C --- TEST FOR FULL WEIGHT -100.                                        X11B0920
      IF (STWT(J)-100.) 123,163,123                                     X11B0930
  123 KSWEX = 2                                                         X11B0940
C --- COMPUTE AVGE OF NON-FULL WT. VALUE  TIMES ITS WT. AND 4 NEAREST   X11B0950
C --- FULL WT. VALUES                                                   X11B0960
      STSI(J) = STSI(J) * STWT(J)/100.                                  X11B0970
      N = 0                                                             X11B0980
      NT = 400                                                          X11B0990
      IF (J-12-KFDA) 125,125,124                                        X11B1000
  124 IF (J+24-MLDA)126,126,125                                         X11B1010
  125 NT = 300                                                          X11B1020
  126 K = 12                                                            X11B1030
      K2 = 12                                                           X11B1040
      KSWA = 0                                                          X11B1050
  131 L = J - K                                                         X11B1060
      IF (L-KFDA) 132,133,133                                           X11B1070
  132 KSWA = 1                                                          X11B1080
      GO TO 135                                                         X11B1090
  133 IF (STWT(L)-100.) 141,134,141                                     X11B1100
  134 STSI(J) = STSI(J) + STSI(L)                                       X11B1110
      N = N + 100                                                       X11B1120
      IF (N-NT) 135,143,143                                             X11B1130
  135 M = J + K2                                                        X11B1140
      IF (M-MLDA) 137,137,136                                           X11B1150
  136 IF (KSWA) 145,139,145                                             X11B1160
  137 IF (STWT(M)-100.) 142,138,142                                     X11B1170
  138 STSI(J) = STSI(J) + STSI(M)                                       X11B1180
      N = N + 100                                                       X11B1190
      IF (N-NT) 139,143,143                                             X11B1200
  139 K2 = K2 + 12                                                      X11B1210
  141 K = K + 12                                                        X11B1220
      GO TO 131                                                         X11B1230
  142 K2 = K2 + 12                                                      X11B1240
      GO TO 135                                                         X11B1250
C --- IF FEWER THAN 4 FULL WEIGHT VALUES IN MONTH, REPLACE EXTREME WITH X11B1260
C --- AVGE OF ALL SI RATIOS.                                            X11B1270
  145 STSI(J) = TMP                                                     X11B1280
      GO TO 171                                                         X11B1290
  143 X = N                                                             X11B1300
      STSI(J) = STSI(J)/(STWT(J)+X)*100.                                X11B1310
  171 STI(J) = STSI(J)                                                  X11B1320
  163 CONTINUE                                                          X11B1330
      KTABL = 4 + KADD                                                  X11B1340
      IN = 1                                                            X11B1350
      IF (KPRNT-7) 256,255,256                                          X11B1360
C --- WRITE REPLACEMENT VALUES FOR EXTREME SI RATIOS -B4. OR B9.        X11B1370
  255 CALL RITE (KTABL,STI,MFDA,MLDA,6,6,STDEV)                         X11B1380
  256 GO TO (169,180), KSECT                                            X11B1390
C --- PART C + D ONLY.                                                  X11B1400
  113 IF (KPRNT-6) 169,169,257                                          X11B1410
C --- WRITE MODIFIED SI RATIOS -C4. OR D4.                              X11B1420
  257 CALL RITE (4,STSI,MFDA,MLDA,5,4,0)                                X11B1430
C --- THE FOLLOWING CODING IS USED IN PARTS B,C AND D                   X11B1440
C --- COMPUTE ESTIMATE OF SEASONAL FACTORS                              X11B1450
  169 CALL VSFC (MFDA,MLDA,KSECT)                                       X11B1460
C --- REPLACE 6 MISSING VALUES AT EACH END DUE TO USE OF CENTERED       X11B1470
C --- 12-TERM TREND CYCLE MOVING AVERAGE                                X11B1480
      DO 170 I = 1,6                                                    X11B1490
      J = LFDA + I - 1                                                  X11B1500
      K = LLDA - I + 1                                                  X11B1510
      STS(J) = STS(J+12)                                                X11B1520
  170 STS(K) = STS(K-12)                                                X11B1530
C --- OBTAIN PRLIM SEASONALLY ADJUSTED SERIES                           X11B1540
      CALL ADDMUL (STCI,STCSI,STS,LFDA,LLDA)                            X11B1550
      IF (KPRNT-6) 259,259,258                                          X11B1560
C --- WRITE SEASONAL FACTORS -B5.,C5., OR D5.                           X11B1570
  258 CALL RITE (5,STS,LFDA,LLDA,4,4,0)                                 X11B1580
C --- WRITE SEASONALLY ADJUSTED SERIES -B6.,C6., OR D6.                 X11B1590
      CALL RITE (6,STCI,LFDA,LLDA,5,7,0)                                X11B1600
  259 KSECT = 2                                                         X11B1610
      GO TO (160,168,168),KPART                                         X11B1620
C --- PART B ONLY                                                       X11B1630
  160 NTERM = 999                                                       X11B1640
C --- APPLY VARIABLE TREND CYCLE ROUTINE TO SEASONALLY ADJUSTED SERIES  X11B1650
C --- *VTC MODIFIED SO 13-TERM M.A. IS SELECTED FOR I/C OF 1. OR MORE*  X11B1660
      IF (KEXOPT) 161,168,161                                           X11B1670
C --- MODIFY CI VALUES BEFORE TREND CYCLE ROUTINE IF OPTION SELECTED    X11B1680
  161 CALL VTC (LFDA,LLDA,KTCOPT)                                       X11B1690
C --- DIVIDE SEASONALLY ADJUSTED SERIES BY TREND CYCLE FOR ESTIMATE OF  X11B1700
C --- IRREGULAR                                                         X11B1710
      CALL ADDMUL (STI,STCI,STC,LFDA,LLDA)                              X11B1720
C --- IDENTIFY EXTREME IRREGULAR VALUES                                 X11B1730
      CALL XTRM (STI,STDEV,STWT,LFDA,LLDA,SIGMU,SIGML,KEXT)             X11B1740
C --- REPLACE CORRESPONDING CI VALUES FOR IRRS. RECVING LESS THAN FULL  X11B1750
C --- WEIGHT                                                            X11B1760
      DO 167 I = LFDA, LLDA                                             X11B1770
      IF (STWT(I)-100.) 162,167,167                                     X11B1780
  162 STCI(I) = STCI(I)*STWT(I)/100.                                    X11B1790
      N = 0                                                             X11B1800
      NT = 400                                                          X11B1810
      IF (I-1-LFDA) 165,165,164                                         X11B1820
  164 IF (I+1-LLDA) 166,165,165                                         X11B1830
  165 NT = 300                                                          X11B1840
  166 K = 1                                                             X11B1850
      K2 = 1                                                            X11B1860
      KSWA = 0                                                          X11B1870
  146 L = I - K                                                         X11B1880
      IF (L-LFDA) 150,151,151                                           X11B1890
  150 KSWA = 1                                                          X11B1900
      GO TO 153                                                         X11B1910
  151 IF (STWT(L)-100.) 158,152,152                                     X11B1920
  152 STCI(I) = STCI(I) + STCI(L)                                       X11B1930
      N = N + 100                                                       X11B1940
      IF (N-NT) 153,144,144                                             X11B1950
  153 L = I + K2                                                        X11B1960
      IF(L-LLDA) 155,155,154                                            X11B1970
  154 IF (KSWA) 144,157,144                                             X11B1980
  155 IF (STWT(L)-100.) 159,156,159                                     X11B1990
  156 STCI(I) = STCI(I) + STCI(L)                                       X11B2000
      N = N + 100                                                       X11B2010
      IF (N-NT) 157,144,144                                             X11B2020
  157 K2 = K2 + 1                                                       X11B2030
  158 K = K + 1                                                         X11B2040
      GO TO 146                                                         X11B2050
  159 K2 = K2 + 1                                                       X11B2060
      GO TO 153                                                         X11B2070
  144 X = N                                                             X11B2080
      STCI(I) = STCI(I)/(STWT(I)+X)*100.                                X11B2090
  167 CONTINUE                                                          X11B2100
C --- THE FOLLOWING CODING IS USED IN PARTS B,C AND D                   X11B2110
C --- APPLY THE VARIABLE TREND CYCLE ROUTINE TO THE (MODIFIED) CI VALUESX11B2120
  168 CALL VTC (LFDA,LLDA,KTCOPT)                                       X11B2130
  178 IF (KPRNT-5) 260,262,261                                          X11B2140
  260 GO TO (262,261,262,261),KPRNT                                     X11B2150
C --- WRITE TREND CYCLE -B7.,C7., OR D7.                                X11B2160
  261 CALL RITE (7,STC,LFDA,LLDA,5,7,0)                                 X11B2170
C --- DIVIDE B1 BY B7 *C1 BY C7,D1 BY D7* TO OBTAIN SI RATIOS           X11B2180
  262 CALL ADDMUL (STSI,STCSI,STC,LFDA,LLDA)                            X11B2190
      MFDA = LFDA                                                       X11B2200
      MLDA = LLDA                                                       X11B2210
  179 KADD = 5                                                          X11B2220
      GO TO (112,676,176),KPART                                         X11B2230
C --- PART C ONLY                                                       X11B2240
  676 IF (KPRNT-9) 180,264,180                                          X11B2250
C --- WRITE MODIFIED SI RATIOS C9.                                      X11B2260
  264 CALL RITE (9,STSI,LFDA,LLDA,5,4,0)                                X11B2270
C --- PART B AND C                                                      X11B2280
C --- COMPUTE WEIGHTED 7-TERM MVG AVG OF EACH MONTH SEPARATELY FOR      X11B2290
C --- ESTIMATE OF SEASONAL FACTORS. TO CENTER COMPUTE CENTERED 12-TERM  X11B2300
C --- MOVING AVGE OF ENTIRE SERIES                                      X11B2310
  180 CALL VSFC (MFDA,MLDA,KSECT)                                       X11B2320
      IF (KPRNT-3) 265,267,266                                          X11B2330
  265 IF (KPRNT-1) 266,267,266                                          X11B2340
C --- WRITE SEASONAL FACTORS -B10. OR C10.                              X11B2350
  266 CALL RITE (10,STS,LFDA,LLDA,4,4,0)                                X11B2360
C --- DIVIDE PRIOR ADJUSTED SERIES*B1. OR A1* BY SEASONAL FACTORS TO    X11B2370
C --- OBTAIN A PRELIM SEASONALLY ADJUSTED SERIES                        X11B2380
  267 CALL ADDMUL (STCI,STOPA,STS,LFDA,LLDA)                            X11B2390
      IF (KPRNT-4) 269,269,268                                          X11B2400
C --- WRITE SEASONALLY ADJUSTED SERIES -B11. OR C11.                    X11B2410
  268 CALL RITE (11,STCI,LFDA,LLDA,5,7,0)                               X11B2420
C --- DIVIDE SEASONALLY ADJUSTED SERIES BY TREND CYCLE TO OBTAIN PRELIM X11B2430
C --- IRREGULAR                                                         X11B2440
  269 CALL ADDMUL (STI,STCI,STC,LFDA,LLDA)                              X11B2450
      IF (KPRNT-3) 187,187,240                                          X11B2460
C --- WRITE IRREGULAR SERIES -B13. OR C13. *B12. +C12. NOT USED*        X11B2470
  240 CALL RITE (13,STI,LFDA,LLDA,3,5,0)                                X11B2480
  187 KSWK = KDWOPT * 4 + KSWT                                          X11B2490
      IF (KDWOPT) 300,300,204                                           X11B2500
  204 KSWK = KSWK - 4                                                   X11B2510
C --- COMPUTE TRADING DAY REGRESSION FACTORS FOR ALL OPTIONS EXCEPT     X11B2520
C --- *SKIP REGRESSION*                                                 X11B2530
  207 CALL TRADAY (LFDC,LLDA,LCYR,SIGM,KPART,LOPT,KSWT)                 X11B2540
      IF (MULADD) 208,203,208                                           X22B2545
C --- IF MULT., ADD 1. TO EACH DAILY FACTOR                             X11B2550
  203 DO 200 I = 1, 7                                                   X11B2560
  200 D(I) = D(I) + 1.                                                  X11B2570
C --- COMPUTE MONTHLY FACTORS FROM 7 T.D.REGR. FACTORS                  X11B2580
      MOPT = 0                                                          X11B2584
      GO TO (208,205,208,205),KSWT                                      X11B2585
  205 MOPT = 8                                                          X11B2586
  208 CALL DOW (D,STTDRF,LYR,LFDA,LLDA,MOPT)                            X11B2590
      IF (KPRNT-1) 271,302,271                                          X11B2600
C --- WRITE T.D.REGRESSION FACTORS -B16. OR C16.                        X11B2610
  271 CALL RITE (16,STTDRF,LFDR,LLDA,4,4,D)                             X11B2620
C --- SKIP BALANCE OF TRADING DAY REGR. IF *COMPUTE BUT DO NOT APPLY*   X11B2630
C --- OPTION WAS SELECTED                                               X11B2640
  302 IF (KDWOPT-2) 300,230,202                                         X11B2650
C --- DISREGARD RESULTS OF F-TEST IN PART B IF *APPLY ON BASIS OF F* O  X11B2660
C --- OPTION SELECTED AND APPLY T.D.REGRESSION                          X11B2670
  202 IF (KPART-1) 206,201,206                                          X11B2680
C --- IN PART C APPLY T.D. REGR. OR NOT ON BASIS OF F.                  X11B2690
  206 IF (FSTAR-BLANK) 201,221,201                                      X11B2700
  221 KSWK = KSWK - 8                                                   X11B2710
      GO TO 300                                                         X11B2720
  201 KSWK = KSWK - 4                                                   X11B2730
C --- DIVIDE IRREGULAR BY T.D. REGR FACTORS TO OBTAIN AN IRREGULAR FREE X11B2740
C --- OF T.D.VARIATION                                                  X11B2750
  230 CALL ADDMUL (STI,STI,STTDRF,LFDR,LLDA)                            X11B2760
C --- COMPUTE WEIGHTS FOR IRREGULAR COMPONENT                           X11B2770
  300 CALL XTRM (STI,STDEV,STWT,LFDA,LLDA,SIGMU,SIGML,KEXT)             X11B2780
C --- WRITE WEIGHTS FOR IRREGULAR COMPONENT -B17. OR C17.               X11B2790
      IN = 1                                                            X11B2800
      DO 233 I=LFDA,LLDA                                                X11B2805
  233 STMP(I) = STPTDF(I)                                               X11B2806
      IF (KPRNT-1) 272,273,272                                          X11B2810
  272 CALL RITE (17,STWT,LFDA,LLDA,6,1,STDEV)                           X11B2820
C --- IF THERE ARE PRIOR T.D. WEIGHTS AND REGR.T.D. WTS B18.,C18,B19,C19X11B2830
C --- ARE PRINTED OUT. IF THERE ARE NO T.D. WIGHTS THEY ARE SUPPRESSED. X11B2840
C --- IF THERE ARE PRIOR T.D. WTS. BUT NO REGR. WTS. B18 AND C18 ARE THEX11B2850
C --- SAME AS A4 AND B19 AND C19 ARE THE SAME AS B1. IF THERE ARE REGR  X11B2860
C --- WTS AND NO PRIOR T.D. WTS B18 AND C18 ARE THE SAME AS B16 +C16    X11B2870
C --- AND B19 + C19 ARE PRINTED OUT                                     X11B2880
  273 GO TO (359,356,359,356,355,340,355,340),KSWK                      X11B2890
  356 IF (KPRNT-2) 359,359,358                                          X11B2900
  358 CALL RITE (18,0,0,0,18,0,0)                                       X11B2910
  359 GO TO 232                                                         X11B2940
  355 IF (KPART - 1) 366,366,373                                        X11B2945
  373 IF (LOPT) 366,366,340                                             X11B2950
  366 DO 314 I = LFDR,LLDA                                              X11B2955
  314 STMP(I) = STTDRF(I)                                               X11B2956
      IF (KPRNT-2) 232,232,357                                          X11B2960
  357 CALL RITE (18,0,0,0,19,0,0)                                       X11B2970
      GO TO 232                                                         X11B2980
C --- COMBINE PRIOR AND REGR WTS                                        X11B2990
  340 DO 337 I = 1, 7                                                   X11B3000
  337 D(I) = D(I) + DWT(I) - 1.                                         X11B3010
C --- COMPUTE MONTHLY FACTORS FROM COMBINED DAILY WTS.                  X11B3020
      CALL DOW (D,STMP,LYR,LFDR,LLDA,LOPT)                              X11B3030
      IF (KPRNT-2) 232,232,275                                          X11B3040
C --- WWRITE TRADING DAY FACTORS FROM COMBINED WTS. -B18. OR C18.       X11B3050
  275 CALL RITE (18,STMP,LFDA,LLDA,4,4,D)                               X11B3060
  232 IF (KPART-1) 350,350,351                                          X11B3070
C --- PART C ONLY                                                       X11B3080
C --- COMPUTE AVGE MONTH-TO-MONTH CHANGES OF COMBINED T.D. FACTORS      X11B3090
  351 DO 311 I = LFDA,LLDA                                              X11B3095
  311 STTDRF(I) = STMP(I)                                               X11B3096
      CALL SUMRY (STTDRF,SMTD,LFDA,LLDA,1)                              X11B3100
C --- PART B AND C                                                      X11B3110
C --- DIVIDE PRIOR MONTHLY ADJUSTED -*A3 OR A1* BY COMBINED T.D. FACTORSX11B3120
C --- TO OBTAIN CALENDAR ADJUSTED SERIES                                X11B3130
  350 CALL ADDMUL (STOCCA,STOPMA,STMP,LFDA,LLDA)                        X11B3140
      IF (KSWK-3) 370,354,352                                           X11B3150
  370 IF (KSWK-1) 352,354,352                                           X11B3160
  352 IF (KPRNT-2) 354,354,277                                          X11B3170
C --- WRITE ORIGINAL SERIES ADJUSTED FOR CALENDAR VARIATION -B19 OR C19.X11B3180
  277 CALL RITE (19,STOCCA,LFDA,LLDA,2,7,0)                             X11B3190
C --- MODIFY THE ORIGINAL SERIES ADJUSTED FOR CALENDAR VARIATION FOR    X11B3200
C --- EXTREMES WHERE IRREGULAR VALUES RECVD LESS THAN FULL WT.          X11B3210
  354 IF (MULADD) 336,353,336                                           X11B3220
  336 DO 347 I = LFDA,LLDA                                              X11B3230
      STCSI(I) = STOCCA(I)                                              X11B3240
      IF (STWT(I)-100.) 338,347,338                                     X11B3250
  338 STCSI(I) = STOCCA(I)-(STI(I)*(1.0-STWT(I)/100.))                  X11B3260
  347 CONTINUE                                                          X11B3270
      GO TO 335                                                         X11B3280
  353 DO 348 I = LFDA,LLDA                                              X11B3290
      STCSI(I) = STOCCA(I)                                              X11B3300
      IF (STWT(I)-100.) 333,348,333                                     X11B3310
  333 STCSI(I)=STOCCA(I)*((100.-STWT(I))/STI(I)+STWT(I)/100.)           X11B3320
  348 CONTINUE                                                          X11B3330
  335 KPRNT = KPRNT + 2                                                 X11B3340
      GO TO (346,332),KPART                                             X11B3350
C --- BEGIN PART C                                                      X11B3360
  346 KPART = 2                                                         X11B3370
      PART = CS                                                         X11B3380
      GO TO 343                                                         X11B3390
C --- BEGIN PART D                                                      X11B3400
  332 KPART = 3                                                         X11B3410
      PART = DS                                                         X11B3420
  343 KSECT = 1                                                         X11B3430
      IF (KPRNT-5) 278,281,279                                          X11B3440
  278 IF (KPRNT-3) 279,281,279                                          X11B3450
C --- WRITE MODIFIED ORIGINAL SERIES - C1. OR D1.                       X11B3460
  279 CALL RITE (1,STCSI,LFDA,LLDA,5,7,0)                               X11B3470
  281 FINAP(1)=FINAL(1)                                                 X11B3480
      FINAP(2)=FINAL(2)                                                 X11B3481
      GO TO 100                                                         X11B3490
C --- PART D ONLY                                                       X11B3500
C --- DIVIDE CALENDAR ADJUSTED SERIES *C19 IF REGRESSION OPTION SELECTEDX11B3510
C ---  B1 IF PRIOR ADJUSTMENT ONLY OR A1 IF NO CALENDAR ADJUSTMENT* BY TX11B3520
C --- TREND CYCLE -D7. TO OBTAIN FINAL UNMODIFIED SI RATIOS             X11B3530
  176 CALL ADDMUL (STSIE,STOCCA,STC,LFDA,LLDA)                          X11B3540
C --- COMPUTE SEASONAL FACTORS                                          X11B3550
      CALL VSFC (MFDA,MLDA,KSECT)                                       X11B3560
      FINAB(1)=FINAL(1)                                                 X11B3570
      FINAB(2)=FINAL(2)                                                 X11B3571
C --- WRITE UNMODIFIED SI RATIOS -D8.                                   X11B3580
      CALL RITE (8,STSIE,LFDA,LLDA,5,4,0)                               X11B3590
  654 FORMAT (/20X,23HSTABLE SEASONALITY TEST)                          X11B3600
      WRITE (NW,654)                                                    X11B3610
C --- PERFORM ANALYSIS OF VARIANCE ON UNMODIFIED SI RATIOS              X11B3620
      CALL FTEST (STSIE,LFDA,LLDA)                                      X11B3630
C --- IDENTIFY SI RATIOS WHICH ARE NOT IDENTICAL IN D7. AND D8.         X11B3640
      DO 677 I = LFDA,LLDA                                              X11B3650
      STMP(I) =10.**10                                                  X11B3660
      IF (STSIE(I) - STSI(I)) 678,677,678                               X11B3670
  678 STMP(I) = STSI(I)                                                 X11B3680
  677 CONTINUE                                                          X11B3690
C --- WRITE FINAL REPLACEMANT VALUES FOR EXTREME SI RATIOS -D9.         X11B3700
      CALL RITE (9,STMP,LFDA,LLDA,6,4,0)                                X11B3710
C --- COMPUTE YEAR AHEAD SEASONAL FACTORS                               X11B3720
  198 J = LLDA + 1                                                      X11B3730
      K = LLDA + 12                                                     X11B3740
      DO 197 I = J,K                                                    X11B3750
  197 STS(I) =(3.*STS(I-12)-STS(I-24))/2.                               X11B3760
C --- WRITE FINAL SEASONAL FACTORS - D10.                               X11B3770
      CALL RITE (10,STS,LFDA,LLDA,1,4,0)                                X11B3780
  191 IF (KFULSM) 211,209,211                                           X11B3790
C --- SUMMARY MEASURES VERSION ONLY                                     X11B3800
C --- REPLACE FINAL SEASONALLY ADJUSTED SERIES WITH D1.                 X11B3810
  211 DO 212 I = LFDA,LLDA                                              X11B3820
  212 STCI(I) = STCSI(I)                                                X11B3830
C --- APPLY VARIABLE TREND CYCLE ROUTINE TO D1                          X11B3840
      CALL VTC (LFDA,LLDA,KTCOPT)                                       X11B3850
C --- REPLACE FINAL SEASONALLY ADJUSTED SERIES WITH B1.                 X11B3860
      DO 213 I = LFDA,LLDA                                              X11B3870
  213 STCI(I) = STOR(I)                                                 X11B3880
      GO TO 214                                                         X11B3890
C --- FULL ADJUSTMENT VERSION ONLY                                      X11B3900
C --- DIVIDE D1 BY FINAL SEASONAL FACTORS TO OBTAIN A MODIFIED SEASONAL-X11B3910
C --- LY ADJUSTED SERIES                                                X11B3920
  209 CALL ADDMUL (STCI,STCSI,STS,LFDA,LLDA)                            X11B3930
C --- APPLY THE VARIABLE TREND CYCLE ROUTINE TO THE MOD. SEASONALLY ADJ.X11B3940
C --- SERIES TO OBTAIN FINAL TREND CYCLE                                X11B3950
      CALL VTC (LFDA,LLDA,KTCOPT)                                       X11B3960
C --- DIVIDE THE CALENDAR ADJ. SERIES *C19,B1, OR A1* BY FINAL SEASONAL X11B3970
C --- FACTORS TO OBTAIN A FINAL SEASONALLY ADJ. SERIES                  X11B3980
      CALL ADDMUL (STCI,STOCCA,STS,LFDA,LLDA)                           X11B3990
C --- FOR ALL VERSIONS                                                  X11B4000
C --- WRITE FINAL SEASONALLY ADJUSTED SERIES -D11.                      X11B4010
  214 CALL RITE (11,STCI,LFDA,LLDA,2,7,0)                               X11B4020
C --- WRITE FINAL TREND CYCLE -D12.                                     X11B4030
  190 CALL RITE (12,STC,LFDA,LLDA,2,7,0)                                X11B4040
C --- DIVIDE FINAL SEASONALLY ADJUSTED SERIES BY FINAL TREND CYCLE TO   X11B4050
C --- OBTAIN THE FINAL IRREGULAR                                        X11B4060
      CALL ADDMUL (STI,STCI,STC,LFDA,LLDA)                              X11B4070
C --- WRITE FINAL IRREGULAR -D13.                                       X11B4080
      CALL RITE (13,STI,LFDA,LLDA,3,5,0)                                X11B4090
C --- BEGIN PART E                                                      X11B4100
  334 KPART = 5                                                         X11B4110
      PART = ES                                                         X11B4120
C --- COMPUTE MODIFIED ORIGINAL, SEASONALLLY ADJUSTED AND IRREGUAAR     X11B4130
C --- SERIES BY REPLACING THOSE VALUES WHICH WERE ASSIGNED ZERO WT. IN  X11B4140
C --- TABLE C17.                                                        X11B4150
      DO 362 I = LFDA,LLDA                                              X11B4160
      IF (STWT(I)) 360,367,360                                          X11B4170
  360 STOME(I) = STOR(I)                                                X11B4180
      STCIME(I)= STCI(I)                                                X11B4190
      STIME(I) = STI(I)                                                 X11B4200
      GO TO 362                                                         X11B4210
C --- REPLACE SEASONALLY ADJUSTED VALUES WITH FINAL TREND CYCLE VALUES  X11B4220
  367 STCIME(I) = STC(I)                                                X11B4230
  368 IF (MULADD) 364,363,364                                           X11B4240
C --- IF MULTIPLICATIVE, REPLACE IRREGULAR VALUES WITH 100. AND ORIGINALX11B4250
C --- VALUES WITH THE PRODUCT OF THE FINAL TREND CYCLE, FINAL SEASONAL FX11B4260
C --- FACTORS, COMBINED TRADING DAY FACTORS AND PRIOR MONTHLY FACTORS   X11B4270
  363 STIME(I) = 100.                                                   X11B4280
      STOME(I) = STC(I)*STS(I)/100.*STTDRF(I)/100.*STPMF(I)/100.        X11B4290
      GO TO 362                                                         X11B4300
C --- IF ADDITIVE, REPLACE IRREGULAR VALUES WITH 0. AND ORIGINAL VALUES X11B4310
C --- WITH THE SUM OF THE  ABOVE                                        X11B4320
  364 STIME(I) = 0.                                                     X11B4330
      STOME(I) = STC(I)+STS(I)+STTDRF(I)+STPMF(I)                       X11B4340
  362 CONTINUE                                                          X11B4350
C --- WRITE ORIGINAL SERIES MODIFIED FIR EXTREMES -E1.                  X11B4360
  436 CALL RITE (1,STOME,LFDA,LLDA,2,7,0)                               X11B4370
      IF (KFULSM) 422,421,422                                           X11B4380
C --- FOR FULL ADJUSTMENT ONLY, WRITE MODIFIED SEASONALLY ADJUSTED      X11B4390
C --- SERIES -E2.                                                       X11B4400
  421 CALL RITE (2,STCIME,LFDA,LLDA,2,7,0)                              X11B4410
C --- WRITE MODIFIED IRREGULAR SERIES -E3                               X11B4420
  422 CALL RITE (3,STIME,LFDA,LLDA,3,5,0)                               X11B4430
      IF (KFULSM) 466,438,466                                           X11B4440
C --- FOR FULL ADJUSTMENT ONLY COMPUTE AND WRITE RATIOS OF ANNUAL TOTALSX11B4450
C --- B1/D11 AND E1/E2   -E4.                                           X11B4460
  438 CALL RITE (4,0,0,0,0,0,0)                                         X11B4470
      J = 1                                                             X11B4480
      JYRA = LYR                                                        X11B4490
      IF (LFDA-1) 431,432,431                                           X11B4500
  431 J = 13                                                            X11B4510
      JYRA = LYR + 1                                                    X11B4520
  432 KYRA = LYR + LLDA/12 - 1                                          X11B4530
      DO 434 I = JYRA,KYRA                                              X11B4540
      TOTO = 0.                                                         X11B4550
      TOTOM = 0.                                                        X11B4560
      TOTA = 0.                                                         X11B4570
      TOTAM = 0.                                                        X11B4580
      K = J + 11                                                        X11B4590
      DO 433 L = J,K                                                    X11B4600
      TOTO = TOTO + STOR(L)                                             X11B4610
      TOTOM = TOTOM + STOME(L)                                          X11B4620
      TOTA = TOTA + STCI(L)                                             X11B4630
  433 TOTAM = TOTAM + STCIME(L)                                         X11B4640
      J = J + 12                                                        X11B4650
      IF (MULADD) 424,423,424                                           X11B4660
  423 TOTO = TOTO/TOTA*100.                                             X11B4670
      TOTOM = TOTOM/TOTAM*100.                                          X11B4680
      GO TO 434                                                         X11B4690
  424 TOTO = TOTO - TOTA                                                X11B4700
      TOTOM = TOTOM - TOTAM                                             X11B4710
  434 WRITE (NW,435) SPC,I,TOTO,TOTOM                                   X11B4720
  435 FORMAT (A1,5H   19,I2,5X,F8.1,5X,F8.1)                            X11B4730
  466 MFDA = LFDA + 1                                                   X11B4740
      MLDA = LLDA - 1                                                   X11B4750
C --- COMPUTE AVGE CHANGES IN ORIGINAL AND SEASONALLY ADJUSTED SERIES   X11B4760
      IF (MULADD) 437,440,437                                           X11B4770
  437 CALL ADDMUL (STMP2,STOR2,STOR,LFDA,MLDA)                          X11B4780
      GO TO 444                                                         X11B4790
  440 DO 448 I = MFDA,LLDA                                              X11B4800
  448 STMP(I) = (STOR(I)-STOR(I-1))/STOR(I-1)*100.                      X11B4810
C --- WRITE AVGE CHANGES IN ORIGINAL SERIES -E5.                        X11B4820
  444 CALL RITE (5,STMP,MFDA,LLDA,5,4,0)                                X11B4830
      IF (KFULSM) 439,467,439                                           X11B4840
  467 IF (MULADD) 430,455,430                                           X11B4850
  430 CALL ADDMUL (STMP2,STCI2,STCI,LFDA,MLDA)                          X11B4860
      GO TO 420                                                         X11B4870
  455 DO 425 I = MFDA,LLDA                                              X11B4880
  425 STMP(I) = (STCI(I)-STCI(I-1))/STCI(I-1)*100.                      X11B4890
C --- WRITE AVGE CHANGES IN SEASONALLY ADJUSTED SERIES -E6.             X11B4900
  420 CALL RITE (6,STMP,MFDA,LLDA,5,4,0)                                X11B4910
C --- COMPUTE AVGE CHANGES IN I + C OVER 1-12 MONTH SPANS               X11B4920
  439 CALL SUMRY (STI,SMI,LFDA,LLDA,2)                                  X11B4930
      CALL SUMRY (STC,SMC,LFDA,LLDA,2)                                  X11B4940
      DO 400 I = 1,12                                                   X11B4950
C --- COMPUTE I/C TO DETERMINE MCD                                      X11B4960
  400 SMIC(I) = SMI(I)/SMC(I)                                           X11B4970
      MCD = 5                                                           X11B4980
  402 IF (SMIC(MCD) - .995) 401,426,426                                 X11B4990
  401 IF (MCD-1) 412,412,413                                            X11B5000
  413 MCD = MCD - 1                                                     X11B5010
      GO TO 402                                                         X11B5020
C---  COMPUTE MCD MOVING AVERAGE                                        X11B5030
  426 MCD = MCD + 1                                                     X11B5040
  427 MFDA = LFDA + MCD/2                                               X11B5050
      MLDA = LLDA - (MCD-1)/2                                           X11B5060
      J = (MCD+2)/2                                                     X11B5070
      XMCD = MCD                                                        X11B5080
      DO 408 I = MFDA, MLDA                                             X11B5090
      TMP = 0.                                                          X11B5100
      DO 407 I2 = 1, MCD                                                X11B5110
      L = I + I2 - J                                                    X11B5120
  407 TMP = TMP + STCI(L)                                               X11B5130
  408 STMCD(I) = TMP/XMCD                                               X11B5140
C --- COMPUTE AVGE MO-TO-MO CHANGES IN MCD FOR SUMMARY MEASURES TABLE   X11B5150
      CALL SUMRY (STMCD,SMMCD,MFDA,MLDA,3)                              X11B5160
C --- COMPUTE AVGE DURATION OF RUN OF MCD SERIES                        X11B5170
      CALL AVDUR (STMCD,MFDA,MLDA,ADRMCD)                               X11B5180
  412 KPART = 6                                                         X11B5190
      PART = FS                                                         X11B5200
C --- WRITE MCD MOVING AVERAGE -F1.                                     X11B5210
      CALL RITE (1,STMCD,MFDA,MLDA,5,7,0)                               X11B5220
C --- COMPUTE MEASURES FOR SUMMARY MEASURES TABLE                       X11B5230
      CALL SUMRY (STS,SMS,LFDA,LLDA,2)                                  X11B5240
      CALL SUMRY (STOR,SMO,LFDA,LLDA,2)                                 X11B5250
      CALL SUMRY (STCI,SMCI,LFDA,LLDA,3)                                X11B5260
      CALL SUMRY (STOME,SMOME,LFDA,LLDA,4)                              X11B5270
      IF (KFULSM) 469,458,469                                           X11B5280
C --- IN SUMMARY MEASURES RUN REPLACE SEASONALLY ADJUSTED WITH ORIGINAL X11B5290
  469 DO 468 I = 1,12                                                   X11B5300
  468 SMCIME(I) = SMOME(I)                                              X11B5310
      GO TO 459                                                         X11B5320
  458 CALL SUMRY (STCIME,SMCIME,LFDA,LLDA,4)                            X11B5330
  459 CALL SUMRY (STIME,SMIME,LFDA,LLDA,4)                              X11B5340
      CALL AVDUR (STCI,LFDA,LLDA,ADRCI)                                 X11B5350
      CALL AVDUR (STI,LFDA,LLDA,ADRI)                                   X11B5360
      CALL AVDUR (STC   ,LFDA,LLDA,ADRC)                                X11B5370
C --- IF MCD IS 1, MCD IS SAME AS SEASONALLY ADJUSTED SERIES            X11B5380
      IF (MCD-1) 464,454,464                                            X11B5390
  454 ADRMCD = ADRCI                                                    X11B5400
      DO 465 I = 1,12                                                   X11B5410
  465 SMMCD(I) = SMCI(I)                                                X11B5420
C --- WRITE TABLE HEADING FOR SUMMARY MEASURES                          X11B5430
  464 CALL RITE (2,0,0,0,0,0,0)                                         X11B5440
      SWO = BLANK                                                       X11B5450
      IF (KDWOPT-2) 284,285,283                                         X11B5460
  283 IF (FSTAR-BLANK) 285,284,285                                      X11B5470
  284 GO TO (286,285,286,285), KSWT                                     X11B5480
  285 SWO = STAR                                                        X11B5490
C --- WRITE AVGE CHANGE W/O REGARD TO SIGN. 1-12 MOS. SPAN              X11B5500
  286 WRITE (NW,1000) PCDIF,AORB,SWO                                    X11B5510
 1000 FORMAT (                                                          X11B5520
     19X,7HAVERAGE,4A4,43H WITHOUT REGARD TO SIGN OVER INDICATED SPAN   X11B5530
     2/                                                                 X11B5540
     314X,4HSPAN/                                                       X11B5550
     415X,2HIN,6X,A1,88H1     D11     D13     D12     D10      A2     C1X11B5560
     58      F1             E1      E2      E3/                         X11B5570
     613X,59HMONTHS    O      CI       I       C       S       P      TDX11B5580
     7,A1,40H     MCD           MOD.O   MOD.CI  MOD.I)                  X11B5590
      DO 443 I = 1,12                                                   X11B5600
      J = I + 12                                                        X11B5610
      IF (I-8) 442,443,441                                              X11B5620
  441 IF (I-10)442,443,442                                              X11B5630
  442 WRITE(NW,1001)I,SMO(I),SMCI(I),SMI(I),SMC(I),SMS(I),SMP(I),SMTD(I)X11B5640
     1,SMMCD(I),SMOME(I),SMCIME(I),SMIME(I)                             X11B5650
 1001 FORMAT (15X,I2,8F8.2,9X,3F8.2)                                    X11B5660
C --- COMPUTE CONTRIBUTIONS TO ORIGINAL SERIES IN FULL ADJUST. RUN ONLY X11B5670
      SMO2(I)=SMI(J)+SMC(J)+SMS(J)+SMP(J)+SMTD(J)                       X11B5680
  428 SMI(J) = SMI(J)/SMO2(I)                                           X11B5690
      SMC(J) = SMC(J)/SMO2(I)                                           X11B5700
      SMS(J) = SMS(J)/SMO2(I)                                           X11B5710
      SMP(J) = SMP(J)/SMO2(I)                                           X11B5720
      SMTD(J)=SMTD(J)/SMO2(I)                                           X11B5730
      SMO2(I)=SMO2(I)/SMO(J)                                            X11B5740
  443 CONTINUE                                                          X11B5750
      IF (KFULSM) 429,499,429                                           X11B5760
  499 WRITE (NW,1002) SWO                                               X11B5770
 1002 FORMAT (/9X,67HRELATIVE CONTRIBUTIONS OF COMPONENTS TO VARIANCE INX11B5780
     1 ORIGINAL SERIES/                                                 X11B5790
     2 14X,4HSPAN/                                                      X11B5800
     315X,58HIN    D13     D12     D10      A2     C18            RATIO/X11B5810
     413X,42HMONTHS   I       C       S       P      TD,A1,18H    TOTAL X11B5820
     5  (X100))                                                         X11B5830
      DO 447 I = 1,12                                                   X11B5840
      J = I + 12                                                        X11B5850
      IF (I-8) 446,447,445                                              X11B5860
  445 IF (I-10)446,447,446                                              X11B5870
  446 WRITE (NW,1003) I,SMI(J),SMC(J),SMS(J),SMP(J),SMTD(J),SMO2(I)     X11B5880
 1003 FORMAT (15X,I2,2P5F8.2,9H   100.00, F8.2)                         X11B5890
  447 CONTINUE                                                          X11B5900
C --- WRITE AVERAGE DURATIONS OF RUN                                    X11B5910
  429 WRITE (NW,1004) ADRCI,ADRI,ADRC,ADRMCD,(SMIC(I),I=1,12),MCD       X11B5920
 1004 FORMAT(/9X,55HAVERAGE DURATION OF RUN      CI      I       C      X11B5930
     1MCD/33X,4F8.2//9X,25HI/C RATIO FOR MONTHS SPAN/23X,89H1       2   X11B5940
     2    3       4       5       6       7       8       9      10     X11B5950
     3 11      12/17X,12F8.2//                                          X11B5960
     3 9X,31HMONTHS FOR CYCLICAL DOMINANCE  ,I2/)                       X11B5970
      WRITE (NW,1005) (PCDIF(I),I=1,4),AORB                             X11B5980
 1005 FORMAT (9X,7HAVERAGE,4A4,63H WITH REGARD TO SIGN AND STANDARD DEVIX11B5990
     1ATION OVER INDICATED SPAN/                                        X11B6000
     214X,4HSPAN,8X,A1,1H1,15X,3HD13,14X,3HD12,14X,3HD10,14X,3HD11,15X, X11B6010
     32HF1/15X,2HIN,10X,1HO,16X,1HI,16X,1HC,16X,1HS,16X,2HCI,14X,3HMCD/ X11B6020
     413X,106HMONTHS   AVGE    S.D.     AVGE    S.D.     AVGE    S.D.   X11B6030
     5  AVGE    S.D.     AVGE    S.D.     AVGE    S.D.)                 X11B6040
      DO 451 I = 1,12                                                   X11B6050
      J = I + 24                                                        X11B6060
      K = I+36                                                          X11B6070
      IF (I-8) 450,451,449                                              X11B6080
  449 IF (I-10)450,451,450                                              X11B6090
C --- WRITE AVERAGE CHANGE WITH REGARD TO SIGN                          X11B6100
  450 WRITE (NW,1006) I,SMO(J),SMO(K),SMI(J),SMI(K),SMC(J),SMC(K),SMS(J)X11B6110
     1,SMS(K),SMCI(J),SMCI(K),SMMCD(J),SMMCD(K)                         X11B6120
 1006 FORMAT (15X,I2,6(F9.2,F8.2))                                      X11B6130
  451 CONTINUE                                                          X11B6140
      IF (SWO-STAR) 457,289,457                                         X11B6150
  289 WRITE (NW,1007) OUT                                               X11B6160
 1007 FORMAT(//10X,38H* [TRADING DAY ADJUSTMENT FACTORS WITH,A3,28H LENGX11B6170
     1TH OF MONTH ADJUSTMENT])                                          X11B6180
C --- BEGIN PART G                                                      X11B6190
  457 PART = GS                                                         X11B6200
      KPART = 7                                                         X11B6210
      MLDA = LLDA+12                                                    X11B6220
      IF (KCHOPT-1) 506,510,506                                         X11B6230
C --- CHART G1                                                          X11B6240
  506 CALL CHART (2,MDEC,0,LFDA,LLDA,LLDA,LYR,1,STCI,STC,STC)           X11B6250
      IF (KFULSM) 510,507,510                                           X11B6260
C --- CHART G2                                                          X11B6270
  507 CALL CHART (3,0,2,LFDA,MLDA,LLDA,LYR,2,STSIE,STSI,STS)            X11B6280
      IF (KCHOPT) 508,510,508                                           X11B6290
C --- CHART G3                                                          X11B6300
  508 CALL CHART (3,0,0,LFDA,MLDA,LLDA,LYR,3,STSIE,STSI,STS)            X11B6310
C --- CHART G4                                                          X11B6320
  509 CALL CHART (2,0,0,LFDA,LLDA,LLDA,LYR,4,STI,STIME,STIME)           X11B6330
  510 RETURN                                                            X11B6340
      END                                                                       
C --- LIP FOR ADDMUL,ADDMUL,ADDMUS                                      X11C0010
C --- THIS ROUTINE DIVIDES ARRAY1 BY ARAAY2*100. OR SUBTRACTS ARRAY2    X11C0020
C --- FROM ARRAY1 DEPENDING ON WHETHER A MULTIPLICATIVE OR ADDITIVE ADJ X11C0030
C --- IS BEING MADE.                                                    X11C0040
      SUBROUTINE ADDMUL (RESULT,ARRAY1,ARRAY2,JFDA,JLDA)                X11C0050
      DIMENSION RESULT(600),ARRAY1(600),ARRAY2(600)                     X11C0060
      COMMON/CJ/MULADD                                                  X11C0070
      IF (MULADD) 2,1,2                                                 X11C0080
    1 DO 3 I = JFDA,JLDA                                                X11C0090
    3 RESULT(I) = ARRAY1(I)/ARRAY2(I)*100.                              X11C0100
      RETURN                                                            X11C0110
    2 DO 4 I = JFDA,JLDA                                                X11C0120
    4 RESULT(I) = ARRAY1(I)-ARRAY2(I)                                   X11C0130
      RETURN                                                            X11C0140
      END                                                               X11C0150
C --- LIP FOR AVDUR,AVDUR,AVDUS                                         X11D0010
C --- THIS ROUTINE COMPUTES THE AVERAGE DURATION OF RUN OF THE SERIES I X11D0020
C --- IN *ARRAY*.                                                       X11D0030
      SUBROUTINE AVDUR (ARRAY, JFDA, JLDA, ADR)                         X11D0040
      DIMENSION ARRAY (600)                                             X11D0050
      RUNS = 1.                                                         X11D0060
      ADR = JLDA - JFDA                                                 X11D0070
      K = JLDA - 1                                                      X11D0080
      KSW = 0                                                           X11D0090
      IF (ARRAY(JFDA+1) -  ARRAY(JFDA)) 20, 21, 21                      X11D0100
   20 KSW = 1                                                           X11D0110
   21 DO 9 I = JFDA, K                                                  X11D0120
   15 IF (ARRAY(I+1) - ARRAY(I)) 16, 9, 17                              X11D0130
   16 IF (KSW-1) 8,9,8                                                  X11D0140
    8 KSW = 1                                                           X11D0150
      GO TO 18                                                          X11D0160
   17 IF (KSW) 7,9,7                                                    X11D0170
    7 KSW = 0                                                           X11D0180
   18 RUNS = RUNS + 1.                                                  X11D0190
    9 CONTINUE                                                          X11D0200
   19 ADR = ADR/RUNS                                                    X11D0210
      RETURN                                                            X11D0220
      END                                                               X11D0230
C --- LIP FOR CHART,CHART,CHARTS                                        X11E0010
      SUBROUTINE CHART (NOSER,LOG,MO,IBEG,IEND,IENDA,LYR,LTABL,A,B,C)   X11E0020
      COMMON/CA/NW,NX(112),Y(12),STMP(476)                              X11E0030
      DIMENSION A(600),B(600),C(612),MO1(12),MO2(12),NM(7),NY(7),       X11E0040
     1 NZ1(111),NZ2(111),MO3(12)                                        X11E0041
      DATA DUMMY,NLETX,NAST,NLETO,NBLANK,NPLUS/1H ,1HX,1H*,1HO,1H ,1H</ X11E0050
      DATA MO1/4HJANU,4HFEBR,4HMARC,4HAPRI,4HMAY ,4HJUNE,4HJULY,4HAUGU, X11E0060
     1 4HSEPT,4HOCTO,4HNOVE,4HDECE/                                     X11E0070
      DATA MO2/3HARY,4HUARY,1HH,1HL,1H ,1H ,1H ,2HST,4HEMBE,3HBER,4HMBERX11E0080
     1 ,4HMBER/                                                         X11E0090
      DATA MO3/1H ,1H ,1H ,1H ,1H ,1H ,1H ,1H ,1HR,1H ,1H ,1H /         X11E0091
      DATA NM/4H(4H ,4H 19,,4HI2,1,2HX,,1H ,1H ,3HA1)/                  X11E0100
      DATA NY/4H(1X,,4HA3,I,4H2,1X,1H,,1H ,1H ,3HA1)/                   X11E0110
      DATA NZ1/1H ,4H  1X,4H  2X,4H  3X,4H  4X,4H  5X,4H  6X,4H  7X,    X11E0120
     1 4H  8X,4H  9X,4H 10X,4H 11X,4H 12X,4H 13X,4H 14X,4H 15X,4H 16X,  X11E0125
     2 4H 17X,4H 18X,4H 19X,4H 20X,4H 21X,4H 22X,4H 23X,4H 24X,4H 25X,  X11E0130
     3 4H 26X,4H 27X,4H 28X,4H 29X,4H 30X,4H 31X,4H 32X,4H 33X,4H 34X,  X11E0135
     4 4H 35X,4H 36X,4H 37X,4H 38X,4H 39X,4H 40X,4H 41X,4H 42X,4H 43X,  X11E0140
     5 4H 44X,4H 45X,4H 46X,4H 47X,4H 48X,4H 49X,4H 50X,4H 51X,4H 52X,  X11E0145
     6 4H 53X,4H 54X,4H 55X,4H 56X,4H 57X,4H 58X,4H 59X,4H 60X,4H 61X,  X11E0150
     7 4H 62X,4H 63X,4H 64X,4H 65X,4H 66X,4H 67X,4H 68X,4H 69X,4H 70X,  X11E0155
     8 4H 71X,4H 72X,4H 73X,4H 74X,4H 75X,4H 76X,4H 77X,4H 78X,4H 79X,  X11E0160
     9 4H 80X,4H 81X,4H 82X,4H 83X,4H 84X,4H 85X,4H 86X,4H 87X,4H 88X,  X11E0165
     1 4H 89X,4H 90X,4H 91X,4H 92X,4H 93X,4H 94X,4H 95X,4H 96X,4H 97X,  X11E0170
     2 4H 98X,4H 99X,4H100X,4H101X,4H102X,4H103X,4H104X,4H105X,4H106X,  X11E0175
     3 4H107X,4H108X,4H109X,4H110X/                                     X11E0180
      DATA NZ2/4H,111,4H,110,4H,109,4H,108,4H,107,4H,106,4H,105,4H,104, X11E0185
     1  4H,103,4H,102,4H,101,4H,100,4H, 99,4H, 98,4H, 97,4H, 96,4H, 95, X11E0190
     2  4H, 94,4H, 93,4H, 92,4H, 91,4H, 90,4H, 89,4H, 88,4H, 87,4H, 86, X11E0195
     3  4H, 85,4H, 84,4H, 83,4H, 82,4H, 81,4H, 80,4H, 79,4H, 78,4H, 77, X11E0200
     4  4H, 76,4H, 75,4H, 74,4H, 73,4H, 72,4H, 71,4H, 70,4H, 69,4H, 68, X11E0205
     5  4H, 67,4H, 66,4H, 65,4H, 64,4H, 63,4H, 62,4H, 61,4H, 60,4H, 59, X11E0210
     6  4H, 58,4H, 57,4H, 56,4H, 55,4H, 54,4H, 53,4H, 52,4H, 51,4H, 50, X11E0220
     7  4H, 49,4H, 48,4H, 47,4H, 46,4H, 45,4H, 44,4H, 43,4H, 42,4H, 41, X11E0230
     8  4H, 40,4H, 39,4H, 38,4H, 37,4H, 36,4H, 35,4H, 34,4H, 33,4H, 32, X11E0240
     9  4H, 31,4H, 30,4H, 29,4H, 28,4H, 27,4H, 26,4H, 25,4H, 24,4H, 23, X11E0250
     1  4H, 22,4H, 21,4H, 20,4H, 19,4H, 18,4H, 17,4H, 16,4H, 15,4H, 14, X11E0260
     2  4H, 13,4H, 12,4H, 11,4H, 10,4H,  9,4H,  8,4H,  7,4H,  6,4H,  5, X11E0270
     3  4H,  4,4H,  3,4H,  2,4H,  1/                                    X11E0280
      NYEAR=LYR                                                         X11E0290
      N = 1                                                             X11E0300
      DO 105 I = 1,111                                                  X11E0310
  105 NX(I) = NBLANK                                                    X11E0320
C --- FIND LARGEST AND SMALLEST VALUES                                  X11E0330
  221 BIG = -999999.                                                    X11E0340
      SMALL = 999999.                                                   X11E0350
      IF (NOSER-2) 510,520,530                                          X11E0360
  530 DO 534 I = IBEG,IEND                                              X11E0370
      IF (C(I)-BIG) 531,534,532                                         X11E0380
  531 IF (C(I)-SMALL) 533,534,534                                       X11E0390
  532 BIG = C(I)                                                        X11E0400
      GO TO 534                                                         X11E0410
  533 SMALL = C(I)                                                      X11E0420
  534 CONTINUE                                                          X11E0430
  520 DO 524 I = IBEG,IENDA                                             X11E0440
      IF (B(I)-BIG) 521,524,522                                         X11E0450
  521 IF (B(I)-SMALL) 523,524,524                                       X11E0460
  522 BIG = B(I)                                                        X11E0470
      GO TO 524                                                         X11E0480
  523 SMALL = B(I)                                                      X11E0490
  524 CONTINUE                                                          X11E0500
  510 DO 514 I = IBEG,IENDA                                             X11E0510
      IF (A(I)-BIG) 511,514,512                                         X11E0520
  511 IF (A(I)-SMALL) 513,514,514                                       X11E0530
  512 BIG = A(I)                                                        X11E0540
      GO TO 514                                                         X11E0550
  513 SMALL = A(I)                                                      X11E0560
  514 CONTINUE                                                          X11E0570
      SMALL = AINT(SMALL)                                               X11E0580
  291 ASSIGN 297 TO JUMP                                                X11E0590
  293 CALL RITE (LTABL,0,0,0,0,0,0)                                     X11E0600
      GO TO JUMP,(297,153)                                              X11E0610
  297 ASSIGN 153 TO JUMP                                                X11E0620
  296 IF (LOG) 101,101,100                                              X11E0630
C --- ARITHMETIC CHART                                                  X11E0640
  101 IF (SMALL) 103,103,104                                            X11E0650
  103 SMALL = SMALL - 1.                                                X11E0660
  104 KDIV = (BIG-SMALL)/11. + 1.                                       X11E0670
      DIV = KDIV                                                        X11E0680
      Y(1) = SMALL                                                      X11E0690
      BIG = SMALL                                                       X11E0700
      DO 148 I = 2,12                                                   X11E0710
      BIG = BIG +  DIV                                                  X11E0720
  148 Y(I) = BIG                                                        X11E0730
      KL = 0                                                            X11E0740
      CYCLE = 110./(BIG-SMALL)                                          X11E0750
  153 WRITE (NW,16)                                                     X11E0760
   16 FORMAT(20H    SCALE-ARITHMETIC)                                   X11E0770
      WRITE (NW,1) Y                                                    X11E0780
    1 FORMAT(1H ,2X,F7.0,11(3X,F7.0))                                   X11E0790
      WRITE (NW,27)                                                     X11E0800
   27 FORMAT(7X,1H.,11(9X,1H.))                                         X11E0810
      IF (MO) 5000,5000,3500                                            X11E0820
C --- DETERMINE LOG SCALE                                               X11E0830
  100 IF (SMALL) 106,106,107                                            X11E0840
  106 SMALL = 1.                                                        X11E0850
  107 KVAL = BIG/SMALL                                                  X11E0860
      WT = 1.                                                           X11E0870
      IF (KVAL-2) 20, 420, 420                                          X11E0880
  420 IF (KVAL-4) 30, 421, 421                                          X11E0890
  421 IF (KVAL-10) 40, 422, 422                                         X11E0900
  422 IF (KVAL-100) 50,423,423                                          X11E0910
  423 IF (KVAL-10000) 60,70,70                                          X11E0920
C --- HEADINGS FOR VARIOUS LOG CHARTS                                   X11E0930
   20 DO 29 I = 1,6                                                     X11E0940
      Y(I)= SMALL*WT                                                    X11E0950
   29 WT = WT + .2                                                      X11E0960
      WRITE (NW, 9)                                                     X11E0970
    9 FORMAT(33H    SCALE-SEMI-LOG  QUARTER CYCLE)                      X11E0980
      WRITE (NW, 3) (Y(I), I = 1, 6)                                    X11E0990
    3 FORMAT(3X,F7.0,21X,F8.0,16X,F8.0,14X,F8.0,10X,F8.0,9X,F8.0)       X11E1000
      WRITE (NW,21)                                                     X11E1010
   21 FORMAT(7X,1H.,28X,1H.,23X,1H.,21X,1H.,17X,1H.,16X,1H.)            X11E1020
      KL = 1                                                            X11E1030
      CYCLE = 365.4121                                                  X11E1040
      GO TO 5000                                                        X11E1050
   30 DO 31 I = 1,7                                                     X11E1060
      Y(I) = SMALL*WT                                                   X11E1070
   31 WT = WT +.5                                                       X11E1080
      WRITE (NW, 11)                                                    X11E1090
   11 FORMAT(33H    SCALE-SEMI-LOG  HALF CYCLE   )                      X11E1100
      WRITE (NW, 4) (Y(I), I = 1, 7)                                    X11E1110
    4 FORMAT(3X,F7.0,24X,F8.0,15X,F8.0,10X,F8.0,6X,F8.0,4X,F8.0,3X,F8.0)X11E1120
      WRITE (NW,22)                                                     X11E1130
   22 FORMAT(7X,1H.,31X,1H.,22X,1H.,17X,1H.,13X,1H.,11X,1H.,10X,1H.)    X11E1140
      KL = 2                                                            X11E1150
      CYCLE = 182.706                                                   X11E1160
      GO TO 5000                                                        X11E1170
   40 Y(1)= SMALL                                                       X11E1180
      WT = 2.                                                           X11E1190
      DO 41 I=2,6                                                       X11E1200
      Y(I)= SMALL* WT                                                   X11E1210
   41 WT = WT + 2.                                                      X11E1220
      WRITE (NW, 13)                                                    X11E1230
   13 FORMAT(33H    SCALE-SEMI-LOG  ONE CYCLE    )                      X11E1240
      WRITE (NW, 5) (Y(I), I = 1, 6)                                    X11E1250
    5 FORMAT(3X,F7.0,25X,F8.0,25X,F8.0,12X,F8.0,5X,F8.0,3X,F8.0)        X11E1260
      WRITE (NW,23)                                                     X11E1270
   23 FORMAT(7X,1H.,32X,1H.,32X,1H.,19X,1H.,12X,1H.,10X,1H.)            X11E1280
      KL = 3                                                            X11E1290
      CYCLE = 110.                                                      X11E1300
      GO TO 5000                                                        X11E1310
   50 Y(1) = SMALL                                                      X11E1320
      Y(2) = SMALL*4.0                                                  X11E1330
      Y(3) = SMALL*7.0                                                  X11E1340
      Y(4) = SMALL*10.0                                                 X11E1350
      Y(5) =SMALL* 40.0                                                 X11E1360
      Y(6) = SMALL*70.0                                                 X11E1370
      Y(7) = SMALL*100.0                                                X11E1380
      WRITE (NW, 14)                                                    X11E1390
   14 FORMAT(33H    SCALE-SEMI-LOG  TWO CYCLE    )                      X11E1400
      WRITE (NW, 6) (Y(I), I = 1, 7)                                    X11E1410
    6 FORMAT(1H ,2X,F7.0,27X,F7.0,6X,F7.0,2X,F7.0,27X,F7.0,6X,F7.0,F7.0)X11E1420
      WRITE (NW,24)                                                     X11E1430
   24 FORMAT(7X,1H.,33X,1H.,12X,1H.,8X,1H.,33X,1H.,12X,1H.,7X,1H.)      X11E1440
      KL = 4                                                            X11E1450
      CYCLE = 55.                                                       X11E1460
      GO TO 5000                                                        X11E1470
   60 DO 61 I = 1,5                                                     X11E1480
      Y(I) = SMALL*WT                                                   X11E1490
   61 WT = 10.*WT                                                       X11E1500
      WRITE (NW,15)                                                     X11E1510
   15 FORMAT(33H    SCALE-SEMI-LOG  FOUR CYCLE   )                      X11E1520
      WRITE (NW, 7) (Y(I), I=1,5)                                       X11E1530
    7 FORMAT(1H ,2X,F7.0,20X,F7.0,21X,F7.0,19X,F8.0,20X,F8.0)           X11E1540
      WRITE (NW,25)                                                     X11E1550
   25 FORMAT(7X,1H.,26X,1H.,27X,1H.,26X,1H.,27X,1H.)                    X11E1560
      KL = 5                                                            X11E1570
      CYCLE = 27.5                                                      X11E1580
      GO TO 5000                                                        X11E1590
   70 WRITE (NW,19)                                                     X11E1600
   19 FORMAT (30H    SCALE-SEMI-LOG  FIVE CYCLE)                        X11E1610
      DO 71 I = 1,6                                                     X11E1620
      Y(I) = SMALL*WT                                                   X11E1630
   71 WT = 10.*WT                                                       X11E1640
      WRITE (NW,8) (Y(I),I=1,6)                                         X11E1650
    8 FORMAT(3X,F7.0,5(14X,F8.0))                                       X11E1660
      WRITE (NW,26)                                                     X11E1670
   26 FORMAT(7X,1H.,21X,1H.,21X,1H.,21X,1H.,21X,1H.,21X,1H.)            X11E1680
      KL = 6                                                            X11E1690
      CYCLE = 22.                                                       X11E1700
C --- PLOT POINTS                                                       X11E1710
 5000 I = IBEG                                                          X11E1720
      N = 12                                                            X11E1730
      ASSIGN 703 TO JPLOT                                               X11E1740
 1099 NPLOTA = 112                                                      X11E1750
      NPLOTB = 112                                                      X11E1760
      NPLOTC = 112                                                      X11E1770
      IF (LOG) 102,102,1002                                             X11E1780
  102 CX = C(I)-SMALL                                                   X11E1790
      BX = B(I)-SMALL                                                   X11E1800
      AX = A(I)-SMALL                                                   X11E1810
      GO TO 1003                                                        X11E1820
 1002 IF (NOSER-2) 610,620,630                                          X11E1830
  630 CX = ALOG10(C(I)/SMALL)                                           X11E1840
  620 BX = ALOG10(B(I)/SMALL)                                           X11E1850
  610 AX = ALOG10(A(I)/SMALL)                                           X11E1860
 1003 IF (NOSER-2) 910,920,930                                          X11E1870
  930 NPLOTC = CX * CYCLE + 1.5                                         X11E1880
  933 IF (NPLOTC-111) 936,934,934                                       X11E1890
  934 NPLOTC = 111                                                      X11E1900
      GO TO 935                                                         X11E1910
  936 IF (NPLOTC) 937,937,935                                           X11E1920
  937 NPLOTC = 1.                                                       X11E1930
  935 NX(NPLOTC) = NPLUS                                                X11E1940
  920 IF (I-IENDA) 921,921,397                                          X11E1950
  921 NPLOTB = BX * CYCLE + 1.5                                         X11E1960
  923 IF (NPLOTB-111) 926,924,924                                       X11E1970
  924 NPLOTB = 111                                                      X11E1980
      GO TO 925                                                         X11E1990
  926 IF (NPLOTB) 927,927,925                                           X11E2000
  927 NPLOTB = 1.                                                       X11E2010
  925 NX(NPLOTB) = NLETO                                                X11E2020
  910 NPLOTA = AX * CYCLE + 1.5                                         X11E2030
  913 IF (NPLOTA-111) 916,914,914                                       X11E2040
  914 NPLOTA = 111                                                      X11E2050
      GO TO 915                                                         X11E2060
  916 IF (NPLOTA) 917,917,915                                           X11E2070
  917 NPLOTA = 1.                                                       X11E2080
  915 NX(NPLOTA) = NLETX                                                X11E2090
 1004 JH = NPLOTA                                                       X11E2100
      JL = NPLOTA                                                       X11E2110
      IF (NOSER-2) 399,363,351                                          X11E2120
  351 IF (NPLOTC-NPLOTB) 359,356,352                                    X11E2130
  352 IF (NPLOTC-NPLOTA) 392,355,353                                    X11E2140
  353 IF (NPLOTB-NPLOTA) 395,354,391                                    X11E2150
  354 NX(NPLOTB) = NAST                                                 X11E2160
      GO TO 391                                                         X11E2170
  355 NX(NPLOTC) = NAST                                                 X11E2180
      GO TO 392                                                         X11E2190
  356 IF (NPLOTC-NPLOTA) 355,358,357                                    X11E2200
  357 NX(NPLOTC) = NAST                                                 X11E2210
      GO TO 391                                                         X11E2220
  358 NX(NPLOTC) = NAST                                                 X11E2230
      GO TO 399                                                         X11E2240
  359 IF (NPLOTC-NPLOTA) 361,360,393                                    X11E2250
  360 NX(NPLOTC) = NAST                                                 X11E2260
      GO TO 393                                                         X11E2270
  361 IF (NPLOTB-NPLOTA) 394,362,396                                    X11E2280
  362 NX(NPLOTB) = NAST                                                 X11E2290
      GO TO 394                                                         X11E2300
  363 IF (NPLOTB-NPLOTA) 392,364,393                                    X11E2310
  364 NX(NPLOTB) = NAST                                                 X11E2320
      GO TO 399                                                         X11E2330
  395 JH = NPLOTC                                                       X11E2340
  392 JL = NPLOTB                                                       X11E2350
      GO TO 399                                                         X11E2360
  396 JH = NPLOTB                                                       X11E2370
  394 JL = NPLOTC                                                       X11E2380
      GO TO 399                                                         X11E2390
  397 JL = NPLOTC                                                       X11E2400
  391 JH = NPLOTC                                                       X11E2410
      GO TO 399                                                         X11E2420
  393 JH = NPLOTB                                                       X11E2430
  399 NM(5)=NZ1(JL)                                                     X11E2440
      NM(6)=NZ2(JL)                                                     X11E2441
      NY(5)=NZ1(JL)                                                     X11E2450
      NY(6)=NZ2(JL)                                                     X11E2451
      GO TO JPLOT,(703,2999)                                            X11E2460
  703 M = I                                                             X11E2470
  720 IF (M-12) 1000,1000,701                                           X11E2480
  701 M = M-12                                                          X11E2490
      IF(M-12)  702, 702,701                                            X11E2500
  702 IF(M-1) 1000,705,1000                                             X11E2510
  705 NYEAR = NYEAR + 1                                                 X11E2520
 1000 WRITE (NW,NY) MO1(M),NYEAR,(NX(IPLOT),IPLOT=JL,JH)                X11E2530
 4000 I = I + 1                                                         X11E2540
      GO TO 1098                                                        X11E2550
C ---  12 MONTHLY CHARTS                                                X11E2560
 3500 WRITE (NW,17) MO1(N),MO2(N),MO3(N)                                X11E2570
   17 FORMAT (1H ,3A4)                                                  X11E2580
      NYEAR = LYR-1                                                     X11E2590
      IF(IBEG-N)3001,3001,3002                                          X11E2600
 3002 IF(IBEG-12) 800,800,801                                           X11E2610
  800 NYEAR = NYEAR +1                                                  X11E2620
  801 IST = N+12                                                        X11E2630
      GO TO 3006                                                        X11E2640
 3001 IST = N                                                           X11E2650
 3006 I = IST                                                           X11E2660
      ASSIGN 2999 TO JPLOT                                              X11E2670
      GO TO 1099                                                        X11E2680
 2999 NYEAR = NYEAR + 1                                                 X11E2690
 3000 WRITE (NW,NM) NYEAR,(NX(IPLOT),IPLOT = JL,JH)                     X11E2700
      I = I + 12                                                        X11E2710
 1098 NX(NPLOTA) = NBLANK                                               X11E2720
      NX(NPLOTB) = NBLANK                                               X11E2730
      NX(NPLOTC) = NBLANK                                               X11E2740
      IF (I-IEND) 1099,1099,3010                                        X11E2750
 3010 IF (LOG) 3011,3011,3012                                           X11E2760
 3011 WRITE (NW,27)                                                     X11E2770
      WRITE (NW, 1) (Y(I), I = 1, 12)                                   X11E2780
      N=N+1                                                             X11E2790
      IF (N-12) 293,293,9999                                            X11E2800
 3012 GO TO (3021,3022,3023,3024,3025,3026),KL                          X11E2810
 3021 WRITE (NW,21)                                                     X11E2820
      WRITE (NW,3)(Y(I),I=1,6)                                          X11E2830
      GO TO 9999                                                        X11E2840
 3022 WRITE (NW,22)                                                     X11E2850
      WRITE (NW,4) (Y(I),I=1,7)                                         X11E2860
      GO TO 9999                                                        X11E2870
 3023 WRITE (NW,23)                                                     X11E2880
      WRITE (NW,5) (Y(I),I=1,6)                                         X11E2890
      GO TO 9999                                                        X11E2900
 3024 WRITE (NW,24)                                                     X11E2910
      WRITE (NW,6) (Y(I),I=1,7)                                         X11E2920
      GO TO 9999                                                        X11E2930
 3025 WRITE (NW,25)                                                     X11E2940
      WRITE (NW,7)(Y(I),I=1,5)                                          X11E2950
      GO TO 9999                                                        X11E2960
 3026 WRITE (NW,26)                                                     X11E2970
      WRITE (NW,8) (Y(I),I=1,6)                                         X11E2980
 9999 RETURN                                                            X11E2990
      END                                                               X11E3000
C --- LIP FOR DOW,DOW,DOWS                                              X11F0010
C --- THIS ROUTINE COMBINES SEVEN DAILY WEIGHTS INTO MONTHLY FACTORS    X11F0020
      SUBROUTINE DOW (DWT,ARRAY,KYR,KFDA,JLDA,JOPT)                     X11F0030
      DIMENSION ARRAY(600),DWT(7),MDAYS(12),WT(4),ADJ(12)               X11F0040
      COMMON/CJ/MULADD                                                  X11F0050
      DATA DUMMY/1H /                                                   X11F0051
      DATA MDAYS/3,0,3,2,3,2,3,3,2,3,2,3/                               X11F0060
      DATA ADJ/28.25,30.,31.,28.25,30.4375,30.4375,30.4375,30.4375,29., X11F0070
     1 30.,31.,28./                                                     X11F0075
      TKON = 0.                                                         X11F0080
      IF (MULADD) 33,2,33                                               X11F0090
    2 TKON = 28.                                                        X11F0100
      DO 1 I = 1,4                                                      X11F0110
      M = I + JOPT                                                      X11F0120
    1 WT(I) = ADJ(M)                                                    X11F0130
C --- STANDARDIZE WEIGHTS TO TOTAL 7.0                                  X11F0140
    3 TMP = 0                                                           X11F0150
    6 DO 32 I = 1,7                                                     X11F0160
   32 TMP = TMP + DWT(I)                                                X11F0170
      DO 31 I = 1, 7                                                    X11F0180
   31 DWT(I) = (DWT(I)*7.)/TMP                                          X11F0190
   33 JFDA = (KFDA - 1) / 12 * 12 + 1                                   X11F0195
      JYR = KYR + JFDA / 12                                             X11F0196
C --- SET PERPETUAL CALENDAR                                            X11F0200
      I = JYR + 12 -((JYR+11)/28) * 28                                  X11F0210
      I = I + (I-1)/4                                                   X11F0220
      I = I - ((I-1)/7) * 7                                             X11F0230
      M = 1                                                             X11F0240
      JL = JLDA + 12                                                    X11F0270
      L = JYR - 1                                                       X11F0280
      DO 30 J = JFDA,JL                                                 X11F0310
      ARRAY(J) = TKON                                                   X11F0320
      N = MDAYS(M)                                                      X11F0330
      IF (N) 19, 13, 19                                                 X11F0340
   13 L = L + 1                                                         X11F0350
      N = 4                                                             X11F0360
      IF (L - (L/4) * 4) 25, 9, 25                                      X11F0370
    9 N = 1                                                             X11F0375
   19 K = 0                                                             X11F0380
   20 ARRAY(J) = ARRAY(J) + DWT(I)                                      X11F0390
      I = I + 1                                                         X11F0400
      IF (I - 7) 22, 22, 21                                             X11F0410
   21 I = 1                                                             X11F0420
   22 K = K + 1                                                         X11F0430
      IF (K-N) 20, 25, 25                                               X11F0440
   25 IF (MULADD) 28,325,28                                             X11F0450
  325 ARRAY(J) = ARRAY(J)/WT(N)* 100.                                   X11F0460
   28 M = M + 1                                                         X11F0470
      IF (M-12) 30, 30, 29                                              X11F0480
   29 M = 1                                                             X11F0490
   30 CONTINUE                                                          X11F0500
  999 RETURN                                                            X11F0510
      END                                                               X11F0520
C --- LIP FOR FTEST,FTEST,FTESTS                                        X11G0010
C --- THIS ROUTINE COMPUTES THE ANALYSIS-OF-VARIANCE F-TEST.            X11G0020
      SUBROUTINE FTEST (ARRAY,JFDA,JLDA)                                X11G0030
      DIMENSION ARRAY(600)                                              X11G0040
      COMMON/CA/NW,NM(12),SUMM(12),SSQT,SUMT,F,FSTAR,SSR,SSM,KDFR,KDFT, X11G0050
     1FMSM,FMSR,NT,STMP(565)                                            X11G0060
      DATA DUMMY,BLANK,STAR/1H ,4H    ,4H****/                          X11G0070
      DO 1 I=1,12                                                       X11G0080
      NM(I) = 0                                                         X11G0090
    1 SUMM(I) = 0.                                                      X11G0100
      NT = 0                                                            X11G0110
      SUMT = 0.                                                         X11G0120
      SSQT = 0.                                                         X11G0130
      DO 11 I = 1,12                                                    X11G0140
      J = I + JFDA - 1                                                  X11G0150
      DO 11 M = J,JLDA,12                                               X11G0160
   10 NM(I) = NM(I) + 1                                                 X11G0170
      NT = NT + 1                                                       X11G0180
      SUMM(I) = SUMM(I) + ARRAY(M)                                      X11G0190
      SUMT = SUMT + ARRAY(M)                                            X11G0200
      SSQT = SSQT + ARRAY(M)**2                                         X11G0210
   11 CONTINUE                                                          X11G0220
      ST = NT                                                           X11G0230
      SSQT = SSQT - SUMT**2/ST                                          X11G0240
      SSM = 0.                                                          X11G0250
      DO 12 I = 1,12                                                    X11G0260
      SM = NM(I)                                                        X11G0270
   12 SSM = SSM + SUMM(I)**2/SM                                         X11G0280
      SSM = SSM - SUMT**2/ST                                            X11G0290
      SSR = SSQT - SSM                                                  X11G0300
      KDFR = NT - 12                                                    X11G0310
      KDFT = NT - 1                                                     X11G0320
      FMSM = SSM/11.                                                    X11G0330
      DFR = KDFR                                                        X11G0340
      FMSR = SSR/DFR                                                    X11G0350
      F = FMSM/FMSR                                                     X11G0360
      ASSIGN 30 TO JUMP                                                 X11G0370
      FSTAR = BLANK                                                     X11G0380
   14 IF (F-2.34) 19,18,18                                              X11G0390
   18 FSTAR = STAR                                                      X11G0400
      ASSIGN 27 TO JUMP                                                 X11G0410
   19 WRITE (NW,100) SSM,FMSM,F,FSTAR,SSR,KDFR,FMSR,SSQT,KDFT           X11G0420
      GO TO JUMP,(27,30)                                                X11G0430
  100 FORMAT (43X, 6HSUM OF,5X,7HDGRS.OF,9X,4HMEAN/                     X11G0440
     142X,7HSQUARES,4X, 7HFREEDOM,9X,6HSQUARE,9X,1HF/                   X11G0450
     220X,14HBETWEEN MONTHS,F17.3,7X,2H11,F17.3,F12.3,A2/               X11G0460
     326X,8HRESIDUAL,F17.3,I9,F17.3/                                    X11G0470
     429X,5HTOTAL,F17.3,I9)                                             X11G0480
   27 WRITE (NW,101)                                                    X11G0490
  101 FORMAT (30X,52H**STABLE SEASONALITY PRESENT AT THE 1 PER CENT LEVEX11G0500
     1L)                                                                X11G0510
      RETURN                                                            X11G0520
   30 WRITE (NW,102)                                                    X11G0530
  102 FORMAT (30X,57HNO EVIDENCE OF STABLE SEASONALITY AT THE 1 PER CENTX11G0540
     1 LEVEL)                                                           X11G0550
      RETURN                                                            X11G0560
      END                                                               X11G0570
C --- LIP FOR MVAVG,MVAVG,MVAVGS                                        X11H0010
C --- THIS ROUTINE COMPUTES WEIGHTED MOVING AVERAGES FOR VSFC AND VTC.  X11H0020
C --- WEIGHTS ARE ORDERED SO THAT FIRST N WEIGHTS ARE APPLIED TO VALUES X11H0030
C --- FOR FIRST AND LAST MOVING AVERAGE TERMS. LAST N VALUES ARE FOR    X11H0040
C --- MIDDLE TERMS. WITHIN EACH SET OF N VALUES FOR END TERMS, FIRST    X11H0050
C --- WEIGHT IS APPLIED TO FIRST AND LAST INPUT VALUE.                  X11H0060
      SUBROUTINE MVAVG (STB,STA,LF,LL,N,WT)                             X11H0070
      DIMENSION STA(600),STB(600),WT(276)                               X11H0080
      M = N/2                                                           X11H0090
      DO 1 I = 1,M                                                      X11H0100
      II = LF + I - 1                                                   X11H0110
      JJ = LL - I + 1                                                   X11H0120
      STB(II) = 0.                                                      X11H0130
      STB(JJ) = 0.                                                      X11H0140
      KK = LF                                                           X11H0150
      MM = LL                                                           X11H0160
      NN = N * (I-1)                                                    X11H0170
      DO 1 J = 1,N                                                      X11H0180
      NN = NN + 1                                                       X11H0190
      STB(II) = STB(II) + STA(KK)*WT(NN)                                X11H0200
      STB(JJ) = STB(JJ) + STA(MM)*WT(NN)                                X11H0210
      KK = KK + 1                                                       X11H0220
    1 MM = MM - 1                                                       X11H0230
      IF (N-M-M) 2,4,2                                                  X11H0240
    2 II = II + 1                                                       X11H0250
      JJ = JJ - 1                                                       X11H0260
      DO 3 I = II,JJ                                                    X11H0270
      KK = I - M - 1                                                    X11H0280
      STB(I) = 0.                                                       X11H0290
      DO 3 J = 1,N                                                      X11H0300
      KK = KK + 1                                                       X11H0310
      MM = NN + J                                                       X11H0320
    3 STB(I) = STB(I) + STA(KK)*WT(MM)                                  X11H0330
    4 RETURN                                                            X11H0340
      END                                                               X11H0350
C --- LIP FOR RITE,RITE,RITES                                           X11I0010
C --- TABLE OUTPUT ROUTINE. WRITES THE HEADING LINE ON ALL PAGES AND    X11I0020
C --- ALL MONTHLY TABLES.                                               X11I0030
      SUBROUTINE RITE (KTABL,ARRAY,LFDA,LLDA,JAVG,JDCM,ARR)             X11I0040
      COMMON/CA/NW,STMP(600)                                            X11I0050
      COMMON/CB/RATIC,NTERM,STC(360),STCI(360)                          X11I0060
      COMMON/CC/RATI(36),LTERM(12),STS(372),STSI(360)                   X11I0070
      COMMON/CF/LSER,LYR,PART,KSWK,FINAB(2),FINAP(2),KPART,AORB,OUT,MCD,X11I0080
     1 SIGM,SIGML,SIGMU,IN,RADIF1(2),RADIF2,KDEC,NEWPAG,SPC,NAME(20),   X11I0090
     2 LBK,LBNK,TCARD,KSER,LAYR,LSTMO,LSTYR,KPROPT                      X11I0091
      COMMON/CJ/MULADD                                                  X11I0100
      DIMENSION ARRAY(612),ARR(612),TMP(12),AVGMON(12),TOTMON(12),      X11I0110
     1 FA2(9),FA3(15),FA4(9),FB1(8),FB2(11),FB3(6),FB4(11),FB5(6),FB6(8)X11I0120
     2,FB7(10),FB13(6),FB14(16),FB15(8),FB16(17),FB17(10),FB18(15)      X11I0130
     3,FB19(14),FE1(10),FE2(9),FE3(7),FE4(15),FE5(11),FE6(17),NF1(12),  X11I0140
     4 NF2(24),TYRLY(4),SDEV(12),TITLE(20),DIFRAT(9),KDCML(6),FF1(5),   X11I0150
     5 FF2(4),FC4(6),KSE(15),NF3(2),NF4(2),NF5(2),FG1(2)                X11I0160
      DATA DUMMY,BLANK/1H ,4H    /                                      X11I0170
      DATA KDCML/1H1,1H2,1H3,1H4,1H5,1H0/                               X11I0180
      DATA DIFRAT/4HRATI,2HOS,4HDIFF,4HEREN,4HCES ,4H PER,4H CEN,4HT CH,X11I0190
     1 4HANGE/                                                          X11I0200
      DATA TYRLY/4HAVGE,4H TOT,4HS.D.,4HS.D./                           X11I0210
      DATA NF1/4H(A1,,4H3X, ,4H2H19,4H,I2,,4H2X,1,4H2(1X,4H,F7.,4H    , X11I0220
     1 4H),6X,4H,F8.,4H    ,1H)/                                        X11I0230
      DATA NF2/4H(A1,,4H12X,,4H14H ,4HTABL,4HE TO,4HTAL-,4H ,  ,4H F9., X11I0240
     1 1H ,4H,A1,,4H8X,6,4HHMEA,4HN- ,,4H F7.,1H ,4H,8X,,4H16HS,4HTD. , X11I0250
     2 4HDEVI,4HATIO,4HN- ,,4H F7.,1H ,1H)/                             X11I0260
      DATA NF3/4H2H19,4H,I2,/,NF4/4H4HAV,4HGE, /,NF5/4H4HS.,4HD., /     X11I0270
      DATA FA2/4HPRIO,4HR MO,4HNTHL,4HY AD,4HJUST,4HMENT,4H FAC,4HTORS, X11I0280
     1 4H    /                                                          X11I0290
      DATA FA3/4HORIG,4HINAL,4H SER,4HIES ,4HADJU,4HSTED,4H BY ,4HPRIO, X11I0300
     1 4HR MO,4HNTHL,4HY AD,4HJUST,4HMENT,4H FAC,4HTORS/                X11I0310
      DATA FA4/4HPRIO,4HR TR,4HADIN,4HG DA,4HY AD,4HJUST,4HMENT,4H FAC, X11I0330
     1 4HTORS/                                                          X11I0340
      DATA FB1/4HPRIO,4HR AD,4HJUST,4HED O,4HRIGI,4HNAL ,4HSERI,4HES  / X11I0350
      DATA FB2/4HTREN,4HD CY,4HCLE-,4H CEN,4HTERE,4HD 12,4H-TER,4HM MO, X11I0370
     1 4HVING,4H AVE,4HRAGE/                                            X11I0380
      DATA FB3/4H FIN,4HAL  ,4H  UN,4HMODI,4HFIED,4H SI /               X11I0400
      DATA FB4/4H FIN,4HAL  ,4H REP,4HLACE,4HMENT,4H VAL,4HUES ,4HFOR , X11I0420
     1 4HEXTR,4HEME ,4H SI /                                            X11I0430
      DATA KSE/4H(6X,,4H4HI ,4H  ,1,4H2F8.,4H    ,4H/6X,,4H4HS ,4H  ,1, X11I0440
     1 4H2F8.,4H    ,4H/4X,,4H6HRA,4HTIO ,4H,22F,4H8.2)/                X11I0450
      DATA FC4/4H FIN,4HAL  ,4H    ,4HMODI,4HFIED,4H SI /               X11I0460
      DATA FB5/4H    ,4H SEA,4HSONA,4HL FA,4HCTOR,4HS   /               X11I0490
      DATA FB6/4H    ,4H SEA,4HSONA,4HLLY ,4HADJU,4HSTED,4H SER,4HIES / X11I0510
      DATA FB7/4H FIN,4HAL  ,4HTREN,4HD CY,4HCLE ,4H- HE,4HNDER,4HSON , X11I0520
     1 4HCURV,4HE   /                                                   X11I0530
      DATA FB13/4H    ,4H IRR,4HEGUL,4HAR S,4HERIE,4HS   /              X11I0540
      DATA FB14/4HEXTR,4HEME ,4HIRRE,4HGULA,4HR VA,4HLUES,4H EXC,4HLUDE,X11I0560
     1 4HD FR,4HOM T,4HRADI,4HNG D,4HAY R,4HEGRE,4HSSIO,4HN   /         X11I0570
      DATA FB15/4H PRE,4HLIM ,4H TRA,4HDING,4H DAY,4H REG,4HRESS,4HION /X11I0590
      DATA FB16/4HTRAD,4HING ,4HDAY ,4HADJU,4HSTME,4HNT F,4HACTO,4HRS D,X11I0610
     1 4HERIV,4HED F,4HROM ,4HREGR,4HESSI,4HON C,4HOEFF,4HICIE,4HNTS /  X11I0620
      DATA FB17/4H PRE,4HLIM ,4H WEI,4HGHTS,4H FOR,4H IRR,4HEGUL,4HAR C,X11I0640
     1 4HOMPO,4HNENT/                                                   X11I0650
      DATA FB18/4HTRAD,4HING-,4HDAY ,4HADJU,4HSTME,4HNT F,4HACTO,4HRS F,X11I0660
     1 4HROM ,4HCOMB,4HINED,4H DAI,4HLY W,4HEIGH,4HTS  /                X11I0670
      DATA FB19/4H   A,4HDJUS,4HTED*,4H ORI,4HGINA,4HL SE,4HRIES,4H MOD,X11I0690
     1 4HIFIE,4HD BY,4H PRE,4HLIM ,4HWEIG,4HHTS /                       X11I0700
      DATA FE1/4HORIG,4HINAL,4H SER,4HIES ,4HMODI,4HFIED,4H FOR,4H EXT, X11I0720
     1 4HREME,4HS   /                                                   X11I0730
      DATA FE2/4HMODI,4HFIED,4H SEA,4HSONA,4HLLY ,4HADJU,4HSTED,4H SER, X11I0740
     1 4HIES /                                                          X11I0750
      DATA FE3/4HMODI,4HFIED,4H IRR,4HEGUL,4HAR S,4HERIE,4HS   /        X11I0760
      DATA FE4/4H    ,4H RAT,4HIOS ,4HOF A,4HNNUA,4HL TO,4HTALS,4H, OR, X11I0780
     1 4HIGIN,4HAL A,4HND A,4HDJUS,4HTED ,4HSERI,4HES  /                X11I0790
      DATA FE5/4HMONT,4HH-TO,4H-MON,4HTH C,4HHANG,4HES I,4HN OR,4HIGIN, X11I0810
     1 4HAL S,4HERIE,4HS   /                                            X11I0820
      DATA FE6/4HMONT,4HH-TO,4H-MON,4HTH C,4HHANG,4HES I,4HN FI,4HNAL , X11I0830
     1 4HSEAS,4HONAL,4HLY A,4HDJUS,4HTED ,4HSERI,4HES [,4HD11.,4H]   /  X11I0840
      DATA FF1/4HMCD ,4HMOVI,4HNG A,4HVERA,4HGE  /                      X11I0860
      DATA FF2/4HSUMM,4HARY ,4HMEAS,4HURES/                             X11I0880
      DATA FG1/4H CHA,4HRT  /                                           X11I0900
      ASSIGN 901 TO KRITE                                               X11I0910
      ASSIGN 999 TO KEXIT                                               X11I0920
      JFDA = LFDA                                                       X11I0930
      JLDA = LLDA                                                       X11I0940
      KAVG = JAVG                                                       X11I0950
      DO 992 I=1,20                                                     X11I0960
  992 TITLE(I) = BLANK                                                  X11I0970
      GO TO (200,200,200,100,500,600,700),KPART                         X11I0980
  100 GO TO (101,102,103,104),KTABL                                     X11I0990
  101 KPAGE = 1                                                         X11I1000
      DO 111 I=1,4                                                      X11I1010
  111 TITLE(I)=FB19(I+3)                                                X11I1020
      GO TO 900                                                         X11I1030
  102 DO 121 I=1,9                                                      X11I1040
  121 TITLE(I) = FA2(I)                                                 X11I1050
      GO TO 900                                                         X11I1060
  103 DO 131 I=1,15                                                     X11I1070
  131 TITLE(I) = FA3(I)                                                 X11I1080
      GO TO 900                                                         X11I1090
  104 DO 141 I=1,9                                                      X11I1100
  141 TITLE(I) = FA4(I)                                                 X11I1110
      ASSIGN 142 TO KRITE                                               X11I1120
      GO TO 900                                                         X11I1130
  142 WRITE (NW,143) (ARR(I),I=1,7),OUT                                 X11I1140
  143 FORMAT (79H A4A. PRIOR DAILY WEIGHTS - MON     TUE     WED    THURX11I1150
     1     FRI     SAT     SUN/ 23X, 7F8.3/                             X11I1160
     247H A4B. PRIOR TRADING DAY ADJUSTMENT FACTORS WITH,A3,27H LENGTH OX11I1170
     3F MONTH ADJUSTMENT)                                               X11I1180
      ASSIGN 145 TO KEXIT                                               X11I1190
      GO TO 901                                                         X11I1200
  145 WRITE (NW, 144)                                                   X11I1210
  144 FORMAT (58H A4C. PRIOR TRADING DAY ADJUSTMENT FACTORS, ONE YEAR AHX11I1220
     1EAD)                                                              X11I1230
      GO TO 315                                                         X11I1240
  200 GO TO (201,202,203,204,205,206,207,203,204,205,206,207,213,214,   X11I1250
     1 215,216,217,218,219),KTABL                                       X11I1260
  201 IF (KPART-2) 224,234,234                                          X11I1270
  224 IF (KSWK-1) 222,101,222                                           X11I1280
  222 DO 233 I=1,8                                                      X11I1290
  233 TITLE(I) = FB1(I)                                                 X11I1300
      GO TO 900                                                         X11I1310
  234 DO 235 I=1,14                                                     X11I1320
  235 TITLE(I) = FB19(I)                                                X11I1330
      TITLE(11)=FINAP(1)                                                X11I1340
      TITLE(12)=FINAP(2)                                                X11I1341
      IF (KSWK-1) 254,254,231                                           X11I1350
  254 TITLE(1) = BLANK                                                  X11I1360
      TITLE(2) = BLANK                                                  X11I1370
      TITLE(3)=BLANK                                                    X11I1371
      GO TO 900                                                         X11I1380
  231 ASSIGN 301 TO KRITE                                               X11I1390
      GO TO 900                                                         X11I1400
  202 DO 223 I=1,11                                                     X11I1410
  223 TITLE(I) = FB2(I)                                                 X11I1420
      GO TO 900                                                         X11I1430
  203 DO 264 I=3,6                                                      X11I1440
  264 TITLE(I) = FB3(I)                                                 X11I1450
      GO TO 356                                                         X11I1460
  204 IF (KPART-2) 266,267,310                                          X11I1470
  310 IF (KTABL-9) 267,230,230                                          X11I1480
  230 ASSIGN 227 TO KEXIT                                               X11I1490
      GO TO 266                                                         X11I1500
  267 DO 269 I = 1,6                                                    X11I1510
  269 TITLE(I) = FC4(I)                                                 X11I1520
  356 TITLE(7)=RADIF1(1)                                                X11I1530
      TITLE(8)=RADIF1(2)                                                X11I1540
      TITLE(9)=RADIF2                                                   X11I1541
      GO TO 899                                                         X11I1550
  266 DO 265 I=3,11                                                     X11I1560
  265 TITLE(I) = FB4(I)                                                 X11I1570
      TITLE(12)=RADIF1(1)                                               X11I1580
      TITLE(13)=RADIF1(2)                                               X11I1590
      TITLE(14)=RADIF2                                                  X11I1591
      GO TO 899                                                         X11I1600
  227 WRITE (NW,226) SPC                                                X11I1610
  226 FORMAT (A1,91HD 9A. YEAR TO YEAR CHANGE IN IRREGULAR AND SEASONAL X11I1620
     1COMPONENTS AND MOVING SEASONALITY RATIO/                          X11I1630
     214X,91HJAN     FEB     MAR     APR     MAY     JUN     JUL     AUGX11I1640
     3     SEP     OCT     NOV     DEC)                                 X11I1650
      KSE(5)=KDCML(3)                                                   X11I1660
      KSE(10)=KDCML(3)                                                  X11I1670
      IF (MULADD) 330,331,330                                           X11I1680
  330 KSE(5)=KDCML(2)                                                   X11I1690
      KSE(10)=KDCML(2)                                                  X11I1700
  331 WRITE (NW,KSE) RATI                                               X11I1710
      GO TO 999                                                         X11I1720
  205 DO 225 I=2,6                                                      X11I1730
  225 TITLE(I+1)=FB5(I)                                                 X11I1740
      IF (KAVG-1) 899,344,899                                           X11I1750
  344 ASSIGN 345 TO KEXIT                                               X11I1760
      GO TO 899                                                         X11I1770
  345 WRITE (NW,232) SPC                                                X11I1780
  232 FORMAT (A1,38HD10A. SEASONAL FACTORS, ONE YEAR AHEAD)             X11I1790
      ASSIGN 999 TO KEXIT                                               X11I1800
      GO TO 316                                                         X11I1810
  206 DO 236 I=2,8                                                      X11I1820
  236 TITLE(I+1)=FB6(I)                                                 X11I1830
      GO TO 899                                                         X11I1840
  207 DO 238 I=1,10                                                     X11I1850
  238 TITLE(I) = FB7(I)                                                 X11I1860
      ASSIGN 239 TO KRITE                                               X11I1870
      GO TO 899                                                         X11I1880
  239 WRITE (NW, 237) NTERM, RATIC                                      X11I1890
  237 FORMAT (19X,I2,45H-TERM MOVING AVERAGE SELECTED.   I/C RATIO IS,  X11I1900
     1F6.2)                                                             X11I1910
      GO TO 901                                                         X11I1920
  213 DO 242 I=2,6                                                      X11I1930
  242 TITLE(I+1)=FB13(I)                                                X11I1940
      GO TO 899                                                         X11I1950
  214 DO 245 I=1,16                                                     X11I1960
  245 TITLE(I) = FB14(I)                                                X11I1970
      ASSIGN 270 TO KRITE                                               X11I1980
      GO TO 900                                                         X11I1990
  270 WRITE (NW,271) SIGM                                               X11I2000
  271 FORMAT (9X,9H[OUTSIDE ,F3.1,13H-SIGMA LIMIT])                     X11I2010
      GO TO 901                                                         X11I2020
  215 DO 244 I=3,8                                                      X11I2030
  244 TITLE(I) = FB15(I)                                                X11I2040
      TITLE(1)=FINAP(1)                                                 X11I2050
      TITLE(2)=FINAP(2)                                                 X11I2051
      GO TO 632                                                         X11I2060
  216 DO 246 I=1,17                                                     X11I2070
  246 TITLE(I) = FB16(I)                                                X11I2080
      IF (KPART-2) 900,384,900                                          X11I2090
  384 ASSIGN 386 TO KRITE                                               X11I2100
      GO TO 900                                                         X11I2110
  386 WRITE (NW,385) (ARR(I),I=1,7)                                     X11I2120
  385 FORMAT (96H C16A. REGRESSION COEFFICIENTS - MON       TUE       WEX11I2130
     1D      THUR       FRI       SAT       SUN/27X,7F10.3/             X11I2140
     248H C16B. REGRESSION TRADING DAY ADJUSTMENT FACTORS)              X11I2150
      ASSIGN 388 TO KEXIT                                               X11I2160
      GO TO 901                                                         X11I2170
  388 WRITE (NW,387)                                                    X11I2180
  387 FORMAT (64H C16C. REGRESSION TRADING DAY ADJUSTMENT FACTORS, ONE YX11I2190
     1EAR AHEAD)                                                        X11I2200
      GO TO 315                                                         X11I2210
  315 ASSIGN 999 TO KEXIT                                               X11I2220
  316 JFDA = JLDA + 1                                                   X11I2230
      JLDA = JFDA + 11                                                  X11I2240
      KAVG = 6                                                          X11I2250
      GO TO 901                                                         X11I2260
  217 DO 247 I=3,10                                                     X11I2270
  247 TITLE(I) = FB17(I)                                                X11I2280
      TITLE(1)=FINAP(1)                                                 X11I2290
      TITLE(2)=FINAP(2)                                                 X11I2291
      ASSIGN 277 TO KRITE                                               X11I2300
      GO TO 900                                                         X11I2310
  277 WRITE (NW,276) SPC,SIGML,SIGMU                                    X11I2320
  276 FORMAT (A1,8X,22HGRADUATION RANGE FROM ,F3.1,4H TO ,F3.1,6H SIGMA)X11I2330
      GO TO 901                                                         X11I2340
  218 DO 248 I=1,15                                                     X11I2350
  248 TITLE(I) = FB18(I)                                                X11I2360
      IF (KAVG-18) 323,327,322                                          X11I2370
  322 ASSIGN 324 TO KRITE                                               X11I2380
      GO TO 900                                                         X11I2390
  324 WRITE (NW,325) PART                                               X11I2400
  325 FORMAT (9X,15H[SAME AS TABLE ,A1,4H16.])                          X11I2410
      GO TO 999                                                         X11I2420
  327 ASSIGN 328 TO KRITE                                               X11I2430
      GO TO 900                                                         X11I2440
  328 WRITE (NW,326)                                                    X11I2450
  326 FORMAT (9X,20H[SAME AS TABLE A 4.])                               X11I2460
      GO TO 999                                                         X11I2470
  323 IF (KPART-2) 900,250,900                                          X11I2480
  250 ASSIGN 275 TO KRITE                                               X11I2490
      GO TO 900                                                         X11I2500
  275 WRITE(NW,272) (ARR(I),I=1,7),OUT                                  X11I2510
  272 FORMAT (83H C18A. COMBINED DAILY WEIGHTS - MON     TUE     WED    X11I2520
     1THUR     FRI     SAT     SUN/27X, 7F8.3/                          X11I2530
     251H C18B. COMBINED TRADING-DAY ADJUSTMENT FACTORS WITH,A3,27H LENGX11I2540
     3TH OF MONTH ADJUSTMENT)                                           X11I2550
      ASSIGN 274 TO KEXIT                                               X11I2560
      GO TO 901                                                         X11I2570
  274 WRITE (NW,273)                                                    X11I2580
  273 FORMAT (62H C18C. COMBINED TRADING-DAY ADJUSTMENT FACTORS, ONE YEAX11I2590
     1R AHEAD)                                                          X11I2600
      GO TO 315                                                         X11I2610
  219 DO 249 I=1,7                                                      X11I2620
  249 TITLE(I) = FB19(I)                                                X11I2630
      ASSIGN 301 TO KRITE                                               X11I2640
      GO TO 900                                                         X11I2650
  301 DO 304 I=1,15                                                     X11I2660
  304 TITLE(I) = BLANK                                                  X11I2670
      GO TO (901,287,291,288,296,298,291,291),KSWK                      X11I2680
  287 IF (KTABL-1) 335,293,335                                          X11I2690
  288 IF (KTABL-1) 335,291,335                                          X11I2700
  335 WRITE (NW,329)                                                    X11I2710
  329 FORMAT (9X,20H[SAME AS TABLE B 1.])                               X11I2720
      GO TO 999                                                         X11I2730
  291 DO 292 I=1,9                                                      X11I2740
  292 TITLE(I) = FA2(I)                                                 X11I2750
      WRITE (NW,381) TITLE                                              X11I2760
  381 FORMAT (9X,15H*ADJUSTED BY...,20A4)                               X11I2770
  293 GO TO (901,294,901,294,296,298,296,298),KSWK                      X11I2780
  294 DO 295 I=1,9                                                      X11I2790
  295 TITLE(I) = FA4(I)                                                 X11I2800
      GO TO 300                                                         X11I2810
  296 DO 297 I=1,17                                                     X11I2820
  297 TITLE(I) = FB16(I)                                                X11I2830
      GO TO 300                                                         X11I2840
  298 DO 299 I=1,15                                                     X11I2850
  299 TITLE(I) = FB18(I)                                                X11I2860
  300 WRITE (NW,381) TITLE                                              X11I2870
      GO TO 901                                                         X11I2880
  500 GO TO (501,502,503,504,505,506),KTABL                             X11I2890
  501 DO 550 I=1,10                                                     X11I2900
  550 TITLE(I)=FE1(I)                                                   X11I2910
      GO TO 900                                                         X11I2920
  502 DO 551 I=1,9                                                      X11I2930
  551 TITLE(I) = FE2(I)                                                 X11I2940
      GO TO 900                                                         X11I2950
  503 DO 552 I=1,7                                                      X11I2960
  552 TITLE(I)=FE3(I)                                                   X11I2970
      GO TO 900                                                         X11I2980
  504 DO 554 I=1,15                                                     X11I2990
  554 TITLE(I) = FE4(I)                                                 X11I3000
      IF (MULADD) 553,557,553                                           X11I3010
  553 TITLE(1)=DIFRAT(3)                                                X11I3020
      TITLE(2)=DIFRAT(4)                                                X11I3030
      TITLE(3)=DIFRAT(5)                                                X11I3031
  557 ASSIGN  556 TO KRITE                                              X11I3040
      GO TO 900                                                         X11I3050
  556 WRITE (NW,555)                                                    X11I3060
  555 FORMAT (4X,4HYEAR,6X,21HUNMODIFIED   MODIFIED)                    X11I3070
      GO TO 999                                                         X11I3080
  505 DO 558 I=1,11                                                     X11I3090
  558 TITLE(I) = FE5(I)                                                 X11I3100
      GO TO 900                                                         X11I3110
  506 DO 559 I=1,17                                                     X11I3120
  559 TITLE(I) = FE6(I)                                                 X11I3130
      GO TO 900                                                         X11I3140
  600 GO TO (601,602),KTABL                                             X11I3150
  601 DO 658 I=1,5                                                      X11I3160
  658 TITLE(I) = FF1(I)                                                 X11I3170
      ASSIGN 659 TO KRITE                                               X11I3180
      GO TO 900                                                         X11I3190
  659 WRITE (NW,651) MCD                                                X11I3200
  651 FORMAT (12X, 7HMCD IS , I2)                                       X11I3210
      IF (MCD-1) 901,653,901                                            X11I3220
  653 WRITE (NW,652)                                                    X11I3230
  652 FORMAT (9X,13HSEE TABLE D11)                                      X11I3240
      GO TO 999                                                         X11I3250
  602 DO 660 I=1,4                                                      X11I3260
  660 TITLE (I) = FF2(I)                                                X11I3270
  632 ASSIGN 999 TO KRITE                                               X11I3280
      GO TO 900                                                         X11I3290
  700 GO TO (701,702,702,704),KTABL                                     X11I3300
  701 ASSIGN 711 TO KRITE                                               X11I3310
      GO TO 710                                                         X11I3320
  702 ASSIGN 721 TO KRITE                                               X11I3330
      GO TO 710                                                         X11I3340
  704 ASSIGN 741 TO KRITE                                               X11I3350
  710 TITLE(1)=FG1(1)                                                   X11I3360
      TITLE(2)=FG1(2)                                                   X11I3361
      GO TO 900                                                         X11I3370
  711 WRITE (NW,750)                                                    X11I3380
  750 FORMAT (9X,43H[X] - D11. FINAL SEASONALLY ADJUSTED SERIES/        X11I3390
     1        9X,28H[O] - D12. FINAL TREND CYCLE/                       X11I3400
     2        9X,27H[*] - COINCIDENCE OF POINTS)                        X11I3410
      GO TO 999                                                         X11I3420
  721 WRITE (NW,751) RADIF1,RADIF2,RADIF1,RADIF2                        X11I3430
  751 FORMAT(9X,31H[X] - D 8. FINAL UNMODIFIED SI ,3A4/                 X11I3440
     1       9X,20H[O] - D 9. FINAL SI ,3A4,21HMODIFIED FOR EXTREMES/   X11I3450
     2        9X,33H[<] - D10. FINAL SEASONAL FACTORS/                  X11I3460
     2        9X,27H[*] - COINCIDENCE OF POINTS)                        X11I3470
      GO TO 999                                                         X11I3480
  741 WRITE (NW,752)                                                    X11I3490
  752 FORMAT (9X,33H[X] - D13. FINAL IRREGULAR SERIES/                  X11I3500
     1        9X,42H[O] - E 3. FINAL MODIFIED IRREGULAR SERIES/         X11I3510
     2        9X,27H[*] - COINCIDENCE OF POINTS)                        X11I3520
      GO TO 999                                                         X11I3530
  899 TITLE(1)=FINAB(1)                                                 X11I3540
      TITLE(2)=FINAB(2)                                                 X11I3541
  900 WRITE (NW,800) NEWPAG,NAME,KPAGE,LSER                             X11I3550
  800 FORMAT(A1,17X,20A4,2X,3H P.,I2,9H, SERIES ,A4)                    X11I3560
      WRITE (NW,801)SPC,PART,KTABL,(TITLE(I),I=1,20)                    X11I3570
  801 FORMAT(2A1,I2,2H. ,20A4)                                          X11I3580
      KPAGE = KPAGE + 1                                                 X11I3590
      GO TO KRITE,(901,142,301,239,270,386,277,324,328,275,556,659,999, X11I3600
     1 711,721,741)                                                     X11I3610
  901 KDCM = JDCM                                                       X11I3620
      KYRLY = 1                                                         X11I3630
      GO TO (1,2,3,4,5,6,7),KDCM                                        X11I3640
    1 KYRLY = 4                                                         X11I3650
      GO TO 2                                                           X11I3660
    3 IF (MULADD) 9,2,9                                                 X11I3670
    4 IF (MULADD) 9,11,9                                                X11I3680
   11 KDCM = 1                                                          X11I3690
      GO TO 2                                                           X11I3700
    5 KYRLY = 3                                                         X11I3710
      GO TO 4                                                           X11I3720
    6 KYRLY = 4                                                         X11I3730
      GO TO 4                                                           X11I3740
    7 KYRLY = 2                                                         X11I3750
    9 KDCM = KDEC                                                       X11I3760
    2 YRLY = TYRLY(KYRLY)                                               X11I3770
      NF1(3)=NF3(1)                                                     X11I3780
      NF1(4)=NF3(2)                                                     X11I3781
      NF1(8)=KDCML(KDCM)                                                X11I3790
      NF1(11)=KDCML(KDCM)                                               X11I3800
      NF2(9) = KDCML(KDCM)                                              X11I3810
      NF2(15)= KDCML(KDCM)                                              X11I3820
      NF2(23)= KDCML(KDCM)                                              X11I3830
   40 WRITE (NW,99) SPC,YRLY                                            X11I3840
   99 FORMAT (A1,3X,110HYEAR      JAN     FEB     MAR     APR     MAY   X11I3850
     1  JUN     JUL     AUG     SEP     OCT     NOV     DEC         ,A4)X11I3860
      SK = 100.                                                         X11I3870
      IF (MULADD) 20,21,20                                              X11I3880
   20 SK = 0.                                                           X11I3890
   21 KSWR = 1                                                          X11I3900
      JYR = LYR + (JFDA-1)/12                                           X11I3910
      JDEC = (JLDA+11)/12 *12                                           X11I3920
   43 TOTAL=0.0                                                         X11I3930
      YRDEV = 0.0                                                       X11I3940
      TOTDEV = 0.0                                                      X11I3950
      DO 48 I = 1, 12                                                   X11I3960
      TMP(I) = 10.**10                                                  X11I3970
      AVGMON(I) = 0.0                                                   X11I3980
      SDEV(I) = 0.0                                                     X11I3990
   48 TOTMON(I) = 0.0                                                   X11I4000
      JMON=JFDA                                                         X11I4010
      IM = JMON - (JMON-1)/12 * 12                                      X11I4020
      KMON = JMON - IM + 12                                             X11I4030
   45 YRTOT=0.0                                                         X11I4040
      YRDEV = 0.0                                                       X11I4050
      DO 44 I=JMON,KMON                                                 X11I4060
      TMP(IM) = ARRAY(I)                                                X11I4070
      TOTMON(IM) = TOTMON(IM) + 1.                                      X11I4080
      TOTDEV = TOTDEV + TMP(IM)**2                                      X11I4090
      SDEV(IM) = SDEV(IM) + (TMP(IM)-SK)**2                             X11I4100
      YRDEV = YRDEV + (TMP(IM)-SK)**2                                   X11I4110
      AVGMON(IM) = AVGMON(IM) + TMP(IM)                                 X11I4120
      YRTOT = YRTOT + TMP(IM)                                           X11I4130
      TOTAL = TOTAL + TMP(IM)                                           X11I4140
   44 IM = IM + 1                                                       X11I4150
      P = KMON + 1 - JMON                                               X11I4160
      GO TO (86,50,82,87),KYRLY                                         X11I4170
   82 YRTOT = SQRT(YRDEV/P)                                             X11I4180
      GO TO 50                                                          X11I4190
   86 YRTOT = YRTOT/P                                                   X11I4200
      GO TO 50                                                          X11I4210
   87 YRTOT = ARR(IN)                                                   X11I4220
      IN = IN + 1                                                       X11I4230
   50 WRITE (NW,NF1) SPC,JYR,(TMP(I),I=1,12),YRTOT                      X11I4240
   51 JYR = JYR + 1                                                     X11I4250
      JMON=KMON+1                                                       X11I4260
      KMON=KMON+12                                                      X11I4270
      IM = 1                                                            X11I4280
      IF (KMON-JDEC) 45,46,70                                           X11I4290
   46 KMON = JLDA                                                       X11I4300
      DO 41 I = 1,12                                                    X11I4310
   41 TMP(I) = 10.**10                                                  X11I4320
      GO TO 45                                                          X11I4330
   70 WRITE (NW,802) SPC                                                X11I4340
  802 FORMAT (A1)                                                       X11I4350
      GO TO (80,73,75,80,73,89),KAVG                                    X11I4360
   73 NF1(3)=NF4(1)                                                     X11I4370
      NF1(4)=NF4(2)                                                     X11I4371
      DO 71 I = 1,12                                                    X11I4380
   71 AVGMON(I) =AVGMON(I)/TOTMON(I)                                    X11I4390
      GO TO 72                                                          X11I4400
   75 NF1(3)=NF5(1)                                                     X11I4410
      NF1(4)=NF5(2)                                                     X11I4411
      NF1(8)=KDCML(1)                                                   X11I4420
      DO 76 I = 1,12                                                    X11I4430
   76 AVGMON(I) = SQRT(SDEV(I)/TOTMON(I))                               X11I4440
   72 WRITE (NW,NF1) SPC,(AVGMON(I),I=1,12)                             X11I4450
   80 IF (KAVG-3) 81,81,88                                              X11I4460
   81 TOTN = JLDA+1-JFDA                                                X11I4470
      AVGE = TOTAL/TOTN                                                 X11I4480
      TOTDEV = SQRT(TOTDEV/TOTN - AVGE**2)                              X11I4490
      WRITE (NW,NF2) SPC,TOTAL,BLANK,AVGE,TOTDEV                        X11I4500
      GO TO 89                                                          X11I4510
   88 WRITE (NW,NF2) SPC,TOTAL                                          X11I4520
   89 GO TO KEXIT,(999,145,227,345,388,274)                             X11I4530
  999 RETURN                                                            X11I4540
      END                                                               X11I4550
C --- LIP FOR SUMRY,SUMRY,SUMRYS                                        X11J0010
      SUBROUTINE SUMRY (ARRAY,SM,LFDA,LLDA,N)                           X11J0020
C     AVERAGE PERCENT CHANGE WITHOUT REGARD TO SIGN FOR 1-12 MONTHS     X11J0030
C     SPANS IN SM[1]-SM[12]. AVGE PCT CHANGE WITH REGARD TO SIGN -      X11J0040
C     SM[25]-SM[36]. AVGE PCT CHANGE W/O REGARD TO SIGN SQUARED -       X11J0050
C     SM[13]-SM[24]. STND.DEVIATION OF PERCENT CHANGES - SM[37]-SM[48]. X11J0060
      COMMON/CJ/MULADD                                                  X11J0070
      DIMENSION ARRAY(600),SM(48)                                       X11J0080
      K = LLDA                                                          X11J0090
      DO 20 I = 1,12                                                    X11J0100
      K = K-1                                                           X11J0110
      P = K-LFDA+1                                                      X11J0120
      SM(I) = 0.                                                        X11J0130
      DO 3 J = LFDA,K                                                   X11J0140
      M = I + J                                                         X11J0150
      IF (MULADD) 2,1,2                                                 X11J0160
    1 SM(I)=SM(I)+ABS((ARRAY(M) - ARRAY(J))*100./ARRAY(J))              X11J0170
      GO TO 3                                                           X11J0180
    2 SM(I)=SM(I)+ABS(ARRAY(M) - ARRAY(J))                              X11J0190
    3 CONTINUE                                                          X11J0200
      SM(I) = SM(I)/P                                                   X11J0210
      IF (N-3) 4,6,20                                                   X11J0220
    4 SM(I+12) = SM(I)**2                                               X11J0230
    5 IF (N-2) 20,6,20                                                  X11J0240
    6 SM(I+24) = 0                                                      X11J0250
      SM(I+36) = 0                                                      X11J0260
      DO 9 J = LFDA,K                                                   X11J0270
      M = I + J                                                         X11J0280
      IF (MULADD) 8,7,8                                                 X11J0290
    7 SM(I+24) = SM(I+24)+(ARRAY(M) - ARRAY(J))*100./ARRAY(J)           X11J0300
      GO TO 9                                                           X11J0310
    8 SM(I+24) = SM(I+24)+ARRAY(M) - ARRAY(J)                           X11J0320
    9 CONTINUE                                                          X11J0330
      SM(I+24) = SM(I+24)/P                                             X11J0340
      DO 12 J = LFDA,K                                                  X11J0350
      M = I + J                                                         X11J0360
      IF (MULADD) 11,10,11                                              X11J0370
   10 ARRAY(J)=ARRAY(J)                                                 X11J0380
      SM(I+36)=SM(I+36)+(SM(I+24)-(ARRAY(M)-ARRAY(J))*100./ARRAY(J))**2 X11J0390
      GO TO 12                                                          X11J0400
   11 SM(I+36)=SM(I+36)+(ARRAY(M) - ARRAY(J)-SM(I+24))**2               X11J0410
   12 CONTINUE                                                          X11J0420
      SM(I+36) = SQRT(SM(I+36)/P)                                       X11J0430
   20 CONTINUE                                                          X11J0440
      RETURN                                                            X11J0450
      END                                                               X11J0460
C --- LIP FOR TRADAY,TRADAY,TRADAS                                      X11K0010
C --- THIS ROUTINE COMPUTES SEVEN DAILY WEIGHTS FROM THE DATA BY        X11K0020
C --- REGRESSION METHODS.                                               X11K0030
      SUBROUTINE TRADAY (KFDA,KLDA,LYR,SIGM,KPART,LOPT,KSWT)            X11K0040
      REAL MATRX                                                        X11K0050
      COMMON/CA/NW,STMP(600)                                            X11K0060
      COMMON /CJ/MULADD                                                 X11K0070
      COMMON/CL/ARRAY(360),KARRAY(360),STDR(360),DR(7),DP(7),FSTAR,KPRNTX11K0080
      DIMENSION KDAYS(12),MDAYS(12),TMEAN(22),TC(22),X(7),C(6),S(7),V(6)X11K0090
     1,TP(7),DC(7),T1(7),STAR1(7),STAR2(7),SETDAF(3),ADJ(8)             X11K0100
     2,MATRX(6,7),WT(3)                                                 X11K0110
      DATA DUMMY/1H /                                                   X11K0111
      DATA ADJ/31.,30.,29.,0.,30.4375,30.4375,30.4375,0./               X11K0120
      DATA STAR/4H****/                                                 X11K0130
      DATA BLANK/4H    /                                                X11K0140
      DATA KDAYS/3,0,3,2,3,2,3,3,2,3,2,3/                               X11K0150
      DATA MDAYS/0,3,3,6,1,4,6,2,5,0,3,5/                               X11K0160
 8200 FORMAT (22X,65HCOMBINED      PRIOR    REGRESSION   ST.ERROR       X11K0170
     1  T          T/                                                   X11K0180
     223X,52HWEIGHT      WEIGHT      COEFF.    [COMB.WT.]       [,I1,   X11K0190
     317H]     [PRIOR WT.]/                                             X11K0200
     411X,9H   MONDAY,F9.3,7X,F5.3,3F12.3,A1,4X,F7.3,A2/                X11K0210
     511X,9H  TUESDAY,F9.3,7X,F5.3,3F12.3,A1,4X,F7.3,A2/                X11K0220
     611X,9HWEDNESDAY,F9.3,7X,F5.3,3F12.3,A1,4X,F7.3,A2/                X11K0230
     711X,9H THURSDAY,F9.3,7X,F5.3,3F12.3,A1,4X,F7.3,A2/                X11K0240
     811X,9H   FRIDAY,F9.3,7X,F5.3,3F12.3,A1,4X,F7.3,A2/                X11K0250
     911X,9H SATURDAY,F9.3,7X,F5.3,3F12.3,A1,4X,F7.3,A2/                X11K0260
     911X,9H   SUNDAY,F9.3,7X,F5.3,3F12.3,A1,4X,F7.3,A2)                X11K0270
 8201 FORMAT (26X,46H*   COMBINED WT. SIGNIFICANTLY DIFFERENT FROM ,I1, X11K0280
     1 20H AT 1 PER CENT LEVEL)                                         X11K0290
 8202 FORMAT (26X,78H**  COMBINED WT. SIGNIFICANTLY DIFFERENT FROM PRIORX11K0300
     1 WEIGHT AT 1 PER CENT LEVEL)                                      X11K0310
 8203 FORMAT (//21X,9HSOURCE OF, 9X, 6HSUM OF,5X,7HDGRS.OF,9X,4HMEAN/   X11K0320
     122X,8HVARIANCE,9X,7HSQUARES,4X,7HFREEDOM,9X,6HSQUARE,9X,1HF//     X11K0330
     220X,10HREGRESSION,F17.3,7X,2H6.,F17.3,F12.3,A3/                   X11K0340
     325X,5HERROR,F17.3,F9.0,F17.3/                                     X11K0350
     425X,5HTOTAL,F17.3,F9.0)                                           X11K0360
 8204 FORMAT (26X,66H*** RESIDUAL TRADING DAY VARIATION PRESENT AT THE 1X11K0370
     1 PER CENT LEVEL/)                                                 X11K0380
 8205 FORMAT (11X,86HSTANDARD ERRORS OF TRADING DAY ADJUSTMENT FACTORS DX11K0390
     1ERIVED FROM REGRESSION COEFFICIENTS/15X,15H31-DAY MONTHS- ,F8.2/  X11K0400
     215X,15H30-DAY MONTHS- ,F8.2/15X,15H29-DAY MONTHS- ,F8.2/15X,23H28-X11K0410
     3DAY MONTHS-      .00)                                             X11K0420
      LFDA = KFDA                                                       X11K0430
      LLDA = KLDA                                                       X11K0440
      TKON = 100.                                                       X11K0450
      Z1 = 28.25                                                        X11K0454
      Z2 = 28.25                                                        X11K0455
      GO TO (81,80,81,80),KSWT                                          X11K0456
   80 Z1 = 28.                                                          X11K0457
      Z2 = 29.                                                          X11K0458
   81 KON = 1                                                           X11K0460
      IF (MULADD) 198,199,198                                           X11K0470
  198 TKON = 0.                                                         X11K0480
      KON = 0                                                           X11K0490
  199 IF (KPART-1) 200,200,300                                          X11K0500
C --- DETERMINE DAY-OF-WEEK OF FIRST DAY OF FIRST MONTH OF SERIES       X11K0510
C ---     DETERMINE D-O-W OF JAN.1 OF LYR. 1=MON., 7=SUN.               X11K0520
  200 N = LYR + 12 - ((LYR + 11)/28) * 28                               X11K0530
      N = N + (N-1)/4                                                   X11K0540
      N = N - ((N-1)/7) * 7                                             X11K0550
C ---    D-O-W FOR ACTUAL FIRST MONTH OF SERIES                         X11K0560
      J = LFDA - (LFDA-1)/12*12                                         X11K0570
      N = N + MDAYS(J)                                                  X11K0580
C ---    ADD A DAY IF FIRST MONTH IS IN LEAP YEAR AND AFTER FEB.        X11K0590
      L = LYR - 1                                                       X11K0600
      IF (J-2) 11,11,12                                                 X11K0610
   12 L = LYR                                                           X11K0620
      IF (LYR-LYR/4*4) 11,13,11                                         X11K0630
   13 N = N + 1                                                         X11K0640
   11 IF (N - 7) 10, 10, 9                                              X11K0650
    9 N = N - 7                                                         X11K0660
   10 M = N                                                             X11K0670
C --- STORE TYPE CODE FOR EACH MONTH IN KARRAY.ALSO ACCUMULATE IRREGULARX11K0680
C ---   AND COUNT BY TYPE TO GET TYPE MEAN                              X11K0690
      DO 8 I = LFDA, LLDA                                               X11K0700
      STMP(I) = 10.**10                                                 X11K0710
      K = KDAYS(J)                                                      X11K0720
C --- TEST FOR FEB.                                                     X11K0730
      IF (K) 4, 1, 4                                                    X11K0740
C --- TEST FOR LEAP YEAR FEB.                                           X11K0750
    1 L = L + 1                                                         X11K0760
      IF (L - (L/4) * 4) 2, 3, 2                                        X11K0770
C --- NON-LEAP YEAR FEB. TYPE CODE IS 15                                X11K0780
    2 MTYPE = 15                                                        X11K0790
      GO TO 14                                                          X11K0800
C --- LEAP YEAR FEB. TYPE CODE IS 16-22 FOR 1ST DAY MON. THRU SUN.      X11K0810
    3 MTYPE = M + 15                                                    X11K0820
      K = 1                                                             X11K0830
      GO TO 14                                                          X11K0840
C --- TYPE CODES FOR NON-FEB ARE 1-7  AND  8-14 FOR 30 AND 31 DAY MOS.  X11K0850
    4 MTYPE = (K - 2) * 7 + M                                           X11K0860
C --- STORE TYPE CODE IN KARRAY                                         X11K0870
   14 KARRAY(I) = MTYPE                                                 X11K0880
C --- FIND FIRST DAY FOR NEXT MONTH IN SERIES                           X11K0890
      M = M + K                                                         X11K0900
      IF (M - 7) 6, 6, 5                                                X11K0910
    5 M = M - 7                                                         X11K0920
    6 J = J + 1                                                         X11K0930
      IF (J - 12) 8, 8, 7                                               X11K0940
    7 J = 1                                                             X11K0950
    8 CONTINUE                                                          X11K0960
C --- COMPUTE SIGMA LIMITS AND IDENTIFY EXTREME IRREGULARS              X11K0970
      KSTD = 1                                                          X11K0980
   21 DO 22 I = 1, 22                                                   X11K0990
      TC(I) = 0.                                                        X11K1000
   22 TMEAN(I) = 0.                                                     X11K1010
      TK = 0.                                                           X11K1020
      TSD = 0.                                                          X11K1030
      DO 24 I = LFDA, LLDA                                              X11K1040
      M = KARRAY(I)                                                     X11K1050
      IF (M - 15) 23, 23, 24                                            X11K1060
   23 TMEAN(M) = TMEAN(M) + ARRAY(I)                                    X11K1070
      TC(M) = TC(M) + 1.                                                X11K1080
      TK = TK + 1.                                                      X11K1090
   24 CONTINUE                                                          X11K1100
      DO 25 I = 1, 15                                                   X11K1110
   25 TMEAN(I) = TMEAN(I)/TC(I)                                         X11K1120
C --- COMPUTE SQ.DEV. OF IRR.FM.TYPE-MEANS FOR NON-LEAP YEAR FEBS.      X11K1130
      DO 28 I = LFDA, LLDA                                              X11K1140
      M = KARRAY(I)                                                     X11K1150
      IF (M - 15) 27, 27, 28                                            X11K1160
   27 TSD = TSD + (ARRAY(I) - TMEAN(M))**2                              X11K1170
   28 CONTINUE                                                          X11K1180
      TSD = SQRT(TSD/TK) * SIGM                                         X11K1190
C --- IDENTIFY EXTREME IRREGULARS BY ADDING 22 TO TYPE CODE             X11K1200
      DO 35 I = LFDA, LLDA                                              X11K1210
      M = KARRAY(I)                                                     X11K1220
      IF (M - 22) 29, 29, 35                                            X11K1230
   29 IF (M - 15) 30, 30, 33                                            X11K1240
   30 IF (ABS(ARRAY(I)-TMEAN(M))-TSD) 35,35,32                          X11K1250
   33 IF (ABS(ARRAY(I)-TKON)-TSD) 35,35,32                              X11K1260
   32 KARRAY(I) = KARRAY(I) + 22                                        X11K1270
      STMP(I) = ARRAY(I)                                                X11K1280
   35 CONTINUE                                                          X11K1290
      GO TO ( 36, 37), KSTD                                             X11K1300
   36 KSTD = 2                                                          X11K1310
      GO TO 21                                                          X11K1320
  300 DO 302 I = LFDA, LLDA                                             X11K1330
  333 IF (KARRAY(I) - 22) 302,302,301                                   X11K1340
  301 KARRAY(I) = KARRAY(I) - 22                                        X11K1350
      GO TO 333                                                         X11K1355
  302 CONTINUE                                                          X11K1360
      KSTD = 1                                                          X11K1370
  310 TSD = 0.                                                          X11K1380
      TK = 0.                                                           X11K1390
      DO 304 I = LFDA, LLDA                                             X11K1400
      IF (KARRAY(I) - 22) 303,303,304                                   X11K1410
  303 TSD = TSD + (ARRAY(I) - STDR(I))**2                               X11K1420
      TK = TK + 1.                                                      X11K1430
  304 CONTINUE                                                          X11K1440
      TSD = SQRT(TSD/TK) * SIGM                                         X11K1450
      DO 308 I = LFDA, LLDA                                             X11K1460
      STMP(I) = 10.**10                                                 X11K1470
  305 IF (ABS(ARRAY(I)-STDR(I))-TSD) 308,308,307                        X11K1480
  307 KARRAY(I) = KARRAY(I) + 22                                        X11K1490
      STMP(I) = ARRAY(I)                                                X11K1500
  308 CONTINUE                                                          X11K1510
      GO TO (309, 37), KSTD                                             X11K1520
  309 KSTD = 2                                                          X11K1530
      GO TO 310                                                         X11K1540
C --- REGRESSION COMPUTATION                                            X11K1550
   37 IF (KPRNT-2) 39,38,38                                             X11K1560
   38 CALL RITE (14,STMP,LFDA,LLDA,6,4,0)                               X11K1570
      CALL RITE (15,0,0,0,0,0,0)                                        X11K1580
   39 SUMY = 0.                                                         X11K1590
      SUMYSQ = 0.                                                       X11K1600
      DO 40 I = 1, 6                                                    X11K1610
      DO 40 J = 1, 7                                                    X11K1620
   40 MATRX(I,J) = 0.                                                   X11K1630
      DO 58 I = LFDA, LLDA                                              X11K1640
      DO 41 J = 1, 7                                                    X11K1650
   41 X(J) = 0.                                                         X11K1660
      M = KARRAY(I)                                                     X11K1670
      Y = ARRAY(I)                                                      X11K1680
      IF (M - 7) 251,251,201                                            X11K1690
  201 M = M - 7                                                         X11K1700
      IF (M - 8) 245,210,202                                            X11K1710
  202 M = M - 8                                                         X11K1720
      IF (M - 7) 203,203,58                                             X11K1730
C --- 28 DAY MONTH                                                      X11K1732
  210 IF (MULADD) 56,211,56                                             X11K1734
  211 GO TO (212,213,212,213), KSWT                                     X11K1736
  212 Y = Y * 0.2825 - 28.0                                             X11K1738
      GO TO 56                                                          X11K1740
  213 Y = Y * 0.28 - 28.0                                               X11K1742
      GO TO 56                                                          X11K1744
C --- 29 DAY MONTH                                                      X11K1746
  203 N = 1                                                             X11K1748
      IF (MULADD) 50,220,50                                             X11K1750
  220 GO TO (221,222,221,222), KSWT                                     X11K1752
  221 Y = Y * 0.2825 - 29.0                                             X11K1754
      GO TO 50                                                          X11K1756
  222 Y = (Y / 100.0 - 1.0) * (28.0 + DP(M))                            X11K1758
      GO TO 50                                                          X11K1760
C --- 30 DAY MONTH                                                      X11K1762
  251 N = 2                                                             X11K1764
      IF (MULADD) 50,252,50                                             X11K1766
  252 M1 = M + 1                                                        X11K1768
      IF (M1 - 8) 254,253,253                                           X11K1770
  253 M1 = 1                                                            X11K1772
  254 Y = (Y / 100.0 - 1.0) * (28.0 + DP(M) + DP(M1))                   X11K1774
      GO TO 50                                                          X11K1780
C --- 31 DAY MONTH                                                      X11K1790
  245 N = 3                                                             X11K1800
      IF (MULADD) 50,246,50                                             X11K1810
  246 M1 = M + 1                                                        X11K1820
      M2 = M + 2                                                        X11K1830
      IF (M1 - 7) 249,248,247                                           X11K1840
  247 M1 = M1 - 7                                                       X11K1850
  248 M2 = M2 - 7                                                       X11K1860
  249 Y = (Y / 100.0 - 1.0) * (28.0 + DP(M) + DP(M1) + DP(M2))          X11K1870
   50 DO 53 J = 1, N                                                    X11K1880
      IF (M - 7) 52, 52, 51                                             X11K1890
   51 M = M - 7                                                         X11K1900
   52 X(M) = 1.                                                         X11K1910
   53 M = M + 1                                                         X11K1920
      IF (X(7)) 56, 56, 54                                              X11K1930
   54 DO 55 J = 1, 6                                                    X11K1940
   55 X(J) = X(J) - 1.                                                  X11K1950
   56 SUMY = SUMY + Y                                                   X11K1960
      SUMYSQ = SUMYSQ + Y * Y                                           X11K1970
      DO 57 M = 1, 6                                                    X11K1980
      MATRX(M,7) = MATRX(M,7) + Y * X(M)                                X11K1990
      DO 57 J = 1, 6                                                    X11K2000
   57 MATRX(M,J) = MATRX(M,J) + X(M) * X(J)                             X11K2010
   58 CONTINUE                                                          X11K2020
      DO 59 I = 1, 6                                                    X11K2030
   59 V(I) = MATRX(I,7)                                                 X11K2040
      DO 65 I = 1, 6                                                    X11K2050
   61 R = 1./MATRX(I,1)                                                 X11K2060
      DO 62 J = 1, 6                                                    X11K2070
   62 MATRX(I,J) = R * MATRX(I, J+1)                                    X11K2080
      MATRX(I,7) = R                                                    X11K2090
      DO 65 M = 1, 6                                                    X11K2100
      IF (M - I) 63, 65, 63                                             X11K2110
   63 R = -MATRX(M,1)                                                   X11K2120
      DO 64 J = 1, 6                                                    X11K2130
   64 MATRX(M,J) = MATRX(M,J+1) + R * MATRX(I,J)                        X11K2140
      MATRX(M,7) = R * MATRX(I,7)                                       X11K2150
   65 CONTINUE                                                          X11K2160
      S(7) = 0.                                                         X11K2170
      DO 66 I = 1, 6                                                    X11K2180
      DO 66 J = 2, 7                                                    X11K2190
   66 S(7) = S(7) + MATRX(I,J)                                          X11K2200
      DO 67 I = 1, 6                                                    X11K2210
   67 C(I) = MATRX(I,I+1)                                               X11K2220
      DSS = 0.                                                          X11K2230
      XN = 0.                                                           X11K2240
      DO 69 I = LFDA,LLDA                                               X11K2250
      IF (KARRAY(I)-22) 68,68,69                                        X11K2260
   68 XN = XN + 1.                                                      X11K2270
   69 CONTINUE                                                          X11K2280
      DR(7) = 0.                                                        X11K2290
      DO 71 I = 1, 6                                                    X11K2300
      DR(I) = MATRX(I,1)                                                X11K2310
      DR(7) = DR(7) - MATRX(I,1)                                        X11K2320
   71 DSS = DSS + DR(I) * V(I)                                          X11K2330
      RSS = SUMYSQ - DSS                                                X11K2340
      TMP = RSS/(XN - 6.)                                               X11K2350
      SE = SQRT(TMP)                                                    X11K2360
      F = (DSS/6.)/TMP                                                  X11K2370
      FSTAR = BLANK                                                     X11K2380
      IF (F-2.95) 75,75,74                                              X11K2390
   74 FSTAR = STAR                                                      X11K2400
   75 IF (KPRNT-2) 107,109,109                                          X11K2410
  109 DO 72 I = 1,6                                                     X11K2420
   72 S(I) = SE * SQRT(C(I))                                            X11K2430
      S(7) = SE * SQRT(S(7))                                            X11K2440
      TMP = XN - 6.                                                     X11K2450
      DSSM = DSS/6.                                                     X11K2460
      RSSM = RSS/TMP                                                    X11K2470
      SUMM = SUMYSQ/XN                                                  X11K2480
      SIGT1 = 0.                                                        X11K2490
      SIGT2 = 0.                                                        X11K2500
      DO 97 I = 1, 7                                                    X11K2510
      STAR1(I) = BLANK                                                  X11K2520
      STAR2(I) = BLANK                                                  X11K2530
      IF (MULADD) 110,92,110                                            X11K2540
   92 X(I) = DP(I)                                                      X11K2550
      DC(I) = DP(I) + DR(I)                                             X11K2560
      TP(I) = DR(I)/S(I)                                                X11K2570
      T1(I) = (DC(I)-1.)/S(I)                                           X11K2580
      IF (ABS(TP(I))-2.62) 95,95,94                                     X11K2590
   94 STAR2(I) = STAR                                                   X11K2600
      SIGT2 = 1.                                                        X11K2610
      GO TO 95                                                          X11K2620
  110 X(I) = 10.**10                                                    X11K2630
      TP(I) = 10.**10                                                   X11K2640
      DC(I) = DR(I)                                                     X11K2650
      T1(I) = DC(I)/S(I)                                                X11K2660
   95 IF (ABS(T1(I))-2.62) 97,97,96                                     X11K2670
   96 STAR1(I) = STAR                                                   X11K2680
      SIGT1 = 1.                                                        X11K2690
   97 CONTINUE                                                          X11K2700
  104 WRITE (NW,8200) KON,(DC(I),X(I),DR(I),S(I),T1(I),STAR1(I),TP(I),  X11K2710
     1STAR2(I), I = 1,7)                                                X11K2720
      IF (SIGT1 - 1.)99, 98, 99                                         X11K2730
   98 WRITE (NW,8201) KON                                               X11K2740
   99 IF (SIGT2 -1.) 101, 100, 101                                      X11K2750
  100 WRITE (NW, 8202)                                                  X11K2760
  101 WRITE (NW,8203) DSS,DSSM,F,FSTAR,RSS,TMP,RSSM,SUMYSQ,XN           X11K2770
      IF (FSTAR-BLANK)102,105,102                                       X11K2780
  102 WRITE (NW, 8204)                                                  X11K2790
  105 DO 106 K = 1,3                                                    X11K2800
      M = K + LOPT                                                      X11K2810
      WT(K) = ADJ(M)                                                    X11K2820
      M = 4 - K                                                         X11K2830
      SETDAF(M) = 0.                                                    X11K2840
      L = K+1                                                           X11K2850
      DO 106 I = 1,K                                                    X11K2860
      DO 106 J = 2,L                                                    X11K2870
  106 SETDAF(M) = SETDAF(M) + MATRX(I,J)                                X11K2880
      DO 108 I = 1,3                                                    X11K2890
  108 SETDAF(I) = SQRT(SETDAF(I))*100.*SE/WT(I)                         X11K2900
      WRITE (NW,8205) SETDAF                                            X11K2910
  107 RETURN                                                            X11K2920
      END                                                               X11K2930
C --- LIP FOR VSFC,VSFC,VSFCS                                           X11L0010
      SUBROUTINE VSFC (LFDA,LLDA,KSECT)                                 X11L0020
C --- SEASONAL FACTOR CURVE ROUTINE.                                    X11L0030
      COMMON/CA/NW,STMP(600)                                            X11L0040
      COMMON/CC/RATI(36),LTERM(12),STS(372),STSI(360)                   X11L0050
      COMMON/CF/LSER,LYR,PART,KSWK,FINAB(2),FINAP(2),KPART,AORB,OUT,MCD,X11L0060
     1 SIGM,SIGML,SIGMU,IN,RADIF1(2),RADIF2,KDEC,NEWPAG,SPC,NAME(20),   X11L0070
     2 LBK,LBNK,TCARD,KSER,LAYR,LSTMO,LSTYR,KPROPT                      X11L0071
      COMMON/CJ/MULADD                                                  X11L0080
      DIMENSION W3X9(66), W3A9(50), W3B9(45), W3C9(32), W3D9(28),       X11L0090
     1 W3E9(18), W3X5(28), W3A5(18),W3B5(15), W3C5(8), W3X3(15),        X11L0100
     2 W3A3(8), W3B3(6), W3X1(6),STSP(57),STAVG(57)                     X11L0110
C --- WEIGHTS FOR 3X9 MOVING AVGE. WEIGHTS IN W3A9-W3E9 ARE FOR SERIES  X11L0120
C --- SHORTER THAN 11 YEARS.                                            X11L0130
      DATA DUMMY/1H /                                                   X11L0131
      DATA W3X9/                                                        X11L0140
     2 .246, .221, .197, .173, .112, .051, .0  , .0  , .0  , .0  , .0  ,X11L0150
     3 .208, .192, .176, .160, .144, .092, .028, .0  , .0  , .0  , .0  ,X11L0160
     4 .173, .163, .154, .143, .133, .123, .079, .032, .0  , .0  , .0  ,X11L0170
     5 .141, .137, .132, .128, .123, .117, .113, .075, .034, .0  , .0  ,X11L0180
     6 .084, .120, .118, .117, .116, .114, .113, .111, .073, .034, .0  ,X11L0190
     7 .037, .074, .111, .111, .111, .111, .111, .111, .111, .074, .037/X11L0200
      DATA W3A9/                                                        X11L0210
     2 .246, .221, .197, .173, .112, .051, .0  , .0  , .0  , .0  ,      X11L0220
     3 .208, .192, .176, .160, .144, .092, .028, .0  , .0  , .0  ,      X11L0230
     4 .173, .163, .154, .143, .133, .123, .079, .032, .0  , .0  ,      X11L0240
     5 .141, .137, .132, .128, .123, .117, .113, .075, .034, .0  ,      X11L0250
     6 .084, .120, .118, .117, .116, .114, .113, .111, .073, .034/      X11L0260
      DATA W3B9/                                                        X11L0270
     2 .246, .221, .197, .173, .112, .051, .0  , .0  , .0  ,            X11L0280
     3 .208, .192, .176, .160, .144, .092, .028, .0  , .0  ,            X11L0290
     4 .173, .163, .154, .143, .133, .123, .079, .032, .0  ,            X11L0300
     5 .141, .137, .132, .128, .123, .117, .113, .075, .034,            X11L0310
     6 .111, .111, .111, .111, .111, .111, .111, .111, .111/            X11L0320
      DATA W3C9/                                                        X11L0330
     2 .246, .221, .197, .173, .112, .051, .0  , .0  ,                  X11L0340
     3 .208, .192, .176, .160, .144, .092, .028, .0  ,                  X11L0350
     4 .173, .163, .154, .143, .133, .123, .079, .032,                  X11L0360
     5 .125, .125, .125, .125, .125, .125, .125, .125/                  X11L0370
      DATA W3D9/                                                        X11L0380
     2 .246, .221, .197, .173, .112, .051, .0  ,                        X11L0390
     3 .208, .192, .176, .160, .144, .092, .028,                        X11L0400
     4 .143, .143, .143, .143, .143, .143, .143,                        X11L0410
     5 .143, .143, .143, .143, .143, .143, .143/                        X11L0420
      DATA W3E9/                                                        X11L0430
     2 .246, .221, .197, .173, .112, .051,                              X11L0440
     3 .167, .167, .167, .167, .167, .167,                              X11L0450
     4 .167, .167, .167, .167, .167, .167/                              X11L0460
C --- WEIGHTS FOR 3X5 MOVING AVERAGE.                                   X11L0470
      DATA W3X5/                                                        X11L0480
     2 .283, .283, .283, .150, .0  , .0  , .0  ,                        X11L0490
     3 .250, .250, .250, .183, .067, .0  , .0  ,                        X11L0500
     4 .150, .217, .217, .217, .133, .067, .0  ,                        X11L0510
     5 .067, .133, .200, .200, .200, .133, .067/                        X11L0520
      DATA W3A5/                                                        X11L0530
     2 .283, .283, .283, .150, .0  , .0  ,                              X11L0540
     3 .250, .250, .250, .183, .067, .0  ,                              X11L0550
     4 .150, .217, .217, .217, .133, .067/                              X11L0560
      DATA W3B5/                                                        X11L0570
     2 .283, .283, .283, .150, .0  ,                                    X11L0580
     3 .250, .250, .250, .183, .067,                                    X11L0590
     4 .200, .200, .200, .200, .200/                                    X11L0600
      DATA W3C5/                                                        X11L0610
     2 .283, .283, .283, .150,                                          X11L0620
     3 .250, .250, .250, .250/                                          X11L0630
C --- WEIGHTS FOR 3X3 MOVING AVERAGE.                                   X11L0640
      DATA W3X3/                                                        X11L0650
     2 .407, .407, .185, .0  , .0  ,                                    X11L0660
     3 .259, .370, .259, .111, .0  ,                                    X11L0670
     4 .111, .222, .333, .222, .111/                                    X11L0680
      DATA W3A3/                                                        X11L0690
     2 .407, .407, .185, .0  ,                                          X11L0700
     3 .259, .370, .259, .111/                                          X11L0710
      DATA W3B3/                                                        X11L0720
     2 .407, .407, .185,                                                X11L0730
     3 .333, .333, .333/                                                X11L0740
C --- WEIGHTS FOR 3-TERM MOVING AVERAGE.                                X11L0750
      DATA W3X1/                                                        X11L0760
     2 .610, .390, .0  ,                                                X11L0770
     3 .333, .333, .333/                                                X11L0780
      MFDA = LFDA                                                       X11L0790
      MLDA = LLDA                                                       X11L0800
      KFDA = MFDA + 11                                                  X11L0810
C --- FOR EACH MONTH SEPARATELY.                                        X11L0820
      DO 291 J = MFDA,KFDA                                              X11L0830
      M = J-(J-1)/12*12                                                 X11L0840
      K = 3                                                             X11L0850
C --- MOVE MONTH TO *STSP*.                                             X11L0860
      DO 260 I = J,MLDA,12                                              X11L0870
      K = K + 1                                                         X11L0880
  260 STSP(K) = STSI(I)                                                 X11L0890
      IF (KPART-3) 256,401,256                                          X11L0900
  401 IF (KSECT-2) 256,402,256                                          X11L0910
C --- COMPUTE IBAR,SBAR,AND RATIO IN FINAL ROUND ONLY.                  X11L0920
C --- COMPUTE 7-TERM MOVING AVERAGE FOR ESTIMATE OF S.                  X11L0930
  402 DO 20 I = 1,3                                                     X11L0940
      STSP(I) =(STSP(4)+STSP(5)+STSP(6))/3.                             X11L0950
      KI = K + I                                                        X11L0960
   20 STSP(KI)  = (STSP(K)+STSP(K-1)+STSP(K-2))/3.                      X11L0970
      DO 21 I = 4,K                                                     X11L0980
   21 STAVG(I) = (STSP(I-3)+STSP(I-2)+STSP(I-1)+STSP(I)+STSP(I+1)+      X11L0990
     1STSP(I+2)+STSP(I+3))/7.                                           X11L1000
C --- COMPUTE SBAR.                                                     X11L1010
   30 RATI(M+12) = 0.                                                   X11L1020
      DO 242 I = 5,K                                                    X11L1030
      IF (MULADD) 241,261,241                                           X11L1040
  241 RATI(M+12) = RATI(M+12) + ABS(STAVG(I-1)-STAVG(I))                X11L1050
      GO TO 242                                                         X11L1060
  261 RATI(M+12)=RATI(M+12)+ABS(STAVG(I-1)-STAVG(I))/STAVG(I)*100.      X11L1070
  242 CONTINUE                                                          X11L1080
      P = K-4                                                           X11L1090
      RATI(M+12) = RATI(M+12)/P                                         X11L1100
C --- DIVIDE SI/S FOR ESTIMATE OF I                                     X11L1110
      CALL ADDMUL (STAVG,STSP,STAVG,4,K)                                X11L1120
C --- COMPTUE IBAR                                                      X11L1130
      RATI(M) = 0.                                                      X11L1140
      DO 244 I = 5,K                                                    X11L1150
      IF (MULADD) 243,263,243                                           X11L1160
  243 RATI(M) = RATI(M) + ABS(STAVG(I-1)-STAVG(I))                      X11L1170
      GO TO 244                                                         X11L1180
  263 RATI(M)=RATI(M)+ABS(STAVG(I-1)-STAVG(I))/STAVG(I)*100.            X11L1190
  244 CONTINUE                                                          X11L1200
      RATI(M) = RATI(M)/P                                               X11L1210
C --- COMPUTE IBAR/SBAR RATIO. LARGEST RATIO PRINTED IS 999.99.         X11L1220
      RATI(M+24) = 999.99                                               X11L1230
      IF (RATI(M)-RATI(M+12)*999.99) 255,256,256                        X11L1240
  255 RATI(M+24) = RATI(M)/RATI(M+12)                                   X11L1250
  256 NTERM = LTERM(M)                                                  X11L1260
C --- CHECK IF MOVING AVERAGE FOR THIS MONTH PRESELECTED.               X11L1270
      IF (NTERM) 267,267,264                                            X11L1280
  264 GO TO (286,283,279,272,268),NTERM                                 X11L1290
C --- STABLE SEASONAL. AVERAGE OF ALL SI RATIOS FOR THIS MONTH.         X11L1300
  268 TMP = 0.                                                          X11L1310
      DO 269 I = 4,K                                                    X11L1320
  269 TMP = TMP + STSP(I)                                               X11L1330
      SUM = K - 3                                                       X11L1340
      TMP = TMP/SUM                                                     X11L1350
      DO 270 I = 4,K                                                    X11L1360
  270 STAVG(I) = TMP                                                    X11L1370
      GO TO 290                                                         X11L1380
C --- COMPUTE 3X9 MOVING AVERAGE.                                       X11L1390
  272 IF (K-13) 273,276,275                                             X11L1400
  273 IF (K-11) 274,288,277                                             X11L1410
  274 IF (K-9) 268,231,289                                              X11L1420
  275 CALL MVAVG(STAVG,STSP,4,K,11,W3X9)                                X11L1430
      GO TO 290                                                         X11L1440
  276 CALL MVAVG(STAVG,STSP,4,K,10,W3A9)                                X11L1450
      GO TO 290                                                         X11L1460
  277 CALL MVAVG(STAVG,STSP,4,K,9,W3B9)                                 X11L1470
      GO TO 290                                                         X11L1480
  288 CALL MVAVG(STAVG,STSP,4,K,8,W3C9)                                 X11L1490
      GO TO 290                                                         X11L1500
  289 CALL MVAVG(STAVG,STSP,4,K,7,W3D9)                                 X11L1510
      GO TO 290                                                         X11L1520
  231 CALL MVAVG(STAVG,STSP,4,K,6,W3E9)                                 X11L1530
      GO TO 290                                                         X11L1540
  267 IF (KSECT-1) 279,283,279                                          X11L1550
C --- COMPUTE 3X5 MOVING AVERAGE.                                       X11L1560
  279 IF (K-9) 234,281,280                                              X11L1570
  234 IF (K-7) 268,233,232                                              X11L1580
  280 CALL MVAVG(STAVG,STSP,4,K,7,W3X5)                                 X11L1590
      GO TO 290                                                         X11L1600
  281 CALL MVAVG(STAVG,STSP,4,K,6,W3A5)                                 X11L1610
      GO TO 290                                                         X11L1620
  232 CALL MVAVG(STAVG,STSP,4,K,5,W3B5)                                 X11L1630
      GO TO 290                                                         X11L1640
  233 CALL MVAVG(STAVG,STSP,4,K,4,W3C5)                                 X11L1650
      GO TO 290                                                         X11L1660
C --- COMPUTE 3X3 MOVING AVERAGE.                                       X11L1670
  283 IF (K-7) 235,285,284                                              X11L1680
  235 IF (K-5) 268,268,236                                              X11L1690
  284 CALL MVAVG(STAVG,STSP,4,K,5,W3X3)                                 X11L1700
      GO TO 290                                                         X11L1710
  285 CALL MVAVG(STAVG,STSP,4,K,4,W3A3)                                 X11L1720
      GO TO 290                                                         X11L1730
  236 CALL MVAVG(STAVG,STSP,4,K,3,W3B3)                                 X11L1740
      GO TO 290                                                         X11L1750
C --- COMPUTE 3-TERM MOVING AVERAGE                                     X11L1760
  286 CALL MVAVG(STAVG,STSP,4,K,3,W3X1)                                 X11L1770
  290 L = J                                                             X11L1780
      DO 291 I = 4,K                                                    X11L1790
      STMP(L) = STAVG(I)                                                X11L1800
  291 L = L + 12                                                        X11L1810
C --- COMPUTE CENTERED 12-TERM MOVING AVERAGE.                          X11L1820
      J = MFDA + 6                                                      X11L1830
      K = MLDA - 6                                                      X11L1840
      DO 300 I = J,K                                                    X11L1850
  300 STS(I)=(STMP(I-6)+STMP(I+6)+2.*(STMP(I-5)+STMP(I-4)+STMP(I-3)+    X11L1860
     1STMP(I-2)+STMP(I-1)+STMP(I)+STMP(I+1)+STMP(I+2)+STMP(I+3)+        X11L1870
     2STMP(I+4)+STMP(I+5)))/24.                                         X11L1880
C --- FILL IN MISSING END TERMS BY REPEATING FIRST AND LAST AVAILABLE   X11L1890
C --- MOVING AVERAGE VALUES 6 TIMES.                                    X11L1900
      K = MFDA                                                          X11L1910
      L = MLDA                                                          X11L1920
      DO 303 I = 1,6                                                    X11L1930
      STS(K) = STS(MFDA+6)                                              X11L1940
      STS(L) = STS(MLDA-6)                                              X11L1950
      K = K + 1                                                         X11L1960
  303 L = L - 1                                                         X11L1970
C --- DIVIDE SEASONALS BY 12-TERM MOVING AVERAGE.                       X11L1980
      CALL ADDMUL (STS,STMP,STS,MFDA,MLDA)                              X11L1990
      RETURN                                                            X11L2000
      END                                                               X11L2010
C --- LIP FOR VTC,VTC,VTCS                                              X11M0010
C --- VARIABLE TREND-CYCLE ROUTINE.                                     X11M0020
      SUBROUTINE VTC (LFDA,LLDA,KTCOPT)                                 X11M0030
      COMMON/CA/NW,STI(600)                                             X11M0040
      COMMON/CB/RATIC,NTERM,STC(360),STCI(360)                          X11M0050
      COMMON/CJ/MULADD                                                  X11M0060
      DIMENSION W9H(45),W13H(91),W23H(276),W23H1(207),W23H2(69)         X11M0070
      EQUIVALENCE (W23H(1), W23H1(1)), (W23H(208), W23H2(1))            X11M0071
C --- 9-TERM HENDERSON WEIGHTS.                                         X11M0080
      DATA DUMMY/1H /                                                   X11M0081
      DATA W9H/                                                         X11M0090
     1 .581, .424, .185,-.034,-.156, .0  , .0  , .0  , .0  ,            X11M0100
     2 .298, .354, .282, .126,-.011,-.049, .0  , .0  , .0  ,            X11M0110
     3 .086, .242, .315, .259, .120, .0  ,-.022, .0  , .0  ,            X11M0120
     4-.029, .102, .255, .324, .263, .120,-.004,-.031, .0  ,            X11M0130
     5-.041,-.010, .119, .267, .330, .267, .119,-.010,-.041/            X11M0140
C --- 13-TERM HENDERSON WEIGHTS.                                        X11M0150
      DATA W13H/                                                        X11M0160
     1 .421, .353, .244, .120, .012,-.058,-.092,.0,.0,.0,.0,.0,.0,      X11M0170
     2 .279, .292, .254, .174, .080, .002,-.038,-.043,.0,.0,.0,.0,.0,   X11M0180
     3 .148, .216, .241, .216, .149, .068, .003,-.025,-.016,.0,.0,.0,.0,X11M0190
     4 .046, .131, .201, .230, .208, .145, .066, .004,-.022,-.009,.0,.0,X11M0200
     4 .0  ,                                                            X11M0210
     5-.018, .050, .136, .205, .235, .210, .145, .067, .003,-.022,-.011,X11M0220
     6 .0  , .0  ,                                                      X11M0230
     7-.034,-.006, .061, .144, .212, .238, .213, .147, .066, .001,-.025,X11M0240
     8-.017, .0  ,                                                      X11M0250
     9-.019,-.028, .0  , .066, .147, .214, .240, .214, .147, .066, .0  ,X11M0260
     1-.028,-.019/                                                      X11M0270
C --- 23-TERM HENDERSON WEIGHTS.                                        X11M0280
      DATA W23H1/                                                       X11M0290
     1 .288, .263, .227, .182, .133, .084, .039, .002,-.028,-.049,-.064,X11M0300
     2-.077, .0  , .0  , .0  , .0  , .0  , .0  , .0  , .0  , .0 ,.0,.0, X11M0310
     3 .224, .219, .203, .176, .141, .101, .061, .025,-.004,-.024,-.035,X11M0320
     4-.041,-.046, .0  , .0  , .0  , .0  , .0  , .0  , .0  , .0  ,.0,.0,X11M0330
     5 .166, .176, .177, .166, .146, .116, .082, .049, .018,-.005,-.019,X11M0340
     6-.025,-.025,-.022, .0  , .0  , .0  , .0  , .0  , .0  , .0  ,.0,.0,X11M0350
     7 .112, .134, .150, .154, .147, .129, .103, .073, .042, .015,-.004,X11M0370
     8-.015,-.018,-.014,-.008, .0  , .0  , .0  , .0  , .0  , .0  ,.0,.0,X11M0380
     9 .066, .095, .119, .136, .142, .137, .121, .098, .068, .040, .015,X11M0390
     1-.003,-.012,-.013,-.008,-.001, .0  , .0  , .0  , .0  , .0  ,.0,.0,X11M0400
     2 .027, .059, .088, .114, .131, .139, .134, .119, .095, .067, .039,X11M0410
     3 .015,-.002,-.011,-.011,-.006, .003, .0  , .0  , .0  , .0  ,.0,.0,X11M0420
     4 .001, .027, .059, .089, .114, .132, .138, .134, .118, .096, .068,X11M0440
     5 .039, .015,-.003,-.011,-.012,-.006, .002, .0  , .0  , .0  ,.0,.0,X11M0450
     6-.015, .005, .031, .060, .090, .116, .133, .140, .135, .120, .096,X11M0460
     7 .068, .039, .015,-.003,-.011,-.013,-.007, .001, .0  , .0  ,.0,.0,X11M0470
     8-.021,-.010, .008, .034, .064, .094, .118, .136, .140, .137, .120,X11M0480
     9 .097, .068, .039, .014,-.003,-.013,-.013,-.007,-.002, .0  ,.0,.0/X11M0490
      DATA W23H2/                                                       X11M0500
     1-.019,-.017,-.007, .011, .037, .067, .095, .120, .137, .143, .138,X11M0510
     2 .122, .097, .069, .040, .014,-.005,-.014,-.015,-.010,-.003,.0,.0,X11M0520
     3-.011,-.016,-.015,-.005, .013, .039, .068, .097, .122, .138, .144,X11M0530
     4 .138, .122, .097, .068, .039, .013,-.005,-.015,-.016,-.011,-.004,X11M0540
     5 .0  ,                                                            X11M0550
     6-.004,-.011,-.016,-.015,-.005, .013, .039, .068, .097, .122, .138,X11M0560
     7 .148, .138, .122, .097, .068, .039, .013,-.005,-.015,-.016,-.011,X11M0570
     8-.004/                                                            X11M0580
C --- CALCULATE 13-TERM HENDERSON. DROP END TERMS. CALC  IRREGULAR SER. X11M0590
 4000 MFDA = LFDA + 6                                                   X11M0600
      MLDA = LLDA - 6                                                   X11M0610
      DO 1 I = MFDA,MLDA                                                X11M0620
    1 STC(I) = .240057*STCI(I) + .214337*(STCI(I+1)+STCI(I-1)) +        X11M0630
     1.147357*(STCI(I+2)+ STCI(I-2)) +.065492*(STCI(I+3)+STCI(I-3)) -   X11M0640
     2.027864*(STCI(I+5)+ STCI(I-5)) -.019350*(STCI(I+6)+STCI(I-6))     X11M0650
      CALL ADDMUL (STI,STCI,STC,MFDA,MLDA)                              X11M0660
C --- CALCULATE IBAR/CBAR RATIO                                         X11M0670
      APCC = 0.                                                         X11M0680
      APCI = 0.                                                         X11M0690
      K = MLDA - 1                                                      X11M0700
      DO 4 I = MFDA,K                                                   X11M0710
      IF (MULADD) 2,3,2                                                 X11M0720
    2 APCC = APCC + ABS(STC(I+1)-STC(I))                                X11M0730
      APCI = APCI + ABS(STI(I+1)-STI(I))                                X11M0740
      GO TO 4                                                           X11M0750
    3 APCC = APCC + ABS(STC(I+1)-STC(I))/STC(I)                         X11M0760
      APCI = APCI + ABS(STI(I+1)-STI(I))/STI(I)                         X11M0770
    4 CONTINUE                                                          X11M0780
      RATIC = APCI/APCC                                                 X11M0790
C --- CHECK IF TREND-CYCLE MOVING AVERAGE PRESELECTED.                  X11M0800
      IF (KTCOPT-3) 7,23,6                                              X11M0810
    7 IF (KTCOPT-1) 6,9,13                                              X11M0820
    6 IF (RATIC-.995) 9,22,22                                           X11M0830
   22 IF (NTERM-999) 5,13,5                                             X11M0840
    5 IF (RATIC-3.495) 13,23,23                                         X11M0850
    9 NTERM = 9                                                         X11M0860
      CALL MVAVG (STC,STCI,LFDA,LLDA,9,W9H)                             X11M0870
      RETURN                                                            X11M0880
   13 NTERM = 13                                                        X11M0890
      CALL MVAVG (STC,STCI,LFDA,LLDA,13,W13H)                           X11M0900
      RETURN                                                            X11M0910
   23 NTERM = 23                                                        X11M0920
      CALL MVAVG (STC,STCI,LFDA,LLDA,23,W23H)                           X11M0930
      RETURN                                                            X11M0940
      END                                                               X11M0950
C --- LIP FOR XTRM,XTRM,XTRMS                                           X11N0010
C --- THIS ROUTINE COMPUTES WEIGHTS FOR IRREGULAR COMPONENT AND IDENTIF X11N0020
C --- IES EXTREME IRREGULAR VALUES.                                     X11N0030
      SUBROUTINE XTRM (ARRAY,STDEV,STWT,KFDA,KLDA,TMPU,TMPL,KEXT)       X11N0040
      COMMON/CJ/MULADD                                                  X11N0050
      DIMENSION ARRAY(600),STDEV(600),STWT(600)                         X11N0060
      SK = 100                                                          X11N0070
      IF (MULADD) 298,299,298                                           X11N0080
  298 SK = 0                                                            X11N0090
C --- SET ALL WEIGHTS EQUAL TO 100. TO START.                           X11N0100
  299 DO 300 I = KFDA,KLDA                                              X11N0110
  300 STWT(I) = 100.0                                                   X11N0120
C --- IN FIRST ROUND, IDENTIFY EXTREMES OUTSIDE UPPER LIMIT FOR         X11N0130
C --- EXCLUSION FROM SECOND ROUND.                                      X11N0140
      SIGMU = TMPU                                                      X11N0150
      SIGML = TMPU                                                      X11N0160
C --- DETERMINE IF AT LEAST 5 YEARS AVAILABLE FOR MOVING STANDARD DEVTN X11N0170
      NFDA = (KFDA+10)/12 * 12 + 1                                      X11N0180
      NLDA = KLDA/12 * 12 - 59                                          X11N0190
      ITMP = 59                                                         X11N0200
      IF (NLDA-NFDA) 318,301,301                                        X11N0210
C --- LESS THAN 5 YEARS AVAILABLE.                                      X11N0220
  318 ITMP = ITMP + NLDA - NFDA                                         X11N0230
      NLDA = NFDA                                                       X11N0240
  301 KSWS = 1                                                          X11N0250
C --- COMPUTE MOVING 5-YEAR STD. DEV. EXCLUDING ZERO WT. IRREGULARS.    X11N0260
  314 DO 312 I = NFDA,NLDA,12                                           X11N0270
      SDEV = 0                                                          X11N0280
      K = I + ITMP                                                      X11N0290
      XN = 0.                                                           X11N0300
      DO 303 M = I,K                                                    X11N0310
      IF (STWT(M)) 302,303,302                                          X11N0320
  302 SDEV = SDEV + (ARRAY(M)-SK)**2                                    X11N0330
      XN = XN + 1.                                                      X11N0340
  303 CONTINUE                                                          X11N0350
      SDEV = SQRT(SDEV/XN)                                              X11N0360
      IF (NLDA-NFDA) 320,320,319                                        X11N0370
  320 J = KFDA                                                          X11N0380
      K = KLDA                                                          X11N0390
      GO TO 308                                                         X11N0400
C --- APPLY TO CENTRAL YEAR. AT ENDS OF SERIES APPLY TO ALL VALUES UP T X11N0410
C --- TO CENTRAL YEAR.                                                  X11N0420
  319 IF (I-NFDA) 304,305,304                                           X11N0430
  304 IF (I-NLDA) 307,306,307                                           X11N0440
  305 J = KFDA                                                          X11N0450
      K = NFDA + 35                                                     X11N0460
      GO TO 308                                                         X11N0470
  306 J = NLDA + 24                                                     X11N0480
      K = KLDA                                                          X11N0490
      GO TO 308                                                         X11N0500
  307 J = I + 24                                                        X11N0510
      K = I + 35                                                        X11N0520
C --- COMPUTE DEVIATION OF EACH IRREGULAR VALUE.                        X11N0530
  308 DO 312 M = J,K                                                    X11N0540
      STDEV(M) = SDEV                                                   X11N0550
      TEMP = (ABS(ARRAY(M)-SK))/SDEV                                    X11N0560
      IF (TEMP-SIGMU) 309,310,310                                       X11N0570
  309 IF (TEMP-SIGML) 312,312,311                                       X11N0580
C --- ASSIGN ZERO WT. IF OUTSIDE UPPER LIMIT.                           X11N0590
  310 STWT(M) = 0                                                       X11N0600
      KEXT = KEXT + 1                                                   X11N0610
      GO TO 312                                                         X11N0620
C --- GRADUATE IF BETWEEN LIMITS.                                       X11N0630
  311 STWT(M) = (SIGMU-TEMP)*100./(SIGMU-SIGML)                         X11N0640
  312 CONTINUE                                                          X11N0650
      GO TO (313, 315), KSWS                                            X11N0660
C --- START SECOND ROUND.                                               X11N0670
  313 KSWS = 2                                                          X11N0680
      KEXT = 0                                                          X11N0690
      SIGML = TMPL                                                      X11N0700
      GO TO 314                                                         X11N0710
C --- STORE STD.DEVS. FOR PRINTING ON TABLE OF WEIGHTS.                 X11N0720
  315 J = 1                                                             X11N0730
      DO 316 I = KFDA, KLDA, 12                                         X11N0740
      STDEV(J) = STDEV(I)                                               X11N0750
      STDEV(J+1) = STDEV(I)                                             X11N0760
  316 J = J + 1                                                         X11N0770
  317 RETURN                                                            X11N0780
      END                                                               X11N0790
/* *                                                                            
//GO.SYSIN  DD  *                                                               
HP204  01531264   22                             3                              
T FEB 1968   U. S. TOTAL RETAIL SALES IN MILLIONS OF DOLLARS                    
P204  53 12903 12198 13711 14115 14520 14442 14250 14045 13952 14819 13828 16314
P204  54 12213 11948 13576 14025 14116 14533 14259 13771 14012 14538 14401 17738
P204  55 13147 12642 14609 15450 15333 15600 15261 15481 15765 15685 15751 19124
P204  56 13727 13551 15527 15074 16109 16579 15382 16187 15582 16130 16493 19380
P204  57 14741 14058 15945 16285 17205 17114 16864 17490 16373 16949 17133 19844
P204  58 15286 13783 15464 16362 17364 16603 16596 17000 16326 17360 17039 21174
P204  59 16225 14961 16967 17821 18600 18708 18332 18054 17570 19095 17635 21454
P204  60 16312 15829 17632 18973 18548 18918 18066 18153 17848 18648 18385 22153
P204  61 15803 15071 17714 17618 18532 18907 17922 18325 18158 18761 19224 22881
P204  62 17007 16042 19193 19097 20226 20254 19138 19920 18863 20576 20911 24127
P204  63 18261 17087 19653 20518 21228 20737 20540 21018 19267 21528 21494 25104
P204  64 19154 18758 20502 21186 22508 22242 22145 21778 21313 22605 21720 27719
Z                                                                               
/* *                                                                            
/+ +                                                                            
//CENSUSQ  JOB                                                                  
// EXEC FORTGCLG,PARM.FORT>:BCD:                                                
//FORT.SYSIN DD *                                                               
C     PROGRAM DECK USES BCD                                             X1QA0010
C     IBM 360 VERSION OF                                                X1QA0020
C     X-11Q SEASONAL ADJUSTMENT PROGRAM                                 X1QA0030
C     ECONOMIC RESEARCH AND ANALYSIS DIVISION                           X1QA0040
C     WRITTEN BY NORMAN BAKKA                                           X1QA0050
C     MARCH 11, 1966                                                    X1QA0060
C --- OCTOBER 10, 1966                                                  X1QA0070
C --- INPUT ROUTINE                                                     X1QA0080
C  (1)READS AND EDITS HEADER CARD                                       X1QA0090
C  (2)READS AND EDITS INPUT SERIES                                      X1QA0100
C  (3)CALLS QSAP, WHICH IS THE MAIN SEASONAL ADJUSTMENT PROGRAM         X1QA0110
      INTEGER ADD                                                       X1QA0120
      REAL MADJ(4)                                                      X1QA0130
      DIMENSION XORG(125), AADJ(4), ADJ(4), SUMM(5), SEAS(5),           X1QA0140
     1          PRNT(3), RUN(5), PB7(2), QUAR(4)                        X1QA0150
      COMMON /TADJ/ ADD                                                 X1QA0160
      COMMON /RITE/ NR,NYEAR,TITLE(15),SERNO,KPAGE                      X1QA0170
      COMMON /INPT/ XORG,IB,IE,MEAS,KB7,MLG,JDEC,KP,NP                  X1QA0180
      COMMON /SIGM/ SIGML, SIGMU, SD5(125)                              X1QA0190
      DATA NEWPG/1H1/                                                           
      DATA HS,ZS /1HH, 1HZ/                                             X1QA0210
      DATA  MADJ           /4HMULT,4HIPLI,4HCATI,2HVE /                 X1QA0220
      DATA  AADJ           /4H    ,4H  AD,4HDITI,2HVE/                  X1QA0230
      DATA  SUMM           /4HSUMM,4HARY ,4HMEAS,4HURES,1H /            X1QA0240
      DATA  SEAS           /4HSEAS,4HONAL,4H ADJ,4HUSTM,4HENT /         X1QA0250
      DATA  PRNT          /4HSTND,4HLONG,4HFULL/                        X1QA0260
      DATA  PB7           /3HOUT, 1H /                                  X1QA0270
      DATA  QUAR           /3H1ST, 3H2ND, 3H3RD, 3H4TH/                 X1QA0280
C --- ASSIGNMENT OF INPUT/OUTPUT VARIABLES(UNITS)                       X1QA0290
      IR = 5                                                                    
      JO = 6                                                            X1QA0310
      NR=6                                                                      
      LR=6                                                                      
      RECORD = 0.0                                                      X1QA0340
  200 KERR = 1                                                          X1QA0350
C --- READ HEADER CARD                                                  X1QA0360
  201 READ (IR,1,END=999) CARD,SERNO,MQ,MYR,NQ,NYR,ADD,MEAS,NP,SIGML,   X1QA0370
     1SIGMU,KB7,(TITLE(I),I=1,15)                                       X1QA0380
    1 FORMAT(A1,A4,2X,2(I1,I2),3I1,2F2.1,I1,14A4,A3)                    X1QA0390
C     FIRST COLUMN MUST HAVE  H  PUNCH,  A  Z  PUNCH INDICATES LAST     X1QA0400
C           CARD AND THUS END OF JOB                                    X1QA0410
      IF (CARD-HS) 10,11,10                                             X1QA0420
   10 IF (CARD-ZS) 101,999,101                                          X1QA0430
C --- END OF JOB                                                        X1QA0440
  999 WRITE (JO,998)                                                    X1QA0450
      WRITE (NR,998)                                                    X1QA0460
  998 FORMAT(11H1END OF JOB)                                            X1QA0470
      STOP                                                              X1QA0480
C --- EDIT OF OPTION CARD                                               X1QA0510
   11 KERR = 1                                                          X1QA0520
      IF (MQ) 102,102,12                                                X1QA0530
   12 IF (MQ-5) 13,102,102                                              X1QA0540
   13 IF (NQ) 103,103,14                                                X1QA0550
   14 IF (NQ-5) 15,103,103                                              X1QA0560
   15 IF (NYR-MYR) 104,104,16                                           X1QA0570
   16 IB = MQ                                                           X1QA0580
      IE = (NYR-MYR)*4 + NQ                                             X1QA0590
      IF (IE-IB-11) 105,17,17                                           X1QA0600
   17 IF (ADD-2) 18,106,106                                             X1QA0610
   18 IF (MEAS-2)19,107,107                                             X1QA0620
   19 IF (NP-3)20,108,108                                               X1QA0630
   20 IF (SIGMU-SIGML) 109,21,21                                        X1QA0640
   21 IF (KB7-2) 30,110,110                                             X1QA0650
C --- STANDARD MULTIPLICATIVE SEASONAL ADJUSTMENT RUN                   X1QA0660
   30 IF (SIGMU) 109,31,32                                              X1QA0670
   31 SIGML = 1.5                                                       X1QA0680
      SIGMU = 2.5                                                       X1QA0690
   32 DO 33 I=1,5                                                       X1QA0700
   33 RUN(I) = SEAS(I)                                                  X1QA0710
      DO 34 I=1,4                                                       X1QA0720
   34 ADJ(I) = MADJ(I)                                                  X1QA0730
      KPAGE = 0                                                         X1QA0740
      MLG =  2                                                          X1QA0750
      JDEC = 2                                                          X1QA0760
      KP = NP + 1                                                       X1QA0770
      MEAS = MEAS + 1                                                   X1QA0780
      KB7 = KB7 + 1                                                     X1QA0790
C --- SUMMARY MEASURES RUN                                              X1QA0800
      IF (MEAS-1) 45,45,40                                              X1QA0810
   40 DO 41 I=1,4                                                       X1QA0820
   41 RUN(I)  = SUMM(I)                                                 X1QA0830
C --- ADDITIVE RUN                                                      X1QA0840
   45 IF (ADD) 50,50,46                                                 X1QA0850
   46 DO 47 I=1,4                                                       X1QA0860
   47 ADJ(I) = AADJ(I)                                                  X1QA0870
      JDEC = 1                                                          X1QA0880
      MLG = 1                                                           X1QA0890
C --- SET M AND N TO READ FIRST DATA CARD                               X1QA0900
   50 NYEAR = MYR                                                       X1QA0910
      M = 1                                                             X1QA0920
      N = 4                                                             X1QA0930
C --- READ INPUT SERIES                                                 X1QA0940
C     INPUT IS EDITED FOR DATE SEQUENCE AND CONSISTENT SERIES NUMBERING X1QA0950
   52 READ (IR,2) (XORG(I), I=M,N), KYR, SERIE                          X1QA0960
    2 FORMAT(4(12X,F6.0),I2,A4)                                         X1QA0970
C --- EDIT FOR CORRECT SERIES IDENTIFICATION (COLS 77-80)               X1QA0980
      IF (SERNO-SERIE) 120,55,120                                       X1QA0990
C --- FIELDS PRECEEDING QUARTER SPECIFIED AS FIRST MUST BE BLANK        X1QA1000
   55 IF (N-1) 56,56,59                                                 X1QA1010
   56 IF (IB-2) 59,57,57                                                X1QA1020
   57 K = IB-1                                                          X1QA1030
      DO 58 I=1,K                                                       X1QA1040
      IF (XORG(I)) 121,58,121                                           X1QA1050
   58 CONTINUE                                                          X1QA1060
C --- EDIT FOR DATE SEQUENCE (COLS 73-74)                               X1QA1070
   59 IF (KYR-MYR) 122,60,122                                           X1QA1080
C --- TEST FOR LAST CARD OF SERIES                                      X1QA1090
   60 IF (MYR-NYR) 61,65,61                                             X1QA1100
C --- SET M,N, AND MYR TO READ NEXT CARD                                X1QA1110
   61 MYR = MYR + 1                                                     X1QA1120
      M = M + 4                                                         X1QA1130
      N = N + 4                                                         X1QA1140
      GO TO 52                                                          X1QA1150
C --- FIELDS AFTER QUARTER SPECIFIED AS LAST MUST BE BLANK              X1QA1160
   65 IF (NQ-4) 66,70,70                                                X1QA1170
   66 J = IE + 1                                                        X1QA1180
      K = (NYR-NYEAR+1) *4                                              X1QA1190
      DO 67 I=J,K                                                       X1QA1200
      IF (XORG(I)) 123,67,123                                           X1QA1210
   67 CONTINUE                                                          X1QA1220
C --- IF MULTIPLICATIVE ADJUSTMENT - EDIT SERIES FOR ZERO               X1QA1230
C        OR NEGATIVE DATA                                               X1QA1240
   70 IF (ADD) 71,71,73                                                 X1QA1250
   71 DO 72 I=IB,IE                                                     X1QA1260
      IF (XORG(I)) 124,124,72                                           X1QA1270
   72 CONTINUE                                                          X1QA1280
C --- WRITE TITLE PAGE                                                  X1QA1290
   73 WRITE (NR,3) NEWPG, (TITLE(I),I=1,15), SERNO, QUAR(MQ), NYEAR,    X1QA1300
     1             QUAR(NQ), NYR, (ADJ(I),I=1,4), (RUN(I),I=1,5),       X1QA1310
     2             PRNT(KP), SIGML, SIGMU, PB7(KB7)                     X1QA1320
    3 FORMAT (A1, 42X, 37HQUARTERLY SEASONAL ADJUSTMENT PROGRAM /       X1QA1330
     1            49X, 25HU.S. BUREAU OF THE CENSUS /                   X1QA1340
     2            42X, 39HECONOMIC RESEARCH AND ANALYSIS DIVISION /     X1QA1350
     3           53X, 17HOCTOBER 10, 1966 ///                           X1QA1360
     410X,15HSERIES TITLE - 14A4,A3,9X,11HSERIES NO. A4 /               X1QA1370
     536X,17HPERIOD COVERED - A3,9H QUAR. 19 I2,4H TO A3,9H QUAR. 19 I2/X1QA1380
     6 36X,14HTYPE OF RUN - ,3A4,A2,1X,5A4 /                            X1QA1390
     7 52X, A4, 9H PRINTOUT / 31X, 47HSIGMA LIMITS FOR GRADUATING EXTREMX1QA1400
     8E VALUES ARE ,F3.1,5H AND , F3.1 /                                X1QA1410
     9 31X, 35HB7. TREND-CYCLE CURVE COMPUTED WITH, A3, 26H MODIFICATIONX1QA1420
     1 FOR EXTREMES)                                                    X1QA1430
C --- IF SERIES IS REJECTED, WRITE FACT ON TITLE PAGE                   X1QA1440
      GO TO (76,75),KERR                                                X1QA1450
   75 WRITE (NR,4)                                                      X1QA1460
    4 FORMAT (////// 40X,25HSERIES REJECTED - SEE LOG)                  X1QA1470
      GO TO 200                                                         X1QA1480
C --- WRITE LOG ENTRY - ONLY IF SERIES WAS NOT REJECTED                 X1QA1490
C                                                                       X1QA1520
C --- CALL SEASONAL ADJUSTMENT ROUTINE                                  X1QA1530
C                                                                       X1QA1540
   76 CALL QSAP                                                         X1QA1550
C ---                                                                   X1QA1560
      IF (NP-1) 81,82,83                                                X1QA1570
   81 RECORD = RECORD + 1.0                                             X1QA1580
      GO TO 84                                                          X1QA1590
   82 RECORD = RECORD + 1.5                                             X1QA1600
      GO TO 84                                                          X1QA1610
   83 RECORD = RECORD + 2.5                                             X1QA1620
   84 IF (RECORD - 35.0) 200,90,90                                      X1QA1630
C --- ALTERNATE OUTPUT SERVOS                                           X1QA1640
   90 CONTINUE                                                          X1QA1650
      NTMP = NR                                                         X1QA1690
      NR = LR                                                           X1QA1700
      LR = NTMP                                                         X1QA1710
      RECORD = 0.0                                                      X1QA1720
      GO TO 200                                                         X1QA1730
C --- REJECT MESSAGE                                                    X1QA1740
  101 GO TO (330,201),KERR                                              X1QA1750
  330 KERR = 2                                                          X1QA1760
      WRITE (JO,301) SERNO                                              X1QA1770
  301 FORMAT ( 1X,A4,25H REJECTED, NO HEADER CARD)                      X1QA1780
      GO TO 201                                                         X1QA1790
  102 KVAR = MQ                                                         X1QA1800
      KCOL = 8                                                          X1QA1810
      KFAIL = 1                                                         X1QA1820
      GO TO 202                                                         X1QA1830
  103 KVAR = NQ                                                         X1QA1840
      KCOL = 11                                                         X1QA1850
      KFAIL = 2                                                         X1QA1860
      GO TO 202                                                         X1QA1870
  106 KVAR = ADD                                                        X1QA1880
      KCOL = 14                                                         X1QA1890
      KFAIL =3                                                          X1QA1900
      GO TO 202                                                         X1QA1910
  107 KVAR = MEAS                                                       X1QA1920
      KCOL = 15                                                         X1QA1930
      KFAIL = 4                                                         X1QA1940
      GO TO 202                                                         X1QA1950
  108 KVAR = NP                                                         X1QA1960
      KCOL = 16                                                         X1QA1970
      KFAIL = 5                                                         X1QA1980
      GO TO 202                                                         X1QA1990
  110 KVAR = KB7                                                        X1QA2000
      KCOL = 21                                                         X1QA2010
      KFAIL = 6                                                         X1QA2020
  202 KERR = 2                                                          X1QA2030
      WRITE (JO,302) SERNO, KVAR,KCOL                                   X1QA2040
  302 FORMAT ( 1X,A4, 11H REJECTED, ,I1,35H-PUNCH IS INAPPROPRIATE FOR CX1QA2050
     1OLUMN ,I2)                                                        X1QA2060
      GO TO (13,15,18,19,20,30),KFAIL                                   X1QA2070
  104 KERR = 2                                                          X1QA2080
      WRITE (JO,304) SERNO,MYR,NYR                                      X1QA2090
  304 FORMAT ( 1X,A4,10H REJECTED,,18H BEGINNING YEAR IS,I3,18H, ENDING X1QA2100
     1YEAR IS, ,I3)                                                     X1QA2110
      GO TO 17                                                          X1QA2120
  105 KERR = 2                                                          X1QA2130
      WRITE (JO,305) SERNO                                              X1QA2140
  305 FORMAT (1X,A4,61H REJECTED, SERIES DOES NOT HAVE AT LEAST 3 FULL YX1QA2150
     1EARS OF DATA)                                                     X1QA2160
      GO TO 17                                                          X1QA2170
  109 KERR = 2                                                          X1QA2180
      WRITE (JO,309) SERNO,SIGML,SIGMU                                  X1QA2190
  309 FORMAT (1X,A4,24H REJECTED, EITHER LOWER[,F3.1,11H] OR UPPER[,F3.1X1QA2200
     1, 31H] SIGMA LIMIT IS NOT ACCEPTABLE)                             X1QA2210
      GO TO 32                                                          X1QA2220
  120 KERR = 2                                                          X1QA2230
      WRITE (JO,320) SERNO,SERIE                                        X1QA2240
  320 FORMAT ( 1X,A4,11H REJECTED, ,A4,23H IS WRONG SERIES NUMBER)      X1QA2250
      GO TO 55                                                          X1QA2260
  121 KERR = 2                                                          X1QA2270
      WRITE (JO,321) SERNO                                              X1QA2280
  321 FORMAT ( 1X,A4,34H REJECTED, BEGINS IN WRONG QUARTER)             X1QA2290
      GO TO 59                                                          X1QA2300
  122 KERR = 2                                                          X1QA2310
      WRITE (JO,322) SERNO,MYR,KYR                                      X1QA2320
  322 FORMAT ( 1X,A4,25H REJECTED, YEAR SHOULD BE,I3, 8H ,BUT IS,I3)    X1QA2330
      GO TO 60                                                          X1QA2340
  123 KERR = 2                                                          X1QA2350
      WRITE (JO,323) SERNO                                              X1QA2360
  323 FORMAT ( 1X,A4,32H REJECTED, ENDS IN WRONG QUARTER)               X1QA2370
      GO TO 70                                                          X1QA2380
  124 KERR = 2                                                          X1QA2390
      WRITE (JO,324) SERNO                                              X1QA2400
  324 FORMAT ( 1X,A4,32H REJECTED, ZERO OR NEGATIVE DATA)               X1QA2410
      GO TO 73                                                          X1QA2420
      END                                                               X1QA2430
      SUBROUTINE CHART (NS,LS,MO,IBEG,IEND,A,B,C,LTAB)                  X1QM0020
      DIMENSION A(125), B(125), C(125), Y(12), DATE(4), T(5), SINAME(6) X1QM0030
      INTEGER ADD                                                       X1QM0040
      COMMON /TADJ/ ADD                                                 X1QM0050
      COMMON /RITE/ NR, NYEAR, TITLE(15), SERNO, KPAGE                  X1QM0060
      COMMON /LINE/ VAL(3), NX(112), LOG, NOSER, BIG, SMALL, KSCLE      X1QM0070
      DATA NEWPG /1H1/                                                          
      DATA  DATE           /3H1ST, 3H2ND, 3H3RD, 3H4TH/                 X1QM0090
      DATA  T           / 4HQUAR,4HHALF,4H ONE,4H TWO,4HFOUR /          X1QM0100
      DATA  SINAME           /4HRATI,4HDIFF,4HOS  ,4HEREN,4H    ,4HCES /XIQM0120
      KEXT = 1                                                          X1QM0130
      NOSER =  NS                                                       X1QM0140
      LOG = LS                                                          X1QM0150
C --- WRITE CHART TITLE AND LEGEND                                      X1QM0160
      GO TO (40,45),MO                                                  X1QM0170
   40 KPAGE = KPAGE + 1                                                 X1QM0180
      WRITE (NR,1) NEWPG,(TITLE(I),I=1,15),KPAGE,SERNO,LTAB             X1QM0190
    1 FORMAT(A1,29X,14A4,A3,8X,4HPAGE I3,9H, SERIES A4/2H GI2,7H. CHART)X1QM0200
      GO TO (41,42,42,43),LTAB                                          X1QM0210
   41 WRITE (NR,2)                                                      X1QM0220
    2 FORMAT (10X,42H[X]- D11. FINAL SEASONALLY ADJUSTED SERIES /       X1QM0230
     1        10X,27H[0]- D12. FINAL TREND-CYCLE )                      X1QM0240
      GO TO 44                                                          X1QM0250
   42 WRITE (NR,3) SINAME(ADD+1),SINAME(ADD+3),SINAME(ADD+5),SINAME(ADD+X1QM0260
     11),SINAME(ADD+3),SINAME(ADD+5)                                    X1QM0270
    3 FORMAT (10X,18H[X]- D8. FINAL SI ,3A4,13HWITH EXTREMES /          X1QM0280
     1        10X,18H[0]- D9. FINAL SI ,3A4,16HWITHOUT EXTREMES /       X1QM0290
     2        10X,31H[<]- D10.FINAL SEASONAL FACTORS ]                  X1QM0300
      GO TO 44                                                          X1QM0310
   43 WRITE (NR,4)                                                      X1QM0320
    4 FORMAT (10X,31H[X]- D13.FINAL IRREGULAR SERIES /                  X1QM0330
     1        10X,40H[0]- E3. FINAL MODIFIED IRREGULAR SERIES )         X1QM0340
   44 WRITE (NR,5)                                                      X1QM0350
    5 FORMAT (10X,26H[*]- COINCIDENCE OF POINTS)                        X1QM0360
   45 LYR = NYEAR - 1                                                   X1QM0370
C --- FIND LARGEST AND SMALLEST VALUES                                  X1QM0380
      BIG = A(IBEG)                                                     X1QM0390
      SMALL = A(IBEG)                                                   X1QM0400
      DO 59 I=IBEG,IEND                                                 X1QM0410
      DO 59 M=1,3                                                       X1QM0420
      GO TO (51,52,53),M                                                X1QM0430
   51 TEMP = A(I)                                                       X1QM0440
      GO TO 55                                                          X1QM0450
   52 TEMP = B(I)                                                       X1QM0460
      GO TO 55                                                          X1QM0470
   53 TEMP = C(I)                                                       X1QM0480
   55 IF (TEMP-BIG) 57,57,56                                            X1QM0490
   56 BIG = TEMP                                                        X1QM0500
   57 IF (TEMP-SMALL) 58,59,59                                          X1QM0510
   58 SMALL = TEMP                                                      X1QM0520
   59 CONTINUE                                                          X1QM0530
      SMALL = AINT(SMALL)                                               X1QM0540
      GO TO (70,60),LOG                                                 X1QM0550
C --- DETERMINE LOG SCALE                                               X1QM0560
   60 KVAL = BIG / SMALL                                                X1QM0570
      IF (KVAL-2) 81,61,61                                              X1QM0580
   61 IF (KVAL-4) 82,62,62                                              X1QM0590
   62 IF (KVAL-10) 83,63,63                                             X1QM0600
   63 IF (KVAL-100)84,84,85                                             X1QM0610
C --- ARITHMETIC SCALE                                                  X1QM0620
   70 KDIV = (BIG-SMALL) /11.0 + 1.0                                    X1QM0630
      DIV = KDIV                                                        X1QM0640
      Y(1) = SMALL                                                      X1QM0650
      BIG = SMALL                                                       X1QM0660
      DO 71 I=2,12                                                      X1QM0670
      BIG = BIG + DIV                                                   X1QM0680
   71 Y(I) = BIG                                                        X1QM0690
      GO TO (72,109),MO                                                 X1QM0700
   72 WRITE (NR,16)                                                     X1QM0710
      WRITE (NR,6) (Y(I),I=1,12)                                        X1QM0720
    6 FORMAT (12F10.0)                                                  X1QM0730
      WRITE (NR,7)                                                      X1QM0740
    7 FORMAT (8X,12(1H.,9X))                                            X1QM0750
      GO TO 102                                                         X1QM0770
   81 KSCLE = 1                                                         X1QM0780
      GO TO 86                                                          X1QM0790
   82 KSCLE = 2                                                         X1QM0800
      GO TO 86                                                          X1QM0810
   83 KSCLE = 3                                                         X1QM0820
      GO TO 86                                                          X1QM0830
   84 KSCLE = 4                                                         X1QM0840
      GO TO 86                                                          X1QM0850
   85 KSCLE = 5                                                         X1QM0860
   86 WRITE (NR,8) T(KSCLE)                                             X1QM0870
    8 FORMAT (4X,14HSCALE-SEMI LOG,2X,A4,6H CYCLE)                      X1QM0880
   87 WT = 1.0                                                          X1QM0890
      GO TO (90,92,94,96,98),KSCLE                                      X1QM0900
   90 DO 91 I=1,6                                                       X1QM0910
      Y(I) = SMALL * WT                                                 X1QM0920
   91 WT = WT + 0.2                                                     X1QM0930
      WRITE (NR,10) (Y(I),I=1,6)                                        X1QM0940
   10 FORMAT (4X,F7.0,22X,F7.0,18X,F7.0,14X,F7.0,12X,F7.0,8X,F7.0)      X1QM0950
      GO TO 100                                                         X1QM0960
   92 DO 93 I=1,7                                                       X1QM0970
      Y(I) = SMALL * WT                                                 X1QM0980
   93 WT = WT + 0.5                                                     X1QM0990
      WRITE (NR,11) (Y(I),I=1,7)                                        X1QM1000
   11 FORMAT (4X,F7.0,25X,F7.0,16X,F7.0,11X,F7.0,8X,F7.0,5X,F7.0,2X,F7.0X1QM1010
     1 )                                                                X1QM1011
      GO TO 100                                                         X1QM1020
   94 Y(1) = SMALL                                                      X1QM1030
      WT = 2.0                                                          X1QM1040
      DO 95 I=2,6                                                       X1QM1050
      Y(I) = SMALL * WT                                                 X1QM1060
   95 WT = WT + 2.0                                                     X1QM1070
      WRITE (NR,12) (Y(I),I=1,6)                                        X1QM1080
   12 FORMAT (4X,F7.0,26X,F7.0,27X,F7.0,12X,F7.0,7X,F7.0,2X,F7.0)       X1QM1090
      GO TO 100                                                         X1QM1100
   96 Y(1) = SMALL                                                      X1QM1110
      Y(2) = SMALL * 4.0                                                X1QM1120
      Y(3) = SMALL * 7.0                                                X1QM1130
      Y(4) = SMALL *10.0                                                X1QM1140
      Y(5) = SMALL *40.0                                                X1QM1150
      Y(6) = SMALL *70.0                                                X1QM1160
      Y(7) = SMALL *100.0                                               X1QM1170
      WRITE (NR,13) (Y(I),I=1,7)                                        X1QM1180
   13 FORMAT (4X,F7.0,25X,F7.0,7X,F7.0,2X,F7.0,26X,F7.0,6X,F7.0,1X,F7.0)X1QM1190
      GO TO 100                                                         X1QM1200
   98 DO 99 I=1,5                                                       X1QM1210
      Y(I) = SMALL * WT                                                 X1QM1220
   99 WT = 10.0 * WT                                                    X1QM1230
      WRITE (NR,14) (Y(I),I=1,5)                                        X1QM1240
   14 FORMAT (4X,F7.0,20X,F7.0,22X,F7.0,20X,F7.0,19X,F7.0)              X1QM1250
  100 GO TO (101,999),KEXT                                              X1QM1260
  101 KEXT = 2                                                          X1QM1270
C --- CHART IN CHRONOLOGICAL ORDER                                      X1QM1280
  102 DO 104 I=IBEG,IEND                                                X1QM1290
      VAL(1) = A(I)                                                     X1QM1300
      VAL(2) = B(I)                                                     X1QM1310
      VAL(3) = C(I)                                                     X1QM1320
      CALL PLOT                                                         X1QM1330
      M = I - (I-1)/4*4                                                 X1QM1340
      IF (M-1) 104,103,104                                              X1QM1350
  103 LYR = LYR + 1                                                     X1QM1360
  104 WRITE (NR,15) DATE(M),LYR,(NX(N),N=1,112)                         X1QM1370
   15 FORMAT (1X,A3,I2,2X,112A1)                                        X1QM1380
      GO TO (105,87),LOG                                                X1QM1390
  105 WRITE (NR,7)                                                      X1QM1400
      WRITE (NR,6) (Y(I),I=1,12)                                        X1QM1410
  999 RETURN                                                            X1QM1420
C --- QUARTERLY CHARTS                                                  X1QM1430
  109 DO 116 N=1,4                                                      X1QM1440
      KPAGE = KPAGE + 1                                                 X1QM1450
      WRITE (NR,1) NEWPG,(TITLE(I),I=1,15),KPAGE,SERNO,LTAB             X1QM1460
      WRITE (NR,3) SINAME(ADD+1),SINAME(ADD+3),SINAME(ADD+5),SINAME(ADD+XIQM1470
     11),SINAME(ADD+3),SINAME(ADD+5)                                    X1QM1480
      WRITE (NR,5)                                                      X1QM1490
      WRITE (NR,16)                                                     X1QM1500
   16 FORMAT (4X,16HSCALE-ARITHMETIC )                                  X1QM1510
      WRITE (NR,6) (Y(I),I=1,12)                                        X1QM1520
      WRITE (NR,7)                                                      X1QM1530
      WRITE (NR,17) DATE(N)                                             X1QM1540
   17 FORMAT (1X,A3,8H QUARTER)                                         X1QM1550
      LYR = NYEAR - 1                                                   X1QM1560
      IF (IBEG-N) 113,113,110                                           X1QM1570
  110 IF (IBEG-4) 111,111,112                                           X1QM1580
  111 LYR = LYR + 1                                                     X1QM1590
  112 IST = N + 4                                                       X1QM1600
      GO TO 114                                                         X1QM1610
  113 IST = N                                                           X1QM1620
  114 DO 115 I=IST,IEND,4                                               X1QM1630
      VAL(1) = A(I)                                                     X1QM1640
      VAL(2) = B(I)                                                     X1QM1650
      VAL(3) = C(I)                                                     X1QM1660
      CALL PLOT                                                         X1QM1670
      LYR = LYR + 1                                                     X1QM1680
  115 WRITE (NR,18) LYR,(NX(L),L=1,112)                                 X1QM1690
   18 FORMAT (4H  19,I2,2X,112A1)                                       X1QM1700
      WRITE (NR,7)                                                      X1QM1710
  116 WRITE (NR,6) (Y(I),I=1,12)                                        X1QM1720
      RETURN                                                            X1QM1730
      END                                                               X1QM1740
C --- SUBROUTINE TO WRITE OUTPUT                                        X1QC0020
      SUBROUTINE WRIT (X,KB,KE,KTAB,MTAB,KDEC,NOP)                      X1QC0030
C --- X = ARRAY TO BE PRINTED FROM KB TO KE                             X1QC0040
C --- KTAB = LOCATION OF WRITE STATEMENT FOR CORRECT TITLE FORMAT       X1QC0050
C --- MTAB = TABLE NUMBER                                               X1QC0060
C --- KDEC = NUMBER OF DECIMAL PLACES, 1 = NONE, 2 = ONE PLACE          X1QC0070
C --- NOP   = 1,TOTAL. = 2,AVG. = 3,S.D., = 4,MOVING 5-YEAR S.D.        X1QC0080
      INTEGER ADD                                                       X1QC0090
      DIMENSION X(125), TAVG(4), PART(3), SINAME(6), MOD(9)             X1QC0100
      COMMON /SIGM/ SIGML,SIGMU,SD5(125)                                X1QC0110
      COMMON /RITE/ NR, NYEAR, TITLE(15), SERNO, KPAGE                  X1QC0120
      COMMON /MORE/ SFC,BPF,KPART,MCD                                   X1QC0130
      COMMON /XYBK/ Y(30), Z(30)                                        X1QC0140
      COMMON /TADJ/ ADD                                                 X1QC0150
      DATA NEWPG,SPACE /1H1, 1H0/                                               
      DATA  TAVG           /4HTOTL,4HAVG.,4HS.D.,4HS.D. /               X1QC0170
      DATA  SINAME           /4HRATI,4HDIFF,4HOS  ,4HEREN,4H    ,4HCES /X1QC0180
      DATA MOD(3),MOD(4),MOD(8),MOD(9) /2HUN, 1H , 2HUN, 1H /           X1QC0190
      DATA  PART          ,PARTE,PARTF /1HB, 1HC, 1HD, 1HE, 1HF/        X1QC0200
      XBAR = 1.0                                                        X1QC0210
      IF (ADD) 301,301,300                                              X1QC0220
  300 XBAR = 0.0                                                        X1QC0230
  301 K = KPART                                                         X1QC0240
      TABLE = MTAB                                                      X1QC0250
      IF (KTAB-11) 45,61,45                                             X1QC0260
C --- WRITE SERIES TITLE                                                X1QC0270
   45 KPAGE = KPAGE + 1                                                 X1QC0280
      WRITE (NR,30) NEWPG, (TITLE(I),I=1,15),KPAGE, SERNO               X1QC0290
   30 FORMAT(A1,29X,14A4,A3,8X,4HPAGE I3,9H, SERIES A4)                 X1QC0300
C --- WRITE TABLE TITLE                                                 X1QC0310
      GO TO (50,50,50,70,80),KPART                                      X1QC0320
C --- PARTS B, C, AND D.                                                X1QC0330
   50 GO TO (51,52,53,54,55,56,57,58,59,60),KTAB                        X1QC0340
   51 WRITE (NR,1) PART(K),TABLE                                        X1QC0350
    1 FORMAT (1XA1,F3.0,16H ORIGINAL SERIES)                            X1QC0360
      GO TO 201                                                         X1QC0370
   52 WRITE (NR,2) PART(K),TABLE                                        X1QC0380
    2 FORMAT (1XA1,F3.0,44H TREND-CYCLE, CENTERED 4-TERM MOVING AVERAGE)X1QC0390
      GO TO 201                                                         X1QC0400
   53 WRITE (NR,3) PART(K),TABLE,BPF,MOD(MTAB),SINAME(ADD+1),           X1QC0410
     1       SINAME(ADD+3),SINAME(ADD+5)                                X1QC0420
    3 FORMAT (1XA1,F3.0,1X,A4,1X,A2,12HMODIFIED SI 3A4)                 X1QC0430
      GO TO 201                                                         X1QC0440
   54 WRITE (NR,4) PART(K),TABLE,BPF,SINAME(ADD+1),SINAME(ADD+3)        X1QC0450
     1, SINAME(ADD+5)                                                   XIQC0451
    4 FORMAT(1XA1,F3.0,1X,A4,35H REPLACEMENT VALUES FOR EXTREME SI 3A4) X1QC0460
      GO TO 201                                                         X1QC0470
   55 WRITE (NR,5) PART(K),TABLE,BPF,SFC                                X1QC0480
    5 FORMAT(1XA1,F3.0,1X,A4,18H SEASONAL FACTORS,A4,15H MOVING AVERAGE)X1QC0490
      GO TO 201                                                         X1QC0500
   56 WRITE (NR,6) PART(K),TABLE,BPF                                    X1QC0510
    6 FORMAT (1XA1,F3.0,1X,A4,27H SEASONALLY ADJUSTED SERIES)           X1QC0520
      GO TO 201                                                         X1QC0530
   57 WRITE (NR,7) PART(K),TABLE,BPF                                    X1QC0540
    7 FORMAT (1XA1,F3.0,1X,A4,36H TREND-CYCLE, 5-TERM HENDERSON CURVE)  X1QC0550
      GO TO 201                                                         X1QC0560
   58 WRITE (NR,8) PART(K),TABLE,BPF                                    X1QC0570
    8 FORMAT (1XA1,F3.0,1X,A4,17H IRREGULAR SERIES)                     X1QC0580
      GO TO 201                                                         X1QC0590
   59 WRITE (NR,9) PART(K),TABLE,BPF,SIGML,SIGMU                        X1QC0600
    9 FORMAT (1XA1,F3.0,1X,A4,29H WEIGHTS FOR IRREGULAR SERIES/         X1QC0610
     1       16X,22HGRADUATION RANGE FROM F4.1,4H TO F4.1,7H SIGMAS)    X1QC0620
      GO TO 201                                                         X1QC0630
   60 WRITE (NR,10)PART(K),TABLE,BPF                                    X1QC0640
   10 FORMAT (1XA1,F3.0,29H ORIGINAL SERIES MODIFIED BY A4,8H WEIGHTS)  X1QC0650
      GO TO 201                                                         X1QC0660
   61 WRITE (NR,19)                                                     X1QC0670
   19 FORMAT (38H0D10A. SEASONAL FACTORS ONE YEAR AHEAD)                X1QC0680
      GO TO 201                                                         X1QC0690
C --- PART E                                                            X1QC0700
   70 GO TO (71,72,73,74,75,76),KTAB                                    X1QC0710
   71 WRITE (NR,11) PARTE,TABLE                                         X1QC0720
   11 FORMAT (1X,A1,F3.0,38H ORIGINAL SERIES MODIFIED FOR EXTREMES)     X1QC0730
      GO TO 201                                                         X1QC0740
   72 WRITE (NR,12) PARTE,TABLE                                         X1QC0750
   12 FORMAT (1X,A1,F3.0,36H MODIFIED SEASONALLY ADJUSTED SERIES)       X1QC0760
      GO TO 201                                                         X1QC0770
   73 WRITE (NR,13) PARTE,TABLE                                         X1QC0780
   13 FORMAT (1X,A1,F3.0,26H MODIFIED IRREGULAR SERIES)                 X1QC0790
      GO TO 201                                                         X1QC0800
   74 WRITE (NR,14) PARTE,TABLE,SINAME(ADD+1),SINAME(ADD+3),SINAME(ADD+5X1QC0810
     1)                                                                 X1QC0811
   14 FORMAT (1X,A1,F3.0,1X,3A4,57HOF ANNUAL TOTALS, ORIGINAL AND SEASONX1QC0820
     1ALLY ADJUSTED SERIES / 23X, 10HUNMODIFIED, 26X, 8HMODIFIED )      X1QC0830
      RETURN                                                            X1QC0840
   75 WRITE (NR,15) PARTE,TABLE                                         X1QC0850
   15 FORMAT (1X,A1,F3.0,46H QUARTER-TO-QUARTER CHANGES IN ORIGINAL SERIX1QC0860
     1ES)                                                               X1QC0870
      GO TO 201                                                         X1QC0880
   76 WRITE (NR,16) PARTE,TABLE                                         X1QC0890
   16 FORMAT (1X,A1,F3.0,70H QUARTER-TO-QUARTER CHANGES IN FINAL SEASONAX1QC0900
     1LLY ADJUSTED SERIES [D11.] )                                      X1QC0910
      GO TO 201                                                         X1QC0920
C --- PART F                                                            X1QC0930
   80 GO TO (81,83),KTAB                                                X1QC0940
   81 WRITE (NR,17) PARTF,TABLE,MCD                                     X1QC0950
   17 FORMAT (1X,A1,F3.0,19H QCD MOVING AVERAGE / 11X,6HQCD IS,I2)      X1QC0960
      IF (MCD-1) 82,82,201                                              X1QC0970
   82 WRITE (NR,32)                                                     X1QC0980
   32 FORMAT (6X,15H SEE TABLE D11.)                                    X1QC0990
      RETURN                                                            X1QC1000
   83 WRITE (NR,18) PARTF,TABLE                                         X1QC1010
   18 FORMAT (1X,A1,F3.0,17H SUMMARY MEASURES)                          X1QC1020
      RETURN                                                            X1QC1030
  201 WRITE (NR,31) SPACE, TAVG(NOP)                                    X1QC1040
   31 FORMAT (A1,3X,4HYEAR,10X,8H1ST QUAR,16X,8H2ND QUAR,16X,8H3RD QUAR,X1QC1050
     1        16X,8H4TH QUAR,18X,A4)                                    X1QC1060
      DO 204 I=1,125                                                    X1QC1070
      IF (I-KB) 203,202,202                                             X1QC1080
  202 IF (I-KE) 204,204,203                                             X1QC1090
  203 X(I) = 10.0**10                                                   X1QC1100
  204 CONTINUE                                                          X1QC1110
      J1 = (KB+3) /4 * 4 - 3                                            X1QC1120
      J2 = J1 + 3                                                       X1QC1130
      NO = (KE-1)/4 * 4                                                 X1QC1140
      TOTAL = 0.0                                                       X1QC1150
      NT = 0                                                            X1QC1160
      DO 230 J=J1,KE,4                                                  X1QC1170
      IF (J-J1) 211,211,210                                             X1QC1180
  210 IF (J-NO) 213,212,212                                             X1QC1190
  211 M = KB                                                            X1QC1200
      N = J2                                                            X1QC1210
      GO TO 214                                                         X1QC1220
  212 M = J                                                             X1QC1230
      N = KE                                                            X1QC1240
      GO TO 214                                                         X1QC1250
  213 M = J                                                             X1QC1260
      N = J + 3                                                         X1QC1270
  214 NT = NT + 1                                                       X1QC1280
      SUBTOT = 0.0                                                      X1QC1290
      DO 215 I=M,N                                                      X1QC1300
  215 SUBTOT = SUBTOT + X(I)                                            X1QC1310
      TOTAL = TOTAL + SUBTOT                                            X1QC1320
      COUNT = N - M + 1                                                 X1QC1330
      YRAVG = SUBTOT / COUNT                                            X1QC1340
      GO TO (216,217,218,220),NOP                                       X1QC1350
  216 Y(NT) = SUBTOT                                                    X1QC1360
      GO TO 230                                                         X1QC1370
  217 Y(NT) = YRAVG                                                     X1QC1380
      GO TO 230                                                         X1QC1390
  218 YRSD = 0.0                                                        X1QC1400
      DO 219 I=M,N                                                      X1QC1410
  219 YRSD = YRSD + (X(I)-XBAR) **2                                     X1QC1420
      Y(NT) = SQRT(YRSD/COUNT)                                          X1QC1430
      GO TO 230                                                         X1QC1440
  220 Y(NT) = SD5(N)                                                    X1QC1450
  230 CONTINUE                                                          X1QC1460
      KYEAR = NYEAR + J1 / 4                                            X1QC1470
      N = 1                                                             X1QC1480
C --- WRITE LINE(YEAR) OF DATA                                          X1QC1490
      J = J1                                                            X1QC1500
  103 K = J + 3                                                         X1QC1510
      GO TO (104,107),KDEC                                              X1QC1520
  104 IF (MTAB-17) 106,105,106                                          X1QC1530
C --- LINE FOR TABLE OF WEIGHTS FOR IRREGULAR                           X1QC1540
  105 WRITE (NR,20) SPACE,KYEAR, (X(I),I=J,K), Y(N)                     X1QC1550
   20 FORMAT (A1,3X,2H19,I2,10X,2PF8.1,3(16X,F8.1),14X,0PF8.0)          X1QC1560
      GO TO 108                                                         X1QC1570
C --- LINE FOR DATA WITH NO DECIMAL PLACES                              X1QC1580
  106 WRITE (NR,21) SPACE,KYEAR, (X(I),I=J,K), Y(N)                     X1QC1590
   21 FORMAT (A1,3X,2H19,I2,10X,F8.0,3(16X,F8.0),14X,F8.0)              X1QC1600
      GO TO 108                                                         X1QC1610
C --- LINE FOR DATA WITH ONE PLACE AFTER DECIMAL POINT                  X1QC1620
  107 WRITE (NR,22) SPACE,KYEAR, (X(I),I=J,K),Y(N)                      X1QC1630
   22 FORMAT (A1,3X,2H19,I2,10X,2PF8.1,3(16X,F8.1),14X,F8.1)            X1QC1640
  108 J = J + 4                                                         X1QC1650
      KYEAR = KYEAR + 1                                                 X1QC1660
      N = N + 1                                                         X1QC1670
      IF (K-KE) 103,109,109                                             X1QC1680
  109 WRITE (NR,23)                                                     X1QC1690
   23 FORMAT (1H )                                                      X1QC1700
C --- COMPUTE AVERAGE OR STND DEV FOR EACH QUARTER                      X1QC1710
C                                                                       X1QC1720
C     TABLES FOR WHICH ABOVE IS NOT PRINTED                             X1QC1730
      IF (KPART-3) 122,120,123                                          X1QC1740
  120 IF (MTAB-9) 121,999,121                                           X1QC1750
  121 IF (KTAB-11) 122,999,122                                          X1QC1760
  122 IF (KTAB-5) 123,150,123                                           X1QC1770
  123 GO TO (130,130,130,999),NOP                                       X1QC1780
  130 DO 139 N=1,4                                                      X1QC1790
      IST = N + 4*((KB+3-N)/4)                                          X1QC1800
  133 SUM = 0.0                                                         X1QC1840
      C = 0.0                                                           X1QC1850
      DO 136 I=IST,KE,4                                                 X1QC1860
      C = C + 1.0                                                       X1QC1870
      GO TO (134,134,135),NOP                                           X1QC1880
  134 SUM = SUM + X(I)                                                  X1QC1890
      GO TO 136                                                         X1QC1900
  135 SUM = SUM + (X(I)-XBAR) **2                                       X1QC1910
  136 CONTINUE                                                          X1QC1920
      GO TO (137,137,138),NOP                                           X1QC1930
  137 Y(N) = SUM / C                                                    X1QC1940
      GO TO 139                                                         X1QC1950
  138 Y(N) = SQRT(SUM/C)                                                X1QC1960
  139 CONTINUE                                                          X1QC1970
      M = (NOP+1)/2 + 1                                                 X1QC1980
      GO TO (140,141),KDEC                                              X1QC1990
  140 WRITE (NR,24) TAVG(M), (Y(I),I=1,4)                               X1QC2000
   24 FORMAT (4X,A4,12X,F6.0,3(18X,F6.0))                               X1QC2010
      GO TO 150                                                         X1QC2020
  141 WRITE (NR,25) TAVG(M), (Y(I),I=1,4)                               X1QC2030
   25 FORMAT (4X,A4,12X,2PF6.1,3(18X,F6.1))                             X1QC2040
C --- WRITE TABLE TOTAL                                                 X1QC2050
C                                                                       X1QC2060
C     DETERMINE WHICH TABLES ALSO HAVE TABLE AVG AND STND DEV           X1QC2070
  150 IF (MTAB-13) 151,170,151                                          X1QC2080
  151 IF (MTAB-12) 152,170,152                                          X1QC2090
  152 GO TO (153,160,154,155,160),KPART                                 X1QC2100
  153 IF (MTAB-1) 160,170,160                                           X1QC2110
  154 IF (MTAB-11) 160,170,160                                          X1QC2120
  155 IF (MTAB-3) 170,170,160                                           X1QC2130
C --- TABLE TOTAL ONLY                                                  X1QC2140
  160 GO TO (161,162),KDEC                                              X1QC2150
  161 WRITE (NR,26) TOTAL                                               X1QC2160
   26 FORMAT (1H0 19X, 12HTABLE TOTAL ,F10.0)                           X1QC2170
      GO TO 999                                                         X1QC2180
  162 WRITE (NR,27) TOTAL                                               X1QC2190
   27 FORMAT (1H0 19X, 12HTABLE TOTAL ,2PF10.1)                         X1QC2200
      GO TO 999                                                         X1QC2210
C --- TOTAL,AVERAGE, AND STANDARD DEVIATION OF TABLE                    X1QC2220
  170 C = KE - KB + 1                                                   X1QC2230
      XBAR = TOTAL / C                                                  X1QC2240
      SDEV = 0.0                                                        X1QC2250
      DO 171 I=KB,KE                                                    X1QC2260
  171 SDEV = SDEV + (X(I)-XBAR) **2                                     X1QC2270
      SDEV = SQRT(SDEV/C)                                               X1QC2280
      GO TO (172,173),KDEC                                              X1QC2290
  172 WRITE (NR,28) TOTAL,XBAR,SDEV                                     X1QC2300
   28 FORMAT (1H0 19X,12HTABLE TOTAL ,F10.0,5X,5HMEAN ,F10.0,5X,15HSTD. X1QC2310
     1DEVIATION ,F10.0)                                                 X1QC2320
      GO TO 999                                                         X1QC2330
  173 WRITE (NR,29) TOTAL,XBAR,SDEV                                     X1QC2340
   29 FORMAT (1H0 19X,12HTABLE TOTAL ,2PF10.1,5X,5HMEAN ,F10.1,5X,15HSTDX1QC2350
     1. DEVIATION ,F10.1)                                               X1QC2360
  999 RETURN                                                            X1QC2370
      END                                                               X1QC2380
      SUBROUTINE QSAP                                                   X1QB0020
      INTEGER ADD                                                       X1QB0030
      REAL IBAR(4),IBAR2(4),MOBAR(4),MCIBAR(4),MIBAR(4)                 X1QB0040
      DIMENSION XORG(125), XTCSI(125), XTC(125), XSI(125), XTCI(125),   X1QB0050
     1          XTEMP(125),XMORG(125), XMTCI(125), XMI(125), XSIT(125), X1QB0060
     2          WQCD(4), RATIO(4), WTH5(15), WORD(8), XTEM(4), XTEM2(4),X1QB0070
     3          OBAR(4),CIBAR(4),CBAR(4),SBAR(4),QBAR(4),               X1QB0080
     4          OBAR2(4),CIBAR2(4),CBAR2(4),SBAR2(4),QBAR2(4),          X1QB0090
     5          SDCO(4),SDCCI(4),SDCC(4),SDCS(4),SDCQ(4),SDCI(4),       X1QB0100
     6          RIC(4),RII(4),RIS(4),RTOT(4),RATO(4)                    X1QB0110
      COMMON /TADJ/ ADD                                                 X1QB0120
      COMMON /EXTR/ XS(125),XI(125), XWT(125)                           X1QB0130
      COMMON /INPT/ XORG,IB,IE,MEAS,KB7,MLG,JDEC,KP,NP                  X1QB0140
      COMMON /RITE/ NR, NYEAR, TITLE(15), SERNO, KPAGE                  X1QB0150
      COMMON /MORE/ SFC,BPF,KPART,MCD                                   X1QB0160
      DATA W3X3,W3X5 /4H 3X3,4H 3X5 /                                   X1QB0170
      DATA  WTH5            /.670,.403,-.073,.0,.0,                     X1QB0180
     1                       .257,.522,.294,-.073,.0,                   X1QB0190
     2                      -.073,.294,.558,.294,-.073/                 X1QB0200
      DATA  WQCD           /4*1.0/                                      X1QB0210
      DATA PRE,FIN,BLA /4HPRLM,4HFINL,1H /                              X1QB0220
      DATA  WORD           /4HPERC,4HDIFF,4HENT ,4HEREN,4HCHAN,4HCE  ,  X1QB0230
     1 4HGE  ,4H    /                                                   X1QB0240
      BPF = BLA                                                         X1QB0250
      KPART = 1                                                         X1QB0260
      DO 100 I=IB,IE                                                    X1QB0270
  100 XTCSI(I) = XORG(I)                                                X1QB0280
C --- WRITE ORIGINAL SERIES - TABLE B1                                  X1QB0290
      CALL WRIT (XORG,IB,IE,1,1,1,1)                                    X1QB0300
C --- TREND-CYCLE, CENTERED 4-TERM MOVING AVERAGE  (TABLE 2)            X1QB0310
  120 IB1 = IB + 2                                                      X1QB0320
      IE1 = IE - 2                                                      X1QB0330
      DO 121 I=IB1,IE1                                                  X1QB0340
  121 XTC(I) = (XTCSI(I-2) + XTCSI(I+2) + 2.0*(XTCSI(I-1) + XTCSI(I) +  X1QB0350
     1          XTCSI(I+1))) / 8.0                                      X1QB0360
      GO TO (130,122,122,130,130,122,130,130,122),KP                    X1QB0370
  122 CALL WRIT (XTC,IB1,IE1,2,2,1,1)                                   X1QB0380
C --- SI RATIOS -- PRELIMINARY  (TABLE 3 OR 4)                          X1QB0390
  130 SFC = W3X3                                                        X1QB0400
      JTBLE = KPART / 2 + 3                                             X1QB0410
      CALL DIVSUB (XTCSI,XTC,XSI,IB1,IE1)                               X1QB0420
      GO TO (132,132,131,132,132,131,132,132,131),KP                    X1QB0430
  131 CALL WRIT (XSI,IB1,IE1,3,JTBLE,JDEC,JDEC)                         X1QB0440
  132 GO TO (140,150,150),KPART                                         X1QB0450
C --- PART B - REPLACE  EXTREME SI RATIOS - TABLE B4                    X1QB0460
  140 CALL SI (XSI,IB1,IE1,XTEMP,1)                                     X1QB0470
      GO TO (150,150,141),KP                                            X1QB0480
  141 CALL WRIT (XTEMP,IB1,IE1,4,4,JDEC,4)                              X1QB0490
C --- SEASONAL FACTORS -- PRELIMINARY (TABLE 5)                         X1QB0500
  150 CALL QSF (XSI,XS,IB1,IE1,1)                                       X1QB0510
C        FILL IN MISSING TERMS                                          X1QB0520
      XS(IB) = XS(IB+4)                                                 X1QB0530
      XS(IB+1) = XS(IB+5)                                               X1QB0540
      XS(IE) = XS(IE-4)                                                 X1QB0550
      XS(IE-1) = XS(IE-5)                                               X1QB0560
      GO TO (152,152,151,152,152,151,152,152,151),KP                    X1QB0570
  151 CALL WRIT (XS,IB,IE,5,5,JDEC,JDEC)                                X1QB0580
C --- SEASONALLY ADJUST DATA -- PRELIMINARY  (TABLE 6)                  X1QB0590
  152 CALL DIVSUB (XTCSI,XS,XTCI,IB,IE)                                 X1QB0600
      GO TO (154,154,153,154,154,153,154,154,153),KP                    X1QB0610
  153 CALL WRIT (XTCI,IB,IE,6,6,1,1)                                    X1QB0620
C --- TREND-CYCLE CURVE - TABLE 7                                       X1QB0630
  154 CALL MOVAVE (XTCI,XTC,WTH5,IB,IE,5,2,0)                           X1QB0640
      GO TO (155,174,174),KPART                                         X1QB0650
  155 GO TO (174,156),KB7                                               X1QB0660
C --- IF KB7 = 2, MODIFY EXTREME VALUES BEFORE COMPUTING THE B-7        X1QB0670
C                 TREND-CYCLE CURVE                                     X1QB0680
C --- FIND EXTREME SEASONALLY ADJUSTED VALUES                           X1QB0690
  156 CALL DIVSUB (XTCI,XTC,XI,IB,IE)                                   X1QB0700
      CALL XTRMES (XI,IB,IE,XWT)                                        X1QB0710
C --- REPLACE EXTREME VALUES                                            X1QB0720
      DO 169 I=IB,IE                                                    X1QB0730
      IF (XWT(I) - 1.0) 160,169,169                                     X1QB0740
  160 SUM = XTCI(I) * XWT(I)                                            X1QB0750
      COUNT = 0.0                                                       X1QB0760
      N = IE                                                            X1QB0770
      INC = 1                                                           X1QB0780
  161 M = I                                                             X1QB0790
  162 IF (M-N) 163,165,163                                              X1QB0800
  163 M = M + INC                                                       X1QB0810
      IF (XWT(M) - 1.0) 162,164,164                                     X1QB0820
  164 SUM = SUM + XTCI(M)                                               X1QB0830
      COUNT = COUNT + 1.0                                               X1QB0840
  165 IF (INC) 167,166,166                                              X1QB0850
  166 INC = -1                                                          X1QB0860
      N = IB                                                            X1QB0870
      GO TO 161                                                         X1QB0880
  167 XTCI(I) = SUM / (COUNT + XWT(I))                                  X1QB0890
  169 CONTINUE                                                          X1QB0900
C --- COMPUTE MOVING AVERAGE OF MODIFIED SERIES                         X1QB1000
      CALL MOVAVE (XTCI,XTC,WTH5,IB,IE,5,2,0)                           X1QB1010
  174 GO TO (176,175,175,176,175,175,176,175,175),KP                    X1QB1020
  175 CALL WRIT (XTC,IB,IE,7,7,1,1)                                     X1QB1030
C --- SI RATIOS  (TABLE 8 OR 9)                                         X1QB1040
  176 SFC = W3X5                                                        X1QB1050
      GO TO (181,185,190),KPART                                         X1QB1060
C        PART B                                                         X1QB1070
  181 CALL DIVSUB (XORG,XTC,XSI,IB,IE)                                  X1QB1080
      GO TO (183,183,182),KP                                            X1QB1090
  182 CALL WRIT (XSI,IB,IE,3,8,JDEC,JDEC)                               X1QB1100
C --- PART B - REPLACE  EXTREME SI RATIOS - TABLE B9                    X1QB1110
  183 CALL SI (XSI,IB,IE,XTEMP,2)                                       X1QB1120
      GO TO (200,200,184),KP                                            X1QB1130
  184 CALL WRIT (XTEMP,IB,IE,4,9,JDEC,4)                                X1QB1140
      GO TO 200                                                         X1QB1150
C        PART C                                                         X1QB1160
  185 CALL DIVSUB (XTCSI,XTC,XSI,IB,IE)                                 X1QB1170
      GO TO (200,200,200,200,200,186),KP                                X1QB1180
  186 CALL WRIT (XSI,IB,IE,3,9,JDEC,JDEC)                               X1QB1190
      GO TO 200                                                         X1QB1200
C        PART D                                                         X1QB1210
  190 BPF = FIN                                                         X1QB1220
C --- FINAL UNMODIFIED SI RATIOS - TABLE D8                             X1QB1230
      CALL DIVSUB (XORG,XTC,XSIT,IB,IE)                                 X1QB1240
      CALL WRIT (XSIT,IB,IE,3,8,JDEC,JDEC)                              X1QB1250
      CALL FTEST (XSIT,IB,IE,NR)                                        X1QB1260
C --- FINAL REPLACEMENT VALUES FOR EXTREME SI RATIOS - TABLE D9         X1QB1270
      CALL DIVSUB (XTCSI,XTC,XSI,IB,IE)                                 X1QB1280
      DO 193 I=IB,IE                                                    X1QB1290
      IF (XSIT(I)-XSI(I)) 192,191,192                                   X1QB1300
  191 XTEMP(I) = 10.0**10                                               X1QB1310
      GO TO 193                                                         X1QB1320
  192 XTEMP(I) = XSI(I)                                                 X1QB1330
  193 CONTINUE                                                          X1QB1340
      CALL WRIT (XTEMP,IB,IE,4,9,JDEC,JDEC)                             X1QB1350
C --- SEASONAL FACTORS  (TABLE 10)                                      X1QB1360
  200 CALL QSF (XSI,XS,IB,IE,2)                                         X1QB1370
      GO TO (530,201,201,530,201,201,201,201,201),KP                    X1QB1380
  201 CALL WRIT (XS,IB,IE,5,10,JDEC,JDEC)                               X1QB1390
      GO TO (530,530,524),KPART                                         X1QB1400
C --- SEASONAL FACTORS ONE YEAR AHEAD                                   X1QB1410
  524 J = IE - IE/4*4 + 1                                               X1QB1420
      XTEMP(J)   = (3.0* XS(IE-3) - XS(IE-7)) / 2.0                     X1QB1430
      XTEMP(J+1) = (3.0* XS(IE-2) - XS(IE-6)) / 2.0                     X1QB1440
      XTEMP(J+2) = (3.0* XS(IE-1) - XS(IE-5)) / 2.0                     X1QB1450
      XTEMP(J+3) = (3.0* XS(IE)   - XS(IE-4)) / 2.0                     X1QB1460
      IYEAR = NYEAR                                                     X1QB1470
      NYEAR = NYEAR + IE/4                                              X1QB1480
      J3 = J + 3                                                        X1QB1490
      CALL WRIT (XTEMP,J,J3,11,0,JDEC,JDEC)                             X1QB1500
      NYEAR = IYEAR                                                     X1QB1510
C --- SEASONALLY ADJUST  (TABLE 11)                                     X1QB1520
  530 CALL DIVSUB (XORG,XS,XTCI,IB,IE)                                  X1QB1530
      GO TO (242,242,230),KPART                                         X1QB1540
  230 GO TO (242,240),MEAS                                              X1QB1550
C --- IF PART D AND SUMMARY MEASURES RUN, REPLACE SEASONALLY ADJUSTED   X1QB1560
C     SERIES BY ORIGINAL SERIES                                         X1QB1570
  240 DO 241 I=IB,IE                                                    X1QB1580
  241 XTCI(I) = XORG(I)                                                 X1QB1590
  242 GO TO (2002,2002,243,2002,2002,243,243,243,243),KP                X1QB1600
  243 CALL WRIT (XTCI,IB,IE,6,11,1,1)                                   X1QB1610
      GO TO (2002,2002,255),KPART                                       X1QB1620
C --- FINAL TREND-CYCLE, TABLE D12                                      X1QB1630
C --- DIVIDE MODIFIED ORIGINAL SERIES BY FINAL SEASONAL FACTORS         X1QB1640
  255 CALL DIVSUB (XTCSI,XS,XTEMP,IB,IE)                                X1QB1650
      GO TO (259,257),MEAS                                              X1QB1660
C --- IF SUMMARY MEASURES RUN, COMPUTE MOVING AVERAGE OF                X1QB1670
C     OF MODIFIED ORIGINAL                                              X1QB1680
  257 DO 258 I=IB,IE                                                    X1QB1690
  258 XTEMP(I) = XTCSI(I)                                               X1QB1700
  259 CALL MOVAVE (XTEMP,XTC,WTH5,IB,IE,5,2,0)                          X1QB1710
      CALL WRIT (XTC,IB,IE,7,12,1,1)                                    X1QB1720
C --- IRREGULAR  (TABLE 13)                                             X1QB1730
 2002 CALL DIVSUB (XTCI,XTC,XI,IB,IE)                                   X1QB1740
      GO TO (270,261,261,261,261,261,261,261,261),KP                    X1QB1750
  261 CALL WRIT (XI,IB,IE,8,13,JDEC,3)                                  X1QB1760
      GO TO (270,270,6000),KPART                                        X1QB1770
C --- WEIGHTS FOR IRREGULAR - TABLES B17 AND C17                        X1QB1780
  270 CALL XTRMES (XI,IB,IE,XWT)                                        X1QB1790
      BPF = PRE                                                         X1QB1800
      GO TO (280,272,272,271,271,271),KP                                X1QB1810
  271 BPF = FIN                                                         X1QB1820
  272 CALL WRIT (XWT,IB,IE,9,17,JDEC,4)                                 X1QB1830
C --- MODIFY ORIGINAL SERIES BY WEIGHTS - TABLES C1 AND D1              X1QB1840
  280 DO 402 I=IB,IE                                                    X1QB1850
      IF (XWT(I) - 1.0) 399,402,402                                     X1QB1860
  399 IF (ADD) 400,400,401                                              X1QB1870
  400 XTCSI(I) = (XORG(I) * (1.0+XWT(I) * (XI(I)-1.0))) / XI(I)         X1QB1880
      GO TO 402                                                         X1QB1890
  401 XTCSI(I) = XORG(I) - (XI(I) * (1.0 - XWT(I)))                     X1QB1900
  402 CONTINUE                                                          X1QB1910
      KPART = KPART + 1                                                 X1QB1920
      GO TO (286,285,285,286,285,285),KP                                X1QB1930
  285 CALL WRIT (XTCSI,IB,IE,10,1,1,1)                                  X1QB1940
  286 BPF = BLA                                                         X1QB1950
      KP = KP + 3                                                       X1QB1960
      GO TO 120                                                         X1QB1970
C                                                                       X1QB1980
C --- PART E                                                            X1QB1990
C                                                                       X1QB2000
C --- MODIFY ORIGINAL,SEASONALLY ADJUSTED,AND IRREGULAR FOR EXTREMES    X1QB2010
C --- TABLES E1, E2, AND E3                                             X1QB2020
 6000 DO 636 I=IB,IE                                                    X1QB2030
      TORG = XORG(I)                                                    X1QB2040
      TSA = XTCI(I)                                                     X1QB2050
      TI = XI(I)                                                        X1QB2060
      IF (XWT(I)) 635,630,635                                           X1QB2070
  630 IF (ADD) 632,632,631                                              X1QB2080
  631 TORG = XTC(I) + XS(I)                                             X1QB2090
      TI = 0.0                                                          X1QB2100
      GO TO 633                                                         X1QB2110
  632 TORG = XTC(I) * XS(I)                                             X1QB2120
      TI = 1.0                                                          X1QB2130
  633 TSA = XTC(I)                                                      X1QB2140
      GO TO (635,634),MEAS                                              X1QB2150
  634 TORG = XTC(I)                                                     X1QB2160
  635 XMTCI(I) = TSA                                                    X1QB2170
      XMI(I) = TI                                                       X1QB2180
      XMORG(I) = TORG                                                   X1QB2190
  636 CONTINUE                                                          X1QB2200
      KPART = 4                                                         X1QB2210
      CALL WRIT (XMORG,IB,IE,1 ,1,1,1)                                  X1QB2220
      GO TO (637,638),MEAS                                              X1QB2230
  637 CALL WRIT (XMTCI,IB,IE,2 ,2,1,1)                                  X1QB2240
  638 CALL WRIT (XMI,IB,IE,3 ,3,JDEC,3)                                 X1QB2250
C --- RATIOS OF ANNUAL TOTALS - TABLE E4                                X1QB2260
      GO TO (640,2003),MEAS                                             X1QB2270
  640 CALL WRIT (XORG,IB,IE,4,4,1,1)                                    X1QB2280
      IB1 = (IB+2)/4*4 +1                                               X1QB2290
      IE1 = IE/4*4                                                      X1QB2300
      KYEAR = NYEAR + IB1/4                                             X1QB2310
      DO 644 I=IB1,IE1,4                                                X1QB2320
      IF (ADD) 641,641,642                                              X1QB2330
  641 ET1 = (XORG(I)+XORG(I+1)+XORG(I+2)+XORG(I+3)) /                   X1QB2340
     1        (XTCI(I)+XTCI(I+1)+XTCI(I+2)+XTCI(I+3))                   X1QB2350
      ET3 = (XMORG(I)+XMORG(I+1)+XMORG(I+2)+XMORG(I+3)) /               X1QB2360
     1        (XMTCI(I)+XMTCI(I+1)+XMTCI(I+2)+XMTCI(I+3))               X1QB2370
      GO TO 643                                                         X1QB2380
  642 ET1 = (XORG(I)+XORG(I+1)+XORG(I+2)+XORG(I+3)) -                   X1QB2390
     1        (XTCI(I)+XTCI(I+1)+XTCI(I+2)+XTCI(I+3))                   X1QB2400
      ET3 = (XMORG(I)+XMORG(I+1)+XMORG(I+2)+XMORG(I+3)) -               X1QB2410
     1        (XMTCI(I)+XMTCI(I+1)+XMTCI(I+2)+XMTCI(I+3))               X1QB2420
  643 WRITE (NR,25) KYEAR,ET1,ET3                                       X1QB2430
   25 FORMAT (7X,2H19,I2,12X,F7.2,28X,F7.2)                             X1QB2440
  644 KYEAR = KYEAR + 1                                                 X1QB2450
C --- CHANGES IN ORGINAL SERIES  (TABLE E5)                             X1QB2460
 2003 IB1 = IB+1                                                        X1QB2470
      IE1 = IE-1                                                        X1QB2480
      DO 651 I=IB,IE1                                                   X1QB2490
      XTEMP(I+1) = XORG(I+1) - XORG(I)                                  X1QB2500
      IF (ADD) 650,650,651                                              X1QB2510
  650 XTEMP(I+1) = XTEMP(I+1) / XORG(I)                                 X1QB2520
  651 CONTINUE                                                          X1QB2530
      CALL WRIT (XTEMP,IB1,IE,5,5,JDEC,JDEC)                            X1QB2540
      GO TO (655,660),MEAS                                              X1QB2550
C --- CHANGES IN FINAL SEASONALLY ADJUSTED SERIES  (TABLE E6)           X1QB2560
  655 DO 653 I=IB,IE1                                                   X1QB2570
      XTEMP(I+1) = XTCI(I+1) - XTCI(I)                                  X1QB2580
      IF (ADD) 652,652,653                                              X1QB2590
  652 XTEMP(I+1) = XTEMP(I+1) / XTCI(I)                                 X1QB2600
  653 CONTINUE                                                          X1QB2610
      CALL WRIT (XTEMP,IB1,IE,6,6,JDEC,JDEC)                            X1QB2620
C                                                                       X1QB2630
C --- PART F                                                            X1QB2640
C                                                                       X1QB2650
  660 KPART = 5                                                         X1QB2660
      CALL AVEC (XTCI,IB,IE,CIBAR,CIBAR2,SDCCI)                         X1QB2670
      CALL AVEDUR (XTCI,IB,IE,ADRCI)                                    X1QB2680
      CALL AVEDUR (XTC,IB,IE,ADRC)                                      X1QB2690
      CALL AVEDUR (XI,IB,IE,ADRI)                                       X1QB2700
C --- FIND QCD AND COMPUTE QCD MOVING AVERAGE                           X1QB2710
      CALL AVEC (XTC,IB,IE,CBAR,CBAR2,SDCC)                             X1QB2720
      CALL AVEC (XI,IB,IE,IBAR,IBAR2,SDCI)                              X1QB2730
      DO 500 I=1,4                                                      X1QB2740
  500 RATIO(I) = IBAR(I) / CBAR(I)                                      X1QB2750
      I = 3                                                             X1QB2760
  501 IF (RATIO(I)-.995) 502,502,505                                    X1QB2770
  502 I = I - 1                                                         X1QB2780
      IF (I) 503,503,501                                                X1QB2790
  503 MCD = 1                                                           X1QB2800
      DO 504 I=IB,IE                                                    X1QB2810
  504 XTEMP(I) = XTCI(I)                                                X1QB2820
      NT1 = IB                                                          X1QB2830
      NT2 = IE                                                          X1QB2840
      GO TO 506                                                         X1QB2850
  505 MCD = I + 1                                                       X1QB2860
      NT1 = IB + MCD/2                                                  X1QB2870
      NT2 = IE - (MCD-1)/2                                              X1QB2880
      CALL MOVAVE (XTCI,XTEMP,WQCD,IB,IE,MCD,0,0)                       X1QB2890
  506 CALL AVEDUR (XTEMP,NT1,NT2,ADRQCD)                                X1QB2900
      CALL AVEC (XTEMP,NT1,NT2,QBAR,QBAR2,SDCQ)                         X1QB2910
      CALL WRIT (XTEMP,NT1,NT2,1,1,1,1)                                 X1QB2920
C --- SUMMARY MEASURES                                                  X1QB2930
      CALL WRIT (XORG,0,0,2,2,1,1)                                      X1QB2940
      CALL AVEC (XORG,IB,IE,OBAR,OBAR2,SDCO)                            X1QB2950
      CALL AVEC (XS  ,IB,IE,SBAR,SBAR2,SDCS)                            X1QB2960
      CALL AVEC (XMORG,IB,IE,MOBAR,XTEM,XTEM2)                          X1QB2970
      CALL AVEC (XMTCI,IB,IE,MCIBAR,XTEM,XTEM2)                         X1QB2980
      CALL AVEC (XMI,IB,IE,MIBAR,XTEM,XTEM2)                            X1QB2990
      WRITE (NR,10) WORD(ADD+1),WORD(ADD+3),WORD(ADD+5),WORD(ADD+7)     X1QB3000
   10 FORMAT(/7X8HAVERAGE ,4A4, 43H WITHOUT REGARD TO SIGN OVER INDICATEX1QB3010
     1D SPAN /14X4HSPAN22X20HTABLE NO. AND SYMBOL37X15HMODIFIED SERIES /X1QB3020
     215X 2HIN 9X 2HB1 8X 3HD11 7X 3HD13 7X 3HD12 7X 3HD10 7X 2HF1 18X  X1QB3030
     32HE1 8X 2HE2 8X 2HE3 / 12X 8HQUARTERS 7X 1HO 8X 2HCI 9X 1HI 9X 1HCX1QB3040
     49X 1HS 8X 3HQCD 18X 1HO 8X 2HCI 9X 1HI)                           X1QB3050
      DO 510 I=1,4                                                      X1QB3060
  510 WRITE (NR,11) I,OBAR(I),CIBAR(I),IBAR(I),CBAR(I),SBAR(I),QBAR(I), X1QB3070
     1MOBAR(I),MCIBAR(I),MIBAR(I)                                       X1QB3080
   11 FORMAT (16XI1,3X6F10.2,10X3F10.2)                                 X1QB3090
      GO TO (512,520),MEAS                                              X1QB3100
  512 DO 515 I=1,4                                                      X1QB3110
      TEMPS = CBAR(I)**2 + IBAR(I)**2 + SBAR(I)**2                      X1QB3120
      RIC(I) = CBAR(I)**2 / TEMPS * 100.                                X1QB3130
      RII(I) = IBAR(I)**2 / TEMPS * 100.                                X1QB3140
      RIS(I) = SBAR(I)**2 / TEMPS * 100.                                X1QB3150
      RTOT(I) = RIC(I) + RII(I) + RIS(I)                                X1QB3160
  515 RATO(I) = (TEMPS / OBAR(I)**2) *100.                              X1QB3170
      WRITE (NR,12) WORD(ADD+1),WORD(ADD+3),WORD(ADD+5),WORD(ADD+7)     X1QB3180
   12 FORMAT(/7X40HRELATIVE CONTRIBUTIONS OF COMPONENTS TO ,4A4, 18HIN OX1QB3190
     1RIGINAL SERIES /14X4HSPAN7X20HTABLE NO. AND SYMBOL /15X2HIN9X3HD13X1QB3200
     27X3HD127X3HD10 /12X8HQUARTERS7X1HI9X1HC9X1HS7X5HTOTAL5X5HRATIO )  X1QB3210
      DO 516 I=1,4                                                      X1QB3220
  516 WRITE (NR,13) I,RII(I),RIC(I),RIS(I),RTOT(I),RATO(I)              X1QB3230
   13 FORMAT (16XI1,3X5F10.2)                                           X1QB3240
  520 WRITE (NR,14) ADRCI,ADRI,ADRC,ADRQCD                              X1QB3250
   14 FORMAT(/7X23HAVERAGE DURATION OF RUN7X2HCI9X1HI9X1HC7X3HQCD/      X1QB3260
     1 30X4F10.2)                                                       X1QB3270
      WRITE (NR,15) (RATIO(I),I=1,4),MCD                                X1QB3280
   15 FORMAT(/7X 27HI/C RATIO FOR QUARTERS SPAN /                       X1QB3290
     1 18X,1H1,9X,1H2,9X,1H3,9X,1H4 / 10X, 4F10.2 //                    X1QB3300
     2 7X,31HQUARTERS FOR CYCLICAL DOMINANCE,11X,I1)                    X1QB3310
      WRITE (NR,16) WORD(ADD+1),WORD(ADD+3),WORD(ADD+5),WORD(ADD+7)     X1QB3320
   16 FORMAT(/7X 8HAVERAGE ,4A4,  62HWITH REGARD TO SIGN AND STANDARD DEX1QB3330
     1VIATION OVER INDICATED SPAN /                                     X1QB3340
     214X4HSPAN11X3H B113X3HD1313X3HD1213X3HD1013X3HD1113X3H F1 /       X1QB3350
     315X2HIN13X1HO15X1HI15X1HC15X1HS15X2HCI13X3HQCD /                  X1QB3360
     412X104HQUARTERS     AVG    S.D.     AVG    S.D.     AVG    S.D.   X1QB3370
     5  AVG    S.D.     AVG    S.D.     AVG    S.D. )                   X1QB3380
      DO 525 I=1,4                                                      X1QB3390
  525 WRITE (NR,17) I,OBAR2(I),SDCO(I),IBAR2(I),SDCI(I),CBAR2(I),SDCC(I)X1QB3400
     1,SBAR2(I),SDCS(I),CIBAR2(I),SDCCI(I),QBAR2(I),SDCQ(I)             X1QB3410
   17 FORMAT (16X I1, 3X 12F8.2)                                        X1QB3420
C --- WRITE CHARTS                                                      X1QB3430
  910 IF (ADD) 911,911,913                                              X1QB3440
  911 DO 912 I=IB,IE                                                    X1QB3450
      XMI(I) = XMI(I) * 100.                                            X1QB3460
      XI(I) = XI(I) * 100.                                              X1QB3470
      XSIT(I) = XSIT(I) * 100.                                          X1QB3480
      XSI(I) = XSI(I) * 100.                                            X1QB3490
  912 XS(I) = XS(I) * 100.                                              X1QB3500
  913 CALL CHART (2,MLG,1,IB,IE,XTCI,XTC,XTC,1)                         X1QB3510
      GO TO (914,916),MEAS                                              X1QB3520
  914 CALL CHART (3,1,2,IB,IE,XSIT,XSI,XS,2)                            X1QB3530
      IF (NP) 916,916,915                                               X1QB3540
  915 CALL CHART (3,1,1,IB,IE,XSIT,XSI,XS,3)                            X1QB3550
      CALL CHART (2,1,1,IB,IE,XI,XMI,XMI,4)                             X1QB3560
  916 RETURN                                                            X1QB3570
      END                                                               X1QB3580
C --- SEASONAL FACTOR CURVE SUBROUTINE                                  X1QD0020
      SUBROUTINE QSF (XSI,XS,KB,KE,ITER)                                X1QD0030
      INTEGER ADD                                                       X1QD0040
      DIMENSION XSI(125),XS(125),WT3A(6),WT4A(8),W3X3(15),WT3B(6),      X1QD0050
     1          WT4B(8),WT5B(15),WT6B(18),W3X5(28)                      X1QD0060
      COMMON /SIGM/ SIGML,SIGMU,XCF(125)                                X1QD0070
      COMMON /XYBK/ X(30),Y(30)                                         X1QD0080
      COMMON /TADJ/ ADD                                                 X1QD0090
      DATA  WT3A             /.407,.407,.185,                           X1QD0100
     1                        .333,.333,.333/                           X1QD0110
      DATA  WT4A            /.407,.407,.185,.0,                         X1QD0120
     1                       .259,.370,.259,.111/                       X1QD0130
      DATA  W3X3            /.407,.407,.185,.0,.0,                      X1QD0140
     1                       .259,.370,.259,.111,.0,                    X1QD0150
     2                       .111,.222,.333,.222,.111/                  X1QD0160
      DATA  WT3B             /.333,.333,.333,                           X1QD0170
     1                        .333,.333,.333/                           X1QD0180
      DATA  WT4B             /.283,.283,.283,.150,                      X1QD0190
     1                        .250,.250,.250,.250/                      X1QD0200
      DATA  WT5B             /.283,.283,.283,.150,.0,                   X1QD0210
     1                        .250,.250,.250,.183,.067,                 X1QD0220
     2                        .200,.200,.200,.200,.200/                 X1QD0230
      DATA  WT6B             /.283,.283,.283,.150,.000,.000,            X1QD0240
     1                        .250,.250,.250,.183,.067,.000,            X1QD0250
     2                        .150,.217,.217,.217,.133,.067/            X1QD0260
      DATA  W3X5            / .283,.283,.283,.150,.000,.000,.000,       X1QD0270
     1                        .250,.250,.250,.183,.067,.000,.000,       X1QD0280
     2                        .150,.217,.217,.217,.133,.067,.000,       X1QD0290
     3                        .067,.133,.200,.200,.200,.133,.067/       X1QD0300
      KBT = KB-1                                                        X1QD0310
      DO 30 K=1,4                                                       X1QD0320
      KBT = KBT+1                                                       X1QD0330
      J = 0                                                             X1QD0340
      DO 10 I=KBT,KE,4                                                  X1QD0350
      J = J+1                                                           X1QD0360
   10 X(J) = XSI(I)                                                     X1QD0370
      J1 = J                                                            X1QD0380
      IF (J-7) 12,12,11                                                 X1QD0390
   11 J1 = 7                                                            X1QD0400
   12 KTER = ITER - 1                                                   X1QD0410
      J1 = J1 + 7*KTER                                                  X1QD0420
      GO TO (13,113,13,14,15,15,15,  13,13,33,34,35,36,37),J1           X1QD0430
  113 Y(1) = (X(1) + X(2)) / 2.0                                        X1QD0431
      Y(2) = (X(1) + X(2)) / 2.0                                        X1QD0432
      GO TO 40                                                          X1QD0433
   13 CALL MOVAVE (X,Y,WT3A,1,J,3,1,0)                                  X1QD0440
      GO TO 40                                                          X1QD0450
   14 CALL MOVAVE (X,Y,WT4A,1,J,4,2,1)                                  X1QD0460
      GO TO 40                                                          X1QD0470
   15 CALL MOVAVE (X,Y,W3X3,1,J,5,2,0)                                  X1QD0480
      GO TO 40                                                          X1QD0490
   33 CALL MOVAVE (X,Y,WT3B,1,J,3,1,0)                                  X1QD0500
      GO TO 40                                                          X1QD0510
   34 CALL MOVAVE (X,Y,WT4B,1,J,4,2,1)                                  X1QD0520
      GO TO 40                                                          X1QD0530
   35 CALL MOVAVE (X,Y,WT5B,1,J,5,2,0)                                  X1QD0540
      GO TO 40                                                          X1QD0550
   36 CALL MOVAVE (X,Y,WT6B,1,J,6,3,1)                                  X1QD0560
      GO TO 40                                                          X1QD0570
   37 CALL MOVAVE (X,Y,W3X5,1,J,7,3,0)                                  X1QD0580
   40 J = 0                                                             X1QD0590
      DO 30 I=KBT,KE,4                                                  X1QD0600
      J = J + 1                                                         X1QD0610
   30 XS(I) = Y(J)                                                      X1QD0620
C --- CENTER SEASONAL FACTORS                                           X1QD0630
      DO 20 I=KB,KE                                                     X1QD0640
   20 XCF(I) = XS(I)                                                    X1QD0650
      M = KB + 2                                                        X1QD0660
      N = KE - 2                                                        X1QD0670
      DO 23 I=M,N                                                       X1QD0680
      IF (ADD) 22,22,21                                                 X1QD0690
   21 XS(I) = XS(I) - ((XCF(I-2) + XCF(I+2) + 2.0 * (XCF(I-1) + XCF(I) +X1QD0700
     1                  XCF(I+1))) / 8.0)                               X1QD0710
      GO TO 23                                                          X1QD0720
   22 XS(I) = XS(I) / ((XCF(I-2) + XCF(I+2) + 2.0 * (XCF(I-1) + XCF(I) +X1QD0730
     1                  XCF(I+1))) / 8.0)                               X1QD0740
   23 CONTINUE                                                          X1QD0750
      BEG = (XCF(KB) + XCF(KB+4) + 2.0 * (XCF(KB+1) + XCF(KB+2) +       X1QD0760
     1       XCF(KB+3))) / 8.0                                          X1QD0770
      END = (XCF(KE) + XCF(KE-4) + 2.0 * (XCF(KE-1) + XCF(KE-2) +       X1QD0780
     1       XCF(KE-3))) / 8.0                                          X1QD0790
      IF (ADD) 25,25,24                                                 X1QD0800
   24 XS(KB) = XS(KB) - BEG                                             X1QD0810
      XS(KB+1) = XS(KB+1) - BEG                                         X1QD0820
      XS(KE) = XS(KE) - END                                             X1QD0830
      XS(KE-1) = XS(KE-1) - END                                         X1QD0840
      GO TO 26                                                          X1QD0850
   25 XS(KB) = XS(KB) / BEG                                             X1QD0860
      XS(KB+1) = XS(KB+1) / BEG                                         X1QD0870
      XS(KE) = XS(KE) / END                                             X1QD0880
      XS(KE-1) = XS(KE-1) / END                                         X1QD0890
   26 RETURN                                                            X1QD0900
      END                                                               X1QD0910
C --- SUBROUTINE TO FIND EXTEME VALUES IN ARRAY XI                      X1QE0020
      SUBROUTINE XTRMES(XI,KB,KE,XWT)                                   X1QE0030
      INTEGER ADD                                                       X1QE0040
      DIMENSION XWT(125),XI(125)                                        X1QE0050
      COMMON /TADJ/ ADD                                                 X1QE0060
      COMMON /SIGM/ SIGML,SIGMU,SD5(125)                                X1QE0070
      ITER = 1                                                          X1QE0080
      XBAR = 1.0                                                        X1QE0090
      IF (ADD) 9,9,8                                                    X1QE0100
    8 XBAR = 0.0                                                        X1QE0110
    9 MB = (KB+2) / 4*4+1                                               X1QE0120
      ME =  KE / 4 * 4 - 19                                             X1QE0130
      IF (ME-MB) 11,11,12                                               X1QE0140
   11 ME = 1                                                            X1QE0150
   12 DO 29 I=MB,ME,4                                                   X1QE0160
      SDEV = 0.0                                                        X1QE0170
      IF (ME-MB) 13,13,14                                               X1QE0180
   13 J = KB                                                            X1QE0190
      K = KE                                                            X1QE0200
      GO TO 15                                                          X1QE0210
   14 J = I                                                             X1QE0220
      K = I + 19                                                        X1QE0230
   15 C = 0.0                                                           X1QE0240
      DO 18 M=J,K                                                       X1QE0250
      GO TO (17,16),ITER                                                X1QE0260
   16 IF (XWT(M)) 18,18,17                                              X1QE0270
   17 C = C + 1.0                                                       X1QE0280
      SDEV = SDEV + (XI(M)-XBAR) **2                                    X1QE0290
   18 CONTINUE                                                          X1QE0300
      SDEV = SQRT(SDEV/C)                                               X1QE0310
      IF (ME-MB) 24,24,19                                               X1QE0320
   19 IF (I-MB) 20,21,20                                                X1QE0330
   20 IF (I-ME) 23,22,23                                                X1QE0340
   21 J = KB                                                            X1QE0350
      K = MB + 11                                                       X1QE0360
      GO TO 24                                                          X1QE0370
   22 J = ME + 8                                                        X1QE0380
      K = KE                                                            X1QE0390
      GO TO 24                                                          X1QE0400
   23 J = I + 8                                                         X1QE0410
      K = I + 11                                                        X1QE0420
   24 DO 29 M=J,K                                                       X1QE0430
      SD5(M) = SDEV                                                     X1QE0440
      IF (SDEV) 27,27,40                                                X1QE0450
   40 TEMP = (ABS(XI(M)-XBAR)) / SDEV                                   X1QE0460
      IF (TEMP-SIGMU) 25,25,26                                          X1QE0470
   25 IF (TEMP-SIGML) 27,27,28                                          X1QE0480
   26 XWT(M) = 0.0                                                      X1QE0490
      GO TO 29                                                          X1QE0500
   27 XWT(M) = 1.0                                                      X1QE0510
      GO TO 29                                                          X1QE0520
   28 XWT(M) = (SIGMU-TEMP) / (SIGMU-SIGML)                             X1QE0530
   29 CONTINUE                                                          X1QE0540
      GO TO (30,31),ITER                                                X1QE0550
   30 ITER = 2                                                          X1QE0560
      GO TO 9                                                           X1QE0570
   31 RETURN                                                            X1QE0580
      END                                                               X1QE0590
C --- MOVING AVERAGE SUBROUTINE                                         X1QF0020
      SUBROUTINE MOVAVE (X,Y,WT,J,K,NTRMS,NENDT,NOCEN)                  X1QF0030
C ---   X = INPUT SERIES                                                X1QF0040
C       Y = OUTPUT SERIES -I.E. INPUT SERIES AFTER MOVING AVERAGE TAKEN X1QF0050
C       J = LOCATION OF FIRST DATA VALUE OF INPUT SERIES                X1QF0060
C       K = LOCATION OF LAST DATA VALUE OF INPUT SERIES                 X1QF0070
C       WT = WEIGHTS TO BE USED FOR MOVING AVERAGE                      X1QF0080
C --- NENDT = NUMBER OF END TERMS                                       X1QF0090
C --- NTRMS = NUMBER OF TERMS IN MOVING AVERAGE                         X1QF0100
      DIMENSION X(125), Y(125), WT(30)                                  X1QF0110
      IF (NENDT) 5,5,1                                                  X1QF0120
    1 DO  3 N=1,NENDT                                                   X1QF0130
      SUMWT = 0.0                                                       X1QF0140
      TEMP1 = 0.0                                                       X1QF0150
      TEMP2 = 0.0                                                       X1QF0160
      DO 2 I=1,NTRMS                                                    X1QF0170
      KWT = N * NTRMS - NTRMS + I                                       X1QF0180
      KTRM1 = J + I - 1                                                 X1QF0190
      KTRM2 = K - I + 1                                                 X1QF0200
      TEMP1 = TEMP1 + (X(KTRM1) * WT(KWT))                              X1QF0210
      TEMP2 = TEMP2 + (X(KTRM2) * WT(KWT))                              X1QF0220
    2 SUMWT = SUMWT + WT(KWT)                                           X1QF0230
      KBEG = J + N - 1                                                  X1QF0240
      KEND = K + 1 - N                                                  X1QF0250
      Y(KBEG) = TEMP1 / SUMWT                                           X1QF0260
      Y(KEND) = TEMP2 / SUMWT                                           X1QF0270
    3 CONTINUE                                                          X1QF0280
C --- CENTRAL TERMS                                                     X1QF0290
    5 IF (NOCEN) 6,6,10                                                 X1QF0300
    6 K1= K + 1 - NTRMS                                                 X1QF0310
      SUMWT = 0                                                         X1QF0320
      DO 7 I=1,NTRMS                                                    X1QF0330
      KWT = NENDT*NTRMS + I                                             X1QF0340
    7 SUMWT = SUMWT + WT(KWT)                                           X1QF0350
      DO 9 N=J,K1                                                       X1QF0360
      TEMP1 = 0.0                                                       X1QF0370
      DO 8 I=1,NTRMS                                                    X1QF0380
      KWT = NENDT*NTRMS + I                                             X1QF0390
      KTRM1= N + I - 1                                                  X1QF0400
    8 TEMP1 = TEMP1 +(X(KTRM1) * WT(KWT))                               X1QF0410
      KTRM2 = N + NTRMS/2                                               X1QF0420
    9 Y(KTRM2) = TEMP1 / SUMWT                                          X1QF0430
   10 RETURN                                                            X1QF0440
      END                                                               X1QF0450
      SUBROUTINE REPLCE (X,Y,J,K,XWT)                                   X1QG0020
C --- THIS SUBROUTINE REPLACES VALUES IN ARRAY -X- WHICH HAVE A WEIGHT  X1QG0030
C     LESS THAN 1.0                                                     X1QG0040
C --- THE REPLACEMENT VALUES ARE STORED IN ARRAY -Y-                    X1QG0050
      DIMENSION X(125), Y(125), XWT(125)                                X1QG0060
      DO 100 I=J,K                                                      X1QG0070
      R = X(I)                                                          X1QG0080
      IF (XWT(I) - 1.0) 10,100,100                                      X1QG0090
   10 SUM = X(I) * XWT(I)                                               X1QG0100
      KNO = 0                                                           X1QG0110
      IF (I-1-J) 12,12,11                                               X1QG0120
   11 IF (K-I-1) 13,13,19                                               X1QG0130
C --- EXTREME VALUES IN FIRST 2 LOCATIONS AT EITHER END OF ARRAY ARE    X1QG0140
C      REPLACED BY THE THREE NEAREST NONEXTREME VALUES                  X1QG0150
   12 M = J                                                             X1QG0160
      N = K                                                             X1QG0170
      INC = 1                                                           X1QG0180
      GO TO 14                                                          X1QG0190
   13 M = K                                                             X1QG0200
      N = J                                                             X1QG0210
      INC = -1                                                          X1QG0220
   14 IF (XWT(M)-1.0) 15,17,17                                          X1QG0230
   15 IF (M-N) 16,40,16                                                 X1QG0240
   16 M = M + INC                                                       X1QG0250
      GO TO 14                                                          X1QG0260
   17 SUM = SUM + X(M)                                                  X1QG0270
      KNO = KNO + 1                                                     X1QG0280
      IF (KNO-3) 15,40,40                                               X1QG0290
C --- EXTREME CENTER VALUES ARE REPLACED BY TWO NEAREST NONEXTREME      X1QG0300
C      VALUES ON EACH SIDE                                              X1QG0310
   19 K2 = 2                                                            X1QG0320
      MM = I                                                            X1QG0330
C                                                                       X1QG0340
   20 INC = 1                                                           X1QG0350
      N = K                                                             X1QG0360
C                                                                       X1QG0370
   21 NO = 0                                                            X1QG0380
      M = MM                                                            X1QG0390
C                                                                       X1QG0400
   22 IF (M-N) 23,30,23                                                 X1QG0410
   23 M = M + INC                                                       X1QG0420
      IF (XWT(M)-1.0) 22,24,24                                          X1QG0430
C                                                                       X1QG0440
   24 SUM = SUM + X(M)                                                  X1QG0450
      NO = NO + 1                                                       X1QG0460
      IF (NO-K2) 22,30,30                                               X1QG0470
C                                                                       X1QG0480
   30 KNO = KNO + NO                                                    X1QG0490
      IF (KNO-4) 31,39,39                                               X1QG0500
   31 IF (MM-I) 39,32,39                                                X1QG0510
C                                                                       X1QG0520
   32 IF (INC) 34,34,33                                                 X1QG0530
   33 M2 = M                                                            X1QG0540
      N = J                                                             X1QG0550
      K2 = 4 - NO                                                       X1QG0560
      INC = -1                                                          X1QG0570
      GO TO 21                                                          X1QG0580
C                                                                       X1QG0590
   34 K2 = 4 - KNO                                                      X1QG0600
      MM = M2                                                           X1QG0610
      GO TO 20                                                          X1QG0620
C                                                                       X1QG0630
   39 IF (KNO-4) 41,50,50                                               X1QG0640
   40 IF (KNO -3) 41,50,50                                              X1QG0650
   41 SUM = 0.0                                                         X1QG0660
      DO 42 L=J,K                                                       X1QG0670
   42 SUM = SUM + X(L)                                                  X1QG0680
      CT =  K - J + 1                                                   X1QG0690
      GO TO 51                                                          X1QG0700
   50 CT = KNO                                                          X1QG0710
      CT = CT + XWT(I)                                                  X1QG0720
   51 R = SUM / CT                                                      X1QG0730
  100 Y(I) =  R                                                         X1QG0740
      RETURN                                                            X1QG0750
      END                                                               X1QG0760
C --- SUBROUTINE TO CALCULATE AVERAGE QUARTER-TO-QUARTER CHANGE         X1QH0020
      SUBROUTINE AVEC (X,J,K,XBAR,XBAR2,SDC)                            X1QH0030
C --- INPUT IS ARRAY X - LOCATION OF 1ST VALUE IS  J, OF LAST IS K.     X1QH0040
C --- OUTPUT                                                            X1QH0050
C           SDC  = STD. DEV. OF CHANGES WITH REGARD TO SIGN             X1QH0060
C           XBAR = AVERAGE CHANGE WITHOUT REGARD TO SIGN                X1QH0070
C           XBAR2 = AVG CHANGE WITH REGARD TO SIGN                      X1QH0080
C --- IF ADDITIVE ADJUSTMENT, CHANGES ARE QUARTER-TO-QUARTER DIFFERENCE X1QH0090
C     IF MULTIPLICATIVE, QUARTER-TO-QUARTER PERCENT CHANGE              X1QH0100
      INTEGER ADD                                                       X1QH0110
      DIMENSION X(125), XBAR(4), XBAR2(4), SDC(4)                       X1QH0120
      COMMON /TADJ/ ADD                                                 X1QH0130
      DO 10 M=1,4                                                       X1QH0140
      XBAR(M) = 0.0                                                     X1QH0150
      XBAR2(M) = 0.0                                                    X1QH0160
      SDC(M) = 0.0                                                      X1QH0170
      KM = K - M                                                        X1QH0180
      COUNT = KM - J + 1                                                X1QH0190
      DO 3  I=J,KM                                                      X1QH0200
      N = I + M                                                         X1QH0210
      IF (ADD) 1,1,2                                                    X1QH0220
    1 XBAR(M) = XBAR(M) + ABS(X(N)-X(I)) / X(I) * 100.0                 X1QH0230
      XBAR2(M) = XBAR2(M) + (X(N)-X(I)) / X(I) * 100.0                  X1QH0240
      GO TO 3                                                           X1QH0250
    2 XBAR(M) = XBAR(M) + ABS(X(N)-X(I))                                X1QH0260
      XBAR2(M) = XBAR2(M) + (X(N)-X(I))                                 X1QH0270
    3 CONTINUE                                                          X1QH0280
      XBAR(M) = XBAR(M) / COUNT                                         X1QH0290
      XBAR2(M) = XBAR2(M) / COUNT                                       X1QH0300
      IF (ADD) 6,6,4                                                    X1QH0310
    4 DO 5 I=J,KM                                                       X1QH0320
      N = I + M                                                         X1QH0330
    5 SDC(M) = SDC(M) + (X(N)-X(I) - XBAR2(M)) **2                      X1QH0340
      GO TO 8                                                           X1QH0350
    6 DO 7 I=J,KM                                                       X1QH0360
      N = I + M                                                         X1QH0370
    7 SDC(M) = SDC(M) + ((X(N)-X(I)) / X(I) * 100.0 - XBAR2(M)) **2     X1QH0380
    8 IF (SDC(M)) 10,10,9                                               X1QH0390
    9 SDC(M) = SQRT(SDC(M)/COUNT)                                       X1QH0400
   10 CONTINUE                                                          X1QH0410
      RETURN                                                            X1QH0420
      END                                                               X1QH0430
C --- AVERAGE DURATION OF RUN SUBROUTINE                                X1QI0020
      SUBROUTINE AVEDUR(Y,L,M,ADR)                                      X1QI0030
      DIMENSION Y(125)                                                  X1QI0040
      I = L                                                             X1QI0050
      RUNS = 1.                                                         X1QI0060
      IF (Y(I)-Y(I+1)) 15,12,18                                         X1QI0070
   12 I = I + 1                                                         X1QI0080
      IF (I-M) 13,21,21                                                 X1QI0090
   13 IF (Y(I)-Y(I+1)) 15,12,17                                         X1QI0100
   15 I = I + 1                                                         X1QI0110
      IF (I-M) 16,21,21                                                 X1QI0120
   16 IF (Y(I)-Y(I+1)) 15,15,17                                         X1QI0130
   17 RUNS = RUNS + 1.0                                                 X1QI0140
   18 I = I + 1                                                         X1QI0150
      IF (I-M) 19,21,21                                                 X1QI0160
   19 IF (Y(I)-Y(I+1)) 20,18,18                                         X1QI0170
   20 RUNS = RUNS + 1.0                                                 X1QI0180
      GO TO 15                                                          X1QI0190
   21 COUNT = M - L                                                     X1QI0200
      ADR = COUNT / RUNS                                                X1QI0210
      RETURN                                                            X1QI0220
      END                                                               X1QI0230
C --- SUBROUTINE TO DIVIDE/SUBTRACT TWO SERIES                          X1QJ0020
      SUBROUTINE DIVSUB (X,Y,Z,J,K)                                     X1QJ0030
      INTEGER ADD                                                       X1QJ0040
      DIMENSION X(125), Y(125), Z(125)                                  X1QJ0050
      COMMON /TADJ/ ADD                                                 X1QJ0060
      DO 12 I=J,K                                                       X1QJ0070
      IF (ADD) 11,11,10                                                 X1QJ0080
   10 Z(I) = X(I) - Y(I)                                                X1QJ0090
      GO TO 12                                                          X1QJ0100
   11 Z(I) = X(I) / Y(I)                                                X1QJ0110
   12 CONTINUE                                                          X1QJ0120
      RETURN                                                            X1QJ0130
      END                                                               X1QJ0140
C --- SUBROUTINE TO COMPUTE SI RATIOS FOR PART B (TABLES 4 AND 9)       X1QK0020
      SUBROUTINE SI (XSI,J,K,XSIT,ITER)                                 X1QK0030
      DIMENSION XSI(125), XSIT(125), WT(30)                             X1QK0040
      COMMON /EXTR/ XS(125), XI(125), XWT(125)                          X1QK0050
      COMMON /XYBK/ X(30), Y(30)                                        X1QK0060
      CALL QSF (XSI,XS,J,K,ITER)                                        X1QK0070
      CALL DIVSUB (XSI,XS,XI,J,K)                                       X1QK0080
      CALL XTRMES (XI,J,K,XWT)                                          X1QK0090
      L = J - 1                                                         X1QK0100
      DO 11 N=1,4                                                       X1QK0110
      L = L + 1                                                         X1QK0120
      M = 0                                                             X1QK0130
      DO 9 I=L,K,4                                                      X1QK0140
      M = M + 1                                                         X1QK0150
      WT(M) = XWT(I)                                                    X1QK0160
    9 X(M) = XSI(I)                                                     X1QK0170
      CALL REPLCE (X,Y,1,M,WT)                                          X1QK0180
      M = 0                                                             X1QK0190
      DO 10 I=L,K,4                                                     X1QK0200
      M = M + 1                                                         X1QK0210
   10 XSIT(I) = Y(M)                                                    X1QK0220
   11 CONTINUE                                                          X1QK0230
      DO 14 I=J,K                                                       X1QK0240
      IF (XSIT(I)-XSI(I)) 12,13,12                                      X1QK0250
   12 XSI(I) = XSIT(I)                                                  X1QK0260
      GO TO 14                                                          X1QK0270
   13 XSIT(I) = 10.0**10                                                X1QK0280
   14 CONTINUE                                                          X1QK0290
      RETURN                                                            X1QK0300
      END                                                               X1QK0310
C --- F-TEST SUBROUTINE                                                 X1QL0020
      SUBROUTINE FTEST (X,KB,KE,NR)                                     X1QL0030
      INTEGER ADD                                                       X1QL0040
      DIMENSION X(125)                                                  X1QL0050
      COMMON /TADJ/ ADD                                                 X1QL0060
      DATA BLANK,STAR /1H , 2H**/                                       X1QL0070
      DIV = 1.                                                          X1QL0080
      IF (ADD) 8,8,7                                                    X1QL0090
    7 DIV = 10000.                                                      X1QL0100
    8 T = 0.0                                                           X1QL0110
      CF = 0.0                                                          X1QL0120
      SSBQ = 0.0                                                        X1QL0130
      SST = 0.0                                                         X1QL0140
      DO 30 N=1,4                                                       X1QL0150
      T1 = 0.0                                                          X1QL0160
      SSQ = 0.0                                                         X1QL0170
      IST = N                                                           X1QL0180
      IF (KB-N) 13,13,11                                                X1QL0190
   11 IST = N + 4                                                       X1QL0200
   13 DO 16 I=IST,KE,4                                                  X1QL0210
      T1 = T1 + 1.0                                                     X1QL0220
      SSQ = SSQ + X(I)                                                  X1QL0230
   16 SST = SST + X(I) **2                                              X1QL0240
      SSBQ = SSBQ + SSQ*SSQ / T1                                        X1QL0250
      CF = CF + SSQ                                                     X1QL0260
   30 T = T + T1                                                        X1QL0270
      CF = CF * CF / T                                                  X1QL0280
      KDFBQ = 3                                                         X1QL0290
      KDFR = T - 4.0                                                    X1QL0300
      KDFT = T - 1.0                                                    X1QL0310
      SSBQ = (SSBQ - CF) / DIV                                          X1QL0320
      SST = (SST - CF) / DIV                                            X1QL0330
      SSR = SST - SSBQ                                                  X1QL0340
      QMS = SSBQ / 3.0                                                  X1QL0350
      CF = KDFR                                                         X1QL0360
      RMS = SSR / CF                                                    X1QL0370
      FRATIO = QMS / RMS                                                X1QL0380
      TEST = BLANK                                                      X1QL0390
      IF (FRATIO-4.20) 44,43,43                                         X1QL0400
   43 TEST = STAR                                                       X1QL0410
   44 WRITE (NR,104)SSBQ,KDFBQ,QMS,FRATIO,TEST,SSR,KDFR,RMS,SST,KDFT    X1QL0420
  104 FORMAT (35X, 23HSTABLE SEASONALITY TEST /                         X1QL0430
     1        43X, 27HSUM OF   DEGREES OF    MEAN /                     X1QL0440
     2        42X, 38HSQUARES    FREEDOM     SQUARE        F /          X1QL0450
     320X,16HBETWEEN QUARTERS, 4PF13.3,8X,I2,F12.3,0PF12.3,A2 /         X1QL0460
     4 20X, 8HRESIDUAL, 6X, 4PF15.3, I10, F12.3 /                       X1QL0470
     5 20X, 5HTOTAL, 9X, F15.3, I10 )                                   X1QL0480
      IF (TEST-STAR) 42,39,42                                           X1QL0490
   39 WRITE (NR,105)                                                    X1QL0500
  105 FORMAT (25X51H**STABLE SEASONALITY PRESENT AT THE 1 PERCENT LEVEL)X1QL0510
      RETURN                                                            X1QL0520
   42 WRITE (NR,106)                                                    X1QL0530
  106 FORMAT (25X,58H  NO EVIDENCE OF STABLE SEASONALITY AT THE 1 PERCENX1QL0540
     1T LEVEL)                                                          X1QL0550
      RETURN                                                            X1QL0560
      END                                                               X1QL0570
      SUBROUTINE PLOT                                                   X1QN0020
      DIMENSION KPOINT(3), CYCLE(5)                                     X1QN0030
      COMMON /LINE/ VAL(3), NX(112), LOG, NOSER, BIG, SMALL, KSCLE      X1QN0040
      DATA NLETX,NAST,NLETO,NBLANK,NDOT,NPLUS /1HX,1H*,1HO,1H ,1H.,1H</ X1QN0050
      DATA  CYCLE           /.30103, .60206, 1.0, 2.0, 4.0/             X1QN0060
      DO 100 N=1,112                                                    X1QN0070
  100 NX(N) = NBLANK                                                    X1QN0080
      GO TO (102,101),LOG                                               X1QN0090
  101 NX(1  ) = NDOT                                                    X1QN0100
      NX(112) = NDOT                                                    X1QN0110
      GO TO (200,300,400,500,600),KSCLE                                 X1QN0120
  200 NX(30 ) = NDOT                                                    X1QN0130
      NX(55 ) = NDOT                                                    X1QN0140
      NX(76 ) = NDOT                                                    X1QN0150
      NX(95 ) = NDOT                                                    X1QN0160
      GO TO 102                                                         X1QN0170
  300 NX(33 ) = NDOT                                                    X1QN0180
      NX(56 ) = NDOT                                                    X1QN0190
      NX(74 ) = NDOT                                                    X1QN0200
      NX(89 ) = NDOT                                                    X1QN0210
      NX(101) = NDOT                                                    X1QN0220
      GO TO 102                                                         X1QN0230
  400 NX(34 ) = NDOT                                                    X1QN0240
      NX(68 ) = NDOT                                                    X1QN0250
      NX(87 ) = NDOT                                                    X1QN0260
      NX(101) = NDOT                                                    X1QN0270
      GO TO 102                                                         X1QN0280
  500 NX(33 ) = NDOT                                                    X1QN0290
      NX(47 ) = NDOT                                                    X1QN0300
      NX(56 ) = NDOT                                                    X1QN0310
      NX(89 ) = NDOT                                                    X1QN0320
      NX(103) = NDOT                                                    X1QN0330
      GO TO 102                                                         X1QN0340
  600 NX(28 ) = NDOT                                                    X1QN0350
      NX(57 ) = NDOT                                                    X1QN0360
      NX(84 ) = NDOT                                                    X1QN0370
  102 DO 107 M=1,3                                                      X1QN0380
      IF (VAL(M)-BIG) 104,104,103                                       X1QN0390
  103 VAL(M) = BIG                                                      X1QN0400
  104 GO TO (105,106),LOG                                               X1QN0410
  105 KPOINT(M) = (VAL(M)-SMALL) / (BIG-SMALL) * 111.0 + 1.5            X1QN0420
      GO TO 107                                                         X1QN0430
  106 KPOINT(M) = ALOG10(VAL(M)/SMALL) / CYCLE(KSCLE) * 111.0 + 1.5     X1QN0440
  107 CONTINUE                                                          X1QN0450
      NA = KPOINT(1)                                                    X1QN0460
      NB = KPOINT(2)                                                    X1QN0470
      NC = KPOINT(3)                                                    X1QN0480
      NX(NC) = NPLUS                                                    X1QN0490
      NX(NA) = NLETX                                                    X1QN0500
      NX(NB) = NLETO                                                    X1QN0510
      IF (NA-NB) 109,108,109                                            X1QN0520
  108 NX(NA) = NAST                                                     X1QN0530
  109 IF (NOSER-2) 110,114,110                                          X1QN0540
  110 IF (NA-NC) 112,111,112                                            X1QN0550
  111 NX(NA) = NAST                                                     X1QN0560
  112 IF (NB-NC) 114,113,114                                            X1QN0570
  113 NX(NB) = NAST                                                     X1QN0580
  114 RETURN                                                            X1QN0590
      END                                                               X1QN0600
/* *                                                                            
//GO.SYSIN  DD *                                                                
HU255  1503641  1020 SHORT-TERM BANK BALANCES, U. S. CAPITAL, MIL. OF $ 10/10/66
                49               209               304               34950U255  
               213               229               160               27351U255  
               236               233               188               23652U255  
               192               106               146               20053U255  
               172               304               416               39654U255  
               179               285               155               34355U255  
               176               309               295               40656U255  
               425               233               151               23757U255  
               283               373               294               20258U255  
                87               222               131               41759U255  
               304               236               619               63660U255  
               556               359               213               79761U255  
               455                41                94               53462U255  
               123               502               174               69163U255  
               609               731               112                  64U255  
Z                                                                               
/* *                                                                            
/+ +                                                                            
                                                                                                                                                                                                                                          @